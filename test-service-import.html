<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planets Service Import Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîß Planets Service Import Test</h1>
    
    <div class="test-section info">
        <h3>Testing Import Fixes</h3>
        <p>This test verifies that the PlanetsAnalysisDataService can be properly imported and instantiated without the "does not provide an export named" error.</p>
    </div>

    <div class="test-section">
        <h3>üîß Test Controls</h3>
        <button onclick="testServiceImport()">Test Service Import</button>
        <button onclick="testServiceMethods()">Test Service Methods</button>
        <button onclick="clearResults()">Clear Results</button>
    </div>

    <div id="results"></div>

    <script type="module">
        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test-section ${type}`;
            div.innerHTML = `<pre>${new Date().toLocaleTimeString()}: ${message}</pre>`;
            results.appendChild(div);
            console.log(message);
        }

        window.testServiceImport = async function() {
            log('üîç Testing PlanetsAnalysisDataService import...', 'info');

            try {
                // Try to import the service
                const { PlanetsAnalysisDataService } = await import('/src/services/planetsAnalysisDataService.js');
                
                log('‚úÖ Import successful! PlanetsAnalysisDataService loaded without errors', 'success');
                
                // Try to create an instance
                const service = new PlanetsAnalysisDataService();
                log('‚úÖ Service instance created successfully', 'success');
                
                // Check if required methods exist
                const methods = ['getLatestAnalysisNumbers', 'getTopicNumbers', 'isAbcdNumber', 'isBcdNumber', 'getAnalysisSummary'];
                const existingMethods = methods.filter(method => typeof service[method] === 'function');
                
                log(`üìã Methods found: ${existingMethods.length}/${methods.length}`, existingMethods.length === methods.length ? 'success' : 'error');
                existingMethods.forEach(method => log(`   ‚úÖ ${method}()`, 'success'));
                
                if (existingMethods.length === methods.length) {
                    log('üéâ ALL IMPORT FIXES SUCCESSFUL - Service is ready for use!', 'success');
                } else {
                    log('‚ö†Ô∏è Some methods are missing', 'error');
                }

            } catch (error) {
                log(`‚ùå Import failed: ${error.message}`, 'error');
                log(`üí° Error details: ${error.stack}`, 'error');
            }
        };

        window.testServiceMethods = async function() {
            log('üîç Testing service method calls...', 'info');

            try {
                const { PlanetsAnalysisDataService } = await import('/src/services/planetsAnalysisDataService.js');
                const service = new PlanetsAnalysisDataService();
                
                log('üìä Testing getAnalysisSummary()...', 'info');
                
                // Test getAnalysisSummary with mock data
                const mockAnalysisData = {
                    latestDate: '2025-06-26',
                    source: 'test',
                    topicNumbers: {
                        'D-1 Set-1 Matrix': { abcd: [1, 2, 3], bcd: [4, 5] }
                    }
                };
                
                const summary = service.getAnalysisSummary(mockAnalysisData);
                log(`‚úÖ getAnalysisSummary() returned: ${JSON.stringify(summary)}`, 'success');
                
                log('üìä Testing isAbcdNumber()...', 'info');
                const isAbcd = service.isAbcdNumber(1, 'D-1 Set-1 Matrix', mockAnalysisData);
                log(`‚úÖ isAbcdNumber(1, 'D-1 Set-1 Matrix') = ${isAbcd}`, 'success');
                
                log('üìä Testing isBcdNumber()...', 'info');
                const isBcd = service.isBcdNumber(4, 'D-1 Set-1 Matrix', mockAnalysisData);
                log(`‚úÖ isBcdNumber(4, 'D-1 Set-1 Matrix') = ${isBcd}`, 'success');
                
                log('üéâ All service methods working correctly!', 'success');

            } catch (error) {
                log(`‚ùå Method testing failed: ${error.message}`, 'error');
            }
        };

        window.clearResults = function() {
            document.getElementById('results').innerHTML = '';
        };

        // Auto-run initial test
        document.addEventListener('DOMContentLoaded', function() {
            log('üöÄ Import Test Environment Ready', 'info');
            log('üëÜ Click "Test Service Import" to verify the import fixes worked', 'info');
        });
    </script>
</body>
</html>
