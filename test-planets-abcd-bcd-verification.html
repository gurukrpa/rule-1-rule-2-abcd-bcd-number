<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planets Analysis ABCD/BCD Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { background: #e8f5e8; }
        .warning { background: #fff8e1; }
        .error { background: #ffeaea; }
        .code { background: #f5f5f5; padding: 10px; font-family: monospace; }
        .test-step { margin: 10px 0; }
        .badge { display: inline-block; padding: 2px 6px; border-radius: 3px; font-size: 12px; font-weight: bold; }
        .abcd { background: #c8e6c9; color: #2e7d32; }
        .bcd { background: #bbdefb; color: #1565c0; }
    </style>
</head>
<body>
    <h1>üéØ Planets Analysis ABCD/BCD Test</h1>
    
    <div class="section">
        <h2>üìã Test Overview</h2>
        <p>This test verifies that the ABCD/BCD numbers are working correctly for all 30 topics including "D-3 Set-1 Matrix".</p>
    </div>

    <div class="section">
        <h2>üîç Current Topic Numbers</h2>
        <div id="topic-numbers-test"></div>
    </div>

    <div class="section">
        <h2>üß™ Element Number Extraction Test</h2>
        <div id="extraction-test"></div>
    </div>

    <div class="section">
        <h2>üìä ABCD/BCD Badge Rendering Test</h2>
        <div id="badge-test"></div>
    </div>

    <div class="section">
        <h2>üéØ D-3 Set-1 Specific Test</h2>
        <div id="d3-set1-test"></div>
    </div>

    <div class="section">
        <h2>üìù Instructions</h2>
        <div class="test-step">
            <strong>1. Open Browser Console:</strong> Press F12 or Ctrl+Shift+I to see detailed logs
        </div>
        <div class="test-step">
            <strong>2. Navigate to Planets Analysis:</strong> Go to <code>http://localhost:5173/planets-analysis/planets-test-user-2025</code>
        </div>
        <div class="test-step">
            <strong>3. Check for D-3 Set-1:</strong> Look for "D-3 Set-1 Matrix" in the topic headers
        </div>
        <div class="test-step">
            <strong>4. Upload Test Excel:</strong> Create and upload a simple Excel file to verify ABCD/BCD badges appear
        </div>
    </div>

    <script>
        console.log('üîç Starting Planets Analysis ABCD/BCD Test...');

        // Test 1: Topic Numbers Verification
        function testTopicNumbers() {
            const TOPIC_NUMBERS = {
                'D-1 Set-1 Matrix': { abcd: [1, 2, 4, 7, 9], bcd: [5] },
                'D-1 Set-2 Matrix': { abcd: [3, 5, 7, 10, 12], bcd: [] },
                'D-3 Set-1 Matrix': { abcd: [1, 2, 5, 9, 10], bcd: [7] },
                'D-3 Set-2 Matrix': { abcd: [3, 7, 8, 9, 10], bcd: [5, 6] },
                'D-4 Set-1 Matrix': { abcd: [2, 3, 4, 8], bcd: [7, 12] },
                'D-4 Set-2 Matrix': { abcd: [2, 10, 11, 12], bcd: [4] },
                'D-5 Set-1 Matrix': { abcd: [1, 4, 7, 8, 9, 11, 12], bcd: [] },
                'D-5 Set-2 Matrix': { abcd: [4, 5, 7, 8, 10], bcd: [2, 3, 12] },
                'D-7 Set-1 Matrix': { abcd: [5, 6, 8, 9, 11, 12], bcd: [] },
                'D-7 Set-2 Matrix': { abcd: [4, 5, 6, 7, 8], bcd: [] },
                'D-9 Set-1 Matrix': { abcd: [7, 8, 10, 12], bcd: [9] },
                'D-9 Set-2 Matrix': { abcd: [4, 5, 8], bcd: [6, 9] },
                'D-10 Set-1 Matrix': { abcd: [1, 4, 5, 6, 8], bcd: [2] },
                'D-10 Set-2 Matrix': { abcd: [2, 5, 6, 7], bcd: [3, 12] },
                'D-11 Set-1 Matrix': { abcd: [8, 9, 10], bcd: [3] },
                'D-11 Set-2 Matrix': { abcd: [2, 6, 8], bcd: [1] },
                'D-12 Set-1 Matrix': { abcd: [1, 3, 12], bcd: [4, 8] },
                'D-12 Set-2 Matrix': { abcd: [7, 10, 12], bcd: [] },
                'D-27 Set-1 Matrix': { abcd: [1, 3, 4, 5, 8], bcd: [9, 10] },
                'D-27 Set-2 Matrix': { abcd: [2, 3, 5, 7, 11, 12], bcd: [] },
                'D-30 Set-1 Matrix': { abcd: [1, 4, 9, 11], bcd: [2, 7, 8] },
                'D-30 Set-2 Matrix': { abcd: [2, 3, 4, 7, 8, 11], bcd: [5] },
                'D-60 Set-1 Matrix': { abcd: [1, 10, 11], bcd: [] },
                'D-60 Set-2 Matrix': { abcd: [4, 11], bcd: [8, 10] },
                'D-81 Set-1 Matrix': { abcd: [1, 4, 8, 11], bcd: [7, 12] },
                'D-81 Set-2 Matrix': { abcd: [2, 5, 6, 7, 10], bcd: [8, 11] },
                'D-108 Set-1 Matrix': { abcd: [1, 5, 8, 11], bcd: [3] },
                'D-108 Set-2 Matrix': { abcd: [4, 5, 7], bcd: [11] },
                'D-144 Set-1 Matrix': { abcd: [1, 11], bcd: [4, 10] },
                'D-144 Set-2 Matrix': { abcd: [1, 3, 4, 10], bcd: [] }
            };

            let html = '<h3>‚úÖ All 30 Topics Available:</h3>';
            const topicCount = Object.keys(TOPIC_NUMBERS).length;
            html += `<p>Total topics: <strong>${topicCount}/30</strong></p>`;
            
            html += '<h4>üéØ D-3 Set-1 Matrix Specific:</h4>';
            const d3set1 = TOPIC_NUMBERS['D-3 Set-1 Matrix'];
            if (d3set1) {
                html += `<p>‚úÖ Found: D-3 Set-1 Matrix</p>`;
                html += `<p>ABCD: [${d3set1.abcd.join(', ')}] <span class="badge abcd">ABCD</span></p>`;
                html += `<p>BCD: [${d3set1.bcd.join(', ')}] <span class="badge bcd">BCD</span></p>`;
            } else {
                html += `<p>‚ùå D-3 Set-1 Matrix NOT FOUND</p>`;
            }

            document.getElementById('topic-numbers-test').innerHTML = html;
            
            console.log('‚úÖ Topic Numbers Test Results:');
            console.log(`   - Total topics: ${topicCount}/30`);
            console.log(`   - D-3 Set-1 Matrix:`, d3set1);
            return topicCount === 30 && d3set1;
        }

        // Test 2: Element Number Extraction
        function testElementExtraction() {
            const extractElementNumber = (str) => {
                if (typeof str !== 'string') return null;
                const match = str.match(/^[a-z]+-(\d+)/);
                return match ? Number(match[1]) : null;
            };

            const testCases = [
                { input: 'as-7-/su-(12 Sc 50)-(20 Ta 50)', expected: 7 },
                { input: 'mo-3-/ma-(15 Li 30)-(10 Ge 45)', expected: 3 },
                { input: 'hl-5-/ju-(08 Sa 20)-(25 Aq 15)', expected: 5 },
                { input: 'gl-9-/ve-(03 Pi 10)-(18 Vi 55)', expected: 9 },
                { input: 'invalid-data', expected: null },
                { input: '', expected: null }
            ];

            let html = '<h3>üî¢ Element Number Extraction:</h3>';
            let allPassed = true;

            testCases.forEach(test => {
                const result = extractElementNumber(test.input);
                const passed = result === test.expected;
                allPassed = allPassed && passed;
                
                html += `<div class="${passed ? 'success' : 'error'}" style="margin: 5px 0; padding: 5px;">`;
                html += `${passed ? '‚úÖ' : '‚ùå'} "${test.input}" ‚Üí ${result} (expected: ${test.expected})`;
                html += `</div>`;
            });

            document.getElementById('extraction-test').innerHTML = html;
            
            console.log('‚úÖ Element Extraction Test Results:');
            testCases.forEach(test => {
                const result = extractElementNumber(test.input);
                console.log(`   - "${test.input}" ‚Üí ${result} (expected: ${test.expected})`);
            });
            
            return allPassed;
        }

        // Test 3: ABCD/BCD Badge Rendering
        function testBadgeRendering() {
            const TOPIC_NUMBERS = {
                'D-3 Set-1 Matrix': { abcd: [1, 2, 5, 9, 10], bcd: [7] }
            };

            const renderABCDBadges = (rawData, setName) => {
                const extractElementNumber = (str) => {
                    if (typeof str !== 'string') return null;
                    const match = str.match(/^[a-z]+-(\d+)/);
                    return match ? Number(match[1]) : null;
                };

                const extractedNumber = extractElementNumber(rawData);
                if (!extractedNumber && extractedNumber !== 0) return null;
                
                const { abcd, bcd } = TOPIC_NUMBERS[setName] || { abcd: [], bcd: [] };
                
                if (abcd.includes(extractedNumber)) {
                    return 'ABCD';
                }
                
                if (bcd.includes(extractedNumber)) {
                    return 'BCD';
                }
                
                return null;
            };

            const testCases = [
                { data: 'as-1-/su-(12 Sc 50)', topic: 'D-3 Set-1 Matrix', expected: 'ABCD' },
                { data: 'mo-2-/ma-(15 Li 30)', topic: 'D-3 Set-1 Matrix', expected: 'ABCD' },
                { data: 'hl-5-/ju-(08 Sa 20)', topic: 'D-3 Set-1 Matrix', expected: 'ABCD' },
                { data: 'gl-7-/ve-(03 Pi 10)', topic: 'D-3 Set-1 Matrix', expected: 'BCD' },
                { data: 'var-3-/sa-(18 Vi 55)', topic: 'D-3 Set-1 Matrix', expected: null },
                { data: 'sl-6-/ra-(21 Ar 30)', topic: 'D-3 Set-1 Matrix', expected: null }
            ];

            let html = '<h3>üè∑Ô∏è Badge Rendering Test:</h3>';
            let allPassed = true;

            testCases.forEach(test => {
                const result = renderABCDBadges(test.data, test.topic);
                const passed = result === test.expected;
                allPassed = allPassed && passed;
                
                html += `<div class="${passed ? 'success' : 'error'}" style="margin: 5px 0; padding: 5px;">`;
                html += `${passed ? '‚úÖ' : '‚ùå'} "${test.data}" ‚Üí `;
                if (result) {
                    html += `<span class="badge ${result.toLowerCase()}">${result}</span>`;
                } else {
                    html += 'No Badge';
                }
                html += ` (expected: ${test.expected || 'No Badge'})`;
                html += `</div>`;
            });

            document.getElementById('badge-test').innerHTML = html;
            
            console.log('‚úÖ Badge Rendering Test Results:');
            testCases.forEach(test => {
                const result = renderABCDBadges(test.data, test.topic);
                console.log(`   - "${test.data}" ‚Üí ${result} (expected: ${test.expected})`);
            });
            
            return allPassed;
        }

        // Test 4: D-3 Set-1 Specific Test
        function testD3Set1() {
            const d3set1Numbers = { abcd: [1, 2, 5, 9, 10], bcd: [7] };
            
            let html = '<h3>üéØ D-3 Set-1 Matrix Analysis:</h3>';
            html += `<p><strong>Expected ABCD numbers:</strong> ${d3set1Numbers.abcd.join(', ')}</p>`;
            html += `<p><strong>Expected BCD numbers:</strong> ${d3set1Numbers.bcd.join(', ')}</p>`;
            
            html += '<h4>Sample Planet Data for D-3 Set-1:</h4>';
            const sampleData = [
                { element: 'Lagna (as)', data: 'as-2-/su-(12 Sc 50)', number: 2, badge: 'ABCD' },
                { element: 'Moon (mo)', data: 'mo-9-/ma-(15 Li 30)', number: 9, badge: 'ABCD' },
                { element: 'Hora Lagna (hl)', data: 'hl-7-/ju-(08 Sa 20)', number: 7, badge: 'BCD' },
                { element: 'Ghati Lagna (gl)', data: 'gl-3-/ve-(03 Pi 10)', number: 3, badge: null }
            ];

            sampleData.forEach(sample => {
                const badgeClass = sample.badge ? sample.badge.toLowerCase() : '';
                html += `<div style="margin: 5px 0; padding: 5px; border-left: 3px solid #ddd;">`;
                html += `<strong>${sample.element}:</strong> ${sample.data} ‚Üí Number: ${sample.number} `;
                if (sample.badge) {
                    html += `<span class="badge ${badgeClass}">${sample.badge}</span>`;
                } else {
                    html += '<em>No Badge</em>';
                }
                html += `</div>`;
            });

            html += '<h4>What You Should See in Browser:</h4>';
            html += '<ul>';
            html += '<li>‚úÖ D-3 Set-1 Matrix appears in topic list</li>';
            html += '<li>‚úÖ Planet headers show ABCD: [1, 2, 5, 9, 10], BCD: [7]</li>';
            html += '<li>‚úÖ Green ABCD badges for numbers 1, 2, 5, 9, 10</li>';
            html += '<li>‚úÖ Blue BCD badges for number 7</li>';
            html += '<li>‚úÖ No badges for other numbers (3, 4, 6, 8, 11, 12)</li>';
            html += '</ul>';

            document.getElementById('d3-set1-test').innerHTML = html;
            
            console.log('‚úÖ D-3 Set-1 Specific Test:');
            console.log('   - ABCD numbers:', d3set1Numbers.abcd);
            console.log('   - BCD numbers:', d3set1Numbers.bcd);
            console.log('   - Sample data tested with expected badges');
            
            return true;
        }

        // Run all tests
        console.log('üöÄ Running ABCD/BCD tests...');
        const test1 = testTopicNumbers();
        const test2 = testElementExtraction();
        const test3 = testBadgeRendering();
        const test4 = testD3Set1();

        const allTestsPassed = test1 && test2 && test3 && test4;
        
        console.log('\nüìä Test Summary:');
        console.log(`   Topic Numbers: ${test1 ? '‚úÖ PASS' : '‚ùå FAIL'}`);
        console.log(`   Element Extraction: ${test2 ? '‚úÖ PASS' : '‚ùå FAIL'}`);
        console.log(`   Badge Rendering: ${test3 ? '‚úÖ PASS' : '‚ùå FAIL'}`);
        console.log(`   D-3 Set-1 Specific: ${test4 ? '‚úÖ PASS' : '‚ùå FAIL'}`);
        console.log(`   Overall: ${allTestsPassed ? 'üéâ ALL TESTS PASSED' : '‚ùå SOME TESTS FAILED'}`);

        if (allTestsPassed) {
            console.log('\nüéØ Conclusion: ABCD/BCD numbers are correctly configured for D-3 Set-1 Matrix');
            console.log('If you\'re seeing only planet names, it\'s likely because:');
            console.log('1. No Excel file has been uploaded yet');
            console.log('2. The Excel file doesn\'t contain D-3 Set-1 Matrix data');
            console.log('3. The topic name in Excel differs slightly from "D-3 Set-1 Matrix"');
        }
    </script>
</body>
</html>
