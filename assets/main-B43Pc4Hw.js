var S7=Object.defineProperty;var k7=(t,r,e)=>r in t?S7(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var zy=(t,r,e)=>k7(t,typeof r!="symbol"?r+"":r,e);function E7(t,r){for(var e=0;e<r.length;e++){const n=r[e];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();var rr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function A7(t){if(t.__esModule)return t;var r=t.default;if(typeof r=="function"){var e=function n(){return this instanceof n?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};e.prototype=r.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),e}var L3={exports:{}},qp={},I3={exports:{}},gr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xh=Symbol.for("react.element"),C7=Symbol.for("react.portal"),T7=Symbol.for("react.fragment"),N7=Symbol.for("react.strict_mode"),D7=Symbol.for("react.profiler"),R7=Symbol.for("react.provider"),P7=Symbol.for("react.context"),O7=Symbol.for("react.forward_ref"),M7=Symbol.for("react.suspense"),F7=Symbol.for("react.memo"),j7=Symbol.for("react.lazy"),Vy=Symbol.iterator;function L7(t){return t===null||typeof t!="object"?null:(t=Vy&&t[Vy]||t["@@iterator"],typeof t=="function"?t:null)}var B3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$3=Object.assign,U3={};function Lu(t,r,e){this.props=t,this.context=r,this.refs=U3,this.updater=e||B3}Lu.prototype.isReactComponent={};Lu.prototype.setState=function(t,r){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,r,"setState")};Lu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function H3(){}H3.prototype=Lu.prototype;function vv(t,r,e){this.props=t,this.context=r,this.refs=U3,this.updater=e||B3}var bv=vv.prototype=new H3;bv.constructor=vv;$3(bv,Lu.prototype);bv.isPureReactComponent=!0;var qy=Array.isArray,z3=Object.prototype.hasOwnProperty,yv={current:null},V3={key:!0,ref:!0,__self:!0,__source:!0};function q3(t,r,e){var n,s={},a=null,i=null;if(r!=null)for(n in r.ref!==void 0&&(i=r.ref),r.key!==void 0&&(a=""+r.key),r)z3.call(r,n)&&!V3.hasOwnProperty(n)&&(s[n]=r[n]);var o=arguments.length-2;if(o===1)s.children=e;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Xh,type:t,key:a,ref:i,props:s,_owner:yv.current}}function I7(t,r){return{$$typeof:Xh,type:t.type,key:r,ref:t.ref,props:t.props,_owner:t._owner}}function xv(t){return typeof t=="object"&&t!==null&&t.$$typeof===Xh}function B7(t){var r={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(e){return r[e]})}var Wy=/\/+/g;function h1(t,r){return typeof t=="object"&&t!==null&&t.key!=null?B7(""+t.key):r.toString(36)}function N0(t,r,e,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Xh:case C7:i=!0}}if(i)return i=t,s=s(i),t=n===""?"."+h1(i,0):n,qy(s)?(e="",t!=null&&(e=t.replace(Wy,"$&/")+"/"),N0(s,r,e,"",function(c){return c})):s!=null&&(xv(s)&&(s=I7(s,e+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Wy,"$&/")+"/")+t)),r.push(s)),1;if(i=0,n=n===""?".":n+":",qy(t))for(var o=0;o<t.length;o++){a=t[o];var l=n+h1(a,o);i+=N0(a,r,e,l,s)}else if(l=L7(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=n+h1(a,o++),i+=N0(a,r,e,l,s);else if(a==="object")throw r=String(t),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return i}function Ud(t,r,e){if(t==null)return t;var n=[],s=0;return N0(t,n,"","",function(a){return r.call(e,a,s++)}),n}function $7(t){if(t._status===-1){var r=t._result;r=r(),r.then(function(e){(t._status===0||t._status===-1)&&(t._status=1,t._result=e)},function(e){(t._status===0||t._status===-1)&&(t._status=2,t._result=e)}),t._status===-1&&(t._status=0,t._result=r)}if(t._status===1)return t._result.default;throw t._result}var Fs={current:null},D0={transition:null},U7={ReactCurrentDispatcher:Fs,ReactCurrentBatchConfig:D0,ReactCurrentOwner:yv};function W3(){throw Error("act(...) is not supported in production builds of React.")}gr.Children={map:Ud,forEach:function(t,r,e){Ud(t,function(){r.apply(this,arguments)},e)},count:function(t){var r=0;return Ud(t,function(){r++}),r},toArray:function(t){return Ud(t,function(r){return r})||[]},only:function(t){if(!xv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};gr.Component=Lu;gr.Fragment=T7;gr.Profiler=D7;gr.PureComponent=vv;gr.StrictMode=N7;gr.Suspense=M7;gr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U7;gr.act=W3;gr.cloneElement=function(t,r,e){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=$3({},t.props),s=t.key,a=t.ref,i=t._owner;if(r!=null){if(r.ref!==void 0&&(a=r.ref,i=yv.current),r.key!==void 0&&(s=""+r.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in r)z3.call(r,l)&&!V3.hasOwnProperty(l)&&(n[l]=r[l]===void 0&&o!==void 0?o[l]:r[l])}var l=arguments.length-2;if(l===1)n.children=e;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Xh,type:t.type,key:s,ref:a,props:n,_owner:i}};gr.createContext=function(t){return t={$$typeof:P7,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:R7,_context:t},t.Consumer=t};gr.createElement=q3;gr.createFactory=function(t){var r=q3.bind(null,t);return r.type=t,r};gr.createRef=function(){return{current:null}};gr.forwardRef=function(t){return{$$typeof:O7,render:t}};gr.isValidElement=xv;gr.lazy=function(t){return{$$typeof:j7,_payload:{_status:-1,_result:t},_init:$7}};gr.memo=function(t,r){return{$$typeof:F7,type:t,compare:r===void 0?null:r}};gr.startTransition=function(t){var r=D0.transition;D0.transition={};try{t()}finally{D0.transition=r}};gr.unstable_act=W3;gr.useCallback=function(t,r){return Fs.current.useCallback(t,r)};gr.useContext=function(t){return Fs.current.useContext(t)};gr.useDebugValue=function(){};gr.useDeferredValue=function(t){return Fs.current.useDeferredValue(t)};gr.useEffect=function(t,r){return Fs.current.useEffect(t,r)};gr.useId=function(){return Fs.current.useId()};gr.useImperativeHandle=function(t,r,e){return Fs.current.useImperativeHandle(t,r,e)};gr.useInsertionEffect=function(t,r){return Fs.current.useInsertionEffect(t,r)};gr.useLayoutEffect=function(t,r){return Fs.current.useLayoutEffect(t,r)};gr.useMemo=function(t,r){return Fs.current.useMemo(t,r)};gr.useReducer=function(t,r,e){return Fs.current.useReducer(t,r,e)};gr.useRef=function(t){return Fs.current.useRef(t)};gr.useState=function(t){return Fs.current.useState(t)};gr.useSyncExternalStore=function(t,r,e){return Fs.current.useSyncExternalStore(t,r,e)};gr.useTransition=function(){return Fs.current.useTransition()};gr.version="18.3.1";I3.exports=gr;var Se=I3.exports;const wv=gv(Se),Tg=E7({__proto__:null,default:wv},[Se]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H7=Se,z7=Symbol.for("react.element"),V7=Symbol.for("react.fragment"),q7=Object.prototype.hasOwnProperty,W7=H7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,G7={key:!0,ref:!0,__self:!0,__source:!0};function G3(t,r,e){var n,s={},a=null,i=null;e!==void 0&&(a=""+e),r.key!==void 0&&(a=""+r.key),r.ref!==void 0&&(i=r.ref);for(n in r)q7.call(r,n)&&!G7.hasOwnProperty(n)&&(s[n]=r[n]);if(t&&t.defaultProps)for(n in r=t.defaultProps,r)s[n]===void 0&&(s[n]=r[n]);return{$$typeof:z7,type:t,key:a,ref:i,props:s,_owner:W7.current}}qp.Fragment=V7;qp.jsx=G3;qp.jsxs=G3;L3.exports=qp;var X=L3.exports,Ng={},X3={exports:{}},ma={},K3={exports:{}},Y3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function r(_,S){var T=_.length;_.push(S);e:for(;0<T;){var U=T-1>>>1,A=_[U];if(0<s(A,S))_[U]=S,_[T]=A,T=U;else break e}}function e(_){return _.length===0?null:_[0]}function n(_){if(_.length===0)return null;var S=_[0],T=_.pop();if(T!==S){_[0]=T;e:for(var U=0,A=_.length,H=A>>>1;U<H;){var z=2*(U+1)-1,K=_[z],j=z+1,J=_[j];if(0>s(K,T))j<A&&0>s(J,K)?(_[U]=J,_[j]=T,U=j):(_[U]=K,_[z]=T,U=z);else if(j<A&&0>s(J,T))_[U]=J,_[j]=T,U=j;else break e}}return S}function s(_,S){var T=_.sortIndex-S.sortIndex;return T!==0?T:_.id-S.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,d=null,h=3,f=!1,g=!1,m=!1,p=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(_){for(var S=e(c);S!==null;){if(S.callback===null)n(c);else if(S.startTime<=_)n(c),S.sortIndex=S.expirationTime,r(l,S);else break;S=e(c)}}function k(_){if(m=!1,y(_),!g)if(e(l)!==null)g=!0,x(N);else{var S=e(c);S!==null&&w(k,S.startTime-_)}}function N(_,S){g=!1,m&&(m=!1,v(R),R=-1),f=!0;var T=h;try{for(y(S),d=e(l);d!==null&&(!(d.expirationTime>S)||_&&!V());){var U=d.callback;if(typeof U=="function"){d.callback=null,h=d.priorityLevel;var A=U(d.expirationTime<=S);S=t.unstable_now(),typeof A=="function"?d.callback=A:d===e(l)&&n(l),y(S)}else n(l);d=e(l)}if(d!==null)var H=!0;else{var z=e(c);z!==null&&w(k,z.startTime-S),H=!1}return H}finally{d=null,h=T,f=!1}}var L=!1,F=null,R=-1,B=5,q=-1;function V(){return!(t.unstable_now()-q<B)}function I(){if(F!==null){var _=t.unstable_now();q=_;var S=!0;try{S=F(!0,_)}finally{S?C():(L=!1,F=null)}}else L=!1}var C;if(typeof b=="function")C=function(){b(I)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,E=O.port2;O.port1.onmessage=I,C=function(){E.postMessage(null)}}else C=function(){p(I,0)};function x(_){F=_,L||(L=!0,C())}function w(_,S){R=p(function(){_(t.unstable_now())},S)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_){_.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,x(N))},t.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<_?Math.floor(1e3/_):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return e(l)},t.unstable_next=function(_){switch(h){case 1:case 2:case 3:var S=3;break;default:S=h}var T=h;h=S;try{return _()}finally{h=T}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_,S){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var T=h;h=_;try{return S()}finally{h=T}},t.unstable_scheduleCallback=function(_,S,T){var U=t.unstable_now();switch(typeof T=="object"&&T!==null?(T=T.delay,T=typeof T=="number"&&0<T?U+T:U):T=U,_){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=T+A,_={id:u++,callback:S,priorityLevel:_,startTime:T,expirationTime:A,sortIndex:-1},T>U?(_.sortIndex=T,r(c,_),e(l)===null&&_===e(c)&&(m?(v(R),R=-1):m=!0,w(k,T-U))):(_.sortIndex=A,r(l,_),g||f||(g=!0,x(N))),_},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(_){var S=h;return function(){var T=h;h=S;try{return _.apply(this,arguments)}finally{h=T}}}})(Y3);K3.exports=Y3;var X7=K3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K7=Se,da=X7;function Dt(t){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+t,e=1;e<arguments.length;e++)r+="&args[]="+encodeURIComponent(arguments[e]);return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var J3=new Set,mh={};function cc(t,r){Au(t,r),Au(t+"Capture",r)}function Au(t,r){for(mh[t]=r,t=0;t<r.length;t++)J3.add(r[t])}var ao=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dg=Object.prototype.hasOwnProperty,Y7=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gy={},Xy={};function J7(t){return Dg.call(Xy,t)?!0:Dg.call(Gy,t)?!1:Y7.test(t)?Xy[t]=!0:(Gy[t]=!0,!1)}function Z7(t,r,e,n){if(e!==null&&e.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return n?!1:e!==null?!e.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Q7(t,r,e,n){if(r===null||typeof r>"u"||Z7(t,r,e,n))return!0;if(n)return!1;if(e!==null)switch(e.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function js(t,r,e,n,s,a,i){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=e,this.propertyName=t,this.type=r,this.sanitizeURL=a,this.removeEmptyString=i}var ts={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ts[t]=new js(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var r=t[0];ts[r]=new js(r,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ts[t]=new js(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ts[t]=new js(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ts[t]=new js(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ts[t]=new js(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ts[t]=new js(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ts[t]=new js(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ts[t]=new js(t,5,!1,t.toLowerCase(),null,!1,!1)});var _v=/[\-:]([a-z])/g;function Sv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var r=t.replace(_v,Sv);ts[r]=new js(r,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var r=t.replace(_v,Sv);ts[r]=new js(r,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var r=t.replace(_v,Sv);ts[r]=new js(r,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ts[t]=new js(t,1,!1,t.toLowerCase(),null,!1,!1)});ts.xlinkHref=new js("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ts[t]=new js(t,1,!1,t.toLowerCase(),null,!0,!0)});function kv(t,r,e,n){var s=ts.hasOwnProperty(r)?ts[r]:null;(s!==null?s.type!==0:n||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(Q7(r,e,s,n)&&(e=null),n||s===null?J7(r)&&(e===null?t.removeAttribute(r):t.setAttribute(r,""+e)):s.mustUseProperty?t[s.propertyName]=e===null?s.type===3?!1:"":e:(r=s.attributeName,n=s.attributeNamespace,e===null?t.removeAttribute(r):(s=s.type,e=s===3||s===4&&e===!0?"":""+e,n?t.setAttributeNS(n,r,e):t.setAttribute(r,e))))}var ho=K7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hd=Symbol.for("react.element"),Jc=Symbol.for("react.portal"),Zc=Symbol.for("react.fragment"),Ev=Symbol.for("react.strict_mode"),Rg=Symbol.for("react.profiler"),Z3=Symbol.for("react.provider"),Q3=Symbol.for("react.context"),Av=Symbol.for("react.forward_ref"),Pg=Symbol.for("react.suspense"),Og=Symbol.for("react.suspense_list"),Cv=Symbol.for("react.memo"),Vo=Symbol.for("react.lazy"),e4=Symbol.for("react.offscreen"),Ky=Symbol.iterator;function _f(t){return t===null||typeof t!="object"?null:(t=Ky&&t[Ky]||t["@@iterator"],typeof t=="function"?t:null)}var en=Object.assign,d1;function Ff(t){if(d1===void 0)try{throw Error()}catch(e){var r=e.stack.trim().match(/\n( *(at )?)/);d1=r&&r[1]||""}return`
`+d1+t}var p1=!1;function m1(t,r){if(!t||p1)return"";p1=!0;var e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(c){var n=c}Reflect.construct(t,[],r)}else{try{r.call()}catch(c){n=c}t.call(r.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=o);break}}}finally{p1=!1,Error.prepareStackTrace=e}return(t=t?t.displayName||t.name:"")?Ff(t):""}function eE(t){switch(t.tag){case 5:return Ff(t.type);case 16:return Ff("Lazy");case 13:return Ff("Suspense");case 19:return Ff("SuspenseList");case 0:case 2:case 15:return t=m1(t.type,!1),t;case 11:return t=m1(t.type.render,!1),t;case 1:return t=m1(t.type,!0),t;default:return""}}function Mg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Zc:return"Fragment";case Jc:return"Portal";case Rg:return"Profiler";case Ev:return"StrictMode";case Pg:return"Suspense";case Og:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Q3:return(t.displayName||"Context")+".Consumer";case Z3:return(t._context.displayName||"Context")+".Provider";case Av:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Cv:return r=t.displayName||null,r!==null?r:Mg(t.type)||"Memo";case Vo:r=t._payload,t=t._init;try{return Mg(t(r))}catch{}}return null}function tE(t){var r=t.type;switch(t.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=r.render,t=t.displayName||t.name||"",r.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mg(r);case 8:return r===Ev?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function pl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function t4(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function rE(t){var r=t4(t)?"checked":"value",e=Object.getOwnPropertyDescriptor(t.constructor.prototype,r),n=""+t[r];if(!t.hasOwnProperty(r)&&typeof e<"u"&&typeof e.get=="function"&&typeof e.set=="function"){var s=e.get,a=e.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(t,r,{enumerable:e.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function zd(t){t._valueTracker||(t._valueTracker=rE(t))}function r4(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var e=r.getValue(),n="";return t&&(n=t4(t)?t.checked?"true":"false":t.value),t=n,t!==e?(r.setValue(t),!0):!1}function K0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Fg(t,r){var e=r.checked;return en({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:e??t._wrapperState.initialChecked})}function Yy(t,r){var e=r.defaultValue==null?"":r.defaultValue,n=r.checked!=null?r.checked:r.defaultChecked;e=pl(r.value!=null?r.value:e),t._wrapperState={initialChecked:n,initialValue:e,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function n4(t,r){r=r.checked,r!=null&&kv(t,"checked",r,!1)}function jg(t,r){n4(t,r);var e=pl(r.value),n=r.type;if(e!=null)n==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+e):t.value!==""+e&&(t.value=""+e);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}r.hasOwnProperty("value")?Lg(t,r.type,e):r.hasOwnProperty("defaultValue")&&Lg(t,r.type,pl(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(t.defaultChecked=!!r.defaultChecked)}function Jy(t,r,e){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var n=r.type;if(!(n!=="submit"&&n!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+t._wrapperState.initialValue,e||r===t.value||(t.value=r),t.defaultValue=r}e=t.name,e!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,e!==""&&(t.name=e)}function Lg(t,r,e){(r!=="number"||K0(t.ownerDocument)!==t)&&(e==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+e&&(t.defaultValue=""+e))}var jf=Array.isArray;function fu(t,r,e,n){if(t=t.options,r){r={};for(var s=0;s<e.length;s++)r["$"+e[s]]=!0;for(e=0;e<t.length;e++)s=r.hasOwnProperty("$"+t[e].value),t[e].selected!==s&&(t[e].selected=s),s&&n&&(t[e].defaultSelected=!0)}else{for(e=""+pl(e),r=null,s=0;s<t.length;s++){if(t[s].value===e){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}r!==null||t[s].disabled||(r=t[s])}r!==null&&(r.selected=!0)}}function Ig(t,r){if(r.dangerouslySetInnerHTML!=null)throw Error(Dt(91));return en({},r,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Zy(t,r){var e=r.value;if(e==null){if(e=r.children,r=r.defaultValue,e!=null){if(r!=null)throw Error(Dt(92));if(jf(e)){if(1<e.length)throw Error(Dt(93));e=e[0]}r=e}r==null&&(r=""),e=r}t._wrapperState={initialValue:pl(e)}}function s4(t,r){var e=pl(r.value),n=pl(r.defaultValue);e!=null&&(e=""+e,e!==t.value&&(t.value=e),r.defaultValue==null&&t.defaultValue!==e&&(t.defaultValue=e)),n!=null&&(t.defaultValue=""+n)}function Qy(t){var r=t.textContent;r===t._wrapperState.initialValue&&r!==""&&r!==null&&(t.value=r)}function a4(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bg(t,r){return t==null||t==="http://www.w3.org/1999/xhtml"?a4(r):t==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Vd,i4=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,e,n,s){MSApp.execUnsafeLocalFunction(function(){return t(r,e,n,s)})}:t}(function(t,r){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=r;else{for(Vd=Vd||document.createElement("div"),Vd.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=Vd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;r.firstChild;)t.appendChild(r.firstChild)}});function gh(t,r){if(r){var e=t.firstChild;if(e&&e===t.lastChild&&e.nodeType===3){e.nodeValue=r;return}}t.textContent=r}var qf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nE=["Webkit","ms","Moz","O"];Object.keys(qf).forEach(function(t){nE.forEach(function(r){r=r+t.charAt(0).toUpperCase()+t.substring(1),qf[r]=qf[t]})});function o4(t,r,e){return r==null||typeof r=="boolean"||r===""?"":e||typeof r!="number"||r===0||qf.hasOwnProperty(t)&&qf[t]?(""+r).trim():r+"px"}function l4(t,r){t=t.style;for(var e in r)if(r.hasOwnProperty(e)){var n=e.indexOf("--")===0,s=o4(e,r[e],n);e==="float"&&(e="cssFloat"),n?t.setProperty(e,s):t[e]=s}}var sE=en({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $g(t,r){if(r){if(sE[t]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(Dt(137,t));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(Dt(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(Dt(61))}if(r.style!=null&&typeof r.style!="object")throw Error(Dt(62))}}function Ug(t,r){if(t.indexOf("-")===-1)return typeof r.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hg=null;function Tv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var zg=null,hu=null,du=null;function ex(t){if(t=Jh(t)){if(typeof zg!="function")throw Error(Dt(280));var r=t.stateNode;r&&(r=Yp(r),zg(t.stateNode,t.type,r))}}function c4(t){hu?du?du.push(t):du=[t]:hu=t}function u4(){if(hu){var t=hu,r=du;if(du=hu=null,ex(t),r)for(t=0;t<r.length;t++)ex(r[t])}}function f4(t,r){return t(r)}function h4(){}var g1=!1;function d4(t,r,e){if(g1)return t(r,e);g1=!0;try{return f4(t,r,e)}finally{g1=!1,(hu!==null||du!==null)&&(h4(),u4())}}function vh(t,r){var e=t.stateNode;if(e===null)return null;var n=Yp(e);if(n===null)return null;e=n[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(e&&typeof e!="function")throw Error(Dt(231,r,typeof e));return e}var Vg=!1;if(ao)try{var Sf={};Object.defineProperty(Sf,"passive",{get:function(){Vg=!0}}),window.addEventListener("test",Sf,Sf),window.removeEventListener("test",Sf,Sf)}catch{Vg=!1}function aE(t,r,e,n,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{r.apply(e,c)}catch(u){this.onError(u)}}var Wf=!1,Y0=null,J0=!1,qg=null,iE={onError:function(t){Wf=!0,Y0=t}};function oE(t,r,e,n,s,a,i,o,l){Wf=!1,Y0=null,aE.apply(iE,arguments)}function lE(t,r,e,n,s,a,i,o,l){if(oE.apply(this,arguments),Wf){if(Wf){var c=Y0;Wf=!1,Y0=null}else throw Error(Dt(198));J0||(J0=!0,qg=c)}}function uc(t){var r=t,e=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,r.flags&4098&&(e=r.return),t=r.return;while(t)}return r.tag===3?e:null}function p4(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function tx(t){if(uc(t)!==t)throw Error(Dt(188))}function cE(t){var r=t.alternate;if(!r){if(r=uc(t),r===null)throw Error(Dt(188));return r!==t?null:t}for(var e=t,n=r;;){var s=e.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){e=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===e)return tx(s),t;if(a===n)return tx(s),r;a=a.sibling}throw Error(Dt(188))}if(e.return!==n.return)e=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===e){i=!0,e=s,n=a;break}if(o===n){i=!0,n=s,e=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===e){i=!0,e=a,n=s;break}if(o===n){i=!0,n=a,e=s;break}o=o.sibling}if(!i)throw Error(Dt(189))}}if(e.alternate!==n)throw Error(Dt(190))}if(e.tag!==3)throw Error(Dt(188));return e.stateNode.current===e?t:r}function m4(t){return t=cE(t),t!==null?g4(t):null}function g4(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var r=g4(t);if(r!==null)return r;t=t.sibling}return null}var v4=da.unstable_scheduleCallback,rx=da.unstable_cancelCallback,uE=da.unstable_shouldYield,fE=da.unstable_requestPaint,pn=da.unstable_now,hE=da.unstable_getCurrentPriorityLevel,Nv=da.unstable_ImmediatePriority,b4=da.unstable_UserBlockingPriority,Z0=da.unstable_NormalPriority,dE=da.unstable_LowPriority,y4=da.unstable_IdlePriority,Wp=null,Ei=null;function pE(t){if(Ei&&typeof Ei.onCommitFiberRoot=="function")try{Ei.onCommitFiberRoot(Wp,t,void 0,(t.current.flags&128)===128)}catch{}}var ai=Math.clz32?Math.clz32:vE,mE=Math.log,gE=Math.LN2;function vE(t){return t>>>=0,t===0?32:31-(mE(t)/gE|0)|0}var qd=64,Wd=4194304;function Lf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Q0(t,r){var e=t.pendingLanes;if(e===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,i=e&268435455;if(i!==0){var o=i&~s;o!==0?n=Lf(o):(a&=i,a!==0&&(n=Lf(a)))}else i=e&~s,i!==0?n=Lf(i):a!==0&&(n=Lf(a));if(n===0)return 0;if(r!==0&&r!==n&&!(r&s)&&(s=n&-n,a=r&-r,s>=a||s===16&&(a&4194240)!==0))return r;if(n&4&&(n|=e&16),r=t.entangledLanes,r!==0)for(t=t.entanglements,r&=n;0<r;)e=31-ai(r),s=1<<e,n|=t[e],r&=~s;return n}function bE(t,r){switch(t){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yE(t,r){for(var e=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-ai(a),o=1<<i,l=s[i];l===-1?(!(o&e)||o&n)&&(s[i]=bE(o,r)):l<=r&&(t.expiredLanes|=o),a&=~o}}function Wg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function x4(){var t=qd;return qd<<=1,!(qd&4194240)&&(qd=64),t}function v1(t){for(var r=[],e=0;31>e;e++)r.push(t);return r}function Kh(t,r,e){t.pendingLanes|=r,r!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,r=31-ai(r),t[r]=e}function xE(t,r){var e=t.pendingLanes&~r;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=r,t.mutableReadLanes&=r,t.entangledLanes&=r,r=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<e;){var s=31-ai(e),a=1<<s;r[s]=0,n[s]=-1,t[s]=-1,e&=~a}}function Dv(t,r){var e=t.entangledLanes|=r;for(t=t.entanglements;e;){var n=31-ai(e),s=1<<n;s&r|t[n]&r&&(t[n]|=r),e&=~s}}var Or=0;function w4(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var _4,Rv,S4,k4,E4,Gg=!1,Gd=[],sl=null,al=null,il=null,bh=new Map,yh=new Map,Xo=[],wE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nx(t,r){switch(t){case"focusin":case"focusout":sl=null;break;case"dragenter":case"dragleave":al=null;break;case"mouseover":case"mouseout":il=null;break;case"pointerover":case"pointerout":bh.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":yh.delete(r.pointerId)}}function kf(t,r,e,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:r,domEventName:e,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},r!==null&&(r=Jh(r),r!==null&&Rv(r)),t):(t.eventSystemFlags|=n,r=t.targetContainers,s!==null&&r.indexOf(s)===-1&&r.push(s),t)}function _E(t,r,e,n,s){switch(r){case"focusin":return sl=kf(sl,t,r,e,n,s),!0;case"dragenter":return al=kf(al,t,r,e,n,s),!0;case"mouseover":return il=kf(il,t,r,e,n,s),!0;case"pointerover":var a=s.pointerId;return bh.set(a,kf(bh.get(a)||null,t,r,e,n,s)),!0;case"gotpointercapture":return a=s.pointerId,yh.set(a,kf(yh.get(a)||null,t,r,e,n,s)),!0}return!1}function A4(t){var r=Wl(t.target);if(r!==null){var e=uc(r);if(e!==null){if(r=e.tag,r===13){if(r=p4(e),r!==null){t.blockedOn=r,E4(t.priority,function(){S4(e)});return}}else if(r===3&&e.stateNode.current.memoizedState.isDehydrated){t.blockedOn=e.tag===3?e.stateNode.containerInfo:null;return}}}t.blockedOn=null}function R0(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var e=Xg(t.domEventName,t.eventSystemFlags,r[0],t.nativeEvent);if(e===null){e=t.nativeEvent;var n=new e.constructor(e.type,e);Hg=n,e.target.dispatchEvent(n),Hg=null}else return r=Jh(e),r!==null&&Rv(r),t.blockedOn=e,!1;r.shift()}return!0}function sx(t,r,e){R0(t)&&e.delete(r)}function SE(){Gg=!1,sl!==null&&R0(sl)&&(sl=null),al!==null&&R0(al)&&(al=null),il!==null&&R0(il)&&(il=null),bh.forEach(sx),yh.forEach(sx)}function Ef(t,r){t.blockedOn===r&&(t.blockedOn=null,Gg||(Gg=!0,da.unstable_scheduleCallback(da.unstable_NormalPriority,SE)))}function xh(t){function r(s){return Ef(s,t)}if(0<Gd.length){Ef(Gd[0],t);for(var e=1;e<Gd.length;e++){var n=Gd[e];n.blockedOn===t&&(n.blockedOn=null)}}for(sl!==null&&Ef(sl,t),al!==null&&Ef(al,t),il!==null&&Ef(il,t),bh.forEach(r),yh.forEach(r),e=0;e<Xo.length;e++)n=Xo[e],n.blockedOn===t&&(n.blockedOn=null);for(;0<Xo.length&&(e=Xo[0],e.blockedOn===null);)A4(e),e.blockedOn===null&&Xo.shift()}var pu=ho.ReactCurrentBatchConfig,ep=!0;function kE(t,r,e,n){var s=Or,a=pu.transition;pu.transition=null;try{Or=1,Pv(t,r,e,n)}finally{Or=s,pu.transition=a}}function EE(t,r,e,n){var s=Or,a=pu.transition;pu.transition=null;try{Or=4,Pv(t,r,e,n)}finally{Or=s,pu.transition=a}}function Pv(t,r,e,n){if(ep){var s=Xg(t,r,e,n);if(s===null)C1(t,r,n,tp,e),nx(t,n);else if(_E(s,t,r,e,n))n.stopPropagation();else if(nx(t,n),r&4&&-1<wE.indexOf(t)){for(;s!==null;){var a=Jh(s);if(a!==null&&_4(a),a=Xg(t,r,e,n),a===null&&C1(t,r,n,tp,e),a===s)break;s=a}s!==null&&n.stopPropagation()}else C1(t,r,n,null,e)}}var tp=null;function Xg(t,r,e,n){if(tp=null,t=Tv(n),t=Wl(t),t!==null)if(r=uc(t),r===null)t=null;else if(e=r.tag,e===13){if(t=p4(r),t!==null)return t;t=null}else if(e===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null);return tp=t,null}function C4(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hE()){case Nv:return 1;case b4:return 4;case Z0:case dE:return 16;case y4:return 536870912;default:return 16}default:return 16}}var Zo=null,Ov=null,P0=null;function T4(){if(P0)return P0;var t,r=Ov,e=r.length,n,s="value"in Zo?Zo.value:Zo.textContent,a=s.length;for(t=0;t<e&&r[t]===s[t];t++);var i=e-t;for(n=1;n<=i&&r[e-n]===s[a-n];n++);return P0=s.slice(t,1<n?1-n:void 0)}function O0(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function Xd(){return!0}function ax(){return!1}function ga(t){function r(e,n,s,a,i){this._reactName=e,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(e=t[o],this[o]=e?e(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Xd:ax,this.isPropagationStopped=ax,this}return en(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():typeof e.returnValue!="unknown"&&(e.returnValue=!1),this.isDefaultPrevented=Xd)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():typeof e.cancelBubble!="unknown"&&(e.cancelBubble=!0),this.isPropagationStopped=Xd)},persist:function(){},isPersistent:Xd}),r}var Iu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mv=ga(Iu),Yh=en({},Iu,{view:0,detail:0}),AE=ga(Yh),b1,y1,Af,Gp=en({},Yh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Af&&(Af&&t.type==="mousemove"?(b1=t.screenX-Af.screenX,y1=t.screenY-Af.screenY):y1=b1=0,Af=t),b1)},movementY:function(t){return"movementY"in t?t.movementY:y1}}),ix=ga(Gp),CE=en({},Gp,{dataTransfer:0}),TE=ga(CE),NE=en({},Yh,{relatedTarget:0}),x1=ga(NE),DE=en({},Iu,{animationName:0,elapsedTime:0,pseudoElement:0}),RE=ga(DE),PE=en({},Iu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),OE=ga(PE),ME=en({},Iu,{data:0}),ox=ga(ME),FE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function IE(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=LE[t])?!!r[t]:!1}function Fv(){return IE}var BE=en({},Yh,{key:function(t){if(t.key){var r=FE[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=O0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?jE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fv,charCode:function(t){return t.type==="keypress"?O0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?O0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$E=ga(BE),UE=en({},Gp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lx=ga(UE),HE=en({},Yh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fv}),zE=ga(HE),VE=en({},Iu,{propertyName:0,elapsedTime:0,pseudoElement:0}),qE=ga(VE),WE=en({},Gp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),GE=ga(WE),XE=[9,13,27,32],jv=ao&&"CompositionEvent"in window,Gf=null;ao&&"documentMode"in document&&(Gf=document.documentMode);var KE=ao&&"TextEvent"in window&&!Gf,N4=ao&&(!jv||Gf&&8<Gf&&11>=Gf),cx=" ",ux=!1;function D4(t,r){switch(t){case"keyup":return XE.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function R4(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qc=!1;function YE(t,r){switch(t){case"compositionend":return R4(r);case"keypress":return r.which!==32?null:(ux=!0,cx);case"textInput":return t=r.data,t===cx&&ux?null:t;default:return null}}function JE(t,r){if(Qc)return t==="compositionend"||!jv&&D4(t,r)?(t=T4(),P0=Ov=Zo=null,Qc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return N4&&r.locale!=="ko"?null:r.data;default:return null}}var ZE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fx(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!ZE[t.type]:r==="textarea"}function P4(t,r,e,n){c4(n),r=rp(r,"onChange"),0<r.length&&(e=new Mv("onChange","change",null,e,n),t.push({event:e,listeners:r}))}var Xf=null,wh=null;function QE(t){z4(t,0)}function Xp(t){var r=ru(t);if(r4(r))return t}function eA(t,r){if(t==="change")return r}var O4=!1;if(ao){var w1;if(ao){var _1="oninput"in document;if(!_1){var hx=document.createElement("div");hx.setAttribute("oninput","return;"),_1=typeof hx.oninput=="function"}w1=_1}else w1=!1;O4=w1&&(!document.documentMode||9<document.documentMode)}function dx(){Xf&&(Xf.detachEvent("onpropertychange",M4),wh=Xf=null)}function M4(t){if(t.propertyName==="value"&&Xp(wh)){var r=[];P4(r,wh,t,Tv(t)),d4(QE,r)}}function tA(t,r,e){t==="focusin"?(dx(),Xf=r,wh=e,Xf.attachEvent("onpropertychange",M4)):t==="focusout"&&dx()}function rA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Xp(wh)}function nA(t,r){if(t==="click")return Xp(r)}function sA(t,r){if(t==="input"||t==="change")return Xp(r)}function aA(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var li=typeof Object.is=="function"?Object.is:aA;function _h(t,r){if(li(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var e=Object.keys(t),n=Object.keys(r);if(e.length!==n.length)return!1;for(n=0;n<e.length;n++){var s=e[n];if(!Dg.call(r,s)||!li(t[s],r[s]))return!1}return!0}function px(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function mx(t,r){var e=px(t);t=0;for(var n;e;){if(e.nodeType===3){if(n=t+e.textContent.length,t<=r&&n>=r)return{node:e,offset:r-t};t=n}e:{for(;e;){if(e.nextSibling){e=e.nextSibling;break e}e=e.parentNode}e=void 0}e=px(e)}}function F4(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?F4(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function j4(){for(var t=window,r=K0();r instanceof t.HTMLIFrameElement;){try{var e=typeof r.contentWindow.location.href=="string"}catch{e=!1}if(e)t=r.contentWindow;else break;r=K0(t.document)}return r}function Lv(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}function iA(t){var r=j4(),e=t.focusedElem,n=t.selectionRange;if(r!==e&&e&&e.ownerDocument&&F4(e.ownerDocument.documentElement,e)){if(n!==null&&Lv(e)){if(r=n.start,t=n.end,t===void 0&&(t=r),"selectionStart"in e)e.selectionStart=r,e.selectionEnd=Math.min(t,e.value.length);else if(t=(r=e.ownerDocument||document)&&r.defaultView||window,t.getSelection){t=t.getSelection();var s=e.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=mx(e,a);var i=mx(e,n);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(r=r.createRange(),r.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(r),t.extend(i.node,i.offset)):(r.setEnd(i.node,i.offset),t.addRange(r)))}}for(r=[],t=e;t=t.parentNode;)t.nodeType===1&&r.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof e.focus=="function"&&e.focus(),e=0;e<r.length;e++)t=r[e],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var oA=ao&&"documentMode"in document&&11>=document.documentMode,eu=null,Kg=null,Kf=null,Yg=!1;function gx(t,r,e){var n=e.window===e?e.document:e.nodeType===9?e:e.ownerDocument;Yg||eu==null||eu!==K0(n)||(n=eu,"selectionStart"in n&&Lv(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Kf&&_h(Kf,n)||(Kf=n,n=rp(Kg,"onSelect"),0<n.length&&(r=new Mv("onSelect","select",null,r,e),t.push({event:r,listeners:n}),r.target=eu)))}function Kd(t,r){var e={};return e[t.toLowerCase()]=r.toLowerCase(),e["Webkit"+t]="webkit"+r,e["Moz"+t]="moz"+r,e}var tu={animationend:Kd("Animation","AnimationEnd"),animationiteration:Kd("Animation","AnimationIteration"),animationstart:Kd("Animation","AnimationStart"),transitionend:Kd("Transition","TransitionEnd")},S1={},L4={};ao&&(L4=document.createElement("div").style,"AnimationEvent"in window||(delete tu.animationend.animation,delete tu.animationiteration.animation,delete tu.animationstart.animation),"TransitionEvent"in window||delete tu.transitionend.transition);function Kp(t){if(S1[t])return S1[t];if(!tu[t])return t;var r=tu[t],e;for(e in r)if(r.hasOwnProperty(e)&&e in L4)return S1[t]=r[e];return t}var I4=Kp("animationend"),B4=Kp("animationiteration"),$4=Kp("animationstart"),U4=Kp("transitionend"),H4=new Map,vx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xl(t,r){H4.set(t,r),cc(r,[t])}for(var k1=0;k1<vx.length;k1++){var E1=vx[k1],lA=E1.toLowerCase(),cA=E1[0].toUpperCase()+E1.slice(1);xl(lA,"on"+cA)}xl(I4,"onAnimationEnd");xl(B4,"onAnimationIteration");xl($4,"onAnimationStart");xl("dblclick","onDoubleClick");xl("focusin","onFocus");xl("focusout","onBlur");xl(U4,"onTransitionEnd");Au("onMouseEnter",["mouseout","mouseover"]);Au("onMouseLeave",["mouseout","mouseover"]);Au("onPointerEnter",["pointerout","pointerover"]);Au("onPointerLeave",["pointerout","pointerover"]);cc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cc("onBeforeInput",["compositionend","keypress","textInput","paste"]);cc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var If="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uA=new Set("cancel close invalid load scroll toggle".split(" ").concat(If));function bx(t,r,e){var n=t.type||"unknown-event";t.currentTarget=e,lE(n,r,void 0,t),t.currentTarget=null}function z4(t,r){r=(r&4)!==0;for(var e=0;e<t.length;e++){var n=t[e],s=n.event;n=n.listeners;e:{var a=void 0;if(r)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;bx(s,o,c),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;bx(s,o,c),a=l}}}if(J0)throw t=qg,J0=!1,qg=null,t}function Vr(t,r){var e=r[t2];e===void 0&&(e=r[t2]=new Set);var n=t+"__bubble";e.has(n)||(V4(r,t,2,!1),e.add(n))}function A1(t,r,e){var n=0;r&&(n|=4),V4(e,t,n,r)}var Yd="_reactListening"+Math.random().toString(36).slice(2);function Sh(t){if(!t[Yd]){t[Yd]=!0,J3.forEach(function(e){e!=="selectionchange"&&(uA.has(e)||A1(e,!1,t),A1(e,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[Yd]||(r[Yd]=!0,A1("selectionchange",!1,r))}}function V4(t,r,e,n){switch(C4(r)){case 1:var s=kE;break;case 4:s=EE;break;default:s=Pv}e=s.bind(null,r,e,t),s=void 0,!Vg||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(r,e,{capture:!0,passive:s}):t.addEventListener(r,e,!0):s!==void 0?t.addEventListener(r,e,{passive:s}):t.addEventListener(r,e,!1)}function C1(t,r,e,n,s){var a=n;if(!(r&1)&&!(r&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=Wl(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}d4(function(){var c=a,u=Tv(e),d=[];e:{var h=H4.get(t);if(h!==void 0){var f=Mv,g=t;switch(t){case"keypress":if(O0(e)===0)break e;case"keydown":case"keyup":f=$E;break;case"focusin":g="focus",f=x1;break;case"focusout":g="blur",f=x1;break;case"beforeblur":case"afterblur":f=x1;break;case"click":if(e.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=ix;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=TE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=zE;break;case I4:case B4:case $4:f=RE;break;case U4:f=qE;break;case"scroll":f=AE;break;case"wheel":f=GE;break;case"copy":case"cut":case"paste":f=OE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=lx}var m=(r&4)!==0,p=!m&&t==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var b=c,y;b!==null;){y=b;var k=y.stateNode;if(y.tag===5&&k!==null&&(y=k,v!==null&&(k=vh(b,v),k!=null&&m.push(kh(b,k,y)))),p)break;b=b.return}0<m.length&&(h=new f(h,g,null,e,u),d.push({event:h,listeners:m}))}}if(!(r&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&e!==Hg&&(g=e.relatedTarget||e.fromElement)&&(Wl(g)||g[io]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(g=e.relatedTarget||e.toElement,f=c,g=g?Wl(g):null,g!==null&&(p=uc(g),g!==p||g.tag!==5&&g.tag!==6)&&(g=null)):(f=null,g=c),f!==g)){if(m=ix,k="onMouseLeave",v="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(m=lx,k="onPointerLeave",v="onPointerEnter",b="pointer"),p=f==null?h:ru(f),y=g==null?h:ru(g),h=new m(k,b+"leave",f,e,u),h.target=p,h.relatedTarget=y,k=null,Wl(u)===c&&(m=new m(v,b+"enter",g,e,u),m.target=y,m.relatedTarget=p,k=m),p=k,f&&g)t:{for(m=f,v=g,b=0,y=m;y;y=Ic(y))b++;for(y=0,k=v;k;k=Ic(k))y++;for(;0<b-y;)m=Ic(m),b--;for(;0<y-b;)v=Ic(v),y--;for(;b--;){if(m===v||v!==null&&m===v.alternate)break t;m=Ic(m),v=Ic(v)}m=null}else m=null;f!==null&&yx(d,h,f,m,!1),g!==null&&p!==null&&yx(d,p,g,m,!0)}}e:{if(h=c?ru(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var N=eA;else if(fx(h))if(O4)N=sA;else{N=rA;var L=tA}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=nA);if(N&&(N=N(t,c))){P4(d,N,e,u);break e}L&&L(t,h,c),t==="focusout"&&(L=h._wrapperState)&&L.controlled&&h.type==="number"&&Lg(h,"number",h.value)}switch(L=c?ru(c):window,t){case"focusin":(fx(L)||L.contentEditable==="true")&&(eu=L,Kg=c,Kf=null);break;case"focusout":Kf=Kg=eu=null;break;case"mousedown":Yg=!0;break;case"contextmenu":case"mouseup":case"dragend":Yg=!1,gx(d,e,u);break;case"selectionchange":if(oA)break;case"keydown":case"keyup":gx(d,e,u)}var F;if(jv)e:{switch(t){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Qc?D4(t,e)&&(R="onCompositionEnd"):t==="keydown"&&e.keyCode===229&&(R="onCompositionStart");R&&(N4&&e.locale!=="ko"&&(Qc||R!=="onCompositionStart"?R==="onCompositionEnd"&&Qc&&(F=T4()):(Zo=u,Ov="value"in Zo?Zo.value:Zo.textContent,Qc=!0)),L=rp(c,R),0<L.length&&(R=new ox(R,t,null,e,u),d.push({event:R,listeners:L}),F?R.data=F:(F=R4(e),F!==null&&(R.data=F)))),(F=KE?YE(t,e):JE(t,e))&&(c=rp(c,"onBeforeInput"),0<c.length&&(u=new ox("onBeforeInput","beforeinput",null,e,u),d.push({event:u,listeners:c}),u.data=F))}z4(d,r)})}function kh(t,r,e){return{instance:t,listener:r,currentTarget:e}}function rp(t,r){for(var e=r+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=vh(t,e),a!=null&&n.unshift(kh(t,a,s)),a=vh(t,r),a!=null&&n.push(kh(t,a,s))),t=t.return}return n}function Ic(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function yx(t,r,e,n,s){for(var a=r._reactName,i=[];e!==null&&e!==n;){var o=e,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=vh(e,a),l!=null&&i.unshift(kh(e,l,o))):s||(l=vh(e,a),l!=null&&i.push(kh(e,l,o)))),e=e.return}i.length!==0&&t.push({event:r,listeners:i})}var fA=/\r\n?/g,hA=/\u0000|\uFFFD/g;function xx(t){return(typeof t=="string"?t:""+t).replace(fA,`
`).replace(hA,"")}function Jd(t,r,e){if(r=xx(r),xx(t)!==r&&e)throw Error(Dt(425))}function np(){}var Jg=null,Zg=null;function Qg(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var e2=typeof setTimeout=="function"?setTimeout:void 0,dA=typeof clearTimeout=="function"?clearTimeout:void 0,wx=typeof Promise=="function"?Promise:void 0,pA=typeof queueMicrotask=="function"?queueMicrotask:typeof wx<"u"?function(t){return wx.resolve(null).then(t).catch(mA)}:e2;function mA(t){setTimeout(function(){throw t})}function T1(t,r){var e=r,n=0;do{var s=e.nextSibling;if(t.removeChild(e),s&&s.nodeType===8)if(e=s.data,e==="/$"){if(n===0){t.removeChild(s),xh(r);return}n--}else e!=="$"&&e!=="$?"&&e!=="$!"||n++;e=s}while(e);xh(r)}function ol(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return t}function _x(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var e=t.data;if(e==="$"||e==="$!"||e==="$?"){if(r===0)return t;r--}else e==="/$"&&r++}t=t.previousSibling}return null}var Bu=Math.random().toString(36).slice(2),Si="__reactFiber$"+Bu,Eh="__reactProps$"+Bu,io="__reactContainer$"+Bu,t2="__reactEvents$"+Bu,gA="__reactListeners$"+Bu,vA="__reactHandles$"+Bu;function Wl(t){var r=t[Si];if(r)return r;for(var e=t.parentNode;e;){if(r=e[io]||e[Si]){if(e=r.alternate,r.child!==null||e!==null&&e.child!==null)for(t=_x(t);t!==null;){if(e=t[Si])return e;t=_x(t)}return r}t=e,e=t.parentNode}return null}function Jh(t){return t=t[Si]||t[io],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ru(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Dt(33))}function Yp(t){return t[Eh]||null}var r2=[],nu=-1;function wl(t){return{current:t}}function Wr(t){0>nu||(t.current=r2[nu],r2[nu]=null,nu--)}function Hr(t,r){nu++,r2[nu]=t.current,t.current=r}var ml={},ys=wl(ml),Xs=wl(!1),tc=ml;function Cu(t,r){var e=t.type.contextTypes;if(!e)return ml;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===r)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in e)s[a]=r[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ks(t){return t=t.childContextTypes,t!=null}function sp(){Wr(Xs),Wr(ys)}function Sx(t,r,e){if(ys.current!==ml)throw Error(Dt(168));Hr(ys,r),Hr(Xs,e)}function q4(t,r,e){var n=t.stateNode;if(r=r.childContextTypes,typeof n.getChildContext!="function")return e;n=n.getChildContext();for(var s in n)if(!(s in r))throw Error(Dt(108,tE(t)||"Unknown",s));return en({},e,n)}function ap(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ml,tc=ys.current,Hr(ys,t),Hr(Xs,Xs.current),!0}function kx(t,r,e){var n=t.stateNode;if(!n)throw Error(Dt(169));e?(t=q4(t,r,tc),n.__reactInternalMemoizedMergedChildContext=t,Wr(Xs),Wr(ys),Hr(ys,t)):Wr(Xs),Hr(Xs,e)}var Yi=null,Jp=!1,N1=!1;function W4(t){Yi===null?Yi=[t]:Yi.push(t)}function bA(t){Jp=!0,W4(t)}function _l(){if(!N1&&Yi!==null){N1=!0;var t=0,r=Or;try{var e=Yi;for(Or=1;t<e.length;t++){var n=e[t];do n=n(!0);while(n!==null)}Yi=null,Jp=!1}catch(s){throw Yi!==null&&(Yi=Yi.slice(t+1)),v4(Nv,_l),s}finally{Or=r,N1=!1}}return null}var su=[],au=0,ip=null,op=0,Da=[],Ra=0,rc=null,Ji=1,Zi="";function Il(t,r){su[au++]=op,su[au++]=ip,ip=t,op=r}function G4(t,r,e){Da[Ra++]=Ji,Da[Ra++]=Zi,Da[Ra++]=rc,rc=t;var n=Ji;t=Zi;var s=32-ai(n)-1;n&=~(1<<s),e+=1;var a=32-ai(r)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Ji=1<<32-ai(r)+s|e<<s|n,Zi=a+t}else Ji=1<<a|e<<s|n,Zi=t}function Iv(t){t.return!==null&&(Il(t,1),G4(t,1,0))}function Bv(t){for(;t===ip;)ip=su[--au],su[au]=null,op=su[--au],su[au]=null;for(;t===rc;)rc=Da[--Ra],Da[Ra]=null,Zi=Da[--Ra],Da[Ra]=null,Ji=Da[--Ra],Da[Ra]=null}var fa=null,ca=null,Kr=!1,ei=null;function X4(t,r){var e=Pa(5,null,null,0);e.elementType="DELETED",e.stateNode=r,e.return=t,r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)}function Ex(t,r){switch(t.tag){case 5:var e=t.type;return r=r.nodeType!==1||e.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(t.stateNode=r,fa=t,ca=ol(r.firstChild),!0):!1;case 6:return r=t.pendingProps===""||r.nodeType!==3?null:r,r!==null?(t.stateNode=r,fa=t,ca=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(e=rc!==null?{id:Ji,overflow:Zi}:null,t.memoizedState={dehydrated:r,treeContext:e,retryLane:1073741824},e=Pa(18,null,null,0),e.stateNode=r,e.return=t,t.child=e,fa=t,ca=null,!0):!1;default:return!1}}function n2(t){return(t.mode&1)!==0&&(t.flags&128)===0}function s2(t){if(Kr){var r=ca;if(r){var e=r;if(!Ex(t,r)){if(n2(t))throw Error(Dt(418));r=ol(e.nextSibling);var n=fa;r&&Ex(t,r)?X4(n,e):(t.flags=t.flags&-4097|2,Kr=!1,fa=t)}}else{if(n2(t))throw Error(Dt(418));t.flags=t.flags&-4097|2,Kr=!1,fa=t}}}function Ax(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fa=t}function Zd(t){if(t!==fa)return!1;if(!Kr)return Ax(t),Kr=!0,!1;var r;if((r=t.tag!==3)&&!(r=t.tag!==5)&&(r=t.type,r=r!=="head"&&r!=="body"&&!Qg(t.type,t.memoizedProps)),r&&(r=ca)){if(n2(t))throw K4(),Error(Dt(418));for(;r;)X4(t,r),r=ol(r.nextSibling)}if(Ax(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Dt(317));e:{for(t=t.nextSibling,r=0;t;){if(t.nodeType===8){var e=t.data;if(e==="/$"){if(r===0){ca=ol(t.nextSibling);break e}r--}else e!=="$"&&e!=="$!"&&e!=="$?"||r++}t=t.nextSibling}ca=null}}else ca=fa?ol(t.stateNode.nextSibling):null;return!0}function K4(){for(var t=ca;t;)t=ol(t.nextSibling)}function Tu(){ca=fa=null,Kr=!1}function $v(t){ei===null?ei=[t]:ei.push(t)}var yA=ho.ReactCurrentBatchConfig;function Cf(t,r,e){if(t=e.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(e._owner){if(e=e._owner,e){if(e.tag!==1)throw Error(Dt(309));var n=e.stateNode}if(!n)throw Error(Dt(147,t));var s=n,a=""+t;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===a?r.ref:(r=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},r._stringRef=a,r)}if(typeof t!="string")throw Error(Dt(284));if(!e._owner)throw Error(Dt(290,t))}return t}function Qd(t,r){throw t=Object.prototype.toString.call(r),Error(Dt(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t))}function Cx(t){var r=t._init;return r(t._payload)}function Y4(t){function r(v,b){if(t){var y=v.deletions;y===null?(v.deletions=[b],v.flags|=16):y.push(b)}}function e(v,b){if(!t)return null;for(;b!==null;)r(v,b),b=b.sibling;return null}function n(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function s(v,b){return v=fl(v,b),v.index=0,v.sibling=null,v}function a(v,b,y){return v.index=y,t?(y=v.alternate,y!==null?(y=y.index,y<b?(v.flags|=2,b):y):(v.flags|=2,b)):(v.flags|=1048576,b)}function i(v){return t&&v.alternate===null&&(v.flags|=2),v}function o(v,b,y,k){return b===null||b.tag!==6?(b=j1(y,v.mode,k),b.return=v,b):(b=s(b,y),b.return=v,b)}function l(v,b,y,k){var N=y.type;return N===Zc?u(v,b,y.props.children,k,y.key):b!==null&&(b.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Vo&&Cx(N)===b.type)?(k=s(b,y.props),k.ref=Cf(v,b,y),k.return=v,k):(k=$0(y.type,y.key,y.props,null,v.mode,k),k.ref=Cf(v,b,y),k.return=v,k)}function c(v,b,y,k){return b===null||b.tag!==4||b.stateNode.containerInfo!==y.containerInfo||b.stateNode.implementation!==y.implementation?(b=L1(y,v.mode,k),b.return=v,b):(b=s(b,y.children||[]),b.return=v,b)}function u(v,b,y,k,N){return b===null||b.tag!==7?(b=Jl(y,v.mode,k,N),b.return=v,b):(b=s(b,y),b.return=v,b)}function d(v,b,y){if(typeof b=="string"&&b!==""||typeof b=="number")return b=j1(""+b,v.mode,y),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Hd:return y=$0(b.type,b.key,b.props,null,v.mode,y),y.ref=Cf(v,null,b),y.return=v,y;case Jc:return b=L1(b,v.mode,y),b.return=v,b;case Vo:var k=b._init;return d(v,k(b._payload),y)}if(jf(b)||_f(b))return b=Jl(b,v.mode,y,null),b.return=v,b;Qd(v,b)}return null}function h(v,b,y,k){var N=b!==null?b.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return N!==null?null:o(v,b,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Hd:return y.key===N?l(v,b,y,k):null;case Jc:return y.key===N?c(v,b,y,k):null;case Vo:return N=y._init,h(v,b,N(y._payload),k)}if(jf(y)||_f(y))return N!==null?null:u(v,b,y,k,null);Qd(v,y)}return null}function f(v,b,y,k,N){if(typeof k=="string"&&k!==""||typeof k=="number")return v=v.get(y)||null,o(b,v,""+k,N);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Hd:return v=v.get(k.key===null?y:k.key)||null,l(b,v,k,N);case Jc:return v=v.get(k.key===null?y:k.key)||null,c(b,v,k,N);case Vo:var L=k._init;return f(v,b,y,L(k._payload),N)}if(jf(k)||_f(k))return v=v.get(y)||null,u(b,v,k,N,null);Qd(b,k)}return null}function g(v,b,y,k){for(var N=null,L=null,F=b,R=b=0,B=null;F!==null&&R<y.length;R++){F.index>R?(B=F,F=null):B=F.sibling;var q=h(v,F,y[R],k);if(q===null){F===null&&(F=B);break}t&&F&&q.alternate===null&&r(v,F),b=a(q,b,R),L===null?N=q:L.sibling=q,L=q,F=B}if(R===y.length)return e(v,F),Kr&&Il(v,R),N;if(F===null){for(;R<y.length;R++)F=d(v,y[R],k),F!==null&&(b=a(F,b,R),L===null?N=F:L.sibling=F,L=F);return Kr&&Il(v,R),N}for(F=n(v,F);R<y.length;R++)B=f(F,v,R,y[R],k),B!==null&&(t&&B.alternate!==null&&F.delete(B.key===null?R:B.key),b=a(B,b,R),L===null?N=B:L.sibling=B,L=B);return t&&F.forEach(function(V){return r(v,V)}),Kr&&Il(v,R),N}function m(v,b,y,k){var N=_f(y);if(typeof N!="function")throw Error(Dt(150));if(y=N.call(y),y==null)throw Error(Dt(151));for(var L=N=null,F=b,R=b=0,B=null,q=y.next();F!==null&&!q.done;R++,q=y.next()){F.index>R?(B=F,F=null):B=F.sibling;var V=h(v,F,q.value,k);if(V===null){F===null&&(F=B);break}t&&F&&V.alternate===null&&r(v,F),b=a(V,b,R),L===null?N=V:L.sibling=V,L=V,F=B}if(q.done)return e(v,F),Kr&&Il(v,R),N;if(F===null){for(;!q.done;R++,q=y.next())q=d(v,q.value,k),q!==null&&(b=a(q,b,R),L===null?N=q:L.sibling=q,L=q);return Kr&&Il(v,R),N}for(F=n(v,F);!q.done;R++,q=y.next())q=f(F,v,R,q.value,k),q!==null&&(t&&q.alternate!==null&&F.delete(q.key===null?R:q.key),b=a(q,b,R),L===null?N=q:L.sibling=q,L=q);return t&&F.forEach(function(I){return r(v,I)}),Kr&&Il(v,R),N}function p(v,b,y,k){if(typeof y=="object"&&y!==null&&y.type===Zc&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Hd:e:{for(var N=y.key,L=b;L!==null;){if(L.key===N){if(N=y.type,N===Zc){if(L.tag===7){e(v,L.sibling),b=s(L,y.props.children),b.return=v,v=b;break e}}else if(L.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Vo&&Cx(N)===L.type){e(v,L.sibling),b=s(L,y.props),b.ref=Cf(v,L,y),b.return=v,v=b;break e}e(v,L);break}else r(v,L);L=L.sibling}y.type===Zc?(b=Jl(y.props.children,v.mode,k,y.key),b.return=v,v=b):(k=$0(y.type,y.key,y.props,null,v.mode,k),k.ref=Cf(v,b,y),k.return=v,v=k)}return i(v);case Jc:e:{for(L=y.key;b!==null;){if(b.key===L)if(b.tag===4&&b.stateNode.containerInfo===y.containerInfo&&b.stateNode.implementation===y.implementation){e(v,b.sibling),b=s(b,y.children||[]),b.return=v,v=b;break e}else{e(v,b);break}else r(v,b);b=b.sibling}b=L1(y,v.mode,k),b.return=v,v=b}return i(v);case Vo:return L=y._init,p(v,b,L(y._payload),k)}if(jf(y))return g(v,b,y,k);if(_f(y))return m(v,b,y,k);Qd(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,b!==null&&b.tag===6?(e(v,b.sibling),b=s(b,y),b.return=v,v=b):(e(v,b),b=j1(y,v.mode,k),b.return=v,v=b),i(v)):e(v,b)}return p}var Nu=Y4(!0),J4=Y4(!1),lp=wl(null),cp=null,iu=null,Uv=null;function Hv(){Uv=iu=cp=null}function zv(t){var r=lp.current;Wr(lp),t._currentValue=r}function a2(t,r,e){for(;t!==null;){var n=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,n!==null&&(n.childLanes|=r)):n!==null&&(n.childLanes&r)!==r&&(n.childLanes|=r),t===e)break;t=t.return}}function mu(t,r){cp=t,Uv=iu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&r&&(Gs=!0),t.firstContext=null)}function Fa(t){var r=t._currentValue;if(Uv!==t)if(t={context:t,memoizedValue:r,next:null},iu===null){if(cp===null)throw Error(Dt(308));iu=t,cp.dependencies={lanes:0,firstContext:t}}else iu=iu.next=t;return r}var Gl=null;function Vv(t){Gl===null?Gl=[t]:Gl.push(t)}function Z4(t,r,e,n){var s=r.interleaved;return s===null?(e.next=e,Vv(r)):(e.next=s.next,s.next=e),r.interleaved=e,oo(t,n)}function oo(t,r){t.lanes|=r;var e=t.alternate;for(e!==null&&(e.lanes|=r),e=t,t=t.return;t!==null;)t.childLanes|=r,e=t.alternate,e!==null&&(e.childLanes|=r),e=t,t=t.return;return e.tag===3?e.stateNode:null}var qo=!1;function qv(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Q4(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function to(t,r){return{eventTime:t,lane:r,tag:0,payload:null,callback:null,next:null}}function ll(t,r,e){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ar&2){var s=n.pending;return s===null?r.next=r:(r.next=s.next,s.next=r),n.pending=r,oo(t,e)}return s=n.interleaved,s===null?(r.next=r,Vv(n)):(r.next=s.next,s.next=r),n.interleaved=r,oo(t,e)}function M0(t,r,e){if(r=r.updateQueue,r!==null&&(r=r.shared,(e&4194240)!==0)){var n=r.lanes;n&=t.pendingLanes,e|=n,r.lanes=e,Dv(t,e)}}function Tx(t,r){var e=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,e===n)){var s=null,a=null;if(e=e.firstBaseUpdate,e!==null){do{var i={eventTime:e.eventTime,lane:e.lane,tag:e.tag,payload:e.payload,callback:e.callback,next:null};a===null?s=a=i:a=a.next=i,e=e.next}while(e!==null);a===null?s=a=r:a=a.next=r}else s=a=r;e={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=e;return}t=e.lastBaseUpdate,t===null?e.firstBaseUpdate=r:t.next=r,e.lastBaseUpdate=r}function up(t,r,e,n){var s=t.updateQueue;qo=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?a=c:i.next=c,i=l;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(a!==null){var d=s.baseState;i=0,u=c=l=null,o=a;do{var h=o.lane,f=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=t,m=o;switch(h=r,f=e,m.tag){case 1:if(g=m.payload,typeof g=="function"){d=g.call(f,d,h);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(f,d,h):g,h==null)break e;d=en({},d,h);break e;case 2:qo=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,h=s.effects,h===null?s.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,i|=h;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;h=o,o=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,r=s.shared.interleaved,r!==null){s=r;do i|=s.lane,s=s.next;while(s!==r)}else a===null&&(s.shared.lanes=0);sc|=i,t.lanes=i,t.memoizedState=d}}function Nx(t,r,e){if(t=r.effects,r.effects=null,t!==null)for(r=0;r<t.length;r++){var n=t[r],s=n.callback;if(s!==null){if(n.callback=null,n=e,typeof s!="function")throw Error(Dt(191,s));s.call(n)}}}var Zh={},Ai=wl(Zh),Ah=wl(Zh),Ch=wl(Zh);function Xl(t){if(t===Zh)throw Error(Dt(174));return t}function Wv(t,r){switch(Hr(Ch,r),Hr(Ah,t),Hr(Ai,Zh),t=r.nodeType,t){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:Bg(null,"");break;default:t=t===8?r.parentNode:r,r=t.namespaceURI||null,t=t.tagName,r=Bg(r,t)}Wr(Ai),Hr(Ai,r)}function Du(){Wr(Ai),Wr(Ah),Wr(Ch)}function e6(t){Xl(Ch.current);var r=Xl(Ai.current),e=Bg(r,t.type);r!==e&&(Hr(Ah,t),Hr(Ai,e))}function Gv(t){Ah.current===t&&(Wr(Ai),Wr(Ah))}var Zr=wl(0);function fp(t){for(var r=t;r!==null;){if(r.tag===13){var e=r.memoizedState;if(e!==null&&(e=e.dehydrated,e===null||e.data==="$?"||e.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var D1=[];function Xv(){for(var t=0;t<D1.length;t++)D1[t]._workInProgressVersionPrimary=null;D1.length=0}var F0=ho.ReactCurrentDispatcher,R1=ho.ReactCurrentBatchConfig,nc=0,Qr=null,Rn=null,Un=null,hp=!1,Yf=!1,Th=0,xA=0;function ss(){throw Error(Dt(321))}function Kv(t,r){if(r===null)return!1;for(var e=0;e<r.length&&e<t.length;e++)if(!li(t[e],r[e]))return!1;return!0}function Yv(t,r,e,n,s,a){if(nc=a,Qr=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,F0.current=t===null||t.memoizedState===null?kA:EA,t=e(n,s),Yf){a=0;do{if(Yf=!1,Th=0,25<=a)throw Error(Dt(301));a+=1,Un=Rn=null,r.updateQueue=null,F0.current=AA,t=e(n,s)}while(Yf)}if(F0.current=dp,r=Rn!==null&&Rn.next!==null,nc=0,Un=Rn=Qr=null,hp=!1,r)throw Error(Dt(300));return t}function Jv(){var t=Th!==0;return Th=0,t}function yi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?Qr.memoizedState=Un=t:Un=Un.next=t,Un}function ja(){if(Rn===null){var t=Qr.alternate;t=t!==null?t.memoizedState:null}else t=Rn.next;var r=Un===null?Qr.memoizedState:Un.next;if(r!==null)Un=r,Rn=t;else{if(t===null)throw Error(Dt(310));Rn=t,t={memoizedState:Rn.memoizedState,baseState:Rn.baseState,baseQueue:Rn.baseQueue,queue:Rn.queue,next:null},Un===null?Qr.memoizedState=Un=t:Un=Un.next=t}return Un}function Nh(t,r){return typeof r=="function"?r(t):r}function P1(t){var r=ja(),e=r.queue;if(e===null)throw Error(Dt(311));e.lastRenderedReducer=t;var n=Rn,s=n.baseQueue,a=e.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,e.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,c=a;do{var u=c.lane;if((nc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,Qr.lanes|=u,sc|=u}c=c.next}while(c!==null&&c!==a);l===null?i=n:l.next=o,li(n,r.memoizedState)||(Gs=!0),r.memoizedState=n,r.baseState=i,r.baseQueue=l,e.lastRenderedState=n}if(t=e.interleaved,t!==null){s=t;do a=s.lane,Qr.lanes|=a,sc|=a,s=s.next;while(s!==t)}else s===null&&(e.lanes=0);return[r.memoizedState,e.dispatch]}function O1(t){var r=ja(),e=r.queue;if(e===null)throw Error(Dt(311));e.lastRenderedReducer=t;var n=e.dispatch,s=e.pending,a=r.memoizedState;if(s!==null){e.pending=null;var i=s=s.next;do a=t(a,i.action),i=i.next;while(i!==s);li(a,r.memoizedState)||(Gs=!0),r.memoizedState=a,r.baseQueue===null&&(r.baseState=a),e.lastRenderedState=a}return[a,n]}function t6(){}function r6(t,r){var e=Qr,n=ja(),s=r(),a=!li(n.memoizedState,s);if(a&&(n.memoizedState=s,Gs=!0),n=n.queue,Zv(a6.bind(null,e,n,t),[t]),n.getSnapshot!==r||a||Un!==null&&Un.memoizedState.tag&1){if(e.flags|=2048,Dh(9,s6.bind(null,e,n,s,r),void 0,null),zn===null)throw Error(Dt(349));nc&30||n6(e,r,s)}return s}function n6(t,r,e){t.flags|=16384,t={getSnapshot:r,value:e},r=Qr.updateQueue,r===null?(r={lastEffect:null,stores:null},Qr.updateQueue=r,r.stores=[t]):(e=r.stores,e===null?r.stores=[t]:e.push(t))}function s6(t,r,e,n){r.value=e,r.getSnapshot=n,i6(r)&&o6(t)}function a6(t,r,e){return e(function(){i6(r)&&o6(t)})}function i6(t){var r=t.getSnapshot;t=t.value;try{var e=r();return!li(t,e)}catch{return!0}}function o6(t){var r=oo(t,1);r!==null&&ii(r,t,1,-1)}function Dx(t){var r=yi();return typeof t=="function"&&(t=t()),r.memoizedState=r.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nh,lastRenderedState:t},r.queue=t,t=t.dispatch=SA.bind(null,Qr,t),[r.memoizedState,t]}function Dh(t,r,e,n){return t={tag:t,create:r,destroy:e,deps:n,next:null},r=Qr.updateQueue,r===null?(r={lastEffect:null,stores:null},Qr.updateQueue=r,r.lastEffect=t.next=t):(e=r.lastEffect,e===null?r.lastEffect=t.next=t:(n=e.next,e.next=t,t.next=n,r.lastEffect=t)),t}function l6(){return ja().memoizedState}function j0(t,r,e,n){var s=yi();Qr.flags|=t,s.memoizedState=Dh(1|r,e,void 0,n===void 0?null:n)}function Zp(t,r,e,n){var s=ja();n=n===void 0?null:n;var a=void 0;if(Rn!==null){var i=Rn.memoizedState;if(a=i.destroy,n!==null&&Kv(n,i.deps)){s.memoizedState=Dh(r,e,a,n);return}}Qr.flags|=t,s.memoizedState=Dh(1|r,e,a,n)}function Rx(t,r){return j0(8390656,8,t,r)}function Zv(t,r){return Zp(2048,8,t,r)}function c6(t,r){return Zp(4,2,t,r)}function u6(t,r){return Zp(4,4,t,r)}function f6(t,r){if(typeof r=="function")return t=t(),r(t),function(){r(null)};if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function h6(t,r,e){return e=e!=null?e.concat([t]):null,Zp(4,4,f6.bind(null,r,t),e)}function Qv(){}function d6(t,r){var e=ja();r=r===void 0?null:r;var n=e.memoizedState;return n!==null&&r!==null&&Kv(r,n[1])?n[0]:(e.memoizedState=[t,r],t)}function p6(t,r){var e=ja();r=r===void 0?null:r;var n=e.memoizedState;return n!==null&&r!==null&&Kv(r,n[1])?n[0]:(t=t(),e.memoizedState=[t,r],t)}function m6(t,r,e){return nc&21?(li(e,r)||(e=x4(),Qr.lanes|=e,sc|=e,t.baseState=!0),r):(t.baseState&&(t.baseState=!1,Gs=!0),t.memoizedState=e)}function wA(t,r){var e=Or;Or=e!==0&&4>e?e:4,t(!0);var n=R1.transition;R1.transition={};try{t(!1),r()}finally{Or=e,R1.transition=n}}function g6(){return ja().memoizedState}function _A(t,r,e){var n=ul(t);if(e={lane:n,action:e,hasEagerState:!1,eagerState:null,next:null},v6(t))b6(r,e);else if(e=Z4(t,r,e,n),e!==null){var s=Ps();ii(e,t,n,s),y6(e,r,n)}}function SA(t,r,e){var n=ul(t),s={lane:n,action:e,hasEagerState:!1,eagerState:null,next:null};if(v6(t))b6(r,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=r.lastRenderedReducer,a!==null))try{var i=r.lastRenderedState,o=a(i,e);if(s.hasEagerState=!0,s.eagerState=o,li(o,i)){var l=r.interleaved;l===null?(s.next=s,Vv(r)):(s.next=l.next,l.next=s),r.interleaved=s;return}}catch{}finally{}e=Z4(t,r,s,n),e!==null&&(s=Ps(),ii(e,t,n,s),y6(e,r,n))}}function v6(t){var r=t.alternate;return t===Qr||r!==null&&r===Qr}function b6(t,r){Yf=hp=!0;var e=t.pending;e===null?r.next=r:(r.next=e.next,e.next=r),t.pending=r}function y6(t,r,e){if(e&4194240){var n=r.lanes;n&=t.pendingLanes,e|=n,r.lanes=e,Dv(t,e)}}var dp={readContext:Fa,useCallback:ss,useContext:ss,useEffect:ss,useImperativeHandle:ss,useInsertionEffect:ss,useLayoutEffect:ss,useMemo:ss,useReducer:ss,useRef:ss,useState:ss,useDebugValue:ss,useDeferredValue:ss,useTransition:ss,useMutableSource:ss,useSyncExternalStore:ss,useId:ss,unstable_isNewReconciler:!1},kA={readContext:Fa,useCallback:function(t,r){return yi().memoizedState=[t,r===void 0?null:r],t},useContext:Fa,useEffect:Rx,useImperativeHandle:function(t,r,e){return e=e!=null?e.concat([t]):null,j0(4194308,4,f6.bind(null,r,t),e)},useLayoutEffect:function(t,r){return j0(4194308,4,t,r)},useInsertionEffect:function(t,r){return j0(4,2,t,r)},useMemo:function(t,r){var e=yi();return r=r===void 0?null:r,t=t(),e.memoizedState=[t,r],t},useReducer:function(t,r,e){var n=yi();return r=e!==void 0?e(r):r,n.memoizedState=n.baseState=r,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:r},n.queue=t,t=t.dispatch=_A.bind(null,Qr,t),[n.memoizedState,t]},useRef:function(t){var r=yi();return t={current:t},r.memoizedState=t},useState:Dx,useDebugValue:Qv,useDeferredValue:function(t){return yi().memoizedState=t},useTransition:function(){var t=Dx(!1),r=t[0];return t=wA.bind(null,t[1]),yi().memoizedState=t,[r,t]},useMutableSource:function(){},useSyncExternalStore:function(t,r,e){var n=Qr,s=yi();if(Kr){if(e===void 0)throw Error(Dt(407));e=e()}else{if(e=r(),zn===null)throw Error(Dt(349));nc&30||n6(n,r,e)}s.memoizedState=e;var a={value:e,getSnapshot:r};return s.queue=a,Rx(a6.bind(null,n,a,t),[t]),n.flags|=2048,Dh(9,s6.bind(null,n,a,e,r),void 0,null),e},useId:function(){var t=yi(),r=zn.identifierPrefix;if(Kr){var e=Zi,n=Ji;e=(n&~(1<<32-ai(n)-1)).toString(32)+e,r=":"+r+"R"+e,e=Th++,0<e&&(r+="H"+e.toString(32)),r+=":"}else e=xA++,r=":"+r+"r"+e.toString(32)+":";return t.memoizedState=r},unstable_isNewReconciler:!1},EA={readContext:Fa,useCallback:d6,useContext:Fa,useEffect:Zv,useImperativeHandle:h6,useInsertionEffect:c6,useLayoutEffect:u6,useMemo:p6,useReducer:P1,useRef:l6,useState:function(){return P1(Nh)},useDebugValue:Qv,useDeferredValue:function(t){var r=ja();return m6(r,Rn.memoizedState,t)},useTransition:function(){var t=P1(Nh)[0],r=ja().memoizedState;return[t,r]},useMutableSource:t6,useSyncExternalStore:r6,useId:g6,unstable_isNewReconciler:!1},AA={readContext:Fa,useCallback:d6,useContext:Fa,useEffect:Zv,useImperativeHandle:h6,useInsertionEffect:c6,useLayoutEffect:u6,useMemo:p6,useReducer:O1,useRef:l6,useState:function(){return O1(Nh)},useDebugValue:Qv,useDeferredValue:function(t){var r=ja();return Rn===null?r.memoizedState=t:m6(r,Rn.memoizedState,t)},useTransition:function(){var t=O1(Nh)[0],r=ja().memoizedState;return[t,r]},useMutableSource:t6,useSyncExternalStore:r6,useId:g6,unstable_isNewReconciler:!1};function Ya(t,r){if(t&&t.defaultProps){r=en({},r),t=t.defaultProps;for(var e in t)r[e]===void 0&&(r[e]=t[e]);return r}return r}function i2(t,r,e,n){r=t.memoizedState,e=e(n,r),e=e==null?r:en({},r,e),t.memoizedState=e,t.lanes===0&&(t.updateQueue.baseState=e)}var Qp={isMounted:function(t){return(t=t._reactInternals)?uc(t)===t:!1},enqueueSetState:function(t,r,e){t=t._reactInternals;var n=Ps(),s=ul(t),a=to(n,s);a.payload=r,e!=null&&(a.callback=e),r=ll(t,a,s),r!==null&&(ii(r,t,s,n),M0(r,t,s))},enqueueReplaceState:function(t,r,e){t=t._reactInternals;var n=Ps(),s=ul(t),a=to(n,s);a.tag=1,a.payload=r,e!=null&&(a.callback=e),r=ll(t,a,s),r!==null&&(ii(r,t,s,n),M0(r,t,s))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var e=Ps(),n=ul(t),s=to(e,n);s.tag=2,r!=null&&(s.callback=r),r=ll(t,s,n),r!==null&&(ii(r,t,n,e),M0(r,t,n))}};function Px(t,r,e,n,s,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,i):r.prototype&&r.prototype.isPureReactComponent?!_h(e,n)||!_h(s,a):!0}function x6(t,r,e){var n=!1,s=ml,a=r.contextType;return typeof a=="object"&&a!==null?a=Fa(a):(s=Ks(r)?tc:ys.current,n=r.contextTypes,a=(n=n!=null)?Cu(t,s):ml),r=new r(e,a),t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Qp,t.stateNode=r,r._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),r}function Ox(t,r,e,n){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(e,n),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(e,n),r.state!==t&&Qp.enqueueReplaceState(r,r.state,null)}function o2(t,r,e,n){var s=t.stateNode;s.props=e,s.state=t.memoizedState,s.refs={},qv(t);var a=r.contextType;typeof a=="object"&&a!==null?s.context=Fa(a):(a=Ks(r)?tc:ys.current,s.context=Cu(t,a)),s.state=t.memoizedState,a=r.getDerivedStateFromProps,typeof a=="function"&&(i2(t,r,a,e),s.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(r=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),r!==s.state&&Qp.enqueueReplaceState(s,s.state,null),up(t,e,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ru(t,r){try{var e="",n=r;do e+=eE(n),n=n.return;while(n);var s=e}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:r,stack:s,digest:null}}function M1(t,r,e){return{value:t,source:null,stack:e??null,digest:r??null}}function l2(t,r){try{console.error(r.value)}catch(e){setTimeout(function(){throw e})}}var CA=typeof WeakMap=="function"?WeakMap:Map;function w6(t,r,e){e=to(-1,e),e.tag=3,e.payload={element:null};var n=r.value;return e.callback=function(){mp||(mp=!0,b2=n),l2(t,r)},e}function _6(t,r,e){e=to(-1,e),e.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=r.value;e.payload=function(){return n(s)},e.callback=function(){l2(t,r)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(e.callback=function(){l2(t,r),typeof n!="function"&&(cl===null?cl=new Set([this]):cl.add(this));var i=r.stack;this.componentDidCatch(r.value,{componentStack:i!==null?i:""})}),e}function Mx(t,r,e){var n=t.pingCache;if(n===null){n=t.pingCache=new CA;var s=new Set;n.set(r,s)}else s=n.get(r),s===void 0&&(s=new Set,n.set(r,s));s.has(e)||(s.add(e),t=UA.bind(null,t,r,e),r.then(t,t))}function Fx(t){do{var r;if((r=t.tag===13)&&(r=t.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return t;t=t.return}while(t!==null);return null}function jx(t,r,e,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===r?t.flags|=65536:(t.flags|=128,e.flags|=131072,e.flags&=-52805,e.tag===1&&(e.alternate===null?e.tag=17:(r=to(-1,1),r.tag=2,ll(e,r,1))),e.lanes|=1),t)}var TA=ho.ReactCurrentOwner,Gs=!1;function Ts(t,r,e,n){r.child=t===null?J4(r,null,e,n):Nu(r,t.child,e,n)}function Lx(t,r,e,n,s){e=e.render;var a=r.ref;return mu(r,s),n=Yv(t,r,e,n,a,s),e=Jv(),t!==null&&!Gs?(r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~s,lo(t,r,s)):(Kr&&e&&Iv(r),r.flags|=1,Ts(t,r,n,s),r.child)}function Ix(t,r,e,n,s){if(t===null){var a=e.type;return typeof a=="function"&&!ob(a)&&a.defaultProps===void 0&&e.compare===null&&e.defaultProps===void 0?(r.tag=15,r.type=a,S6(t,r,a,n,s)):(t=$0(e.type,null,n,r,r.mode,s),t.ref=r.ref,t.return=r,r.child=t)}if(a=t.child,!(t.lanes&s)){var i=a.memoizedProps;if(e=e.compare,e=e!==null?e:_h,e(i,n)&&t.ref===r.ref)return lo(t,r,s)}return r.flags|=1,t=fl(a,n),t.ref=r.ref,t.return=r,r.child=t}function S6(t,r,e,n,s){if(t!==null){var a=t.memoizedProps;if(_h(a,n)&&t.ref===r.ref)if(Gs=!1,r.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(Gs=!0);else return r.lanes=t.lanes,lo(t,r,s)}return c2(t,r,e,n,s)}function k6(t,r,e){var n=r.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},Hr(lu,ia),ia|=e;else{if(!(e&1073741824))return t=a!==null?a.baseLanes|e:e,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:t,cachePool:null,transitions:null},r.updateQueue=null,Hr(lu,ia),ia|=t,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:e,Hr(lu,ia),ia|=n}else a!==null?(n=a.baseLanes|e,r.memoizedState=null):n=e,Hr(lu,ia),ia|=n;return Ts(t,r,s,e),r.child}function E6(t,r){var e=r.ref;(t===null&&e!==null||t!==null&&t.ref!==e)&&(r.flags|=512,r.flags|=2097152)}function c2(t,r,e,n,s){var a=Ks(e)?tc:ys.current;return a=Cu(r,a),mu(r,s),e=Yv(t,r,e,n,a,s),n=Jv(),t!==null&&!Gs?(r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~s,lo(t,r,s)):(Kr&&n&&Iv(r),r.flags|=1,Ts(t,r,e,s),r.child)}function Bx(t,r,e,n,s){if(Ks(e)){var a=!0;ap(r)}else a=!1;if(mu(r,s),r.stateNode===null)L0(t,r),x6(r,e,n),o2(r,e,n,s),n=!0;else if(t===null){var i=r.stateNode,o=r.memoizedProps;i.props=o;var l=i.context,c=e.contextType;typeof c=="object"&&c!==null?c=Fa(c):(c=Ks(e)?tc:ys.current,c=Cu(r,c));var u=e.getDerivedStateFromProps,d=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Ox(r,i,n,c),qo=!1;var h=r.memoizedState;i.state=h,up(r,n,i,s),l=r.memoizedState,o!==n||h!==l||Xs.current||qo?(typeof u=="function"&&(i2(r,e,u,n),l=r.memoizedState),(o=qo||Px(r,e,o,n,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(r.flags|=4194308)):(typeof i.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=n,r.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(r.flags|=4194308),n=!1)}else{i=r.stateNode,Q4(t,r),o=r.memoizedProps,c=r.type===r.elementType?o:Ya(r.type,o),i.props=c,d=r.pendingProps,h=i.context,l=e.contextType,typeof l=="object"&&l!==null?l=Fa(l):(l=Ks(e)?tc:ys.current,l=Cu(r,l));var f=e.getDerivedStateFromProps;(u=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||h!==l)&&Ox(r,i,n,l),qo=!1,h=r.memoizedState,i.state=h,up(r,n,i,s);var g=r.memoizedState;o!==d||h!==g||Xs.current||qo?(typeof f=="function"&&(i2(r,e,f,n),g=r.memoizedState),(c=qo||Px(r,e,c,n,h,g,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,g,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,g,l)),typeof i.componentDidUpdate=="function"&&(r.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(r.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(r.flags|=1024),r.memoizedProps=n,r.memoizedState=g),i.props=n,i.state=g,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(r.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(r.flags|=1024),n=!1)}return u2(t,r,e,n,a,s)}function u2(t,r,e,n,s,a){E6(t,r);var i=(r.flags&128)!==0;if(!n&&!i)return s&&kx(r,e,!1),lo(t,r,a);n=r.stateNode,TA.current=r;var o=i&&typeof e.getDerivedStateFromError!="function"?null:n.render();return r.flags|=1,t!==null&&i?(r.child=Nu(r,t.child,null,a),r.child=Nu(r,null,o,a)):Ts(t,r,o,a),r.memoizedState=n.state,s&&kx(r,e,!0),r.child}function A6(t){var r=t.stateNode;r.pendingContext?Sx(t,r.pendingContext,r.pendingContext!==r.context):r.context&&Sx(t,r.context,!1),Wv(t,r.containerInfo)}function $x(t,r,e,n,s){return Tu(),$v(s),r.flags|=256,Ts(t,r,e,n),r.child}var f2={dehydrated:null,treeContext:null,retryLane:0};function h2(t){return{baseLanes:t,cachePool:null,transitions:null}}function C6(t,r,e){var n=r.pendingProps,s=Zr.current,a=!1,i=(r.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(a=!0,r.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Hr(Zr,s&1),t===null)return s2(r),t=r.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(r.mode&1?t.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(i=n.children,t=n.fallback,a?(n=r.mode,a=r.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=rm(i,n,0,null),t=Jl(t,n,e,null),a.return=r,t.return=r,a.sibling=t,r.child=a,r.child.memoizedState=h2(e),r.memoizedState=f2,t):eb(r,i));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return NA(t,r,i,n,o,s,e);if(a){a=n.fallback,i=r.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&r.child!==s?(n=r.child,n.childLanes=0,n.pendingProps=l,r.deletions=null):(n=fl(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=fl(o,a):(a=Jl(a,i,e,null),a.flags|=2),a.return=r,n.return=r,n.sibling=a,r.child=n,n=a,a=r.child,i=t.child.memoizedState,i=i===null?h2(e):{baseLanes:i.baseLanes|e,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~e,r.memoizedState=f2,n}return a=t.child,t=a.sibling,n=fl(a,{mode:"visible",children:n.children}),!(r.mode&1)&&(n.lanes=e),n.return=r,n.sibling=null,t!==null&&(e=r.deletions,e===null?(r.deletions=[t],r.flags|=16):e.push(t)),r.child=n,r.memoizedState=null,n}function eb(t,r){return r=rm({mode:"visible",children:r},t.mode,0,null),r.return=t,t.child=r}function e0(t,r,e,n){return n!==null&&$v(n),Nu(r,t.child,null,e),t=eb(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function NA(t,r,e,n,s,a,i){if(e)return r.flags&256?(r.flags&=-257,n=M1(Error(Dt(422))),e0(t,r,i,n)):r.memoizedState!==null?(r.child=t.child,r.flags|=128,null):(a=n.fallback,s=r.mode,n=rm({mode:"visible",children:n.children},s,0,null),a=Jl(a,s,i,null),a.flags|=2,n.return=r,a.return=r,n.sibling=a,r.child=n,r.mode&1&&Nu(r,t.child,null,i),r.child.memoizedState=h2(i),r.memoizedState=f2,a);if(!(r.mode&1))return e0(t,r,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Dt(419)),n=M1(a,n,void 0),e0(t,r,i,n)}if(o=(i&t.childLanes)!==0,Gs||o){if(n=zn,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,oo(t,s),ii(n,t,s,-1))}return ib(),n=M1(Error(Dt(421))),e0(t,r,i,n)}return s.data==="$?"?(r.flags|=128,r.child=t.child,r=HA.bind(null,t),s._reactRetry=r,null):(t=a.treeContext,ca=ol(s.nextSibling),fa=r,Kr=!0,ei=null,t!==null&&(Da[Ra++]=Ji,Da[Ra++]=Zi,Da[Ra++]=rc,Ji=t.id,Zi=t.overflow,rc=r),r=eb(r,n.children),r.flags|=4096,r)}function Ux(t,r,e){t.lanes|=r;var n=t.alternate;n!==null&&(n.lanes|=r),a2(t.return,r,e)}function F1(t,r,e,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:n,tail:e,tailMode:s}:(a.isBackwards=r,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=e,a.tailMode=s)}function T6(t,r,e){var n=r.pendingProps,s=n.revealOrder,a=n.tail;if(Ts(t,r,n.children,e),n=Zr.current,n&2)n=n&1|2,r.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ux(t,e,r);else if(t.tag===19)Ux(t,e,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Hr(Zr,n),!(r.mode&1))r.memoizedState=null;else switch(s){case"forwards":for(e=r.child,s=null;e!==null;)t=e.alternate,t!==null&&fp(t)===null&&(s=e),e=e.sibling;e=s,e===null?(s=r.child,r.child=null):(s=e.sibling,e.sibling=null),F1(r,!1,s,e,a);break;case"backwards":for(e=null,s=r.child,r.child=null;s!==null;){if(t=s.alternate,t!==null&&fp(t)===null){r.child=s;break}t=s.sibling,s.sibling=e,e=s,s=t}F1(r,!0,e,null,a);break;case"together":F1(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function L0(t,r){!(r.mode&1)&&t!==null&&(t.alternate=null,r.alternate=null,r.flags|=2)}function lo(t,r,e){if(t!==null&&(r.dependencies=t.dependencies),sc|=r.lanes,!(e&r.childLanes))return null;if(t!==null&&r.child!==t.child)throw Error(Dt(153));if(r.child!==null){for(t=r.child,e=fl(t,t.pendingProps),r.child=e,e.return=r;t.sibling!==null;)t=t.sibling,e=e.sibling=fl(t,t.pendingProps),e.return=r;e.sibling=null}return r.child}function DA(t,r,e){switch(r.tag){case 3:A6(r),Tu();break;case 5:e6(r);break;case 1:Ks(r.type)&&ap(r);break;case 4:Wv(r,r.stateNode.containerInfo);break;case 10:var n=r.type._context,s=r.memoizedProps.value;Hr(lp,n._currentValue),n._currentValue=s;break;case 13:if(n=r.memoizedState,n!==null)return n.dehydrated!==null?(Hr(Zr,Zr.current&1),r.flags|=128,null):e&r.child.childLanes?C6(t,r,e):(Hr(Zr,Zr.current&1),t=lo(t,r,e),t!==null?t.sibling:null);Hr(Zr,Zr.current&1);break;case 19:if(n=(e&r.childLanes)!==0,t.flags&128){if(n)return T6(t,r,e);r.flags|=128}if(s=r.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Hr(Zr,Zr.current),n)break;return null;case 22:case 23:return r.lanes=0,k6(t,r,e)}return lo(t,r,e)}var N6,d2,D6,R6;N6=function(t,r){for(var e=r.child;e!==null;){if(e.tag===5||e.tag===6)t.appendChild(e.stateNode);else if(e.tag!==4&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return;e=e.return}e.sibling.return=e.return,e=e.sibling}};d2=function(){};D6=function(t,r,e,n){var s=t.memoizedProps;if(s!==n){t=r.stateNode,Xl(Ai.current);var a=null;switch(e){case"input":s=Fg(t,s),n=Fg(t,n),a=[];break;case"select":s=en({},s,{value:void 0}),n=en({},n,{value:void 0}),a=[];break;case"textarea":s=Ig(t,s),n=Ig(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=np)}$g(e,n);var i;e=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(i in o)o.hasOwnProperty(i)&&(e||(e={}),e[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(mh.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(e||(e={}),e[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(e||(e={}),e[i]=l[i])}else e||(a||(a=[]),a.push(c,e)),e=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(mh.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Vr("scroll",t),a||o===l||(a=[])):(a=a||[]).push(c,l))}e&&(a=a||[]).push("style",e);var c=a;(r.updateQueue=c)&&(r.flags|=4)}};R6=function(t,r,e,n){e!==n&&(r.flags|=4)};function Tf(t,r){if(!Kr)switch(t.tailMode){case"hidden":r=t.tail;for(var e=null;r!==null;)r.alternate!==null&&(e=r),r=r.sibling;e===null?t.tail=null:e.sibling=null;break;case"collapsed":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function as(t){var r=t.alternate!==null&&t.alternate.child===t.child,e=0,n=0;if(r)for(var s=t.child;s!==null;)e|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)e|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=e,r}function RA(t,r,e){var n=r.pendingProps;switch(Bv(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return as(r),null;case 1:return Ks(r.type)&&sp(),as(r),null;case 3:return n=r.stateNode,Du(),Wr(Xs),Wr(ys),Xv(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Zd(r)?r.flags|=4:t===null||t.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,ei!==null&&(w2(ei),ei=null))),d2(t,r),as(r),null;case 5:Gv(r);var s=Xl(Ch.current);if(e=r.type,t!==null&&r.stateNode!=null)D6(t,r,e,n,s),t.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!n){if(r.stateNode===null)throw Error(Dt(166));return as(r),null}if(t=Xl(Ai.current),Zd(r)){n=r.stateNode,e=r.type;var a=r.memoizedProps;switch(n[Si]=r,n[Eh]=a,t=(r.mode&1)!==0,e){case"dialog":Vr("cancel",n),Vr("close",n);break;case"iframe":case"object":case"embed":Vr("load",n);break;case"video":case"audio":for(s=0;s<If.length;s++)Vr(If[s],n);break;case"source":Vr("error",n);break;case"img":case"image":case"link":Vr("error",n),Vr("load",n);break;case"details":Vr("toggle",n);break;case"input":Yy(n,a),Vr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Vr("invalid",n);break;case"textarea":Zy(n,a),Vr("invalid",n)}$g(e,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Jd(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Jd(n.textContent,o,t),s=["children",""+o]):mh.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Vr("scroll",n)}switch(e){case"input":zd(n),Jy(n,a,!0);break;case"textarea":zd(n),Qy(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=np)}n=s,r.updateQueue=n,n!==null&&(r.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=a4(e)),t==="http://www.w3.org/1999/xhtml"?e==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(e,{is:n.is}):(t=i.createElement(e),e==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,e),t[Si]=r,t[Eh]=n,N6(t,r,!1,!1),r.stateNode=t;e:{switch(i=Ug(e,n),e){case"dialog":Vr("cancel",t),Vr("close",t),s=n;break;case"iframe":case"object":case"embed":Vr("load",t),s=n;break;case"video":case"audio":for(s=0;s<If.length;s++)Vr(If[s],t);s=n;break;case"source":Vr("error",t),s=n;break;case"img":case"image":case"link":Vr("error",t),Vr("load",t),s=n;break;case"details":Vr("toggle",t),s=n;break;case"input":Yy(t,n),s=Fg(t,n),Vr("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=en({},n,{value:void 0}),Vr("invalid",t);break;case"textarea":Zy(t,n),s=Ig(t,n),Vr("invalid",t);break;default:s=n}$g(e,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?l4(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&i4(t,l)):a==="children"?typeof l=="string"?(e!=="textarea"||l!=="")&&gh(t,l):typeof l=="number"&&gh(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(mh.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Vr("scroll",t):l!=null&&kv(t,a,l,i))}switch(e){case"input":zd(t),Jy(t,n,!1);break;case"textarea":zd(t),Qy(t);break;case"option":n.value!=null&&t.setAttribute("value",""+pl(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?fu(t,!!n.multiple,a,!1):n.defaultValue!=null&&fu(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=np)}switch(e){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return as(r),null;case 6:if(t&&r.stateNode!=null)R6(t,r,t.memoizedProps,n);else{if(typeof n!="string"&&r.stateNode===null)throw Error(Dt(166));if(e=Xl(Ch.current),Xl(Ai.current),Zd(r)){if(n=r.stateNode,e=r.memoizedProps,n[Si]=r,(a=n.nodeValue!==e)&&(t=fa,t!==null))switch(t.tag){case 3:Jd(n.nodeValue,e,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Jd(n.nodeValue,e,(t.mode&1)!==0)}a&&(r.flags|=4)}else n=(e.nodeType===9?e:e.ownerDocument).createTextNode(n),n[Si]=r,r.stateNode=n}return as(r),null;case 13:if(Wr(Zr),n=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Kr&&ca!==null&&r.mode&1&&!(r.flags&128))K4(),Tu(),r.flags|=98560,a=!1;else if(a=Zd(r),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(Dt(318));if(a=r.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Dt(317));a[Si]=r}else Tu(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;as(r),a=!1}else ei!==null&&(w2(ei),ei=null),a=!0;if(!a)return r.flags&65536?r:null}return r.flags&128?(r.lanes=e,r):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(r.child.flags|=8192,r.mode&1&&(t===null||Zr.current&1?On===0&&(On=3):ib())),r.updateQueue!==null&&(r.flags|=4),as(r),null);case 4:return Du(),d2(t,r),t===null&&Sh(r.stateNode.containerInfo),as(r),null;case 10:return zv(r.type._context),as(r),null;case 17:return Ks(r.type)&&sp(),as(r),null;case 19:if(Wr(Zr),a=r.memoizedState,a===null)return as(r),null;if(n=(r.flags&128)!==0,i=a.rendering,i===null)if(n)Tf(a,!1);else{if(On!==0||t!==null&&t.flags&128)for(t=r.child;t!==null;){if(i=fp(t),i!==null){for(r.flags|=128,Tf(a,!1),n=i.updateQueue,n!==null&&(r.updateQueue=n,r.flags|=4),r.subtreeFlags=0,n=e,e=r.child;e!==null;)a=e,t=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e=e.sibling;return Hr(Zr,Zr.current&1|2),r.child}t=t.sibling}a.tail!==null&&pn()>Pu&&(r.flags|=128,n=!0,Tf(a,!1),r.lanes=4194304)}else{if(!n)if(t=fp(i),t!==null){if(r.flags|=128,n=!0,e=t.updateQueue,e!==null&&(r.updateQueue=e,r.flags|=4),Tf(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Kr)return as(r),null}else 2*pn()-a.renderingStartTime>Pu&&e!==1073741824&&(r.flags|=128,n=!0,Tf(a,!1),r.lanes=4194304);a.isBackwards?(i.sibling=r.child,r.child=i):(e=a.last,e!==null?e.sibling=i:r.child=i,a.last=i)}return a.tail!==null?(r=a.tail,a.rendering=r,a.tail=r.sibling,a.renderingStartTime=pn(),r.sibling=null,e=Zr.current,Hr(Zr,n?e&1|2:e&1),r):(as(r),null);case 22:case 23:return ab(),n=r.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(r.flags|=8192),n&&r.mode&1?ia&1073741824&&(as(r),r.subtreeFlags&6&&(r.flags|=8192)):as(r),null;case 24:return null;case 25:return null}throw Error(Dt(156,r.tag))}function PA(t,r){switch(Bv(r),r.tag){case 1:return Ks(r.type)&&sp(),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return Du(),Wr(Xs),Wr(ys),Xv(),t=r.flags,t&65536&&!(t&128)?(r.flags=t&-65537|128,r):null;case 5:return Gv(r),null;case 13:if(Wr(Zr),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(Dt(340));Tu()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return Wr(Zr),null;case 4:return Du(),null;case 10:return zv(r.type._context),null;case 22:case 23:return ab(),null;case 24:return null;default:return null}}var t0=!1,ps=!1,OA=typeof WeakSet=="function"?WeakSet:Set,Ut=null;function ou(t,r){var e=t.ref;if(e!==null)if(typeof e=="function")try{e(null)}catch(n){sn(t,r,n)}else e.current=null}function p2(t,r,e){try{e()}catch(n){sn(t,r,n)}}var Hx=!1;function MA(t,r){if(Jg=ep,t=j4(),Lv(t)){if("selectionStart"in t)var e={start:t.selectionStart,end:t.selectionEnd};else e:{e=(e=t.ownerDocument)&&e.defaultView||window;var n=e.getSelection&&e.getSelection();if(n&&n.rangeCount!==0){e=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{e.nodeType,a.nodeType}catch{e=null;break e}var i=0,o=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==e||s!==0&&d.nodeType!==3||(o=i+s),d!==a||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===e&&++c===s&&(o=i),h===a&&++u===n&&(l=i),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}e=o===-1||l===-1?null:{start:o,end:l}}else e=null}e=e||{start:0,end:0}}else e=null;for(Zg={focusedElem:t,selectionRange:e},ep=!1,Ut=r;Ut!==null;)if(r=Ut,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,Ut=t;else for(;Ut!==null;){r=Ut;try{var g=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,p=g.memoizedState,v=r.stateNode,b=v.getSnapshotBeforeUpdate(r.elementType===r.type?m:Ya(r.type,m),p);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=r.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Dt(163))}}catch(k){sn(r,r.return,k)}if(t=r.sibling,t!==null){t.return=r.return,Ut=t;break}Ut=r.return}return g=Hx,Hx=!1,g}function Jf(t,r,e){var n=r.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&p2(r,e,a)}s=s.next}while(s!==n)}}function em(t,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var e=r=r.next;do{if((e.tag&t)===t){var n=e.create;e.destroy=n()}e=e.next}while(e!==r)}}function m2(t){var r=t.ref;if(r!==null){var e=t.stateNode;switch(t.tag){case 5:t=e;break;default:t=e}typeof r=="function"?r(t):r.current=t}}function P6(t){var r=t.alternate;r!==null&&(t.alternate=null,P6(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&(delete r[Si],delete r[Eh],delete r[t2],delete r[gA],delete r[vA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function O6(t){return t.tag===5||t.tag===3||t.tag===4}function zx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||O6(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function g2(t,r,e){var n=t.tag;if(n===5||n===6)t=t.stateNode,r?e.nodeType===8?e.parentNode.insertBefore(t,r):e.insertBefore(t,r):(e.nodeType===8?(r=e.parentNode,r.insertBefore(t,e)):(r=e,r.appendChild(t)),e=e._reactRootContainer,e!=null||r.onclick!==null||(r.onclick=np));else if(n!==4&&(t=t.child,t!==null))for(g2(t,r,e),t=t.sibling;t!==null;)g2(t,r,e),t=t.sibling}function v2(t,r,e){var n=t.tag;if(n===5||n===6)t=t.stateNode,r?e.insertBefore(t,r):e.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(v2(t,r,e),t=t.sibling;t!==null;)v2(t,r,e),t=t.sibling}var Kn=null,Za=!1;function jo(t,r,e){for(e=e.child;e!==null;)M6(t,r,e),e=e.sibling}function M6(t,r,e){if(Ei&&typeof Ei.onCommitFiberUnmount=="function")try{Ei.onCommitFiberUnmount(Wp,e)}catch{}switch(e.tag){case 5:ps||ou(e,r);case 6:var n=Kn,s=Za;Kn=null,jo(t,r,e),Kn=n,Za=s,Kn!==null&&(Za?(t=Kn,e=e.stateNode,t.nodeType===8?t.parentNode.removeChild(e):t.removeChild(e)):Kn.removeChild(e.stateNode));break;case 18:Kn!==null&&(Za?(t=Kn,e=e.stateNode,t.nodeType===8?T1(t.parentNode,e):t.nodeType===1&&T1(t,e),xh(t)):T1(Kn,e.stateNode));break;case 4:n=Kn,s=Za,Kn=e.stateNode.containerInfo,Za=!0,jo(t,r,e),Kn=n,Za=s;break;case 0:case 11:case 14:case 15:if(!ps&&(n=e.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&p2(e,r,i),s=s.next}while(s!==n)}jo(t,r,e);break;case 1:if(!ps&&(ou(e,r),n=e.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=e.memoizedProps,n.state=e.memoizedState,n.componentWillUnmount()}catch(o){sn(e,r,o)}jo(t,r,e);break;case 21:jo(t,r,e);break;case 22:e.mode&1?(ps=(n=ps)||e.memoizedState!==null,jo(t,r,e),ps=n):jo(t,r,e);break;default:jo(t,r,e)}}function Vx(t){var r=t.updateQueue;if(r!==null){t.updateQueue=null;var e=t.stateNode;e===null&&(e=t.stateNode=new OA),r.forEach(function(n){var s=zA.bind(null,t,n);e.has(n)||(e.add(n),n.then(s,s))})}}function Va(t,r){var e=r.deletions;if(e!==null)for(var n=0;n<e.length;n++){var s=e[n];try{var a=t,i=r,o=i;e:for(;o!==null;){switch(o.tag){case 5:Kn=o.stateNode,Za=!1;break e;case 3:Kn=o.stateNode.containerInfo,Za=!0;break e;case 4:Kn=o.stateNode.containerInfo,Za=!0;break e}o=o.return}if(Kn===null)throw Error(Dt(160));M6(a,i,s),Kn=null,Za=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){sn(s,r,c)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)F6(r,t),r=r.sibling}function F6(t,r){var e=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Va(r,t),mi(t),n&4){try{Jf(3,t,t.return),em(3,t)}catch(m){sn(t,t.return,m)}try{Jf(5,t,t.return)}catch(m){sn(t,t.return,m)}}break;case 1:Va(r,t),mi(t),n&512&&e!==null&&ou(e,e.return);break;case 5:if(Va(r,t),mi(t),n&512&&e!==null&&ou(e,e.return),t.flags&32){var s=t.stateNode;try{gh(s,"")}catch(m){sn(t,t.return,m)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,i=e!==null?e.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&n4(s,a),Ug(o,i);var c=Ug(o,a);for(i=0;i<l.length;i+=2){var u=l[i],d=l[i+1];u==="style"?l4(s,d):u==="dangerouslySetInnerHTML"?i4(s,d):u==="children"?gh(s,d):kv(s,u,d,c)}switch(o){case"input":jg(s,a);break;case"textarea":s4(s,a);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var f=a.value;f!=null?fu(s,!!a.multiple,f,!1):h!==!!a.multiple&&(a.defaultValue!=null?fu(s,!!a.multiple,a.defaultValue,!0):fu(s,!!a.multiple,a.multiple?[]:"",!1))}s[Eh]=a}catch(m){sn(t,t.return,m)}}break;case 6:if(Va(r,t),mi(t),n&4){if(t.stateNode===null)throw Error(Dt(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(m){sn(t,t.return,m)}}break;case 3:if(Va(r,t),mi(t),n&4&&e!==null&&e.memoizedState.isDehydrated)try{xh(r.containerInfo)}catch(m){sn(t,t.return,m)}break;case 4:Va(r,t),mi(t);break;case 13:Va(r,t),mi(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(nb=pn())),n&4&&Vx(t);break;case 22:if(u=e!==null&&e.memoizedState!==null,t.mode&1?(ps=(c=ps)||u,Va(r,t),ps=c):Va(r,t),mi(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Ut=t,u=t.child;u!==null;){for(d=Ut=u;Ut!==null;){switch(h=Ut,f=h.child,h.tag){case 0:case 11:case 14:case 15:Jf(4,h,h.return);break;case 1:ou(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,e=h.return;try{r=n,g.props=r.memoizedProps,g.state=r.memoizedState,g.componentWillUnmount()}catch(m){sn(n,e,m)}}break;case 5:ou(h,h.return);break;case 22:if(h.memoizedState!==null){Wx(d);continue}}f!==null?(f.return=h,Ut=f):Wx(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,c?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=o4("display",i))}catch(m){sn(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){sn(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Va(r,t),mi(t),n&4&&Vx(t);break;case 21:break;default:Va(r,t),mi(t)}}function mi(t){var r=t.flags;if(r&2){try{e:{for(var e=t.return;e!==null;){if(O6(e)){var n=e;break e}e=e.return}throw Error(Dt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(gh(s,""),n.flags&=-33);var a=zx(t);v2(t,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=zx(t);g2(t,o,i);break;default:throw Error(Dt(161))}}catch(l){sn(t,t.return,l)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function FA(t,r,e){Ut=t,j6(t)}function j6(t,r,e){for(var n=(t.mode&1)!==0;Ut!==null;){var s=Ut,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||t0;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||ps;o=t0;var c=ps;if(t0=i,(ps=l)&&!c)for(Ut=s;Ut!==null;)i=Ut,l=i.child,i.tag===22&&i.memoizedState!==null?Gx(s):l!==null?(l.return=i,Ut=l):Gx(s);for(;a!==null;)Ut=a,j6(a),a=a.sibling;Ut=s,t0=o,ps=c}qx(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Ut=a):qx(t)}}function qx(t){for(;Ut!==null;){var r=Ut;if(r.flags&8772){var e=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:ps||em(5,r);break;case 1:var n=r.stateNode;if(r.flags&4&&!ps)if(e===null)n.componentDidMount();else{var s=r.elementType===r.type?e.memoizedProps:Ya(r.type,e.memoizedProps);n.componentDidUpdate(s,e.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=r.updateQueue;a!==null&&Nx(r,a,n);break;case 3:var i=r.updateQueue;if(i!==null){if(e=null,r.child!==null)switch(r.child.tag){case 5:e=r.child.stateNode;break;case 1:e=r.child.stateNode}Nx(r,i,e)}break;case 5:var o=r.stateNode;if(e===null&&r.flags&4){e=o;var l=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&e.focus();break;case"img":l.src&&(e.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var c=r.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&xh(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Dt(163))}ps||r.flags&512&&m2(r)}catch(h){sn(r,r.return,h)}}if(r===t){Ut=null;break}if(e=r.sibling,e!==null){e.return=r.return,Ut=e;break}Ut=r.return}}function Wx(t){for(;Ut!==null;){var r=Ut;if(r===t){Ut=null;break}var e=r.sibling;if(e!==null){e.return=r.return,Ut=e;break}Ut=r.return}}function Gx(t){for(;Ut!==null;){var r=Ut;try{switch(r.tag){case 0:case 11:case 15:var e=r.return;try{em(4,r)}catch(l){sn(r,e,l)}break;case 1:var n=r.stateNode;if(typeof n.componentDidMount=="function"){var s=r.return;try{n.componentDidMount()}catch(l){sn(r,s,l)}}var a=r.return;try{m2(r)}catch(l){sn(r,a,l)}break;case 5:var i=r.return;try{m2(r)}catch(l){sn(r,i,l)}}}catch(l){sn(r,r.return,l)}if(r===t){Ut=null;break}var o=r.sibling;if(o!==null){o.return=r.return,Ut=o;break}Ut=r.return}}var jA=Math.ceil,pp=ho.ReactCurrentDispatcher,tb=ho.ReactCurrentOwner,Oa=ho.ReactCurrentBatchConfig,Ar=0,zn=null,Cn=null,Zn=0,ia=0,lu=wl(0),On=0,Rh=null,sc=0,tm=0,rb=0,Zf=null,qs=null,nb=0,Pu=1/0,Xi=null,mp=!1,b2=null,cl=null,r0=!1,Qo=null,gp=0,Qf=0,y2=null,I0=-1,B0=0;function Ps(){return Ar&6?pn():I0!==-1?I0:I0=pn()}function ul(t){return t.mode&1?Ar&2&&Zn!==0?Zn&-Zn:yA.transition!==null?(B0===0&&(B0=x4()),B0):(t=Or,t!==0||(t=window.event,t=t===void 0?16:C4(t.type)),t):1}function ii(t,r,e,n){if(50<Qf)throw Qf=0,y2=null,Error(Dt(185));Kh(t,e,n),(!(Ar&2)||t!==zn)&&(t===zn&&(!(Ar&2)&&(tm|=e),On===4&&Ko(t,Zn)),Ys(t,n),e===1&&Ar===0&&!(r.mode&1)&&(Pu=pn()+500,Jp&&_l()))}function Ys(t,r){var e=t.callbackNode;yE(t,r);var n=Q0(t,t===zn?Zn:0);if(n===0)e!==null&&rx(e),t.callbackNode=null,t.callbackPriority=0;else if(r=n&-n,t.callbackPriority!==r){if(e!=null&&rx(e),r===1)t.tag===0?bA(Xx.bind(null,t)):W4(Xx.bind(null,t)),pA(function(){!(Ar&6)&&_l()}),e=null;else{switch(w4(n)){case 1:e=Nv;break;case 4:e=b4;break;case 16:e=Z0;break;case 536870912:e=y4;break;default:e=Z0}e=V6(e,L6.bind(null,t))}t.callbackPriority=r,t.callbackNode=e}}function L6(t,r){if(I0=-1,B0=0,Ar&6)throw Error(Dt(327));var e=t.callbackNode;if(gu()&&t.callbackNode!==e)return null;var n=Q0(t,t===zn?Zn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||r)r=vp(t,n);else{r=n;var s=Ar;Ar|=2;var a=B6();(zn!==t||Zn!==r)&&(Xi=null,Pu=pn()+500,Yl(t,r));do try{BA();break}catch(o){I6(t,o)}while(!0);Hv(),pp.current=a,Ar=s,Cn!==null?r=0:(zn=null,Zn=0,r=On)}if(r!==0){if(r===2&&(s=Wg(t),s!==0&&(n=s,r=x2(t,s))),r===1)throw e=Rh,Yl(t,0),Ko(t,n),Ys(t,pn()),e;if(r===6)Ko(t,n);else{if(s=t.current.alternate,!(n&30)&&!LA(s)&&(r=vp(t,n),r===2&&(a=Wg(t),a!==0&&(n=a,r=x2(t,a))),r===1))throw e=Rh,Yl(t,0),Ko(t,n),Ys(t,pn()),e;switch(t.finishedWork=s,t.finishedLanes=n,r){case 0:case 1:throw Error(Dt(345));case 2:Bl(t,qs,Xi);break;case 3:if(Ko(t,n),(n&130023424)===n&&(r=nb+500-pn(),10<r)){if(Q0(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Ps(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=e2(Bl.bind(null,t,qs,Xi),r);break}Bl(t,qs,Xi);break;case 4:if(Ko(t,n),(n&4194240)===n)break;for(r=t.eventTimes,s=-1;0<n;){var i=31-ai(n);a=1<<i,i=r[i],i>s&&(s=i),n&=~a}if(n=s,n=pn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*jA(n/1960))-n,10<n){t.timeoutHandle=e2(Bl.bind(null,t,qs,Xi),n);break}Bl(t,qs,Xi);break;case 5:Bl(t,qs,Xi);break;default:throw Error(Dt(329))}}}return Ys(t,pn()),t.callbackNode===e?L6.bind(null,t):null}function x2(t,r){var e=Zf;return t.current.memoizedState.isDehydrated&&(Yl(t,r).flags|=256),t=vp(t,r),t!==2&&(r=qs,qs=e,r!==null&&w2(r)),t}function w2(t){qs===null?qs=t:qs.push.apply(qs,t)}function LA(t){for(var r=t;;){if(r.flags&16384){var e=r.updateQueue;if(e!==null&&(e=e.stores,e!==null))for(var n=0;n<e.length;n++){var s=e[n],a=s.getSnapshot;s=s.value;try{if(!li(a(),s))return!1}catch{return!1}}}if(e=r.child,r.subtreeFlags&16384&&e!==null)e.return=r,r=e;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ko(t,r){for(r&=~rb,r&=~tm,t.suspendedLanes|=r,t.pingedLanes&=~r,t=t.expirationTimes;0<r;){var e=31-ai(r),n=1<<e;t[e]=-1,r&=~n}}function Xx(t){if(Ar&6)throw Error(Dt(327));gu();var r=Q0(t,0);if(!(r&1))return Ys(t,pn()),null;var e=vp(t,r);if(t.tag!==0&&e===2){var n=Wg(t);n!==0&&(r=n,e=x2(t,n))}if(e===1)throw e=Rh,Yl(t,0),Ko(t,r),Ys(t,pn()),e;if(e===6)throw Error(Dt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=r,Bl(t,qs,Xi),Ys(t,pn()),null}function sb(t,r){var e=Ar;Ar|=1;try{return t(r)}finally{Ar=e,Ar===0&&(Pu=pn()+500,Jp&&_l())}}function ac(t){Qo!==null&&Qo.tag===0&&!(Ar&6)&&gu();var r=Ar;Ar|=1;var e=Oa.transition,n=Or;try{if(Oa.transition=null,Or=1,t)return t()}finally{Or=n,Oa.transition=e,Ar=r,!(Ar&6)&&_l()}}function ab(){ia=lu.current,Wr(lu)}function Yl(t,r){t.finishedWork=null,t.finishedLanes=0;var e=t.timeoutHandle;if(e!==-1&&(t.timeoutHandle=-1,dA(e)),Cn!==null)for(e=Cn.return;e!==null;){var n=e;switch(Bv(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&sp();break;case 3:Du(),Wr(Xs),Wr(ys),Xv();break;case 5:Gv(n);break;case 4:Du();break;case 13:Wr(Zr);break;case 19:Wr(Zr);break;case 10:zv(n.type._context);break;case 22:case 23:ab()}e=e.return}if(zn=t,Cn=t=fl(t.current,null),Zn=ia=r,On=0,Rh=null,rb=tm=sc=0,qs=Zf=null,Gl!==null){for(r=0;r<Gl.length;r++)if(e=Gl[r],n=e.interleaved,n!==null){e.interleaved=null;var s=n.next,a=e.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}e.pending=n}Gl=null}return t}function I6(t,r){do{var e=Cn;try{if(Hv(),F0.current=dp,hp){for(var n=Qr.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}hp=!1}if(nc=0,Un=Rn=Qr=null,Yf=!1,Th=0,tb.current=null,e===null||e.return===null){On=1,Rh=r,Cn=null;break}e:{var a=t,i=e.return,o=e,l=r;if(r=Zn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Fx(i);if(f!==null){f.flags&=-257,jx(f,i,o,a,r),f.mode&1&&Mx(a,c,r),r=f,l=c;var g=r.updateQueue;if(g===null){var m=new Set;m.add(l),r.updateQueue=m}else g.add(l);break e}else{if(!(r&1)){Mx(a,c,r),ib();break e}l=Error(Dt(426))}}else if(Kr&&o.mode&1){var p=Fx(i);if(p!==null){!(p.flags&65536)&&(p.flags|=256),jx(p,i,o,a,r),$v(Ru(l,o));break e}}a=l=Ru(l,o),On!==4&&(On=2),Zf===null?Zf=[a]:Zf.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,r&=-r,a.lanes|=r;var v=w6(a,l,r);Tx(a,v);break e;case 1:o=l;var b=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof b.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(cl===null||!cl.has(y)))){a.flags|=65536,r&=-r,a.lanes|=r;var k=_6(a,o,r);Tx(a,k);break e}}a=a.return}while(a!==null)}U6(e)}catch(N){r=N,Cn===e&&e!==null&&(Cn=e=e.return);continue}break}while(!0)}function B6(){var t=pp.current;return pp.current=dp,t===null?dp:t}function ib(){(On===0||On===3||On===2)&&(On=4),zn===null||!(sc&268435455)&&!(tm&268435455)||Ko(zn,Zn)}function vp(t,r){var e=Ar;Ar|=2;var n=B6();(zn!==t||Zn!==r)&&(Xi=null,Yl(t,r));do try{IA();break}catch(s){I6(t,s)}while(!0);if(Hv(),Ar=e,pp.current=n,Cn!==null)throw Error(Dt(261));return zn=null,Zn=0,On}function IA(){for(;Cn!==null;)$6(Cn)}function BA(){for(;Cn!==null&&!uE();)$6(Cn)}function $6(t){var r=z6(t.alternate,t,ia);t.memoizedProps=t.pendingProps,r===null?U6(t):Cn=r,tb.current=null}function U6(t){var r=t;do{var e=r.alternate;if(t=r.return,r.flags&32768){if(e=PA(e,r),e!==null){e.flags&=32767,Cn=e;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{On=6,Cn=null;return}}else if(e=RA(e,r,ia),e!==null){Cn=e;return}if(r=r.sibling,r!==null){Cn=r;return}Cn=r=t}while(r!==null);On===0&&(On=5)}function Bl(t,r,e){var n=Or,s=Oa.transition;try{Oa.transition=null,Or=1,$A(t,r,e,n)}finally{Oa.transition=s,Or=n}return null}function $A(t,r,e,n){do gu();while(Qo!==null);if(Ar&6)throw Error(Dt(327));e=t.finishedWork;var s=t.finishedLanes;if(e===null)return null;if(t.finishedWork=null,t.finishedLanes=0,e===t.current)throw Error(Dt(177));t.callbackNode=null,t.callbackPriority=0;var a=e.lanes|e.childLanes;if(xE(t,a),t===zn&&(Cn=zn=null,Zn=0),!(e.subtreeFlags&2064)&&!(e.flags&2064)||r0||(r0=!0,V6(Z0,function(){return gu(),null})),a=(e.flags&15990)!==0,e.subtreeFlags&15990||a){a=Oa.transition,Oa.transition=null;var i=Or;Or=1;var o=Ar;Ar|=4,tb.current=null,MA(t,e),F6(e,t),iA(Zg),ep=!!Jg,Zg=Jg=null,t.current=e,FA(e),fE(),Ar=o,Or=i,Oa.transition=a}else t.current=e;if(r0&&(r0=!1,Qo=t,gp=s),a=t.pendingLanes,a===0&&(cl=null),pE(e.stateNode),Ys(t,pn()),r!==null)for(n=t.onRecoverableError,e=0;e<r.length;e++)s=r[e],n(s.value,{componentStack:s.stack,digest:s.digest});if(mp)throw mp=!1,t=b2,b2=null,t;return gp&1&&t.tag!==0&&gu(),a=t.pendingLanes,a&1?t===y2?Qf++:(Qf=0,y2=t):Qf=0,_l(),null}function gu(){if(Qo!==null){var t=w4(gp),r=Oa.transition,e=Or;try{if(Oa.transition=null,Or=16>t?16:t,Qo===null)var n=!1;else{if(t=Qo,Qo=null,gp=0,Ar&6)throw Error(Dt(331));var s=Ar;for(Ar|=4,Ut=t.current;Ut!==null;){var a=Ut,i=a.child;if(Ut.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ut=c;Ut!==null;){var u=Ut;switch(u.tag){case 0:case 11:case 15:Jf(8,u,a)}var d=u.child;if(d!==null)d.return=u,Ut=d;else for(;Ut!==null;){u=Ut;var h=u.sibling,f=u.return;if(P6(u),u===c){Ut=null;break}if(h!==null){h.return=f,Ut=h;break}Ut=f}}}var g=a.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var p=m.sibling;m.sibling=null,m=p}while(m!==null)}}Ut=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Ut=i;else e:for(;Ut!==null;){if(a=Ut,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Jf(9,a,a.return)}var v=a.sibling;if(v!==null){v.return=a.return,Ut=v;break e}Ut=a.return}}var b=t.current;for(Ut=b;Ut!==null;){i=Ut;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Ut=y;else e:for(i=b;Ut!==null;){if(o=Ut,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:em(9,o)}}catch(N){sn(o,o.return,N)}if(o===i){Ut=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,Ut=k;break e}Ut=o.return}}if(Ar=s,_l(),Ei&&typeof Ei.onPostCommitFiberRoot=="function")try{Ei.onPostCommitFiberRoot(Wp,t)}catch{}n=!0}return n}finally{Or=e,Oa.transition=r}}return!1}function Kx(t,r,e){r=Ru(e,r),r=w6(t,r,1),t=ll(t,r,1),r=Ps(),t!==null&&(Kh(t,1,r),Ys(t,r))}function sn(t,r,e){if(t.tag===3)Kx(t,t,e);else for(;r!==null;){if(r.tag===3){Kx(r,t,e);break}else if(r.tag===1){var n=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(cl===null||!cl.has(n))){t=Ru(e,t),t=_6(r,t,1),r=ll(r,t,1),t=Ps(),r!==null&&(Kh(r,1,t),Ys(r,t));break}}r=r.return}}function UA(t,r,e){var n=t.pingCache;n!==null&&n.delete(r),r=Ps(),t.pingedLanes|=t.suspendedLanes&e,zn===t&&(Zn&e)===e&&(On===4||On===3&&(Zn&130023424)===Zn&&500>pn()-nb?Yl(t,0):rb|=e),Ys(t,r)}function H6(t,r){r===0&&(t.mode&1?(r=Wd,Wd<<=1,!(Wd&130023424)&&(Wd=4194304)):r=1);var e=Ps();t=oo(t,r),t!==null&&(Kh(t,r,e),Ys(t,e))}function HA(t){var r=t.memoizedState,e=0;r!==null&&(e=r.retryLane),H6(t,e)}function zA(t,r){var e=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(e=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Dt(314))}n!==null&&n.delete(r),H6(t,e)}var z6;z6=function(t,r,e){if(t!==null)if(t.memoizedProps!==r.pendingProps||Xs.current)Gs=!0;else{if(!(t.lanes&e)&&!(r.flags&128))return Gs=!1,DA(t,r,e);Gs=!!(t.flags&131072)}else Gs=!1,Kr&&r.flags&1048576&&G4(r,op,r.index);switch(r.lanes=0,r.tag){case 2:var n=r.type;L0(t,r),t=r.pendingProps;var s=Cu(r,ys.current);mu(r,e),s=Yv(null,r,n,t,s,e);var a=Jv();return r.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Ks(n)?(a=!0,ap(r)):a=!1,r.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,qv(r),s.updater=Qp,r.stateNode=s,s._reactInternals=r,o2(r,n,t,e),r=u2(null,r,n,!0,a,e)):(r.tag=0,Kr&&a&&Iv(r),Ts(null,r,s,e),r=r.child),r;case 16:n=r.elementType;e:{switch(L0(t,r),t=r.pendingProps,s=n._init,n=s(n._payload),r.type=n,s=r.tag=qA(n),t=Ya(n,t),s){case 0:r=c2(null,r,n,t,e);break e;case 1:r=Bx(null,r,n,t,e);break e;case 11:r=Lx(null,r,n,t,e);break e;case 14:r=Ix(null,r,n,Ya(n.type,t),e);break e}throw Error(Dt(306,n,""))}return r;case 0:return n=r.type,s=r.pendingProps,s=r.elementType===n?s:Ya(n,s),c2(t,r,n,s,e);case 1:return n=r.type,s=r.pendingProps,s=r.elementType===n?s:Ya(n,s),Bx(t,r,n,s,e);case 3:e:{if(A6(r),t===null)throw Error(Dt(387));n=r.pendingProps,a=r.memoizedState,s=a.element,Q4(t,r),up(r,n,null,e);var i=r.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},r.updateQueue.baseState=a,r.memoizedState=a,r.flags&256){s=Ru(Error(Dt(423)),r),r=$x(t,r,n,e,s);break e}else if(n!==s){s=Ru(Error(Dt(424)),r),r=$x(t,r,n,e,s);break e}else for(ca=ol(r.stateNode.containerInfo.firstChild),fa=r,Kr=!0,ei=null,e=J4(r,null,n,e),r.child=e;e;)e.flags=e.flags&-3|4096,e=e.sibling;else{if(Tu(),n===s){r=lo(t,r,e);break e}Ts(t,r,n,e)}r=r.child}return r;case 5:return e6(r),t===null&&s2(r),n=r.type,s=r.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,Qg(n,s)?i=null:a!==null&&Qg(n,a)&&(r.flags|=32),E6(t,r),Ts(t,r,i,e),r.child;case 6:return t===null&&s2(r),null;case 13:return C6(t,r,e);case 4:return Wv(r,r.stateNode.containerInfo),n=r.pendingProps,t===null?r.child=Nu(r,null,n,e):Ts(t,r,n,e),r.child;case 11:return n=r.type,s=r.pendingProps,s=r.elementType===n?s:Ya(n,s),Lx(t,r,n,s,e);case 7:return Ts(t,r,r.pendingProps,e),r.child;case 8:return Ts(t,r,r.pendingProps.children,e),r.child;case 12:return Ts(t,r,r.pendingProps.children,e),r.child;case 10:e:{if(n=r.type._context,s=r.pendingProps,a=r.memoizedProps,i=s.value,Hr(lp,n._currentValue),n._currentValue=i,a!==null)if(li(a.value,i)){if(a.children===s.children&&!Xs.current){r=lo(t,r,e);break e}}else for(a=r.child,a!==null&&(a.return=r);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=to(-1,e&-e),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}a.lanes|=e,l=a.alternate,l!==null&&(l.lanes|=e),a2(a.return,e,r),o.lanes|=e;break}l=l.next}}else if(a.tag===10)i=a.type===r.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(Dt(341));i.lanes|=e,o=i.alternate,o!==null&&(o.lanes|=e),a2(i,e,r),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===r){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Ts(t,r,s.children,e),r=r.child}return r;case 9:return s=r.type,n=r.pendingProps.children,mu(r,e),s=Fa(s),n=n(s),r.flags|=1,Ts(t,r,n,e),r.child;case 14:return n=r.type,s=Ya(n,r.pendingProps),s=Ya(n.type,s),Ix(t,r,n,s,e);case 15:return S6(t,r,r.type,r.pendingProps,e);case 17:return n=r.type,s=r.pendingProps,s=r.elementType===n?s:Ya(n,s),L0(t,r),r.tag=1,Ks(n)?(t=!0,ap(r)):t=!1,mu(r,e),x6(r,n,s),o2(r,n,s,e),u2(null,r,n,!0,t,e);case 19:return T6(t,r,e);case 22:return k6(t,r,e)}throw Error(Dt(156,r.tag))};function V6(t,r){return v4(t,r)}function VA(t,r,e,n){this.tag=t,this.key=e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pa(t,r,e,n){return new VA(t,r,e,n)}function ob(t){return t=t.prototype,!(!t||!t.isReactComponent)}function qA(t){if(typeof t=="function")return ob(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Av)return 11;if(t===Cv)return 14}return 2}function fl(t,r){var e=t.alternate;return e===null?(e=Pa(t.tag,r,t.key,t.mode),e.elementType=t.elementType,e.type=t.type,e.stateNode=t.stateNode,e.alternate=t,t.alternate=e):(e.pendingProps=r,e.type=t.type,e.flags=0,e.subtreeFlags=0,e.deletions=null),e.flags=t.flags&14680064,e.childLanes=t.childLanes,e.lanes=t.lanes,e.child=t.child,e.memoizedProps=t.memoizedProps,e.memoizedState=t.memoizedState,e.updateQueue=t.updateQueue,r=t.dependencies,e.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},e.sibling=t.sibling,e.index=t.index,e.ref=t.ref,e}function $0(t,r,e,n,s,a){var i=2;if(n=t,typeof t=="function")ob(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Zc:return Jl(e.children,s,a,r);case Ev:i=8,s|=8;break;case Rg:return t=Pa(12,e,r,s|2),t.elementType=Rg,t.lanes=a,t;case Pg:return t=Pa(13,e,r,s),t.elementType=Pg,t.lanes=a,t;case Og:return t=Pa(19,e,r,s),t.elementType=Og,t.lanes=a,t;case e4:return rm(e,s,a,r);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Z3:i=10;break e;case Q3:i=9;break e;case Av:i=11;break e;case Cv:i=14;break e;case Vo:i=16,n=null;break e}throw Error(Dt(130,t==null?t:typeof t,""))}return r=Pa(i,e,r,s),r.elementType=t,r.type=n,r.lanes=a,r}function Jl(t,r,e,n){return t=Pa(7,t,n,r),t.lanes=e,t}function rm(t,r,e,n){return t=Pa(22,t,n,r),t.elementType=e4,t.lanes=e,t.stateNode={isHidden:!1},t}function j1(t,r,e){return t=Pa(6,t,null,r),t.lanes=e,t}function L1(t,r,e){return r=Pa(4,t.children!==null?t.children:[],t.key,r),r.lanes=e,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}function WA(t,r,e,n,s){this.tag=r,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=v1(0),this.expirationTimes=v1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=v1(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function lb(t,r,e,n,s,a,i,o,l){return t=new WA(t,r,e,o,l),r===1?(r=1,a===!0&&(r|=8)):r=0,a=Pa(3,null,null,r),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:e,cache:null,transitions:null,pendingSuspenseBoundaries:null},qv(a),t}function GA(t,r,e){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jc,key:n==null?null:""+n,children:t,containerInfo:r,implementation:e}}function q6(t){if(!t)return ml;t=t._reactInternals;e:{if(uc(t)!==t||t.tag!==1)throw Error(Dt(170));var r=t;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Ks(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(Dt(171))}if(t.tag===1){var e=t.type;if(Ks(e))return q4(t,e,r)}return r}function W6(t,r,e,n,s,a,i,o,l){return t=lb(e,n,!0,t,s,a,i,o,l),t.context=q6(null),e=t.current,n=Ps(),s=ul(e),a=to(n,s),a.callback=r??null,ll(e,a,s),t.current.lanes=s,Kh(t,s,n),Ys(t,n),t}function nm(t,r,e,n){var s=r.current,a=Ps(),i=ul(s);return e=q6(e),r.context===null?r.context=e:r.pendingContext=e,r=to(a,i),r.payload={element:t},n=n===void 0?null:n,n!==null&&(r.callback=n),t=ll(s,r,i),t!==null&&(ii(t,s,i,a),M0(t,s,i)),i}function bp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Yx(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var e=t.retryLane;t.retryLane=e!==0&&e<r?e:r}}function cb(t,r){Yx(t,r),(t=t.alternate)&&Yx(t,r)}function XA(){return null}var G6=typeof reportError=="function"?reportError:function(t){console.error(t)};function ub(t){this._internalRoot=t}sm.prototype.render=ub.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(Dt(409));nm(t,r,null,null)};sm.prototype.unmount=ub.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;ac(function(){nm(null,t,null,null)}),r[io]=null}};function sm(t){this._internalRoot=t}sm.prototype.unstable_scheduleHydration=function(t){if(t){var r=k4();t={blockedOn:null,target:t,priority:r};for(var e=0;e<Xo.length&&r!==0&&r<Xo[e].priority;e++);Xo.splice(e,0,t),e===0&&A4(t)}};function fb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function am(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Jx(){}function KA(t,r,e,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var c=bp(i);a.call(c)}}var i=W6(r,n,t,0,null,!1,!1,"",Jx);return t._reactRootContainer=i,t[io]=i.current,Sh(t.nodeType===8?t.parentNode:t),ac(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=bp(l);o.call(c)}}var l=lb(t,0,!1,null,null,!1,!1,"",Jx);return t._reactRootContainer=l,t[io]=l.current,Sh(t.nodeType===8?t.parentNode:t),ac(function(){nm(r,l,e,n)}),l}function im(t,r,e,n,s){var a=e._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=bp(i);o.call(l)}}nm(r,i,t,s)}else i=KA(e,r,t,s,n);return bp(i)}_4=function(t){switch(t.tag){case 3:var r=t.stateNode;if(r.current.memoizedState.isDehydrated){var e=Lf(r.pendingLanes);e!==0&&(Dv(r,e|1),Ys(r,pn()),!(Ar&6)&&(Pu=pn()+500,_l()))}break;case 13:ac(function(){var n=oo(t,1);if(n!==null){var s=Ps();ii(n,t,1,s)}}),cb(t,1)}};Rv=function(t){if(t.tag===13){var r=oo(t,134217728);if(r!==null){var e=Ps();ii(r,t,134217728,e)}cb(t,134217728)}};S4=function(t){if(t.tag===13){var r=ul(t),e=oo(t,r);if(e!==null){var n=Ps();ii(e,t,r,n)}cb(t,r)}};k4=function(){return Or};E4=function(t,r){var e=Or;try{return Or=t,r()}finally{Or=e}};zg=function(t,r,e){switch(r){case"input":if(jg(t,e),r=e.name,e.type==="radio"&&r!=null){for(e=t;e.parentNode;)e=e.parentNode;for(e=e.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<e.length;r++){var n=e[r];if(n!==t&&n.form===t.form){var s=Yp(n);if(!s)throw Error(Dt(90));r4(n),jg(n,s)}}}break;case"textarea":s4(t,e);break;case"select":r=e.value,r!=null&&fu(t,!!e.multiple,r,!1)}};f4=sb;h4=ac;var YA={usingClientEntryPoint:!1,Events:[Jh,ru,Yp,c4,u4,sb]},Nf={findFiberByHostInstance:Wl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},JA={bundleType:Nf.bundleType,version:Nf.version,rendererPackageName:Nf.rendererPackageName,rendererConfig:Nf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ho.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=m4(t),t===null?null:t.stateNode},findFiberByHostInstance:Nf.findFiberByHostInstance||XA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var n0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!n0.isDisabled&&n0.supportsFiber)try{Wp=n0.inject(JA),Ei=n0}catch{}}ma.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YA;ma.createPortal=function(t,r){var e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fb(r))throw Error(Dt(200));return GA(t,r,null,e)};ma.createRoot=function(t,r){if(!fb(t))throw Error(Dt(299));var e=!1,n="",s=G6;return r!=null&&(r.unstable_strictMode===!0&&(e=!0),r.identifierPrefix!==void 0&&(n=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),r=lb(t,1,!1,null,null,e,!1,n,s),t[io]=r.current,Sh(t.nodeType===8?t.parentNode:t),new ub(r)};ma.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(Dt(188)):(t=Object.keys(t).join(","),Error(Dt(268,t)));return t=m4(r),t=t===null?null:t.stateNode,t};ma.flushSync=function(t){return ac(t)};ma.hydrate=function(t,r,e){if(!am(r))throw Error(Dt(200));return im(null,t,r,!0,e)};ma.hydrateRoot=function(t,r,e){if(!fb(t))throw Error(Dt(405));var n=e!=null&&e.hydratedSources||null,s=!1,a="",i=G6;if(e!=null&&(e.unstable_strictMode===!0&&(s=!0),e.identifierPrefix!==void 0&&(a=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),r=W6(r,null,t,1,e??null,s,!1,a,i),t[io]=r.current,Sh(t),n)for(t=0;t<n.length;t++)e=n[t],s=e._getVersion,s=s(e._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[e,s]:r.mutableSourceEagerHydrationData.push(e,s);return new sm(r)};ma.render=function(t,r,e){if(!am(r))throw Error(Dt(200));return im(null,t,r,!1,e)};ma.unmountComponentAtNode=function(t){if(!am(t))throw Error(Dt(40));return t._reactRootContainer?(ac(function(){im(null,null,t,!1,function(){t._reactRootContainer=null,t[io]=null})}),!0):!1};ma.unstable_batchedUpdates=sb;ma.unstable_renderSubtreeIntoContainer=function(t,r,e,n){if(!am(e))throw Error(Dt(200));if(t==null||t._reactInternals===void 0)throw Error(Dt(38));return im(t,r,e,!1,n)};ma.version="18.3.1-next-f1338f8080-20240426";function X6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(X6)}catch(t){console.error(t)}}X6(),X3.exports=ma;var K6=X3.exports,Zx=K6;Ng.createRoot=Zx.createRoot,Ng.hydrateRoot=Zx.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ph(){return Ph=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Ph.apply(this,arguments)}var el;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(el||(el={}));const Qx="popstate";function ZA(t){t===void 0&&(t={});function r(n,s){let{pathname:a,search:i,hash:o}=n.location;return _2("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function e(n,s){return typeof s=="string"?s:yp(s)}return e9(r,e,null,t)}function bn(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function Y6(t,r){if(!t){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function QA(){return Math.random().toString(36).substr(2,8)}function ew(t,r){return{usr:t.state,key:t.key,idx:r}}function _2(t,r,e,n){return e===void 0&&(e=null),Ph({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof r=="string"?$u(r):r,{state:e,key:r&&r.key||n||QA()})}function yp(t){let{pathname:r="/",search:e="",hash:n=""}=t;return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(r+=n.charAt(0)==="#"?n:"#"+n),r}function $u(t){let r={};if(t){let e=t.indexOf("#");e>=0&&(r.hash=t.substr(e),t=t.substr(0,e));let n=t.indexOf("?");n>=0&&(r.search=t.substr(n),t=t.substr(0,n)),t&&(r.pathname=t)}return r}function e9(t,r,e,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=el.Pop,l=null,c=u();c==null&&(c=0,i.replaceState(Ph({},i.state,{idx:c}),""));function u(){return(i.state||{idx:null}).idx}function d(){o=el.Pop;let p=u(),v=p==null?null:p-c;c=p,l&&l({action:o,location:m.location,delta:v})}function h(p,v){o=el.Push;let b=_2(m.location,p,v);c=u()+1;let y=ew(b,c),k=m.createHref(b);try{i.pushState(y,"",k)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(k)}a&&l&&l({action:o,location:m.location,delta:1})}function f(p,v){o=el.Replace;let b=_2(m.location,p,v);c=u();let y=ew(b,c),k=m.createHref(b);i.replaceState(y,"",k),a&&l&&l({action:o,location:m.location,delta:0})}function g(p){let v=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof p=="string"?p:yp(p);return b=b.replace(/ $/,"%20"),bn(v,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,v)}let m={get action(){return o},get location(){return t(s,i)},listen(p){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Qx,d),l=p,()=>{s.removeEventListener(Qx,d),l=null}},createHref(p){return r(s,p)},createURL:g,encodeLocation(p){let v=g(p);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:h,replace:f,go(p){return i.go(p)}};return m}var tw;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(tw||(tw={}));function t9(t,r,e){return e===void 0&&(e="/"),r9(t,r,e)}function r9(t,r,e,n){let s=typeof r=="string"?$u(r):r,a=hb(s.pathname||"/",e);if(a==null)return null;let i=J6(t);n9(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=m9(a);o=h9(i[l],c)}return o}function J6(t,r,e,n){r===void 0&&(r=[]),e===void 0&&(e=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(bn(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=hl([n,l.relativePath]),u=e.concat(l);a.children&&a.children.length>0&&(bn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),J6(a.children,r,u,c)),!(a.path==null&&!a.index)&&r.push({path:c,score:u9(c,a.index),routesMeta:u})};return t.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of Z6(a.path))s(a,i,l)}),r}function Z6(t){let r=t.split("/");if(r.length===0)return[];let[e,...n]=r,s=e.endsWith("?"),a=e.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=Z6(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function n9(t){t.sort((r,e)=>r.score!==e.score?e.score-r.score:f9(r.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}const s9=/^:[\w-]+$/,a9=3,i9=2,o9=1,l9=10,c9=-2,rw=t=>t==="*";function u9(t,r){let e=t.split("/"),n=e.length;return e.some(rw)&&(n+=c9),r&&(n+=i9),e.filter(s=>!rw(s)).reduce((s,a)=>s+(s9.test(a)?a9:a===""?o9:l9),n)}function f9(t,r){return t.length===r.length&&t.slice(0,-1).every((n,s)=>n===r[s])?t[t.length-1]-r[r.length-1]:0}function h9(t,r,e){let{routesMeta:n}=t,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=a==="/"?r:r.slice(a.length)||"/",d=d9({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:hl([a,d.pathname]),pathnameBase:y9(hl([a,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(a=hl([a,d.pathnameBase]))}return i}function d9(t,r){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[e,n]=p9(t.path,t.caseSensitive,t.end),s=r.match(e);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,u,d)=>{let{paramName:h,isOptional:f}=u;if(h==="*"){let m=o[d]||"";i=a.slice(0,a.length-m.length).replace(/(.)\/+$/,"$1")}const g=o[d];return f&&!g?c[h]=void 0:c[h]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:i,pattern:t}}function p9(t,r,e){r===void 0&&(r=!1),e===void 0&&(e=!0),Y6(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,r?void 0:"i"),n]}function m9(t){try{return t.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Y6(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),t}}function hb(t,r){if(r==="/")return t;if(!t.toLowerCase().startsWith(r.toLowerCase()))return null;let e=r.endsWith("/")?r.length-1:r.length,n=t.charAt(e);return n&&n!=="/"?null:t.slice(e)||"/"}function g9(t,r){r===void 0&&(r="/");let{pathname:e,search:n="",hash:s=""}=typeof t=="string"?$u(t):t;return{pathname:e?e.startsWith("/")?e:v9(e,r):r,search:x9(n),hash:w9(s)}}function v9(t,r){let e=r.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?e.length>1&&e.pop():s!=="."&&e.push(s)}),e.length>1?e.join("/"):"/"}function I1(t,r,e,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+e+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function b9(t){return t.filter((r,e)=>e===0||r.route.path&&r.route.path.length>0)}function db(t,r){let e=b9(t);return r?e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase):e.map(n=>n.pathnameBase)}function pb(t,r,e,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=$u(t):(s=Ph({},t),bn(!s.pathname||!s.pathname.includes("?"),I1("?","pathname","search",s)),bn(!s.pathname||!s.pathname.includes("#"),I1("#","pathname","hash",s)),bn(!s.search||!s.search.includes("#"),I1("#","search","hash",s)));let a=t===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=e;else{let d=r.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;s.pathname=h.join("/")}o=d>=0?r[d]:"/"}let l=g9(s,o),c=i&&i!=="/"&&i.endsWith("/"),u=(a||i===".")&&e.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const hl=t=>t.join("/").replace(/\/\/+/g,"/"),y9=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),x9=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,w9=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function _9(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Q6=["post","put","patch","delete"];new Set(Q6);const S9=["get",...Q6];new Set(S9);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oh(){return Oh=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Oh.apply(this,arguments)}const mb=Se.createContext(null),k9=Se.createContext(null),Sl=Se.createContext(null),om=Se.createContext(null),po=Se.createContext({outlet:null,matches:[],isDataRoute:!1}),e_=Se.createContext(null);function E9(t,r){let{relative:e}=r===void 0?{}:r;Uu()||bn(!1);let{basename:n,navigator:s}=Se.useContext(Sl),{hash:a,pathname:i,search:o}=r_(t,{relative:e}),l=i;return n!=="/"&&(l=i==="/"?n:hl([n,i])),s.createHref({pathname:l,search:o,hash:a})}function Uu(){return Se.useContext(om)!=null}function Hu(){return Uu()||bn(!1),Se.useContext(om).location}function t_(t){Se.useContext(Sl).static||Se.useLayoutEffect(t)}function mo(){let{isDataRoute:t}=Se.useContext(po);return t?I9():A9()}function A9(){Uu()||bn(!1);let t=Se.useContext(mb),{basename:r,future:e,navigator:n}=Se.useContext(Sl),{matches:s}=Se.useContext(po),{pathname:a}=Hu(),i=JSON.stringify(db(s,e.v7_relativeSplatPath)),o=Se.useRef(!1);return t_(()=>{o.current=!0}),Se.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=pb(c,JSON.parse(i),a,u.relative==="path");t==null&&r!=="/"&&(d.pathname=d.pathname==="/"?r:hl([r,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[r,n,i,a,t])}function lm(){let{matches:t}=Se.useContext(po),r=t[t.length-1];return r?r.params:{}}function r_(t,r){let{relative:e}=r===void 0?{}:r,{future:n}=Se.useContext(Sl),{matches:s}=Se.useContext(po),{pathname:a}=Hu(),i=JSON.stringify(db(s,n.v7_relativeSplatPath));return Se.useMemo(()=>pb(t,JSON.parse(i),a,e==="path"),[t,i,a,e])}function C9(t,r){return T9(t,r)}function T9(t,r,e,n){Uu()||bn(!1);let{navigator:s,static:a}=Se.useContext(Sl),{matches:i}=Se.useContext(po),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Hu(),d;if(r){var h;let v=typeof r=="string"?$u(r):r;c==="/"||(h=v.pathname)!=null&&h.startsWith(c)||bn(!1),d=v}else d=u;let f=d.pathname||"/",g=f;if(c!=="/"){let v=c.replace(/^\//,"").split("/");g="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=t9(t,{pathname:g}),p=O9(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:hl([c,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:hl([c,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,e,n);return r&&p?Se.createElement(om.Provider,{value:{location:Oh({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:el.Pop}},p):p}function N9(){let t=L9(),r=_9(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),e=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Se.createElement(Se.Fragment,null,Se.createElement("h2",null,"Unexpected Application Error!"),Se.createElement("h3",{style:{fontStyle:"italic"}},r),e?Se.createElement("pre",{style:s},e):null,null)}const D9=Se.createElement(N9,null);class R9 extends Se.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){console.error("React Router caught the following error during render",r,e)}render(){return this.state.error!==void 0?Se.createElement(po.Provider,{value:this.props.routeContext},Se.createElement(e_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function P9(t){let{routeContext:r,match:e,children:n}=t,s=Se.useContext(mb);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),Se.createElement(po.Provider,{value:r},n)}function O9(t,r,e,n){var s;if(r===void 0&&(r=[]),e===void 0&&(e=null),n===void 0&&(n=null),t==null){var a;if(!e)return null;if(e.errors)t=e.matches;else if((a=n)!=null&&a.v7_partialHydration&&r.length===0&&!e.initialized&&e.matches.length>0)t=e.matches;else return null}let i=t,o=(s=e)==null?void 0:s.errors;if(o!=null){let u=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);u>=0||bn(!1),i=i.slice(0,Math.min(i.length,u+1))}let l=!1,c=-1;if(e&&n&&n.v7_partialHydration)for(let u=0;u<i.length;u++){let d=i[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:f}=e,g=d.route.loader&&h[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||g){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,d,h)=>{let f,g=!1,m=null,p=null;e&&(f=o&&d.route.id?o[d.route.id]:void 0,m=d.route.errorElement||D9,l&&(c<0&&h===0?(B9("route-fallback"),g=!0,p=null):c===h&&(g=!0,p=d.route.hydrateFallbackElement||null)));let v=r.concat(i.slice(0,h+1)),b=()=>{let y;return f?y=m:g?y=p:d.route.Component?y=Se.createElement(d.route.Component,null):d.route.element?y=d.route.element:y=u,Se.createElement(P9,{match:d,routeContext:{outlet:u,matches:v,isDataRoute:e!=null},children:y})};return e&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?Se.createElement(R9,{location:e.location,revalidation:e.revalidation,component:m,error:f,children:b(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):b()},null)}var n_=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(n_||{}),s_=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(s_||{});function M9(t){let r=Se.useContext(mb);return r||bn(!1),r}function F9(t){let r=Se.useContext(k9);return r||bn(!1),r}function j9(t){let r=Se.useContext(po);return r||bn(!1),r}function a_(t){let r=j9(),e=r.matches[r.matches.length-1];return e.route.id||bn(!1),e.route.id}function L9(){var t;let r=Se.useContext(e_),e=F9(),n=a_();return r!==void 0?r:(t=e.errors)==null?void 0:t[n]}function I9(){let{router:t}=M9(n_.UseNavigateStable),r=a_(s_.UseNavigateStable),e=Se.useRef(!1);return t_(()=>{e.current=!0}),Se.useCallback(function(s,a){a===void 0&&(a={}),e.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Oh({fromRouteId:r},a)))},[t,r])}const nw={};function B9(t,r,e){nw[t]||(nw[t]=!0)}function $9(t,r){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function s0(t){let{to:r,replace:e,state:n,relative:s}=t;Uu()||bn(!1);let{future:a,static:i}=Se.useContext(Sl),{matches:o}=Se.useContext(po),{pathname:l}=Hu(),c=mo(),u=pb(r,db(o,a.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(u);return Se.useEffect(()=>c(JSON.parse(d),{replace:e,state:n,relative:s}),[c,d,s,e,n]),null}function Hs(t){bn(!1)}function U9(t){let{basename:r="/",children:e=null,location:n,navigationType:s=el.Pop,navigator:a,static:i=!1,future:o}=t;Uu()&&bn(!1);let l=r.replace(/^\/*/,"/"),c=Se.useMemo(()=>({basename:l,navigator:a,static:i,future:Oh({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=$u(n));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:g="default"}=n,m=Se.useMemo(()=>{let p=hb(u,l);return p==null?null:{location:{pathname:p,search:d,hash:h,state:f,key:g},navigationType:s}},[l,u,d,h,f,g,s]);return m==null?null:Se.createElement(Sl.Provider,{value:c},Se.createElement(om.Provider,{children:e,value:m}))}function H9(t){let{children:r,location:e}=t;return C9(S2(r),e)}new Promise(()=>{});function S2(t,r){r===void 0&&(r=[]);let e=[];return Se.Children.forEach(t,(n,s)=>{if(!Se.isValidElement(n))return;let a=[...r,s];if(n.type===Se.Fragment){e.push.apply(e,S2(n.props.children,a));return}n.type!==Hs&&bn(!1),!n.props.index||!n.props.children||bn(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=S2(n.props.children,a)),e.push(i)}),e}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function k2(){return k2=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},k2.apply(this,arguments)}function z9(t,r){if(t==null)return{};var e={},n=Object.keys(t),s,a;for(a=0;a<n.length;a++)s=n[a],!(r.indexOf(s)>=0)&&(e[s]=t[s]);return e}function V9(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function q9(t,r){return t.button===0&&(!r||r==="_self")&&!V9(t)}const W9=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],G9="6";try{window.__reactRouterVersion=G9}catch{}const X9="startTransition",sw=Tg[X9];function K9(t){let{basename:r,children:e,future:n,window:s}=t,a=Se.useRef();a.current==null&&(a.current=ZA({window:s,v5Compat:!0}));let i=a.current,[o,l]=Se.useState({action:i.action,location:i.location}),{v7_startTransition:c}=n||{},u=Se.useCallback(d=>{c&&sw?sw(()=>l(d)):l(d)},[l,c]);return Se.useLayoutEffect(()=>i.listen(u),[i,u]),Se.useEffect(()=>$9(n),[n]),Se.createElement(U9,{basename:r,children:e,location:o.location,navigationType:o.action,navigator:i,future:n})}const Y9=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",J9=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ti=Se.forwardRef(function(r,e){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:l,to:c,preventScrollReset:u,viewTransition:d}=r,h=z9(r,W9),{basename:f}=Se.useContext(Sl),g,m=!1;if(typeof c=="string"&&J9.test(c)&&(g=c,Y9))try{let y=new URL(window.location.href),k=c.startsWith("//")?new URL(y.protocol+c):new URL(c),N=hb(k.pathname,f);k.origin===y.origin&&N!=null?c=N+k.search+k.hash:m=!0}catch{}let p=E9(c,{relative:s}),v=Z9(c,{replace:i,state:o,target:l,preventScrollReset:u,relative:s,viewTransition:d});function b(y){n&&n(y),y.defaultPrevented||v(y)}return Se.createElement("a",k2({},h,{href:g||p,onClick:m||a?n:b,ref:e,target:l}))});var aw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(aw||(aw={}));var iw;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(iw||(iw={}));function Z9(t,r){let{target:e,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=r===void 0?{}:r,l=mo(),c=Hu(),u=r_(t,{relative:i});return Se.useCallback(d=>{if(q9(d,e)){d.preventDefault();let h=n!==void 0?n:yp(c)===yp(u);l(t,{replace:h,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[c,l,u,n,s,e,t,a,i,o])}const Q9="modulepreload",eC=function(t){return"/rule-1-rule-2-abcd-bcd-number/"+t},ow={},Ma=function(r,e,n){let s=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(e.map(l=>{if(l=eC(l),l in ow)return;ow[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Q9,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return r().catch(a)})},tC=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>Ma(async()=>{const{default:n}=await Promise.resolve().then(()=>zu);return{default:n}},void 0).then(({default:n})=>n(...e)):r=fetch,(...e)=>r(...e)};class gb extends Error{constructor(r,e="FunctionsError",n){super(r),this.name=e,this.context=n}}class rC extends gb{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class lw extends gb{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class cw extends gb{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var E2;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(E2||(E2={}));var nC=function(t,r,e,n){function s(a){return a instanceof e?a:new e(function(i){i(a)})}return new(e||(e=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(t,r||[])).next())})};class sC{constructor(r,{headers:e={},customFetch:n,region:s=E2.Any}={}){this.url=r,this.headers=e,this.region=s,this.fetch=tC(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,e={}){var n;return nC(this,void 0,void 0,function*(){try{const{headers:s,method:a,body:i}=e;let o={},{region:l}=e;l||(l=this.region);const c=new URL(`${this.url}/${r}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;i&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(o["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const d=yield this.fetch(c.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:u}).catch(m=>{throw new rC(m)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new lw(d);if(!d.ok)throw new cw(d);let f=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return f==="application/json"?g=yield d.json():f==="application/octet-stream"?g=yield d.blob():f==="text/event-stream"?g=d:f==="multipart/form-data"?g=yield d.formData():g=yield d.text(),{data:g,error:null,response:d}}catch(s){return{data:null,error:s,response:s instanceof cw||s instanceof lw?s.context:void 0}}})}}var Ws={},vb={},cm={},Qh={},um={},fm={},aC=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ou=aC();const iC=Ou.fetch,i_=Ou.fetch.bind(Ou),o_=Ou.Headers,oC=Ou.Request,lC=Ou.Response,zu=Object.freeze(Object.defineProperty({__proto__:null,Headers:o_,Request:oC,Response:lC,default:i_,fetch:iC},Symbol.toStringTag,{value:"Module"})),cC=A7(zu);var hm={};Object.defineProperty(hm,"__esModule",{value:!0});let uC=class extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}};hm.default=uC;var l_=rr&&rr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fm,"__esModule",{value:!0});const fC=l_(cC),hC=l_(hm);let dC=class{constructor(r){this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=r.headers,this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=r.shouldThrowOnError,this.signal=r.signal,this.isMaybeSingle=r.isMaybeSingle,r.fetch?this.fetch=r.fetch:typeof fetch>"u"?this.fetch=fC.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,e){return this.headers=Object.assign({},this.headers),this.headers[r]=e,this}then(r,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var i,o,l;let c=null,u=null,d=null,h=a.status,f=a.statusText;if(a.ok){if(this.method!=="HEAD"){const v=await a.text();v===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=v:u=JSON.parse(v))}const m=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),p=(o=a.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&p&&p.length>1&&(d=parseInt(p[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,h=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const m=await a.text();try{c=JSON.parse(m),Array.isArray(c)&&a.status===404&&(u=[],c=null,h=200,f="OK")}catch{a.status===404&&m===""?(h=204,f="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,f="OK"),c&&this.shouldThrowOnError)throw new hC.default(c)}return{error:c,data:u,count:d,status:h,statusText:f}});return this.shouldThrowOnError||(s=s.catch(a=>{var i,o,l;return{error:{message:`${(i=a==null?void 0:a.name)!==null&&i!==void 0?i:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(o=a==null?void 0:a.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=a==null?void 0:a.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(r,e)}returns(){return this}overrideTypes(){return this}};fm.default=dC;var pC=rr&&rr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(um,"__esModule",{value:!0});const mC=pC(fm);let gC=class extends mC.default{select(r){let e=!1;const n=(r??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(r,{ascending:e=!0,nullsFirst:n,foreignTable:s,referencedTable:a=s}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${r}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:e,referencedTable:n=e}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${r}`),this}range(r,e,{foreignTable:n,referencedTable:s=n}={}){const a=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${r}`),this.url.searchParams.set(i,`${e-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:r=!1,verbose:e=!1,settings:n=!1,buffers:s=!1,wal:a=!1,format:i="text"}={}){var o;const l=[r?"analyze":null,e?"verbose":null,n?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`,i==="json"?this:this}rollback(){var r;return((r=this.headers.Prefer)!==null&&r!==void 0?r:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};um.default=gC;var vC=rr&&rr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Qh,"__esModule",{value:!0});const bC=vC(um);let yC=class extends bC.default{eq(r,e){return this.url.searchParams.append(r,`eq.${e}`),this}neq(r,e){return this.url.searchParams.append(r,`neq.${e}`),this}gt(r,e){return this.url.searchParams.append(r,`gt.${e}`),this}gte(r,e){return this.url.searchParams.append(r,`gte.${e}`),this}lt(r,e){return this.url.searchParams.append(r,`lt.${e}`),this}lte(r,e){return this.url.searchParams.append(r,`lte.${e}`),this}like(r,e){return this.url.searchParams.append(r,`like.${e}`),this}likeAllOf(r,e){return this.url.searchParams.append(r,`like(all).{${e.join(",")}}`),this}likeAnyOf(r,e){return this.url.searchParams.append(r,`like(any).{${e.join(",")}}`),this}ilike(r,e){return this.url.searchParams.append(r,`ilike.${e}`),this}ilikeAllOf(r,e){return this.url.searchParams.append(r,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(r,e){return this.url.searchParams.append(r,`ilike(any).{${e.join(",")}}`),this}is(r,e){return this.url.searchParams.append(r,`is.${e}`),this}in(r,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(r,`in.(${n})`),this}contains(r,e){return typeof e=="string"?this.url.searchParams.append(r,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(r,`cs.{${e.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(e)}`),this}containedBy(r,e){return typeof e=="string"?this.url.searchParams.append(r,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(r,`cd.{${e.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(e)}`),this}rangeGt(r,e){return this.url.searchParams.append(r,`sr.${e}`),this}rangeGte(r,e){return this.url.searchParams.append(r,`nxl.${e}`),this}rangeLt(r,e){return this.url.searchParams.append(r,`sl.${e}`),this}rangeLte(r,e){return this.url.searchParams.append(r,`nxr.${e}`),this}rangeAdjacent(r,e){return this.url.searchParams.append(r,`adj.${e}`),this}overlaps(r,e){return typeof e=="string"?this.url.searchParams.append(r,`ov.${e}`):this.url.searchParams.append(r,`ov.{${e.join(",")}}`),this}textSearch(r,e,{config:n,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(r,`${a}fts${i}.${e}`),this}match(r){return Object.entries(r).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(r,e,n){return this.url.searchParams.append(r,`not.${e}.${n}`),this}or(r,{foreignTable:e,referencedTable:n=e}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${r})`),this}filter(r,e,n){return this.url.searchParams.append(r,`${e}.${n}`),this}};Qh.default=yC;var xC=rr&&rr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(cm,"__esModule",{value:!0});const Df=xC(Qh);let wC=class{constructor(r,{headers:e={},schema:n,fetch:s}){this.url=r,this.headers=e,this.schema=n,this.fetch=s}select(r,{head:e=!1,count:n}={}){const s=e?"HEAD":"GET";let a=!1;const i=(r??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new Df.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(r,{count:e,defaultToNull:n=!0}={}){const s="POST",a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),e&&a.push(`count=${e}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(r)){const i=r.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Df.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}upsert(r,{onConflict:e,ignoreDuplicates:n=!1,count:s,defaultToNull:a=!0}={}){const i="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),a||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(r)){const l=r.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Df.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}update(r,{count:e}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),this.headers.Prefer=s.join(","),new Df.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}delete({count:r}={}){const e="DELETE",n=[];return r&&n.push(`count=${r}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Df.default({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};cm.default=wC;var dm={},pm={};Object.defineProperty(pm,"__esModule",{value:!0});pm.version=void 0;pm.version="0.0.0-automated";Object.defineProperty(dm,"__esModule",{value:!0});dm.DEFAULT_HEADERS=void 0;const _C=pm;dm.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${_C.version}`};var c_=rr&&rr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(vb,"__esModule",{value:!0});const SC=c_(cm),kC=c_(Qh),EC=dm;let AC=class u_{constructor(r,{headers:e={},schema:n,fetch:s}={}){this.url=r,this.headers=Object.assign(Object.assign({},EC.DEFAULT_HEADERS),e),this.schemaName=n,this.fetch=s}from(r){const e=new URL(`${this.url}/${r}`);return new SC.default(e,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(r){return new u_(this.url,{headers:this.headers,schema:r,fetch:this.fetch})}rpc(r,e={},{head:n=!1,get:s=!1,count:a}={}){let i;const o=new URL(`${this.url}/rpc/${r}`);let l;n||s?(i=n?"HEAD":"GET",Object.entries(e).filter(([u,d])=>d!==void 0).map(([u,d])=>[u,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([u,d])=>{o.searchParams.append(u,d)})):(i="POST",l=e);const c=Object.assign({},this.headers);return a&&(c.Prefer=`count=${a}`),new kC.default({method:i,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};vb.default=AC;var Vu=rr&&rr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.PostgrestError=Ws.PostgrestBuilder=Ws.PostgrestTransformBuilder=Ws.PostgrestFilterBuilder=Ws.PostgrestQueryBuilder=Ws.PostgrestClient=void 0;const f_=Vu(vb);Ws.PostgrestClient=f_.default;const h_=Vu(cm);Ws.PostgrestQueryBuilder=h_.default;const d_=Vu(Qh);Ws.PostgrestFilterBuilder=d_.default;const p_=Vu(um);Ws.PostgrestTransformBuilder=p_.default;const m_=Vu(fm);Ws.PostgrestBuilder=m_.default;const g_=Vu(hm);Ws.PostgrestError=g_.default;var CC=Ws.default={PostgrestClient:f_.default,PostgrestQueryBuilder:h_.default,PostgrestFilterBuilder:d_.default,PostgrestTransformBuilder:p_.default,PostgrestBuilder:m_.default,PostgrestError:g_.default};const{PostgrestClient:TC,PostgrestQueryBuilder:QV,PostgrestFilterBuilder:eq,PostgrestTransformBuilder:tq,PostgrestBuilder:rq,PostgrestError:nq}=CC;function NC(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const DC=NC(),RC="2.11.15",PC=`realtime-js/${RC}`,OC="1.0.0",v_=1e4,MC=1e3;var eh;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(eh||(eh={}));var hs;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(hs||(hs={}));var Qa;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Qa||(Qa={}));var A2;(function(t){t.websocket="websocket"})(A2||(A2={}));var Hl;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Hl||(Hl={}));class FC{constructor(){this.HEADER_LENGTH=1}decode(r,e){return r.constructor===ArrayBuffer?e(this._binaryDecode(r)):e(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const e=new DataView(r),n=new TextDecoder;return this._decodeBroadcast(r,e,n)}_decodeBroadcast(r,e,n){const s=e.getUint8(1),a=e.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(r.slice(i,i+s));i=i+s;const l=n.decode(r.slice(i,i+a));i=i+a;const c=JSON.parse(n.decode(r.slice(i,r.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class b_{constructor(r,e){this.callback=r,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ur;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ur||(Ur={}));const uw=(t,r,e={})=>{var n;const s=(n=e.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(r).reduce((a,i)=>(a[i]=jC(i,t,r,s),a),{})},jC=(t,r,e,n)=>{const s=r.find(o=>o.name===t),a=s==null?void 0:s.type,i=e[t];return a&&!n.includes(a)?y_(a,i):C2(i)},y_=(t,r)=>{if(t.charAt(0)==="_"){const e=t.slice(1,t.length);return $C(r,e)}switch(t){case Ur.bool:return LC(r);case Ur.float4:case Ur.float8:case Ur.int2:case Ur.int4:case Ur.int8:case Ur.numeric:case Ur.oid:return IC(r);case Ur.json:case Ur.jsonb:return BC(r);case Ur.timestamp:return UC(r);case Ur.abstime:case Ur.date:case Ur.daterange:case Ur.int4range:case Ur.int8range:case Ur.money:case Ur.reltime:case Ur.text:case Ur.time:case Ur.timestamptz:case Ur.timetz:case Ur.tsrange:case Ur.tstzrange:return C2(r);default:return C2(r)}},C2=t=>t,LC=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},IC=t=>{if(typeof t=="string"){const r=parseFloat(t);if(!Number.isNaN(r))return r}return t},BC=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(r){return console.log(`JSON parse error: ${r}`),t}return t},$C=(t,r)=>{if(typeof t!="string")return t;const e=t.length-1,n=t[e];if(t[0]==="{"&&n==="}"){let a;const i=t.slice(1,e);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>y_(r,o))}return t},UC=t=>typeof t=="string"?t.replace(" ","T"):t,x_=t=>{let r=t;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")};class B1{constructor(r,e,n={},s=v_){this.channel=r,this.event=e,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,e){var n;return this._hasReceived(r)&&e((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:e}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(e))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var fw;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(fw||(fw={}));class th{constructor(r,e){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=th.syncState(this.state,s,a,i),this.pendingDiffs.forEach(l=>{this.state=th.syncDiff(this.state,l,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=th.syncDiff(this.state,s,a,i),o())}),this.onJoin((s,a,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:i})}),this.onLeave((s,a,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,e,n,s){const a=this.cloneDeep(r),i=this.transformState(e),o={},l={};return this.map(a,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const d=a[c];if(d){const h=u.map(p=>p.presence_ref),f=d.map(p=>p.presence_ref),g=u.filter(p=>f.indexOf(p.presence_ref)<0),m=d.filter(p=>h.indexOf(p.presence_ref)<0);g.length>0&&(o[c]=g),m.length>0&&(l[c]=m)}else o[c]=u}),this.syncDiff(a,{joins:o,leaves:l},n,s)}static syncDiff(r,e,n,s){const{joins:a,leaves:i}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(o,l)=>{var c;const u=(c=r[o])!==null&&c!==void 0?c:[];if(r[o]=this.cloneDeep(l),u.length>0){const d=r[o].map(f=>f.presence_ref),h=u.filter(f=>d.indexOf(f.presence_ref)<0);r[o].unshift(...h)}n(o,u,l)}),this.map(i,(o,l)=>{let c=r[o];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),r[o]=c,s(o,c,l),c.length===0&&delete r[o]}),r}static map(r,e){return Object.getOwnPropertyNames(r).map(n=>e(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((e,n)=>{const s=r[n];return"metas"in s?e[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):e[n]=s,e},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var hw;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(hw||(hw={}));var dw;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(dw||(dw={}));var Ki;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Ki||(Ki={}));class bb{constructor(r,e={config:{}},n){this.topic=r,this.params=e,this.socket=n,this.bindings={},this.state=hs.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new B1(this,Qa.join,this.params,this.timeout),this.rejoinTimer=new b_(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=hs.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=hs.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=hs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=hs.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Qa.reply,{},(s,a)=>{this._trigger(this._replyEventName(a),s)}),this.presence=new th(this),this.broadcastEndpointURL=x_(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(r,e=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==hs.closed){const{config:{broadcast:a,presence:i,private:o}}=this.params;this._onError(u=>r==null?void 0:r(Ki.CHANNEL_ERROR,u)),this._onClose(()=>r==null?void 0:r(Ki.CLOSED));const l={},c={broadcast:a,presence:i,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:u})=>{var d;if(this.socket.setAuth(),u===void 0){r==null||r(Ki.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,f=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,g=[];for(let m=0;m<f;m++){const p=h[m],{filter:{event:v,schema:b,table:y,filter:k}}=p,N=u&&u[m];if(N&&N.event===v&&N.schema===b&&N.table===y&&N.filter===k)g.push(Object.assign(Object.assign({},p),{id:N.id}));else{this.unsubscribe(),this.state=hs.errored,r==null||r(Ki.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,r&&r(Ki.SUBSCRIBED);return}}).receive("error",u=>{this.state=hs.errored,r==null||r(Ki.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{r==null||r(Ki.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,e={}){return await this.send({type:"presence",event:"track",payload:r},e.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,e,n){return this._on(r,e,n)}async send(r,e={}){var n,s;if(!this._canPush()&&r.type==="broadcast"){const{event:a,payload:i}=r,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=e.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,l;const c=this._push(r.type,r,e.timeout||this.timeout);r.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&a("ok"),c.receive("ok",()=>a("ok")),c.receive("error",()=>a("error")),c.receive("timeout",()=>a("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=hs.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Qa.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new B1(this,Qa.leave,{},r),n.receive("ok",()=>{e(),s("ok")}).receive("timeout",()=>{e(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(r,e,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),i=await this.socket.fetch(r,Object.assign(Object.assign({},e),{signal:s.signal}));return clearTimeout(a),i}_push(r,e,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new B1(this,r,e,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(r,e,n){return e}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,e,n){var s,a;const i=r.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Qa;if(n&&[o,l,c,u].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,e,n);if(e&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var g,m,p;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((p=(m=f.filter)===null||m===void 0?void 0:m.event)===null||p===void 0?void 0:p.toLocaleLowerCase())===i}).map(f=>f.callback(h,n)):(a=this.bindings[i])===null||a===void 0||a.filter(f=>{var g,m,p,v,b,y;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in f){const k=f.id,N=(g=f.filter)===null||g===void 0?void 0:g.event;return k&&((m=e.ids)===null||m===void 0?void 0:m.includes(k))&&(N==="*"||(N==null?void 0:N.toLocaleLowerCase())===((p=e.data)===null||p===void 0?void 0:p.type.toLocaleLowerCase()))}else{const k=(b=(v=f==null?void 0:f.filter)===null||v===void 0?void 0:v.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return k==="*"||k===((y=e==null?void 0:e.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===i}).map(f=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:m,table:p,commit_timestamp:v,type:b,errors:y}=g;h=Object.assign(Object.assign({},{schema:m,table:p,commit_timestamp:v,eventType:b,new:{},old:{},errors:y}),this._getPayloadRecords(g))}f.callback(h,n)})}_isClosed(){return this.state===hs.closed}_isJoined(){return this.state===hs.joined}_isJoining(){return this.state===hs.joining}_isLeaving(){return this.state===hs.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,e,n){const s=r.toLocaleLowerCase(),a={type:s,filter:e,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(r,e){const n=r.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&bb.isEqual(s.filter,e))}),this}static isEqual(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const n in r)if(r[n]!==e[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(Qa.close,{},r)}_onError(r){this._on(Qa.error,{},e=>r(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=hs.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const e={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(e.new=uw(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(e.old=uw(r.columns,r.old_record)),e}}const pw=()=>{},HC=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class zC{constructor(r,e){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=v_,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=pw,this.ref=0,this.logger=pw,this.conn=null,this.sendBuffer=[],this.serializer=new FC,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>Ma(async()=>{const{default:l}=await Promise.resolve().then(()=>zu);return{default:l}},void 0).then(({default:l})=>l(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${r}/${A2.websocket}`,this.httpEndpoint=x_(r),e!=null&&e.transport?this.transport=e.transport:this.transport=null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.timeout&&(this.timeout=e.timeout),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),e!=null&&e.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const s=(n=e==null?void 0:e.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=e!=null&&e.reconnectAfterMs?e.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=e!=null&&e.encode?e.encode:(a,i)=>i(JSON.stringify(a)),this.decode=e!=null&&e.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new b_(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(e==null?void 0:e.fetch),e!=null&&e.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(e==null?void 0:e.worker)||!1,this.workerUrl=e==null?void 0:e.workerUrl}this.accessToken=(e==null?void 0:e.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=DC),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:OC}))}disconnect(r,e){this.conn&&(this.conn.onclose=function(){},r?this.conn.close(r,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(r){const e=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const r=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,e,n){this.logger(r,e,n)}connectionState(){switch(this.conn&&this.conn.readyState){case eh.connecting:return Hl.Connecting;case eh.open:return Hl.Open;case eh.closing:return Hl.Closing;default:return Hl.Closed}}isConnected(){return this.connectionState()===Hl.Open}channel(r,e={config:{}}){const n=`realtime:${r}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new bb(`realtime:${r}`,e,this);return this.channels.push(a),a}}push(r){const{topic:e,event:n,payload:s,ref:a}=r,i=()=>{this.encode(r,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${e} ${n} (${a})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(r=null){let e=r||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(n=>{const s={access_token:e,version:PC};e&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Qa.access_token,{access_token:e})}))}async sendHeartbeat(){var r;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(r=this.conn)===null||r===void 0||r.close(MC,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let e=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${r}"`),e.unsubscribe())}_remove(r){this.channels=this.channels.filter(e=>e.topic!==r.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_onConnMessage(r){this.decode(r.data,e=>{let{topic:n,event:s,payload:a,ref:i}=e;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(e.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${n} ${s} ${i&&"("+i+")"||""}`,a),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(s,a,i)),this.stateChangeCallbacks.message.forEach(o=>o(e))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(r=>r())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){this.log("transport","close",r),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(r))}_onConnError(r){this.log("transport",`${r}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(r))}_triggerChanError(){this.channels.forEach(r=>r._trigger(Qa.error))}_appendParams(r,e){if(Object.keys(e).length===0)return r;const n=r.match(/\?/)?"&":"?",s=new URLSearchParams(e);return`${r}${n}${s}`}_workerObjectUrl(r){let e;if(r)e=r;else{const n=new Blob([HC],{type:"application/javascript"});e=URL.createObjectURL(n)}return e}}class yb extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function Bn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class VC extends yb{constructor(r,e){super(r),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class T2 extends yb{constructor(r,e){super(r),this.name="StorageUnknownError",this.originalError=e}}var qC=function(t,r,e,n){function s(a){return a instanceof e?a:new e(function(i){i(a)})}return new(e||(e=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(t,r||[])).next())})};const w_=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>Ma(async()=>{const{default:n}=await Promise.resolve().then(()=>zu);return{default:n}},void 0).then(({default:n})=>n(...e)):r=fetch,(...e)=>r(...e)},WC=()=>qC(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ma(()=>Promise.resolve().then(()=>zu),void 0)).Response:Response}),N2=t=>{if(Array.isArray(t))return t.map(e=>N2(e));if(typeof t=="function"||t!==Object(t))return t;const r={};return Object.entries(t).forEach(([e,n])=>{const s=e.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));r[s]=N2(n)}),r};var fc=function(t,r,e,n){function s(a){return a instanceof e?a:new e(function(i){i(a)})}return new(e||(e=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(t,r||[])).next())})};const $1=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),GC=(t,r,e)=>fc(void 0,void 0,void 0,function*(){const n=yield WC();t instanceof n&&!(e!=null&&e.noResolveJson)?t.json().then(s=>{r(new VC($1(s),t.status||500))}).catch(s=>{r(new T2($1(s),s))}):r(new T2($1(t),t))}),XC=(t,r,e,n)=>{const s={method:t,headers:(r==null?void 0:r.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},r==null?void 0:r.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),e))};function ed(t,r,e,n,s,a){return fc(this,void 0,void 0,function*(){return new Promise((i,o)=>{t(e,XC(r,n,s,a)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>GC(l,o,n))})})}function xp(t,r,e,n){return fc(this,void 0,void 0,function*(){return ed(t,"GET",r,e,n)})}function Wo(t,r,e,n,s){return fc(this,void 0,void 0,function*(){return ed(t,"POST",r,n,s,e)})}function KC(t,r,e,n,s){return fc(this,void 0,void 0,function*(){return ed(t,"PUT",r,n,s,e)})}function YC(t,r,e,n){return fc(this,void 0,void 0,function*(){return ed(t,"HEAD",r,Object.assign(Object.assign({},e),{noResolveJson:!0}),n)})}function __(t,r,e,n,s){return fc(this,void 0,void 0,function*(){return ed(t,"DELETE",r,n,s,e)})}var Us=function(t,r,e,n){function s(a){return a instanceof e?a:new e(function(i){i(a)})}return new(e||(e=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(t,r||[])).next())})};const JC={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},mw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ZC{constructor(r,e={},n,s){this.url=r,this.headers=e,this.bucketId=n,this.fetch=w_(s)}uploadOrUpdate(r,e,n,s){return Us(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},mw),s);let o=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l))):(a=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const c=this._removeEmptyFolders(e),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:r,body:a,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(a){if(Bn(a))return{data:null,error:a};throw a}})}upload(r,e,n){return Us(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,e,n)})}uploadToSignedUrl(r,e,n,s){return Us(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(r),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",e);try{let l;const c=Object.assign({upsert:mw.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),h=yield d.json();return d.ok?{data:{path:a,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(Bn(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(r,e){return Us(this,void 0,void 0,function*(){try{let n=this._getFinalPath(r);const s=Object.assign({},this.headers);e!=null&&e.upsert&&(s["x-upsert"]="true");const a=yield Wo(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new yb("No token returned by API");return{data:{signedUrl:i.toString(),path:r,token:o},error:null}}catch(n){if(Bn(n))return{data:null,error:n};throw n}})}update(r,e,n){return Us(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,e,n)})}move(r,e,n){return Us(this,void 0,void 0,function*(){try{return{data:yield Wo(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Bn(s))return{data:null,error:s};throw s}})}copy(r,e,n){return Us(this,void 0,void 0,function*(){try{return{data:{path:(yield Wo(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Bn(s))return{data:null,error:s};throw s}})}createSignedUrl(r,e,n){return Us(this,void 0,void 0,function*(){try{let s=this._getFinalPath(r),a=yield Wo(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(s){if(Bn(s))return{data:null,error:s};throw s}})}createSignedUrls(r,e,n){return Us(this,void 0,void 0,function*(){try{const s=yield Wo(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:r},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(s){if(Bn(s))return{data:null,error:s};throw s}})}download(r,e){return Us(this,void 0,void 0,function*(){const s=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),i=a?`?${a}`:"";try{const o=this._getFinalPath(r);return{data:yield(yield xp(this.fetch,`${this.url}/${s}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Bn(o))return{data:null,error:o};throw o}})}info(r){return Us(this,void 0,void 0,function*(){const e=this._getFinalPath(r);try{const n=yield xp(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:N2(n),error:null}}catch(n){if(Bn(n))return{data:null,error:n};throw n}})}exists(r){return Us(this,void 0,void 0,function*(){const e=this._getFinalPath(r);try{return yield YC(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Bn(n)&&n instanceof T2){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(r,e){const n=this._getFinalPath(r),s=[],a=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";a!==""&&s.push(a);const o=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(r){return Us(this,void 0,void 0,function*(){try{return{data:yield __(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(e){if(Bn(e))return{data:null,error:e};throw e}})}list(r,e,n){return Us(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},JC),e),{prefix:r||""});return{data:yield Wo(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Bn(s))return{data:null,error:s};throw s}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const e=[];return r.width&&e.push(`width=${r.width}`),r.height&&e.push(`height=${r.height}`),r.resize&&e.push(`resize=${r.resize}`),r.format&&e.push(`format=${r.format}`),r.quality&&e.push(`quality=${r.quality}`),e.join("&")}}const QC="2.7.1",eT={"X-Client-Info":`storage-js/${QC}`};var Bc=function(t,r,e,n){function s(a){return a instanceof e?a:new e(function(i){i(a)})}return new(e||(e=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(t,r||[])).next())})};class tT{constructor(r,e={},n){this.url=r,this.headers=Object.assign(Object.assign({},eT),e),this.fetch=w_(n)}listBuckets(){return Bc(this,void 0,void 0,function*(){try{return{data:yield xp(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(Bn(r))return{data:null,error:r};throw r}})}getBucket(r){return Bc(this,void 0,void 0,function*(){try{return{data:yield xp(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(e){if(Bn(e))return{data:null,error:e};throw e}})}createBucket(r,e={public:!1}){return Bc(this,void 0,void 0,function*(){try{return{data:yield Wo(this.fetch,`${this.url}/bucket`,{id:r,name:r,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Bn(n))return{data:null,error:n};throw n}})}updateBucket(r,e){return Bc(this,void 0,void 0,function*(){try{return{data:yield KC(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Bn(n))return{data:null,error:n};throw n}})}emptyBucket(r){return Bc(this,void 0,void 0,function*(){try{return{data:yield Wo(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(Bn(e))return{data:null,error:e};throw e}})}deleteBucket(r){return Bc(this,void 0,void 0,function*(){try{return{data:yield __(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(e){if(Bn(e))return{data:null,error:e};throw e}})}}class rT extends tT{constructor(r,e={},n){super(r,e,n)}from(r){return new ZC(this.url,this.headers,r,this.fetch)}}const nT="2.50.3";let Bf="";typeof Deno<"u"?Bf="deno":typeof document<"u"?Bf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Bf="react-native":Bf="node";const sT={"X-Client-Info":`supabase-js-${Bf}/${nT}`},aT={headers:sT},iT={schema:"public"},oT={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},lT={};var cT=function(t,r,e,n){function s(a){return a instanceof e?a:new e(function(i){i(a)})}return new(e||(e=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(t,r||[])).next())})};const uT=t=>{let r;return t?r=t:typeof fetch>"u"?r=i_:r=fetch,(...e)=>r(...e)},fT=()=>typeof Headers>"u"?o_:Headers,hT=(t,r,e)=>{const n=uT(e),s=fT();return(a,i)=>cT(void 0,void 0,void 0,function*(){var o;const l=(o=yield r())!==null&&o!==void 0?o:t;let c=new s(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(a,Object.assign(Object.assign({},i),{headers:c}))})};var dT=function(t,r,e,n){function s(a){return a instanceof e?a:new e(function(i){i(a)})}return new(e||(e=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(t,r||[])).next())})};function pT(t){return t.endsWith("/")?t:t+"/"}function mT(t,r){var e,n;const{db:s,auth:a,realtime:i,global:o}=t,{db:l,auth:c,realtime:u,global:d}=r,h={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),a),realtime:Object.assign(Object.assign({},u),i),global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},(e=d==null?void 0:d.headers)!==null&&e!==void 0?e:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>dT(this,void 0,void 0,function*(){return""})};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}const S_="2.70.0",Gc=30*1e3,D2=3,U1=D2*Gc,gT="http://localhost:9999",vT="supabase.auth.token",bT={"X-Client-Info":`gotrue-js/${S_}`},R2="X-Supabase-Api-Version",k_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},yT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,xT=6e5;class xb extends Error{constructor(r,e,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=n}}function hr(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class wT extends xb{constructor(r,e,n){super(r,e,n),this.name="AuthApiError",this.status=e,this.code=n}}function _T(t){return hr(t)&&t.name==="AuthApiError"}class E_ extends xb{constructor(r,e){super(r),this.name="AuthUnknownError",this.originalError=e}}class kl extends xb{constructor(r,e,n,s){super(r,n,s),this.name=e,this.status=n}}class Uo extends kl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ST(t){return hr(t)&&t.name==="AuthSessionMissingError"}class a0 extends kl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class i0 extends kl{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class o0 extends kl{constructor(r,e=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function kT(t){return hr(t)&&t.name==="AuthImplicitGrantRedirectError"}class gw extends kl{constructor(r,e=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class P2 extends kl{constructor(r,e){super(r,"AuthRetryableFetchError",e,void 0)}}function H1(t){return hr(t)&&t.name==="AuthRetryableFetchError"}class vw extends kl{constructor(r,e,n){super(r,"AuthWeakPasswordError",e,"weak_password"),this.reasons=n}}class rh extends kl{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const wp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),bw=` 	
\r=`.split(""),ET=(()=>{const t=new Array(128);for(let r=0;r<t.length;r+=1)t[r]=-1;for(let r=0;r<bw.length;r+=1)t[bw[r].charCodeAt(0)]=-2;for(let r=0;r<wp.length;r+=1)t[wp[r].charCodeAt(0)]=r;return t})();function yw(t,r,e){if(t!==null)for(r.queue=r.queue<<8|t,r.queuedBits+=8;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;e(wp[n]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;e(wp[n]),r.queuedBits-=6}}function A_(t,r,e){const n=ET[t];if(n>-1)for(r.queue=r.queue<<6|n,r.queuedBits+=6;r.queuedBits>=8;)e(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function xw(t){const r=[],e=i=>{r.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=i=>{TT(i,n,e)};for(let i=0;i<t.length;i+=1)A_(t.charCodeAt(i),s,a);return r.join("")}function AT(t,r){if(t<=127){r(t);return}else if(t<=2047){r(192|t>>6),r(128|t&63);return}else if(t<=65535){r(224|t>>12),r(128|t>>6&63),r(128|t&63);return}else if(t<=1114111){r(240|t>>18),r(128|t>>12&63),r(128|t>>6&63),r(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function CT(t,r){for(let e=0;e<t.length;e+=1){let n=t.charCodeAt(e);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(e+1)-56320&65535|s)+65536,e+=1}AT(n,r)}}function TT(t,r,e){if(r.utf8seq===0){if(t<=127){e(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){r.utf8seq=n;break}if(r.utf8seq===2)r.codepoint=t&31;else if(r.utf8seq===3)r.codepoint=t&15;else if(r.utf8seq===4)r.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|t&63,r.utf8seq-=1,r.utf8seq===0&&e(r.codepoint)}}function NT(t){const r=[],e={queue:0,queuedBits:0},n=s=>{r.push(s)};for(let s=0;s<t.length;s+=1)A_(t.charCodeAt(s),e,n);return new Uint8Array(r)}function DT(t){const r=[];return CT(t,e=>r.push(e)),new Uint8Array(r)}function RT(t){const r=[],e={queue:0,queuedBits:0},n=s=>{r.push(s)};return t.forEach(s=>yw(s,e,n)),yw(null,e,n),r.join("")}function PT(t){return Math.round(Date.now()/1e3)+t}function OT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const r=Math.random()*16|0;return(t=="x"?r:r&3|8).toString(16)})}const Ka=()=>typeof window<"u"&&typeof document<"u",jl={tested:!1,writable:!1},nh=()=>{if(!Ka())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(jl.tested)return jl.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),jl.tested=!0,jl.writable=!0}catch{jl.tested=!0,jl.writable=!1}return jl.writable};function MT(t){const r={},e=new URL(t);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((s,a)=>{r[a]=s})}catch{}return e.searchParams.forEach((n,s)=>{r[s]=n}),r}const C_=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>Ma(async()=>{const{default:n}=await Promise.resolve().then(()=>zu);return{default:n}},void 0).then(({default:n})=>n(...e)):r=fetch,(...e)=>r(...e)},FT=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",T_=async(t,r,e)=>{await t.setItem(r,JSON.stringify(e))},l0=async(t,r)=>{const e=await t.getItem(r);if(!e)return null;try{return JSON.parse(e)}catch{return e}},c0=async(t,r)=>{await t.removeItem(r)};class mm{constructor(){this.promise=new mm.promiseConstructor((r,e)=>{this.resolve=r,this.reject=e})}}mm.promiseConstructor=Promise;function z1(t){const r=t.split(".");if(r.length!==3)throw new rh("Invalid JWT structure");for(let n=0;n<r.length;n++)if(!yT.test(r[n]))throw new rh("JWT not in base64url format");return{header:JSON.parse(xw(r[0])),payload:JSON.parse(xw(r[1])),signature:NT(r[2]),raw:{header:r[0],payload:r[1]}}}async function jT(t){return await new Promise(r=>{setTimeout(()=>r(null),t)})}function LT(t,r){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await t(a);if(!r(a,null,i)){n(i);return}}catch(i){if(!r(a,i)){s(i);return}}})()})}function IT(t){return("0"+t.toString(16)).substr(-2)}function BT(){const r=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=e.length;let s="";for(let a=0;a<56;a++)s+=e.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(r),Array.from(r,IT).join("")}async function $T(t){const e=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",e),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function UT(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const e=await $T(t);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $c(t,r,e=!1){const n=BT();let s=n;e&&(s+="/PASSWORD_RECOVERY"),await T_(t,`${r}-code-verifier`,s);const a=await UT(n);return[a,n===a?"plain":"s256"]}const HT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function zT(t){const r=t.headers.get(R2);if(!r||!r.match(HT))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function VT(t){if(!t)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(t<=r)throw new Error("JWT has expired")}function qT(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const WT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Uc(t){if(!WT.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var GT=function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(e[n[s]]=t[n[s]]);return e};const $l=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),XT=[502,503,504];async function ww(t){var r;if(!FT(t))throw new P2($l(t),0);if(XT.includes(t.status))throw new P2($l(t),t.status);let e;try{e=await t.json()}catch(a){throw new E_($l(a),a)}let n;const s=zT(t);if(s&&s.getTime()>=k_["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?n=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(n=e.error_code),n){if(n==="weak_password")throw new vw($l(e),t.status,((r=e.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new Uo}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new vw($l(e),t.status,e.weak_password.reasons);throw new wT($l(e),t.status||500,n)}const KT=(t,r,e,n)=>{const s={method:t,headers:(r==null?void 0:r.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r==null?void 0:r.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),e))};async function mr(t,r,e,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[R2]||(a[R2]=k_["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const i=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await YT(t,r,e+o,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function YT(t,r,e,n,s,a){const i=KT(r,n,s,a);let o;try{o=await t(e,Object.assign({},i))}catch(l){throw console.error(l),new P2($l(l),0)}if(o.ok||await ww(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await ww(l)}}function Gi(t){var r;let e=null;eN(t)&&(e=Object.assign({},t),t.expires_at||(e.expires_at=PT(t.expires_in)));const n=(r=t.user)!==null&&r!==void 0?r:t;return{data:{session:e,user:n},error:null}}function _w(t){const r=Gi(t);return!r.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((e,n)=>e&&typeof n=="string",!0)&&(r.data.weak_password=t.weak_password),r}function Yo(t){var r;return{data:{user:(r=t.user)!==null&&r!==void 0?r:t},error:null}}function JT(t){return{data:t,error:null}}function ZT(t){const{action_link:r,email_otp:e,hashed_token:n,redirect_to:s,verification_type:a}=t,i=GT(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:r,email_otp:e,hashed_token:n,redirect_to:s,verification_type:a},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function QT(t){return t}function eN(t){return t.access_token&&t.refresh_token&&t.expires_in}const V1=["global","local","others"];var tN=function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(e[n[s]]=t[n[s]]);return e};class rN{constructor({url:r="",headers:e={},fetch:n}){this.url=r,this.headers=e,this.fetch=C_(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,e=V1[0]){if(V1.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${V1.join(", ")}`);try{return await mr(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(hr(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,e={}){try{return await mr(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Yo})}catch(n){if(hr(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:e}=r,n=tN(r,["options"]),s=Object.assign(Object.assign({},n),e);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await mr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:ZT,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(hr(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(r){try{return await mr(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:Yo})}catch(e){if(hr(e))return{data:{user:null},error:e};throw e}}async listUsers(r){var e,n,s,a,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await mr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(e=r==null?void 0:r.page)===null||e===void 0?void 0:e.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=r==null?void 0:r.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:QT});if(u.error)throw u.error;const d=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,f=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(g.split(";")[1].split("=")[1]);c[`${p}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(hr(c))return{data:{users:[]},error:c};throw c}}async getUserById(r){Uc(r);try{return await mr(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:Yo})}catch(e){if(hr(e))return{data:{user:null},error:e};throw e}}async updateUserById(r,e){Uc(r);try{return await mr(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:e,headers:this.headers,xform:Yo})}catch(n){if(hr(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,e=!1){Uc(r);try{return await mr(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:e},xform:Yo})}catch(n){if(hr(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){Uc(r.userId);try{const{data:e,error:n}=await mr(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:e,error:n}}catch(e){if(hr(e))return{data:null,error:e};throw e}}async _deleteFactor(r){Uc(r.userId),Uc(r.id);try{return{data:await mr(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(e){if(hr(e))return{data:null,error:e};throw e}}}const nN={getItem:t=>nh()?globalThis.localStorage.getItem(t):null,setItem:(t,r)=>{nh()&&globalThis.localStorage.setItem(t,r)},removeItem:t=>{nh()&&globalThis.localStorage.removeItem(t)}};function Sw(t={}){return{getItem:r=>t[r]||null,setItem:(r,e)=>{t[r]=e},removeItem:r=>{delete t[r]}}}function sN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Hc={debug:!!(globalThis&&nh()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class N_ extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class aN extends N_{}async function iN(t,r,e){Hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),Hc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await e()}finally{Hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(r===0)throw Hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new aN(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Hc.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}sN();const oN={url:gT,storageKey:vT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:bT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function kw(t,r,e){return await e()}class Mh{constructor(r){var e,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Mh.nextInstanceID,Mh.nextInstanceID+=1,this.instanceID>0&&Ka()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},oN),r);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new rN({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=C_(s.fetch),this.lock=s.lock||kw,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Ka()&&(!((e=globalThis==null?void 0:globalThis.navigator)===null||e===void 0)&&e.locks)?this.lock=iN:this.lock=kw,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:nh()?this.storage=nN:(this.memoryStorage={},this.storage=Sw(this.memoryStorage)):(this.memoryStorage={},this.storage=Sw(this.memoryStorage)),Ka()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${S_}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const e=MT(window.location.href);let n="none";if(this._isImplicitGrantCallback(e)?n="implicit":await this._isPKCECallback(e)&&(n="pkce"),Ka()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(e,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),kT(a)){const l=(r=a.details)===null||r===void 0?void 0:r.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return hr(e)?{error:e}:{error:new E_("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var e,n,s;try{const a=await mr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(e=r==null?void 0:r.options)===null||e===void 0?void 0:e.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=r==null?void 0:r.options)===null||s===void 0?void 0:s.captchaToken}},xform:Gi}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(hr(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(r){var e,n,s;try{let a;if("email"in r){const{email:u,password:d,options:h}=r;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await $c(this.storage,this.storageKey)),a=await mr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:d,data:(e=h==null?void 0:h.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:g},xform:Gi})}else if("phone"in r){const{phone:u,password:d,options:h}=r;a=await mr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Gi})}else throw new i0("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(hr(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(r){try{let e;if("email"in r){const{email:a,password:i,options:o}=r;e=await mr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:_w})}else if("phone"in r){const{phone:a,password:i,options:o}=r;e=await mr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:_w})}else throw new i0("You must provide either an email or phone number and a password");const{data:n,error:s}=e;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new a0}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(e){if(hr(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(r){var e,n,s,a;return await this._handleProviderSignIn(r.provider,{redirectTo:(e=r.options)===null||e===void 0?void 0:e.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=r.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=r.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:e}=r;if(e==="solana")return await this.signInWithSolana(r);throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}async signInWithSolana(r){var e,n,s,a,i,o,l,c,u,d,h,f;let g,m;if("message"in r)g=r.message,m=r.signature;else{const{chain:p,wallet:v,statement:b,options:y}=r;let k;if(Ka())if(typeof v=="object")k=v;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))k=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=v}const N=new URL((e=y==null?void 0:y.url)!==null&&e!==void 0?e:window.location.href);if("signIn"in k&&k.signIn){const L=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),b?{statement:b}:null));let F;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")F=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)F=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)g=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),m=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${N.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(s=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((d=(u=y==null?void 0:y.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||d===void 0)&&d.length?["Resources",...y.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const L=await k.signMessage(new TextEncoder().encode(g),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=L}}try{const{data:p,error:v}=await mr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:RT(m)},!((h=r.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=r.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Gi});if(v)throw v;return!p||!p.session||!p.user?{data:{user:null,session:null},error:new a0}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),{data:Object.assign({},p),error:v})}catch(p){if(hr(p))return{data:{user:null,session:null},error:p};throw p}}async _exchangeCodeForSession(r){const e=await l0(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(e??"").split("/");try{const{data:a,error:i}=await mr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:Gi});if(await c0(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new a0}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:i})}catch(a){if(hr(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(r){try{const{options:e,provider:n,token:s,access_token:a,nonce:i}=r,o=await mr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:Gi}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new a0}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(e){if(hr(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(r){var e,n,s,a,i;try{if("email"in r){const{email:o,options:l}=r;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await $c(this.storage,this.storageKey));const{error:d}=await mr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(e=l==null?void 0:l.data)!==null&&e!==void 0?e:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in r){const{phone:o,options:l}=r,{data:c,error:u}=await mr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(a=l==null?void 0:l.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new i0("You must provide either an email or phone number.")}catch(o){if(hr(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(r){var e,n;try{let s,a;"options"in r&&(s=(e=r.options)===null||e===void 0?void 0:e.redirectTo,a=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await mr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:Gi});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(hr(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(r){var e,n,s;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await $c(this.storage,this.storageKey)),await mr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(e=r.options)===null||e===void 0?void 0:e.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=r==null?void 0:r.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:JT})}catch(a){if(hr(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:e},error:n}=r;if(n)throw n;if(!e)throw new Uo;const{error:s}=await mr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:s}})}catch(r){if(hr(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const e=`${this.url}/resend`;if("email"in r){const{email:n,type:s,options:a}=r,{error:i}=await mr(this.fetch,"POST",e,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in r){const{phone:n,type:s,options:a}=r,{data:i,error:o}=await mr(this.fetch,"POST",e,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new i0("You must provide either an email or phone number and a type")}catch(e){if(hr(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(r,e){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await e()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=e();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await r(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const e=await l0(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?r=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at*1e3-Date.now()<U1:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.storage.isServer){let i=this.suppressGetSessionWarning;r=new Proxy(r,{get:(l,c,u)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:r},error:null}}const{session:s,error:a}=await this._callRefreshToken(r.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await mr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Yo}):await this._useSession(async e=>{var n,s,a;const{data:i,error:o}=e;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Uo}:await mr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Yo})})}catch(e){if(hr(e))return ST(e)&&(await this._removeSession(),await c0(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(r,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,e))}async _updateUser(r,e={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new Uo;const i=s.session;let o=null,l=null;this.flowType==="pkce"&&r.email!=null&&([o,l]=await $c(this.storage,this.storageKey));const{data:c,error:u}=await mr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:Yo});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(hr(n))return{data:{user:null},error:n};throw n}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new Uo;const e=Date.now()/1e3;let n=e,s=!0,a=null;const{payload:i}=z1(r.access_token);if(i.exp&&(n=i.exp,s=n<=e),s){const{session:o,error:l}=await this._callRefreshToken(r.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:l}=await this._getUser(r.access_token);if(l)throw l;a={access_token:r.access_token,refresh_token:r.refresh_token,user:o.user,token_type:"bearer",expires_in:n-e,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(e){if(hr(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async e=>{var n;if(!r){const{data:i,error:o}=e;if(o)throw o;r=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(r!=null&&r.refresh_token))throw new Uo;const{session:s,error:a}=await this._callRefreshToken(r.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(hr(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(r,e){try{if(!Ka())throw new o0("No browser detected.");if(r.error||r.error_description||r.error_code)throw new o0(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new gw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new o0("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new gw("No code detected.");const{data:b,error:y}=await this._exchangeCodeForSession(r.code);if(y)throw y;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=r;if(!a||!o||!i||!c)throw new o0("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(o);let h=u+d;l&&(h=parseInt(l));const f=h-u;f*1e3<=Gc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${d}s`);const g=h-d;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,u);const{data:m,error:p}=await this._getUser(a);if(p)throw p;const v={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:d,expires_at:h,refresh_token:i,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:r.type},error:null}}catch(n){if(hr(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const e=await l0(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&e)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async e=>{var n;const{data:s,error:a}=e;if(a)return{error:a};const i=(n=s.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,r);if(o&&!(_T(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return r!=="others"&&(await this._removeSession(),await c0(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const e=OT(),n={id:e,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async e=>{var n,s;try{const{data:{session:a},error:i}=e;if(i)throw i;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",r,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(r))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",a),console.error(a)}})}async resetPasswordForEmail(r,e={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await $c(this.storage,this.storageKey,!0));try{return await mr(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(a){if(hr(a))return{data:null,error:a};throw a}}async getUserIdentities(){var r;try{const{data:e,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(r=e.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(e){if(hr(e))return{data:null,error:e};throw e}}async linkIdentity(r){var e;try{const{data:n,error:s}=await this._useSession(async a=>{var i,o,l,c,u;const{data:d,error:h}=a;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(i=r.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=r.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=r.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await mr(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Ka()&&!(!((e=r.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:r.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(hr(n))return{data:{provider:r.provider,url:null},error:n};throw n}}async unlinkIdentity(r){try{return await this._useSession(async e=>{var n,s;const{data:a,error:i}=e;if(i)throw i;return await mr(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(e){if(hr(e))return{data:null,error:e};throw e}}async _refreshAccessToken(r){const e=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(e,"begin");try{const n=Date.now();return await LT(async s=>(s>0&&await jT(200*Math.pow(2,s-1)),this._debug(e,"refreshing attempt",s),await mr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:Gi})),(s,a)=>{const i=200*Math.pow(2,s);return a&&H1(a)&&Date.now()+i-n<Gc})}catch(n){if(this._debug(e,"error",n),hr(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(e,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,e){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",e,"url",n),Ka()&&!e.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r;const e="#_recoverAndRefresh()";this._debug(e,"begin");try{const n=await l0(this.storage,this.storageKey);if(this._debug(e,"session from storage",n),!this._isValidSession(n)){this._debug(e,"session is not valid"),n!==null&&await this._removeSession();return}const s=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<U1;if(this._debug(e,`session has${s?"":" not"} expired with margin of ${U1}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),H1(a)||(this._debug(e,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(e,"error",n),console.error(n);return}finally{this._debug(e,"end")}}async _callRefreshToken(r){var e,n;if(!r)throw new Uo;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new mm;const{data:a,error:i}=await this._refreshAccessToken(r);if(i)throw i;if(!a.session)throw new Uo;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(s,"error",a),hr(a)){const i={session:null,error:a};return H1(a)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(r,e,n=!0){const s=`#_notifyAllSubscribers(${r})`;this._debug(s,"begin",e,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:e});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(r,e)}catch(l){a.push(l)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0,await T_(this.storage,this.storageKey,r)}async _removeSession(){this._debug("#_removeSession()"),await c0(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Ka()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",r)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),Gc);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-r)/Gc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Gc}ms, refresh threshold is ${D2} ticks`),s<=D2&&await this._callRefreshToken(n.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof N_)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ka()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const e=`#_onVisibilityChanged(${r})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,e,n){const s=[`provider=${encodeURIComponent(e)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,i]=await $c(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${s.join("&")}`}async _unenroll(r){try{return await this._useSession(async e=>{var n;const{data:s,error:a}=e;return a?{data:null,error:a}:await mr(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(e){if(hr(e))return{data:null,error:e};throw e}}async _enroll(r){try{return await this._useSession(async e=>{var n,s;const{data:a,error:i}=e;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:l,error:c}=await mr(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(r.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(e){if(hr(e))return{data:null,error:e};throw e}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:s,error:a}=e;if(a)return{data:null,error:a};const{data:i,error:o}=await mr(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(e){if(hr(e))return{data:null,error:e};throw e}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:s,error:a}=e;return a?{data:null,error:a}:await mr(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(e){if(hr(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(r){const{data:e,error:n}=await this._challenge({factorId:r.factorId});return n?{data:null,error:n}:await this._verify({factorId:r.factorId,challengeId:e.id,code:r.code})}async _listFactors(){const{data:{user:r},error:e}=await this.getUser();if(e)return{data:null,error:e};const n=(r==null?void 0:r.factors)||[],s=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),a=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:s,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var e,n;const{data:{session:s},error:a}=r;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=z1(s.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(r,e={keys:[]}){let n=e.keys.find(i=>i.kid===r);if(n||(n=this.jwks.keys.find(i=>i.kid===r),n&&this.jwks_cached_at+xT>Date.now()))return n;const{data:s,error:a}=await mr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!s.keys||s.keys.length===0)throw new rh("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(i=>i.kid===r),!n)throw new rh("No matching signing key found in JWKS");return n}async getClaims(r,e={keys:[]}){try{let n=r;if(!n){const{data:f,error:g}=await this.getSession();if(g||!f.session)return{data:null,error:g};n=f.session.access_token}const{header:s,payload:a,signature:i,raw:{header:o,payload:l}}=z1(n);if(VT(a.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:f}=await this.getUser(n);if(f)throw f;return{data:{claims:a,header:s,signature:i},error:null}}const c=qT(s.alg),u=await this.fetchJwk(s.kid,e),d=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,i,DT(`${o}.${l}`)))throw new rh("Invalid JWT signature");return{data:{claims:a,header:s,signature:i},error:null}}catch(n){if(hr(n))return{data:null,error:n};throw n}}}Mh.nextInstanceID=0;const lN=Mh;class cN extends lN{constructor(r){super(r)}}var uN=function(t,r,e,n){function s(a){return a instanceof e?a:new e(function(i){i(a)})}return new(e||(e=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(d){i(d)}}function l(u){try{c(n.throw(u))}catch(d){i(d)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(t,r||[])).next())})};class fN{constructor(r,e,n){var s,a,i;if(this.supabaseUrl=r,this.supabaseKey=e,!r)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const o=pT(r),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:iT,realtime:lT,auth:Object.assign(Object.assign({},oT),{storageKey:c}),global:aT},d=mT(n??{},u);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=hT(e,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new TC(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new sC(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new rT(this.storageUrl.href,this.headers,this.fetch)}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,e={},n={}){return this.rest.rpc(r,e,n)}channel(r,e={config:{}}){return this.realtime.channel(r,e)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,e;return uN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(e=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:e,detectSessionInUrl:n,storage:s,storageKey:a,flowType:i,lock:o,debug:l},c,u){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new cN({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),c),storageKey:a,autoRefreshToken:r,persistSession:e,detectSessionInUrl:n,storage:s,flowType:i,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new zC(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r==null?void 0:r.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,n)=>{this._handleTokenChanged(e,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(r,e,n){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:r==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const hN=(t,r,e)=>new fN(t,r,e),dN="https://zndkprjytuhzufdqhnmt.supabase.co",pN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpuZGtwcmp5dHVoenVmZHFobm10Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM0OTg5OTgsImV4cCI6MjA1OTA3NDk5OH0._1xM__KPGNlr3HG3-An2fy3kKfIxWU-AXJnrMpdWYok",Lt=hN(dN,pN),O2=["Ar","Ta","Ge","Cn","Le","Vi","Li","Sc","Sg","Cp","Aq","Pi"],mN=["Su","Mo","Ma","Me","Ju","Ve","Sa","Ra","Ke"],zs=["D-1","D-9","D-10","D-3","D-4","D-7","D-12","D-27","D-30","D-60","D-5","D-11","D-81","D-108","D-144"],q1={group1:["Ar","Cn","Li","Cp"],group2:["Ta","Le","Sc","Aq"],group3:["Ge","Vi","Sg","Pi"]},gN=["Ar","Ta","Ge"],zl=t=>q1.group1.includes(t)?"bg-[#DCEDC1] text-black":q1.group2.includes(t)?"bg-[#FFD3B6] text-black":q1.group3.includes(t)?"bg-[#FFAAA5] text-black":"",Ew=t=>gN.includes(t)?"font-bold":"",vN=(t,r)=>{if(!t||!r)return null;const e=O2.indexOf(t),n=O2.indexOf(r);if(e===-1||n===-1)return null;if(t===r)return 1;let s=1,a=e;for(;a!==n;)a=(a+1)%12,s++;return s},M2=(t,r)=>{const e={},n=Object.entries(r).sort(([s],[a])=>Number(s)-Number(a)).map(([s,a])=>({day:Number(s),date:a}));for(let s=0;s<n.length-1;s++){const a=n[s],i=n[s+1];[...new Set(t.map(l=>l.hr_number))].forEach(l=>{const c=t.filter(d=>d.date===a.date&&d.hr_number===l),u=t.filter(d=>d.date===i.date&&d.hr_number===l);zs.forEach(d=>{var g,m;const h=(g=c.find(p=>p.topic===d))==null?void 0:g.planet_house,f=(m=u.find(p=>p.topic===d))==null?void 0:m.planet_house;if(console.log(`HR: ${l}, Division: ${d}, Current Date: ${a.date}, Next Date: ${i.date}, Current House: ${h}, Next House: ${f}`),h&&f){const p=vN(h,f);if(p!==null){const v=parseInt(l.split("-")[1]);e[`${v}_${d}_${i.day}`]=p}}})})}return e},bN=(t,r,e)=>{const n={};for(let s=1;s<=e;s++)n[s]={Ar:0,Ta:0,Ge:0};return t.forEach(s=>{var o;if(!s.planet_house||s.date!==r)return;const a=(o=s.hr_number)==null?void 0:o.match(/\d+$/),i=a?parseInt(a[0]):null;i&&i<=e&&(["Ar","Cn","Li","Cp"].includes(s.planet_house)?n[i].Ar++:["Ta","Le","Sc","Aq"].includes(s.planet_house)?n[i].Ta++:["Ge","Vi","Sg","Pi"].includes(s.planet_house)&&n[i].Ge++)}),n};function yN({onAddDate:t,existingDates:r}){const[e,n]=Se.useState(""),[s,a]=Se.useState(""),i=()=>{if(!r||r.length===0)return"";const l=[...r].sort((u,d)=>new Date(d)-new Date(u)),c=new Date(l[0]);return c.setDate(c.getDate()+1),c.toISOString().split("T")[0]},o=async l=>{if(l.preventDefault(),a(""),!e){a("Select date");return}if(r.includes(e)){a("Date exists");return}await t(e)&&n("")};return X.jsxs("form",{onSubmit:o,className:"flex items-center gap-1",children:[X.jsx("input",{type:"date",value:e,onChange:l=>n(l.target.value),min:i(),className:"text-xs rounded border-gray-300",title:r.length>0?`Dates up to and including ${new Date(r.sort((l,c)=>new Date(c)-new Date(l))[0]).toLocaleDateString()} are disabled`:""}),X.jsx("button",{type:"submit",className:"bg-green-500 text-white px-2 py-1 text-xs rounded hover:bg-green-600",children:"Add"}),s&&X.jsx("span",{className:"text-xs text-red-600",children:s})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var D_=1252,xN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_b=function(t){xN.indexOf(t)!=-1&&(D_=wb[0]=t)};function wN(){_b(1252)}var ni=function(t){_b(t)};function R_(){ni(1200),wN()}function Aw(t){for(var r=[],e=0,n=t.length;e<n;++e)r[e]=t.charCodeAt(e);return r}function _N(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return r.join("")}function P_(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return r.join("")}var $f=function(t){var r=t.charCodeAt(0),e=t.charCodeAt(1);return r==255&&e==254?_N(t.slice(2)):r==254&&e==255?P_(t.slice(2)):r==65279?t.slice(1):t},u0=function(r){return String.fromCharCode(r)},Cw=function(r){return String.fromCharCode(r)},F2,tl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Tw(t){for(var r="",e=0,n=0,s=0,a=0,i=0,o=0,l=0,c=0;c<t.length;)e=t.charCodeAt(c++),a=e>>2,n=t.charCodeAt(c++),i=(e&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),r+=tl.charAt(a)+tl.charAt(i)+tl.charAt(o)+tl.charAt(l);return r}function pa(t){var r="",e=0,n=0,s=0,a=0,i=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)a=tl.indexOf(t.charAt(c++)),i=tl.indexOf(t.charAt(c++)),e=a<<2|i>>4,r+=String.fromCharCode(e),o=tl.indexOf(t.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(n)),l=tl.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(r+=String.fromCharCode(s));return r}var yr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),hc=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function gl(t){return yr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Nw(t){return yr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ri=function(r){return yr?hc(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function dc(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function Sb(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Sb(new Uint8Array(t));for(var r=new Array(t.length),e=0;e<t.length;++e)r[e]=t[e];return r}var Jo=yr?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:hc(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var n=new Uint8Array(e),s=0;for(r=0,e=0;r<t.length;e+=s,++r)if(s=t[r].length,t[r]instanceof Uint8Array)n.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";n.set(new Uint8Array(t[r]),e)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function SN(t){for(var r=[],e=0,n=t.length+250,s=gl(t.length+255),a=0;a<t.length;++a){var i=t.charCodeAt(a);if(i<128)s[e++]=i;else if(i<2048)s[e++]=192|i>>6&31,s[e++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=t.charCodeAt(++a)&1023;s[e++]=240|i>>8&7,s[e++]=128|i>>2&63,s[e++]=128|o>>6&15|(i&3)<<4,s[e++]=128|o&63}else s[e++]=224|i>>12&15,s[e++]=128|i>>6&63,s[e++]=128|i&63;e>n&&(r.push(s.slice(0,e)),e=0,s=gl(65535),n=65530)}return r.push(s.slice(0,e)),Jo(r)}var Os=/\u0000/g,Uf=/[\u0001-\u0006]/g;function vu(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function si(t,r){var e=""+t;return e.length>=r?e:an("0",r-e.length)+e}function kb(t,r){var e=""+t;return e.length>=r?e:an(" ",r-e.length)+e}function _p(t,r){var e=""+t;return e.length>=r?e:e+an(" ",r-e.length)}function kN(t,r){var e=""+Math.round(t);return e.length>=r?e:an("0",r-e.length)+e}function EN(t,r){var e=""+t;return e.length>=r?e:an("0",r-e.length)+e}var Dw=Math.pow(2,32);function zc(t,r){if(t>Dw||t<-Dw)return kN(t,r);var e=Math.round(t);return EN(e,r)}function Sp(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var Rw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],W1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function AN(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var dr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Pw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},CN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function kp(t,r,e){for(var n=t<0?-1:1,s=t*n,a=0,i=1,o=0,l=1,c=0,u=0,d=Math.floor(s);c<r&&(d=Math.floor(s),o=d*i+a,u=d*c+l,!(s-d<5e-8));)s=1/(s-d),a=i,i=o,l=c,c=u;if(u>r&&(c>r?(u=l,o=a):(u=c,o=i)),!e)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function Kl(t,r,e){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,i=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=e?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=e?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),e&&(a=ON(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var O_=new Date(1899,11,31,0,0,0),TN=O_.getTime(),NN=new Date(1900,2,1,0,0,0);function M_(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=NN&&(e+=24*60*60*1e3),(e-(TN+(t.getTimezoneOffset()-O_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Eb(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function DN(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function RN(t){var r=t<0?12:11,e=Eb(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function PN(t){var r=Eb(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function Fh(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=RN(t):r===10?e=t.toFixed(10).substr(0,12):e=PN(t),Eb(DN(e.toUpperCase()))}function ic(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Fh(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return La(14,M_(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function ON(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function MN(t,r,e,n){var s="",a=0,i=0,o=e.y,l,c=0;switch(t){case 98:o=e.y+543;case 121:switch(r.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(r.length){case 1:case 2:l=e.m,c=r.length;break;case 3:return W1[e.m-1][1];case 5:return W1[e.m-1][0];default:return W1[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:l=e.d,c=r.length;break;case 3:return Rw[e.q][0];default:return Rw[e.q][1]}break;case 104:switch(r.length){case 1:case 2:l=1+(e.H+11)%12,c=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:l=e.H,c=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:l=e.M,c=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?si(e.S,r.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(e.S+e.u)),a>=60*i&&(a=0),r==="s"?a===0?"0":""+a/i:(s=si(a,2+n),r==="ss"?s.substr(0,2):"."+s.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":l=e.D*24+e.H;break;case"[m]":case"[mm]":l=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":l=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}c=r.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?si(l,c):"";return u}function rl(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,n=t.substr(0,e);e!=t.length;e+=r)n+=(n.length>0?",":"")+t.substr(e,r);return n}var F_=/%/g;function FN(t,r,e){var n=r.replace(F_,""),s=r.length-n.length;return ro(t,n,e*Math.pow(10,2*s))+an("%",s)}function jN(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ro(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function j_(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+j_(t,-r);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%s;if(a<0&&(a+=s),e=(r/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),e.indexOf("e")===-1){var i=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(i-e.length+a):e+="E+"+(i-a);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,s)+"."+e.substr(2+s),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var L_=/# (\?+)( ?)\/( ?)(\d+)/;function LN(t,r,e){var n=parseInt(t[4],10),s=Math.round(r*n),a=Math.floor(s/n),i=s-a*n,o=n;return e+(a===0?"":""+a)+" "+(i===0?an(" ",t[1].length+1+t[4].length):kb(i,t[1].length)+t[2]+"/"+t[3]+si(o,t[4].length))}function IN(t,r,e){return e+(r===0?"":""+r)+an(" ",t[1].length+2+t[4].length)}var I_=/^#*0*\.([0#]+)/,B_=/\).*[0#]/,$_=/\(###\) ###\\?-####/;function Ns(t){for(var r="",e,n=0;n!=t.length;++n)switch(e=t.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function Ow(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function Mw(t,r){var e=t-Math.floor(t),n=Math.pow(10,r);return r<(""+Math.round(e*n)).length?0:Math.round(e*n)}function BN(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function $N(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ta(t,r,e){if(t.charCodeAt(0)===40&&!r.match(B_)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ta("n",n,e):"("+Ta("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return jN(t,r,e);if(r.indexOf("%")!==-1)return FN(t,r,e);if(r.indexOf("E")!==-1)return j_(r,e);if(r.charCodeAt(0)===36)return"$"+Ta(t,r.substr(r.charAt(1)==" "?2:1),e);var s,a,i,o,l=Math.abs(e),c=e<0?"-":"";if(r.match(/^00+$/))return c+zc(l,r.length);if(r.match(/^[#?]+$/))return s=zc(e,0),s==="0"&&(s=""),s.length>r.length?s:Ns(r.substr(0,r.length-s.length))+s;if(a=r.match(L_))return LN(a,l,c);if(r.match(/^#+0+$/))return c+zc(l,r.length-r.indexOf("0"));if(a=r.match(I_))return s=Ow(e,a[1].length).replace(/^([^\.]+)$/,"$1."+Ns(a[1])).replace(/\.$/,"."+Ns(a[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+an("0",Ns(a[1]).length-m.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return c+Ow(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return c+rl(zc(l,0));if(a=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ta(t,r,-e):rl(""+(Math.floor(e)+BN(e,a[1].length)))+"."+si(Mw(e,a[1].length),a[1].length);if(a=r.match(/^#,#*,#0/))return Ta(t,r.replace(/^#,#*,/,""),e);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=vu(Ta(t,r.replace(/[\\-]/g,""),e)),i=0,vu(vu(r.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(r.match($_))return s=Ta(t,"##########",e),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=kp(l,Math.pow(10,i)-1,!1),s=""+c,u=ro("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=_p(o[2],i),u.length<a[4].length&&(u=Ns(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=kp(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?kb(o[1],i)+a[2]+"/"+a[3]+_p(o[2],i):an(" ",2*i+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return s=zc(e,0),r.length<=s.length?s:Ns(r.substr(0,r.length-s.length))+s;if(a=r.match(/^([#0?]+)\.([#0]+)$/)){s=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=r.indexOf(".")-i,h=r.length-s.length-d;return Ns(r.substr(0,d)+s+r.substr(r.length-h))}if(a=r.match(/^00,000\.([#0]*0)$/))return i=Mw(e,a[1].length),e<0?"-"+Ta(t,r,-e):rl($N(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?si(0,3-g.length):"")+g})+"."+si(i,a[1].length);switch(r){case"###,##0.00":return Ta(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var f=rl(zc(l,0));return f!=="0"?c+f:"";case"###,###.00":return Ta(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Ta(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function UN(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ro(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function HN(t,r,e){var n=r.replace(F_,""),s=r.length-n.length;return ro(t,n,e*Math.pow(10,2*s))+an("%",s)}function U_(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+U_(t,-r);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%s;if(a<0&&(a+=s),e=(r/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!e.match(/[Ee]/)){var i=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(i-e.length+a):e+="E+"+(i-a),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function vi(t,r,e){if(t.charCodeAt(0)===40&&!r.match(B_)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?vi("n",n,e):"("+vi("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return UN(t,r,e);if(r.indexOf("%")!==-1)return HN(t,r,e);if(r.indexOf("E")!==-1)return U_(r,e);if(r.charCodeAt(0)===36)return"$"+vi(t,r.substr(r.charAt(1)==" "?2:1),e);var s,a,i,o,l=Math.abs(e),c=e<0?"-":"";if(r.match(/^00+$/))return c+si(l,r.length);if(r.match(/^[#?]+$/))return s=""+e,e===0&&(s=""),s.length>r.length?s:Ns(r.substr(0,r.length-s.length))+s;if(a=r.match(L_))return IN(a,l,c);if(r.match(/^#+0+$/))return c+si(l,r.length-r.indexOf("0"));if(a=r.match(I_))return s=(""+e).replace(/^([^\.]+)$/,"$1."+Ns(a[1])).replace(/\.$/,"."+Ns(a[1])),s=s.replace(/\.(\d*)$/,function(g,m){return"."+m+an("0",Ns(a[1]).length-m.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return c+rl(""+l);if(a=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+vi(t,r,-e):rl(""+e)+"."+an("0",a[1].length);if(a=r.match(/^#,#*,#0/))return vi(t,r.replace(/^#,#*,/,""),e);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=vu(vi(t,r.replace(/[\\-]/g,""),e)),i=0,vu(vu(r.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(r.match($_))return s=vi(t,"##########",e),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=kp(l,Math.pow(10,i)-1,!1),s=""+c,u=ro("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=_p(o[2],i),u.length<a[4].length&&(u=Ns(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=kp(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?kb(o[1],i)+a[2]+"/"+a[3]+_p(o[2],i):an(" ",2*i+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return s=""+e,r.length<=s.length?s:Ns(r.substr(0,r.length-s.length))+s;if(a=r.match(/^([#0]+)\.([#0]+)$/)){s=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=r.indexOf(".")-i,h=r.length-s.length-d;return Ns(r.substr(0,d)+s+r.substr(r.length-h))}if(a=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+vi(t,r,-e):rl(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?si(0,3-g.length):"")+g})+"."+si(0,a[1].length);switch(r){case"###,###":case"##,###":case"#,###":var f=rl(""+l);return f!=="0"?c+f:"";default:if(r.match(/\.[0#?]*$/))return vi(t,r.slice(0,r.lastIndexOf(".")),e)+Ns(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function ro(t,r,e){return(e|0)===e?vi(t,r,e):Ta(t,r,e)}function zN(t){for(var r=[],e=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=t.substr(s,n-s),s=n+1}if(r[r.length]=t.substr(s),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var H_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function qu(t){for(var r=0,e="",n="";r<t.length;)switch(e=t.charAt(r)){case"G":Sp(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=e;t.charAt(r++)!=="]"&&r<t.length;)n+=t.charAt(r);if(n.match(H_))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function VN(t,r,e,n){for(var s=[],a="",i=0,o="",l="t",c,u,d,h="H";i<t.length;)switch(o=t.charAt(i)){case"G":if(!Sp(t,i))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(d=t.charCodeAt(++i))!==34&&i<t.length;)a+=String.fromCharCode(d);s[s.length]={t:"t",v:a},++i;break;case"\\":var f=t.charAt(++i),g=f==="("||f===")"?f:"t";s[s.length]={t:g,v:f},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:r},++i;break;case"B":case"b":if(t.charAt(i+1)==="1"||t.charAt(i+1)==="2"){if(c==null&&(c=Kl(r,e,t.charAt(i+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||c==null&&(c=Kl(r,e),c==null))return"";for(a=o;++i<t.length&&t.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=Kl(r,e)),t.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",i+=3):t.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",i+=5,h="h"):t.substr(i,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",i+=5,h="h"):(m.t="t",++i),c==null&&m.t==="T")return"";s[s.length]=m,l=o;break;case"[":for(a=o;t.charAt(i++)!=="]"&&i<t.length;)a+=t.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(H_)){if(c==null&&(c=Kl(r,e),c==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",qu(t)||(s[s.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++i<t.length&&(o=t.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(t.charAt(i)==" "||t.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<t.length&&"0123456789".indexOf(t.charAt(++i))>-1;)a+=t.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++i;break}var p=0,v=0,b;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=h,l="h",p<1&&(p=1);break;case"s":(b=s[i].v.match(/\.0+$/))&&(v=Math.max(v,b[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&s[i].v.match(/[Hh]/)&&(p=1),p<2&&s[i].v.match(/[Mm]/)&&(p=2),p<3&&s[i].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",k;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=MN(s[i].t.charCodeAt(0),s[i].v,c,v),s[i].t="t";break;case"n":case"?":for(k=i+1;s[k]!=null&&((o=s[k].t)==="?"||o==="D"||(o===" "||o==="t")&&s[k+1]!=null&&(s[k+1].t==="?"||s[k+1].t==="t"&&s[k+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[k].v==="/"||s[k].v===" "&&s[k+1]!=null&&s[k+1].t=="?"));)s[i].v+=s[k].v,s[k]={v:"",t:";"},++k;y+=s[i].v,i=k-1;break;case"G":s[i].t="t",s[i].v=ic(r,e);break}var N="",L,F;if(y.length>0){y.charCodeAt(0)==40?(L=r<0&&y.charCodeAt(0)===45?-r:r,F=ro("n",y,L)):(L=r<0&&n>1?-r:r,F=ro("n",y,L),L<0&&s[0]&&s[0].t=="t"&&(F=F.substr(1),s[0].v="-"+s[0].v)),k=F.length-1;var R=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){R=i;break}var B=s.length;if(R===s.length&&F.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(k>=s[i].v.length-1?(k-=s[i].v.length,s[i].v=F.substr(k+1,s[i].v.length)):k<0?s[i].v="":(s[i].v=F.substr(0,k+1),k=-1),s[i].t="t",B=i);k>=0&&B<s.length&&(s[B].v=F.substr(0,k+1)+s[B].v)}else if(R!==s.length&&F.indexOf("E")===-1){for(k=F.indexOf(".")-1,i=R;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(u=s[i].v.indexOf(".")>-1&&i===R?s[i].v.indexOf(".")-1:s[i].v.length-1,N=s[i].v.substr(u+1);u>=0;--u)k>=0&&(s[i].v.charAt(u)==="0"||s[i].v.charAt(u)==="#")&&(N=F.charAt(k--)+N);s[i].v=N,s[i].t="t",B=i}for(k>=0&&B<s.length&&(s[B].v=F.substr(0,k+1)+s[B].v),k=F.indexOf(".")+1,i=R;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==R)){for(u=s[i].v.indexOf(".")>-1&&i===R?s[i].v.indexOf(".")+1:0,N=s[i].v.substr(0,u);u<s[i].v.length;++u)k<F.length&&(N+=F.charAt(k++));s[i].v=N,s[i].t="t",B=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(L=n>1&&r<0&&i>0&&s[i-1].v==="-"?-r:r,s[i].v=ro(s[i].t,s[i].v,L),s[i].t="t");var q="";for(i=0;i!==s.length;++i)s[i]!=null&&(q+=s[i].v);return q}var Fw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function jw(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function qN(t,r){var e=zN(t),n=e.length,s=e[n-1].indexOf("@");if(n<4&&s>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||s>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=s>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=s>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=s>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var a=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,a];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var i=e[0].match(Fw),o=e[1].match(Fw);return jw(r,i)?[n,e[0]]:jw(r,o)?[n,e[1]]:[n,e[i!=null&&o!=null?2:1]]}return[n,a]}function La(t,r,e){e==null&&(e={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?n=e.dateNF:n=t;break;case"number":t==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:dr)[t],n==null&&(n=e.table&&e.table[Pw[t]]||dr[Pw[t]]),n==null&&(n=CN[t]||"General");break}if(Sp(n,0))return ic(r,e);r instanceof Date&&(r=M_(r,e.date1904));var s=qN(n,r);if(Sp(s[1]))return ic(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return VN(s[1],r,e,s[0])}function Zl(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(dr[e]==null){r<0&&(r=e);continue}if(dr[e]==t){r=e;break}}r<0&&(r=391)}return dr[r]=t,r}function z_(){dr=AN()}var WN={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},V_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function GN(t){var r=typeof t=="number"?dr[t]:t;return r=r.replace(V_,"(\\d+)"),new RegExp("^"+r+"$")}function XN(t,r,e){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(r.match(V_)||[]).forEach(function(d,h){var f=parseInt(e[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=f;break;case"d":a=f;break;case"h":i=f;break;case"s":l=f;break;case"m":i>=0?o=f:s=f;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&a==-1?u:c+"T"+u}var KN=function(){var t={};t.version="1.2.0";function r(){for(var F=0,R=new Array(256),B=0;B!=256;++B)F=B,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,R[B]=F;return typeof Int32Array<"u"?new Int32Array(R):R}var e=r();function n(F){var R=0,B=0,q=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(q=0;q!=256;++q)V[q]=F[q];for(q=0;q!=256;++q)for(B=F[q],R=256+q;R<4096;R+=256)B=V[R]=B>>>8^F[B&255];var I=[];for(q=1;q!=16;++q)I[q-1]=typeof Int32Array<"u"?V.subarray(q*256,q*256+256):V.slice(q*256,q*256+256);return I}var s=n(e),a=s[0],i=s[1],o=s[2],l=s[3],c=s[4],u=s[5],d=s[6],h=s[7],f=s[8],g=s[9],m=s[10],p=s[11],v=s[12],b=s[13],y=s[14];function k(F,R){for(var B=R^-1,q=0,V=F.length;q<V;)B=B>>>8^e[(B^F.charCodeAt(q++))&255];return~B}function N(F,R){for(var B=R^-1,q=F.length-15,V=0;V<q;)B=y[F[V++]^B&255]^b[F[V++]^B>>8&255]^v[F[V++]^B>>16&255]^p[F[V++]^B>>>24]^m[F[V++]]^g[F[V++]]^f[F[V++]]^h[F[V++]]^d[F[V++]]^u[F[V++]]^c[F[V++]]^l[F[V++]]^o[F[V++]]^i[F[V++]]^a[F[V++]]^e[F[V++]];for(q+=15;V<q;)B=B>>>8^e[(B^F[V++])&255];return~B}function L(F,R){for(var B=R^-1,q=0,V=F.length,I=0,C=0;q<V;)I=F.charCodeAt(q++),I<128?B=B>>>8^e[(B^I)&255]:I<2048?(B=B>>>8^e[(B^(192|I>>6&31))&255],B=B>>>8^e[(B^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,C=F.charCodeAt(q++)&1023,B=B>>>8^e[(B^(240|I>>8&7))&255],B=B>>>8^e[(B^(128|I>>2&63))&255],B=B>>>8^e[(B^(128|C>>6&15|(I&3)<<4))&255],B=B>>>8^e[(B^(128|C&63))&255]):(B=B>>>8^e[(B^(224|I>>12&15))&255],B=B>>>8^e[(B^(128|I>>6&63))&255],B=B>>>8^e[(B^(128|I&63))&255]);return~B}return t.table=e,t.bstr=k,t.buf=N,t.str=L,t}(),_r=function(){var r={};r.version="1.2.1";function e(ce,ke){for(var me=ce.split("/"),xe=ke.split("/"),_e=0,Ee=0,Le=Math.min(me.length,xe.length);_e<Le;++_e){if(Ee=me[_e].length-xe[_e].length)return Ee;if(me[_e]!=xe[_e])return me[_e]<xe[_e]?-1:1}return me.length-xe.length}function n(ce){if(ce.charAt(ce.length-1)=="/")return ce.slice(0,-1).indexOf("/")===-1?ce:n(ce.slice(0,-1));var ke=ce.lastIndexOf("/");return ke===-1?ce:ce.slice(0,ke+1)}function s(ce){if(ce.charAt(ce.length-1)=="/")return s(ce.slice(0,-1));var ke=ce.lastIndexOf("/");return ke===-1?ce:ce.slice(ke+1)}function a(ce,ke){typeof ke=="string"&&(ke=new Date(ke));var me=ke.getHours();me=me<<6|ke.getMinutes(),me=me<<5|ke.getSeconds()>>>1,ce.write_shift(2,me);var xe=ke.getFullYear()-1980;xe=xe<<4|ke.getMonth()+1,xe=xe<<5|ke.getDate(),ce.write_shift(2,xe)}function i(ce){var ke=ce.read_shift(2)&65535,me=ce.read_shift(2)&65535,xe=new Date,_e=me&31;me>>>=5;var Ee=me&15;me>>>=4,xe.setMilliseconds(0),xe.setFullYear(me+1980),xe.setMonth(Ee-1),xe.setDate(_e);var Le=ke&31;ke>>>=5;var Ke=ke&63;return ke>>>=6,xe.setHours(ke),xe.setMinutes(Ke),xe.setSeconds(Le<<1),xe}function o(ce){Yn(ce,0);for(var ke={},me=0;ce.l<=ce.length-4;){var xe=ce.read_shift(2),_e=ce.read_shift(2),Ee=ce.l+_e,Le={};switch(xe){case 21589:me=ce.read_shift(1),me&1&&(Le.mtime=ce.read_shift(4)),_e>5&&(me&2&&(Le.atime=ce.read_shift(4)),me&4&&(Le.ctime=ce.read_shift(4))),Le.mtime&&(Le.mt=new Date(Le.mtime*1e3));break}ce.l=Ee,ke[xe]=Le}return ke}var l;function c(){return l||(l={})}function u(ce,ke){if(ce[0]==80&&ce[1]==75)return Je(ce,ke);if((ce[0]|32)==109&&(ce[1]|32)==105)return Ot(ce,ke);if(ce.length<512)throw new Error("CFB file size "+ce.length+" < 512");var me=3,xe=512,_e=0,Ee=0,Le=0,Ke=0,Ue=0,Qe=[],et=ce.slice(0,512);Yn(et,0);var bt=d(et);switch(me=bt[0],me){case 3:xe=512;break;case 4:xe=4096;break;case 0:if(bt[1]==0)return Je(ce,ke);default:throw new Error("Major Version: Expected 3 or 4 saw "+me)}xe!==512&&(et=ce.slice(0,xe),Yn(et,28));var Ct=ce.slice(0,xe);h(et,me);var Pt=et.read_shift(4,"i");if(me===3&&Pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pt);et.l+=4,Le=et.read_shift(4,"i"),et.l+=4,et.chk("00100000","Mini Stream Cutoff Size: "),Ke=et.read_shift(4,"i"),_e=et.read_shift(4,"i"),Ue=et.read_shift(4,"i"),Ee=et.read_shift(4,"i");for(var be=-1,Me=0;Me<109&&(be=et.read_shift(4,"i"),!(be<0));++Me)Qe[Me]=be;var it=f(ce,xe);p(Ue,Ee,it,xe,Qe);var mt=b(it,Le,Qe,xe);mt[Le].name="!Directory",_e>0&&Ke!==C&&(mt[Ke].name="!MiniFAT"),mt[Qe[0]].name="!FAT",mt.fat_addrs=Qe,mt.ssz=xe;var Rt={},kt=[],Nt=[],sr=[];y(Le,mt,it,kt,_e,Rt,Nt,Ke),g(Nt,sr,kt),kt.shift();var Gt={FileIndex:Nt,FullPaths:sr};return ke&&ke.raw&&(Gt.raw={header:Ct,sectors:it}),Gt}function d(ce){if(ce[ce.l]==80&&ce[ce.l+1]==75)return[0,0];ce.chk(O,"Header Signature: "),ce.l+=16;var ke=ce.read_shift(2,"u");return[ce.read_shift(2,"u"),ke]}function h(ce,ke){var me=9;switch(ce.l+=2,me=ce.read_shift(2)){case 9:if(ke!=3)throw new Error("Sector Shift: Expected 9 saw "+me);break;case 12:if(ke!=4)throw new Error("Sector Shift: Expected 12 saw "+me);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+me)}ce.chk("0600","Mini Sector Shift: "),ce.chk("000000000000","Reserved: ")}function f(ce,ke){for(var me=Math.ceil(ce.length/ke)-1,xe=[],_e=1;_e<me;++_e)xe[_e-1]=ce.slice(_e*ke,(_e+1)*ke);return xe[me-1]=ce.slice(me*ke),xe}function g(ce,ke,me){for(var xe=0,_e=0,Ee=0,Le=0,Ke=0,Ue=me.length,Qe=[],et=[];xe<Ue;++xe)Qe[xe]=et[xe]=xe,ke[xe]=me[xe];for(;Ke<et.length;++Ke)xe=et[Ke],_e=ce[xe].L,Ee=ce[xe].R,Le=ce[xe].C,Qe[xe]===xe&&(_e!==-1&&Qe[_e]!==_e&&(Qe[xe]=Qe[_e]),Ee!==-1&&Qe[Ee]!==Ee&&(Qe[xe]=Qe[Ee])),Le!==-1&&(Qe[Le]=xe),_e!==-1&&xe!=Qe[xe]&&(Qe[_e]=Qe[xe],et.lastIndexOf(_e)<Ke&&et.push(_e)),Ee!==-1&&xe!=Qe[xe]&&(Qe[Ee]=Qe[xe],et.lastIndexOf(Ee)<Ke&&et.push(Ee));for(xe=1;xe<Ue;++xe)Qe[xe]===xe&&(Ee!==-1&&Qe[Ee]!==Ee?Qe[xe]=Qe[Ee]:_e!==-1&&Qe[_e]!==_e&&(Qe[xe]=Qe[_e]));for(xe=1;xe<Ue;++xe)if(ce[xe].type!==0){if(Ke=xe,Ke!=Qe[Ke])do Ke=Qe[Ke],ke[xe]=ke[Ke]+"/"+ke[xe];while(Ke!==0&&Qe[Ke]!==-1&&Ke!=Qe[Ke]);Qe[xe]=-1}for(ke[0]+="/",xe=1;xe<Ue;++xe)ce[xe].type!==2&&(ke[xe]+="/")}function m(ce,ke,me){for(var xe=ce.start,_e=ce.size,Ee=[],Le=xe;me&&_e>0&&Le>=0;)Ee.push(ke.slice(Le*I,Le*I+I)),_e-=I,Le=Vl(me,Le*4);return Ee.length===0?Dn(0):Jo(Ee).slice(0,ce.size)}function p(ce,ke,me,xe,_e){var Ee=C;if(ce===C){if(ke!==0)throw new Error("DIFAT chain shorter than expected")}else if(ce!==-1){var Le=me[ce],Ke=(xe>>>2)-1;if(!Le)return;for(var Ue=0;Ue<Ke&&(Ee=Vl(Le,Ue*4))!==C;++Ue)_e.push(Ee);p(Vl(Le,xe-4),ke-1,me,xe,_e)}}function v(ce,ke,me,xe,_e){var Ee=[],Le=[];_e||(_e=[]);var Ke=xe-1,Ue=0,Qe=0;for(Ue=ke;Ue>=0;){_e[Ue]=!0,Ee[Ee.length]=Ue,Le.push(ce[Ue]);var et=me[Math.floor(Ue*4/xe)];if(Qe=Ue*4&Ke,xe<4+Qe)throw new Error("FAT boundary crossed: "+Ue+" 4 "+xe);if(!ce[et])break;Ue=Vl(ce[et],Qe)}return{nodes:Ee,data:Ww([Le])}}function b(ce,ke,me,xe){var _e=ce.length,Ee=[],Le=[],Ke=[],Ue=[],Qe=xe-1,et=0,bt=0,Ct=0,Pt=0;for(et=0;et<_e;++et)if(Ke=[],Ct=et+ke,Ct>=_e&&(Ct-=_e),!Le[Ct]){Ue=[];var be=[];for(bt=Ct;bt>=0;){be[bt]=!0,Le[bt]=!0,Ke[Ke.length]=bt,Ue.push(ce[bt]);var Me=me[Math.floor(bt*4/xe)];if(Pt=bt*4&Qe,xe<4+Pt)throw new Error("FAT boundary crossed: "+bt+" 4 "+xe);if(!ce[Me]||(bt=Vl(ce[Me],Pt),be[bt]))break}Ee[Ct]={nodes:Ke,data:Ww([Ue])}}return Ee}function y(ce,ke,me,xe,_e,Ee,Le,Ke){for(var Ue=0,Qe=xe.length?2:0,et=ke[ce].data,bt=0,Ct=0,Pt;bt<et.length;bt+=128){var be=et.slice(bt,bt+128);Yn(be,64),Ct=be.read_shift(2),Pt=Db(be,0,Ct-Qe),xe.push(Pt);var Me={name:Pt,type:be.read_shift(1),color:be.read_shift(1),L:be.read_shift(4,"i"),R:be.read_shift(4,"i"),C:be.read_shift(4,"i"),clsid:be.read_shift(16),state:be.read_shift(4,"i"),start:0,size:0},it=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);it!==0&&(Me.ct=k(be,be.l-8));var mt=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);mt!==0&&(Me.mt=k(be,be.l-8)),Me.start=be.read_shift(4,"i"),Me.size=be.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=C,Me.name=""),Me.type===5?(Ue=Me.start,_e>0&&Ue!==C&&(ke[Ue].name="!StreamData")):Me.size>=4096?(Me.storage="fat",ke[Me.start]===void 0&&(ke[Me.start]=v(me,Me.start,ke.fat_addrs,ke.ssz)),ke[Me.start].name=Me.name,Me.content=ke[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:Ue!==C&&Me.start!==C&&ke[Ue]&&(Me.content=m(Me,ke[Ue].data,(ke[Ke]||{}).data))),Me.content&&Yn(Me.content,0),Ee[Pt]=Me,Le.push(Me)}}function k(ce,ke){return new Date((oa(ce,ke+4)/1e7*Math.pow(2,32)+oa(ce,ke)/1e7-11644473600)*1e3)}function N(ce,ke){return c(),u(l.readFileSync(ce),ke)}function L(ce,ke){var me=ke&&ke.type;switch(me||yr&&Buffer.isBuffer(ce)&&(me="buffer"),me||"base64"){case"file":return N(ce,ke);case"base64":return u(ri(pa(ce)),ke);case"binary":return u(ri(ce),ke)}return u(ce,ke)}function F(ce,ke){var me=ke||{},xe=me.root||"Root Entry";if(ce.FullPaths||(ce.FullPaths=[]),ce.FileIndex||(ce.FileIndex=[]),ce.FullPaths.length!==ce.FileIndex.length)throw new Error("inconsistent CFB structure");ce.FullPaths.length===0&&(ce.FullPaths[0]=xe+"/",ce.FileIndex[0]={name:xe,type:5}),me.CLSID&&(ce.FileIndex[0].clsid=me.CLSID),R(ce)}function R(ce){var ke="Sh33tJ5";if(!_r.find(ce,"/"+ke)){var me=Dn(4);me[0]=55,me[1]=me[3]=50,me[2]=54,ce.FileIndex.push({name:ke,type:2,content:me,size:4,L:69,R:69,C:69}),ce.FullPaths.push(ce.FullPaths[0]+ke),B(ce)}}function B(ce,ke){F(ce);for(var me=!1,xe=!1,_e=ce.FullPaths.length-1;_e>=0;--_e){var Ee=ce.FileIndex[_e];switch(Ee.type){case 0:xe?me=!0:(ce.FileIndex.pop(),ce.FullPaths.pop());break;case 1:case 2:case 5:xe=!0,isNaN(Ee.R*Ee.L*Ee.C)&&(me=!0),Ee.R>-1&&Ee.L>-1&&Ee.R==Ee.L&&(me=!0);break;default:me=!0;break}}if(!(!me&&!ke)){var Le=new Date(1987,1,19),Ke=0,Ue=Object.create?Object.create(null):{},Qe=[];for(_e=0;_e<ce.FullPaths.length;++_e)Ue[ce.FullPaths[_e]]=!0,ce.FileIndex[_e].type!==0&&Qe.push([ce.FullPaths[_e],ce.FileIndex[_e]]);for(_e=0;_e<Qe.length;++_e){var et=n(Qe[_e][0]);xe=Ue[et],xe||(Qe.push([et,{name:s(et).replace("/",""),type:1,clsid:x,ct:Le,mt:Le,content:null}]),Ue[et]=!0)}for(Qe.sort(function(Pt,be){return e(Pt[0],be[0])}),ce.FullPaths=[],ce.FileIndex=[],_e=0;_e<Qe.length;++_e)ce.FullPaths[_e]=Qe[_e][0],ce.FileIndex[_e]=Qe[_e][1];for(_e=0;_e<Qe.length;++_e){var bt=ce.FileIndex[_e],Ct=ce.FullPaths[_e];if(bt.name=s(Ct).replace("/",""),bt.L=bt.R=bt.C=-(bt.color=1),bt.size=bt.content?bt.content.length:0,bt.start=0,bt.clsid=bt.clsid||x,_e===0)bt.C=Qe.length>1?1:-1,bt.size=0,bt.type=5;else if(Ct.slice(-1)=="/"){for(Ke=_e+1;Ke<Qe.length&&n(ce.FullPaths[Ke])!=Ct;++Ke);for(bt.C=Ke>=Qe.length?-1:Ke,Ke=_e+1;Ke<Qe.length&&n(ce.FullPaths[Ke])!=n(Ct);++Ke);bt.R=Ke>=Qe.length?-1:Ke,bt.type=1}else n(ce.FullPaths[_e+1]||"")==n(Ct)&&(bt.R=_e+1),bt.type=2}}}function q(ce,ke){var me=ke||{};if(me.fileType=="mad")return yt(ce,me);switch(B(ce),me.fileType){case"zip":return gt(ce,me)}var xe=function(Pt){for(var be=0,Me=0,it=0;it<Pt.FileIndex.length;++it){var mt=Pt.FileIndex[it];if(mt.content){var Rt=mt.content.length;Rt>0&&(Rt<4096?be+=Rt+63>>6:Me+=Rt+511>>9)}}for(var kt=Pt.FullPaths.length+3>>2,Nt=be+7>>3,sr=be+127>>7,Gt=Nt+Me+kt+sr,Xt=Gt+127>>7,Ht=Xt<=109?0:Math.ceil((Xt-109)/127);Gt+Xt+Ht+127>>7>Xt;)Ht=++Xt<=109?0:Math.ceil((Xt-109)/127);var ar=[1,Ht,Xt,sr,kt,Me,be,0];return Pt.FileIndex[0].size=be<<6,ar[7]=(Pt.FileIndex[0].start=ar[0]+ar[1]+ar[2]+ar[3]+ar[4]+ar[5])+(ar[6]+7>>3),ar}(ce),_e=Dn(xe[7]<<9),Ee=0,Le=0;{for(Ee=0;Ee<8;++Ee)_e.write_shift(1,E[Ee]);for(Ee=0;Ee<8;++Ee)_e.write_shift(2,0);for(_e.write_shift(2,62),_e.write_shift(2,3),_e.write_shift(2,65534),_e.write_shift(2,9),_e.write_shift(2,6),Ee=0;Ee<3;++Ee)_e.write_shift(2,0);for(_e.write_shift(4,0),_e.write_shift(4,xe[2]),_e.write_shift(4,xe[0]+xe[1]+xe[2]+xe[3]-1),_e.write_shift(4,0),_e.write_shift(4,4096),_e.write_shift(4,xe[3]?xe[0]+xe[1]+xe[2]-1:C),_e.write_shift(4,xe[3]),_e.write_shift(-4,xe[1]?xe[0]-1:C),_e.write_shift(4,xe[1]),Ee=0;Ee<109;++Ee)_e.write_shift(-4,Ee<xe[2]?xe[1]+Ee:-1)}if(xe[1])for(Le=0;Le<xe[1];++Le){for(;Ee<236+Le*127;++Ee)_e.write_shift(-4,Ee<xe[2]?xe[1]+Ee:-1);_e.write_shift(-4,Le===xe[1]-1?C:Le+1)}var Ke=function(Pt){for(Le+=Pt;Ee<Le-1;++Ee)_e.write_shift(-4,Ee+1);Pt&&(++Ee,_e.write_shift(-4,C))};for(Le=Ee=0,Le+=xe[1];Ee<Le;++Ee)_e.write_shift(-4,w.DIFSECT);for(Le+=xe[2];Ee<Le;++Ee)_e.write_shift(-4,w.FATSECT);Ke(xe[3]),Ke(xe[4]);for(var Ue=0,Qe=0,et=ce.FileIndex[0];Ue<ce.FileIndex.length;++Ue)et=ce.FileIndex[Ue],et.content&&(Qe=et.content.length,!(Qe<4096)&&(et.start=Le,Ke(Qe+511>>9)));for(Ke(xe[6]+7>>3);_e.l&511;)_e.write_shift(-4,w.ENDOFCHAIN);for(Le=Ee=0,Ue=0;Ue<ce.FileIndex.length;++Ue)et=ce.FileIndex[Ue],et.content&&(Qe=et.content.length,!(!Qe||Qe>=4096)&&(et.start=Le,Ke(Qe+63>>6)));for(;_e.l&511;)_e.write_shift(-4,w.ENDOFCHAIN);for(Ee=0;Ee<xe[4]<<2;++Ee){var bt=ce.FullPaths[Ee];if(!bt||bt.length===0){for(Ue=0;Ue<17;++Ue)_e.write_shift(4,0);for(Ue=0;Ue<3;++Ue)_e.write_shift(4,-1);for(Ue=0;Ue<12;++Ue)_e.write_shift(4,0);continue}et=ce.FileIndex[Ee],Ee===0&&(et.start=et.size?et.start-1:C);var Ct=Ee===0&&me.root||et.name;if(Qe=2*(Ct.length+1),_e.write_shift(64,Ct,"utf16le"),_e.write_shift(2,Qe),_e.write_shift(1,et.type),_e.write_shift(1,et.color),_e.write_shift(-4,et.L),_e.write_shift(-4,et.R),_e.write_shift(-4,et.C),et.clsid)_e.write_shift(16,et.clsid,"hex");else for(Ue=0;Ue<4;++Ue)_e.write_shift(4,0);_e.write_shift(4,et.state||0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,et.start),_e.write_shift(4,et.size),_e.write_shift(4,0)}for(Ee=1;Ee<ce.FileIndex.length;++Ee)if(et=ce.FileIndex[Ee],et.size>=4096)if(_e.l=et.start+1<<9,yr&&Buffer.isBuffer(et.content))et.content.copy(_e,_e.l,0,et.size),_e.l+=et.size+511&-512;else{for(Ue=0;Ue<et.size;++Ue)_e.write_shift(1,et.content[Ue]);for(;Ue&511;++Ue)_e.write_shift(1,0)}for(Ee=1;Ee<ce.FileIndex.length;++Ee)if(et=ce.FileIndex[Ee],et.size>0&&et.size<4096)if(yr&&Buffer.isBuffer(et.content))et.content.copy(_e,_e.l,0,et.size),_e.l+=et.size+63&-64;else{for(Ue=0;Ue<et.size;++Ue)_e.write_shift(1,et.content[Ue]);for(;Ue&63;++Ue)_e.write_shift(1,0)}if(yr)_e.l=_e.length;else for(;_e.l<_e.length;)_e.write_shift(1,0);return _e}function V(ce,ke){var me=ce.FullPaths.map(function(Ue){return Ue.toUpperCase()}),xe=me.map(function(Ue){var Qe=Ue.split("/");return Qe[Qe.length-(Ue.slice(-1)=="/"?2:1)]}),_e=!1;ke.charCodeAt(0)===47?(_e=!0,ke=me[0].slice(0,-1)+ke):_e=ke.indexOf("/")!==-1;var Ee=ke.toUpperCase(),Le=_e===!0?me.indexOf(Ee):xe.indexOf(Ee);if(Le!==-1)return ce.FileIndex[Le];var Ke=!Ee.match(Uf);for(Ee=Ee.replace(Os,""),Ke&&(Ee=Ee.replace(Uf,"!")),Le=0;Le<me.length;++Le)if((Ke?me[Le].replace(Uf,"!"):me[Le]).replace(Os,"")==Ee||(Ke?xe[Le].replace(Uf,"!"):xe[Le]).replace(Os,"")==Ee)return ce.FileIndex[Le];return null}var I=64,C=-2,O="d0cf11e0a1b11ae1",E=[208,207,17,224,161,177,26,225],x="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:C,FREESECT:-1,HEADER_SIGNATURE:O,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:x,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _(ce,ke,me){c();var xe=q(ce,me);l.writeFileSync(ke,xe)}function S(ce){for(var ke=new Array(ce.length),me=0;me<ce.length;++me)ke[me]=String.fromCharCode(ce[me]);return ke.join("")}function T(ce,ke){var me=q(ce,ke);switch(ke&&ke.type||"buffer"){case"file":return c(),l.writeFileSync(ke.filename,me),me;case"binary":return typeof me=="string"?me:S(me);case"base64":return Tw(typeof me=="string"?me:S(me));case"buffer":if(yr)return Buffer.isBuffer(me)?me:hc(me);case"array":return typeof me=="string"?ri(me):me}return me}var U;function A(ce){try{var ke=ce.InflateRaw,me=new ke;if(me._processChunk(new Uint8Array([3,0]),me._finishFlushFlag),me.bytesRead)U=ce;else throw new Error("zlib does not expose bytesRead")}catch(xe){console.error("cannot use native zlib: "+(xe.message||xe))}}function H(ce,ke){if(!U)return Xe(ce,ke);var me=U.InflateRaw,xe=new me,_e=xe._processChunk(ce.slice(ce.l),xe._finishFlushFlag);return ce.l+=xe.bytesRead,_e}function z(ce){return U?U.deflateRawSync(ce):Ye(ce)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function P(ce){var ke=(ce<<1|ce<<11)&139536|(ce<<5|ce<<15)&558144;return(ke>>16|ke>>8|ke)&255}for(var D=typeof Uint8Array<"u",G=D?new Uint8Array(256):[],re=0;re<256;++re)G[re]=P(re);function te(ce,ke){var me=G[ce&255];return ke<=8?me>>>8-ke:(me=me<<8|G[ce>>8&255],ke<=16?me>>>16-ke:(me=me<<8|G[ce>>16&255],me>>>24-ke))}function ne(ce,ke){var me=ke&7,xe=ke>>>3;return(ce[xe]|(me<=6?0:ce[xe+1]<<8))>>>me&3}function le(ce,ke){var me=ke&7,xe=ke>>>3;return(ce[xe]|(me<=5?0:ce[xe+1]<<8))>>>me&7}function oe(ce,ke){var me=ke&7,xe=ke>>>3;return(ce[xe]|(me<=4?0:ce[xe+1]<<8))>>>me&15}function ee(ce,ke){var me=ke&7,xe=ke>>>3;return(ce[xe]|(me<=3?0:ce[xe+1]<<8))>>>me&31}function Z(ce,ke){var me=ke&7,xe=ke>>>3;return(ce[xe]|(me<=1?0:ce[xe+1]<<8))>>>me&127}function se(ce,ke,me){var xe=ke&7,_e=ke>>>3,Ee=(1<<me)-1,Le=ce[_e]>>>xe;return me<8-xe||(Le|=ce[_e+1]<<8-xe,me<16-xe)||(Le|=ce[_e+2]<<16-xe,me<24-xe)||(Le|=ce[_e+3]<<24-xe),Le&Ee}function ie(ce,ke,me){var xe=ke&7,_e=ke>>>3;return xe<=5?ce[_e]|=(me&7)<<xe:(ce[_e]|=me<<xe&255,ce[_e+1]=(me&7)>>8-xe),ke+3}function ue(ce,ke,me){var xe=ke&7,_e=ke>>>3;return me=(me&1)<<xe,ce[_e]|=me,ke+1}function pe(ce,ke,me){var xe=ke&7,_e=ke>>>3;return me<<=xe,ce[_e]|=me&255,me>>>=8,ce[_e+1]=me,ke+8}function fe(ce,ke,me){var xe=ke&7,_e=ke>>>3;return me<<=xe,ce[_e]|=me&255,me>>>=8,ce[_e+1]=me&255,ce[_e+2]=me>>>8,ke+16}function ye(ce,ke){var me=ce.length,xe=2*me>ke?2*me:ke+5,_e=0;if(me>=ke)return ce;if(yr){var Ee=Nw(xe);if(ce.copy)ce.copy(Ee);else for(;_e<ce.length;++_e)Ee[_e]=ce[_e];return Ee}else if(D){var Le=new Uint8Array(xe);if(Le.set)Le.set(ce);else for(;_e<me;++_e)Le[_e]=ce[_e];return Le}return ce.length=xe,ce}function Te(ce){for(var ke=new Array(ce),me=0;me<ce;++me)ke[me]=0;return ke}function Pe(ce,ke,me){var xe=1,_e=0,Ee=0,Le=0,Ke=0,Ue=ce.length,Qe=D?new Uint16Array(32):Te(32);for(Ee=0;Ee<32;++Ee)Qe[Ee]=0;for(Ee=Ue;Ee<me;++Ee)ce[Ee]=0;Ue=ce.length;var et=D?new Uint16Array(Ue):Te(Ue);for(Ee=0;Ee<Ue;++Ee)Qe[_e=ce[Ee]]++,xe<_e&&(xe=_e),et[Ee]=0;for(Qe[0]=0,Ee=1;Ee<=xe;++Ee)Qe[Ee+16]=Ke=Ke+Qe[Ee-1]<<1;for(Ee=0;Ee<Ue;++Ee)Ke=ce[Ee],Ke!=0&&(et[Ee]=Qe[Ke+16]++);var bt=0;for(Ee=0;Ee<Ue;++Ee)if(bt=ce[Ee],bt!=0)for(Ke=te(et[Ee],xe)>>xe-bt,Le=(1<<xe+4-bt)-1;Le>=0;--Le)ke[Ke|Le<<bt]=bt&15|Ee<<4;return xe}var je=D?new Uint16Array(512):Te(512),qe=D?new Uint16Array(32):Te(32);if(!D){for(var We=0;We<512;++We)je[We]=0;for(We=0;We<32;++We)qe[We]=0}(function(){for(var ce=[],ke=0;ke<32;ke++)ce.push(5);Pe(ce,qe,32);var me=[];for(ke=0;ke<=143;ke++)me.push(8);for(;ke<=255;ke++)me.push(9);for(;ke<=279;ke++)me.push(7);for(;ke<=287;ke++)me.push(8);Pe(me,je,288)})();var at=function(){for(var ke=D?new Uint8Array(32768):[],me=0,xe=0;me<J.length-1;++me)for(;xe<J[me+1];++xe)ke[xe]=me;for(;xe<32768;++xe)ke[xe]=29;var _e=D?new Uint8Array(259):[];for(me=0,xe=0;me<j.length-1;++me)for(;xe<j[me+1];++xe)_e[xe]=me;function Ee(Ke,Ue){for(var Qe=0;Qe<Ke.length;){var et=Math.min(65535,Ke.length-Qe),bt=Qe+et==Ke.length;for(Ue.write_shift(1,+bt),Ue.write_shift(2,et),Ue.write_shift(2,~et&65535);et-- >0;)Ue[Ue.l++]=Ke[Qe++]}return Ue.l}function Le(Ke,Ue){for(var Qe=0,et=0,bt=D?new Uint16Array(32768):[];et<Ke.length;){var Ct=Math.min(65535,Ke.length-et);if(Ct<10){for(Qe=ie(Ue,Qe,+(et+Ct==Ke.length)),Qe&7&&(Qe+=8-(Qe&7)),Ue.l=Qe/8|0,Ue.write_shift(2,Ct),Ue.write_shift(2,~Ct&65535);Ct-- >0;)Ue[Ue.l++]=Ke[et++];Qe=Ue.l*8;continue}Qe=ie(Ue,Qe,+(et+Ct==Ke.length)+2);for(var Pt=0;Ct-- >0;){var be=Ke[et];Pt=(Pt<<5^be)&32767;var Me=-1,it=0;if((Me=bt[Pt])&&(Me|=et&-32768,Me>et&&(Me-=32768),Me<et))for(;Ke[Me+it]==Ke[et+it]&&it<250;)++it;if(it>2){be=_e[it],be<=22?Qe=pe(Ue,Qe,G[be+1]>>1)-1:(pe(Ue,Qe,3),Qe+=5,pe(Ue,Qe,G[be-23]>>5),Qe+=3);var mt=be<8?0:be-4>>2;mt>0&&(fe(Ue,Qe,it-j[be]),Qe+=mt),be=ke[et-Me],Qe=pe(Ue,Qe,G[be]>>3),Qe-=3;var Rt=be<4?0:be-2>>1;Rt>0&&(fe(Ue,Qe,et-Me-J[be]),Qe+=Rt);for(var kt=0;kt<it;++kt)bt[Pt]=et&32767,Pt=(Pt<<5^Ke[et])&32767,++et;Ct-=it-1}else be<=143?be=be+48:Qe=ue(Ue,Qe,1),Qe=pe(Ue,Qe,G[be]),bt[Pt]=et&32767,++et}Qe=pe(Ue,Qe,0)-1}return Ue.l=(Qe+7)/8|0,Ue.l}return function(Ue,Qe){return Ue.length<8?Ee(Ue,Qe):Le(Ue,Qe)}}();function Ye(ce){var ke=Dn(50+Math.floor(ce.length*1.1)),me=at(ce,ke);return ke.slice(0,me)}var rt=D?new Uint16Array(32768):Te(32768),ht=D?new Uint16Array(32768):Te(32768),Ce=D?new Uint16Array(128):Te(128),Ie=1,Ve=1;function De(ce,ke){var me=ee(ce,ke)+257;ke+=5;var xe=ee(ce,ke)+1;ke+=5;var _e=oe(ce,ke)+4;ke+=4;for(var Ee=0,Le=D?new Uint8Array(19):Te(19),Ke=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ue=1,Qe=D?new Uint8Array(8):Te(8),et=D?new Uint8Array(8):Te(8),bt=Le.length,Ct=0;Ct<_e;++Ct)Le[K[Ct]]=Ee=le(ce,ke),Ue<Ee&&(Ue=Ee),Qe[Ee]++,ke+=3;var Pt=0;for(Qe[0]=0,Ct=1;Ct<=Ue;++Ct)et[Ct]=Pt=Pt+Qe[Ct-1]<<1;for(Ct=0;Ct<bt;++Ct)(Pt=Le[Ct])!=0&&(Ke[Ct]=et[Pt]++);var be=0;for(Ct=0;Ct<bt;++Ct)if(be=Le[Ct],be!=0){Pt=G[Ke[Ct]]>>8-be;for(var Me=(1<<7-be)-1;Me>=0;--Me)Ce[Pt|Me<<be]=be&7|Ct<<3}var it=[];for(Ue=1;it.length<me+xe;)switch(Pt=Ce[Z(ce,ke)],ke+=Pt&7,Pt>>>=3){case 16:for(Ee=3+ne(ce,ke),ke+=2,Pt=it[it.length-1];Ee-- >0;)it.push(Pt);break;case 17:for(Ee=3+le(ce,ke),ke+=3;Ee-- >0;)it.push(0);break;case 18:for(Ee=11+Z(ce,ke),ke+=7;Ee-- >0;)it.push(0);break;default:it.push(Pt),Ue<Pt&&(Ue=Pt);break}var mt=it.slice(0,me),Rt=it.slice(me);for(Ct=me;Ct<286;++Ct)mt[Ct]=0;for(Ct=xe;Ct<30;++Ct)Rt[Ct]=0;return Ie=Pe(mt,rt,286),Ve=Pe(Rt,ht,30),ke}function Oe(ce,ke){if(ce[0]==3&&!(ce[1]&3))return[gl(ke),2];for(var me=0,xe=0,_e=Nw(ke||1<<18),Ee=0,Le=_e.length>>>0,Ke=0,Ue=0;!(xe&1);){if(xe=le(ce,me),me+=3,xe>>>1)xe>>1==1?(Ke=9,Ue=5):(me=De(ce,me),Ke=Ie,Ue=Ve);else{me&7&&(me+=8-(me&7));var Qe=ce[me>>>3]|ce[(me>>>3)+1]<<8;if(me+=32,Qe>0)for(!ke&&Le<Ee+Qe&&(_e=ye(_e,Ee+Qe),Le=_e.length);Qe-- >0;)_e[Ee++]=ce[me>>>3],me+=8;continue}for(;;){!ke&&Le<Ee+32767&&(_e=ye(_e,Ee+32767),Le=_e.length);var et=se(ce,me,Ke),bt=xe>>>1==1?je[et]:rt[et];if(me+=bt&15,bt>>>=4,!(bt>>>8&255))_e[Ee++]=bt;else{if(bt==256)break;bt-=257;var Ct=bt<8?0:bt-4>>2;Ct>5&&(Ct=0);var Pt=Ee+j[bt];Ct>0&&(Pt+=se(ce,me,Ct),me+=Ct),et=se(ce,me,Ue),bt=xe>>>1==1?qe[et]:ht[et],me+=bt&15,bt>>>=4;var be=bt<4?0:bt-2>>1,Me=J[bt];for(be>0&&(Me+=se(ce,me,be),me+=be),!ke&&Le<Pt&&(_e=ye(_e,Pt+100),Le=_e.length);Ee<Pt;)_e[Ee]=_e[Ee-Me],++Ee}}}return ke?[_e,me+7>>>3]:[_e.slice(0,Ee),me+7>>>3]}function Xe(ce,ke){var me=ce.slice(ce.l||0),xe=Oe(me,ke);return ce.l+=xe[1],xe[0]}function nt(ce,ke){if(ce)typeof console<"u"&&console.error(ke);else throw new Error(ke)}function Je(ce,ke){var me=ce;Yn(me,0);var xe=[],_e=[],Ee={FileIndex:xe,FullPaths:_e};F(Ee,{root:ke.root});for(var Le=me.length-4;(me[Le]!=80||me[Le+1]!=75||me[Le+2]!=5||me[Le+3]!=6)&&Le>=0;)--Le;me.l=Le+4,me.l+=4;var Ke=me.read_shift(2);me.l+=6;var Ue=me.read_shift(4);for(me.l=Ue,Le=0;Le<Ke;++Le){me.l+=20;var Qe=me.read_shift(4),et=me.read_shift(4),bt=me.read_shift(2),Ct=me.read_shift(2),Pt=me.read_shift(2);me.l+=8;var be=me.read_shift(4),Me=o(me.slice(me.l+bt,me.l+bt+Ct));me.l+=bt+Ct+Pt;var it=me.l;me.l=be+4,wt(me,Qe,et,Ee,Me),me.l=it}return Ee}function wt(ce,ke,me,xe,_e){ce.l+=2;var Ee=ce.read_shift(2),Le=ce.read_shift(2),Ke=i(ce);if(Ee&8257)throw new Error("Unsupported ZIP encryption");for(var Ue=ce.read_shift(4),Qe=ce.read_shift(4),et=ce.read_shift(4),bt=ce.read_shift(2),Ct=ce.read_shift(2),Pt="",be=0;be<bt;++be)Pt+=String.fromCharCode(ce[ce.l++]);if(Ct){var Me=o(ce.slice(ce.l,ce.l+Ct));(Me[21589]||{}).mt&&(Ke=Me[21589].mt),((_e||{})[21589]||{}).mt&&(Ke=_e[21589].mt)}ce.l+=Ct;var it=ce.slice(ce.l,ce.l+Qe);switch(Le){case 8:it=H(ce,et);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Le)}var mt=!1;Ee&8&&(Ue=ce.read_shift(4),Ue==134695760&&(Ue=ce.read_shift(4),mt=!0),Qe=ce.read_shift(4),et=ce.read_shift(4)),Qe!=ke&&nt(mt,"Bad compressed size: "+ke+" != "+Qe),et!=me&&nt(mt,"Bad uncompressed size: "+me+" != "+et),$t(xe,Pt,it,{unsafe:!0,mt:Ke})}function gt(ce,ke){var me=ke||{},xe=[],_e=[],Ee=Dn(1),Le=me.compression?8:0,Ke=0,Ue=0,Qe=0,et=0,bt=0,Ct=ce.FullPaths[0],Pt=Ct,be=ce.FileIndex[0],Me=[],it=0;for(Ue=1;Ue<ce.FullPaths.length;++Ue)if(Pt=ce.FullPaths[Ue].slice(Ct.length),be=ce.FileIndex[Ue],!(!be.size||!be.content||Pt=="Sh33tJ5")){var mt=et,Rt=Dn(Pt.length);for(Qe=0;Qe<Pt.length;++Qe)Rt.write_shift(1,Pt.charCodeAt(Qe)&127);Rt=Rt.slice(0,Rt.l),Me[bt]=KN.buf(be.content,0);var kt=be.content;Le==8&&(kt=z(kt)),Ee=Dn(30),Ee.write_shift(4,67324752),Ee.write_shift(2,20),Ee.write_shift(2,Ke),Ee.write_shift(2,Le),be.mt?a(Ee,be.mt):Ee.write_shift(4,0),Ee.write_shift(-4,Me[bt]),Ee.write_shift(4,kt.length),Ee.write_shift(4,be.content.length),Ee.write_shift(2,Rt.length),Ee.write_shift(2,0),et+=Ee.length,xe.push(Ee),et+=Rt.length,xe.push(Rt),et+=kt.length,xe.push(kt),Ee=Dn(46),Ee.write_shift(4,33639248),Ee.write_shift(2,0),Ee.write_shift(2,20),Ee.write_shift(2,Ke),Ee.write_shift(2,Le),Ee.write_shift(4,0),Ee.write_shift(-4,Me[bt]),Ee.write_shift(4,kt.length),Ee.write_shift(4,be.content.length),Ee.write_shift(2,Rt.length),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(4,0),Ee.write_shift(4,mt),it+=Ee.l,_e.push(Ee),it+=Rt.length,_e.push(Rt),++bt}return Ee=Dn(22),Ee.write_shift(4,101010256),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,bt),Ee.write_shift(2,bt),Ee.write_shift(4,it),Ee.write_shift(4,et),Ee.write_shift(2,0),Jo([Jo(xe),Jo(_e),Ee])}var dt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ct(ce,ke){if(ce.ctype)return ce.ctype;var me=ce.name||"",xe=me.match(/\.([^\.]+)$/);return xe&&dt[xe[1]]||ke&&(xe=(me=ke).match(/[\.\\]([^\.\\])+$/),xe&&dt[xe[1]])?dt[xe[1]]:"application/octet-stream"}function ut(ce){for(var ke=Tw(ce),me=[],xe=0;xe<ke.length;xe+=76)me.push(ke.slice(xe,xe+76));return me.join(`\r
`)+`\r
`}function ft(ce){var ke=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Qe){var et=Qe.charCodeAt(0).toString(16).toUpperCase();return"="+(et.length==1?"0"+et:et)});ke=ke.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ke.charAt(0)==`
`&&(ke="=0D"+ke.slice(1)),ke=ke.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var me=[],xe=ke.split(`\r
`),_e=0;_e<xe.length;++_e){var Ee=xe[_e];if(Ee.length==0){me.push("");continue}for(var Le=0;Le<Ee.length;){var Ke=76,Ue=Ee.slice(Le,Le+Ke);Ue.charAt(Ke-1)=="="?Ke--:Ue.charAt(Ke-2)=="="?Ke-=2:Ue.charAt(Ke-3)=="="&&(Ke-=3),Ue=Ee.slice(Le,Le+Ke),Le+=Ke,Le<Ee.length&&(Ue+="="),me.push(Ue)}}return me.join(`\r
`)}function Et(ce){for(var ke=[],me=0;me<ce.length;++me){for(var xe=ce[me];me<=ce.length&&xe.charAt(xe.length-1)=="=";)xe=xe.slice(0,xe.length-1)+ce[++me];ke.push(xe)}for(var _e=0;_e<ke.length;++_e)ke[_e]=ke[_e].replace(/[=][0-9A-Fa-f]{2}/g,function(Ee){return String.fromCharCode(parseInt(Ee.slice(1),16))});return ri(ke.join(`\r
`))}function jt(ce,ke,me){for(var xe="",_e="",Ee="",Le,Ke=0;Ke<10;++Ke){var Ue=ke[Ke];if(!Ue||Ue.match(/^\s*$/))break;var Qe=Ue.match(/^(.*?):\s*([^\s].*)$/);if(Qe)switch(Qe[1].toLowerCase()){case"content-location":xe=Qe[2].trim();break;case"content-type":Ee=Qe[2].trim();break;case"content-transfer-encoding":_e=Qe[2].trim();break}}switch(++Ke,_e.toLowerCase()){case"base64":Le=ri(pa(ke.slice(Ke).join("")));break;case"quoted-printable":Le=Et(ke.slice(Ke));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+_e)}var et=$t(ce,xe.slice(me.length),Le,{unsafe:!0});Ee&&(et.ctype=Ee)}function Ot(ce,ke){if(S(ce.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var me=ke&&ke.root||"",xe=(yr&&Buffer.isBuffer(ce)?ce.toString("binary"):S(ce)).split(`\r
`),_e=0,Ee="";for(_e=0;_e<xe.length;++_e)if(Ee=xe[_e],!!/^Content-Location:/i.test(Ee)&&(Ee=Ee.slice(Ee.indexOf("file")),me||(me=Ee.slice(0,Ee.lastIndexOf("/")+1)),Ee.slice(0,me.length)!=me))for(;me.length>0&&(me=me.slice(0,me.length-1),me=me.slice(0,me.lastIndexOf("/")+1),Ee.slice(0,me.length)!=me););var Le=(xe[1]||"").match(/boundary="(.*?)"/);if(!Le)throw new Error("MAD cannot find boundary");var Ke="--"+(Le[1]||""),Ue=[],Qe=[],et={FileIndex:Ue,FullPaths:Qe};F(et);var bt,Ct=0;for(_e=0;_e<xe.length;++_e){var Pt=xe[_e];Pt!==Ke&&Pt!==Ke+"--"||(Ct++&&jt(et,xe.slice(bt,_e),me),bt=_e)}return et}function yt(ce,ke){var me=ke||{},xe=me.boundary||"SheetJS";xe="------="+xe;for(var _e=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+xe.slice(2)+'"',"","",""],Ee=ce.FullPaths[0],Le=Ee,Ke=ce.FileIndex[0],Ue=1;Ue<ce.FullPaths.length;++Ue)if(Le=ce.FullPaths[Ue].slice(Ee.length),Ke=ce.FileIndex[Ue],!(!Ke.size||!Ke.content||Le=="Sh33tJ5")){Le=Le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var Qe=Ke.content,et=yr&&Buffer.isBuffer(Qe)?Qe.toString("binary"):S(Qe),bt=0,Ct=Math.min(1024,et.length),Pt=0,be=0;be<=Ct;++be)(Pt=et.charCodeAt(be))>=32&&Pt<128&&++bt;var Me=bt>=Ct*4/5;_e.push(xe),_e.push("Content-Location: "+(me.root||"file:///C:/SheetJS/")+Le),_e.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),_e.push("Content-Type: "+ct(Ke,Le)),_e.push(""),_e.push(Me?ft(et):ut(et))}return _e.push(xe+`--\r
`),_e.join(`\r
`)}function Vt(ce){var ke={};return F(ke,ce),ke}function $t(ce,ke,me,xe){var _e=xe&&xe.unsafe;_e||F(ce);var Ee=!_e&&_r.find(ce,ke);if(!Ee){var Le=ce.FullPaths[0];ke.slice(0,Le.length)==Le?Le=ke:(Le.slice(-1)!="/"&&(Le+="/"),Le=(Le+ke).replace("//","/")),Ee={name:s(ke),type:2},ce.FileIndex.push(Ee),ce.FullPaths.push(Le),_e||_r.utils.cfb_gc(ce)}return Ee.content=me,Ee.size=me?me.length:0,xe&&(xe.CLSID&&(Ee.clsid=xe.CLSID),xe.mt&&(Ee.mt=xe.mt),xe.ct&&(Ee.ct=xe.ct)),Ee}function Fe(ce,ke){F(ce);var me=_r.find(ce,ke);if(me){for(var xe=0;xe<ce.FileIndex.length;++xe)if(ce.FileIndex[xe]==me)return ce.FileIndex.splice(xe,1),ce.FullPaths.splice(xe,1),!0}return!1}function Be(ce,ke,me){F(ce);var xe=_r.find(ce,ke);if(xe){for(var _e=0;_e<ce.FileIndex.length;++_e)if(ce.FileIndex[_e]==xe)return ce.FileIndex[_e].name=s(me),ce.FullPaths[_e]=me,!0}return!1}function tt(ce){B(ce,!0)}return r.find=V,r.read=L,r.parse=u,r.write=T,r.writeFile=_,r.utils={cfb_new:Vt,cfb_add:$t,cfb_del:Fe,cfb_mov:Be,cfb_gc:tt,ReadShift:sh,CheckField:h8,prep_blob:Yn,bconcat:Jo,use_zlib:A,_deflateRaw:Ye,_inflateRaw:Xe,consts:w},r}();function YN(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(t);r.open("r"),r.encoding="binary";var e=r.read();return r.close(),e}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ni(t){for(var r=Object.keys(t),e=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(t,r[n])&&e.push(r[n]);return e}function Ab(t){for(var r=[],e=Ni(t),n=0;n!==e.length;++n)r[t[e[n]]]=e[n];return r}var Ep=new Date(1899,11,30,0,0,0);function Ms(t,r){var e=t.getTime(),n=Ep.getTime()+(t.getTimezoneOffset()-Ep.getTimezoneOffset())*6e4;return(e-n)/(24*60*60*1e3)}var q_=new Date,JN=Ep.getTime()+(q_.getTimezoneOffset()-Ep.getTimezoneOffset())*6e4,Lw=q_.getTimezoneOffset();function gm(t){var r=new Date;return r.setTime(t*24*60*60*1e3+JN),r.getTimezoneOffset()!==Lw&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Lw)*6e4),r}function ZN(t){var r=0,e=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(e=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":e*=24;case"H":e*=60;case"M":if(n)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=e*parseInt(s[a],10)}return r}var Iw=new Date("2017-02-19T19:06:09.000Z"),W_=isNaN(Iw.getFullYear())?new Date("2/19/17"):Iw,QN=W_.getFullYear()==2017;function Vn(t,r){var e=new Date(t);if(QN)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(W_.getFullYear()==1917&&!isNaN(e.getFullYear())){var n=e.getFullYear();return t.indexOf(""+n)>-1||e.setFullYear(e.getFullYear()+100),e}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function oc(t,r){if(yr&&Buffer.isBuffer(t)){if(r){if(t[0]==255&&t[1]==254)return zf(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return zf(P_(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(t[0]==255&&t[1]==254)return zf(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return zf(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return e[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Qn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=Qn(t[e]));return r}function an(t,r){for(var e="";e.length<r;)e+=t;return e}function oi(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return e=-e,a}),!isNaN(r=Number(n)))?r/e:r}var eD=["january","february","march","april","may","june","july","august","september","october","november","december"];function Mu(t){var r=new Date(t),e=new Date(NaN),n=r.getYear(),s=r.getMonth(),a=r.getDate();if(isNaN(a))return e;var i=t.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&eD.indexOf(i)==-1)return e}else if(i.match(/[a-z]/))return e;return n<0||n>8099?e:(s>0||a>1)&&n!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}var tD=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(e,n,s){if(t||typeof n=="string")return e.split(n);for(var a=e.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function G_(t){return t?t.content&&t.type?oc(t.content,!0):t.data?$f(t.data):t.asNodeBuffer&&yr?$f(t.asNodeBuffer().toString("binary")):t.asBinary?$f(t.asBinary()):t._data&&t._data.getContent?$f(oc(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function X_(t){if(!t)return null;if(t.data)return Aw(t.data);if(t.asNodeBuffer&&yr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var r=t._data.getContent();return typeof r=="string"?Aw(r):Array.prototype.slice.call(r)}return t.content&&t.type?t.content:null}function rD(t){return t&&t.name.slice(-4)===".bin"?X_(t):G_(t)}function Na(t,r){for(var e=t.FullPaths||Ni(t.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<e.length;++a){var i=e[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return t.files?t.files[e[a]]:t.FileIndex[a]}return null}function Cb(t,r){var e=Na(t,r);if(e==null)throw new Error("Cannot find file "+r+" in zip");return e}function kn(t,r,e){if(!e)return rD(Cb(t,r));if(!r)return null;try{return kn(t,r)}catch{return null}}function la(t,r,e){if(!e)return G_(Cb(t,r));if(!r)return null;try{return la(t,r)}catch{return null}}function nD(t,r,e){return X_(Cb(t,r))}function Bw(t){for(var r=t.FullPaths||Ni(t.files),e=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&e.push(r[n].replace(/^Root Entry[\/]/,""));return e.sort()}function sD(t,r,e){if(t.FullPaths){if(typeof e=="string"){var n;return yr?n=hc(e):n=SN(e),_r.utils.cfb_add(t,r,n)}_r.utils.cfb_add(t,r,e)}else t.file(r,e)}function K_(t,r){switch(r.type){case"base64":return _r.read(t,{type:"base64"});case"binary":return _r.read(t,{type:"binary"});case"buffer":case"array":return _r.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Hf(t,r){if(t.charAt(0)=="/")return t.slice(1);var e=r.split("/");r.slice(-1)!="/"&&e.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?e.pop():s!=="."&&e.push(s)}return e.join("/")}var Y_=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,aD=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,$w=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,iD=/<[^>]*>/g,ws=Y_.match($w)?$w:iD,oD=/<\w*:/,lD=/<(\/?)\w+:/;function nr(t,r,e){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(r||(n[0]=t.slice(0,s)),s===t.length)return n;var i=t.match(aD),o=0,l="",c=0,u="",d="",h=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],a=0;a!=d.length&&d.charCodeAt(a)!==61;++a);for(u=d.slice(0,a).trim();d.charCodeAt(a+1)==32;)++a;for(h=(s=d.charCodeAt(a+1))==34||s==39?1:0,l=d.slice(a+1+h,d.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var f=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[f]&&u.slice(o-3,o)=="ext")continue;n[f]=l,n[f.toLowerCase()]=l}}return n}function Di(t){return t.replace(lD,"<$1")}var J_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},cD=Ab(J_),Cr=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function e(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(o,l){return J_[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return e(s.slice(0,a))+s.slice(a+9,i)+e(s.slice(i+3))}}(),uD=/[&<>'"]/g,fD=/[\u0000-\u001f]/g;function Tb(t){var r=t+"";return r.replace(uD,function(e){return cD[e]}).replace(/\n/g,"<br/>").replace(fD,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var Uw=function(){var t=/&#(\d+);/g;function r(e,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,r)}}();function Xr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function G1(t){for(var r="",e=0,n=0,s=0,a=0,i=0,o=0;e<t.length;){if(n=t.charCodeAt(e++),n<128){r+=String.fromCharCode(n);continue}if(s=t.charCodeAt(e++),n>191&&n<224){i=(n&31)<<6,i|=s&63,r+=String.fromCharCode(i);continue}if(a=t.charCodeAt(e++),n<240){r+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=t.charCodeAt(e++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function Hw(t){var r=gl(2*t.length),e,n,s=1,a=0,i=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?e=o:o<224?(e=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(e=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,e=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),e-=65536,i=55296+(e>>>10&1023),e=56320+(e&1023)),i!==0&&(r[a++]=i&255,r[a++]=i>>>8,i=0),r[a++]=e%256,r[a++]=e>>>8;return r.slice(0,a).toString("ucs2")}function zw(t){return hc(t,"binary").toString("utf8")}var f0="foo bar baz",zr=yr&&(zw(f0)==G1(f0)&&zw||Hw(f0)==G1(f0)&&Hw)||G1,zf=yr?function(t){return hc(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,n=0,s=0;e<t.length;)switch(n=t.charCodeAt(e++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(e++)-56320+(n<<10),r.push(String.fromCharCode(240+(s>>18&7))),r.push(String.fromCharCode(144+(s>>12&63))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},jh=function(){var t={};return function(e,n){var s=e+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",n||"")}}(),Z_=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),hD=function(){var t={};return function(e){return t[e]!==void 0?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),dD=/<\/?(?:vt:)?variant>/g,pD=/<(?:vt:)([^>]*)>([\s\S]*)</;function Vw(t,r){var e=nr(t),n=t.match(hD(e.baseType))||[],s=[];if(n.length!=e.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+e.size);return s}return n.forEach(function(a){var i=a.replace(dD,"").match(pD);i&&s.push({v:zr(i[2]),t:i[1]})}),s}var mD=/(^\s|\s$|\n)/;function gD(t){return Ni(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function vD(t,r,e){return"<"+t+(e!=null?gD(e):"")+(r!=null?(r.match(mD)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function Nb(t){if(yr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return zr(dc(Sb(t)));throw new Error("Bad input format: expected Buffer or string")}var Lh=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,bD={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},yD=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function xD(t,r){for(var e=1-2*(t[r+7]>>>7),n=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),s=t[r+6]&15,a=5;a>=0;--a)s=s*256+t[r+a];return n==2047?s==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),e*Math.pow(2,n-52)*s)}function wD(t,r,e){var n=(r<0||1/r==-1/0?1:0)<<7,s=0,a=0,i=n?-r:r;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(r)?26985:0);for(var o=0;o<=5;++o,a/=256)t[e+o]=a&255;t[e+6]=(s&15)<<4|a&15,t[e+7]=s>>4|n}var qw=function(t){for(var r=[],e=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=e)r.push.apply(r,t[0][n].slice(s,s+e));return r},Ww=yr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:hc(r)})):qw(t)}:qw,Gw=function(t,r,e){for(var n=[],s=r;s<e;s+=2)n.push(String.fromCharCode(Qi(t,s)));return n.join("").replace(Os,"")},Db=yr?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(Os,""):Gw(t,r,e)}:Gw,Xw=function(t,r,e){for(var n=[],s=r;s<r+e;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},Q_=yr?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):Xw(t,r,e)}:Xw,Kw=function(t,r,e){for(var n=[],s=r;s<e;s++)n.push(String.fromCharCode(Xc(t,s)));return n.join("")},td=yr?function(r,e,n){return Buffer.isBuffer(r)?r.toString("utf8",e,n):Kw(r,e,n)}:Kw,e8=function(t,r){var e=oa(t,r);return e>0?td(t,r+4,r+4+e-1):""},t8=e8,r8=function(t,r){var e=oa(t,r);return e>0?td(t,r+4,r+4+e-1):""},n8=r8,s8=function(t,r){var e=2*oa(t,r);return e>0?td(t,r+4,r+4+e-1):""},a8=s8,i8=function(r,e){var n=oa(r,e);return n>0?Db(r,e+4,e+4+n):""},o8=i8,l8=function(t,r){var e=oa(t,r);return e>0?td(t,r+4,r+4+e):""},c8=l8,u8=function(t,r){return xD(t,r)},Ap=u8,f8=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};yr&&(t8=function(r,e){if(!Buffer.isBuffer(r))return e8(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},n8=function(r,e){if(!Buffer.isBuffer(r))return r8(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},a8=function(r,e){if(!Buffer.isBuffer(r))return s8(r,e);var n=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n-1)},o8=function(r,e){if(!Buffer.isBuffer(r))return i8(r,e);var n=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n)},c8=function(r,e){if(!Buffer.isBuffer(r))return l8(r,e);var n=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+n)},Ap=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):u8(r,e)},f8=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Xc=function(t,r){return t[r]},Qi=function(t,r){return t[r+1]*256+t[r]},_D=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},oa=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},Vl=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},SD=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function sh(t,r){var e="",n,s,a=[],i,o,l,c;switch(r){case"dbcs":if(c=this.l,yr&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)e+=String.fromCharCode(Qi(this,c)),c+=2;t*=2;break;case"utf8":e=td(this,this.l,this.l+t);break;case"utf16le":t*=2,e=Db(this,this.l,this.l+t);break;case"wstr":return sh.call(this,t,"dbcs");case"lpstr-ansi":e=t8(this,this.l),t=4+oa(this,this.l);break;case"lpstr-cp":e=n8(this,this.l),t=4+oa(this,this.l);break;case"lpwstr":e=a8(this,this.l),t=4+2*oa(this,this.l);break;case"lpp4":t=4+oa(this,this.l),e=o8(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+oa(this,this.l),e=c8(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(i=Xc(this,this.l+t++))!==0;)a.push(u0(i));e=a.join("");break;case"_wstr":for(t=0,e="";(i=Qi(this,this.l+t))!==0;)a.push(u0(i)),t+=2;t+=2,e=a.join("");break;case"dbcs-cont":for(e="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Xc(this,c),this.l=c+1,o=sh.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(u0(Qi(this,c))),c+=2}e=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(e="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Xc(this,c),this.l=c+1,o=sh.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(u0(Xc(this,c))),c+=1}e=a.join("");break;default:switch(t){case 1:return n=Xc(this,this.l),this.l++,n;case 2:return n=(r==="i"?_D:Qi)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(t>0?Vl:SD)(this,this.l),this.l+=4,n):(s=oa(this,this.l),this.l+=4,s);case 8:case-8:if(r==="f")return t==8?s=Ap(this,this.l):s=Ap([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:e=Q_(this,this.l,t);break}}return this.l+=t,e}var kD=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},ED=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},AD=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function CD(t,r,e){var n=0,s=0;if(e==="dbcs"){for(s=0;s!=r.length;++s)AD(this,r.charCodeAt(s),this.l+2*s);n=2*r.length}else if(e==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255;n=r.length}else if(e==="hex"){for(;s<t;++s)this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0;return this}else if(e==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(r.length,t);++s){var i=r.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,kD(this,r,this.l);break;case 8:if(n=8,e==="f"){wD(this,r,this.l);break}case 16:break;case-4:n=4,ED(this,r,this.l);break}return this.l+=n,this}function h8(t,r){var e=Q_(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function Yn(t,r){t.l=r,t.read_shift=sh,t.chk=h8,t.write_shift=CD}function xs(t,r){t.l+=r}function Dn(t){var r=gl(t);return Yn(r,0),r}function go(t,r,e){if(t){var n,s,a;Yn(t,t.l||0);for(var i=t.length,o=0,l=0;t.l<i;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Pp[o]||Pp[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;l=t.l+a;var u=c.f&&c.f(t,a,e);if(t.l=l,r(u,c,o))return}}}function j2(){var t=[],r=yr?256:2048,e=function(c){var u=Dn(c);return Yn(u,0),u},n=e(r),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(s(),n=e(Math.max(c+1,r)))},i=function(){return s(),Jo(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),a(r)};return{next:a,push:o,end:i,_bufs:t}}function ah(t,r,e){var n=Qn(t);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Yw(t,r,e){var n=Qn(t);return n.s=ah(n.s,r.s,e),n.e=ah(n.e,r.s,e),n}function ih(t,r){if(t.cRel&&t.c<0)for(t=Qn(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=Qn(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=cr(t);return!t.cRel&&t.cRel!=null&&(e=DD(e)),!t.rRel&&t.rRel!=null&&(e=TD(e)),e}function X1(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Mn(t.s.c)+":"+(t.e.cRel?"":"$")+Mn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+es(t.s.r)+":"+(t.e.rRel?"":"$")+es(t.e.r):ih(t.s,r.biff)+":"+ih(t.e,r.biff)}function Rb(t){return parseInt(ND(t),10)-1}function es(t){return""+(t+1)}function TD(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function ND(t){return t.replace(/\$(\d+)$/,"$1")}function Pb(t){for(var r=RD(t),e=0,n=0;n!==r.length;++n)e=26*e+r.charCodeAt(n)-64;return e-1}function Mn(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function DD(t){return t.replace(/^([A-Z])/,"$$$1")}function RD(t){return t.replace(/^\$([A-Z])/,"$1")}function PD(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Rs(t){for(var r=0,e=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?r=10*r+(s-48):s>=65&&s<=90&&(e=26*e+(s-64))}return{c:e-1,r:r-1}}function cr(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function Wu(t){var r=t.indexOf(":");return r==-1?{s:Rs(t),e:Rs(t)}:{s:Rs(t.slice(0,r)),e:Rs(t.slice(r+1))}}function Sr(t,r){return typeof r>"u"||typeof r=="number"?Sr(t.s,t.e):(typeof t!="string"&&(t=cr(t)),typeof r!="string"&&(r=cr(r)),t==r?t:t+":"+r)}function ln(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,s=0,a=t.length;for(e=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)e=26*e+s;for(r.s.c=--e,e=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)e=10*e+s;if(r.s.r=--e,n===a||s!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,e=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)e=26*e+s;for(r.e.c=--e,e=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)e=10*e+s;return r.e.r=--e,r}function Jw(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=La(t.z,e?Ms(r):r)}catch{}try{return t.w=La((t.XF||{}).numFmtId||(e?14:0),e?Ms(r):r)}catch{return""+r}}function co(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?gc[t.v]||t.v:r==null?Jw(t,t.v):Jw(t,r))}function El(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",n={};return n[e]=t,{SheetNames:[e],Sheets:n}}function d8(t,r,e){var n=e||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Rs(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=ln(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var d=0;d!=r.length;++d)if(r[d]){if(!Array.isArray(r[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=r[d].length;++h)if(!(typeof r[d][h]>"u")){var f={v:r[d][h]},g=i+d,m=o+h;if(c.s.r>g&&(c.s.r=g),c.s.c>m&&(c.s.c=m),c.e.r<g&&(c.e.r=g),c.e.c<m&&(c.e.c=m),r[d][h]&&typeof r[d][h]=="object"&&!Array.isArray(r[d][h])&&!(r[d][h]instanceof Date))f=r[d][h];else if(Array.isArray(f.v)&&(f.f=r[d][h][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else if(n.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=n.dateNF||dr[14],n.cellDates?(f.t="d",f.w=La(f.z,Ms(f.v))):(f.t="n",f.v=Ms(f.v),f.w=La(f.z,f.v))):f.t="s";if(s)a[g]||(a[g]=[]),a[g][m]&&a[g][m].z&&(f.z=a[g][m].z),a[g][m]=f;else{var p=cr({c:m,r:g});a[p]&&a[p].z&&(f.z=a[p].z),a[p]=f}}}return c.s.c<1e7&&(a["!ref"]=Sr(c)),a}function Gu(t,r){return d8(null,t,r)}function OD(t){return t.read_shift(4,"i")}function bs(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function MD(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Ob(t,r){var e=t.l,n=t.read_shift(1),s=bs(t),a=[],i={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)a.push(MD(t));i.r=a}else i.r=[{ich:0,ifnt:0}];return t.l=e+r,i}var FD=Ob;function Ia(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function pc(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}var jD=bs;function Mb(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}var LD=bs,L2=Mb;function Fb(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,n=r[0]&2;t.l+=4;var s=n===0?Ap([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Vl(r,0)>>2;return e?s/100:s}function p8(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}var mc=p8;function ms(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function ID(t){var r={},e=t.read_shift(1),n=e>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),i=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:r.auto=1;break;case 1:r.index=s;var c=Ql[s];c&&(r.rgb=Bh(c));break;case 2:r.rgb=Bh([i,o,l]);break;case 3:r.theme=s;break}return a!=0&&(r.tint=a>0?a/32767:a/32768),r}function BD(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function m8(t,r){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return e[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,r==1?"lpstr":"lpwstr")}function $D(t){return m8(t,1)}function UD(t){return m8(t,2)}var jb=2,Vs=3,h0=11,Zw=12,Cp=19,d0=64,HD=65,zD=71,VD=4108,qD=4126,$n=80,g8=81,WD=[$n,g8],GD={1:{n:"CodePage",t:jb},2:{n:"Category",t:$n},3:{n:"PresentationFormat",t:$n},4:{n:"ByteCount",t:Vs},5:{n:"LineCount",t:Vs},6:{n:"ParagraphCount",t:Vs},7:{n:"SlideCount",t:Vs},8:{n:"NoteCount",t:Vs},9:{n:"HiddenCount",t:Vs},10:{n:"MultimediaClipCount",t:Vs},11:{n:"ScaleCrop",t:h0},12:{n:"HeadingPairs",t:VD},13:{n:"TitlesOfParts",t:qD},14:{n:"Manager",t:$n},15:{n:"Company",t:$n},16:{n:"LinksUpToDate",t:h0},17:{n:"CharacterCount",t:Vs},19:{n:"SharedDoc",t:h0},22:{n:"HyperlinksChanged",t:h0},23:{n:"AppVersion",t:Vs,p:"version"},24:{n:"DigSig",t:HD},26:{n:"ContentType",t:$n},27:{n:"ContentStatus",t:$n},28:{n:"Language",t:$n},29:{n:"Version",t:$n},255:{},2147483648:{n:"Locale",t:Cp},2147483651:{n:"Behavior",t:Cp},1919054434:{}},XD={1:{n:"CodePage",t:jb},2:{n:"Title",t:$n},3:{n:"Subject",t:$n},4:{n:"Author",t:$n},5:{n:"Keywords",t:$n},6:{n:"Comments",t:$n},7:{n:"Template",t:$n},8:{n:"LastAuthor",t:$n},9:{n:"RevNumber",t:$n},10:{n:"EditTime",t:d0},11:{n:"LastPrinted",t:d0},12:{n:"CreatedDate",t:d0},13:{n:"ModifiedDate",t:d0},14:{n:"PageCount",t:Vs},15:{n:"WordCount",t:Vs},16:{n:"CharCount",t:Vs},17:{n:"Thumbnail",t:zD},18:{n:"Application",t:$n},19:{n:"DocSecurity",t:Vs},255:{},2147483648:{n:"Locale",t:Cp},2147483651:{n:"Behavior",t:Cp},1919054434:{}},Qw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},KD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function YD(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var JD=YD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ql=Qn(JD),gc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},v8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},e5={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function ZD(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function QD(t){var r=ZD();if(!t||!t.match)return r;var e={};if((t.match(ws)||[]).forEach(function(n){var s=nr(n);switch(s[0].replace(oD,"<")){case"<?xml":break;case"<Types":r.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[s.Extension]=s.ContentType;break;case"<Override":r[e5[s.ContentType]]!==void 0&&r[e5[s.ContentType]].push(s.PartName);break}}),r.xmlns!==bD.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=e,delete r.calcchains,r}var cu={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function I2(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function oh(t,r){var e={"!id":{}};if(!t)return e;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(t.match(ws)||[]).forEach(function(s){var a=nr(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:Hf(a.Target,r);e[o]=i,n[a.Id]=i}}),e["!id"]=n,e}var eR="application/vnd.oasis.opendocument.spreadsheet";function tR(t,r){for(var e=Nb(t),n,s;n=Lh.exec(e);)switch(n[3]){case"manifest":break;case"file-entry":if(s=nr(n[0],!1),s.path=="/"&&s.type!==eR)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var lh=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],rR=function(){for(var t=new Array(lh.length),r=0;r<lh.length;++r){var e=lh[r],n="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function b8(t){var r={};t=zr(t);for(var e=0;e<lh.length;++e){var n=lh[e],s=t.match(rR[e]);s!=null&&s.length>0&&(r[n[1]]=Cr(s[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=Vn(r[n[1]]))}return r}var nR=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function y8(t,r,e,n){var s=[];if(typeof t=="string")s=Vw(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(u){return{v:u}}));var i=typeof r=="string"?Vw(r,n).map(function(u){return u.v}):r,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":e.Worksheets=l,e.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":e.NamedRanges=l,e.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":e.Chartsheets=l,e.ChartNames=i.slice(o,o+l);break}o+=l}}function sR(t,r,e){var n={};return r||(r={}),t=zr(t),nR.forEach(function(s){var a=(t.match(jh(s[0]))||[])[1];switch(s[2]){case"string":a&&(r[s[1]]=Cr(a));break;case"bool":r[s[1]]=a==="true";break;case"raw":var i=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&y8(n.HeadingPairs,n.TitlesOfParts,r,e),r}var aR=/<[^>]+>[^<]*/g;function iR(t,r){var e={},n="",s=t.match(aR);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=nr(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Cr(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":e[n]=Cr(u);break;case"bool":e[n]=Xr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":e[n]=parseFloat(u);break;case"filetime":case"date":e[n]=Vn(u);break;case"cy":case"error":e[n]=Cr(u);break;default:if(c.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(r.WTF)throw new Error(i)}}}return e}var oR={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},K1;function lR(t,r,e){K1||(K1=Ab(oR)),r=K1[r]||r,t[r]=e}function Lb(t){var r=t.read_shift(4),e=t.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function x8(t,r,e){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-n&3;)++t.l;return s}function w8(t,r,e){var n=t.read_shift(0,"lpwstr");return n}function _8(t,r,e){return r===31?w8(t):x8(t,r,e)}function B2(t,r,e){return _8(t,r,e===!1?0:4)}function cR(t,r){if(!r)throw new Error("VtUnalignedString must have positive length");return _8(t,r,0)}function uR(t){for(var r=t.read_shift(4),e=[],n=0;n!=r;++n){var s=t.l;e[n]=t.read_shift(0,"lpwstr").replace(Os,""),t.l-s&2&&(t.l+=2)}return e}function fR(t){for(var r=t.read_shift(4),e=[],n=0;n!=r;++n)e[n]=t.read_shift(0,"lpstr-cp").replace(Os,"");return e}function hR(t){var r=t.l,e=Tp(t,g8);t[t.l]==0&&t[t.l+1]==0&&t.l-r&2&&(t.l+=2);var n=Tp(t,Vs);return[e,n]}function dR(t){for(var r=t.read_shift(4),e=[],n=0;n<r/2;++n)e.push(hR(t));return e}function t5(t,r){for(var e=t.read_shift(4),n={},s=0;s!=e;++s){var a=t.read_shift(4),i=t.read_shift(4);n[a]=t.read_shift(i,r===1200?"utf16le":"utf8").replace(Os,"").replace(Uf,"!"),r===1200&&i%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function S8(t){var r=t.read_shift(4),e=t.slice(t.l,t.l+r);return t.l+=r,(r&3)>0&&(t.l+=4-(r&3)&3),e}function pR(t){var r={};return r.Size=t.read_shift(4),t.l+=r.Size+3-(r.Size-1)%4,r}function Tp(t,r,e){var n=t.read_shift(2),s,a=e||{};if(t.l+=2,r!==Zw&&n!==r&&WD.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Zw?n:r){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return x8(t,n,4).replace(Os,"");case 31:return w8(t);case 64:return Lb(t);case 65:return S8(t);case 71:return pR(t);case 80:return B2(t,n,!a.raw).replace(Os,"");case 81:return cR(t,n).replace(Os,"");case 4108:return dR(t);case 4126:case 4127:return n==4127?uR(t):fR(t);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function r5(t,r){var e=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var u=t.read_shift(4),d=t.read_shift(4);a[i]=[u,d+e]}a.sort(function(b,y){return b[1]-y[1]});var h={};for(i=0;i!=s;++i){if(t.l!==a[i][1]){var f=!0;if(i>0&&r)switch(r[a[i-1][0]].t){case 2:t.l+2===a[i][1]&&(t.l+=2,f=!1);break;case 80:t.l<=a[i][1]&&(t.l=a[i][1],f=!1);break;case 4108:t.l<=a[i][1]&&(t.l=a[i][1],f=!1);break}if((!r||i==0)&&t.l<=a[i][1]&&(f=!1,t.l=a[i][1]),f)throw new Error("Read Error: Expected address "+a[i][1]+" at "+t.l+" :"+i)}if(r){var g=r[a[i][0]];if(h[g.n]=Tp(t,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ni(o=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(a[i][0]===1){if(o=h.CodePage=Tp(t,jb),ni(o),l!==-1){var m=t.l;t.l=a[l][1],c=t5(t,o),t.l=m}}else if(a[i][0]===0){if(o===0){l=i,t.l=a[i+1][1];continue}c=t5(t,o)}else{var p=c[a[i][0]],v;switch(t[t.l]){case 65:t.l+=4,v=S8(t);break;case 30:t.l+=4,v=B2(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,v=B2(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,v=t.read_shift(4,"i");break;case 19:t.l+=4,v=t.read_shift(4);break;case 5:t.l+=4,v=t.read_shift(8,"f");break;case 11:t.l+=4,v=dn(t,4);break;case 64:t.l+=4,v=Vn(Lb(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[p]=v}}return t.l=e+n,h}function n5(t,r,e){var n=t.content;if(!n)return{};Yn(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==_r.utils.consts.HEADER_CLSID&&u!==e)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=r5(n,r),h={SystemIdentifier:c};for(var f in d)h[f]=d[f];if(h.FMTID=a,s===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=r5(n,null)}catch{}for(f in g)h[f]=g[f];return h.FMTID=[a,i],h}function Lo(t,r){return t.read_shift(r),null}function mR(t,r,e){for(var n=[],s=t.l+r;t.l<s;)n.push(e(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function dn(t,r){return t.read_shift(r)===1}function En(t){return t.read_shift(2,"u")}function k8(t,r){return mR(t,r,En)}function gR(t){var r=t.read_shift(1),e=t.read_shift(1);return e===1?r:r===1}function rd(t,r,e){var n=t.read_shift(e&&e.biff>=12?2:1),s="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else e.biff==12&&(s="wstr");e.biff>=2&&e.biff<=5&&(s="cpstr");var i=n?t.read_shift(n,s):"";return i}function vR(t){var r=t.read_shift(2),e=t.read_shift(1),n=e&4,s=e&8,a=1+(e&1),i=0,o,l={};s&&(i=t.read_shift(2)),n&&(o=t.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",u=r===0?"":t.read_shift(r,c);return s&&(t.l+=4*i),n&&(t.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function lc(t,r,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(r,"sbcs-cont"):n=t.read_shift(r,"dbcs-cont"),n}function nd(t,r,e){var n=t.read_shift(e&&e.biff==2?1:2);return n===0?(t.l++,""):lc(t,n,e)}function vc(t,r,e){if(e.biff>5)return nd(t,r,e);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function bR(t){var r=t.read_shift(1);t.l++;var e=t.read_shift(2);return t.l+=2,[r,e]}function yR(t){var r=t.read_shift(4),e=t.l,n=!1;r>24&&(t.l+=r-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=e);var s=t.read_shift((n?r-24:r)>>1,"utf16le").replace(Os,"");return n&&(t.l+=24),s}function xR(t){for(var r=t.read_shift(2),e="";r-- >0;)e+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return e+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=t.read_shift(a>>1,"utf16le").replace(Os,"");return e+i}function wR(t,r){var e=t.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return yR(t);case"0303000000000000c000000000000046":return xR(t);default:throw new Error("Unsupported Moniker "+e)}}function p0(t){var r=t.read_shift(4),e=r>0?t.read_shift(r,"utf16le").replace(Os,""):"";return e}function _R(t,r){var e=t.l+r,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,i,o,l,c="",u,d;s&16&&(a=p0(t,e-t.l)),s&128&&(i=p0(t,e-t.l)),(s&257)===257&&(o=p0(t,e-t.l)),(s&257)===1&&(l=wR(t,e-t.l)),s&8&&(c=p0(t,e-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(d=Lb(t)),t.l=e;var h=i||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var f={Target:h};return u&&(f.guid=u),d&&(f.time=d),a&&(f.Tooltip=a),f}function E8(t){var r=t.read_shift(1),e=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[r,e,n,s]}function A8(t,r){var e=E8(t);return e[3]=0,e}function Ri(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2);return{r,c:e,ixfe:n}}function SR(t){var r=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:r,flags:e}}function kR(t,r,e){return r===0?"":vc(t,r,e)}function ER(t,r,e){var n=e.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),i=t.read_shift(n,"i");return[s,a,i]}function C8(t){var r=t.read_shift(2),e=Fb(t);return[r,e]}function AR(t,r,e){t.l+=4,r-=4;var n=t.l+r,s=rd(t,r,e),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function vm(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r},e:{c:s,r:e}}}function T8(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r},e:{c:s,r:e}}}var CR=T8;function N8(t){t.l+=4;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[e,r,n]}function TR(t){var r={};return t.l+=4,t.l+=16,r.fSharedNote=t.read_shift(2),t.l+=4,r}function NR(t){var r={};return t.l+=4,t.cf=t.read_shift(2),r}function is(t){t.l+=2,t.l+=t.read_shift(2)}var DR={0:is,4:is,5:is,6:is,7:NR,8:is,9:is,10:is,11:is,12:is,13:TR,14:is,15:is,16:is,17:is,18:is,19:is,20:is,21:N8};function RR(t,r){for(var e=t.l+r,n=[];t.l<e;){var s=t.read_shift(2);t.l-=2;try{n.push(DR[s](t,e-t.l))}catch{return t.l=e,n}}return t.l!=e&&(t.l=e),n}function m0(t,r){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),r-=2,r>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(r),e}function PR(t,r){return r===0||t.read_shift(2),1200}function OR(t,r,e){if(e.enc)return t.l+=r,"";var n=t.l,s=vc(t,0,e);return t.read_shift(r+n-t.l),s}function MR(t,r,e){var n=e&&e.biff==8||r==2?t.read_shift(2):(t.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function FR(t,r,e){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=rd(t,0,e);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function jR(t,r){for(var e=t.l+r,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0;i!=s&&t.l<e;++i)a.push(vR(t));return a.Count=n,a.Unique=s,a}function LR(t,r){var e={};return e.dsst=t.read_shift(2),t.l+=r-2,e}function IR(t){var r={};r.r=t.read_shift(2),r.c=t.read_shift(2),r.cnt=t.read_shift(2)-r.c;var e=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=e/20),r}function BR(t){var r=SR(t);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var e=t.read_shift(4);return e!==0}function $R(t){return t.read_shift(2),t.read_shift(4)}function s5(t,r,e){var n=0;e&&e.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);e&&e.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function UR(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[r,e],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function HR(t,r,e){if(e&&e.biff>=2&&e.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function zR(){}function VR(t,r,e){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=rd(t,0,e),n}function qR(t){var r=Ri(t);return r.isst=t.read_shift(4),r}function WR(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=t.l+r,s=Ri(t);e.biff==2&&t.l++;var a=nd(t,n-t.l,e);return s.val=a,s}function GR(t,r,e){var n=t.read_shift(2),s=vc(t,0,e);return[n,s]}var XR=vc;function a5(t,r,e){var n=t.l+r,s=e.biff==8||!e.biff?4:2,a=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function KR(t){var r=t.read_shift(2),e=t.read_shift(2),n=C8(t);return{r,c:e,ixfe:n[0],rknum:n[1]}}function YR(t,r){for(var e=t.l+r-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<e;)a.push(C8(t));if(t.l!==e)throw new Error("MulRK read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function JR(t,r){for(var e=t.l+r-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<e;)a.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function ZR(t,r,e,n){var s={},a=t.read_shift(4),i=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=KD[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function QR(t,r,e){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=ZR(t,r,n.fStyle,e),n}function eP(t){t.l+=4;var r=[t.read_shift(2),t.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function i5(t,r,e){var n=Ri(t);(e.biff==2||r==9)&&++t.l;var s=gR(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function tP(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=Ri(t),s=ms(t);return n.val=s,n}var o5=kR;function rP(t,r,e){var n=t.l+r,s=t.read_shift(2),a=t.read_shift(2);if(e.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=lc(t,a),o=[];n>t.l;)o.push(nd(t));return[a,s,i,o]}function l5(t,r,e){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return e.sbcch===14849&&(s=AR(t,r-2,e)),a.body=s||t.read_shift(r-2),typeof s=="string"&&(a.Name=s),a}var nP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function c5(t,r,e){var n=t.l+r,s=t.read_shift(2),a=t.read_shift(1),i=t.read_shift(1),o=t.read_shift(e&&e.biff==2?1:2),l=0;(!e||e.biff>=5)&&(e.biff!=5&&(t.l+=2),l=t.read_shift(2),e.biff==5&&(t.l+=2),t.l+=4);var c=lc(t,i,e);s&32&&(c=nP[c.charCodeAt(0)]);var u=n-t.l;e&&e.biff==2&&--u;var d=n==t.l||o===0||!(u>0)?[]:IF(t,u,e,o);return{chKey:a,Name:c,itab:l,rgce:d}}function D8(t,r,e){if(e.biff<8)return sP(t,r,e);for(var n=[],s=t.l+r,a=t.read_shift(e.biff>8?4:2);a--!==0;)n.push(ER(t,e.biff>8?12:6,e));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function sP(t,r,e){t[t.l+1]==3&&t[t.l]++;var n=rd(t,r,e);return n.charCodeAt(0)==3?n.slice(1):n}function aP(t,r,e){if(e.biff<8){t.l+=r;return}var n=t.read_shift(2),s=t.read_shift(2),a=lc(t,n,e),i=lc(t,s,e);return[a,i]}function iP(t,r,e){var n=T8(t);t.l++;var s=t.read_shift(1);return r-=8,[BF(t,r,e),s,n]}function u5(t,r,e){var n=CR(t);switch(e.biff){case 2:t.l++,r-=7;break;case 3:case 4:t.l+=2,r-=8;break;default:t.l+=6,r-=12}return[n,jF(t,r,e)]}function oP(t){var r=t.read_shift(4)!==0,e=t.read_shift(4)!==0,n=t.read_shift(4);return[r,e,n]}function lP(t,r,e){if(!(e.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=vc(t,0,e);return e.biff<8&&t.read_shift(1),[{r:n,c:s},o,i,a]}}function cP(t,r,e){return lP(t,r,e)}function uP(t,r){for(var e=[],n=t.read_shift(2);n--;)e.push(vm(t));return e}function fP(t,r,e){if(e&&e.biff<8)return dP(t,r,e);var n=N8(t),s=RR(t,r-22,n[1]);return{cmo:n,ft:s}}var hP={8:function(t,r){var e=t.l+r;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=e,{fmt:n}}};function dP(t,r,e){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,r-=36;var i=[];return i.push((hP[n]||xs)(t,r,e)),{cmo:[s,n,a],ft:i}}function pP(t,r,e){var n=t.l,s="";try{t.l+=4;var a=(e.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:i=bR(t,6,e);var o=t.read_shift(2);t.read_shift(2),En(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],d=lc(t,t.lens[c+1]-t.lens[c]-1);if(s+=d,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+r,{t:s}}catch{return t.l=n+r,{t:s}}}function mP(t,r){var e=vm(t);t.l+=16;var n=_R(t,r-24);return[e,n]}function gP(t,r){t.read_shift(2);var e=vm(t),n=t.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Os,""),[e,n]}function vP(t){var r=[0,0],e;return e=t.read_shift(2),r[0]=Qw[e]||e,e=t.read_shift(2),r[1]=Qw[e]||e,r}function bP(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(A8(t));return e}function yP(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(A8(t));return e}function xP(t){t.l+=2;var r={cxfs:0,crc:0};return r.cxfs=t.read_shift(2),r.crc=t.read_shift(4),r}function R8(t,r,e){if(!e.cellStyles)return xs(t,r);var n=e&&e.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:a,w:i,ixfe:o,flags:l};return(e.biff>=5||!e.biff)&&(c.level=l>>8&7),c}function wP(t,r){var e={};return r<32||(t.l+=16,e.header=ms(t),e.footer=ms(t),t.l+=2),e}function _P(t,r,e){var n={area:!1};if(e.biff!=5)return t.l+=r,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var SP=Ri,kP=k8,EP=nd;function AP(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),s={fmt:r,env:e,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function CP(t,r,e){e.biffguess&&e.biff==5&&(e.biff=2);var n=Ri(t);++t.l;var s=vc(t,r-7,e);return n.t="str",n.val=s,n}function TP(t){var r=Ri(t);++t.l;var e=ms(t);return r.t="n",r.val=e,r}function NP(t){var r=Ri(t);++t.l;var e=t.read_shift(2);return r.t="n",r.val=e,r}function DP(t){var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,"sbcs-cont")}function RP(t,r){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=r-13}function PP(t,r,e){var n=t.l+r,s=Ri(t),a=t.read_shift(2),i=lc(t,a,e);return t.l=n,s.t="str",s.val=i,s}var OP=[2,3,48,49,131,139,140,245],f5=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Ab({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(o,l){var c=[],u=gl(1);switch(l.type){case"base64":u=ri(pa(o));break;case"binary":u=ri(o);break;case"buffer":case"array":u=o;break}Yn(u,0);var d=u.read_shift(1),h=!!(d&136),f=!1,g=!1;switch(d){case 2:break;case 3:break;case 48:f=!0,h=!0;break;case 49:f=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,p=521;d==2&&(m=u.read_shift(2)),u.l+=3,d!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(p=u.read_shift(2));var v=u.read_shift(2),b=l.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=t[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var y=[],k={},N=Math.min(u.length,d==2?521:p-10-(f?264:0)),L=g?32:11;u.l<N&&u[u.l]!=13;)switch(k={},k.name=F2.utils.decode(b,u.slice(u.l,u.l+L)).replace(/[\u0000\r\n].*$/g,""),u.l+=L,k.type=String.fromCharCode(u.read_shift(1)),d!=2&&!g&&(k.offset=u.read_shift(4)),k.len=u.read_shift(1),d==2&&(k.offset=u.read_shift(2)),k.dec=u.read_shift(1),k.name.length&&y.push(k),d!=2&&(u.l+=g?13:14),k.type){case"B":(!f||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(u[u.l]!==13&&(u.l=p-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=p;var F=0,R=0;for(c[0]=[],R=0;R!=y.length;++R)c[0][R]=y[R].name;for(;m-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++F]=[],R=0,R=0;R!=y.length;++R){var B=u.slice(u.l,u.l+y[R].len);u.l+=y[R].len,Yn(B,0);var q=F2.utils.decode(b,B);switch(y[R].type){case"C":q.trim().length&&(c[F][R]=q.replace(/\s+$/,""));break;case"D":q.length===8?c[F][R]=new Date(+q.slice(0,4),+q.slice(4,6)-1,+q.slice(6,8)):c[F][R]=q;break;case"F":c[F][R]=parseFloat(q.trim());break;case"+":case"I":c[F][R]=g?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(q.trim().toUpperCase()){case"Y":case"T":c[F][R]=!0;break;case"N":case"F":c[F][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+q+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[F][R]="##MEMO##"+(g?parseInt(q.trim(),10):B.read_shift(4));break;case"N":q=q.replace(/\u0000/g,"").trim(),q&&q!="."&&(c[F][R]=+q||0);break;case"@":c[F][R]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":c[F][R]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":c[F][R]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[F][R]=-B.read_shift(-8,"f");break;case"B":if(f&&y[R].len==8){c[F][R]=B.read_shift(8,"f");break}case"G":case"P":B.l+=y[R].len;break;case"0":if(y[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[R].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Gu(e(o,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function s(o,l){try{return El(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&ni(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=j2(),d=q2(o,{header:1,raw:!0,cellDates:!0}),h=d[0],f=d.slice(1),g=o["!cols"]||[],m=0,p=0,v=0,b=1;for(m=0;m<h.length;++m){if(((g[m]||{}).DBF||{}).name){h[m]=g[m].DBF.name,++v;continue}if(h[m]!=null){if(++v,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(p=0;p<1024;++p)if(h.indexOf(h[m]+"_"+p)==-1){h[m]+="_"+p;break}}}}var y=ln(o["!ref"]),k=[],N=[],L=[];for(m=0;m<=y.e.c-y.s.c;++m){var F="",R="",B=0,q=[];for(p=0;p<f.length;++p)f[p][m]!=null&&q.push(f[p][m]);if(q.length==0||h[m]==null){k[m]="?";continue}for(p=0;p<q.length;++p){switch(typeof q[p]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=q[p]instanceof Date?"D":"C";break;default:R="C"}B=Math.max(B,String(q[p]).length),F=F&&F!=R?"C":R}B>250&&(B=250),R=((g[m]||{}).DBF||{}).type,R=="C"&&g[m].DBF.len>B&&(B=g[m].DBF.len),F=="B"&&R=="N"&&(F="N",L[m]=g[m].DBF.dec,B=g[m].DBF.len),N[m]=F=="C"||R=="N"?B:a[F]||0,b+=N[m],k[m]=F}var V=u.next(32);for(V.write_shift(4,318902576),V.write_shift(4,f.length),V.write_shift(2,296+32*v),V.write_shift(2,b),m=0;m<4;++m)V.write_shift(4,0);for(V.write_shift(4,0|(+r[D_]||3)<<8),m=0,p=0;m<h.length;++m)if(h[m]!=null){var I=u.next(32),C=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,C,"sbcs"),I.write_shift(1,k[m]=="?"?"C":k[m],"sbcs"),I.write_shift(4,p),I.write_shift(1,N[m]||a[k[m]]||0),I.write_shift(1,L[m]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),p+=N[m]||a[k[m]]||0}var O=u.next(264);for(O.write_shift(4,13),m=0;m<65;++m)O.write_shift(4,0);for(m=0;m<f.length;++m){var E=u.next(b);for(E.write_shift(1,0),p=0;p<h.length;++p)if(h[p]!=null)switch(k[p]){case"L":E.write_shift(1,f[m][p]==null?63:f[m][p]?84:70);break;case"B":E.write_shift(8,f[m][p]||0,"f");break;case"N":var x="0";for(typeof f[m][p]=="number"&&(x=f[m][p].toFixed(L[p]||0)),v=0;v<N[p]-x.length;++v)E.write_shift(1,32);E.write_shift(1,x,"sbcs");break;case"D":f[m][p]?(E.write_shift(4,("0000"+f[m][p].getFullYear()).slice(-4),"sbcs"),E.write_shift(2,("00"+(f[m][p].getMonth()+1)).slice(-2),"sbcs"),E.write_shift(2,("00"+f[m][p].getDate()).slice(-2),"sbcs")):E.write_shift(8,"00000000","sbcs");break;case"C":var w=String(f[m][p]!=null?f[m][p]:"").slice(0,N[p]);for(E.write_shift(1,w,"sbcs"),v=0;v<N[p]-w.length;++v)E.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),MP=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Ni(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(h,f){var g=t[f];return typeof g=="number"?Cw(g):g},n=function(h,f,g){var m=f.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?h:Cw(m)};t["|"]=254;function s(h,f){switch(f.type){case"base64":return a(pa(h),f);case"binary":return a(h,f);case"buffer":return a(yr&&Buffer.isBuffer(h)?h.toString("binary"):dc(h),f);case"array":return a(oc(h),f)}throw new Error("Unrecognized type "+f.type)}function a(h,f){var g=h.split(/[\n\r]+/),m=-1,p=-1,v=0,b=0,y=[],k=[],N=null,L={},F=[],R=[],B=[],q=0,V;for(+f.codepage>=0&&ni(+f.codepage);v!==g.length;++v){q=0;var I=g[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,e),C=I.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),O=C[0],E;if(I.length>0)switch(O){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":C[1].charAt(0)=="P"&&k.push(I.slice(3).replace(/;;/g,";"));break;case"C":var x=!1,w=!1,_=!1,S=!1,T=-1,U=-1;for(b=1;b<C.length;++b)switch(C[b].charAt(0)){case"A":break;case"X":p=parseInt(C[b].slice(1))-1,w=!0;break;case"Y":for(m=parseInt(C[b].slice(1))-1,w||(p=0),V=y.length;V<=m;++V)y[V]=[];break;case"K":E=C[b].slice(1),E.charAt(0)==='"'?E=E.slice(1,E.length-1):E==="TRUE"?E=!0:E==="FALSE"?E=!1:isNaN(oi(E))?isNaN(Mu(E).getDate())||(E=Vn(E)):(E=oi(E),N!==null&&qu(N)&&(E=gm(E))),x=!0;break;case"E":S=!0;var A=bu(C[b].slice(1),{r:m,c:p});y[m][p]=[y[m][p],A];break;case"S":_=!0,y[m][p]=[y[m][p],"S5S"];break;case"G":break;case"R":T=parseInt(C[b].slice(1))-1;break;case"C":U=parseInt(C[b].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+I)}if(x&&(y[m][p]&&y[m][p].length==2?y[m][p][0]=E:y[m][p]=E,N=null),_){if(S)throw new Error("SYLK shared formula cannot have own formula");var H=T>-1&&y[T][U];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");y[m][p][1]=U8(H[1],{r:m-T,c:p-U})}break;case"F":var z=0;for(b=1;b<C.length;++b)switch(C[b].charAt(0)){case"X":p=parseInt(C[b].slice(1))-1,++z;break;case"Y":for(m=parseInt(C[b].slice(1))-1,V=y.length;V<=m;++V)y[V]=[];break;case"M":q=parseInt(C[b].slice(1))/20;break;case"F":break;case"G":break;case"P":N=k[parseInt(C[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=C[b].slice(1).split(" "),V=parseInt(B[0],10);V<=parseInt(B[1],10);++V)q=parseInt(B[2],10),R[V-1]=q===0?{hidden:!0}:{wch:q},Fu(R[V-1]);break;case"C":p=parseInt(C[b].slice(1))-1,R[p]||(R[p]={});break;case"R":m=parseInt(C[b].slice(1))-1,F[m]||(F[m]={}),q>0?(F[m].hpt=q,F[m].hpx=$h(q)):q===0&&(F[m].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+I)}z<1&&(N=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+I)}}return F.length>0&&(L["!rows"]=F),R.length>0&&(L["!cols"]=R),f&&f.sheetRows&&(y=y.slice(0,f.sheetRows)),[y,L]}function i(h,f){var g=s(h,f),m=g[0],p=g[1],v=Gu(m,f);return Ni(p).forEach(function(b){v[b]=p[b]}),v}function o(h,f){return El(i(h,f),f)}function l(h,f,g,m){var p="C;Y"+(g+1)+";X"+(m+1)+";K";switch(h.t){case"n":p+=h.v||0,h.f&&!h.F&&(p+=";E"+xM(h.f,{r:g,c:m}));break;case"b":p+=h.v?"TRUE":"FALSE";break;case"e":p+=h.w||h.v;break;case"d":p+='"'+(h.w||h.v)+'"';break;case"s":p+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return p}function c(h,f){f.forEach(function(g,m){var p="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?p+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Dp(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Rp(g.wpx)),typeof g.wch=="number"&&(p+=Math.round(g.wch))),p.charAt(p.length-1)!=" "&&h.push(p)})}function u(h,f){f.forEach(function(g,m){var p="F;";g.hidden?p+="M0;":g.hpt?p+="M"+20*g.hpt+";":g.hpx&&(p+="M"+20*I8(g.hpx)+";"),p.length>2&&h.push(p+"R"+(m+1))})}function d(h,f){var g=["ID;PWXL;N;E"],m=[],p=ln(h["!ref"]),v,b=Array.isArray(h),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&c(g,h["!cols"]),h["!rows"]&&u(g,h["!rows"]),g.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var k=p.s.r;k<=p.e.r;++k)for(var N=p.s.c;N<=p.e.c;++N){var L=cr({r:k,c:N});v=b?(h[k]||[])[N]:h[L],!(!v||v.v==null&&(!v.f||v.F))&&m.push(l(v,h,k,N))}return g.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),FP=function(){function t(a,i){switch(i.type){case"base64":return r(pa(a),i);case"binary":return r(a,i);case"buffer":return r(yr&&Buffer.isBuffer(a)?a.toString("binary"):dc(a),i);case"array":return r(oc(a),i)}throw new Error("Unrecognized type "+i.type)}function r(a,i){for(var o=a.split(`
`),l=-1,c=-1,u=0,d=[];u!==o.length;++u){if(o[u].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),f=h[0],g=h[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+f){case-1:if(m==="BOT"){d[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[l][c]=!0:m==="FALSE"?d[l][c]=!1:isNaN(oi(g))?isNaN(Mu(g).getDate())?d[l][c]=g:d[l][c]=Vn(g):d[l][c]=oi(g),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function e(a,i){return Gu(t(a,i),i)}function n(a,i){return El(e(a,i),i)}var s=function(){var a=function(l,c,u,d,h){l.push(c),l.push(u+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,c,u,d){l.push(c+","+u),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],u=ln(l["!ref"]),d,h=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var f=u.s.r;f<=u.e.r;++f){i(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var m=cr({r:f,c:g});if(d=h?(l[f]||[])[g]:l[m],!d){i(c,1,0,"");continue}switch(d.t){case"n":var p=d.w;!p&&d.v!=null&&(p=d.v),p==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,p,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=La(d.z||dr[14],Ms(Vn(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var v=`\r
`,b=c.join(v);return b}}();return{to_workbook:n,to_sheet:e,from_sheet:s}}(),jP=function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(d,h){for(var f=d.split(`
`),g=-1,m=-1,p=0,v=[];p!==f.length;++p){var b=f[p].trim().split(":");if(b[0]==="cell"){var y=Rs(b[1]);if(v.length<=y.r)for(g=v.length;g<=y.r;++g)v[g]||(v[g]=[]);switch(g=y.r,m=y.c,b[2]){case"t":v[g][m]=t(b[3]);break;case"v":v[g][m]=+b[3];break;case"vtf":var k=b[b.length-1];case"vtc":switch(b[3]){case"nl":v[g][m]=!!+b[4];break;default:v[g][m]=+b[4];break}b[2]=="vtf"&&(v[g][m]=[v[g][m],k])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(d,h){return Gu(e(d,h),h)}function s(d,h){return El(n(d,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],f=[],g,m="",p=Wu(d["!ref"]),v=Array.isArray(d),b=p.s.r;b<=p.e.r;++b)for(var y=p.s.c;y<=p.e.c;++y)if(m=cr({r:b,c:y}),g=v?(d[b]||[])[y]:d[m],!(!g||g.v==null||g.t==="z")){switch(f=["cell",m,"t"],g.t){case"s":case"str":f.push(r(g.v));break;case"n":g.f?(f[2]="vtf",f[3]="n",f[4]=g.v,f[5]=r(g.f)):(f[2]="v",f[3]=g.v);break;case"b":f[2]="vt"+(g.f?"f":"c"),f[3]="nl",f[4]=g.v?"1":"0",f[5]=r(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var k=Ms(Vn(g.v));f[2]="vtc",f[3]="nd",f[4]=""+k,f[5]=g.w||La(g.z||dr[14],k);break;case"e":continue}h.push(f.join(":"))}return h.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(d){return[a,i,o,i,c(d),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),Ih=function(){function t(u,d,h,f,g){g.raw?d[h][f]=u:u===""||(u==="TRUE"?d[h][f]=!0:u==="FALSE"?d[h][f]=!1:isNaN(oi(u))?isNaN(Mu(u).getDate())?d[h][f]=u:d[h][f]=Vn(u):d[h][f]=oi(u))}function r(u,d){var h=d||{},f=[];if(!u||u.length===0)return f;for(var g=u.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var p=10,v=0,b=0;b<=m;++b)v=g[b].indexOf(" "),v==-1?v=g[b].length:v++,p=Math.max(p,v);for(b=0;b<=m;++b){f[b]=[];var y=0;for(t(g[b].slice(0,p).trim(),f,b,y,h),y=1;y<=(g[b].length-p)/10+1;++y)t(g[b].slice(p+(y-1)*10,p+y*10).trim(),f,b,y,h)}return h.sheetRows&&(f=f.slice(0,h.sheetRows)),f}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var d={},h=!1,f=0,g=0;f<u.length;++f)(g=u.charCodeAt(f))==34?h=!h:!h&&g in e&&(d[g]=(d[g]||0)+1);g=[];for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&g.push([d[f],f]);if(!g.length){d=n;for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&g.push([d[f],f])}return g.sort(function(m,p){return m[0]-p[0]||n[m[1]]-n[p[1]]}),e[g.pop()[1]]||44}function a(u,d){var h=d||{},f="",g=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(f=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(f=u.charAt(4),u=u.slice(6)):f=s(u.slice(0,1024)):h&&h.FS?f=h.FS:f=s(u.slice(0,1024));var p=0,v=0,b=0,y=0,k=0,N=f.charCodeAt(0),L=!1,F=0,R=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var B=h.dateNF!=null?GN(h.dateNF):null;function q(){var V=u.slice(y,k),I={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)I.t="z";else if(h.raw)I.t="s",I.v=V;else if(V.trim().length===0)I.t="s",I.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(I.t="s",I.v=V.slice(2,-1).replace(/""/g,'"')):_M(V)?(I.t="n",I.f=V.slice(1)):(I.t="s",I.v=V);else if(V=="TRUE")I.t="b",I.v=!0;else if(V=="FALSE")I.t="b",I.v=!1;else if(!isNaN(b=oi(V)))I.t="n",h.cellText!==!1&&(I.w=V),I.v=b;else if(!isNaN(Mu(V).getDate())||B&&V.match(B)){I.z=h.dateNF||dr[14];var C=0;B&&V.match(B)&&(V=XN(V,h.dateNF,V.match(B)||[]),C=1),h.cellDates?(I.t="d",I.v=Vn(V,C)):(I.t="n",I.v=Ms(Vn(V,C))),h.cellText!==!1&&(I.w=La(I.z,I.v instanceof Date?Ms(I.v):I.v)),h.cellNF||delete I.z}else I.t="s",I.v=V;if(I.t=="z"||(h.dense?(g[p]||(g[p]=[]),g[p][v]=I):g[cr({c:v,r:p})]=I),y=k+1,R=u.charCodeAt(y),m.e.c<v&&(m.e.c=v),m.e.r<p&&(m.e.r=p),F==N)++v;else if(v=0,++p,h.sheetRows&&h.sheetRows<=p)return!0}e:for(;k<u.length;++k)switch(F=u.charCodeAt(k)){case 34:R===34&&(L=!L);break;case N:case 10:case 13:if(!L&&q())break e;break}return k-y>0&&q(),g["!ref"]=Sr(m),g}function i(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,d):Gu(r(u,d),d)}function o(u,d){var h="",f=d.type=="string"?[0,0,0,0]:qb(u,d);switch(d.type){case"base64":h=pa(u);break;case"binary":h=u;break;case"buffer":d.codepage==65001?h=u.toString("utf8"):(d.codepage,h=yr&&Buffer.isBuffer(u)?u.toString("binary"):dc(u));break;case"array":h=oc(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+d.type)}return f[0]==239&&f[1]==187&&f[2]==191?h=zr(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=zr(h):d.type=="binary",h.slice(0,19)=="socialcalc:version:"?jP.to_sheet(d.type=="string"?h:zr(h),d):i(h,d)}function l(u,d){return El(o(u,d),d)}function c(u){for(var d=[],h=ln(u["!ref"]),f,g=Array.isArray(u),m=h.s.r;m<=h.e.r;++m){for(var p=[],v=h.s.c;v<=h.e.c;++v){var b=cr({r:m,c:v});if(f=g?(u[m]||[])[v]:u[b],!f||f.v==null){p.push("          ");continue}for(var y=(f.w||(co(f),f.w)||"").slice(0,10);y.length<10;)y+=" ";p.push(y+(v===0?" ":""))}d.push(p.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function LP(t,r){var e=r||{},n=!!e.WTF;e.WTF=!0;try{var s=MP.to_workbook(t,e);return e.WTF=n,s}catch(a){if(e.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Ih.to_workbook(t,r)}}var ch=function(){function t(A,H,z){if(A){Yn(A,A.l||0);for(var K=z.Enum||T;A.l<A.length;){var j=A.read_shift(2),J=K[j]||K[65535],P=A.read_shift(2),D=A.l+P,G=J.f&&J.f(A,P,z);if(A.l=D,H(G,J,j))return}}}function r(A,H){switch(H.type){case"base64":return e(ri(pa(A)),H);case"binary":return e(ri(A),H);case"buffer":case"array":return e(A,H)}throw"Unsupported type "+H.type}function e(A,H){if(!A)return A;var z=H||{},K=z.dense?[]:{},j="Sheet1",J="",P=0,D={},G=[],re=[],te={s:{r:0,c:0},e:{r:0,c:0}},ne=z.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)z.Enum=T,t(A,function(Z,se,ie){switch(ie){case 0:z.vers=Z,Z>=4096&&(z.qpro=!0);break;case 6:te=Z;break;case 204:Z&&(J=Z);break;case 222:J=Z;break;case 15:case 51:z.qpro||(Z[1].v=Z[1].v.slice(1));case 13:case 14:case 16:ie==14&&(Z[2]&112)==112&&(Z[2]&15)>1&&(Z[2]&15)<15&&(Z[1].z=z.dateNF||dr[14],z.cellDates&&(Z[1].t="d",Z[1].v=gm(Z[1].v))),z.qpro&&Z[3]>P&&(K["!ref"]=Sr(te),D[j]=K,G.push(j),K=z.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},P=Z[3],j=J||"Sheet"+(P+1),J="");var ue=z.dense?(K[Z[0].r]||[])[Z[0].c]:K[cr(Z[0])];if(ue){ue.t=Z[1].t,ue.v=Z[1].v,Z[1].z!=null&&(ue.z=Z[1].z),Z[1].f!=null&&(ue.f=Z[1].f);break}z.dense?(K[Z[0].r]||(K[Z[0].r]=[]),K[Z[0].r][Z[0].c]=Z[1]):K[cr(Z[0])]=Z[1];break}},z);else if(A[2]==26||A[2]==14)z.Enum=U,A[2]==14&&(z.qpro=!0,A.l=0),t(A,function(Z,se,ie){switch(ie){case 204:j=Z;break;case 22:Z[1].v=Z[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Z[3]>P&&(K["!ref"]=Sr(te),D[j]=K,G.push(j),K=z.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},P=Z[3],j="Sheet"+(P+1)),ne>0&&Z[0].r>=ne)break;z.dense?(K[Z[0].r]||(K[Z[0].r]=[]),K[Z[0].r][Z[0].c]=Z[1]):K[cr(Z[0])]=Z[1],te.e.c<Z[0].c&&(te.e.c=Z[0].c),te.e.r<Z[0].r&&(te.e.r=Z[0].r);break;case 27:Z[14e3]&&(re[Z[14e3][0]]=Z[14e3][1]);break;case 1537:re[Z[0]]=Z[1],Z[0]==P&&(j=Z[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(K["!ref"]=Sr(te),D[J||j]=K,G.push(J||j),!re.length)return{SheetNames:G,Sheets:D};for(var le={},oe=[],ee=0;ee<re.length;++ee)D[G[ee]]?(oe.push(re[ee]||G[ee]),le[re[ee]]=D[re[ee]]||D[G[ee]]):(oe.push(re[ee]),le[re[ee]]={"!ref":"A1"});return{SheetNames:oe,Sheets:le}}function n(A,H){var z=H||{};if(+z.codepage>=0&&ni(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var K=j2(),j=ln(A["!ref"]),J=Array.isArray(A),P=[];Wa(K,0,a(1030)),Wa(K,6,l(j));for(var D=Math.min(j.e.r,8191),G=j.s.r;G<=D;++G)for(var re=es(G),te=j.s.c;te<=j.e.c;++te){G===j.s.r&&(P[te]=Mn(te));var ne=P[te]+re,le=J?(A[G]||[])[te]:A[ne];if(!(!le||le.t=="z"))if(le.t=="n")(le.v|0)==le.v&&le.v>=-32768&&le.v<=32767?Wa(K,13,f(G,te,le.v)):Wa(K,14,m(G,te,le.v));else{var oe=co(le);Wa(K,15,d(G,te,oe.slice(0,239)))}}return Wa(K,1),K.end()}function s(A,H){var z=H||{};if(+z.codepage>=0&&ni(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var K=j2();Wa(K,0,i(A));for(var j=0,J=0;j<A.SheetNames.length;++j)(A.Sheets[A.SheetNames[j]]||{})["!ref"]&&Wa(K,27,S(A.SheetNames[j],J++));var P=0;for(j=0;j<A.SheetNames.length;++j){var D=A.Sheets[A.SheetNames[j]];if(!(!D||!D["!ref"])){for(var G=ln(D["!ref"]),re=Array.isArray(D),te=[],ne=Math.min(G.e.r,8191),le=G.s.r;le<=ne;++le)for(var oe=es(le),ee=G.s.c;ee<=G.e.c;++ee){le===G.s.r&&(te[ee]=Mn(ee));var Z=te[ee]+oe,se=re?(D[le]||[])[ee]:D[Z];if(!(!se||se.t=="z"))if(se.t=="n")Wa(K,23,q(le,ee,P,se.v));else{var ie=co(se);Wa(K,22,F(le,ee,P,ie.slice(0,239)))}}++P}}return Wa(K,1),K.end()}function a(A){var H=Dn(2);return H.write_shift(2,A),H}function i(A){var H=Dn(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var z=0,K=0,j=0,J=0;J<A.SheetNames.length;++J){var P=A.SheetNames[J],D=A.Sheets[P];if(!(!D||!D["!ref"])){++j;var G=Wu(D["!ref"]);z<G.e.r&&(z=G.e.r),K<G.e.c&&(K=G.e.c)}}return z>8191&&(z=8191),H.write_shift(2,z),H.write_shift(1,j),H.write_shift(1,K),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(A,H,z){var K={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&z.qpro?(K.s.c=A.read_shift(1),A.l++,K.s.r=A.read_shift(2),K.e.c=A.read_shift(1),A.l++,K.e.r=A.read_shift(2),K):(K.s.c=A.read_shift(2),K.s.r=A.read_shift(2),H==12&&z.qpro&&(A.l+=2),K.e.c=A.read_shift(2),K.e.r=A.read_shift(2),H==12&&z.qpro&&(A.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function l(A){var H=Dn(8);return H.write_shift(2,A.s.c),H.write_shift(2,A.s.r),H.write_shift(2,A.e.c),H.write_shift(2,A.e.r),H}function c(A,H,z){var K=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(K[0].c=A.read_shift(1),K[3]=A.read_shift(1),K[0].r=A.read_shift(2),A.l+=2):(K[2]=A.read_shift(1),K[0].c=A.read_shift(2),K[0].r=A.read_shift(2)),K}function u(A,H,z){var K=A.l+H,j=c(A,H,z);if(j[1].t="s",z.vers==20768){A.l++;var J=A.read_shift(1);return j[1].v=A.read_shift(J,"utf8"),j}return z.qpro&&A.l++,j[1].v=A.read_shift(K-A.l,"cstr"),j}function d(A,H,z){var K=Dn(7+z.length);K.write_shift(1,255),K.write_shift(2,H),K.write_shift(2,A),K.write_shift(1,39);for(var j=0;j<K.length;++j){var J=z.charCodeAt(j);K.write_shift(1,J>=128?95:J)}return K.write_shift(1,0),K}function h(A,H,z){var K=c(A,H,z);return K[1].v=A.read_shift(2,"i"),K}function f(A,H,z){var K=Dn(7);return K.write_shift(1,255),K.write_shift(2,H),K.write_shift(2,A),K.write_shift(2,z,"i"),K}function g(A,H,z){var K=c(A,H,z);return K[1].v=A.read_shift(8,"f"),K}function m(A,H,z){var K=Dn(13);return K.write_shift(1,255),K.write_shift(2,H),K.write_shift(2,A),K.write_shift(8,z,"f"),K}function p(A,H,z){var K=A.l+H,j=c(A,H,z);if(j[1].v=A.read_shift(8,"f"),z.qpro)A.l=K;else{var J=A.read_shift(2);k(A.slice(A.l,A.l+J),j),A.l+=J}return j}function v(A,H,z){var K=H&32768;return H&=-32769,H=(K?A:0)+(H>=8192?H-16384:H),(K?"":"$")+(z?Mn(H):es(H))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(A,H){Yn(A,0);for(var z=[],K=0,j="",J="",P="",D="";A.l<A.length;){var G=A[A.l++];switch(G){case 0:z.push(A.read_shift(8,"f"));break;case 1:J=v(H[0].c,A.read_shift(2),!0),j=v(H[0].r,A.read_shift(2),!1),z.push(J+j);break;case 2:{var re=v(H[0].c,A.read_shift(2),!0),te=v(H[0].r,A.read_shift(2),!1);J=v(H[0].c,A.read_shift(2),!0),j=v(H[0].r,A.read_shift(2),!1),z.push(re+te+":"+J+j)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(A.read_shift(2));break;case 6:{for(var ne="";G=A[A.l++];)ne+=String.fromCharCode(G);z.push('"'+ne.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:D=z.pop(),P=z.pop(),z.push(["AND","OR"][G-20]+"("+P+","+D+")");break;default:if(G<32&&y[G])D=z.pop(),P=z.pop(),z.push(P+y[G]+D);else if(b[G]){if(K=b[G][1],K==69&&(K=A[A.l++]),K>z.length){console.error("WK1 bad formula parse 0x"+G.toString(16)+":|"+z.join("|")+"|");return}var le=z.slice(-K);z.length-=K,z.push(b[G][0]+"("+le.join(",")+")")}else return G<=7?console.error("WK1 invalid opcode "+G.toString(16)):G<=24?console.error("WK1 unsupported op "+G.toString(16)):G<=30?console.error("WK1 invalid opcode "+G.toString(16)):G<=115?console.error("WK1 unsupported function opcode "+G.toString(16)):console.error("WK1 unrecognized opcode "+G.toString(16))}}z.length==1?H[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function N(A){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=A.read_shift(2),H[3]=A[A.l++],H[0].c=A[A.l++],H}function L(A,H){var z=N(A);return z[1].t="s",z[1].v=A.read_shift(H-4,"cstr"),z}function F(A,H,z,K){var j=Dn(6+K.length);j.write_shift(2,A),j.write_shift(1,z),j.write_shift(1,H),j.write_shift(1,39);for(var J=0;J<K.length;++J){var P=K.charCodeAt(J);j.write_shift(1,P>=128?95:P)}return j.write_shift(1,0),j}function R(A,H){var z=N(A);z[1].v=A.read_shift(2);var K=z[1].v>>1;if(z[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return z[1].v=K,z}function B(A,H){var z=N(A),K=A.read_shift(4),j=A.read_shift(4),J=A.read_shift(2);if(J==65535)return K===0&&j===3221225472?(z[1].t="e",z[1].v=15):K===0&&j===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var P=J&32768;return J=(J&32767)-16446,z[1].v=(1-P*2)*(j*Math.pow(2,J+32)+K*Math.pow(2,J)),z}function q(A,H,z,K){var j=Dn(14);if(j.write_shift(2,A),j.write_shift(1,z),j.write_shift(1,H),K==0)return j.write_shift(4,0),j.write_shift(4,0),j.write_shift(2,65535),j;var J=0,P=0,D=0,G=0;return K<0&&(J=1,K=-K),P=Math.log2(K)|0,K/=Math.pow(2,P-31),G=K>>>0,G&2147483648||(K/=2,++P,G=K>>>0),K-=G,G|=2147483648,G>>>=0,K*=Math.pow(2,32),D=K>>>0,j.write_shift(4,D),j.write_shift(4,G),P+=16383+(J?32768:0),j.write_shift(2,P),j}function V(A,H){var z=B(A);return A.l+=H-14,z}function I(A,H){var z=N(A),K=A.read_shift(4);return z[1].v=K>>6,z}function C(A,H){var z=N(A),K=A.read_shift(8,"f");return z[1].v=K,z}function O(A,H){var z=C(A);return A.l+=H-10,z}function E(A,H){return A[A.l+H-1]==0?A.read_shift(H,"cstr"):""}function x(A,H){var z=A[A.l++];z>H-1&&(z=H-1);for(var K="";K.length<z;)K+=String.fromCharCode(A[A.l++]);return K}function w(A,H,z){if(!(!z.qpro||H<21)){var K=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var j=A.read_shift(H-21,"cstr");return[K,j]}}function _(A,H){for(var z={},K=A.l+H;A.l<K;){var j=A.read_shift(2);if(j==14e3){for(z[j]=[0,""],z[j][0]=A.read_shift(2);A[A.l];)z[j][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return z}function S(A,H){var z=Dn(5+A.length);z.write_shift(2,14e3),z.write_shift(2,H);for(var K=0;K<A.length;++K){var j=A.charCodeAt(K);z[z.l++]=j>127?95:j}return z[z.l++]=0,z}var T={0:{n:"BOF",f:En},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:p},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:E},222:{n:"SHEETNAMELP",f:x},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:_},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:C},40:{n:"FORMULA28",f:O},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:E},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:w},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:r}}();function IP(t){var r={},e=t.match(ws),n=0,s=!1;if(e)for(;n!=e.length;++n){var a=nr(e[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;r.cp=wb[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=a.val;break;case"<sz":r.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":a.rgb&&(r.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return r}var BP=function(){var t=jh("t"),r=jh("rPr");function e(a){var i=a.match(t);if(!i)return{t:"s",v:""};var o={t:"s",v:Cr(i[1])},l=a.match(r);return l&&(o.s=IP(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(e).filter(function(o){return o.v})}}(),$P=function(){var r=/(\r\n|\n)/g;function e(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&e(s.s,a[0],a[2]),a[0].join("")+a[1].replace(r,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),UP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,HP=/<(?:\w+:)?r>/,zP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ib(t,r){var e=r?r.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Cr(zr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=zr(t),e&&(n.h=Tb(n.t))):t.match(HP)&&(n.r=zr(t),n.t=Cr(zr((t.replace(zP,"").match(UP)||[]).join("").replace(ws,""))),e&&(n.h=$P(BP(n.r)))),n):{t:""}}var VP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,qP=/<(?:\w+:)?(?:si|sstItem)>/g,WP=/<\/(?:\w+:)?(?:si|sstItem)>/;function GP(t,r){var e=[],n="";if(!t)return e;var s=t.match(VP);if(s){n=s[2].replace(qP,"").split(WP);for(var a=0;a!=n.length;++a){var i=Ib(n[a].trim(),r);i!=null&&(e[e.length]=i)}s=nr(s[1]),e.Count=s.count,e.Unique=s.uniqueCount}return e}function XP(t){return[t.read_shift(4),t.read_shift(4)]}function KP(t,r){var e=[],n=!1;return go(t,function(a,i,o){switch(o){case 159:e.Count=a[0],e.Unique=a[1];break;case 19:e.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),e}function P8(t){for(var r=[],e=t.split(""),n=0;n<e.length;++n)r[n]=e[n].charCodeAt(0);return r}function no(t,r){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),r>=4&&(t.l+=r-4),e}function YP(t){var r={};return r.id=t.read_shift(0,"lpp4"),r.R=no(t,4),r.U=no(t,4),r.W=no(t,4),r}function JP(t){for(var r=t.read_shift(4),e=t.l+r-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return n}function ZP(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(JP(t));return r}function QP(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(t.read_shift(0,"lpp4"));return r}function eO(t){var r={};return t.read_shift(4),t.l+=4,r.id=t.read_shift(0,"lpp4"),r.name=t.read_shift(0,"lpp4"),r.R=no(t,4),r.U=no(t,4),r.W=no(t,4),r}function tO(t){var r=eO(t);if(r.ename=t.read_shift(0,"8lpp4"),r.blksz=t.read_shift(4),r.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function O8(t,r){var e=t.l+r,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,n}function M8(t,r){var e={},n=t.l+r;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,n),t.l=n,e}function rO(t){var r=no(t);switch(r.Minor){case 2:return[r.Minor,nO(t)];case 3:return[r.Minor,sO()];case 4:return[r.Minor,aO(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function nO(t){var r=t.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4),n=O8(t,e),s=M8(t,t.length-t.l);return{t:"Std",h:n,v:s}}function sO(){throw new Error("File is password-protected: ECMA-376 Extensible")}function aO(t){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),n={};return e.replace(ws,function(a){var i=nr(a);switch(Di(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function iO(t,r){var e={},n=e.EncryptionVersionInfo=no(t,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);e.Flags=t.read_shift(4),r-=4;var s=t.read_shift(4);return r-=4,e.EncryptionHeader=O8(t,s),r-=s,e.EncryptionVerifier=M8(t,r),e}function oO(t){var r={},e=r.EncryptionVersionInfo=no(t,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return r.Salt=t.read_shift(16),r.EncryptedVerifier=t.read_shift(16),r.EncryptedVerifierHash=t.read_shift(16),r}function lO(t){var r=0,e,n=P8(t),s=n.length+1,a,i,o,l,c;for(e=gl(s),e[0]=n.length,a=1;a!=s;++a)e[a]=n[a-1];for(a=s-1;a>=0;--a)i=e[a],o=r&16384?1:0,l=r<<1&32767,c=o|l,r=c^i;return r^52811}var F8=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=r[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],d=0;d!=7;++d)u&64&&(o^=e[l]),u*=2,--l;return o};return function(i){for(var o=P8(i),l=a(o),c=o.length,u=gl(16),d=0;d!=16;++d)u[d]=0;var h,f,g;for((c&1)===1&&(h=l>>8,u[c]=s(t[0],h),--c,h=l&255,f=o[o.length-1],u[c]=s(f,h));c>0;)--c,h=l>>8,u[c]=s(o[c],h),--c,h=l&255,u[c]=s(o[c],h);for(c=15,g=15-o.length;g>0;)h=l>>8,u[c]=s(t[g],h),--c,--g,h=l&255,u[c]=s(o[c],h),--c,--g;return u}}(),cO=function(t,r,e,n,s){s||(s=r),n||(n=F8(t));var a,i;for(a=0;a!=r.length;++a)i=r[a],i^=n[e],i=(i>>5|i<<3)&255,s[a]=i,++e;return[s,e,n]},uO=function(t){var r=0,e=F8(t);return function(n){var s=cO("",n,r,e);return r=s[1],s[0]}};function fO(t,r,e,n){var s={key:En(t),verificationBytes:En(t)};return e.password&&(s.verifier=lO(e.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=uO(e.password)),s}function hO(t,r,e){var n=e||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=oO(t):n.Data=iO(t,r),n}function dO(t,r,e){var n={Type:e.biff>=8?t.read_shift(2):0};return n.Type?hO(t,r-2,n):fO(t,e.biff>=8?r:r-2,e,n),n}var pO=function(){function t(s,a){switch(a.type){case"base64":return r(pa(s),a);case"binary":return r(s,a);case"buffer":return r(yr&&Buffer.isBuffer(s)?s.toString("binary"):dc(s),a);case"array":return r(oc(s),a)}throw new Error("Unrecognized type "+a.type)}function r(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,f=0,g,m=-1;g=h.exec(u);){switch(g[0]){case"\\cell":var p=u.slice(f,h.lastIndex-g[0].length);if(p[0]==" "&&(p=p.slice(1)),++m,p.length){var v={v:p,t:"s"};Array.isArray(o)?o[d][m]=v:o[cr({r:d,c:m})]=v}break}f=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Sr(c),o}function e(s,a){return El(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=ln(s["!ref"]),o,l=Array.isArray(s),c=i.s.r;c<=i.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var d=cr({r:c,c:u});o=l?(s[c]||[])[u]:s[d],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(co(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:n}}();function mO(t){var r=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Bh(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}function gO(t){var r=t[0]/255,e=t[1]/255,n=t[2]/255,s=Math.max(r,e,n),a=Math.min(r,e,n),i=s-a;if(i===0)return[0,0,r];var o=0,l=0,c=s+a;switch(l=i/(c>1?2-c:c),s){case r:o=((e-n)/i+6)%6;break;case e:o=(n-r)/i+2;break;case n:o=(r-e)/i+4;break}return[o/6,l,c/2]}function vO(t){var r=t[0],e=t[1],n=t[2],s=e*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*r,l;if(e!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function Np(t,r){if(r===0)return t;var e=gO(mO(t));return r<0?e[2]=e[2]*(1+r):e[2]=1-(1-e[2])*(1-r),Bh(vO(e))}var j8=6,bO=15,yO=1,Ds=j8;function Dp(t){return Math.floor((t+Math.round(128/Ds)/256)*Ds)}function Rp(t){return Math.floor((t-5)/Ds*100+.5)/100}function $2(t){return Math.round((t*Ds+5)/Ds*256)/256}function Y1(t){return $2(Rp(Dp(t)))}function Bb(t){var r=Math.abs(t-Y1(t)),e=Ds;if(r>.005)for(Ds=yO;Ds<bO;++Ds)Math.abs(t-Y1(t))<=r&&(r=Math.abs(t-Y1(t)),e=Ds);Ds=e}function Fu(t){t.width?(t.wpx=Dp(t.width),t.wch=Rp(t.wpx),t.MDW=Ds):t.wpx?(t.wch=Rp(t.wpx),t.width=$2(t.wch),t.MDW=Ds):typeof t.wch=="number"&&(t.width=$2(t.wch),t.wpx=Dp(t.width),t.MDW=Ds),t.customWidth&&delete t.customWidth}var xO=96,L8=xO;function I8(t){return t*96/L8}function $h(t){return t*L8/96}var wO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _O(t,r,e,n){r.Borders=[];var s={},a=!1;(t[0].match(ws)||[]).forEach(function(i){var o=nr(i);switch(Di(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Xr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Xr(o.diagonalDown)),r.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function SO(t,r,e,n){r.Fills=[];var s={},a=!1;(t[0].match(ws)||[]).forEach(function(i){var o=nr(i);switch(Di(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},r.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function kO(t,r,e,n){r.Fonts=[];var s={},a=!1;(t[0].match(ws)||[]).forEach(function(i){var o=nr(i);switch(Di(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=zr(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Xr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Xr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Xr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Xr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Xr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Xr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Xr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=wb[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Xr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Ql[s.color.index];s.color.index==81&&(l=Ql[1]),l||(l=Ql[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&e.themeElements&&e.themeElements.clrScheme&&(s.color.rgb=Np(e.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function EO(t,r,e){r.NumberFmt=[];for(var n=Ni(dr),s=0;s<n.length;++s)r.NumberFmt[n[s]]=dr[n[s]];var a=t[0].match(ws);if(a)for(s=0;s<a.length;++s){var i=nr(a[s]);switch(Di(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Cr(zr(i.formatCode)),l=parseInt(i.numFmtId,10);if(r.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&r.NumberFmt[l]!=null;--l);r.NumberFmt[l]=o}Zl(o,l)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var g0=["numFmtId","fillId","fontId","borderId","xfId"],v0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function AO(t,r,e){r.CellXf=[];var n,s=!1;(t[0].match(ws)||[]).forEach(function(a){var i=nr(a),o=0;switch(Di(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<g0.length;++o)n[g0[o]]&&(n[g0[o]]=parseInt(n[g0[o]],10));for(o=0;o<v0.length;++o)n[v0[o]]&&(n[v0[o]]=Xr(n[v0[o]]));if(r.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[o]){n.numFmtId=o;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Xr(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(e&&e.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var CO=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(r))&&EO(d,u,c),(d=o.match(s))&&kO(d,u,l,c),(d=o.match(n))&&SO(d,u,l,c),(d=o.match(a))&&_O(d,u,l,c),(d=o.match(e))&&AO(d,u,c),u}}();function TO(t,r){var e=t.read_shift(2),n=bs(t);return[e,n]}function NO(t,r,e){var n={};n.sz=t.read_shift(2)/20;var s=BD(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=t.read_shift(1);i!=0&&(n.underline=i);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=ID(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=bs(t),n}var DO=xs;function RO(t,r){var e=t.l+r,n=t.read_shift(2),s=t.read_shift(2);return t.l=e,{ixfe:n,numFmtId:s}}var PO=xs;function OO(t,r,e){var n={};n.NumberFmt=[];for(var s in dr)n.NumberFmt[s]=dr[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return go(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Zl(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(l.color.rgb=Np(r.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(u),i=!0;break;case 38:a.pop(),i=!1;break;default:if(c.T>0)a.push(u);else if(c.T<0)a.pop();else if(!i||e.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var MO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function FO(t,r,e){r.themeElements.clrScheme=[];var n={};(t[0].match(ws)||[]).forEach(function(s){var a=nr(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(r.themeElements.clrScheme[MO.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function jO(){}function LO(){}var IO=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,BO=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,$O=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function UO(t,r,e){r.themeElements={};var n;[["clrScheme",IO,FO],["fontScheme",BO,jO],["fmtScheme",$O,LO]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,r,e)})}var HO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function B8(t,r){(!t||t.length===0)&&(t=zO());var e,n={};if(!(e=t.match(HO)))throw new Error("themeElements not found in theme");return UO(e[0],n,r),n.raw=t,n}function zO(t,r){var e=[Y_];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function VO(t,r,e){var n=t.l+r,s=t.read_shift(4);if(s!==124226){if(!e.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var i;try{i=K_(a,{type:"array"})}catch{return}var o=la(i,"theme/theme/theme1.xml",!0);if(o)return B8(o,e)}}function qO(t){return t.read_shift(4)}function WO(t){var r={};switch(r.xclrType=t.read_shift(2),r.nTintShade=t.read_shift(2),r.xclrType){case 0:t.l+=4;break;case 1:r.xclrValue=GO(t,4);break;case 2:r.xclrValue=E8(t);break;case 3:r.xclrValue=qO(t);break;case 4:t.l+=4;break}return t.l+=8,r}function GO(t,r){return xs(t,r)}function XO(t,r){return xs(t,r)}function KO(t){var r=t.read_shift(2),e=t.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=WO(t);break;case 6:n[1]=XO(t,e);break;case 14:case 15:n[1]=t.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+e)}return n}function YO(t,r){var e=t.l+r;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(KO(t,e-t.l));return{ixfe:n,ext:a}}function JO(t,r){r.forEach(function(e){switch(e[0]){}})}function ZO(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:bs(t)}}function QO(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function eM(t){return t.l+=4,t.read_shift(4)!=0}function tM(t,r,e){var n={Types:[],Cell:[],Value:[]},s=e||{},a=[],i=!1,o=2;return go(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(u),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!c.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function rM(t,r,e){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,i;return t.replace(ws,function(o){var l=nr(o);switch(Di(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&e.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function nM(t){var r=[];if(!t)return r;var e=1;return(t.match(ws)||[]).forEach(function(n){var s=nr(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?e=s.i:s.i=e,r.push(s);break}}),r}function sM(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=cr(e);var n=t.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function aM(t,r,e){var n=[];return go(t,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function iM(t,r,e,n){if(!t)return t;var s=n||{},a=!1;go(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function oM(t,r){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][e].Target}function h5(t,r,e,n){var s=Array.isArray(t),a;r.forEach(function(i){var o=Rs(i.ref);if(s?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[i.ref],!a){a={t:"z"},s?t[o.r][o.c]=a:t[i.ref]=a;var l=ln(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Sr(l);c!==t["!ref"]&&(t["!ref"]=c)}a.c||(a.c=[]);var u={a:i.author,t:i.t,r:i.r,T:e};i.h&&(u.h=i.h);for(var d=a.c.length-1;d>=0;--d){if(!e&&a.c[d].T)return;e&&!a.c[d].T&&a.c.splice(d,1)}if(e&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}a.c.push(u)})}function lM(t,r){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&e.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=nr(o[0]),c={author:l.authorId&&e[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Rs(l.ref);if(!(r.sheetRows&&r.sheetRows<=u.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&Ib(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function cM(t,r){var e=[],n=!1,s={},a=0;return t.replace(ws,function(o,l){var c=nr(o);switch(Di(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&e.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=t.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),e}function uM(t,r){var e=[],n=!1;return t.replace(ws,function(a){var i=nr(a);switch(Di(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),e}function fM(t){var r={};r.iauthor=t.read_shift(4);var e=mc(t);return r.rfx=e.s,r.ref=cr(e.s),t.l+=16,r}var hM=bs;function dM(t,r){var e=[],n=[],s={},a=!1;return go(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,r.sheetRows&&s.rfx&&r.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,e.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),e}var pM="application/vnd.ms-office.vbaProject";function mM(t){var r=_r.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,n){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var s=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");_r.utils.cfb_add(r,s,t.FileIndex[n].content)}}),_r.write(r)}function gM(){return{"!type":"dialog"}}function vM(){return{"!type":"dialog"}}function bM(){return{"!type":"macro"}}function yM(){return{"!type":"macro"}}var bu=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=r.c:--u,l?c+=r.r:--c,s+(o?"":"$")+Mn(u)+(l?"":"$")+es(c)}return function(s,a){return r=a,s.replace(t,e)}}(),$8=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,xM=function(){return function(r,e){return r.replace($8,function(n,s,a,i,o,l){var c=Pb(i)-(a?0:e.c),u=Rb(l)-(o?0:e.r),d=u==0?"":o?u+1:"["+u+"]",h=c==0?"":a?c+1:"["+c+"]";return s+"R"+d+"C"+h})}}();function U8(t,r){return t.replace($8,function(e,n,s,a,i,o){return n+(s=="$"?s+a:Mn(Pb(a)+r.c))+(i=="$"?i+o:es(Rb(o)+r.r))})}function wM(t,r,e){var n=Wu(r),s=n.s,a=Rs(e),i={r:a.r-s.r,c:a.c-s.c};return U8(t,i)}function _M(t){return t.length!=1}function d5(t){return t.replace(/_xlfn\./g,"")}function Sn(t){t.l+=1}function vl(t,r){var e=t.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function H8(t,r,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return z8(t);e.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),i=vl(t),o=vl(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function z8(t){var r=vl(t),e=vl(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:e[0],c:s,cRel:e[1],rRel:e[2]}}}function SM(t,r,e){if(e.biff<8)return z8(t);var n=t.read_shift(e.biff==12?4:2),s=t.read_shift(e.biff==12?4:2),a=vl(t),i=vl(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function V8(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return kM(t);var n=t.read_shift(e&&e.biff==12?4:2),s=vl(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function kM(t){var r=vl(t),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function EM(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function AM(t,r,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return CM(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function CM(t){var r=t.read_shift(2),e=t.read_shift(1),n=(r&32768)>>15,s=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),s==1&&e>=128&&(e=e-256),{r,c:e,cRel:s,rRel:n}}function TM(t,r,e){var n=(t[t.l++]&96)>>5,s=H8(t,e.biff>=2&&e.biff<=5?6:8,e);return[n,s]}function NM(t,r,e){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(e)switch(e.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var i=H8(t,a,e);return[n,s,i]}function DM(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function RM(t,r,e){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(e)switch(e.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function PM(t,r,e){var n=(t[t.l++]&96)>>5,s=SM(t,r-1,e);return[n,s]}function OM(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[n]}function p5(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function MM(t,r,e){t.l+=2;for(var n=t.read_shift(e&&e.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(e&&e.biff==2?1:2));return s}function FM(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function jM(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function LM(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function IM(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[n]}function q8(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function BM(t){return t.read_shift(2),q8(t)}function $M(t){return t.read_shift(2),q8(t)}function UM(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=V8(t,0,e);return[n,s]}function HM(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=AM(t,0,e);return[n,s]}function zM(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var a=V8(t,0,e);return[n,s,a]}function VM(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(e&&e.biff<=3?1:2);return[qF[s],X8[s],n]}function qM(t,r,e){var n=t[t.l++],s=t.read_shift(1),a=e&&e.biff<=3?[n==88?-1:0,t.read_shift(1)]:WM(t);return[s,(a[0]===0?X8:VF)[a[1]]]}function WM(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function GM(t,r,e){t.l+=e&&e.biff==2?3:4}function XM(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(e&&e.biff==2?1:2);return[n,s]}function KM(t){return t.l++,gc[t.read_shift(1)]}function YM(t){return t.l++,t.read_shift(2)}function JM(t){return t.l++,t.read_shift(1)!==0}function ZM(t){return t.l++,ms(t)}function QM(t,r,e){return t.l++,rd(t,r-1,e)}function eF(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=dn(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=gc[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=ms(t);break;case 2:e[1]=vc(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function tF(t,r,e){for(var n=t.read_shift(e.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((e.biff==12?mc:vm)(t));return s}function rF(t,r,e){var n=0,s=0;e.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=eF(t,e.biff);return i}function nF(t,r,e){var n=t.read_shift(1)>>>5&3,s=!e||e.biff>=8?4:2,a=t.read_shift(s);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function sF(t,r,e){if(e.biff==5)return aF(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function aF(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[r,e,n]}function iF(t,r,e){var n=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var s=t.read_shift(e&&e.biff==2?1:2);return[n,s]}function oF(t,r,e){var n=t.read_shift(1)>>>5&3,s=t.read_shift(e&&e.biff==2?1:2);return[n,s]}function lF(t,r,e){var n=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[n]}function cF(t,r,e){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(e)switch(e.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var uF=xs,fF=xs,hF=xs;function sd(t,r,e){return t.l+=2,[EM(t)]}function $b(t){return t.l+=6,[]}var dF=sd,pF=$b,mF=$b,gF=sd;function W8(t){return t.l+=2,[En(t),t.read_shift(2)&1]}var vF=sd,bF=W8,yF=$b,xF=sd,wF=sd,_F=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function SF(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),i=_F[e>>2&31];return{ixti:r,coltype:e&3,rt:i,idx:n,c:s,C:a}}function kF(t){return t.l+=2,[t.read_shift(4)]}function EF(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function AF(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function CF(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function TF(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function NF(t){return t.l+=4,[0,0]}var m5={1:{n:"PtgExp",f:XM},2:{n:"PtgTbl",f:hF},3:{n:"PtgAdd",f:Sn},4:{n:"PtgSub",f:Sn},5:{n:"PtgMul",f:Sn},6:{n:"PtgDiv",f:Sn},7:{n:"PtgPower",f:Sn},8:{n:"PtgConcat",f:Sn},9:{n:"PtgLt",f:Sn},10:{n:"PtgLe",f:Sn},11:{n:"PtgEq",f:Sn},12:{n:"PtgGe",f:Sn},13:{n:"PtgGt",f:Sn},14:{n:"PtgNe",f:Sn},15:{n:"PtgIsect",f:Sn},16:{n:"PtgUnion",f:Sn},17:{n:"PtgRange",f:Sn},18:{n:"PtgUplus",f:Sn},19:{n:"PtgUminus",f:Sn},20:{n:"PtgPercent",f:Sn},21:{n:"PtgParen",f:Sn},22:{n:"PtgMissArg",f:Sn},23:{n:"PtgStr",f:QM},26:{n:"PtgSheet",f:EF},27:{n:"PtgEndSheet",f:AF},28:{n:"PtgErr",f:KM},29:{n:"PtgBool",f:JM},30:{n:"PtgInt",f:YM},31:{n:"PtgNum",f:ZM},32:{n:"PtgArray",f:OM},33:{n:"PtgFunc",f:VM},34:{n:"PtgFuncVar",f:qM},35:{n:"PtgName",f:nF},36:{n:"PtgRef",f:UM},37:{n:"PtgArea",f:TM},38:{n:"PtgMemArea",f:iF},39:{n:"PtgMemErr",f:uF},40:{n:"PtgMemNoMem",f:fF},41:{n:"PtgMemFunc",f:oF},42:{n:"PtgRefErr",f:lF},43:{n:"PtgAreaErr",f:DM},44:{n:"PtgRefN",f:HM},45:{n:"PtgAreaN",f:PM},46:{n:"PtgMemAreaN",f:CF},47:{n:"PtgMemNoMemN",f:TF},57:{n:"PtgNameX",f:sF},58:{n:"PtgRef3d",f:zM},59:{n:"PtgArea3d",f:NM},60:{n:"PtgRefErr3d",f:cF},61:{n:"PtgAreaErr3d",f:RM},255:{}},DF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},RF={1:{n:"PtgElfLel",f:W8},2:{n:"PtgElfRw",f:xF},3:{n:"PtgElfCol",f:dF},6:{n:"PtgElfRwV",f:wF},7:{n:"PtgElfColV",f:gF},10:{n:"PtgElfRadical",f:vF},11:{n:"PtgElfRadicalS",f:yF},13:{n:"PtgElfColS",f:pF},15:{n:"PtgElfColSV",f:mF},16:{n:"PtgElfRadicalLel",f:bF},25:{n:"PtgList",f:SF},29:{n:"PtgSxName",f:kF},255:{}},PF={0:{n:"PtgAttrNoop",f:NF},1:{n:"PtgAttrSemi",f:IM},2:{n:"PtgAttrIf",f:jM},4:{n:"PtgAttrChoose",f:MM},8:{n:"PtgAttrGoto",f:FM},16:{n:"PtgAttrSum",f:GM},32:{n:"PtgAttrBaxcel",f:p5},33:{n:"PtgAttrBaxcel",f:p5},64:{n:"PtgAttrSpace",f:BM},65:{n:"PtgAttrSpaceSemi",f:$M},128:{n:"PtgAttrIfError",f:LM},255:{}};function ad(t,r,e,n){if(n.biff<8)return xs(t,r);for(var s=t.l+r,a=[],i=0;i!==e.length;++i)switch(e[i][0]){case"PtgArray":e[i][1]=rF(t,0,n),a.push(e[i][1]);break;case"PtgMemArea":e[i][2]=tF(t,e[i][1],n),a.push(e[i][2]);break;case"PtgExp":n&&n.biff==12&&(e[i][1][1]=t.read_shift(4),a.push(e[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[i][0]}return r=s-t.l,r!==0&&a.push(xs(t,r)),a}function id(t,r,e){for(var n=t.l+r,s,a,i=[];n!=t.l;)r=n-t.l,a=t[t.l],s=m5[a]||m5[DF[a]],(a===24||a===25)&&(s=(a===24?RF:PF)[t[t.l+1]]),!s||!s.f?xs(t,r):i.push([s.n,s.f(t,r,e)]);return i}function OF(t){for(var r=[],e=0;e<t.length;++e){for(var n=t[e],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}r.push(s.join(","))}return r.join(";")}var MF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function FF(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function G8(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!n)return"SH33TJSERR1";var s="";if(e.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function g5(t,r,e){var n=G8(t,r,e);return n=="#REF"?n:FF(n,e)}function ds(t,r,e,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,c,u,d=0,h=0,f,g="";if(!t[0]||!t[0][0])return"";for(var m=-1,p="",v=0,b=t[0].length;v<b;++v){var y=t[0][v];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(t[0][m][1][0]){case 0:p=an(" ",t[0][m][1][1]);break;case 1:p=an("\r",t[0][m][1][1]);break;default:if(p="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}c=c+p,m=-1}o.push(c+MF[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=ah(y[1][1],i,s),o.push(ih(u,a));break;case"PtgRefN":u=e?ah(y[1][1],e,s):y[1][1],o.push(ih(u,a));break;case"PtgRef3d":d=y[1][1],u=ah(y[1][2],i,s),g=g5(n,d,s),o.push(g+"!"+ih(u,a));break;case"PtgFunc":case"PtgFuncVar":var k=y[1][0],N=y[1][1];k||(k=0),k&=127;var L=k==0?[]:o.slice(-k);o.length-=k,N==="User"&&(N=L.shift()),o.push(N+"("+L.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":f=Yw(y[1][1],e?{s:e}:i,s),o.push(X1(f,s));break;case"PtgArea":f=Yw(y[1][1],i,s),o.push(X1(f,s));break;case"PtgArea3d":d=y[1][1],f=y[1][2],g=g5(n,d,s),o.push(g+"!"+X1(f,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var F=(n.names||[])[h-1]||(n[0]||[])[h],R=F?F.Name:"SH33TJSNAME"+String(h);R&&R.slice(0,6)=="_xlfn."&&!s.xlfn&&(R=R.slice(6)),o.push(R);break;case"PtgNameX":var B=y[1][1];h=y[1][2];var q;if(s.biff<=5)B<0&&(B=-B),n[B]&&(q=n[B][h]);else{var V="";if(((n[B]||[])[0]||[])[0]==14849||(((n[B]||[])[0]||[])[0]==1025?n[B][h]&&n[B][h].itab>0&&(V=n.SheetNames[n[B][h].itab-1]+"!"):V=n.SheetNames[h-1]+"!"),n[B]&&n[B][h])V+=n[B][h].Name;else if(n[0]&&n[0][h])V+=n[0][h].Name;else{var I=(G8(n,B,s)||"").split(";;");I[h-1]?V=I[h-1]:V+="SH33TJSERRX"}o.push(V);break}q||(q={Name:"SH33TJSERRY"}),o.push(q.Name);break;case"PtgParen":var C="(",O=")";if(m>=0){switch(p="",t[0][m][1][0]){case 2:C=an(" ",t[0][m][1][1])+C;break;case 3:C=an("\r",t[0][m][1][1])+C;break;case 4:O=an(" ",t[0][m][1][1])+O;break;case 5:O=an("\r",t[0][m][1][1])+O;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}o.push(C+o.pop()+O);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var E={c:e.c,r:e.r};if(n.sharedf[cr(u)]){var x=n.sharedf[cr(u)];o.push(ds(x,i,E,n,s))}else{var w=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(ds(c[1],i,E,n,s)),w=!0;break}w||o.push(y[1])}break;case"PtgArray":o.push("{"+OF(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var _=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&_.indexOf(t[0][v][0])==-1){y=t[0][m];var S=!0;switch(y[1][0]){case 4:S=!1;case 0:p=an(" ",y[1][1]);break;case 5:S=!1;case 1:p=an("\r",y[1][1]);break;default:if(p="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((S?p:"")+o.pop()+(S?"":p)),m=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function jF(t,r,e){var n=t.l+r,s=e.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],xs(t,r-2)];var o=id(t,i,e);return r!==i+s&&(a=ad(t,r-i-s,o,e)),t.l=n,[o,a]}function LF(t,r,e){var n=t.l+r,s=e.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],xs(t,r-2)];var o=id(t,i,e);return r!==i+s&&(a=ad(t,r-i-s,o,e)),t.l=n,[o,a]}function IF(t,r,e,n){var s=t.l+r,a=id(t,n,e),i;return s!==t.l&&(i=ad(t,s-t.l,a,e)),[a,i]}function BF(t,r,e){var n=t.l+r,s,a=t.read_shift(2),i=id(t,a,e);return a==65535?[[],xs(t,r-2)]:(r!==a+2&&(s=ad(t,n-a-2,i,e)),[i,s])}function $F(t){var r;if(Qi(t,t.l+6)!==65535)return[ms(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return r=t[t.l+2]===1,t.l+=8,[r,"b"];case 2:return r=t[t.l+2],t.l+=8,[r,"e"];case 3:return t.l+=8,["","s"]}return[]}function J1(t,r,e){var n=t.l+r,s=Ri(t);e.biff==2&&++t.l;var a=$F(t),i=t.read_shift(1);e.biff!=2&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var o=LF(t,n-t.l,e);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function bm(t,r,e){var n=t.read_shift(4),s=id(t,n,e),a=t.read_shift(4),i=a>0?ad(t,a,s,e):null;return[s,i]}var UF=bm,ym=bm,HF=bm,zF=bm,VF={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},X8={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qF={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function v5(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,e){return e.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Z1(t){var r=t.split(":"),e=r[0].split(".")[0];return[e,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var uh={},yu={};function fh(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function K8(t,r,e,n,s,a){try{n.cellNF&&(t.z=dr[r])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Vn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(dr[r]==null&&Zl(WN[r]||"General",r),t.t==="e")t.w=t.w||gc[t.v];else if(r===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Fh(t.v);else if(t.t==="d"){var i=Ms(t.v);(i|0)===i?t.w=i.toString(10):t.w=Fh(i)}else{if(t.v===void 0)return"";t.w=ic(t.v,yu)}else t.t==="d"?t.w=La(r,Ms(t.v),yu):t.w=La(r,t.v,yu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&e!=null)try{t.s=a.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Np(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Np(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function WF(t,r){var e=ln(r);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=Sr(e))}var GF=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,XF=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,KF=/<(?:\w:)?hyperlink [^>]*>/mg,YF=/"(\w*:\w*)"/,JF=/<(?:\w:)?col\b[^>]*[\/]?>/g,ZF=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,QF=/<(?:\w:)?pageMargins[^>]*\/>/g,Y8=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ej=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,tj=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function rj(t,r,e,n,s,a,i){if(!t)return t;n||(n={"!id":{}});var o=r.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=t.match(XF);d?(c=t.slice(0,d.index),u=t.slice(d.index+d[0].length)):c=u=t;var h=c.match(Y8);h?Ub(h[0],o,s,e):(h=c.match(ej))&&nj(h[0],h[1]||"",o,s,e);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var g=c.slice(f,f+50).match(YF);g&&WF(o,g[1])}var m=c.match(tj);m&&m[1]&&cj(m[1],s);var p=[];if(r.cellStyles){var v=c.match(JF);v&&ij(p,v)}d&&uj(d[1],o,r,l,a,i);var b=u.match(ZF);b&&(o["!autofilter"]=oj(b[0]));var y=[],k=u.match(GF);if(k)for(f=0;f!=k.length;++f)y[f]=ln(k[f].slice(k[f].indexOf('"')+1));var N=u.match(KF);N&&sj(o,N,n);var L=u.match(QF);if(L&&(o["!margins"]=aj(nr(L[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Sr(l)),r.sheetRows>0&&o["!ref"]){var F=ln(o["!ref"]);r.sheetRows<=+F.e.r&&(F.e.r=r.sheetRows-1,F.e.r>l.e.r&&(F.e.r=l.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>l.e.c&&(F.e.c=l.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Sr(F))}return p.length>0&&(o["!cols"]=p),y.length>0&&(o["!merges"]=y),o}function Ub(t,r,e,n){var s=nr(t);e.Sheets[n]||(e.Sheets[n]={}),s.codeName&&(e.Sheets[n].CodeName=Cr(zr(s.codeName)))}function nj(t,r,e,n,s){Ub(t.slice(0,t.indexOf(">")),e,n,s)}function sj(t,r,e){for(var n=Array.isArray(t),s=0;s!=r.length;++s){var a=nr(zr(r[s]),!0);if(!a.ref)return;var i=((e||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Cr(a.location))):(a.Target="#"+Cr(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=ln(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=cr({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=a):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=a)}}}function aj(t){var r={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(r[e]=parseFloat(t[e]))}),r}function ij(t,r){for(var e=!1,n=0;n!=r.length;++n){var s=nr(r[n],!0);s.hidden&&(s.hidden=Xr(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!e&&s.width&&(e=!0,Bb(s.width)),Fu(s);a<=i;)t[a++]=Qn(s)}}function oj(t){var r={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return r}var lj=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function cj(t,r){r.Views||(r.Views=[{}]),(t.match(lj)||[]).forEach(function(e,n){var s=nr(e);r.Views[n]||(r.Views[n]={}),+s.zoomScale&&(r.Views[n].zoom=+s.zoomScale),Xr(s.rightToLeft)&&(r.Views[n].RTL=!0)})}var uj=function(){var t=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=jh("v"),i=jh("f");return function(l,c,u,d,h,f){for(var g=0,m="",p=[],v=[],b=0,y=0,k=0,N="",L,F,R=0,B=0,q,V,I=0,C=0,O=Array.isArray(f.CellXf),E,x=[],w=[],_=Array.isArray(c),S=[],T={},U=!1,A=!!u.sheetStubs,H=l.split(r),z=0,K=H.length;z!=K;++z){m=H[z].trim();var j=m.length;if(j!==0){var J=0;e:for(g=0;g<j;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(F=nr(m.slice(J,g),!0),R=F.r!=null?parseInt(F.r,10):R+1,B=-1,u.sheetRows&&u.sheetRows<R)continue;T={},U=!1,F.ht&&(U=!0,T.hpt=parseFloat(F.ht),T.hpx=$h(T.hpt)),F.hidden=="1"&&(U=!0,T.hidden=!0),F.outlineLevel!=null&&(U=!0,T.level=+F.outlineLevel),U&&(S[R-1]=T)}break;case"<":J=g;break}if(J>=g)break;if(F=nr(m.slice(J,g),!0),R=F.r!=null?parseInt(F.r,10):R+1,B=-1,!(u.sheetRows&&u.sheetRows<R)){d.s.r>R-1&&(d.s.r=R-1),d.e.r<R-1&&(d.e.r=R-1),u&&u.cellStyles&&(T={},U=!1,F.ht&&(U=!0,T.hpt=parseFloat(F.ht),T.hpx=$h(T.hpt)),F.hidden=="1"&&(U=!0,T.hidden=!0),F.outlineLevel!=null&&(U=!0,T.level=+F.outlineLevel),U&&(S[R-1]=T)),p=m.slice(g).split(t);for(var P=0;P!=p.length&&p[P].trim().charAt(0)=="<";++P);for(p=p.slice(P),g=0;g!=p.length;++g)if(m=p[g].trim(),m.length!==0){if(v=m.match(e),b=g,y=0,k=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,v!=null&&v.length===2){for(b=0,N=v[1],y=0;y!=N.length&&!((k=N.charCodeAt(y)-64)<1||k>26);++y)b=26*b+k;--b,B=b}else++B;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,F=nr(m.slice(0,y),!0),F.r||(F.r=cr({r:R-1,c:B})),N=m.slice(y),L={t:""},(v=N.match(a))!=null&&v[1]!==""&&(L.v=Cr(v[1])),u.cellFormula){if((v=N.match(i))!=null&&v[1]!==""){if(L.f=Cr(zr(v[1])).replace(/\r\n/g,`
`),u.xlfn||(L.f=d5(L.f)),v[0].indexOf('t="array"')>-1)L.F=(N.match(s)||[])[1],L.F.indexOf(":")>-1&&x.push([ln(L.F),L.F]);else if(v[0].indexOf('t="shared"')>-1){V=nr(v[0]);var D=Cr(zr(v[1]));u.xlfn||(D=d5(D)),w[parseInt(V.si,10)]=[V,D,F.r]}}else(v=N.match(/<f[^>]*\/>/))&&(V=nr(v[0]),w[V.si]&&(L.f=wM(w[V.si][1],w[V.si][2],F.r)));var G=Rs(F.r);for(y=0;y<x.length;++y)G.r>=x[y][0].s.r&&G.r<=x[y][0].e.r&&G.c>=x[y][0].s.c&&G.c<=x[y][0].e.c&&(L.F=x[y][1])}if(F.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(A)L.t="z";else continue;else L.t=F.t||"n";switch(d.s.c>B&&(d.s.c=B),d.e.c<B&&(d.e.c=B),L.t){case"n":if(L.v==""||L.v==null){if(!A)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!A)continue;L.t="z"}else q=uh[parseInt(L.v,10)],L.v=q.t,L.r=q.r,u.cellHTML&&(L.h=q.h);break;case"str":L.t="s",L.v=L.v!=null?zr(L.v):"",u.cellHTML&&(L.h=Tb(L.v));break;case"inlineStr":v=N.match(n),L.t="s",v!=null&&(q=Ib(v[1]))?(L.v=q.t,u.cellHTML&&(L.h=q.h)):L.v="";break;case"b":L.v=Xr(L.v);break;case"d":u.cellDates?L.v=Vn(L.v,1):(L.v=Ms(Vn(L.v,1)),L.t="n");break;case"e":(!u||u.cellText!==!1)&&(L.w=L.v),L.v=v8[L.v];break}if(I=C=0,E=null,O&&F.s!==void 0&&(E=f.CellXf[F.s],E!=null&&(E.numFmtId!=null&&(I=E.numFmtId),u.cellStyles&&E.fillId!=null&&(C=E.fillId))),K8(L,I,C,u,h,f),u.cellDates&&O&&L.t=="n"&&qu(dr[I])&&(L.t="d",L.v=gm(L.v)),F.cm&&u.xlmeta){var re=(u.xlmeta.Cell||[])[+F.cm-1];re&&re.type=="XLDAPR"&&(L.D=!0)}if(_){var te=Rs(F.r);c[te.r]||(c[te.r]=[]),c[te.r][te.c]=L}else c[F.r]=L}}}}S.length>0&&(c["!rows"]=S)}}();function fj(t,r){var e={},n=t.l+r;e.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(e.level=a&7),a&16&&(e.hidden=!0),a&32&&(e.hpt=s/20),e}var hj=mc;function dj(){}function pj(t,r){var e={},n=t[t.l];return++t.l,e.above=!(n&64),e.left=!(n&128),t.l+=18,e.name=jD(t),e}function mj(t){var r=Ia(t);return[r]}function gj(t){var r=pc(t);return[r]}function vj(t){var r=Ia(t),e=t.read_shift(1);return[r,e,"b"]}function bj(t){var r=pc(t),e=t.read_shift(1);return[r,e,"b"]}function yj(t){var r=Ia(t),e=t.read_shift(1);return[r,e,"e"]}function xj(t){var r=pc(t),e=t.read_shift(1);return[r,e,"e"]}function wj(t){var r=Ia(t),e=t.read_shift(4);return[r,e,"s"]}function _j(t){var r=pc(t),e=t.read_shift(4);return[r,e,"s"]}function Sj(t){var r=Ia(t),e=ms(t);return[r,e,"n"]}function J8(t){var r=pc(t),e=ms(t);return[r,e,"n"]}function kj(t){var r=Ia(t),e=Fb(t);return[r,e,"n"]}function Ej(t){var r=pc(t),e=Fb(t);return[r,e,"n"]}function Aj(t){var r=Ia(t),e=Ob(t);return[r,e,"is"]}function Cj(t){var r=Ia(t),e=bs(t);return[r,e,"str"]}function Tj(t){var r=pc(t),e=bs(t);return[r,e,"str"]}function Nj(t,r,e){var n=t.l+r,s=Ia(t);s.r=e["!row"];var a=t.read_shift(1),i=[s,a,"b"];if(e.cellFormula){t.l+=2;var o=ym(t,n-t.l,e);i[3]=ds(o,null,s,e.supbooks,e)}else t.l=n;return i}function Dj(t,r,e){var n=t.l+r,s=Ia(t);s.r=e["!row"];var a=t.read_shift(1),i=[s,a,"e"];if(e.cellFormula){t.l+=2;var o=ym(t,n-t.l,e);i[3]=ds(o,null,s,e.supbooks,e)}else t.l=n;return i}function Rj(t,r,e){var n=t.l+r,s=Ia(t);s.r=e["!row"];var a=ms(t),i=[s,a,"n"];if(e.cellFormula){t.l+=2;var o=ym(t,n-t.l,e);i[3]=ds(o,null,s,e.supbooks,e)}else t.l=n;return i}function Pj(t,r,e){var n=t.l+r,s=Ia(t);s.r=e["!row"];var a=bs(t),i=[s,a,"str"];if(e.cellFormula){t.l+=2;var o=ym(t,n-t.l,e);i[3]=ds(o,null,s,e.supbooks,e)}else t.l=n;return i}var Oj=mc;function Mj(t,r){var e=t.l+r,n=mc(t),s=Mb(t),a=bs(t),i=bs(t),o=bs(t);t.l=e;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function Fj(){}function jj(t,r,e){var n=t.l+r,s=p8(t),a=t.read_shift(1),i=[s];if(i[2]=a,e.cellFormula){var o=UF(t,n-t.l,e);i[1]=o}else t.l=n;return i}function Lj(t,r,e){var n=t.l+r,s=mc(t),a=[s];if(e.cellFormula){var i=zF(t,n-t.l,e);a[1]=i,t.l=n}else t.l=n;return a}var Ij=["left","right","top","bottom","header","footer"];function Bj(t){var r={};return Ij.forEach(function(e){r[e]=ms(t)}),r}function $j(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function Uj(){}function Hj(){}function zj(t,r,e,n,s,a,i){if(!t)return t;var o=r||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,f,g,m,p,v,b,y,k,N,L=[];o.biff=12,o["!row"]=0;var F=0,R=!1,B=[],q={},V=o.supbooks||s.supbooks||[[]];if(V.sharedf=q,V.arrayf=B,V.SheetNames=s.SheetNames||s.Sheets.map(function(_){return _.name}),!o.supbooks&&(o.supbooks=V,s.Names))for(var I=0;I<s.Names.length;++I)V[0][I+1]=s.Names[I];var C=[],O=[],E=!1;Pp[16]={n:"BrtShortReal",f:J8};var x;if(go(t,function(S,T,U){if(!h)switch(U){case 148:c=S;break;case 0:f=S,o.sheetRows&&o.sheetRows<=f.r&&(h=!0),k=es(p=f.r),o["!row"]=f.r,(S.hidden||S.hpt||S.level!=null)&&(S.hpt&&(S.hpx=$h(S.hpt)),O[S.r]=S);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:S[2]},S[2]){case"n":g.v=S[1];break;case"s":y=uh[S[1]],g.v=y.t,g.r=y.r;break;case"b":g.v=!!S[1];break;case"e":g.v=S[1],o.cellText!==!1&&(g.w=gc[g.v]);break;case"str":g.t="s",g.v=S[1];break;case"is":g.t="s",g.v=S[1].t;break}if((m=i.CellXf[S[0].iStyleRef])&&K8(g,m.numFmtId,null,o,a,i),v=S[0].c==-1?v+1:S[0].c,o.dense?(l[p]||(l[p]=[]),l[p][v]=g):l[Mn(v)+k]=g,o.cellFormula){for(R=!1,F=0;F<B.length;++F){var A=B[F];f.r>=A[0].s.r&&f.r<=A[0].e.r&&v>=A[0].s.c&&v<=A[0].e.c&&(g.F=Sr(A[0]),R=!0)}!R&&S.length>3&&(g.f=S[3])}if(u.s.r>f.r&&(u.s.r=f.r),u.s.c>v&&(u.s.c=v),u.e.r<f.r&&(u.e.r=f.r),u.e.c<v&&(u.e.c=v),o.cellDates&&m&&g.t=="n"&&qu(dr[m.numFmtId])){var H=Kl(g.v);H&&(g.t="d",g.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}x&&(x.type=="XLDAPR"&&(g.D=!0),x=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;g={t:"z",v:void 0},v=S[0].c==-1?v+1:S[0].c,o.dense?(l[p]||(l[p]=[]),l[p][v]=g):l[Mn(v)+k]=g,u.s.r>f.r&&(u.s.r=f.r),u.s.c>v&&(u.s.c=v),u.e.r<f.r&&(u.e.r=f.r),u.e.c<v&&(u.e.c=v),x&&(x.type=="XLDAPR"&&(g.D=!0),x=void 0);break;case 176:L.push(S);break;case 49:x=((o.xlmeta||{}).Cell||[])[S-1];break;case 494:var z=n["!id"][S.relId];for(z?(S.Target=z.Target,S.loc&&(S.Target+="#"+S.loc),S.Rel=z):S.relId==""&&(S.Target="#"+S.loc),p=S.rfx.s.r;p<=S.rfx.e.r;++p)for(v=S.rfx.s.c;v<=S.rfx.e.c;++v)o.dense?(l[p]||(l[p]=[]),l[p][v]||(l[p][v]={t:"z",v:void 0}),l[p][v].l=S):(b=cr({c:v,r:p}),l[b]||(l[b]={t:"z",v:void 0}),l[b].l=S);break;case 426:if(!o.cellFormula)break;B.push(S),N=o.dense?l[p][v]:l[Mn(v)+k],N.f=ds(S[1],u,{r:f.r,c:v},V,o),N.F=Sr(S[0]);break;case 427:if(!o.cellFormula)break;q[cr(S[0].s)]=S[1],N=o.dense?l[p][v]:l[Mn(v)+k],N.f=ds(S[1],u,{r:f.r,c:v},V,o);break;case 60:if(!o.cellStyles)break;for(;S.e>=S.s;)C[S.e--]={width:S.w/256,hidden:!!(S.flags&1),level:S.level},E||(E=!0,Bb(S.w/256)),Fu(C[S.e+1]);break;case 161:l["!autofilter"]={ref:Sr(S)};break;case 476:l["!margins"]=S;break;case 147:s.Sheets[e]||(s.Sheets[e]={}),S.name&&(s.Sheets[e].CodeName=S.name),(S.above||S.left)&&(l["!outline"]={above:S.above,left:S.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),S.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!T.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Sr(c||u)),o.sheetRows&&l["!ref"]){var w=ln(l["!ref"]);o.sheetRows<=+w.e.r&&(w.e.r=o.sheetRows-1,w.e.r>u.e.r&&(w.e.r=u.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>u.e.c&&(w.e.c=u.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Sr(w))}return L.length>0&&(l["!merges"]=L),C.length>0&&(l["!cols"]=C),O.length>0&&(l["!rows"]=O),l}function Vj(t){var r=[],e=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(r[+i[1]]=e?+i[2]:i[2])});var s=Cr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[r,s,n]}function qj(t,r,e,n,s,a){var i=a||{"!type":"chart"};if(!t)return a;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=Vj(d);u.s.r=u.s.c=0,u.e.c=o,c=Mn(o),h[0].forEach(function(f,g){i[c+es(g)]={t:"n",v:f,z:h[1]},l=g}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=Sr(u)),i}function Wj(t,r,e,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=t.match(Y8);return o&&Ub(o[0],a,s,e),(i=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function Gj(t,r){t.l+=10;var e=bs(t);return{name:e}}function Xj(t,r,e,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return go(t,function(l,c,u){switch(u){case 550:a["!rel"]=l;break;case 651:s.Sheets[e]||(s.Sheets[e]={}),l.name&&(s.Sheets[e].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},r),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var Z8=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Kj=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Yj=[],Jj=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function b5(t,r){for(var e=0;e!=t.length;++e)for(var n=t[e],s=0;s!=r.length;++s){var a=r[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Xr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function y5(t,r){for(var e=0;e!=r.length;++e){var n=r[e];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Xr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Q8(t){y5(t.WBProps,Z8),y5(t.CalcPr,Jj),b5(t.WBView,Kj),b5(t.Sheets,Yj),yu.date1904=Xr(t.WBProps.date1904)}var Zj="][*?/\\".split("");function Qj(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return Zj.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}var eL=/<\w+:workbook/;function tL(t,r){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(t.replace(ws,function(l,c){var u=nr(l);switch(Di(u[0])){case"<?xml":break;case"<workbook":l.match(eL)&&(s="xmlns"+l.match(/<(\w+):/)[1]),e.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],e.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Z8.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":e.WBProps[d[0]]=Xr(u[d[0]]);break;case"int":e.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:e.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(e.WBProps.CodeName=zr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],e.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Cr(zr(u.name)),delete u[0],e.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=zr(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),Xr(u.hidden||"0")&&(a.Hidden=!0),i=c+l.length;break;case"</definedName>":a.Ref=Cr(zr(t.slice(i,c))),e.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],e.CalcPr=u;break;case"<calcPr/>":delete u[0],e.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),yD.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return Q8(e),e}function rL(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=L2(t),e.name=bs(t),e}function nL(t,r){var e={},n=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var s=r>8?bs(t):"";return s.length>0&&(e.CodeName=s),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function sL(t,r){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=r-8,e}function aL(t,r,e){var n=t.l+r;t.l+=4,t.l+=1;var s=t.read_shift(4),a=LD(t),i=HF(t,0,e),o=Mb(t);t.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function iL(t,r){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;r||(r={}),r.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Pp[16]={n:"BrtFRTArchID$",f:sL},go(t,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),e.Sheets.push(l);break;case 153:e.WBProps=l;break;case 39:l.Sheet!=null&&(r.SID=l.Sheet),l.Ref=ds(l.Ptg,null,null,i,r),delete r.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},r),Q8(e),e.Names=a,e.supbooks=i,e}function oL(t,r,e){return r.slice(-4)===".bin"?iL(t,e):tL(t,e)}function lL(t,r,e,n,s,a,i,o){return r.slice(-4)===".bin"?zj(t,n,e,s,a,i,o):rj(t,n,e,s,a,i,o)}function cL(t,r,e,n,s,a,i,o){return r.slice(-4)===".bin"?Xj(t,n,e,s,a):Wj(t,n,e,s,a)}function uL(t,r,e,n,s,a,i,o){return r.slice(-4)===".bin"?bM():yM()}function fL(t,r,e,n,s,a,i,o){return r.slice(-4)===".bin"?gM():vM()}function hL(t,r,e,n){return r.slice(-4)===".bin"?OO(t,e,n):CO(t,e,n)}function dL(t,r,e){return B8(t,e)}function pL(t,r,e){return r.slice(-4)===".bin"?KP(t,e):GP(t,e)}function mL(t,r,e){return r.slice(-4)===".bin"?dM(t,e):lM(t,e)}function gL(t,r,e){return r.slice(-4)===".bin"?aM(t):nM(t)}function vL(t,r,e,n){return e.slice(-4)===".bin"?iM(t,r,e,n):void 0}function bL(t,r,e){return r.slice(-4)===".bin"?tM(t,r,e):rM(t,r,e)}var eS=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,tS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qa(t,r){var e=t.split(/\s+/),n=[];if(n[0]=e[0],e.length===1)return n;var s=t.match(eS),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(tS),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function yL(t){var r=t.split(/\s+/),e={};if(r.length===1)return e;var n=t.match(eS),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(tS),(a=s[1].indexOf(":"))===-1?e[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),e[i]=s[2].slice(1,s[2].length-1));return e}var hh;function xL(t,r){var e=hh[t]||Cr(t);return e==="General"?ic(r):La(e,r)}function wL(t,r,e,n){var s=n;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Xr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Vn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[Cr(r)]=s}function _L(t,r,e){if(t.t!=="z"){if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||gc[t.v]:r==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Fh(t.v):t.w=ic(t.v):t.w=xL(r||"General",t.v)}catch(a){if(e.WTF)throw a}try{var n=hh[r]||r||"General";if(e.cellNF&&(t.z=n),e.cellDates&&t.t=="n"&&qu(n)){var s=Kl(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(e.WTF)throw a}}}function SL(t,r,e){if(e.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=wO[n.Pattern]||n.Pattern)}t[r.ID]=r}function kL(t,r,e,n,s,a,i,o,l,c){var u="General",d=n.StyleID,h={};c=c||{};var f=[],g=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);a[d]!==void 0&&(a[d].nf&&(u=a[d].nf),a[d].Interior&&f.push(a[d].Interior),!!a[d].Parent);)d=a[d].Parent;switch(e.Type){case"Boolean":n.t="b",n.v=Xr(t);break;case"String":n.t="s",n.r=Uw(Cr(t)),n.v=t.indexOf("<")>-1?Cr(r||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Vn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Cr(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=v8[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&r==""?n.t="z":(n.t="s",n.v=Uw(r||t));break}if(_L(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=Cr(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=bu(m,s),delete n.Formula,n.ArrayRange=="RC"?n.F=bu("RC:RC",s):n.ArrayRange&&(n.F=bu(n.ArrayRange,s),l.push([ln(n.F),n.F]))}else for(g=0;g<l.length;++g)s.r>=l[g][0].s.r&&s.r<=l[g][0].e.r&&s.c>=l[g][0].s.c&&s.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(f.forEach(function(p){!h.patternType&&p.patternType&&(h.patternType=p.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function EL(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Q1(t,r){var e=r||{};z_();var n=$f(Nb(t));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(n=zr(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Qn(e);return i.type="string",Ih.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(se){s.indexOf("<"+se)>=0&&(a=!0)}),a)return ML(n,e);hh={"General Number":"General","General Date":dr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":dr[15],"Short Date":dr[14],"Long Time":dr[19],"Medium Time":dr[18],"Short Time":dr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:dr[2],Standard:dr[4],Percent:dr[10],Scientific:dr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},d=[],h=e.dense?[]:{},f="",g={},m={},p=qa('<Data ss:Type="String">'),v=0,b=0,y=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},L={},F="",R=0,B=[],q={},V={},I=0,C=[],O=[],E={},x=[],w,_=!1,S=[],T=[],U={},A=0,H=0,z={Sheets:[],WBProps:{date1904:!1}},K={};Lh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var j="";o=Lh.exec(n);)switch(o[3]=(j=o[3]).toLowerCase()){case"data":if(j=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?kL(n.slice(v,o.index),F,p,l[l.length-1][0]=="comment"?E:g,{c:b,r:y},N,x[b],m,S,e):(F="",p=qa(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(O.length>0&&(g.c=O),(!e.sheetRows||e.sheetRows>y)&&g.v!==void 0&&(e.dense?(h[y]||(h[y]=[]),h[y][b]=g):h[Mn(b)+es(y)]=g),g.HRef&&(g.l={Target:Cr(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(A=b+(parseInt(g.MergeAcross,10)|0),H=y+(parseInt(g.MergeDown,10)|0),B.push({s:{c:b,r:y},e:{c:A,r:H}})),!e.sheetStubs)g.MergeAcross?b=A+1:++b;else if(g.MergeAcross||g.MergeDown){for(var J=b;J<=A;++J)for(var P=y;P<=H;++P)(J>b||P>y)&&(e.dense?(h[P]||(h[P]=[]),h[P][J]={t:"z"}):h[Mn(J)+es(P)]={t:"z"});b=A+1}else++b;else g=yL(o[0]),g.Index&&(b=+g.Index-1),b<k.s.c&&(k.s.c=b),b>k.e.c&&(k.e.c=b),o[0].slice(-2)==="/>"&&++b,O=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<k.s.r&&(k.s.r=y),y>k.e.r&&(k.e.r=y),o[0].slice(-2)==="/>"&&(m=qa(o[0]),m.Index&&(y=+m.Index-1)),b=0,++y):(m=qa(o[0]),m.Index&&(y=+m.Index-1),U={},(m.AutoFitHeight=="0"||m.Height)&&(U.hpx=parseInt(m.Height,10),U.hpt=I8(U.hpx),T[y]=U),m.Hidden=="1"&&(U.hidden=!0,T[y]=U));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(f),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(h["!ref"]=Sr(k),e.sheetRows&&e.sheetRows<=k.e.r&&(h["!fullref"]=h["!ref"],k.e.r=e.sheetRows-1,h["!ref"]=Sr(k))),B.length&&(h["!merges"]=B),x.length>0&&(h["!cols"]=x),T.length>0&&(h["!rows"]=T),u[f]=h}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=b=0,l.push([o[3],!1]),c=qa(o[0]),f=Cr(c.Name),h=e.dense?[]:{},B=[],S=[],T=[],K={name:f,Hidden:0},z.Sheets.push(K);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),x=[],_=!1}break;case"style":o[1]==="/"?SL(N,L,e):L=qa(o[0]);break;case"numberformat":L.nf=Cr(qa(o[0]).Format||"General"),hh[L.nf]&&(L.nf=hh[L.nf]);for(var D=0;D!=392&&dr[D]!=L.nf;++D);if(D==392){for(D=57;D!=392;++D)if(dr[D]==null){Zl(L.nf,D);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(w=qa(o[0]),w.Hidden&&(w.hidden=!0,delete w.Hidden),w.Width&&(w.wpx=parseInt(w.Width,10)),!_&&w.wpx>10){_=!0,Ds=j8;for(var G=0;G<x.length;++G)x[G]&&Fu(x[G])}_&&Fu(w),x[w.Index-1||x.length]=w;for(var re=0;re<+w.Span;++re)x[x.length]=Qn(w);break;case"namedrange":if(o[1]==="/")break;z.Names||(z.Names=[]);var te=nr(o[0]),ne={Name:te.Name,Ref:bu(te.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(ne.Sheet=z.Sheets.length-1),z.Names.push(ne);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F+=n.slice(R,o.index):R=o.index+o[0].length;break;case"interior":if(!e.cellStyles)break;L.Interior=qa(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?lR(q,j,n.slice(I,o.index)):I=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));EL(E),O.push(E)}else l.push([o[3],!1]),c=qa(o[0]),E={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var le=qa(o[0]);h["!autofilter"]={ref:bu(le.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return E5(n,e);var oe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:oe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:oe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:oe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:oe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(I,o.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else I=o.index+o[0].length;break;case"header":h["!margins"]||fh(h["!margins"]={},"xlml"),isNaN(+nr(o[0]).Margin)||(h["!margins"].header=+nr(o[0]).Margin);break;case"footer":h["!margins"]||fh(h["!margins"]={},"xlml"),isNaN(+nr(o[0]).Margin)||(h["!margins"].footer=+nr(o[0]).Margin);break;case"pagemargins":var ee=nr(o[0]);h["!margins"]||fh(h["!margins"]={},"xlml"),isNaN(+ee.Top)||(h["!margins"].top=+ee.Top),isNaN(+ee.Left)||(h["!margins"].left=+ee.Left),isNaN(+ee.Right)||(h["!margins"].right=+ee.Right),isNaN(+ee.Bottom)||(h["!margins"].bottom=+ee.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:oe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:oe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:oe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:oe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:oe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:oe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:oe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:oe=!1}break;case"smarttags":break;default:oe=!1;break}if(oe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?wL(V,j,C,n.slice(I,o.index)):(C=o,I=o.index+o[0].length);break}if(e.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Z={};return!e.bookSheets&&!e.bookProps&&(Z.Sheets=u),Z.SheetNames=d,Z.Workbook=z,Z.SSF=Qn(dr),Z.Props=q,Z.Custprops=V,Z}function U2(t,r){switch(Vb(r=r||{}),r.type||"base64"){case"base64":return Q1(pa(t),r);case"binary":case"buffer":case"file":return Q1(t,r);case"array":return Q1(dc(t),r)}}function AL(t){var r={},e=t.content;if(e.l=28,r.AnsiUserType=e.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=$D(e),e.length-e.l<=4)return r;var n=e.read_shift(4);if(n==0||n>40||(e.l-=4,r.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(n=e.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=UD(e),n=e.read_shift(4),n==0||n>40))return r;e.l-=4,r.Reserved2=e.read_shift(0,"lpwstr")}var CL=[60,1084,2066,2165,2175];function TL(t,r,e,n,s){var a=n,i=[],o=e.slice(e.l,e.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),e.l+=a;for(var l=Qi(e,e.l),c=H2[l],u=0;c!=null&&CL.indexOf(l)>-1;)a=Qi(e,e.l+2),u=e.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=e.slice(u,e.l+4+a),i.push(o),e.l+=4+a,c=H2[l=Qi(e,e.l)];var d=Jo(i);Yn(d,0);var h=0;d.lens=[];for(var f=0;f<i.length;++f)d.lens.push(h),h+=i[f].length;if(d.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+d.length+" < "+n;return r.f(d,d.length,s)}function gi(t,r,e){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,r.cellNF&&(t.z=dr[n])}catch(a){if(r.WTF)throw a}if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||gc[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Fh(t.v):t.w=ic(t.v):t.w=La(n,t.v,{date1904:!!e,dateNF:r&&r.dateNF})}catch(a){if(r.WTF)throw a}if(r.cellDates&&n&&t.t=="n"&&qu(dr[n]||String(n))){var s=Kl(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function b0(t,r,e){return{v:t,ixfe:r,t:e}}function NL(t,r){var e={opts:{}},n={},s=r.dense?[]:{},a={},i={},o=null,l=[],c="",u={},d,h="",f,g,m,p,v={},b=[],y,k,N=[],L=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},B=function(Ye){return Ye<8?Ql[Ye]:Ye<64&&L[Ye-8]||Ql[Ye]},q=function(Ye,rt,ht){var Ce=rt.XF.data;if(!(!Ce||!Ce.patternType||!ht||!ht.cellStyles)){rt.s={},rt.s.patternType=Ce.patternType;var Ie;(Ie=Bh(B(Ce.icvFore)))&&(rt.s.fgColor={rgb:Ie}),(Ie=Bh(B(Ce.icvBack)))&&(rt.s.bgColor={rgb:Ie})}},V=function(Ye,rt,ht){if(!(U>1)&&!(ht.sheetRows&&Ye.r>=ht.sheetRows)){if(ht.cellStyles&&rt.XF&&rt.XF.data&&q(Ye,rt,ht),delete rt.ixfe,delete rt.XF,d=Ye,h=cr(Ye),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Ye.r<i.s.r&&(i.s.r=Ye.r),Ye.c<i.s.c&&(i.s.c=Ye.c),Ye.r+1>i.e.r&&(i.e.r=Ye.r+1),Ye.c+1>i.e.c&&(i.e.c=Ye.c+1),ht.cellFormula&&rt.f){for(var Ce=0;Ce<b.length;++Ce)if(!(b[Ce][0].s.c>Ye.c||b[Ce][0].s.r>Ye.r)&&!(b[Ce][0].e.c<Ye.c||b[Ce][0].e.r<Ye.r)){rt.F=Sr(b[Ce][0]),(b[Ce][0].s.c!=Ye.c||b[Ce][0].s.r!=Ye.r)&&delete rt.f,rt.f&&(rt.f=""+ds(b[Ce][1],i,Ye,S,I));break}}ht.dense?(s[Ye.r]||(s[Ye.r]=[]),s[Ye.r][Ye.c]=rt):s[h]=rt}},I={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(I.password=r.password);var C,O=[],E=[],x=[],w=[],_=!1,S=[];S.SheetNames=I.snames,S.sharedf=I.sharedf,S.arrayf=I.arrayf,S.names=[],S.XTI=[];var T=0,U=0,A=0,H=[],z=[],K;I.codepage=1200,ni(1200);for(var j=!1;t.l<t.length-1;){var J=t.l,P=t.read_shift(2);if(P===0&&T===10)break;var D=t.l===t.length?0:t.read_shift(2),G=H2[P];if(G&&G.f){if(r.bookSheets&&T===133&&P!==133)break;if(T=P,G.r===2||G.r==12){var re=t.read_shift(2);if(D-=2,!I.enc&&re!==P&&((re&255)<<8|re>>8)!==P)throw new Error("rt mismatch: "+re+"!="+P);G.r==12&&(t.l+=10,D-=10)}var te={};if(P===10?te=G.f(t,D,I):te=TL(P,G,t,D,I),U==0&&[9,521,1033,2057].indexOf(T)===-1)continue;switch(P){case 34:e.opts.Date1904=F.WBProps.date1904=te;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(I.enc||(t.l=0),I.enc=te,!r.password)throw new Error("File is password-protected");if(te.valid==null)throw new Error("Encryption scheme unsupported");if(!te.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=te;break;case 66:var ne=Number(te);switch(ne){case 21010:ne=1200;break;case 32768:ne=1e4;break;case 32769:ne=1252;break}ni(I.codepage=ne),j=!0;break;case 317:I.rrtabid=te;break;case 25:I.winlocked=te;break;case 439:e.opts.RefreshAll=te;break;case 12:e.opts.CalcCount=te;break;case 16:e.opts.CalcDelta=te;break;case 17:e.opts.CalcIter=te;break;case 13:e.opts.CalcMode=te;break;case 14:e.opts.CalcPrecision=te;break;case 95:e.opts.CalcSaveRecalc=te;break;case 15:I.CalcRefMode=te;break;case 2211:e.opts.FullCalc=te;break;case 129:te.fDialog&&(s["!type"]="dialog"),te.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),te.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:N.push(te);break;case 430:S.push([te]),S[S.length-1].XTI=[];break;case 35:case 547:S[S.length-1].push(te);break;case 24:case 536:K={Name:te.Name,Ref:ds(te.rgce,i,null,S,I)},te.itab>0&&(K.Sheet=te.itab-1),S.names.push(K),S[0]||(S[0]=[],S[0].XTI=[]),S[S.length-1].push(te),te.Name=="_xlnm._FilterDatabase"&&te.itab>0&&te.rgce&&te.rgce[0]&&te.rgce[0][0]&&te.rgce[0][0][0]=="PtgArea3d"&&(z[te.itab-1]={ref:Sr(te.rgce[0][0][1][2])});break;case 22:I.ExternCount=te;break;case 23:S.length==0&&(S[0]=[],S[0].XTI=[]),S[S.length-1].XTI=S[S.length-1].XTI.concat(te),S.XTI=S.XTI.concat(te);break;case 2196:if(I.biff<8)break;K!=null&&(K.Comment=te[1]);break;case 18:s["!protect"]=te;break;case 19:te!==0&&I.WTF&&console.error("Password verifier: "+te);break;case 133:a[te.pos]=te,I.snames.push(te.name);break;case 10:{if(--U)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Sr(i),r.sheetRows&&r.sheetRows<=i.e.r){var le=i.e.r;i.e.r=r.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Sr(i),i.e.r=le}i.e.r++,i.e.c++}O.length>0&&(s["!merges"]=O),E.length>0&&(s["!objects"]=E),x.length>0&&(s["!cols"]=x),w.length>0&&(s["!rows"]=w),F.Sheets.push(R)}c===""?u=s:n[c]=s,s=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[P]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[te.BIFFVer]||8),I.biffguess=te.BIFFVer==0,te.BIFFVer==0&&te.dt==4096&&(I.biff=5,j=!0,ni(I.codepage=28591)),I.biff==8&&te.BIFFVer==0&&te.dt==16&&(I.biff=2),U++)break;if(s=r.dense?[]:{},I.biff<8&&!j&&(j=!0,ni(I.codepage=r.codepage||1252)),I.biff<5||te.BIFFVer==0&&te.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var oe={pos:t.l-D,name:c};a[oe.pos]=oe,I.snames.push(c)}else c=(a[J]||{name:""}).name;te.dt==32&&(s["!type"]="chart"),te.dt==64&&(s["!type"]="macro"),O=[],E=[],I.arrayf=b=[],x=[],w=[],_=!1,R={Hidden:(a[J]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(r.dense?(s[te.r]||[])[te.c]:s[cr({c:te.c,r:te.r})])&&++te.c,y={ixfe:te.ixfe,XF:N[te.ixfe]||{},v:te.val,t:"n"},A>0&&(y.z=H[y.ixfe>>8&63]),gi(y,r,e.opts.Date1904),V({c:te.c,r:te.r},y,r);break;case 5:case 517:y={ixfe:te.ixfe,XF:N[te.ixfe],v:te.val,t:te.t},A>0&&(y.z=H[y.ixfe>>8&63]),gi(y,r,e.opts.Date1904),V({c:te.c,r:te.r},y,r);break;case 638:y={ixfe:te.ixfe,XF:N[te.ixfe],v:te.rknum,t:"n"},A>0&&(y.z=H[y.ixfe>>8&63]),gi(y,r,e.opts.Date1904),V({c:te.c,r:te.r},y,r);break;case 189:for(var ee=te.c;ee<=te.C;++ee){var Z=te.rkrec[ee-te.c][0];y={ixfe:Z,XF:N[Z],v:te.rkrec[ee-te.c][1],t:"n"},A>0&&(y.z=H[y.ixfe>>8&63]),gi(y,r,e.opts.Date1904),V({c:ee,r:te.r},y,r)}break;case 6:case 518:case 1030:{if(te.val=="String"){o=te;break}if(y=b0(te.val,te.cell.ixfe,te.tt),y.XF=N[y.ixfe],r.cellFormula){var se=te.formula;if(se&&se[0]&&se[0][0]&&se[0][0][0]=="PtgExp"){var ie=se[0][0][1][0],ue=se[0][0][1][1],pe=cr({r:ie,c:ue});v[pe]?y.f=""+ds(te.formula,i,te.cell,S,I):y.F=((r.dense?(s[ie]||[])[ue]:s[pe])||{}).F}else y.f=""+ds(te.formula,i,te.cell,S,I)}A>0&&(y.z=H[y.ixfe>>8&63]),gi(y,r,e.opts.Date1904),V(te.cell,y,r),o=te}break;case 7:case 519:if(o)o.val=te,y=b0(te,o.cell.ixfe,"s"),y.XF=N[y.ixfe],r.cellFormula&&(y.f=""+ds(o.formula,i,o.cell,S,I)),A>0&&(y.z=H[y.ixfe>>8&63]),gi(y,r,e.opts.Date1904),V(o.cell,y,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(te);var fe=cr(te[0].s);if(f=r.dense?(s[te[0].s.r]||[])[te[0].s.c]:s[fe],r.cellFormula&&f){if(!o||!fe||!f)break;f.f=""+ds(te[1],i,te[0],S,I),f.F=Sr(te[0])}}break;case 1212:{if(!r.cellFormula)break;if(h){if(!o)break;v[cr(o.cell)]=te[0],f=r.dense?(s[o.cell.r]||[])[o.cell.c]:s[cr(o.cell)],(f||{}).f=""+ds(te[0],i,d,S,I)}}break;case 253:y=b0(l[te.isst].t,te.ixfe,"s"),l[te.isst].h&&(y.h=l[te.isst].h),y.XF=N[y.ixfe],A>0&&(y.z=H[y.ixfe>>8&63]),gi(y,r,e.opts.Date1904),V({c:te.c,r:te.r},y,r);break;case 513:r.sheetStubs&&(y={ixfe:te.ixfe,XF:N[te.ixfe],t:"z"},A>0&&(y.z=H[y.ixfe>>8&63]),gi(y,r,e.opts.Date1904),V({c:te.c,r:te.r},y,r));break;case 190:if(r.sheetStubs)for(var ye=te.c;ye<=te.C;++ye){var Te=te.ixfe[ye-te.c];y={ixfe:Te,XF:N[Te],t:"z"},A>0&&(y.z=H[y.ixfe>>8&63]),gi(y,r,e.opts.Date1904),V({c:ye,r:te.r},y,r)}break;case 214:case 516:case 4:y=b0(te.val,te.ixfe,"s"),y.XF=N[y.ixfe],A>0&&(y.z=H[y.ixfe>>8&63]),gi(y,r,e.opts.Date1904),V({c:te.c,r:te.r},y,r);break;case 0:case 512:U===1&&(i=te);break;case 252:l=te;break;case 1054:if(I.biff==4){H[A++]=te[1];for(var Pe=0;Pe<A+163&&dr[Pe]!=te[1];++Pe);Pe>=163&&Zl(te[1],A+163)}else Zl(te[1],te[0]);break;case 30:{H[A++]=te;for(var je=0;je<A+163&&dr[je]!=te;++je);je>=163&&Zl(te,A+163)}break;case 229:O=O.concat(te);break;case 93:E[te.cmo[0]]=I.lastobj=te;break;case 438:I.lastobj.TxO=te;break;case 127:I.lastobj.ImData=te;break;case 440:for(p=te[0].s.r;p<=te[0].e.r;++p)for(m=te[0].s.c;m<=te[0].e.c;++m)f=r.dense?(s[p]||[])[m]:s[cr({c:m,r:p})],f&&(f.l=te[1]);break;case 2048:for(p=te[0].s.r;p<=te[0].e.r;++p)for(m=te[0].s.c;m<=te[0].e.c;++m)f=r.dense?(s[p]||[])[m]:s[cr({c:m,r:p})],f&&f.l&&(f.l.Tooltip=te[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;f=r.dense?(s[te[0].r]||[])[te[0].c]:s[cr(te[0])];var qe=E[te[2]];f||(r.dense?(s[te[0].r]||(s[te[0].r]=[]),f=s[te[0].r][te[0].c]={t:"z"}):f=s[cr(te[0])]={t:"z"},i.e.r=Math.max(i.e.r,te[0].r),i.s.r=Math.min(i.s.r,te[0].r),i.e.c=Math.max(i.e.c,te[0].c),i.s.c=Math.min(i.s.c,te[0].c)),f.c||(f.c=[]),g={a:te[1],t:qe.TxO.t},f.c.push(g)}break;case 2173:JO(N[te.ixfe],te.ext);break;case 125:{if(!I.cellStyles)break;for(;te.e>=te.s;)x[te.e--]={width:te.w/256,level:te.level||0,hidden:!!(te.flags&1)},_||(_=!0,Bb(te.w/256)),Fu(x[te.e+1])}break;case 520:{var We={};te.level!=null&&(w[te.r]=We,We.level=te.level),te.hidden&&(w[te.r]=We,We.hidden=!0),te.hpt&&(w[te.r]=We,We.hpt=te.hpt,We.hpx=$h(te.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||fh(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[P]]=te;break;case 161:s["!margins"]||fh(s["!margins"]={}),s["!margins"].header=te.header,s["!margins"].footer=te.footer;break;case 574:te.RTL&&(F.Views[0].RTL=!0);break;case 146:L=te;break;case 2198:C=te;break;case 140:k=te;break;case 442:c?R.CodeName=te||R.name:F.WBProps.CodeName=te||"ThisWorkbook";break}}else G||console.error("Missing Info for XLS Record 0x"+P.toString(16)),t.l+=D}return e.SheetNames=Ni(a).sort(function(at,Ye){return Number(at)-Number(Ye)}).map(function(at){return a[at].name}),r.bookSheets||(e.Sheets=n),!e.SheetNames.length&&u["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=u)):e.Preamble=u,e.Sheets&&z.forEach(function(at,Ye){e.Sheets[e.SheetNames[Ye]]["!autofilter"]=at}),e.Strings=l,e.SSF=Qn(dr),I.enc&&(e.Encryption=I.enc),C&&(e.Themes=C),e.Metadata={},k!==void 0&&(e.Metadata.Country=k),S.names.length>0&&(F.Names=S.names),e.Workbook=F,e}var x5={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function DL(t,r,e){var n=_r.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=n5(n,GD,x5.DSI);for(var a in s)r[a]=s[a]}catch(c){if(e.WTF)throw c}var i=_r.find(t,"/!SummaryInformation");if(i&&i.size>0)try{var o=n5(i,XD,x5.SI);for(var l in o)r[l]==null&&(r[l]=o[l])}catch(c){if(e.WTF)throw c}r.HeadingPairs&&r.TitlesOfParts&&(y8(r.HeadingPairs,r.TitlesOfParts,r,e),delete r.HeadingPairs,delete r.TitlesOfParts)}function rS(t,r){r||(r={}),Vb(r),R_(),r.codepage&&_b(r.codepage);var e,n;if(t.FullPaths){if(_r.find(t,"/encryption"))throw new Error("File is password-protected");e=_r.find(t,"!CompObj"),n=_r.find(t,"/Workbook")||_r.find(t,"/Book")}else{switch(r.type){case"base64":t=ri(pa(t));break;case"binary":t=ri(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Yn(t,0),n={content:t}}var s,a;if(e&&AL(e),r.bookProps&&!r.bookSheets)s={};else{var i=yr?"buffer":"array";if(n&&n.content)s=NL(n.content,r);else if((a=_r.find(t,"PerfectOffice_MAIN"))&&a.content)s=ch.to_workbook(a.content,(r.type=i,r));else if((a=_r.find(t,"NativeContent_MAIN"))&&a.content)s=ch.to_workbook(a.content,(r.type=i,r));else throw(a=_r.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&t.FullPaths&&_r.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=mM(t))}var o={};return t.FullPaths&&DL(t,o,r),s.Props=s.Custprops=o,r.bookFiles&&(s.cfb=t),s}var Pp={0:{f:fj},1:{f:mj},2:{f:kj},3:{f:yj},4:{f:vj},5:{f:Sj},6:{f:Cj},7:{f:wj},8:{f:Pj},9:{f:Rj},10:{f:Nj},11:{f:Dj},12:{f:gj},13:{f:Ej},14:{f:xj},15:{f:bj},16:{f:J8},17:{f:Tj},18:{f:_j},19:{f:Ob},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:aL},40:{},42:{},43:{f:NO},44:{f:TO},45:{f:DO},46:{f:PO},47:{f:RO},48:{},49:{f:OD},50:{},51:{f:QO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:R8},62:{f:Aj},63:{f:sM},64:{f:Uj},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:$j},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:pj},148:{f:hj,p:16},151:{f:Fj},152:{},153:{f:nL},154:{},155:{},156:{f:rL},157:{},158:{},159:{T:1,f:XP},160:{T:-1},161:{T:1,f:mc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Oj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ZO},336:{T:-1},337:{f:eM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:L2},357:{},358:{},359:{},360:{T:1},361:{},362:{f:D8},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:jj},427:{f:Lj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Bj},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:dj},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Mj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:L2},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:hM},633:{T:1},634:{T:-1},635:{T:1,f:fM},636:{T:-1},637:{f:FD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Gj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Hj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},H2={6:{f:J1},10:{f:Lo},12:{f:En},13:{f:En},14:{f:dn},15:{f:dn},16:{f:ms},17:{f:dn},18:{f:dn},19:{f:En},20:{f:o5},21:{f:o5},23:{f:D8},24:{f:c5},25:{f:dn},26:{},27:{},28:{f:cP},29:{},34:{f:dn},35:{f:l5},38:{f:ms},39:{f:ms},40:{f:ms},41:{f:ms},42:{f:dn},43:{f:dn},47:{f:dO},49:{f:VR},51:{f:En},60:{},61:{f:UR},64:{f:dn},65:{f:zR},66:{f:En},77:{},80:{},81:{},82:{},85:{f:En},89:{},90:{},91:{},92:{f:OR},93:{f:fP},94:{},95:{f:dn},96:{},97:{},99:{f:dn},125:{f:R8},128:{f:eP},129:{f:MR},130:{f:En},131:{f:dn},132:{f:dn},133:{f:FR},134:{},140:{f:vP},141:{f:En},144:{},146:{f:yP},151:{},152:{},153:{},154:{},155:{},156:{f:En},157:{},158:{},160:{f:kP},161:{f:wP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:YR},190:{f:JR},193:{f:Lo},197:{},198:{},199:{},200:{},201:{},202:{f:dn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:En},220:{},221:{f:dn},222:{},224:{f:QR},225:{f:PR},226:{f:Lo},227:{},229:{f:uP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:jR},253:{f:qR},255:{f:LR},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:k8},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:dn},353:{f:Lo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:rP},431:{f:dn},432:{},433:{},434:{},437:{},438:{f:pP},439:{f:dn},440:{f:mP},441:{},442:{f:nd},443:{},444:{f:En},445:{},446:{},448:{f:Lo},449:{f:$R,r:2},450:{f:Lo},512:{f:a5},513:{f:SP},515:{f:tP},516:{f:WR},517:{f:i5},519:{f:EP},520:{f:IR},523:{},545:{f:u5},549:{f:s5},566:{},574:{f:HR},638:{f:KR},659:{},1048:{},1054:{f:GR},1084:{},1212:{f:iP},2048:{f:gP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:m0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Lo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:xP,r:12},2173:{f:YO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:dn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:aP,r:12},2197:{},2198:{f:VO,r:12},2199:{},2200:{},2201:{},2202:{f:oP,r:12},2203:{f:Lo},2204:{},2205:{},2206:{},2207:{},2211:{f:BR},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:En},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:_P},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:bP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:a5},1:{},2:{f:NP},3:{f:TP},4:{f:CP},5:{f:i5},7:{f:DP},8:{},9:{f:m0},11:{},22:{f:En},30:{f:XR},31:{},32:{},33:{f:u5},36:{},37:{f:s5},50:{f:RP},62:{},52:{},67:{},68:{f:En},69:{},86:{},126:{},127:{f:AP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:PP},223:{},234:{},354:{},421:{},518:{f:J1},521:{f:m0},536:{f:c5},547:{f:l5},561:{},579:{},1030:{f:J1},1033:{f:m0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Wa(t,r,e,n){var s=r;if(!isNaN(s)){var a=(e||[]).length||0,i=t.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&f8(e)&&t.push(e)}}function w5(t,r){var e=r||{},n=e.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),i=s.index,o=a&&a.index||t.length,l=tD(t.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<l.length;++i){var m=l[i].trim(),p=m.slice(0,3).toLowerCase();if(p=="<tr"){if(++c,e.sheetRows&&e.sheetRows<=c){--c;break}u=0;continue}if(!(p!="<td"&&p!="<th")){var v=m.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var b=v[o].trim();if(b.match(/<t[dh]/i)){for(var y=b,k=0;y.charAt(0)=="<"&&(k=y.indexOf(">"))>-1;)y=y.slice(k+1);for(var N=0;N<g.length;++N){var L=g[N];L.s.c==u&&L.s.r<c&&c<=L.e.r&&(u=L.e.c+1,N=-1)}var F=nr(b.slice(0,b.indexOf(">")));h=F.colspan?+F.colspan:1,((d=+F.rowspan)>1||h>1)&&g.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+h-1}});var R=F.t||F["data-t"]||"";if(!y.length){u+=h;continue}if(y=Z_(y),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),!y.length){u+=h;continue}var B={t:"s",v:y};e.raw||!y.trim().length||R=="s"||(y==="TRUE"?B={t:"b",v:!0}:y==="FALSE"?B={t:"b",v:!1}:isNaN(oi(y))?isNaN(Mu(y).getDate())||(B={t:"d",v:Vn(y)},e.cellDates||(B={t:"n",v:Ms(B.v)}),B.z=e.dateNF||dr[14]):B={t:"n",v:oi(y)}),e.dense?(n[c]||(n[c]=[]),n[c][u]=B):n[cr({r:c,c:u})]=B,u+=h}}}}return n["!ref"]=Sr(f),g.length&&(n["!merges"]=g),n}function RL(t,r,e,n){for(var s=t["!merges"]||[],a=[],i=r.s.c;i<=r.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>e||s[c].s.c>i)&&!(s[c].e.r<e||s[c].e.c<i)){if(s[c].s.r<e||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=cr({r:e,c:i}),d=n.dense?(t[e]||[])[i]:t[u],h=d&&d.v!=null&&(d.h||Tb(d.w||(co(d),d.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(f["data-t"]=d&&d.t||"z",d.v!=null&&(f["data-v"]=d.v),d.z!=null&&(f["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),f.id=(n.id||"sjs")+"-"+u,a.push(vD("td",h,f))}}var g="<tr>";return g+a.join("")+"</tr>"}var PL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',OL="</body></html>";function ML(t,r){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return El(w5(e[0],r),r);var n=Wb();return e.forEach(function(s,a){Gb(n,w5(s,r),"Sheet"+(a+1))}),n}function FL(t,r,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function jL(t,r){var e=r||{},n=e.header!=null?e.header:PL,s=e.footer!=null?e.footer:OL,a=[n],i=Wu(t["!ref"]);e.dense=Array.isArray(t),a.push(FL(t,i,e));for(var o=i.s.r;o<=i.e.r;++o)a.push(RL(t,i,o,e));return a.push("</table>"+s),a.join("")}function nS(t,r,e){var n=e||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Rs(n.origin):n.origin;s=i.r,a=i.c}var o=r.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var u=Wu(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var d=[],h=0,f=t["!rows"]||(t["!rows"]=[]),g=0,m=0,p=0,v=0,b=0,y=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&m<l;++g){var k=o[g];if(_5(k)){if(n.display)continue;f[m]={hidden:!0}}var N=k.children;for(p=v=0;p<N.length;++p){var L=N[p];if(!(n.display&&_5(L))){var F=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):Z_(L.innerHTML),R=L.getAttribute("data-z")||L.getAttribute("z");for(h=0;h<d.length;++h){var B=d[h];B.s.c==v+a&&B.s.r<m+s&&m+s<=B.e.r&&(v=B.e.c+1-a,h=-1)}y=+L.getAttribute("colspan")||1,((b=+L.getAttribute("rowspan")||1)>1||y>1)&&d.push({s:{r:m+s,c:v+a},e:{r:m+s+(b||1)-1,c:v+a+(y||1)-1}});var q={t:"s",v:F},V=L.getAttribute("data-t")||L.getAttribute("t")||"";F!=null&&(F.length==0?q.t=V||"z":n.raw||F.trim().length==0||V=="s"||(F==="TRUE"?q={t:"b",v:!0}:F==="FALSE"?q={t:"b",v:!1}:isNaN(oi(F))?isNaN(Mu(F).getDate())||(q={t:"d",v:Vn(F)},n.cellDates||(q={t:"n",v:Ms(q.v)}),q.z=n.dateNF||dr[14]):q={t:"n",v:oi(F)})),q.z===void 0&&R!=null&&(q.z=R);var I="",C=L.getElementsByTagName("A");if(C&&C.length)for(var O=0;O<C.length&&!(C[O].hasAttribute("href")&&(I=C[O].getAttribute("href"),I.charAt(0)!="#"));++O);I&&I.charAt(0)!="#"&&(q.l={Target:I}),n.dense?(t[m+s]||(t[m+s]=[]),t[m+s][v+a]=q):t[cr({c:v+a,r:m+s})]=q,c.e.c<v+a&&(c.e.c=v+a),v+=y}}++m}return d.length&&(t["!merges"]=(t["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,m-1+s),t["!ref"]=Sr(c),m>=l&&(t["!fullref"]=Sr((c.e.r=o.length-g+m-1+s,c))),t}function sS(t,r){var e=r||{},n=e.dense?[]:{};return nS(n,t,r)}function LL(t,r){return El(sS(t,r),r)}function _5(t){var r="",e=IL(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function IL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function BL(t){var r=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=Cr(r.replace(/<[^>]*>/g,""));return[e]}var S5={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function aS(t,r){var e=r||{},n=Nb(t),s=[],a,i,o={name:""},l="",c=0,u,d,h={},f=[],g=e.dense?[]:{},m,p,v={value:""},b="",y=0,k=[],N=-1,L=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,B={},q=[],V={},I=0,C=0,O=[],E=1,x=1,w=[],_={Names:[]},S={},T=["",""],U=[],A={},H="",z=0,K=!1,j=!1,J=0;for(Lh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Lh.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?g["!ref"]=Sr(F):g["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=F.e.r&&(g["!fullref"]=g["!ref"],F.e.r=e.sheetRows-1,g["!ref"]=Sr(F)),q.length&&(g["!merges"]=q),O.length&&(g["!rows"]=O),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),f.push(u.name),h[u.name]=g,j=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=nr(m[0],!1),N=L=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,g=e.dense?[]:{},q=[],O=[],j=!0);break;case"table-row-group":m[1]==="/"?--R:++R;break;case"table-row":case"":if(m[1]==="/"){N+=E,E=1;break}if(d=nr(m[0],!1),d.?N=d.-1:N==-1&&(N=0),E=+d["number-rows-repeated"]||1,E<10)for(J=0;J<E;++J)R>0&&(O[N+J]={level:R});L=-1;break;case"covered-table-cell":m[1]!=="/"&&++L,e.sheetStubs&&(e.dense?(g[N]||(g[N]=[]),g[N][L]={t:"z"}):g[cr({r:N,c:L})]={t:"z"}),b="",k=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++L,v=nr(m[0],!1),x=parseInt(v["number-columns-repeated"]||"1",10),p={t:"z",v:null},v.formula&&e.cellFormula!=!1&&(p.f=v5(Cr(v.formula))),(v.||v["value-type"])=="string"&&(p.t="s",p.v=Cr(v["string-value"]||""),e.dense?(g[N]||(g[N]=[]),g[N][L]=p):g[cr({r:N,c:L})]=p),L+=x-1;else if(m[1]!=="/"){++L,b="",y=0,k=[],x=1;var P=E?N+E-1:N;if(L>F.e.c&&(F.e.c=L),L<F.s.c&&(F.s.c=L),N<F.s.r&&(F.s.r=N),P>F.e.r&&(F.e.r=P),v=nr(m[0],!1),U=[],A={},p={t:v.||v["value-type"],v:null},e.cellFormula)if(v.formula&&(v.formula=Cr(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(I=parseInt(v["number-matrix-rows-spanned"],10)||0,C=parseInt(v["number-matrix-columns-spanned"],10)||0,V={s:{r:N,c:L},e:{r:N+I-1,c:L+C-1}},p.F=Sr(V),w.push([V,p.F])),v.formula)p.f=v5(v.formula);else for(J=0;J<w.length;++J)N>=w[J][0].s.r&&N<=w[J][0].e.r&&L>=w[J][0].s.c&&L<=w[J][0].e.c&&(p.F=w[J][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(I=parseInt(v["number-rows-spanned"],10)||0,C=parseInt(v["number-columns-spanned"],10)||0,V={s:{r:N,c:L},e:{r:N+I-1,c:L+C-1}},q.push(V)),v["number-columns-repeated"]&&(x=parseInt(v["number-columns-repeated"],10)),p.t){case"boolean":p.t="b",p.v=Xr(v["boolean-value"]);break;case"float":p.t="n",p.v=parseFloat(v.value);break;case"percentage":p.t="n",p.v=parseFloat(v.value);break;case"currency":p.t="n",p.v=parseFloat(v.value);break;case"date":p.t="d",p.v=Vn(v["date-value"]),e.cellDates||(p.t="n",p.v=Ms(p.v)),p.z="m/d/yy";break;case"time":p.t="n",p.v=ZN(v["time-value"])/86400,e.cellDates&&(p.t="d",p.v=gm(p.v)),p.z="HH:MM:SS";break;case"number":p.t="n",p.v=parseFloat(v.);break;default:if(p.t==="string"||p.t==="text"||!p.t)p.t="s",v["string-value"]!=null&&(b=Cr(v["string-value"]),k=[]);else throw new Error("Unsupported value type "+p.t)}}else{if(K=!1,p.t==="s"&&(p.v=b||"",k.length&&(p.R=k),K=y==0),S.Target&&(p.l=S),U.length>0&&(p.c=U,U=[]),b&&e.cellText!==!1&&(p.w=b),K&&(p.t="z",delete p.v),(!K||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=N))for(var D=0;D<E;++D){if(x=parseInt(v["number-columns-repeated"]||"1",10),e.dense)for(g[N+D]||(g[N+D]=[]),g[N+D][L]=D==0?p:Qn(p);--x>0;)g[N+D][L+x]=Qn(p);else for(g[cr({r:N+D,c:L})]=p;--x>0;)g[cr({r:N+D,c:L+x})]=Qn(p);F.e.c<=L&&(F.e.c=L)}x=parseInt(v["number-columns-repeated"]||"1",10),L+=x-1,x=0,p={},b="",k=[]}S={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((a=s.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((a=s.pop())[0]!==m[3])throw"Bad state: "+a;A.t=b,k.length&&(A.R=k),A.a=H,U.push(A)}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);H="",z=0,b="",y=0,k=[];break;case"creator":m[1]==="/"?H=n.slice(z,m.index):z=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((a=s.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);b="",y=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(B[o.name]=l,(a=s.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=nr(m[0],!1),s.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=nr(m[0],!1),l+=S5[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=nr(m[0],!1),l+=S5[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":i=nr(m[0],!1),T=Z1(i["cell-range-address"]);var G={Name:i.name,Ref:T[0]+"!"+T[1]};j&&(G.Sheet=f.length),_.Names.push(G);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(m[1]==="/"&&(!v||!v["string-value"])){var re=BL(n.slice(y,m.index));b=(b.length>0?b+`
`:"")+re[0]}else nr(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{T=Z1(nr(m[0])["target-range-address"]),h[T[0]]["!autofilter"]={ref:T[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(S=nr(m[0],!1),!S.href)break;S.Target=Cr(S.href),delete S.href,S.Target.charAt(0)=="#"&&S.Target.indexOf(".")>-1?(T=Z1(S.Target.slice(1)),S.Target="#"+T[0]+"!"+T[1]):S.Target.match(/^\.\.[\\\/]/)&&(S.Target=S.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(e.WTF)throw new Error(m)}}var te={Sheets:h,SheetNames:f,Workbook:_};return e.bookSheets&&delete te.Sheets,te}function k5(t,r){r=r||{},Na(t,"META-INF/manifest.xml")&&tR(kn(t,"META-INF/manifest.xml"),r);var e=la(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var n=aS(zr(e),r);return Na(t,"meta.xml")&&(n.Props=b8(kn(t,"meta.xml"))),n}function E5(t,r){return aS(t,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Hb(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function z2(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):zr(dc(t))}function V2(t){var r=t.reduce(function(s,a){return s+a.length},0),e=new Uint8Array(r),n=0;return t.forEach(function(s){e.set(s,n),n+=s.length}),e}function A5(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function $L(t,r){for(var e=(t[r+15]&127)<<7|t[r+14]>>1,n=t[r+14]&1,s=r+13;s>=r;--s)n=n*256+t[s];return(t[r+15]&128?-n:n)*Math.pow(10,e-6176)}function Uh(t,r){var e=r?r[0]:0,n=t[e]&127;e:if(t[e++]>=128&&(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),n}function Fn(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function vs(t){for(var r=[],e=[0];e[0]<t.length;){var n=e[0],s=Uh(t,e),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=e[0];t[e[0]++]>=128;);o=t.slice(l,e[0])}break;case 5:i=4,o=t.slice(e[0],e[0]+i),e[0]+=i;break;case 1:i=8,o=t.slice(e[0],e[0]+i),e[0]+=i;break;case 2:i=Uh(t,e),o=t.slice(e[0],e[0]+i),e[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:a};r[s]==null?r[s]=[c]:r[s].push(c)}return r}function zb(t,r){return(t==null?void 0:t.map(function(e){return r(e.data)}))||[]}function UL(t){for(var r,e=[],n=[0];n[0]<t.length;){var s=Uh(t,n),a=vs(t.slice(n[0],n[0]+s));n[0]+=s;var i={id:Fn(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=vs(o.data),c=Fn(l[3][0].data);i.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(r=a[3])!=null&&r[0]&&(i.merge=Fn(a[3][0].data)>>>0>0),e.push(i)}return e}function HL(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],n=Uh(r,e),s=[];e[0]<r.length;){var a=r[e[0]]&3;if(a==0){var i=r[e[0]++]>>2;if(i<60)++i;else{var o=i-59;i=r[e[0]],o>1&&(i|=r[e[0]+1]<<8),o>2&&(i|=r[e[0]+2]<<16),o>3&&(i|=r[e[0]+3]<<24),i>>>=0,i++,e[0]+=o}s.push(r.slice(e[0],e[0]+i)),e[0]+=i;continue}else{var l=0,c=0;if(a==1?(c=(r[e[0]]>>2&7)+4,l=(r[e[0]++]&224)<<3,l|=r[e[0]++]):(c=(r[e[0]++]>>2)+1,a==2?(l=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(l=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),s=[V2(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=V2(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function zL(t){for(var r=[],e=0;e<t.length;){var n=t[e++],s=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(HL(n,t.slice(e,e+s))),e+=s}if(e!==t.length)throw new Error("data is not a valid framed stream!");return V2(r)}function VL(t,r,e,n){var s=Hb(t),a=s.getUint32(4,!0),i=(n>1?12:8)+A5(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=A5(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(c=s.getFloat64(i,!0),i+=8),a&64&&(u.setTime(u.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var d;switch(t[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:r[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:e[o]};else if(l>-1)d={t:"s",v:r[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return d}function qL(t,r,e){var n=Hb(t),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=$L(t,a),a+=16),s&2&&(c=n.getFloat64(a,!0),a+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var d;switch(t[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:r[o]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:e[i]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return d}function WL(t,r,e){switch(t[0]){case 0:case 1:case 2:case 3:return VL(t,r,e,t[0]);case 5:return qL(t,r,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function dl(t){var r=vs(t);return Uh(r[1][0].data)}function C5(t,r){var e=vs(r.data),n=Fn(e[1][0].data),s=e[3],a=[];return(s||[]).forEach(function(i){var o=vs(i.data),l=Fn(o[1][0].data)>>>0;switch(n){case 1:a[l]=z2(o[3][0].data);break;case 8:{var c=t[dl(o[9][0].data)][0],u=vs(c.data),d=t[dl(u[1][0].data)][0],h=Fn(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var f=vs(d.data);a[l]=f[3].map(function(g){return z2(g.data)}).join("")}break}}),a}function GL(t,r){var e,n,s,a,i,o,l,c,u,d,h,f,g,m,p=vs(t),v=Fn(p[1][0].data)>>>0,b=Fn(p[2][0].data)>>>0,y=((n=(e=p[8])==null?void 0:e[0])==null?void 0:n.data)&&Fn(p[8][0].data)>0||!1,k,N;if((a=(s=p[7])==null?void 0:s[0])!=null&&a.data&&r!=0)k=(o=(i=p[7])==null?void 0:i[0])==null?void 0:o.data,N=(c=(l=p[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(u=p[4])==null?void 0:u[0])!=null&&d.data&&r!=1)k=(f=(h=p[4])==null?void 0:h[0])==null?void 0:f.data,N=(m=(g=p[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var L=y?4:1,F=Hb(k),R=[],B=0;B<k.length/2;++B){var q=F.getUint16(B*2,!0);q<65535&&R.push([B,q])}if(R.length!=b)throw"Expected ".concat(b," cells, found ").concat(R.length);var V=[];for(B=0;B<R.length-1;++B)V[R[B][0]]=N.subarray(R[B][1]*L,R[B+1][1]*L);return R.length>=1&&(V[R[R.length-1][0]]=N.subarray(R[R.length-1][1]*L)),{R:v,cells:V}}function XL(t,r){var e,n=vs(r.data),s=(e=n==null?void 0:n[7])!=null&&e[0]?Fn(n[7][0].data)>>>0>0?1:0:-1,a=zb(n[5],function(i){return GL(i,s)});return{nrows:Fn(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function KL(t,r,e){var n,s=vs(r.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Fn(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Fn(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));e["!ref"]=Sr(a);var i=vs(s[4][0].data),o=C5(t,t[dl(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?C5(t,t[dl(i[17][0].data)][0]):[],c=vs(i[3][0].data),u=0;c[1].forEach(function(d){var h=vs(d.data),f=t[dl(h[2][0].data)][0],g=Fn(f.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=XL(t,f);m.data.forEach(function(p,v){p.forEach(function(b,y){var k=cr({r:u+v,c:y}),N=WL(b,o,l);N&&(e[k]=N)})}),u+=m.nrows})}function YL(t,r){var e=vs(r.data),n={"!ref":"A1"},s=t[dl(e[2][0].data)],a=Fn(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return KL(t,s[0],n),n}function JL(t,r){var e,n=vs(r.data),s={name:(e=n[1])!=null&&e[0]?z2(n[1][0].data):"",sheets:[]},a=zb(n[2],dl);return a.forEach(function(i){t[i].forEach(function(o){var l=Fn(o.meta[1][0].data);l==6e3&&s.sheets.push(YL(t,o))})}),s}function ZL(t,r){var e=Wb(),n=vs(r.data),s=zb(n[1],dl);if(s.forEach(function(a){t[a].forEach(function(i){var o=Fn(i.meta[1][0].data);if(o==2){var l=JL(t,i);l.sheets.forEach(function(c,u){Gb(e,c,u==0?l.name:l.name+"_"+u,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function eg(t){var r,e,n,s,a={},i=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=zL(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var u;try{u=UL(c)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){a[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(e=(r=a==null?void 0:a[1])==null?void 0:r[0])==null?void 0:e.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Fn(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(c){var u=Fn(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return ZL(a,o)}function QL(t){return function(e){for(var n=0;n!=t.length;++n){var s=t[n];e[s[0]]===void 0&&(e[s[0]]=s[1]),s[2]==="n"&&(e[s[0]]=Number(e[s[0]]))}}}function Vb(t){QL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function eI(t){return cu.WS.indexOf(t)>-1?"sheet":t==cu.CS?"chart":t==cu.DS?"dialog":t==cu.MS?"macro":t&&t.length?t:"sheet"}function tI(t,r){if(!t)return 0;try{t=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,eI(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function rI(t,r,e,n,s,a,i,o,l,c,u,d){try{a[n]=oh(la(t,e,!0),r);var h=kn(t,r),f;switch(o){case"sheet":f=lL(h,r,s,l,a[n],c,u,d);break;case"chart":if(f=cL(h,r,s,l,a[n],c,u,d),!f||!f["!drawel"])break;var g=Hf(f["!drawel"].Target,r),m=I2(g),p=oM(la(t,g,!0),oh(la(t,m,!0),g)),v=Hf(p,g),b=I2(v);f=qj(la(t,v,!0),v,l,oh(la(t,b,!0),v),c,f);break;case"macro":f=uL(h,r,s,l,a[n],c,u,d);break;case"dialog":f=fL(h,r,s,l,a[n],c,u,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=f;var y=[];a&&a[n]&&Ni(a[n]).forEach(function(k){var N="";if(a[n][k].Type==cu.CMNT){N=Hf(a[n][k].Target,r);var L=mL(kn(t,N,!0),N,l);if(!L||!L.length)return;h5(f,L,!1)}a[n][k].Type==cu.TCMNT&&(N=Hf(a[n][k].Target,r),y=y.concat(cM(kn(t,N,!0),l)))}),y&&y.length&&h5(f,y,!0,l.people||[])}catch(k){if(l.WTF)throw k}}function Ca(t){return t.charAt(0)=="/"?t.slice(1):t}function nI(t,r){if(z_(),r=r||{},Vb(r),Na(t,"META-INF/manifest.xml")||Na(t,"objectdata.xml"))return k5(t,r);if(Na(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof eg<"u"){if(t.FileIndex)return eg(t);var e=_r.utils.cfb_new();return Bw(t).forEach(function(O){sD(e,O,nD(t,O))}),eg(e)}throw new Error("Unsupported NUMBERS file")}if(!Na(t,"[Content_Types].xml"))throw Na(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Na(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Bw(t),s=QD(la(t,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",kn(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!kn(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!r.bookSheets&&!r.bookProps){if(uh=[],s.sst)try{uh=pL(kn(t,Ca(s.sst)),s.sst,r)}catch(O){if(r.WTF)throw O}r.cellStyles&&s.themes.length&&(l=dL(la(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],r)),s.style&&(c=hL(kn(t,Ca(s.style)),s.style,l,r))}s.links.map(function(O){try{var E=oh(la(t,I2(Ca(O))),O);return vL(kn(t,Ca(O)),E,O,r)}catch{}});var u=oL(kn(t,Ca(s.workbooks[0])),s.workbooks[0],r),d={},h="";s.coreprops.length&&(h=kn(t,Ca(s.coreprops[0]),!0),h&&(d=b8(h)),s.extprops.length!==0&&(h=kn(t,Ca(s.extprops[0]),!0),h&&sR(h,d,r)));var f={};(!r.bookSheets||r.bookProps)&&s.custprops.length!==0&&(h=la(t,Ca(s.custprops[0]),!0),h&&(f=iR(h,r)));var g={};if((r.bookSheets||r.bookProps)&&(u.Sheets?i=u.Sheets.map(function(E){return E.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),r.bookProps&&(g.Props=d,g.Custprops=f),r.bookSheets&&typeof i<"u"&&(g.SheetNames=i),r.bookSheets?g.SheetNames:r.bookProps))return g;i={};var m={};r.bookDeps&&s.calcchain&&(m=gL(kn(t,Ca(s.calcchain)),s.calcchain));var p=0,v={},b,y;{var k=u.Sheets;d.Worksheets=k.length,d.SheetNames=[];for(var N=0;N!=k.length;++N)d.SheetNames[N]=k[N].name}var L=a?"bin":"xml",F=s.workbooks[0].lastIndexOf("/"),R=(s.workbooks[0].slice(0,F+1)+"_rels/"+s.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Na(t,R)||(R="xl/_rels/workbook."+L+".rels");var B=oh(la(t,R,!0),R.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(r.xlmeta=bL(kn(t,Ca(s.metadata[0])),s.metadata[0],r)),(s.people||[]).length>=1&&(r.people=uM(kn(t,Ca(s.people[0])),r)),B&&(B=tI(B,u.Sheets));var q=kn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(p=0;p!=d.Worksheets;++p){var V="sheet";if(B&&B[p]?(b="xl/"+B[p][1].replace(/[\/]?xl\//,""),Na(t,b)||(b=B[p][1]),Na(t,b)||(b=R.replace(/_rels\/.*$/,"")+B[p][1]),V=B[p][2]):(b="xl/worksheets/sheet"+(p+1-q)+"."+L,b=b.replace(/sheet0\./,"sheet.")),y=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(p!=r.sheets)continue e;break;case"string":if(d.SheetNames[p].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var I=!1,C=0;C!=r.sheets.length;++C)typeof r.sheets[C]=="number"&&r.sheets[C]==p&&(I=1),typeof r.sheets[C]=="string"&&r.sheets[C].toLowerCase()==d.SheetNames[p].toLowerCase()&&(I=1);if(!I)continue e}}rI(t,b,y,d.SheetNames[p],p,v,i,V,r,u,l,c)}return g={Directory:s,Workbook:u,Props:d,Custprops:f,Deps:m,Sheets:i,SheetNames:d.SheetNames,Strings:uh,Styles:c,Themes:l,SSF:Qn(dr)},r&&r.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(O,E){O=O.replace(/^Root Entry[\/]/,""),g.keys.push(O),g.files[O]=t.FileIndex[E]}))),r&&r.bookVBA&&(s.vba.length>0?g.vbaraw=kn(t,Ca(s.vba[0]),!0):s.defaults&&s.defaults.bin===pM&&(g.vbaraw=kn(t,"xl/vbaProject.bin",!0))),g}function sI(t,r){var e=r||{},n="Workbook",s=_r.find(t,n);try{if(n="/!DataSpaces/Version",s=_r.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(YP(s.content),n="/!DataSpaces/DataSpaceMap",s=_r.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=ZP(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=_r.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=QP(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=_r.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);tO(s.content)}catch{}if(n="/EncryptionInfo",s=_r.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=rO(s.content);if(n="/EncryptedPackage",s=_r.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,e.password||"",e);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,e.password||"",e);throw new Error("File is password-protected")}function qb(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=pa(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function aI(t,r){return _r.find(t,"EncryptedPackage")?sI(t,r):rS(t,r)}function iI(t,r){var e,n=t,s=r||{};return s.type||(s.type=yr&&Buffer.isBuffer(t)?"buffer":"base64"),e=K_(n,s),nI(e,s)}function iS(t,r){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return U2(t.slice(e),r);default:break e}return Ih.to_workbook(t,r)}function oI(t,r){var e="",n=qb(t,r);switch(r.type){case"base64":e=pa(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=oc(t);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(e=zr(e)),r.type="binary",iS(e,r)}function lI(t,r){var e=t;return r.type=="base64"&&(e=pa(e)),e=F2.utils.decode(1200,e.slice(2),"str"),r.type="binary",iS(e,r)}function cI(t){return t.match(/[^\x00-\x7F]/)?zf(t):t}function tg(t,r,e,n){return n?(e.type="string",Ih.to_workbook(t,e)):Ih.to_workbook(r,e)}function Hh(t,r){R_();var e=r||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Hh(new Uint8Array(t),(e=Qn(e),e.type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),yu={},e.dateNF&&(yu.dateNF=e.dateNF),e.type||(e.type=yr&&Buffer.isBuffer(t)?"buffer":"base64"),e.type=="file"&&(e.type=yr?"buffer":"binary",n=YN(t),typeof Uint8Array<"u"&&!yr&&(e.type="array")),e.type=="string"&&(a=!0,e.type="binary",e.codepage=65001,n=cI(t)),e.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return e=Qn(e),e.type="array",Hh(Sb(n),e)}switch((s=qb(n,e))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return aI(_r.read(n,e),e);break;case 9:if(s[1]<=8)return rS(n,e);break;case 60:return U2(n,e);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return LP(n,e);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return FP.to_workbook(n,e);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?iI(n,e):tg(t,n,e,a);case 239:return s[3]===60?U2(n,e):tg(t,n,e,a);case 255:if(s[1]===254)return lI(n,e);if(s[1]===0&&s[2]===2&&s[3]===0)return ch.to_workbook(n,e);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ch.to_workbook(n,e);break;case 3:case 131:case 139:case 140:return f5.to_workbook(n,e);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return pO.to_workbook(n,e);break;case 10:case 13:case 32:return oI(n,e);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return OP.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?f5.to_workbook(n,e):tg(t,n,e,a)}function uI(t,r,e,n,s,a,i,o){var l=es(e),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:e,enumerable:!1})}catch{h.__rowNum__=e}else h.__rowNum__=e;if(!i||t[e])for(var f=r.s.c;f<=r.e.c;++f){var g=i?t[e][f]:t[n[f]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;a[f]!=null&&(h[a[f]]=c);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[f]!=null){if(m==null)if(g.t=="e"&&m===null)h[a[f]]=null;else if(c!==void 0)h[a[f]]=c;else if(u&&m===null)h[a[f]]=null;else continue;else h[a[f]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:co(g,m,o);m!=null&&(d=!1)}}return{row:h,isempty:d}}function q2(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=r||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=ln(u);break;case"number":l=ln(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var d=es(l.s.r),h=[],f=[],g=0,m=0,p=Array.isArray(t),v=l.s.r,b=0,y={};p&&!t[v]&&(t[v]=[]);var k=c.skipHidden&&t["!cols"]||[],N=c.skipHidden&&t["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(k[b]||{}).hidden)switch(h[b]=Mn(b),e=p?t[v][b]:t[h[b]+d],n){case 1:a[b]=b-l.s.c;break;case 2:a[b]=h[b];break;case 3:a[b]=c.header[b-l.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),o=i=co(e,null,c),m=y[i]||0,!m)y[i]=1;else{do o=i+"_"+m++;while(y[o]);y[i]=m,y[o]=1}a[b]=o}for(v=l.s.r+s;v<=l.e.r;++v)if(!(N[v]||{}).hidden){var L=uI(t,l,v,h,n,a,p,c);(L.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(f[g++]=L.row)}return f.length=g,f}var T5=/"/g;function fI(t,r,e,n,s,a,i,o){for(var l=!0,c=[],u="",d=es(e),h=r.s.c;h<=r.e.c;++h)if(n[h]){var f=o.dense?(t[e]||[])[h]:t[n[h]+d];if(f==null)u="";else if(f.v!=null){l=!1,u=""+(o.rawNumbers&&f.t=="n"?f.v:co(f,null,o));for(var g=0,m=0;g!==u.length;++g)if((m=u.charCodeAt(g))===s||m===a||m===34||o.forceQuotes){u='"'+u.replace(T5,'""')+'"';break}u=="ID"&&(u='"ID"')}else f.f!=null&&!f.F?(l=!1,u="="+f.f,u.indexOf(",")>=0&&(u='"'+u.replace(T5,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function oS(t,r){var e=[],n=r??{};if(t==null||t["!ref"]==null)return"";var s=ln(t["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",d=[];n.dense=Array.isArray(t);for(var h=n.skipHidden&&t["!cols"]||[],f=n.skipHidden&&t["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(h[g]||{}).hidden||(d[g]=Mn(g));for(var m=0,p=s.s.r;p<=s.e.r;++p)(f[p]||{}).hidden||(u=fI(t,s,p,d,i,l,a,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&e.push((m++?o:"")+u)));return delete n.dense,e.join("")}function hI(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=oS(t,r);return e}function dI(t){var r="",e,n="";if(t==null||t["!ref"]==null)return[];var s=ln(t["!ref"]),a="",i=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)i[o]=Mn(o);for(var u=s.s.r;u<=s.e.r;++u)for(a=es(u),o=s.s.c;o<=s.e.c;++o)if(r=i[o]+a,e=c?(t[u]||[])[o]:t[r],n="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;n=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)n=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)n=""+e.v;else if(e.t=="b")n=e.v?"TRUE":"FALSE";else if(e.w!==void 0)n="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?n="'"+e.v:n=""+e.v}}l[l.length]=r+"="+n}return l}function lS(t,r,e){var n=e||{},s=+!n.skipHeader,a=t||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Rs(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+r.length-1+s}};if(a["!ref"]){var d=ln(a["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(i=d.e.r+1,u.e.r=i+r.length-1+s)}else i==-1&&(i=0,u.e.r=r.length-1+s);var h=n.header||[],f=0;r.forEach(function(m,p){Ni(m).forEach(function(v){(f=h.indexOf(v))==-1&&(h[f=h.length]=v);var b=m[v],y="z",k="",N=cr({c:o+f,r:i+p+s});c=zh(a,N),b&&typeof b=="object"&&!(b instanceof Date)?a[N]=b:(typeof b=="number"?y="n":typeof b=="boolean"?y="b":typeof b=="string"?y="s":b instanceof Date?(y="d",n.cellDates||(y="n",b=Ms(b)),k=n.dateNF||dr[14]):b===null&&n.nullError&&(y="e",b=0),c?(c.t=y,c.v=b,delete c.w,delete c.R,k&&(c.z=k)):a[N]=c={t:y,v:b},k&&(c.z=k))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var g=es(i);if(s)for(f=0;f<h.length;++f)a[Mn(f+o)+g]={t:"s",v:h[f]};return a["!ref"]=Sr(u),a}function pI(t,r){return lS(null,t,r)}function zh(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var n=Rs(r);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?zh(t,cr(r)):zh(t,cr({r,c:e||0}))}function mI(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Wb(){return{SheetNames:[],Sheets:{}}}function Gb(t,r,e,n){var s=1;if(!e)for(;s<=65535&&t.SheetNames.indexOf(e="Sheet"+s)!=-1;++s,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(e)>=0){var a=e.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||e;for(++s;s<=65535&&t.SheetNames.indexOf(e=i+s)!=-1;++s);}if(Qj(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function gI(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=mI(t,r);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[n].Hidden=e}function vI(t,r){return t.z=r,t}function cS(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function bI(t,r,e){return cS(t,"#"+r,e)}function yI(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function xI(t,r,e,n){for(var s=typeof r!="string"?r:ln(r),a=typeof r=="string"?r:Sr(r),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=zh(t,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=e,n&&(l.D=!0))}return t}var Go={encode_col:Mn,encode_row:es,encode_cell:cr,encode_range:Sr,decode_col:Pb,decode_row:Rb,split_cell:PD,decode_cell:Rs,decode_range:Wu,format_cell:co,sheet_add_aoa:d8,sheet_add_json:lS,sheet_add_dom:nS,aoa_to_sheet:Gu,json_to_sheet:pI,table_to_sheet:sS,table_to_book:LL,sheet_to_csv:oS,sheet_to_txt:hI,sheet_to_json:q2,sheet_to_html:jL,sheet_to_formulae:dI,sheet_to_row_object_array:q2,sheet_get_cell:zh,book_new:Wb,book_append_sheet:Gb,book_set_sheet_visibility:gI,cell_set_number_format:vI,cell_set_hyperlink:cS,cell_set_internal_link:bI,cell_add_comment:yI,sheet_set_array_formula:xI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function uS({onDataUploaded:t,icon:r="",showIcon:e=!0,isUploaded:n=!1,formatConfig:s=null}){const[a,i]=Se.useState(null),o=d=>{if(!d)return null;const h=d.toString().trim(),f=h.match(/\d+([A-Za-z]{2})\d+/);return f?f[1]:O2.includes(h)?h:null},l=(d,h)=>{const f={},g={Lagna:"Lg",Sun:"Su",Moon:"Mo",Mars:"Ma",Mercury:"Me",Jupiter:"Ju",Venus:"Ve",Saturn:"Sa",Rahu:"Ra",Ketu:"Ke",Kethu:"Ke",KETU:"Ke",KETHU:"Ke",ketu:"Ke",kethu:"Ke","Bhava Lagna":"Lg","Hora Lagna":"Lg","Ghati Lagna":"Lg","Vighati Lagna":"Lg","Varnada Lagna":"Lg","Sree Lagna":"Lg","Pranapada Lagna":"Lg","Indu Lagna":"Lg"},m=[];for(let b=1;b<=h.e.c;b++){const y=d[Go.encode_cell({r:0,c:b})];if(y&&y.v){let k=y.v.toString().trim();k=k.replace(/\s*\([^)]*\)/,""),m[b]=k}}let p=2,v=Math.min(19,h.e.r);s&&s.rowRange?(p=s.rowRange.start-1,v=Math.min(s.rowRange.end-1,h.e.r),console.log(` [ExcelUpload] Using custom row range: Excel rows ${s.rowRange.start}-${s.rowRange.end} (0-based: ${p}-${v})`)):console.log(` [ExcelUpload] Using default row range: Excel rows 3-20 (0-based: ${p}-${v})`),console.log(" [ExcelUpload] Processing planet rows...");for(let b=p;b<=v;b++){const y=d[Go.encode_cell({r:b,c:0})];if(!y||!y.v)continue;const k=y.v.toString().trim();console.log(` [ExcelUpload] Found planet name: "${k}" at row ${b+1}`);let N=g[k];if(!N){const F=Object.keys(g).find(R=>R.toLowerCase()===k.toLowerCase());F&&(N=g[F],console.log(` [ExcelUpload] Found case-insensitive match: "${F}" -> "${N}"`))}if(console.log(` [ExcelUpload] Mapped to short code: "${N}"`),!N){console.warn(` [ExcelUpload] Unknown planet: "${k}"`),console.warn(" [ExcelUpload] Available mappings:",Object.keys(g));continue}if(!["Lg","Su","Mo","Ma","Me","Ju","Ve","Sa","Ra","Ke"].includes(N)){console.log(` [ExcelUpload] Skipping additional planet: "${k}" (${N}) - not in main 10`);continue}if(N==="Lg"&&f[N]){console.log(` [ExcelUpload] Skipping duplicate Lagna: "${k}"`);continue}f[N]={},console.log(` [ExcelUpload] Created data structure for planet: "${N}"`);for(let F=1;F<=h.e.c;F++){const R=d[Go.encode_cell({r:b,c:F})];if(R&&R.v){const B=o(R.v),q=m[F];B&&q&&(f[N][q]=B)}}}return console.log(" [ExcelUpload] Final processed data structure:"),console.log("  - Total planets processed:",Object.keys(f).length),console.log("  - Planet keys:",Object.keys(f)),console.log("  - Ketu data check:",f.Ke?"EXISTS":"MISSING"),f.Ke&&console.log("  - Ketu divisions:",Object.keys(f.Ke)),f},c=(d,h)=>{let f=0;const g=["Lagna","Sun","Moon","Mars","Mercury","Jupiter","Venus","Saturn","Rahu","Ketu"],m=[];let p=2,v=Math.min(10,h.e.r);s&&s.rowRange?(p=s.rowRange.start-1,v=Math.min(s.rowRange.end-1,h.e.r),console.log(` [ExcelUpload] Using custom validation range: Excel rows ${s.rowRange.start}-${Math.min(s.rowRange.end,h.e.r+1)} (0-based: ${p}-${v})`)):console.log(` [ExcelUpload] Using default validation range: Excel rows 3-11 (0-based: ${p}-${v})`);for(let k=p;k<=v;k++){const N=d[Go.encode_cell({r:k,c:0})];if(N&&N.v){const L=N.v.toString().trim();g.includes(L)&&m.push({row:k,name:L})}}let b=9;if(s&&s.expectedPlanets&&(b=s.expectedPlanets),m.length<b){const k=m.map(L=>L.name),N=g.filter(L=>!k.includes(L));if(console.warn(` [ExcelUpload] Expected ${b} planets, found ${m.length}. Missing: ${N.join(", ")}`),console.warn(` [ExcelUpload] Found planets: ${k.join(", ")}`),m.length<8)throw new Error(`Invalid viboothi format. Expected at least 8 planets, found ${m.length}. Missing: ${N.join(", ")}`)}m.forEach(({row:k,name:N})=>{let L=0;for(let F=1;F<=Math.min(24,h.e.c);F++){const R=d[Go.encode_cell({r:k,c:F})];R&&R.v!==null&&R.v!==void 0&&R.v.toString().trim()!==""&&(L++,f++)}L<20&&console.warn(`Warning: ${N} has only ${L} divisions (expected ~24)`)});const y=Math.max(180,m.length*20);if(f<y)throw new Error(`Insufficient viboothi data. Expected ~${m.length*24} cells (${m.length} planets  24 divisions), found ${f} cells.`);return console.log(` Viboothi format validated: ${f} data cells across ${m.length} planets`),f},u=d=>{try{i(null);const h=d.target.files[0];if(!h)return;const f=new FileReader;f.onload=g=>{try{const m=new Uint8Array(g.target.result),p=Hh(m,{type:"array"}),v=p.Sheets[p.SheetNames[0]],b=Go.decode_range(v["!ref"]);c(v,b);const y=l(v,b);t(y,h.name),d.target.value=null}catch(m){console.error("Excel processing error:",m),i(m.message)}},f.readAsArrayBuffer(h)}catch(h){console.error("File upload error:",h),i(h.message)}};return X.jsxs("label",{className:"cursor-pointer inline-flex items-center",children:[X.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:u,className:"hidden"}),X.jsx("span",{className:`inline-block p-1 rounded hover:bg-gray-100 ${n?"text-green-600":"text-blue-600"}`,title:n?"View uploaded data":"Upload Excel file",children:X.jsx("span",{className:"text-xl",children:r})}),a&&X.jsx("span",{className:"ml-2 text-xs text-red-600",children:a})]})}function y0(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fS={exports:{}};/*! ExcelJS 19-10-2023 */(function(t,r){(function(e){t.exports=e()})(function(){return function e(n,s,a){function i(c,u){if(!s[c]){if(!n[c]){var d=typeof y0=="function"&&y0;if(!u&&d)return d(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var f=s[c]={exports:{}};n[c][0].call(f.exports,function(g){return i(n[c][1][g]||g)},f,f.exports,e,n,s,a)}return s[c].exports}for(var o=typeof y0=="function"&&y0,l=0;l<a.length;l++)i(a[l]);return i}({1:[function(e,n,s){const a=e("fs"),i=e("fast-csv"),o=e("dayjs/plugin/customParseFormat"),l=e("dayjs/plugin/utc"),c=e("dayjs").extend(o).extend(l),u=e("../utils/stream-buf"),{fs:{exists:d}}=e("../utils/utils"),h={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};n.exports=class{constructor(f){this.workbook=f,this.worksheet=null}async readFile(f,g){if(g=g||{},!await d(f))throw new Error("File not found: "+f);const m=a.createReadStream(f),p=await this.read(m,g);return m.close(),p}read(f,g){return g=g||{},new Promise((m,p)=>{const v=this.workbook.addWorksheet(g.sheetName),b=g.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],y=g.map||function(N){if(N==="")return null;const L=Number(N);if(!Number.isNaN(L)&&L!==1/0)return L;const F=b.reduce((B,q)=>{if(B)return B;const V=c(N,q,!0);return V.isValid()?V:null},null);if(F)return new Date(F.valueOf());const R=h[N];return R!==void 0?R:N},k=i.parse(g.parserOptions).on("data",N=>{v.addRow(N.map(y))}).on("end",()=>{k.emit("worksheet",v)});k.on("worksheet",m).on("error",p),f.pipe(k)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(f,g){return new Promise((m,p)=>{g=g||{};const v=this.workbook.getWorksheet(g.sheetName||g.sheetId),b=i.format(g.formatterOptions);f.on("finish",()=>{m()}),b.on("error",p),b.pipe(f);const{dateFormat:y,dateUTC:k}=g,N=g.map||(R=>{if(R){if(R.text||R.hyperlink)return R.hyperlink||R.text||"";if(R.formula||R.result)return R.result||"";if(R instanceof Date)return y?k?c.utc(R).format(y):c(R).format(y):k?c.utc(R).format():c(R).format();if(R.error)return R.error;if(typeof R=="object")return JSON.stringify(R)}return R}),L=g.includeEmptyRows===void 0||g.includeEmptyRows;let F=1;v&&v.eachRow((R,B)=>{if(L)for(;F++<B-1;)b.write([]);const{values:q}=R;q.shift(),b.write(q.map(N)),F=B}),b.end()})}writeFile(f,g){const m={encoding:(g=g||{}).encoding||"utf8"},p=a.createWriteStream(f,m);return this.write(p,g)}async writeBuffer(f){const g=new u;return await this.write(g,f),g.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(e,n,s){const a=e("../utils/col-cache");class i{constructor(l,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=l,c)if(typeof c=="string"){const d=a.decodeAddress(c);this.nativeCol=d.col+u,this.nativeColOff=0,this.nativeRow=d.row+u,this.nativeRowOff=0}else c.nativeCol!==void 0?(this.nativeCol=c.nativeCol||0,this.nativeColOff=c.nativeColOff||0,this.nativeRow=c.nativeRow||0,this.nativeRowOff=c.nativeRowOff||0):c.col!==void 0?(this.col=c.col+u,this.row=c.row+u):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(l){return l instanceof i||l==null?l:new i(l)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(l){this.nativeCol=Math.floor(l),this.nativeColOff=Math.floor((l-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(l){this.nativeRow=Math.floor(l),this.nativeRowOff=Math.floor((l-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(l){this.nativeCol=l.nativeCol,this.nativeColOff=l.nativeColOff,this.nativeRow=l.nativeRow,this.nativeRowOff=l.nativeRowOff}}n.exports=i},{"../utils/col-cache":19}],3:[function(e,n,s){const a=e("../utils/col-cache"),i=e("../utils/under-dash"),o=e("./enums"),{slideFormula:l}=e("../utils/shared-formula"),c=e("./note");class u{constructor(f,g,m){if(!f||!g)throw new Error("A Cell needs a Row");this._row=f,this._column=g,a.validateAddress(m),this._address=m,this._value=d.create(u.Types.Null,this),this.style=this._mergeStyle(f.style,g.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(f){this.style.numFmt=f}get font(){return this.style.font}set font(f){this.style.font=f}get alignment(){return this.style.alignment}set alignment(f){this.style.alignment=f}get border(){return this.style.border}set border(f){this.style.border=f}get fill(){return this.style.fill}set fill(f){this.style.fill=f}get protection(){return this.style.protection}set protection(f){this.style.protection=f}_mergeStyle(f,g,m){const p=f&&f.numFmt||g&&g.numFmt;p&&(m.numFmt=p);const v=f&&f.font||g&&g.font;v&&(m.font=v);const b=f&&f.alignment||g&&g.alignment;b&&(m.alignment=b);const y=f&&f.border||g&&g.border;y&&(m.border=y);const k=f&&f.fill||g&&g.fill;k&&(m.fill=k);const N=f&&f.protection||g&&g.protection;return N&&(m.protection=N),m}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===u.Types.Merge}merge(f,g){this._value.release(),this._value=d.create(u.Types.Merge,this,f),g||(this.style=f.style)}unmerge(){this.type===u.Types.Merge&&(this._value.release(),this._value=d.create(u.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(f){return this._value.type===u.Types.Merge&&this._value.isMergedTo(f)}get master(){return this.type===u.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===u.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(f){this.type!==u.Types.Merge?(this._value.release(),this._value=d.create(d.getType(f),this,f)):this._value.master.value=f}get note(){return this._comment&&this._comment.note}set note(f){this._comment=new c(f)}get text(){return this._value.toString()}get html(){return i.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(f){this.type===u.Types.String&&(this._value=d.create(u.Types.Hyperlink,this,{text:this._value.value,hyperlink:f}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:f}=this._row;return{sheetName:f.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(f){this.names=[f]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(f){const{definedNames:g}=this.workbook;g.removeAllNames(this.fullAddress),f.forEach(m=>{g.addEx(this.fullAddress,m)})}addName(f){this.workbook.definedNames.addEx(this.fullAddress,f)}removeName(f){this.workbook.definedNames.removeEx(this.fullAddress,f)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(f){this._dataValidations.add(this.address,f)}get model(){const{model:f}=this._value;return f.style=this.style,this._comment&&(f.comment=this._comment.model),f}set model(f){if(this._value.release(),this._value=d.create(f.type,this),this._value.model=f,f.comment)switch(f.comment.type){case"note":this._comment=c.fromModel(f.comment)}f.style?this.style=f.style:this.style={}}}u.Types=o.ValueType;const d={getType:h=>h==null?u.Types.Null:h instanceof String||typeof h=="string"?u.Types.String:typeof h=="number"?u.Types.Number:typeof h=="boolean"?u.Types.Boolean:h instanceof Date?u.Types.Date:h.text&&h.hyperlink?u.Types.Hyperlink:h.formula||h.sharedFormula?u.Types.Formula:h.richText?u.Types.RichText:h.sharedString?u.Types.SharedString:h.error?u.Types.Error:u.Types.JSON,types:[{t:u.Types.Null,f:class{constructor(h){this.model={address:h.address,type:u.Types.Null}}get value(){return null}set value(h){}get type(){return u.Types.Null}get effectiveType(){return u.Types.Null}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return""}release(){}toString(){return""}}},{t:u.Types.Number,f:class{constructor(h,f){this.model={address:h.address,type:u.Types.Number,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return u.Types.Number}get effectiveType(){return u.Types.Number}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.String,f:class{constructor(h,f){this.model={address:h.address,type:u.Types.String,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:u.Types.Date,f:class{constructor(h,f){this.model={address:h.address,type:u.Types.Date,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return u.Types.Date}get effectiveType(){return u.Types.Date}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Hyperlink,f:class{constructor(h,f){this.model={address:h.address,type:u.Types.Hyperlink,text:f?f.text:void 0,hyperlink:f?f.hyperlink:void 0},f&&f.tooltip&&(this.model.tooltip=f.tooltip)}get value(){const h={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(h.tooltip=this.model.tooltip),h}set value(h){this.model={text:h.text,hyperlink:h.hyperlink},h.tooltip&&(this.model.tooltip=h.tooltip)}get text(){return this.model.text}set text(h){this.model.text=h}get hyperlink(){return this.model.hyperlink}set hyperlink(h){this.model.hyperlink=h}get type(){return u.Types.Hyperlink}get effectiveType(){return u.Types.Hyperlink}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:u.Types.Formula,f:class{constructor(h,f){this.cell=h,this.model={address:h.address,type:u.Types.Formula,shareType:f?f.shareType:void 0,ref:f?f.ref:void 0,formula:f?f.formula:void 0,sharedFormula:f?f.sharedFormula:void 0,result:f?f.result:void 0}}_copyModel(h){const f={},g=m=>{const p=h[m];p&&(f[m]=p)};return g("formula"),g("result"),g("ref"),g("shareType"),g("sharedFormula"),f}get value(){return this._copyModel(this.model)}set value(h){this.model=this._copyModel(h)}validate(h){switch(d.getType(h)){case u.Types.Null:case u.Types.String:case u.Types.Number:case u.Types.Date:break;case u.Types.Hyperlink:case u.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(h){this.model.formula=h}get formulaType(){return this.model.formula?o.FormulaType.Master:this.model.sharedFormula?o.FormulaType.Shared:o.FormulaType.None}get result(){return this.model.result}set result(h){this.model.result=h}get type(){return u.Types.Formula}get effectiveType(){const h=this.model.result;return h==null?o.ValueType.Null:h instanceof String||typeof h=="string"?o.ValueType.String:typeof h=="number"?o.ValueType.Number:h instanceof Date?o.ValueType.Date:h.text&&h.hyperlink?o.ValueType.Hyperlink:h.formula?o.ValueType.Formula:o.ValueType.Null}get address(){return this.model.address}set address(h){this.model.address=h}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:h}=this.cell,f=h.findCell(this.model.sharedFormula);this._translatedFormula=f&&l(f.formula,f.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:u.Types.Merge,f:class{constructor(h,f){this.model={address:h.address,type:u.Types.Merge,master:f?f.address:void 0},this._master=f,f&&f.addMergeRef()}get value(){return this._master.value}set value(h){h instanceof u?(this._master&&this._master.releaseMergeRef(),h.addMergeRef(),this._master=h):this._master.value=h}isMergedTo(h){return h===this._master}get master(){return this._master}get type(){return u.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:u.Types.JSON,f:class{constructor(h,f){this.model={address:h.address,type:u.Types.String,value:JSON.stringify(f),rawValue:f}}get value(){return this.model.rawValue}set value(h){this.model.rawValue=h,this.model.value=JSON.stringify(h)}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:u.Types.SharedString,f:class{constructor(h,f){this.model={address:h.address,type:u.Types.SharedString,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return u.Types.SharedString}get effectiveType(){return u.Types.SharedString}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.RichText,f:class{constructor(h,f){this.model={address:h.address,type:u.Types.String,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}toString(){return this.model.value.richText.map(h=>h.text).join("")}get type(){return u.Types.RichText}get effectiveType(){return u.Types.RichText}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:u.Types.Boolean,f:class{constructor(h,f){this.model={address:h.address,type:u.Types.Boolean,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return u.Types.Boolean}get effectiveType(){return u.Types.Boolean}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Error,f:class{constructor(h,f){this.model={address:h.address,type:u.Types.Error,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return u.Types.Error}get effectiveType(){return u.Types.Error}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((h,f)=>(h[f.t]=f.f,h),[]),create(h,f,g){const m=this.types[h];if(!m)throw new Error("Could not create Value of type "+h);return new m(f,g)}};n.exports=u},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(e,n,s){const a=e("../utils/under-dash"),i=e("./enums"),o=e("../utils/col-cache");class l{constructor(u,d,h){this._worksheet=u,this._number=d,h!==!1&&(this.defn=h)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return o.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(u){u?(this.key=u.key,this.width=u.width!==void 0?u.width:9,this.outlineLevel=u.outlineLevel,u.style?this.style=u.style:this.style={},this.header=u.header,this._hidden=!!u.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(u){u!==void 0?(this._header=u,this.headers.forEach((d,h)=>{this._worksheet.getCell(h+1,this.number).value=d})):this._header=void 0}get key(){return this._key}set key(u){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=u,u&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(u){this._hidden=u}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(u){this._outlineLevel=u}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(u){return this.width===u.width&&this.hidden===u.hidden&&this.outlineLevel===u.outlineLevel&&a.isEqual(this.style,u.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const u=this.style;return!u||!(u.font||u.numFmt||u.alignment||u.border||u.fill||u.protection)}get headerCount(){return this.headers.length}eachCell(u,d){const h=this.number;d||(d=u,u=null),this._worksheet.eachRow(u,(f,g)=>{d(f.getCell(h),g)})}get values(){const u=[];return this.eachCell((d,h)=>{d&&d.type!==i.ValueType.Null&&(u[h]=d.value)}),u}set values(u){if(!u)return;const d=this.number;let h=0;u.hasOwnProperty("0")&&(h=1),u.forEach((f,g)=>{this._worksheet.getCell(g+h,d).value=f})}_applyStyle(u,d){return this.style[u]=d,this.eachCell(h=>{h[u]=d}),d}get numFmt(){return this.style.numFmt}set numFmt(u){this._applyStyle("numFmt",u)}get font(){return this.style.font}set font(u){this._applyStyle("font",u)}get alignment(){return this.style.alignment}set alignment(u){this._applyStyle("alignment",u)}get protection(){return this.style.protection}set protection(u){this._applyStyle("protection",u)}get border(){return this.style.border}set border(u){this._applyStyle("border",u)}get fill(){return this.style.fill}set fill(u){this._applyStyle("fill",u)}static toModel(u){const d=[];let h=null;return u&&u.forEach((f,g)=>{f.isDefault?h&&(h=null):h&&f.equivalentTo(h)?h.max=g+1:(h={min:g+1,max:g+1,width:f.width!==void 0?f.width:9,style:f.style,isCustomWidth:f.isCustomWidth,hidden:f.hidden,outlineLevel:f.outlineLevel,collapsed:f.collapsed},d.push(h))}),d.length?d:void 0}static fromModel(u,d){const h=[];let f=1,g=0;for(d=(d=d||[]).sort(function(m,p){return m.min-p.min});g<d.length;){const m=d[g++];for(;f<m.min;)h.push(new l(u,f++));for(;f<=m.max;)h.push(new l(u,f++,m))}return h.length?h:null}}n.exports=l},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(e,n,s){n.exports=class{constructor(a){this.model=a||{}}add(a,i){return this.model[a]=i}find(a){return this.model[a]}remove(a){this.model[a]=void 0}}},{}],6:[function(e,n,s){const a=e("../utils/under-dash"),i=e("../utils/col-cache"),o=e("../utils/cell-matrix"),l=e("./range"),c=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;n.exports=class{constructor(){this.matrixMap={}}getMatrix(u){return this.matrixMap[u]||(this.matrixMap[u]=new o)}add(u,d){const h=i.decodeEx(u);this.addEx(h,d)}addEx(u,d){const h=this.getMatrix(d);if(u.top)for(let f=u.left;f<=u.right;f++)for(let g=u.top;g<=u.bottom;g++){const m={sheetName:u.sheetName,address:i.n2l(f)+g,row:g,col:f};h.addCellEx(m)}else h.addCellEx(u)}remove(u,d){const h=i.decodeEx(u);this.removeEx(h,d)}removeEx(u,d){this.getMatrix(d).removeCellEx(u)}removeAllNames(u){a.each(this.matrixMap,d=>{d.removeCellEx(u)})}forEach(u){a.each(this.matrixMap,(d,h)=>{d.forEach(f=>{u(h,f)})})}getNames(u){return this.getNamesEx(i.decodeEx(u))}getNamesEx(u){return a.map(this.matrixMap,(d,h)=>d.findCellEx(u)&&h).filter(Boolean)}_explore(u,d){d.mark=!1;const{sheetName:h}=d,f=new l(d.row,d.col,d.row,d.col,h);let g,m;function p(b,y){const k=u.findCellAt(h,b,d.col);return!(!k||!k.mark)&&(f[y]=b,k.mark=!1,!0)}for(m=d.row-1;p(m,"top");m--);for(m=d.row+1;p(m,"bottom");m++);function v(b,y){const k=[];for(m=f.top;m<=f.bottom;m++){const N=u.findCellAt(h,m,b);if(!N||!N.mark)return!1;k.push(N)}f[y]=b;for(let N=0;N<k.length;N++)k[N].mark=!1;return!0}for(g=d.col-1;v(g,"left");g--);for(g=d.col+1;v(g,"right");g++);return f}getRanges(u,d){return(d=d||this.matrixMap[u])?(d.forEach(h=>{h.mark=!0}),{name:u,ranges:d.map(h=>h.mark&&this._explore(d,h)).filter(Boolean).map(h=>h.$shortRange)}):{name:u,ranges:[]}}normaliseMatrix(u,d){u.forEachInSheet(d,(h,f,g)=>{h&&(h.row===f&&h.col===g||(h.row=f,h.col=g,h.address=i.n2l(g)+f))})}spliceRows(u,d,h,f){a.each(this.matrixMap,g=>{g.spliceRows(u,d,h,f),this.normaliseMatrix(g,u)})}spliceColumns(u,d,h,f){a.each(this.matrixMap,g=>{g.spliceColumns(u,d,h,f),this.normaliseMatrix(g,u)})}get model(){return a.map(this.matrixMap,(u,d)=>this.getRanges(d,u)).filter(u=>u.ranges.length)}set model(u){const d=this.matrixMap={};u.forEach(h=>{const f=d[h.name]=new o;h.ranges.forEach(g=>{c.test(g.split("!").pop()||"")&&f.addCell(g)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(e,n,s){n.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(e,n,s){const a=e("../utils/col-cache"),i=e("./anchor");n.exports=class{constructor(o,l){this.worksheet=o,this.model=l}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(o){let{type:l,imageId:c,range:u,hyperlinks:d}=o;if(this.type=l,this.imageId=c,l==="image")if(typeof u=="string"){const h=a.decode(u);this.range={tl:new i(this.worksheet,{col:h.left,row:h.top},-1),br:new i(this.worksheet,{col:h.right,row:h.bottom},0),editAs:"oneCell"}}else this.range={tl:new i(this.worksheet,u.tl,0),br:u.br&&new i(this.worksheet,u.br,0),ext:u.ext,editAs:u.editAs,hyperlinks:d||u.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(e,n,s){const a=e("../utils/under-dash");class i{constructor(l){this.note=l}get model(){let l=null;switch(typeof this.note){case"string":l={type:"note",note:{texts:[{text:this.note}]}};break;default:l={type:"note",note:this.note}}return a.deepMerge({},i.DEFAULT_CONFIGS,l)}set model(l){const{note:c}=l,{texts:u}=c;u.length===1&&Object.keys(u[0]).length===1?this.note=u[0].text:this.note=c}static fromModel(l){const c=new i;return c.model=l,c}}i.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},n.exports=i},{"../utils/under-dash":26}],10:[function(e,n,s){const a=e("../utils/col-cache");class i{constructor(){this.decode(arguments)}setTLBR(l,c,u,d,h){if(arguments.length<4){const f=a.decodeAddress(l),g=a.decodeAddress(c);this.model={top:Math.min(f.row,g.row),left:Math.min(f.col,g.col),bottom:Math.max(f.row,g.row),right:Math.max(f.col,g.col),sheetName:u},this.setTLBR(f.row,f.col,g.row,g.col,h)}else this.model={top:Math.min(l,u),left:Math.min(c,d),bottom:Math.max(l,u),right:Math.max(c,d),sheetName:h}}decode(l){switch(l.length){case 5:this.setTLBR(l[0],l[1],l[2],l[3],l[4]);break;case 4:this.setTLBR(l[0],l[1],l[2],l[3]);break;case 3:this.setTLBR(l[0],l[1],l[2]);break;case 2:this.setTLBR(l[0],l[1]);break;case 1:{const c=l[0];if(c instanceof i)this.model={top:c.model.top,left:c.model.left,bottom:c.model.bottom,right:c.model.right,sheetName:c.sheetName};else if(c instanceof Array)this.decode(c);else if(c.top&&c.left&&c.bottom&&c.right)this.model={top:c.top,left:c.left,bottom:c.bottom,right:c.right,sheetName:c.sheetName};else{const u=a.decodeEx(c);u.top?this.model={top:u.top,left:u.left,bottom:u.bottom,right:u.right,sheetName:u.sheetName}:this.model={top:u.row,left:u.col,bottom:u.row,right:u.col,sheetName:u.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+l.length)}}get top(){return this.model.top||1}set top(l){this.model.top=l}get left(){return this.model.left||1}set left(l){this.model.left=l}get bottom(){return this.model.bottom||1}set bottom(l){this.model.bottom=l}get right(){return this.model.right||1}set right(l){this.model.right=l}get sheetName(){return this.model.sheetName}set sheetName(l){this.model.sheetName=l}get _serialisedSheetName(){const{sheetName:l}=this.model;return l?/^[a-zA-Z0-9]*$/.test(l)?l+"!":`'${l}'!`:""}expand(l,c,u,d){(!this.model.top||l<this.top)&&(this.top=l),(!this.model.left||c<this.left)&&(this.left=c),(!this.model.bottom||u>this.bottom)&&(this.bottom=u),(!this.model.right||d>this.right)&&(this.right=d)}expandRow(l){if(l){const{dimensions:c,number:u}=l;c&&this.expand(u,c.min,u,c.max)}}expandToAddress(l){const c=a.decodeEx(l);this.expand(c.row,c.col,c.row,c.col)}get tl(){return a.n2l(this.left)+this.top}get $t$l(){return`$${a.n2l(this.left)}$${this.top}`}get br(){return a.n2l(this.right)+this.bottom}get $b$r(){return`$${a.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(l){return(!l.sheetName||!this.sheetName||l.sheetName===this.sheetName)&&!(l.bottom<this.top)&&!(l.top>this.bottom)&&!(l.right<this.left)&&!(l.left>this.right)}contains(l){const c=a.decodeEx(l);return this.containsEx(c)}containsEx(l){return(!l.sheetName||!this.sheetName||l.sheetName===this.sheetName)&&l.row>=this.top&&l.row<=this.bottom&&l.col>=this.left&&l.col<=this.right}forEachAddress(l){for(let c=this.left;c<=this.right;c++)for(let u=this.top;u<=this.bottom;u++)l(a.encodeAddress(u,c),u,c)}}n.exports=i},{"../utils/col-cache":19}],11:[function(e,n,s){const a=e("../utils/under-dash"),i=e("./enums"),o=e("../utils/col-cache"),l=e("./cell");n.exports=class{constructor(c,u){this._worksheet=c,this._number=u,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(c){return this._cells[c-1]}getCellEx(c){let u=this._cells[c.col-1];if(!u){const d=this._worksheet.getColumn(c.col);u=new l(this,d,c.address),this._cells[c.col-1]=u}return u}getCell(c){if(typeof c=="string"){const u=this._worksheet.getColumnKey(c);c=u?u.number:o.l2n(c)}return this._cells[c-1]||this.getCellEx({address:o.encodeAddress(this._number,c),row:this._number,col:c})}splice(c,u){const d=c+u;for(var h=arguments.length,f=new Array(h>2?h-2:0),g=2;g<h;g++)f[g-2]=arguments[g];const m=f.length-u,p=this._cells.length;let v,b,y;if(m<0)for(v=c+f.length;v<=p;v++)y=this._cells[v-1],b=this._cells[v-m-1],b?(y=this.getCell(v),y.value=b.value,y.style=b.style,y._comment=b._comment):y&&(y.value=null,y.style={},y._comment=void 0);else if(m>0)for(v=p;v>=d;v--)b=this._cells[v-1],b?(y=this.getCell(v+m),y.value=b.value,y.style=b.style,y._comment=b._comment):this._cells[v+m-1]=void 0;for(v=0;v<f.length;v++)y=this.getCell(c+v),y.value=f[v],y.style={},y._comment=void 0}eachCell(c,u){if(u||(u=c,c=null),c&&c.includeEmpty){const d=this._cells.length;for(let h=1;h<=d;h++)u(this.getCell(h),h)}else this._cells.forEach((d,h)=>{d&&d.type!==i.ValueType.Null&&u(d,h+1)})}addPageBreak(c,u){const d=this._worksheet,h=Math.max(0,c-1)||0,f=Math.max(0,u-1)||16838,g={id:this._number,max:f,man:1};h&&(g.min=h),d.rowBreaks.push(g)}get values(){const c=[];return this._cells.forEach(u=>{u&&u.type!==i.ValueType.Null&&(c[u.col]=u.value)}),c}set values(c){if(this._cells=[],c)if(c instanceof Array){let u=0;c.hasOwnProperty("0")&&(u=1),c.forEach((d,h)=>{d!==void 0&&(this.getCellEx({address:o.encodeAddress(this._number,h+u),row:this._number,col:h+u}).value=d)})}else this._worksheet.eachColumnKey((u,d)=>{c[d]!==void 0&&(this.getCellEx({address:o.encodeAddress(this._number,u.number),row:this._number,col:u.number}).value=c[d])})}get hasValues(){return a.some(this._cells,c=>c&&c.type!==i.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let c=0;return this.eachCell(()=>{c++}),c}get dimensions(){let c=0,u=0;return this._cells.forEach(d=>{d&&d.type!==i.ValueType.Null&&((!c||c>d.col)&&(c=d.col),u<d.col&&(u=d.col))}),c>0?{min:c,max:u}:null}_applyStyle(c,u){return this.style[c]=u,this._cells.forEach(d=>{d&&(d[c]=u)}),u}get numFmt(){return this.style.numFmt}set numFmt(c){this._applyStyle("numFmt",c)}get font(){return this.style.font}set font(c){this._applyStyle("font",c)}get alignment(){return this.style.alignment}set alignment(c){this._applyStyle("alignment",c)}get protection(){return this.style.protection}set protection(c){this._applyStyle("protection",c)}get border(){return this.style.border}set border(c){this._applyStyle("border",c)}get fill(){return this.style.fill}set fill(c){this._applyStyle("fill",c)}get hidden(){return!!this._hidden}set hidden(c){this._hidden=c}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(c){this._outlineLevel=c}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const c=[];let u=0,d=0;return this._cells.forEach(h=>{if(h){const f=h.model;f&&((!u||u>h.col)&&(u=h.col),d<h.col&&(d=h.col),c.push(f))}}),this.height||c.length?{cells:c,number:this.number,min:u,max:d,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(c){if(c.number!==this._number)throw new Error("Invalid row number in model");let u;this._cells=[],c.cells.forEach(d=>{switch(d.type){case l.Types.Merge:break;default:{let h;if(d.address)h=o.decodeAddress(d.address);else if(u){const{row:f}=u,g=u.col+1;h={row:f,col:g,address:o.encodeAddress(f,g),$col$row:`$${o.n2l(g)}$${f}`}}u=h,this.getCellEx(h).model=d;break}}}),c.height?this.height=c.height:delete this.height,this.hidden=c.hidden,this.outlineLevel=c.outlineLevel||0,this.style=c.style&&JSON.parse(JSON.stringify(c.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(e,n,s){const a=e("../utils/col-cache");class i{constructor(l,c,u){this.table=l,this.column=c,this.index=u}_set(l,c){this.table.cacheState(),this.column[l]=c}get name(){return this.column.name}set name(l){this._set("name",l)}get filterButton(){return this.column.filterButton}set filterButton(l){this.column.filterButton=l}get style(){return this.column.style}set style(l){this.column.style=l}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(l){this._set("totalsRowLabel",l)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(l){this._set("totalsRowFunction",l)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(l){this._set("totalsRowResult",l)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(l){this._set("totalsRowFormula",l)}}n.exports=class{constructor(o,l){this.worksheet=o,l&&(this.table=l,this.validate(),this.store())}getFormula(o){switch(o.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${o.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${o.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${o.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${o.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${o.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${o.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${o.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${o.name}])`;case"custom":return o.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+o.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:o}=this,l=(m,p,v)=>{m[p]===void 0&&(m[p]=v)};l(o,"headerRow",!0),l(o,"totalsRow",!1),l(o,"style",{}),l(o.style,"theme","TableStyleMedium2"),l(o.style,"showFirstColumn",!1),l(o.style,"showLastColumn",!1),l(o.style,"showRowStripes",!1),l(o.style,"showColumnStripes",!1);const c=(m,p)=>{if(!m)throw new Error(p)};c(o.ref,"Table must have ref"),c(o.columns,"Table must have column definitions"),c(o.rows,"Table must have row definitions"),o.tl=a.decodeAddress(o.ref);const{row:u,col:d}=o.tl;c(u>0,"Table must be on valid row"),c(d>0,"Table must be on valid col");const{width:h,filterHeight:f,tableHeight:g}=this;o.autoFilterRef=a.encode(u,d,u+f-1,d+h-1),o.tableRef=a.encode(u,d,u+g-1,d+h-1),o.columns.forEach((m,p)=>{c(m.name,`Column ${p} must have a name`),p===0?l(m,"totalsRowLabel","Total"):(l(m,"totalsRowFunction","none"),m.totalsRowFormula=this.getFormula(m))})}store(){const o=(f,g)=>{g&&Object.keys(g).forEach(m=>{f[m]=g[m]})},{worksheet:l,table:c}=this,{row:u,col:d}=c.tl;let h=0;if(c.headerRow){const f=l.getRow(u+h++);c.columns.forEach((g,m)=>{const{style:p,name:v}=g,b=f.getCell(d+m);b.value=v,o(b,p)})}if(c.rows.forEach(f=>{const g=l.getRow(u+h++);f.forEach((m,p)=>{const v=g.getCell(d+p);v.value=m,o(v,c.columns[p].style)})}),c.totalsRow){const f=l.getRow(u+h++);c.columns.forEach((g,m)=>{const p=f.getCell(d+m);if(m===0)p.value=g.totalsRowLabel;else{const v=this.getFormula(g);p.value=v?{formula:g.totalsRowFormula,result:g.totalsRowResult}:null}o(p,g.style)})}}load(o){const{table:l}=this,{row:c,col:u}=l.tl;let d=0;if(l.headerRow){const h=o.getRow(c+d++);l.columns.forEach((f,g)=>{h.getCell(u+g).value=f.name})}if(l.rows.forEach(h=>{const f=o.getRow(c+d++);h.forEach((g,m)=>{f.getCell(u+m).value=g})}),l.totalsRow){const h=o.getRow(c+d++);l.columns.forEach((f,g)=>{const m=h.getCell(u+g);g===0?m.value=f.totalsRowLabel:this.getFormula(f)&&(m.value={formula:f.totalsRowFormula,result:f.totalsRowResult})})}}get model(){return this.table}set model(o){this.table=o}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const o=a.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let l=0;l<this._cache.tableHeight;l++){const c=this.worksheet.getRow(o.row+l);for(let u=0;u<this._cache.width;u++)c.getCell(o.col+u).value=null}else{for(let l=this.tableHeight;l<this._cache.tableHeight;l++){const c=this.worksheet.getRow(o.row+l);for(let u=0;u<this._cache.width;u++)c.getCell(o.col+u).value=null}for(let l=0;l<this.tableHeight;l++){const c=this.worksheet.getRow(o.row+l);for(let u=this.width;u<this._cache.width;u++)c.getCell(o.col+u).value=null}}this.store()}addRow(o,l){this.cacheState(),l===void 0?this.table.rows.push(o):this.table.rows.splice(l,0,o)}removeRows(o){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(o,l)}getColumn(o){const l=this.table.columns[o];return new i(this,l,o)}addColumn(o,l,c){this.cacheState(),c===void 0?(this.table.columns.push(o),this.table.rows.forEach((u,d)=>{u.push(l[d])})):(this.table.columns.splice(c,0,o),this.table.rows.forEach((u,d)=>{u.splice(c,0,l[d])}))}removeColumns(o){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(o,l),this.table.rows.forEach(c=>{c.splice(o,l)})}_assign(o,l,c){this.cacheState(),o[l]=c}get ref(){return this.table.ref}set ref(o){this._assign(this.table,"ref",o)}get name(){return this.table.name}set name(o){this.table.name=o}get displayName(){return this.table.displyName||this.table.name}set displayNamename(o){this.table.displayName=o}get headerRow(){return this.table.headerRow}set headerRow(o){this._assign(this.table,"headerRow",o)}get totalsRow(){return this.table.totalsRow}set totalsRow(o){this._assign(this.table,"totalsRow",o)}get theme(){return this.table.style.name}set theme(o){this.table.style.name=o}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(o){this.table.style.showFirstColumn=o}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(o){this.table.style.showLastColumn=o}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(o){this.table.style.showRowStripes=o}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(o){this.table.style.showColumnStripes=o}}},{"../utils/col-cache":19}],13:[function(e,n,s){const a=e("./worksheet"),i=e("./defined-names"),o=e("../xlsx/xlsx"),l=e("../csv/csv");n.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new i}get xlsx(){return this._xlsx||(this._xlsx=new o(this)),this._xlsx}get csv(){return this._csv||(this._csv=new l(this)),this._csv}get nextId(){for(let c=1;c<this._worksheets.length;c++)if(!this._worksheets[c])return c;return this._worksheets.length||1}addWorksheet(c,u){const d=this.nextId;u&&(typeof u=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),u={properties:{tabColor:{argb:u}}}):(u.argb||u.theme||u.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),u={properties:{tabColor:u}}));const h=this._worksheets.reduce((m,p)=>(p&&p.orderNo)>m?p.orderNo:m,0),f=Object.assign({},u,{id:d,name:c,orderNo:h+1,workbook:this}),g=new a(f);return this._worksheets[d]=g,g}removeWorksheetEx(c){delete this._worksheets[c.id]}removeWorksheet(c){const u=this.getWorksheet(c);u&&u.destroy()}getWorksheet(c){return c===void 0?this._worksheets.find(Boolean):typeof c=="number"?this._worksheets[c]:typeof c=="string"?this._worksheets.find(u=>u&&u.name===c):void 0}get worksheets(){return this._worksheets.slice(1).sort((c,u)=>c.orderNo-u.orderNo).filter(Boolean)}eachSheet(c){this.worksheets.forEach(u=>{c(u,u.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(c){const u=this.media.length;return this.media.push(Object.assign({},c,{type:"image"})),u}getImage(c){return this.media[c]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(c=>c.model),sheets:this.worksheets.map(c=>c.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(c){this.creator=c.creator,this.lastModifiedBy=c.lastModifiedBy,this.lastPrinted=c.lastPrinted,this.created=c.created,this.modified=c.modified,this.company=c.company,this.manager=c.manager,this.title=c.title,this.subject=c.subject,this.keywords=c.keywords,this.category=c.category,this.description=c.description,this.language=c.language,this.revision=c.revision,this.contentStatus=c.contentStatus,this.properties=c.properties,this.calcProperties=c.calcProperties,this._worksheets=[],c.worksheets.forEach(u=>{const{id:d,name:h,state:f}=u,g=c.sheets&&c.sheets.findIndex(m=>m.id===d);(this._worksheets[d]=new a({id:d,name:h,orderNo:g,state:f,workbook:this})).model=u}),this._definedNames.model=c.definedNames,this.views=c.views,this._themes=c.themes,this.media=c.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(e,n,s){const a=e("../utils/under-dash"),i=e("../utils/col-cache"),o=e("./range"),l=e("./row"),c=e("./column"),u=e("./enums"),d=e("./image"),h=e("./table"),f=e("./data-validations"),g=e("../utils/encryptor"),{copyStyle:m}=e("../utils/copy-style");n.exports=class{constructor(p){p=p||{},this._workbook=p.workbook,this.id=p.id,this.orderNo=p.orderNo,this.name=p.name,this.state=p.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},p.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!p.pageSetup||!p.pageSetup.fitToWidth&&!p.pageSetup.fitToHeight||p.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},p.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},p.headerFooter),this.dataValidations=new f,this.views=p.views||[],this.autoFilter=p.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(p){if(p===void 0&&(p="sheet"+this.id),this._name!==p){if(typeof p!="string")throw new Error("The name has to be a string.");if(p==="")throw new Error("The name can't be empty.");if(p==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(p))throw new Error(`Worksheet name ${p} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(p))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+p);if(p&&p.length>31&&(console.warn(`Worksheet name ${p} exceeds 31 chars. This will be truncated`),p=p.substring(0,31)),this._workbook._worksheets.find(v=>v&&v.name.toLowerCase()===p.toLowerCase()))throw new Error("Worksheet name already exists: "+p);this._name=p}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const p=new o;return this._rows.forEach(v=>{if(v){const b=v.dimensions;b&&p.expand(v.number,b.min,v.number,b.max)}}),p}get columns(){return this._columns}set columns(p){this._headerRowCount=p.reduce((y,k)=>{const N=(k.header?1:k.headers&&k.headers.length)||0;return Math.max(y,N)},0);let v=1;const b=this._columns=[];p.forEach(y=>{const k=new c(this,v++,!1);b.push(k),k.defn=y})}getColumnKey(p){return this._keys[p]}setColumnKey(p,v){this._keys[p]=v}deleteColumnKey(p){delete this._keys[p]}eachColumnKey(p){a.each(this._keys,p)}getColumn(p){if(typeof p=="string"){const v=this._keys[p];if(v)return v;p=i.l2n(p)}if(this._columns||(this._columns=[]),p>this._columns.length){let v=this._columns.length+1;for(;v<=p;)this._columns.push(new c(this,v++))}return this._columns[p-1]}spliceColumns(p,v){const b=this._rows.length;for(var y=arguments.length,k=new Array(y>2?y-2:0),N=2;N<y;N++)k[N-2]=arguments[N];if(k.length>0)for(let B=0;B<b;B++){const q=[p,v];k.forEach(I=>{q.push(I[B]||null)});const V=this.getRow(B+1);V.splice.apply(V,q)}else this._rows.forEach(B=>{B&&B.splice(p,v)});const L=k.length-v,F=p+v,R=this._columns.length;if(L<0)for(let B=p+k.length;B<=R;B++)this.getColumn(B).defn=this.getColumn(B-L).defn;else if(L>0)for(let B=R;B>=F;B--)this.getColumn(B+L).defn=this.getColumn(B).defn;for(let B=p;B<p+k.length;B++)this.getColumn(B).defn=null;this.workbook.definedNames.spliceColumns(this.name,p,v,k.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let p=0;return this.eachRow(v=>{p=Math.max(p,v.cellCount)}),p}get actualColumnCount(){const p=[];let v=0;return this.eachRow(b=>{b.eachCell(y=>{let{col:k}=y;p[k]||(p[k]=!0,v++)})}),v}_commitRow(){}get _lastRowNumber(){const p=this._rows;let v=p.length;for(;v>0&&p[v-1]===void 0;)v--;return v}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(p){return this._rows[p-1]}findRows(p,v){return this._rows.slice(p-1,p-1+v)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let p=0;return this.eachRow(()=>{p++}),p}getRow(p){let v=this._rows[p-1];return v||(v=this._rows[p-1]=new l(this,p)),v}getRows(p,v){if(v<1)return;const b=[];for(let y=p;y<p+v;y++)b.push(this.getRow(y));return b}addRow(p){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const b=this._nextRow,y=this.getRow(b);return y.values=p,this._setStyleOption(b,v[0]==="i"?v:"n"),y}addRows(p){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const b=[];return p.forEach(y=>{b.push(this.addRow(y,v))}),b}insertRow(p,v){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(p,0,v),this._setStyleOption(p,b),this.getRow(p)}insertRows(p,v){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(p,0,...v),b!=="n")for(let y=0;y<v.length;y++)b[0]==="o"&&this.findRow(v.length+p+y)!==void 0?this._copyStyle(v.length+p+y,p+y,b[1]==="+"):b[0]==="i"&&this.findRow(p-1)!==void 0&&this._copyStyle(p-1,p+y,b[1]==="+");return this.getRows(p,v.length)}_setStyleOption(p){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";v[0]==="o"&&this.findRow(p+1)!==void 0?this._copyStyle(p+1,p,v[1]==="+"):v[0]==="i"&&this.findRow(p-1)!==void 0&&this._copyStyle(p-1,p,v[1]==="+")}_copyStyle(p,v){let b=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const y=this.getRow(p),k=this.getRow(v);k.style=m(y.style),y.eachCell({includeEmpty:b},(N,L)=>{k.getCell(L).style=m(N.style)}),k.height=y.height}duplicateRow(p,v){let b=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const y=this._rows[p-1],k=new Array(v).fill(y.values);this.spliceRows(p+1,b?0:v,...k);for(let N=0;N<v;N++){const L=this._rows[p+N];L.style=y.style,L.height=y.height,y.eachCell({includeEmpty:!0},(F,R)=>{L.getCell(R).style=F.style})}}spliceRows(p,v){const b=p+v;for(var y=arguments.length,k=new Array(y>2?y-2:0),N=2;N<y;N++)k[N-2]=arguments[N];const L=k.length,F=L-v,R=this._rows.length;let B,q;if(F<0)for(p===R&&(this._rows[R-1]=void 0),B=b;B<=R;B++)if(q=this._rows[B-1],q){const V=this.getRow(B+F);V.values=q.values,V.style=q.style,V.height=q.height,q.eachCell({includeEmpty:!0},(I,C)=>{V.getCell(C).style=I.style}),this._rows[B-1]=void 0}else this._rows[B+F-1]=void 0;else if(F>0)for(B=R;B>=b;B--)if(q=this._rows[B-1],q){const V=this.getRow(B+F);V.values=q.values,V.style=q.style,V.height=q.height,q.eachCell({includeEmpty:!0},(I,C)=>{if(V.getCell(C).style=I.style,I._value.constructor.name==="MergeValue"){const O=this.getRow(I._row._number+L).getCell(C),E=I._value._master,x=this.getRow(E._row._number+L).getCell(E._column._number);O.merge(x)}})}else this._rows[B+F-1]=void 0;for(B=0;B<L;B++){const V=this.getRow(p+B);V.style={},V.values=k[B]}this.workbook.definedNames.spliceRows(this.name,p,v,L)}eachRow(p,v){if(v||(v=p,p=void 0),p&&p.includeEmpty){const b=this._rows.length;for(let y=1;y<=b;y++)v(this.getRow(y),y)}else this._rows.forEach(b=>{b&&b.hasValues&&v(b,b.number)})}getSheetValues(){const p=[];return this._rows.forEach(v=>{v&&(p[v.number]=v.values)}),p}findCell(p,v){const b=i.getAddress(p,v),y=this._rows[b.row-1];return y?y.findCell(b.col):void 0}getCell(p,v){const b=i.getAddress(p,v);return this.getRow(b.row).getCellEx(b)}mergeCells(){for(var p=arguments.length,v=new Array(p),b=0;b<p;b++)v[b]=arguments[b];const y=new o(v);this._mergeCellsInternal(y)}mergeCellsWithoutStyle(){for(var p=arguments.length,v=new Array(p),b=0;b<p;b++)v[b]=arguments[b];const y=new o(v);this._mergeCellsInternal(y,!0)}_mergeCellsInternal(p,v){a.each(this._merges,y=>{if(y.intersects(p))throw new Error("Cannot merge already merged cells")});const b=this.getCell(p.top,p.left);for(let y=p.top;y<=p.bottom;y++)for(let k=p.left;k<=p.right;k++)(y>p.top||k>p.left)&&this.getCell(y,k).merge(b,v);this._merges[b.address]=p}_unMergeMaster(p){const v=this._merges[p.address];if(v){for(let b=v.top;b<=v.bottom;b++)for(let y=v.left;y<=v.right;y++)this.getCell(b,y).unmerge();delete this._merges[p.address]}}get hasMerges(){return a.some(this._merges,Boolean)}unMergeCells(){for(var p=arguments.length,v=new Array(p),b=0;b<p;b++)v[b]=arguments[b];const y=new o(v);for(let k=y.top;k<=y.bottom;k++)for(let N=y.left;N<=y.right;N++){const L=this.findCell(k,N);L&&(L.type===u.ValueType.Merge?this._unMergeMaster(L.master):this._merges[L.address]&&this._unMergeMaster(L))}}fillFormula(p,v,b){let y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const k=i.decode(p),{top:N,left:L,bottom:F,right:R}=k,B=R-L+1,q=i.encodeAddress(N,L),V=y==="shared";let I;I=typeof b=="function"?b:Array.isArray(b)?Array.isArray(b[0])?(O,E)=>b[O-N][E-L]:(O,E)=>b[(O-N)*B+(E-L)]:()=>{};let C=!0;for(let O=N;O<=F;O++)for(let E=L;E<=R;E++)C?(this.getCell(O,E).value={shareType:y,formula:v,ref:p,result:I(O,E)},C=!1):this.getCell(O,E).value=V?{sharedFormula:q,result:I(O,E)}:I(O,E)}addImage(p,v){const b={type:"image",imageId:p,range:v};this._media.push(new d(this,b))}getImages(){return this._media.filter(p=>p.type==="image")}addBackgroundImage(p){const v={type:"background",imageId:p};this._media.push(new d(this,v))}getBackgroundImageId(){const p=this._media.find(v=>v.type==="background");return p&&p.imageId}protect(p,v){return new Promise(b=>{this.sheetProtection={sheet:!0},v&&"spinCount"in v&&(v.spinCount=Number.isFinite(v.spinCount)?Math.round(Math.max(0,v.spinCount)):1e5),p&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=g.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=v&&"spinCount"in v?v.spinCount:1e5,this.sheetProtection.hashValue=g.convertPasswordToHash(p,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),v&&(this.sheetProtection=Object.assign(this.sheetProtection,v),!p&&"spinCount"in v&&delete this.sheetProtection.spinCount),b()})}unprotect(){this.sheetProtection=null}addTable(p){const v=new h(this,p);return this.tables[p.name]=v,v}getTable(p){return this.tables[p]}removeTable(p){delete this.tables[p]}getTables(){return Object.values(this.tables)}addConditionalFormatting(p){this.conditionalFormattings.push(p)}removeConditionalFormatting(p){typeof p=="number"?this.conditionalFormattings.splice(p,1):this.conditionalFormattings=p instanceof Function?this.conditionalFormattings.filter(p):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(p){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=p}get model(){const p={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(y=>y.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(y=>y.model),conditionalFormattings:this.conditionalFormattings};p.cols=c.toModel(this.columns);const v=p.rows=[],b=p.dimensions=new o;return this._rows.forEach(y=>{const k=y&&y.model;k&&(b.expand(k.number,k.min,k.number,k.max),v.push(k))}),p.merges=[],a.each(this._merges,y=>{p.merges.push(y.range)}),p}_parseRows(p){this._rows=[],p.rows.forEach(v=>{const b=new l(this,v.number);this._rows[b.number-1]=b,b.model=v})}_parseMergeCells(p){a.each(p.mergeCells,v=>{this.mergeCellsWithoutStyle(v)})}set model(p){this.name=p.name,this._columns=c.fromModel(this,p.cols),this._parseRows(p),this._parseMergeCells(p),this.dataValidations=new f(p.dataValidations),this.properties=p.properties,this.pageSetup=p.pageSetup,this.headerFooter=p.headerFooter,this.views=p.views,this.autoFilter=p.autoFilter,this._media=p.media.map(v=>new d(this,v)),this.sheetProtection=p.sheetProtection,this.tables=p.tables.reduce((v,b)=>{const y=new h;return y.model=b,v[b.name]=y,v},{}),this.conditionalFormattings=p.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(e,n,s){e("core-js/modules/es.promise"),e("core-js/modules/es.promise.finally"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.values"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.async-iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.find-index"),e("core-js/modules/es.array.find"),e("core-js/modules/es.string.from-code-point"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.number.is-nan"),e("regenerator-runtime/runtime");const a={Workbook:e("./doc/workbook")},i=e("./doc/enums");Object.keys(i).forEach(o=>{a[o]=i[o]}),n.exports=a},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(e,n,s){const a=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");s.bufferToString=function(i){return typeof i=="string"?i:a?a.decode(i):i.toString()}},{}],17:[function(e,n,s){const a=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:i}=e("buffer");s.stringToBuffer=function(o){return typeof o!="string"?o:a?i.from(a.encode(o).buffer):i.from(o)}},{buffer:220}],18:[function(e,n,s){const a=e("./under-dash"),i=e("./col-cache");n.exports=class{constructor(o){this.template=o,this.sheets={}}addCell(o){this.addCellEx(i.decodeEx(o))}getCell(o){return this.findCellEx(i.decodeEx(o),!0)}findCell(o){return this.findCellEx(i.decodeEx(o),!1)}findCellAt(o,l,c){const u=this.sheets[o],d=u&&u[l];return d&&d[c]}addCellEx(o){if(o.top)for(let l=o.top;l<=o.bottom;l++)for(let c=o.left;c<=o.right;c++)this.getCellAt(o.sheetName,l,c);else this.findCellEx(o,!0)}getCellEx(o){return this.findCellEx(o,!0)}findCellEx(o,l){const c=this.findSheet(o,l),u=this.findSheetRow(c,o,l);return this.findRowCell(u,o,l)}getCellAt(o,l,c){const u=this.sheets[o]||(this.sheets[o]=[]),d=u[l]||(u[l]=[]);return d[c]||(d[c]={sheetName:o,address:i.n2l(c)+l,row:l,col:c})}removeCellEx(o){const l=this.findSheet(o);if(!l)return;const c=this.findSheetRow(l,o);c&&delete c[o.col]}forEachInSheet(o,l){const c=this.sheets[o];c&&c.forEach((u,d)=>{u&&u.forEach((h,f)=>{h&&l(h,d,f)})})}forEach(o){a.each(this.sheets,(l,c)=>{this.forEachInSheet(c,o)})}map(o){const l=[];return this.forEach(c=>{l.push(o(c))}),l}findSheet(o,l){const c=o.sheetName;return this.sheets[c]?this.sheets[c]:l?this.sheets[c]=[]:void 0}findSheetRow(o,l,c){const{row:u}=l;return o&&o[u]?o[u]:c?o[u]=[]:void 0}findRowCell(o,l,c){const{col:u}=l;return o&&o[u]?o[u]:c?o[u]=this.template?Object.assign(l,JSON.parse(JSON.stringify(this.template))):l:void 0}spliceRows(o,l,c,u){const d=this.sheets[o];if(d){const h=[];for(let f=0;f<u;f++)h.push([]);d.splice(l,c,...h)}}spliceColumns(o,l,c,u){const d=this.sheets[o];if(d){const h=[];for(let f=0;f<u;f++)h.push(null);a.each(d,f=>{f.splice(l,c,...h)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(e,n,s){const a=/^[A-Z]+\d+$/,i={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:o=>o<=26?1:o<=676?2:3,_fill(o){let l,c,u,d,h,f=1;if(o>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&o>=1){for(;f<=26;)l=this._dictionary[f-1],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=1}if(this._l2nFill<2&&o>=2){for(f=27;f<=702;)c=f-27,u=c%26,d=Math.floor(c/26),l=this._dictionary[d]+this._dictionary[u],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=2}if(this._l2nFill<3&&o>=3){for(f=703;f<=16384;)c=f-703,u=c%26,d=Math.floor(c/26)%26,h=Math.floor(c/676),l=this._dictionary[h]+this._dictionary[d]+this._dictionary[u],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=3}},l2n(o){if(this._l2n[o]||this._fill(o.length),!this._l2n[o])throw new Error("Out of bounds. Invalid column letter: "+o);return this._l2n[o]},n2l(o){if(o<1||o>16384)throw new Error(o+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[o]||this._fill(this._level(o)),this._n2l[o]},_hash:{},validateAddress(o){if(!a.test(o))throw new Error("Invalid Address: "+o);return!0},decodeAddress(o){const l=o.length<5&&this._hash[o];if(l)return l;let c=!1,u="",d=0,h=!1,f="",g=0;for(let p,v=0;v<o.length;v++)if(p=o.charCodeAt(v),!h&&p>=65&&p<=90)c=!0,u+=o[v],d=26*d+p-64;else if(p>=48&&p<=57)h=!0,f+=o[v],g=10*g+p-48;else if(h&&c&&p!==36)break;if(c){if(d>16384)throw new Error("Out of bounds. Invalid column letter: "+u)}else d=void 0;h||(g=void 0);const m={address:o=u+f,col:d,row:g,$col$row:`$${u}$${f}`};return d<=100&&g<=100&&(this._hash[o]=m,this._hash[m.$col$row]=m),m},getAddress(o,l){if(l){const c=this.n2l(l)+o;return this.decodeAddress(c)}return this.decodeAddress(o)},decode(o){const l=o.split(":");if(l.length===2){const c=this.decodeAddress(l[0]),u=this.decodeAddress(l[1]),d={top:Math.min(c.row,u.row),left:Math.min(c.col,u.col),bottom:Math.max(c.row,u.row),right:Math.max(c.col,u.col)};return d.tl=this.n2l(d.left)+d.top,d.br=this.n2l(d.right)+d.bottom,d.dimensions=`${d.tl}:${d.br}`,d}return this.decodeAddress(o)},decodeEx(o){const l=o.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),c=l[1]||l[2],u=l[3],d=u.split(":");if(d.length>1){let f=this.decodeAddress(d[0]),g=this.decodeAddress(d[1]);const m=Math.min(f.row,g.row),p=Math.min(f.col,g.col),v=Math.max(f.row,g.row),b=Math.max(f.col,g.col);return f=this.n2l(p)+m,g=this.n2l(b)+v,{top:m,left:p,bottom:v,right:b,sheetName:c,tl:{address:f,col:p,row:m,$col$row:`$${this.n2l(p)}$${m}`,sheetName:c},br:{address:g,col:b,row:v,$col$row:`$${this.n2l(b)}$${v}`,sheetName:c},dimensions:`${f}:${g}`}}if(u.startsWith("#"))return c?{sheetName:c,error:u}:{error:u};const h=this.decodeAddress(u);return c?{sheetName:c,...h}:h},encodeAddress:(o,l)=>i.n2l(l)+o,encode(){switch(arguments.length){case 2:return i.encodeAddress(arguments[0],arguments[1]);case 4:return`${i.encodeAddress(arguments[0],arguments[1])}:${i.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(o,l){const[c,u,,d,h]=o,[f,g]=l;return f>=c&&f<=d&&g>=u&&g<=h}};n.exports=i},{}],20:[function(e,n,s){const a=(o,l)=>({...o,...l.reduce((c,u)=>(o[u]&&(c[u]={...o[u]}),c),{})}),i=function(o,l,c){let u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];o[c]&&(l[c]=a(o[c],u))};s.copyStyle=o=>{if(!o)return o;if(l=o,Object.keys(l).length===0)return{};var l;const c={...o};return i(o,c,"font",["color"]),i(o,c,"alignment"),i(o,c,"protection"),o.border&&(i(o,c,"border"),i(o.border,c.border,"top",["color"]),i(o.border,c.border,"left",["color"]),i(o.border,c.border,"bottom",["color"]),i(o.border,c.border,"right",["color"]),i(o.border,c.border,"diagonal",["color"])),o.fill&&(i(o,c,"fill",["fgColor","bgColor","center"]),o.fill.stops&&(c.fill.stops=o.fill.stops.map(u=>a(u,["color"])))),c}},{}],21:[function(e,n,s){(function(a){(function(){const i=e("crypto"),o={hash(l){const c=i.createHash(l);for(var u=arguments.length,d=new Array(u>1?u-1:0),h=1;h<u;h++)d[h-1]=arguments[h];return c.update(a.concat(d)),c.digest()},convertPasswordToHash(l,c,u,d){if(c=c.toLowerCase(),i.getHashes().indexOf(c)<0)throw new Error(`Hash algorithm '${c}' not supported!`);const h=a.from(l,"utf16le");let f=this.hash(c,a.from(u,"base64"),h);for(let g=0;g<d;g++){const m=a.alloc(4);m.writeUInt32LE(g,0),f=this.hash(c,f,m)}return f.toString("base64")},randomBytes:l=>i.randomBytes(l)};n.exports=o}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(e,n,s){const{SaxesParser:a}=e("saxes"),{PassThrough:i}=e("readable-stream"),{bufferToString:o}=e("./browser-buffer-decode");n.exports=async function*(l){l.pipe&&!l[Symbol.asyncIterator]&&(l=l.pipe(new i));const c=new a;let u;c.on("error",h=>{u=h});let d=[];c.on("opentag",h=>d.push({eventType:"opentag",value:h})),c.on("text",h=>d.push({eventType:"text",value:h})),c.on("closetag",h=>d.push({eventType:"closetag",value:h}));for await(const h of l){if(c.write(o(h)),u)throw u;yield d,d=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(e,n,s){const a=e("./col-cache"),i=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,o=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;n.exports={slideFormula:function(l,c,u){const d=a.decode(c),h=a.decode(u);return l.replace(i,(f,g,m,p,v)=>{if(v)return f;const b=o.exec(p);if(b){const y=b[1],k=b[2].toUpperCase(),N=b[3],L=b[4];if(k.length>3||k.length===3&&k>"XFD")return f;let F=a.l2n(k),R=parseInt(L,10);return y||(F+=h.col-d.col),N||(R+=h.row-d.row),(g||"")+(y||"")+a.n2l(F)+(N||"")+R}return f})}}},{"./col-cache":19}],24:[function(e,n,s){(function(a,i){(function(){const o=e("readable-stream"),l=e("./utils"),c=e("./string-buf");class u{constructor(p,v){this._data=p,this._encoding=v}get length(){return this.toBuffer().length}copy(p,v,b,y){return this.toBuffer().copy(p,v,b,y)}toBuffer(){return this._buffer||(this._buffer=i.from(this._data,this._encoding)),this._buffer}}class d{constructor(p){this._data=p}get length(){return this._data.length}copy(p,v,b,y){return this._data._buf.copy(p,v,b,y)}toBuffer(){return this._data.toBuffer()}}class h{constructor(p){this._data=p}get length(){return this._data.length}copy(p,v,b,y){this._data.copy(p,v,b,y)}toBuffer(){return this._data}}class f{constructor(p){this.size=p,this.buffer=i.alloc(p),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const p=i.alloc(this.iWrite-this.iRead);return this.buffer.copy(p,0,this.iRead,this.iWrite),p}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(p){let v;return p===0?null:p===void 0||p>=this.length?(v=this.toBuffer(),this.iRead=this.iWrite,v):(v=i.alloc(p),this.buffer.copy(v,0,this.iRead,p),this.iRead+=p,v)}write(p,v,b){const y=Math.min(b,this.size-this.iWrite);return p.copy(this.buffer,this.iWrite,v,v+y),this.iWrite+=y,y}}const g=function(m){m=m||{},this.bufSize=m.bufSize||1048576,this.buffers=[],this.batch=m.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};l.inherits(g,o.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return i.concat(this.buffers.map(m=>m.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const p=this.buffers[this.buffers.length-1];if(!p.full)return p}const m=new f(this.bufSize);return this.buffers.push(m),m},async _pipe(m){await Promise.all(this.pipes.map(function(p){return new Promise(v=>{p.write(m.toBuffer(),()=>{v()})})}))},_writeToBuffers(m){let p=0;const v=m.length;for(;p<v;)p+=this._getWritableBuffer().write(m,p,v-p)},async write(m,p,v){let b;if(p instanceof Function&&(v=p,p="utf8"),v=v||l.nop,m instanceof c)b=new d(m);else if(m instanceof i)b=new h(m);else{if(!(typeof m=="string"||m instanceof String||m instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");b=new u(m,p)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(b);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(b),a.nextTick(v)):(await this._pipe(b),v());else this.paused||this.emit("data",b.toBuffer()),this._writeToBuffers(b),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(m,p,v){const b=y=>{y?v(y):(this._flush(),this.pipes.forEach(k=>{k.end()}),this.emit("finish"))};m?this.write(m,p,b):b()},read(m){let p;if(m){for(p=[];m&&this.buffers.length&&!this.buffers[0].eod;){const v=this.buffers[0],b=v.read(m);m-=b.length,p.push(b),v.eod&&v.full&&this.buffers.shift()}return i.concat(p)}return p=this.buffers.map(v=>v.toBuffer()).filter(Boolean),this.buffers=[],i.concat(p)},setEncoding(m){this.encoding=m},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(m){this.pipes.push(m),!this.paused&&this.buffers.length&&this.end()},unpipe(m){this.pipes=this.pipes.filter(p=>p!==m)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),n.exports=g}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(e,n,s){(function(a){(function(){n.exports=class{constructor(i){this._buf=a.alloc(i&&i.size||16384),this._encoding=i&&i.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=a.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(i){i=i||0,this._buffer=void 0,this._inPos=i}_grow(i){let o=2*this._buf.length;for(;o<i;)o*=2;const l=a.alloc(o);this._buf.copy(l,0),this._buf=l}addText(i){this._buffer=void 0;let o=this._inPos+this._buf.write(i,this._inPos,this._encoding);for(;o>=this._buf.length-4;)this._grow(this._inPos+i.length),o=this._inPos+this._buf.write(i,this._inPos,this._encoding);this._inPos=o}addStringBuf(i){i.length&&(this._buffer=void 0,this.length+i.length>this.capacity&&this._grow(this.length+i.length),i._buf.copy(this._buf,this._inPos,0,i.length),this._inPos+=i.length)}}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],26:[function(e,n,s){const{toString:a}=Object.prototype,i=/["&<>]/,o={each:function(l,c){l&&(Array.isArray(l)?l.forEach(c):Object.keys(l).forEach(u=>{c(l[u],u)}))},some:function(l,c){return!!l&&(Array.isArray(l)?l.some(c):Object.keys(l).some(u=>c(l[u],u)))},every:function(l,c){return!l||(Array.isArray(l)?l.every(c):Object.keys(l).every(u=>c(l[u],u)))},map:function(l,c){return l?Array.isArray(l)?l.map(c):Object.keys(l).map(u=>c(l[u],u)):[]},keyBy:(l,c)=>l.reduce((u,d)=>(u[d[c]]=d,u),{}),isEqual:function(l,c){const u=typeof l,d=typeof c,h=Array.isArray(l),f=Array.isArray(c);let g;if(u!==d)return!1;switch(typeof l){case"object":if(h||f)return!(!h||!f)&&l.length===c.length&&l.every((m,p)=>{const v=c[p];return o.isEqual(m,v)});if(l===null||c===null)return l===c;if(g=Object.keys(l),Object.keys(c).length!==g.length)return!1;for(const m of g)if(!c.hasOwnProperty(m))return!1;return o.every(l,(m,p)=>{const v=c[p];return o.isEqual(m,v)});default:return l===c}},escapeHtml(l){const c=i.exec(l);if(!c)return l;let u="",d="",h=0,f=c.index;for(;f<l.length;f++){switch(l.charAt(f)){case'"':d="&quot;";break;case"&":d="&amp;";break;case"'":d="&apos;";break;case"<":d="&lt;";break;case">":d="&gt;";break;default:continue}h!==f&&(u+=l.substring(h,f)),h=f+1,u+=d}return h!==f?u+l.substring(h,f):u},strcmp:(l,c)=>l<c?-1:l>c?1:0,isUndefined:l=>a.call(l)==="[object Undefined]",isObject:l=>a.call(l)==="[object Object]",deepMerge(){const l=arguments[0]||{},{length:c}=arguments;let u,d,h;function f(g,m){u=l[m],h=Array.isArray(g),o.isObject(g)||h?(h?(h=!1,d=u&&Array.isArray(u)?u:[]):d=u&&o.isObject(u)?u:{},l[m]=o.deepMerge(d,g)):o.isUndefined(g)||(l[m]=g)}for(let g=0;g<c;g++)o.each(arguments[g],f);return l}};n.exports=o},{}],27:[function(e,n,s){(function(a,i){(function(){const o=e("fs"),l=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,c={nop(){},promiseImmediate:u=>new Promise(d=>{a.setImmediate?i(()=>{d(u)}):setTimeout(()=>{d(u)},1)}),inherits:function(u,d,h,f){u.super_=d,f||(f=h,h=null),h&&Object.keys(h).forEach(m=>{Object.defineProperty(u,m,Object.getOwnPropertyDescriptor(h,m))});const g={constructor:{value:u,enumerable:!1,writable:!1,configurable:!0}};f&&Object.keys(f).forEach(m=>{g[m]=Object.getOwnPropertyDescriptor(f,m)}),u.prototype=Object.create(d.prototype,g)},dateToExcel:(u,d)=>25569+u.getTime()/864e5-(d?1462:0),excelToDate(u,d){const h=Math.round(24*(u-25569+(d?1462:0))*3600*1e3);return new Date(h)},parsePath(u){const d=u.lastIndexOf("/");return{path:u.substring(0,d),name:u.substring(d+1)}},getRelsPath(u){const d=c.parsePath(u);return`${d.path}/_rels/${d.name}.rels`},xmlEncode(u){const d=l.exec(u);if(!d)return u;let h="",f="",g=0,m=d.index;for(;m<u.length;m++){const p=u.charCodeAt(m);switch(p){case 34:f="&quot;";break;case 38:f="&amp;";break;case 39:f="&apos;";break;case 60:f="&lt;";break;case 62:f="&gt;";break;case 127:f="";break;default:if(p<=31&&(p<=8||p>=11&&p!==13)){f="";break}continue}g!==m&&(h+=u.substring(g,m)),g=m+1,f&&(h+=f)}return g!==m?h+u.substring(g,m):h},xmlDecode:u=>u.replace(/&([a-z]*);/g,d=>{switch(d){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return d}}),validInt(u){const d=parseInt(u,10);return Number.isNaN(d)?0:d},isDateFmt(u){return u?(u=(u=u.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:u=>new Promise(d=>{o.access(u,o.constants.F_OK,h=>{d(!h)})})},toIsoDateString:u=>u.toIsoString().subsstr(0,10),parseBoolean:u=>u===!0||u==="true"||u===1||u==="1"};n.exports=c}).call(this)}).call(this,typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{},e("timers").setImmediate)},{fs:216,timers:523}],28:[function(e,n,s){const a=e("./under-dash"),i=e("./utils");function o(u,d,h){u.push(` ${d}="${i.xmlEncode(h.toString())}"`)}function l(u,d){if(d){const h=[];a.each(d,(f,g)=>{f!==void 0&&o(h,g,f)}),u.push(h.join(""))}}class c{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(d){const h=this._xml;h.push("<?xml"),l(h,d),h.push(`?>
`)}openNode(d,h){const f=this.tos,g=this._xml;f&&this.open&&g.push(">"),this._stack.push(d),g.push("<"),g.push(d),l(g,h),this.leaf=!0,this.open=!0}addAttribute(d,h){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");h!==void 0&&o(this._xml,d,h)}addAttributes(d){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");l(this._xml,d)}writeText(d){const h=this._xml;this.open&&(h.push(">"),this.open=!1),this.leaf=!1,h.push(i.xmlEncode(d.toString()))}writeXml(d){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(d)}closeNode(){const d=this._stack.pop(),h=this._xml;this.leaf?h.push("/>"):(h.push("</"),h.push(d),h.push(">")),this.open=!1,this.leaf=!1}leafNode(d,h,f){this.openNode(d,h),f!==void 0&&this.writeText(f),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const d=this._rollbacks.pop();this._xml.length>d.xml&&this._xml.splice(d.xml,this._xml.length-d.xml),this._stack.length>d.stack&&this._stack.splice(d.stack,this._stack.length-d.stack),this.leaf=d.leaf,this.open=d.open}get xml(){return this.closeAll(),this._xml.join("")}}c.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},n.exports=c},{"./under-dash":26,"./utils":27}],29:[function(e,n,s){(function(a){(function(){const i=e("events"),o=e("jszip"),l=e("./stream-buf"),{stringToBuffer:c}=e("./browser-buffer-encode");class u extends i.EventEmitter{constructor(h){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},h),this.zip=new o,this.stream=new l}append(h,f){f.hasOwnProperty("base64")&&f.base64?this.zip.file(f.name,h,{base64:!0}):(a.browser&&typeof h=="string"&&(h=c(h)),this.zip.file(f.name,h))}async finalize(){const h=await this.zip.generateAsync(this.options);this.stream.end(h),this.emit("finish")}read(h){return this.stream.read(h)}setEncoding(h){return this.stream.setEncoding(h)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(h,f){return this.stream.pipe(h,f)}unpipe(h){return this.stream.unpipe(h)}unshift(h){return this.stream.unshift(h)}wrap(h){return this.stream.wrap(h)}}n.exports={ZipWriter:u}}).call(this)}).call(this,e("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(e,n,s){n.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(e,n,s){n.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(e,n,s){const a=e("../../utils/parse-sax"),i=e("../../utils/xml-stream");class o{prepare(){}render(){}parseOpen(c){}parseText(c){}parseClose(c){}reconcile(c,u){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(c=>{c instanceof o?c.reset():c.xform&&c.xform.reset()})}mergeModel(c){this.model=Object.assign(this.model||{},c)}async parse(c){for await(const u of c)for(const{eventType:d,value:h}of u)if(d==="opentag")this.parseOpen(h);else if(d==="text")this.parseText(h);else if(d==="closetag"&&!this.parseClose(h.name))return this.model;return this.model}async parseStream(c){return this.parse(a(c))}get xml(){return this.toXml(this.model)}toXml(c){const u=new i;return this.render(u,c),u.xml}static toAttribute(c,u){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(c===void 0){if(d)return u}else if(d||c!==u)return c.toString()}static toStringAttribute(c,u){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return o.toAttribute(c,u,d)}static toStringValue(c,u){return c===void 0?u:c}static toBoolAttribute(c,u){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(c===void 0){if(d)return u}else if(d||c!==u)return c?"1":"0"}static toBoolValue(c,u){return c===void 0?u:c==="1"}static toIntAttribute(c,u){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return o.toAttribute(c,u,d)}static toIntValue(c,u){return c===void 0?u:parseInt(c,10)}static toFloatAttribute(c,u){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return o.toAttribute(c,u,d)}static toFloatValue(c,u){return c===void 0?u:parseFloat(c)}}n.exports=o},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(e,n,s){const a=e("../base-xform"),i=e("../../../utils/col-cache");function o(c){try{return i.decodeEx(c),!0}catch{return!1}}function l(c){const u=[];let d=!1,h="";return c.split(",").forEach(f=>{if(!f)return;const g=(f.match(/'/g)||[]).length;if(!g)return void(d?h+=f+",":o(f)&&u.push(f));const m=g%2==0;!d&&m&&o(f)?u.push(f):d&&!m?(d=!1,o(h+f)&&u.push(h+f),h=""):(d=!0,h+=f+",")}),u}n.exports=class extends a{render(c,u){c.openNode("definedName",{name:u.name,localSheetId:u.localSheetId}),c.writeText(u.ranges.join(",")),c.closeNode()}parseOpen(c){switch(c.name){case"definedName":return this._parsedName=c.attributes.name,this._parsedLocalSheetId=c.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(c){this._parsedText.push(c)}parseClose(){return this.model={name:this._parsedName,ranges:l(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(e,n,s){const a=e("../../../utils/utils"),i=e("../base-xform");n.exports=class extends i{render(o,l){o.leafNode("sheet",{sheetId:l.id,name:l.name,state:l.state,"r:id":l.rId})}parseOpen(o){return o.name==="sheet"&&(this.model={name:a.xmlDecode(o.attributes.name),id:parseInt(o.attributes.sheetId,10),state:o.attributes.state,rId:o.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{render(i,o){i.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:o.fullCalcOnLoad?1:void 0})}parseOpen(i){return i.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{render(i,o){i.leafNode("workbookPr",{date1904:o.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(i){return i.name==="workbookPr"&&(this.model={date1904:i.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{render(i,o){const l={xWindow:o.x||0,yWindow:o.y||0,windowWidth:o.width||12e3,windowHeight:o.height||24e3,firstSheet:o.firstSheet,activeTab:o.activeTab};o.visibility&&o.visibility!=="visible"&&(l.visibility=o.visibility),i.leafNode("workbookView",l)}parseOpen(i){if(i.name==="workbookView"){const o=this.model={},l=function(u,d,h){const f=d!==void 0?o[u]=d:h;f!==void 0&&(o[u]=f)},c=function(u,d,h){const f=d!==void 0?o[u]=parseInt(d,10):h;f!==void 0&&(o[u]=f)};return c("x",i.attributes.xWindow,0),c("y",i.attributes.yWindow,0),c("width",i.attributes.windowWidth,25e3),c("height",i.attributes.windowHeight,1e4),l("visibility",i.attributes.visibility,"visible"),c("activeTab",i.attributes.activeTab,void 0),c("firstSheet",i.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(e,n,s){const a=e("../../../utils/under-dash"),i=e("../../../utils/col-cache"),o=e("../../../utils/xml-stream"),l=e("../base-xform"),c=e("../static-xform"),u=e("../list-xform"),d=e("./defined-name-xform"),h=e("./sheet-xform"),f=e("./workbook-view-xform"),g=e("./workbook-properties-xform"),m=e("./workbook-calc-properties-xform");class p extends l{constructor(){super(),this.map={fileVersion:p.STATIC_XFORMS.fileVersion,workbookPr:new g,bookViews:new u({tag:"bookViews",count:!1,childXform:new f}),sheets:new u({tag:"sheets",count:!1,childXform:new h}),definedNames:new u({tag:"definedNames",count:!1,childXform:new d}),calcPr:new m}}prepare(b){b.sheets=b.worksheets;const y=[];let k=0;b.sheets.forEach(N=>{if(N.pageSetup&&N.pageSetup.printArea&&N.pageSetup.printArea.split("&&").forEach(L=>{const F=L.split(":"),R={name:"_xlnm.Print_Area",ranges:[`'${N.name}'!$${F[0]}:$${F[1]}`],localSheetId:k};y.push(R)}),N.pageSetup&&(N.pageSetup.printTitlesRow||N.pageSetup.printTitlesColumn)){const L=[];if(N.pageSetup.printTitlesColumn){const R=N.pageSetup.printTitlesColumn.split(":");L.push(`'${N.name}'!$${R[0]}:$${R[1]}`)}if(N.pageSetup.printTitlesRow){const R=N.pageSetup.printTitlesRow.split(":");L.push(`'${N.name}'!$${R[0]}:$${R[1]}`)}const F={name:"_xlnm.Print_Titles",ranges:L,localSheetId:k};y.push(F)}k++}),y.length&&(b.definedNames=b.definedNames.concat(y)),(b.media||[]).forEach((N,L)=>{N.name=N.type+(L+1)})}render(b,y){b.openXml(o.StdDocAttributes),b.openNode("workbook",p.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(b),this.map.workbookPr.render(b,y.properties),this.map.bookViews.render(b,y.views),this.map.sheets.render(b,y.sheets),this.map.definedNames.render(b,y.definedNames),this.map.calcPr.render(b,y.calcProperties),b.closeNode()}parseOpen(b){if(this.parser)return this.parser.parseOpen(b),!0;switch(b.name){case"workbook":return!0;default:return this.parser=this.map[b.name],this.parser&&this.parser.parseOpen(b),!0}}parseText(b){this.parser&&this.parser.parseText(b)}parseClose(b){if(this.parser)return this.parser.parseClose(b)||(this.parser=void 0),!0;switch(b){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(b){const y=(b.workbookRels||[]).reduce((R,B)=>(R[B.Id]=B,R),{}),k=[];let N,L=0;(b.sheets||[]).forEach(R=>{const B=y[R.rId];B&&(N=b.worksheetHash["xl/"+B.Target.replace(/^(\s|\/xl\/)+/,"")],N&&(N.name=R.name,N.id=R.id,N.state=R.state,k[L++]=N))});const F=[];a.each(b.definedNames,R=>{if(R.name==="_xlnm.Print_Area"){if(N=k[R.localSheetId],N){N.pageSetup||(N.pageSetup={});const B=i.decodeEx(R.ranges[0]);N.pageSetup.printArea=N.pageSetup.printArea?`${N.pageSetup.printArea}&&${B.dimensions}`:B.dimensions}}else if(R.name==="_xlnm.Print_Titles"){if(N=k[R.localSheetId],N){N.pageSetup||(N.pageSetup={});const B=R.ranges.join(","),q=/\$/g,V=/\$\d+:\$\d+/,I=B.match(V);if(I&&I.length){const E=I[0];N.pageSetup.printTitlesRow=E.replace(q,"")}const C=/\$[A-Z]+:\$[A-Z]+/,O=B.match(C);if(O&&O.length){const E=O[0];N.pageSetup.printTitlesColumn=E.replace(q,"")}}}else F.push(R)}),b.definedNames=F,b.media.forEach((R,B)=>{R.index=B})}}p.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},p.STATIC_XFORMS={fileVersion:new c({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},n.exports=p},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(e,n,s){const a=e("../strings/rich-text-xform"),i=e("../../../utils/utils"),o=e("../base-xform"),l=n.exports=function(c){this.model=c};i.inherits(l,o,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new a),this._richTextXform},render(c,u){u=u||this.model,c.openNode("comment",{ref:u.ref,authorId:0}),c.openNode("text"),u&&u.note&&u.note.texts&&u.note.texts.forEach(d=>{this.richTextXform.render(c,d)}),c.closeNode(),c.closeNode()},parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"comment":return this.model={type:"note",note:{texts:[]},...c.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(c),!0;default:return!1}},parseText(c){this.parser&&this.parser.parseText(c)},parseClose(c){switch(c){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(c),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(e,n,s){const a=e("../../../utils/xml-stream"),i=e("../../../utils/utils"),o=e("../base-xform"),l=e("./comment-xform"),c=n.exports=function(){this.map={comment:new l}};i.inherits(c,o,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(u,d){d=d||this.model,u.openXml(a.StdDocAttributes),u.openNode("comments",c.COMMENTS_ATTRIBUTES),u.openNode("authors"),u.leafNode("author",null,"Author"),u.closeNode(),u.openNode("commentList"),d.comments.forEach(h=>{this.map.comment.render(u,h)}),u.closeNode(),u.closeNode()},parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(u),!0;default:return!1}},parseText(u){this.parser&&this.parser.parseText(u)},parseClose(u){switch(u){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(e,n,s){const a=e("../../base-xform");n.exports=class extends a{constructor(i){super(),this._model=i}get tag(){return this._model&&this._model.tag}render(i,o,l){(o===l[2]||this.tag==="x:SizeWithCells"&&o===l[1])&&i.leafNode(this.tag)}parseOpen(i){switch(i.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(e,n,s){const a=e("../../base-xform");n.exports=class extends a{constructor(i){super(),this._model=i}get tag(){return this._model&&this._model.tag}render(i,o){i.leafNode(this.tag,null,o)}parseOpen(i){switch(i.name){case this.tag:return this.text="",!0;default:return!1}}parseText(i){this.text=i}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"x:Anchor"}getAnchorRect(i){const o=Math.floor(i.left),l=Math.floor(68*(i.left-o)),c=Math.floor(i.top),u=Math.floor(18*(i.top-c)),d=Math.floor(i.right),h=Math.floor(68*(i.right-d)),f=Math.floor(i.bottom);return[o,l,c,u,d,h,f,Math.floor(18*(i.bottom-f))]}getDefaultRect(i){const o=i.col,l=Math.max(i.row-2,0);return[o,6,l,14,o+2,2,l+4,16]}render(i,o){const l=o.anchor?this.getAnchorRect(o.anchor):this.getDefaultRect(o.refAddress);i.leafNode("x:Anchor",null,l.join(", "))}parseOpen(i){switch(i.name){case this.tag:return this.text="",!0;default:return!1}}parseText(i){this.text=i}parseClose(){return!1}}},{"../base-xform":32}],44:[function(e,n,s){const a=e("../base-xform"),i=e("./vml-anchor-xform"),o=e("./style/vml-protection-xform"),l=e("./style/vml-position-xform"),c=["twoCells","oneCells","absolute"];n.exports=class extends a{constructor(){super(),this.map={"x:Anchor":new i,"x:Locked":new o({tag:"x:Locked"}),"x:LockText":new o({tag:"x:LockText"}),"x:SizeWithCells":new l({tag:"x:SizeWithCells"}),"x:MoveWithCells":new l({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(u,d){const{protection:h,editAs:f}=d.note;u.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(u,f,c),this.map["x:SizeWithCells"].render(u,f,c),this.map["x:Anchor"].render(u,d),this.map["x:Locked"].render(u,h.locked),u.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(u,h.lockText),u.leafNode("x:Row",null,d.refAddress.row-1),u.leafNode("x:Column",null,d.refAddress.col-1),u.closeNode()}parseOpen(u){switch(u.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){const u=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),d=Object.keys(u).length;this.model.editAs=c[d],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(e,n,s){const a=e("../../../utils/xml-stream"),i=e("../base-xform"),o=e("./vml-shape-xform");class l extends i{constructor(){super(),this.map={"v:shape":new o}}get tag(){return"xml"}render(u,d){u.openXml(a.StdDocAttributes),u.openNode(this.tag,l.DRAWING_ATTRIBUTES),u.openNode("o:shapelayout",{"v:ext":"edit"}),u.leafNode("o:idmap",{"v:ext":"edit",data:1}),u.closeNode(),u.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),u.leafNode("v:stroke",{joinstyle:"miter"}),u.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),u.closeNode(),d.comments.forEach((h,f)=>{this.map["v:shape"].render(u,h,f)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}reconcile(u,d){u.anchors.forEach(h=>{h.br?this.map["xdr:twoCellAnchor"].reconcile(h,d):this.map["xdr:oneCellAnchor"].reconcile(h,d)})}}l.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},n.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(e,n,s){const a=e("../base-xform"),i=e("./vml-textbox-xform"),o=e("./vml-client-data-xform");class l extends a{constructor(){super(),this.map={"v:textbox":new i,"x:ClientData":new o}}get tag(){return"v:shape"}render(u,d,h){u.openNode("v:shape",l.V_SHAPE_ATTRIBUTES(d,h)),u.leafNode("v:fill",{color2:"infoBackground [80]"}),u.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),u.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(u,d),this.map["x:ClientData"].render(u,d),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={margins:{insetmode:u.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}}l.V_SHAPE_ATTRIBUTES=(c,u)=>({id:"_x0000_s"+(1025+u),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":c.note.margins&&c.note.margins.insetmode}),n.exports=l},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"v:textbox"}conversionUnit(i,o,l){return`${parseFloat(i)*o.toFixed(2)}${l}`}reverseConversionUnit(i){return(i||"").split(",").map(o=>Number(parseFloat(this.conversionUnit(parseFloat(o),.1,"")).toFixed(2)))}render(i,o){const l={style:"mso-direction-alt:auto"};if(o&&o.note){let{inset:c}=o.note&&o.note.margins;Array.isArray(c)&&(c=c.map(u=>this.conversionUnit(u,10,"mm")).join(",")),c&&(l.inset=c)}i.openNode("v:textbox",l),i.leafNode("div",{style:"text-align:left"}),i.closeNode()}parseOpen(i){switch(i.name){case this.tag:return this.model={inset:this.reverseConversionUnit(i.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(i){switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],48:[function(e,n,s){const a=e("./base-xform");n.exports=class extends a{createNewModel(i){return{}}parseOpen(i){return this.parser=this.parser||this.map[i.name],this.parser?(this.parser.parseOpen(i),!0):i.name===this.tag&&(this.model=this.createNewModel(i),!0)}parseText(i){this.parser&&this.parser.parseText(i)}onParserClose(i,o){this.model[i]=o.model}parseClose(i){return this.parser?(this.parser.parseClose(i)||(this.onParserClose(i,this.parser),this.parser=void 0),!0):i!==this.tag}}},{"./base-xform":32}],49:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{render(i,o){i.openNode("HeadingPairs"),i.openNode("vt:vector",{size:2,baseType:"variant"}),i.openNode("vt:variant"),i.leafNode("vt:lpstr",void 0,"Worksheets"),i.closeNode(),i.openNode("vt:variant"),i.leafNode("vt:i4",void 0,o.length),i.closeNode(),i.closeNode(),i.closeNode()}parseOpen(i){return i.name==="HeadingPairs"}parseText(){}parseClose(i){return i!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{render(i,o){i.openNode("TitlesOfParts"),i.openNode("vt:vector",{size:o.length,baseType:"lpstr"}),o.forEach(l=>{i.leafNode("vt:lpstr",void 0,l.name)}),i.closeNode(),i.closeNode()}parseOpen(i){return i.name==="TitlesOfParts"}parseText(){}parseClose(i){return i!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(e,n,s){const a=e("../../../utils/xml-stream"),i=e("../base-xform"),o=e("../simple/string-xform"),l=e("./app-heading-pairs-xform"),c=e("./app-titles-of-parts-xform");class u extends i{constructor(){super(),this.map={Company:new o({tag:"Company"}),Manager:new o({tag:"Manager"}),HeadingPairs:new l,TitleOfParts:new c}}render(h,f){h.openXml(a.StdDocAttributes),h.openNode("Properties",u.PROPERTY_ATTRIBUTES),h.leafNode("Application",void 0,"Microsoft Excel"),h.leafNode("DocSecurity",void 0,"0"),h.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(h,f.worksheets),this.map.TitleOfParts.render(h,f.worksheets),this.map.Company.render(h,f.company||""),this.map.Manager.render(h,f.manager),h.leafNode("LinksUpToDate",void 0,"false"),h.leafNode("SharedDoc",void 0,"false"),h.leafNode("HyperlinksChanged",void 0,"false"),h.leafNode("AppVersion",void 0,"16.0300"),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"Properties":return!0;default:return this.parser=this.map[h.name],!!this.parser&&(this.parser.parseOpen(h),!0)}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}u.DateFormat=function(d){return d.toISOString().replace(/[.]\d{3,6}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(e,n,s){const a=e("../../../utils/xml-stream"),i=e("../base-xform");class o extends i{render(c,u){c.openXml(a.StdDocAttributes),c.openNode("Types",o.PROPERTY_ATTRIBUTES);const d={};(u.media||[]).forEach(h=>{if(h.type==="image"){const f=h.extension;d[f]||(d[f]=!0,c.leafNode("Default",{Extension:f,ContentType:"image/"+f}))}}),c.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),c.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),c.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),u.worksheets.forEach(h=>{const f=`/xl/worksheets/sheet${h.id}.xml`;c.leafNode("Override",{PartName:f,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),c.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),c.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),u.sharedStrings&&u.sharedStrings.count&&c.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),u.tables&&u.tables.forEach(h=>{c.leafNode("Override",{PartName:"/xl/tables/"+h.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),u.drawings&&u.drawings.forEach(h=>{c.leafNode("Override",{PartName:`/xl/drawings/${h.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),u.commentRefs&&(c.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),u.commentRefs.forEach(h=>{let{commentName:f}=h;c.leafNode("Override",{PartName:`/xl/${f}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),c.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),c.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),c.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}o.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},n.exports=o},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(e,n,s){const a=e("../../../utils/xml-stream"),i=e("../base-xform"),o=e("../simple/date-xform"),l=e("../simple/string-xform"),c=e("../simple/integer-xform");class u extends i{constructor(){super(),this.map={"dc:creator":new l({tag:"dc:creator"}),"dc:title":new l({tag:"dc:title"}),"dc:subject":new l({tag:"dc:subject"}),"dc:description":new l({tag:"dc:description"}),"dc:identifier":new l({tag:"dc:identifier"}),"dc:language":new l({tag:"dc:language"}),"cp:keywords":new l({tag:"cp:keywords"}),"cp:category":new l({tag:"cp:category"}),"cp:lastModifiedBy":new l({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new o({tag:"cp:lastPrinted",format:u.DateFormat}),"cp:revision":new c({tag:"cp:revision"}),"cp:version":new l({tag:"cp:version"}),"cp:contentStatus":new l({tag:"cp:contentStatus"}),"cp:contentType":new l({tag:"cp:contentType"}),"dcterms:created":new o({tag:"dcterms:created",attrs:u.DateAttrs,format:u.DateFormat}),"dcterms:modified":new o({tag:"dcterms:modified",attrs:u.DateAttrs,format:u.DateFormat})}}render(h,f){h.openXml(a.StdDocAttributes),h.openNode("cp:coreProperties",u.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(h,f.creator),this.map["dc:title"].render(h,f.title),this.map["dc:subject"].render(h,f.subject),this.map["dc:description"].render(h,f.description),this.map["dc:identifier"].render(h,f.identifier),this.map["dc:language"].render(h,f.language),this.map["cp:keywords"].render(h,f.keywords),this.map["cp:category"].render(h,f.category),this.map["cp:lastModifiedBy"].render(h,f.lastModifiedBy),this.map["cp:lastPrinted"].render(h,f.lastPrinted),this.map["cp:revision"].render(h,f.revision),this.map["cp:version"].render(h,f.version),this.map["cp:contentStatus"].render(h,f.contentStatus),this.map["cp:contentType"].render(h,f.contentType),this.map["dcterms:created"].render(h,f.created),this.map["dcterms:modified"].render(h,f.modified),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[h.name],this.parser)return this.parser.parseOpen(h),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(h))}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+h)}}}u.DateFormat=function(d){return d.toISOString().replace(/[.]\d{3}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{render(i,o){i.leafNode("Relationship",o)}parseOpen(i){switch(i.name){case"Relationship":return this.model=i.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(e,n,s){const a=e("../../../utils/xml-stream"),i=e("../base-xform"),o=e("./relationship-xform");class l extends i{constructor(){super(),this.map={Relationship:new o}}render(u,d){d=d||this._values,u.openXml(a.StdDocAttributes),u.openNode("Relationships",l.RELATIONSHIPS_ATTRIBUTES),d.forEach(h=>{this.map.Relationship.render(u,h)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[u.name],this.parser)return this.parser.parseOpen(u),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(u){case"Relationships":return!1;default:throw new Error("Unexpected xml node in parseClose: "+u)}}}l.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},n.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case this.tag:this.reset(),this.model={range:{editAs:i.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[i.name],this.parser&&this.parser.parseOpen(i)}return!0}parseText(i){this.parser&&this.parser.parseText(i)}reconcilePicture(i,o){if(i&&i.rId){const l=o.rels[i.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(l){const c=l[1],u=o.mediaIndex[c];return o.media[u]}}}}},{"../base-xform":32}],57:[function(e,n,s){const a=e("../base-xform"),i=e("./blip-xform");n.exports=class extends a{constructor(){super(),this.map={"a:blip":new i}}get tag(){return"xdr:blipFill"}render(o,l){o.openNode(this.tag),this.map["a:blip"].render(o,l),o.openNode("a:stretch"),o.leafNode("a:fillRect"),o.closeNode(),o.closeNode()}parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case this.tag:this.reset();break;default:this.parser=this.map[o.name],this.parser&&this.parser.parseOpen(o)}return!0}parseText(){}parseClose(o){if(this.parser)return this.parser.parseClose(o)||(this.parser=void 0),!0;switch(o){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}}},{"../base-xform":32,"./blip-xform":58}],58:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"a:blip"}render(i,o){i.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":o.rId,cstate:"print"})}parseOpen(i){switch(i.name){case this.tag:return this.model={rId:i.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(i){switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],59:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"xdr:cNvPicPr"}render(i){i.openNode(this.tag),i.leafNode("a:picLocks",{noChangeAspect:"1"}),i.closeNode()}parseOpen(i){switch(i.name){case this.tag:default:return!0}}parseText(){}parseClose(i){switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],60:[function(e,n,s){const a=e("../base-xform"),i=e("./hlink-click-xform"),o=e("./ext-lst-xform");n.exports=class extends a{constructor(){super(),this.map={"a:hlinkClick":new i,"a:extLst":new o}}get tag(){return"xdr:cNvPr"}render(l,c){l.openNode(this.tag,{id:c.index,name:"Picture "+c.index}),this.map["a:hlinkClick"].render(l,c),this.map["a:extLst"].render(l,c),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(e,n,s){const a=e("../base-xform"),i=e("../simple/integer-xform");n.exports=class extends a{constructor(o){super(),this.tag=o.tag,this.map={"xdr:col":new i({tag:"xdr:col",zero:!0}),"xdr:colOff":new i({tag:"xdr:colOff",zero:!0}),"xdr:row":new i({tag:"xdr:row",zero:!0}),"xdr:rowOff":new i({tag:"xdr:rowOff",zero:!0})}}render(o,l){o.openNode(this.tag),this.map["xdr:col"].render(o,l.nativeCol),this.map["xdr:colOff"].render(o,l.nativeColOff),this.map["xdr:row"].render(o,l.nativeRow),this.map["xdr:rowOff"].render(o,l.nativeRowOff),o.closeNode()}parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case this.tag:this.reset();break;default:this.parser=this.map[o.name],this.parser&&this.parser.parseOpen(o)}return!0}parseText(o){this.parser&&this.parser.parseText(o)}parseClose(o){if(this.parser)return this.parser.parseClose(o)||(this.parser=void 0),!0;switch(o){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(e,n,s){const a=e("../../../utils/col-cache"),i=e("../../../utils/xml-stream"),o=e("../base-xform"),l=e("./two-cell-anchor-xform"),c=e("./one-cell-anchor-xform");class u extends o{constructor(){super(),this.map={"xdr:twoCellAnchor":new l,"xdr:oneCellAnchor":new c}}prepare(h){h.anchors.forEach((f,g)=>{f.anchorType=function(m){return(typeof m.range=="string"?a.decode(m.range):m.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}(f),this.map[f.anchorType].prepare(f,{index:g})})}get tag(){return"xdr:wsDr"}render(h,f){h.openXml(i.StdDocAttributes),h.openNode(this.tag,u.DRAWING_ATTRIBUTES),f.anchors.forEach(g=>{this.map[g.anchorType].render(h,g)}),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)}return!0}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(h){case this.tag:return!1;default:return!0}}reconcile(h,f){h.anchors.forEach(g=>{g.br?this.map["xdr:twoCellAnchor"].reconcile(g,f):this.map["xdr:oneCellAnchor"].reconcile(g,f)})}}u.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},n.exports=u},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"a:extLst"}render(i){i.openNode(this.tag),i.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),i.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),i.closeNode(),i.closeNode()}parseOpen(i){switch(i.name){case this.tag:default:return!0}}parseText(){}parseClose(i){switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],64:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{constructor(i){super(),this.tag=i.tag,this.map={}}render(i,o){i.openNode(this.tag);const l=Math.floor(9525*o.width),c=Math.floor(9525*o.height);i.addAttribute("cx",l),i.addAttribute("cy",c),i.closeNode()}parseOpen(i){return i.name===this.tag&&(this.model={width:parseInt(i.attributes.cx||"0",10)/9525,height:parseInt(i.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"a:hlinkClick"}render(i,o){o.hyperlinks&&o.hyperlinks.rId&&i.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":o.hyperlinks.rId,tooltip:o.hyperlinks.tooltip})}parseOpen(i){switch(i.name){case this.tag:return this.model={hyperlinks:{rId:i.attributes["r:id"],tooltip:i.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(e,n,s){const a=e("../base-xform"),i=e("./c-nv-pr-xform"),o=e("./c-nv-pic-pr-xform");n.exports=class extends a{constructor(){super(),this.map={"xdr:cNvPr":new i,"xdr:cNvPicPr":new o}}get tag(){return"xdr:nvPicPr"}render(l,c){l.openNode(this.tag),this.map["xdr:cNvPr"].render(l,c),this.map["xdr:cNvPicPr"].render(l,c),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(e,n,s){const a=e("./base-cell-anchor-xform"),i=e("../static-xform"),o=e("./cell-position-xform"),l=e("./ext-xform"),c=e("./pic-xform");n.exports=class extends a{constructor(){super(),this.map={"xdr:from":new o({tag:"xdr:from"}),"xdr:ext":new l({tag:"xdr:ext"}),"xdr:pic":new c,"xdr:clientData":new i({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(u,d){this.map["xdr:pic"].prepare(u.picture,d)}render(u,d){u.openNode(this.tag,{editAs:d.range.editAs||"oneCell"}),this.map["xdr:from"].render(u,d.range.tl),this.map["xdr:ext"].render(u,d.range.ext),this.map["xdr:pic"].render(u,d.picture),this.map["xdr:clientData"].render(u,{}),u.closeNode()}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(u,d){u.medium=this.reconcilePicture(u.picture,d)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(e,n,s){const a=e("../base-xform"),i=e("../static-xform"),o=e("./blip-fill-xform"),l=e("./nv-pic-pr-xform"),c=e("./sp-pr");n.exports=class extends a{constructor(){super(),this.map={"xdr:nvPicPr":new l,"xdr:blipFill":new o,"xdr:spPr":new i(c)}}get tag(){return"xdr:pic"}prepare(u,d){u.index=d.index+1}render(u,d){u.openNode(this.tag),this.map["xdr:nvPicPr"].render(u,d),this.map["xdr:blipFill"].render(u,d),this.map["xdr:spPr"].render(u,d),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(e,n,s){n.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(e,n,s){const a=e("./base-cell-anchor-xform"),i=e("../static-xform"),o=e("./cell-position-xform"),l=e("./pic-xform");n.exports=class extends a{constructor(){super(),this.map={"xdr:from":new o({tag:"xdr:from"}),"xdr:to":new o({tag:"xdr:to"}),"xdr:pic":new l,"xdr:clientData":new i({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(c,u){this.map["xdr:pic"].prepare(c.picture,u)}render(c,u){c.openNode(this.tag,{editAs:u.range.editAs||"oneCell"}),this.map["xdr:from"].render(c,u.range.tl),this.map["xdr:to"].render(c,u.range.br),this.map["xdr:pic"].render(c,u.picture),this.map["xdr:clientData"].render(c,{}),c.closeNode()}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(c,u){c.medium=this.reconcilePicture(c.picture,u)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(e,n,s){const a=e("./base-xform");n.exports=class extends a{constructor(i){super(),this.tag=i.tag,this.always=!!i.always,this.count=i.count,this.empty=i.empty,this.$count=i.$count||"count",this.$=i.$,this.childXform=i.childXform,this.maxItems=i.maxItems}prepare(i,o){const{childXform:l}=this;i&&i.forEach((c,u)=>{o.index=u,l.prepare(c,o)})}render(i,o){if(this.always||o&&o.length){i.openNode(this.tag,this.$),this.count&&i.addAttribute(this.$count,o&&o.length||0);const{childXform:l}=this;(o||[]).forEach((c,u)=>{l.render(i,c,u)}),i.closeNode()}else this.empty&&i.leafNode(this.tag)}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(i)&&(this.parser=this.childXform,!0)}}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser){if(!this.parser.parseClose(i)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(i,o){if(i){const{childXform:l}=this;i.forEach(c=>{l.reconcile(c,o)})}}}},{"./base-xform":32}],72:[function(e,n,s){const a=e("../../../utils/col-cache"),i=e("../base-xform");n.exports=class extends i{get tag(){return"autoFilter"}render(o,l){if(l)if(typeof l=="string")o.leafNode("autoFilter",{ref:l});else{const c=function(h){return typeof h=="string"?h:a.getAddress(h.row,h.column).address},u=c(l.from),d=c(l.to);u&&d&&o.leafNode("autoFilter",{ref:`${u}:${d}`})}}parseOpen(o){o.name==="autoFilter"&&(this.model=o.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(e,n,s){const a=e("../../../utils/utils"),i=e("../base-xform"),o=e("../../../doc/range"),l=e("../../../doc/enums"),c=e("../strings/rich-text-xform");function u(d){if(d==null)return l.ValueType.Null;if(d instanceof String||typeof d=="string")return l.ValueType.String;if(typeof d=="number")return l.ValueType.Number;if(typeof d=="boolean")return l.ValueType.Boolean;if(d instanceof Date)return l.ValueType.Date;if(d.text&&d.hyperlink)return l.ValueType.Hyperlink;if(d.formula)return l.ValueType.Formula;if(d.error)return l.ValueType.Error;throw new Error("I could not understand type of value")}n.exports=class extends i{constructor(){super(),this.richTextXForm=new c}get tag(){return"c"}prepare(d,h){const f=h.styles.addStyleModel(d.style||{},function(g){switch(g.type){case l.ValueType.Formula:return u(g.result);default:return g.type}}(d));switch(f&&(d.styleId=f),d.comment&&h.comments.push({...d.comment,ref:d.address}),d.type){case l.ValueType.String:case l.ValueType.RichText:h.sharedStrings&&(d.ssId=h.sharedStrings.add(d.value));break;case l.ValueType.Date:h.date1904&&(d.date1904=!0);break;case l.ValueType.Hyperlink:h.sharedStrings&&d.text!==void 0&&d.text!==null&&(d.ssId=h.sharedStrings.add(d.text)),h.hyperlinks.push({address:d.address,target:d.hyperlink,tooltip:d.tooltip});break;case l.ValueType.Merge:h.merges.add(d);break;case l.ValueType.Formula:if(h.date1904&&(d.date1904=!0),d.shareType==="shared"&&(d.si=h.siFormulae++),d.formula)h.formulae[d.address]=d;else if(d.sharedFormula){const g=h.formulae[d.sharedFormula];if(!g)throw new Error("Shared Formula master must exist above and or left of clone for cell "+d.address);g.si===void 0?(g.shareType="shared",g.si=h.siFormulae++,g.range=new o(g.address,d.address)):g.range&&g.range.expandToAddress(d.address),d.si=g.si}}}renderFormula(d,h){let f=null;switch(h.shareType){case"shared":f={t:"shared",ref:h.ref||h.range.range,si:h.si};break;case"array":f={t:"array",ref:h.ref};break;default:h.si!==void 0&&(f={t:"shared",si:h.si})}switch(u(h.result)){case l.ValueType.Null:d.leafNode("f",f,h.formula);break;case l.ValueType.String:d.addAttribute("t","str"),d.leafNode("f",f,h.formula),d.leafNode("v",null,h.result);break;case l.ValueType.Number:d.leafNode("f",f,h.formula),d.leafNode("v",null,h.result);break;case l.ValueType.Boolean:d.addAttribute("t","b"),d.leafNode("f",f,h.formula),d.leafNode("v",null,h.result?1:0);break;case l.ValueType.Error:d.addAttribute("t","e"),d.leafNode("f",f,h.formula),d.leafNode("v",null,h.result.error);break;case l.ValueType.Date:d.leafNode("f",f,h.formula),d.leafNode("v",null,a.dateToExcel(h.result,h.date1904));break;default:throw new Error("I could not understand type of value")}}render(d,h){if(h.type!==l.ValueType.Null||h.styleId){switch(d.openNode("c"),d.addAttribute("r",h.address),h.styleId&&d.addAttribute("s",h.styleId),h.type){case l.ValueType.Null:break;case l.ValueType.Number:d.leafNode("v",null,h.value);break;case l.ValueType.Boolean:d.addAttribute("t","b"),d.leafNode("v",null,h.value?"1":"0");break;case l.ValueType.Error:d.addAttribute("t","e"),d.leafNode("v",null,h.value.error);break;case l.ValueType.String:case l.ValueType.RichText:h.ssId!==void 0?(d.addAttribute("t","s"),d.leafNode("v",null,h.ssId)):h.value&&h.value.richText?(d.addAttribute("t","inlineStr"),d.openNode("is"),h.value.richText.forEach(f=>{this.richTextXForm.render(d,f)}),d.closeNode("is")):(d.addAttribute("t","str"),d.leafNode("v",null,h.value));break;case l.ValueType.Date:d.leafNode("v",null,a.dateToExcel(h.value,h.date1904));break;case l.ValueType.Hyperlink:h.ssId!==void 0?(d.addAttribute("t","s"),d.leafNode("v",null,h.ssId)):(d.addAttribute("t","str"),d.leafNode("v",null,h.text));break;case l.ValueType.Formula:this.renderFormula(d,h);break;case l.ValueType.Merge:}d.closeNode()}}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"c":return this.model={address:d.attributes.r},this.t=d.attributes.t,d.attributes.s&&(this.model.styleId=parseInt(d.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=d.attributes.si,this.model.shareType=d.attributes.t,this.model.ref=d.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){if(this.parser)this.parser.parseText(d);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+d:d;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+d:d:this.model.value=this.model.value?this.model.value+d:d}}parseClose(d){switch(d){case"c":{const{model:h}=this;if(h.formula||h.shareType)h.type=l.ValueType.Formula,h.value&&(this.t==="str"?h.result=a.xmlDecode(h.value):this.t==="b"?h.result=parseInt(h.value,10)!==0:this.t==="e"?h.result={error:h.value}:h.result=parseFloat(h.value),h.value=void 0);else if(h.value!==void 0)switch(this.t){case"s":h.type=l.ValueType.String,h.value=parseInt(h.value,10);break;case"str":h.type=l.ValueType.String,h.value=a.xmlDecode(h.value);break;case"inlineStr":h.type=l.ValueType.String;break;case"b":h.type=l.ValueType.Boolean,h.value=parseInt(h.value,10)!==0;break;case"e":h.type=l.ValueType.Error,h.value={error:h.value};break;default:h.type=l.ValueType.Number,h.value=parseFloat(h.value)}else h.styleId?h.type=l.ValueType.Null:h.type=l.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(d),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(d),!0)}}reconcile(d,h){const f=d.styleId&&h.styles&&h.styles.getStyleModel(d.styleId);switch(f&&(d.style=f),d.styleId!==void 0&&(d.styleId=void 0),d.type){case l.ValueType.String:typeof d.value=="number"&&h.sharedStrings&&(d.value=h.sharedStrings.getString(d.value)),d.value.richText&&(d.type=l.ValueType.RichText);break;case l.ValueType.Number:f&&a.isDateFmt(f.numFmt)&&(d.type=l.ValueType.Date,d.value=a.excelToDate(d.value,h.date1904));break;case l.ValueType.Formula:d.result!==void 0&&f&&a.isDateFmt(f.numFmt)&&(d.result=a.excelToDate(d.result,h.date1904)),d.shareType==="shared"&&(d.ref?h.formulae[d.si]=d.address:(d.sharedFormula=h.formulae[d.si],delete d.shareType),delete d.si)}const g=h.hyperlinkMap[d.address];g&&(d.type===l.ValueType.Formula?(d.text=d.result,d.result=void 0):(d.text=d.value,d.value=void 0),d.type=l.ValueType.Hyperlink,d.hyperlink=g);const m=h.commentsMap&&h.commentsMap[d.address];m&&(d.comment=m)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(e,n,s){const a=e("../../base-xform");n.exports=class extends a{get tag(){return"x14:cfIcon"}render(i,o){i.leafNode(this.tag,{iconSet:o.iconSet,iconId:o.iconId})}parseOpen(i){let{attributes:o}=i;this.model={iconSet:o.iconSet,iconId:a.toIntValue(o.iconId)}}parseClose(i){return i!==this.tag}}},{"../../base-xform":32}],75:[function(e,n,s){const{v4:a}=e("uuid"),i=e("../../base-xform"),o=e("../../composite-xform"),l=e("./databar-ext-xform"),c=e("./icon-set-ext-xform"),u={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class d extends o{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new l,"x14:iconSet":this.iconSetXform=new c}}get tag(){return"x14:cfRule"}static isExt(f){return f.type==="dataBar"?l.isExt(f):!(f.type!=="iconSet"||!f.custom&&!u[f.iconSet])}prepare(f){d.isExt(f)&&(f.x14Id=`{${a()}}`.toUpperCase())}render(f,g){if(d.isExt(g))switch(g.type){case"dataBar":this.renderDataBar(f,g);break;case"iconSet":this.renderIconSet(f,g)}}renderDataBar(f,g){f.openNode(this.tag,{type:"dataBar",id:g.x14Id}),this.databarXform.render(f,g),f.closeNode()}renderIconSet(f,g){f.openNode(this.tag,{type:"iconSet",priority:g.priority,id:g.x14Id||`{${a()}}`}),this.iconSetXform.render(f,g),f.closeNode()}createNewModel(f){let{attributes:g}=f;return{type:g.type,x14Id:g.id,priority:i.toIntValue(g.priority)}}onParserClose(f,g){Object.assign(this.model,g.model)}}n.exports=d},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(e,n,s){const a=e("../../composite-xform"),i=e("./f-ext-xform");n.exports=class extends a{constructor(){super(),this.map={"xm:f":this.fExtXform=new i}}get tag(){return"x14:cfvo"}render(o,l){o.openNode(this.tag,{type:l.type}),l.value!==void 0&&this.fExtXform.render(o,l.value),o.closeNode()}createNewModel(o){return{type:o.attributes.type}}onParserClose(o,l){switch(o){case"xm:f":this.model.value=l.model?parseFloat(l.model):0}}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(e,n,s){const a=e("../../composite-xform"),i=e("./sqref-ext-xform"),o=e("./cf-rule-ext-xform");n.exports=class extends a{constructor(){super(),this.map={"xm:sqref":this.sqRef=new i,"x14:cfRule":this.cfRule=new o}}get tag(){return"x14:conditionalFormatting"}prepare(l,c){l.rules.forEach(u=>{this.cfRule.prepare(u,c)})}render(l,c){c.rules.some(o.isExt)&&(l.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),c.rules.filter(o.isExt).forEach(u=>this.cfRule.render(l,u)),this.sqRef.render(l,c.ref),l.closeNode())}createNewModel(){return{rules:[]}}onParserClose(l,c){switch(l){case"xm:sqref":this.model.ref=c.model;break;case"x14:cfRule":this.model.rules.push(c.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(e,n,s){const a=e("../../composite-xform"),i=e("./cf-rule-ext-xform"),o=e("./conditional-formatting-ext-xform");n.exports=class extends a{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new o}}get tag(){return"x14:conditionalFormattings"}hasContent(l){return l.hasExtContent===void 0&&(l.hasExtContent=l.some(c=>c.rules.some(i.isExt))),l.hasExtContent}prepare(l,c){l.forEach(u=>{this.cfXform.prepare(u,c)})}render(l,c){this.hasContent(c)&&(l.openNode(this.tag),c.forEach(u=>this.cfXform.render(l,u)),l.closeNode())}createNewModel(){return[]}onParserClose(l,c){this.model.push(c.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(e,n,s){const a=e("../../base-xform"),i=e("../../composite-xform"),o=e("../../style/color-xform"),l=e("./cfvo-ext-xform");n.exports=class extends i{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new l,"x14:borderColor":this.borderColorXform=new o("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new o("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new o("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new o("x14:axisColor")}}static isExt(c){return!c.gradient}get tag(){return"x14:dataBar"}render(c,u){c.openNode(this.tag,{minLength:a.toIntAttribute(u.minLength,0,!0),maxLength:a.toIntAttribute(u.maxLength,100,!0),border:a.toBoolAttribute(u.border,!1),gradient:a.toBoolAttribute(u.gradient,!0),negativeBarColorSameAsPositive:a.toBoolAttribute(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:a.toBoolAttribute(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:a.toAttribute(u.axisPosition,"auto"),direction:a.toAttribute(u.direction,"leftToRight")}),u.cfvo.forEach(d=>{this.cfvoXform.render(c,d)}),this.borderColorXform.render(c,u.borderColor),this.negativeBorderColorXform.render(c,u.negativeBorderColor),this.negativeFillColorXform.render(c,u.negativeFillColor),this.axisColorXform.render(c,u.axisColor),c.closeNode()}createNewModel(c){let{attributes:u}=c;return{cfvo:[],minLength:a.toIntValue(u.minLength,0),maxLength:a.toIntValue(u.maxLength,100),border:a.toBoolValue(u.border,!1),gradient:a.toBoolValue(u.gradient,!0),negativeBarColorSameAsPositive:a.toBoolValue(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:a.toBoolValue(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:a.toStringValue(u.axisPosition,"auto"),direction:a.toStringValue(u.direction,"leftToRight")}}onParserClose(c,u){const[,d]=c.split(":");switch(d){case"cfvo":this.model.cfvo.push(u.model);break;default:this.model[d]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(e,n,s){const a=e("../../base-xform");n.exports=class extends a{get tag(){return"xm:f"}render(i,o){i.leafNode(this.tag,null,o)}parseOpen(){this.model=""}parseText(i){this.model+=i}parseClose(i){return i!==this.tag}}},{"../../base-xform":32}],81:[function(e,n,s){const a=e("../../base-xform"),i=e("../../composite-xform"),o=e("./cfvo-ext-xform"),l=e("./cf-icon-ext-xform");n.exports=class extends i{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new o,"x14:cfIcon":this.cfIconXform=new l}}get tag(){return"x14:iconSet"}render(c,u){c.openNode(this.tag,{iconSet:a.toStringAttribute(u.iconSet),reverse:a.toBoolAttribute(u.reverse,!1),showValue:a.toBoolAttribute(u.showValue,!0),custom:a.toBoolAttribute(u.icons,!1)}),u.cfvo.forEach(d=>{this.cfvoXform.render(c,d)}),u.icons&&u.icons.forEach((d,h)=>{d.iconId=h,this.cfIconXform.render(c,d)}),c.closeNode()}createNewModel(c){let{attributes:u}=c;return{cfvo:[],iconSet:a.toStringValue(u.iconSet,"3TrafficLights"),reverse:a.toBoolValue(u.reverse,!1),showValue:a.toBoolValue(u.showValue,!0)}}onParserClose(c,u){const[,d]=c.split(":");switch(d){case"cfvo":this.model.cfvo.push(u.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(u.model);break;default:this.model[d]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(e,n,s){const a=e("../../base-xform");n.exports=class extends a{get tag(){return"xm:sqref"}render(i,o){i.leafNode(this.tag,null,o)}parseOpen(){this.model=""}parseText(i){this.model+=i}parseClose(i){return i!==this.tag}}},{"../../base-xform":32}],83:[function(e,n,s){const a=e("../../base-xform"),i=e("../../composite-xform"),o=e("../../../../doc/range"),l=e("./databar-xform"),c=e("./ext-lst-ref-xform"),u=e("./formula-xform"),d=e("./color-scale-xform"),h=e("./icon-set-xform"),f={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},g=p=>{const{type:v,operator:b}=p;switch(v){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:v};default:return{type:v,operator:b}}};class m extends i{constructor(){super(),this.map={dataBar:this.databarXform=new l,extLst:this.extLstRefXform=new c,formula:this.formulaXform=new u,colorScale:this.colorScaleXform=new d,iconSet:this.iconSetXform=new h}}get tag(){return"cfRule"}static isPrimitive(v){return v.type!=="iconSet"||!v.custom&&!f[v.iconSet]}render(v,b){switch(b.type){case"expression":this.renderExpression(v,b);break;case"cellIs":this.renderCellIs(v,b);break;case"top10":this.renderTop10(v,b);break;case"aboveAverage":this.renderAboveAverage(v,b);break;case"dataBar":this.renderDataBar(v,b);break;case"colorScale":this.renderColorScale(v,b);break;case"iconSet":this.renderIconSet(v,b);break;case"containsText":this.renderText(v,b);break;case"timePeriod":this.renderTimePeriod(v,b)}}renderExpression(v,b){v.openNode(this.tag,{type:"expression",dxfId:b.dxfId,priority:b.priority}),this.formulaXform.render(v,b.formulae[0]),v.closeNode()}renderCellIs(v,b){v.openNode(this.tag,{type:"cellIs",dxfId:b.dxfId,priority:b.priority,operator:b.operator}),b.formulae.forEach(y=>{this.formulaXform.render(v,y)}),v.closeNode()}renderTop10(v,b){v.leafNode(this.tag,{type:"top10",dxfId:b.dxfId,priority:b.priority,percent:a.toBoolAttribute(b.percent,!1),bottom:a.toBoolAttribute(b.bottom,!1),rank:a.toIntValue(b.rank,10,!0)})}renderAboveAverage(v,b){v.leafNode(this.tag,{type:"aboveAverage",dxfId:b.dxfId,priority:b.priority,aboveAverage:a.toBoolAttribute(b.aboveAverage,!0)})}renderDataBar(v,b){v.openNode(this.tag,{type:"dataBar",priority:b.priority}),this.databarXform.render(v,b),this.extLstRefXform.render(v,b),v.closeNode()}renderColorScale(v,b){v.openNode(this.tag,{type:"colorScale",priority:b.priority}),this.colorScaleXform.render(v,b),v.closeNode()}renderIconSet(v,b){m.isPrimitive(b)&&(v.openNode(this.tag,{type:"iconSet",priority:b.priority}),this.iconSetXform.render(v,b),v.closeNode())}renderText(v,b){v.openNode(this.tag,{type:b.operator,dxfId:b.dxfId,priority:b.priority,operator:a.toStringAttribute(b.operator,"containsText")});const y=(k=>{if(k.formulae&&k.formulae[0])return k.formulae[0];const N=new o(k.ref),{tl:L}=N;switch(k.operator){case"containsText":return`NOT(ISERROR(SEARCH("${k.text}",${L})))`;case"containsBlanks":return`LEN(TRIM(${L}))=0`;case"notContainsBlanks":return`LEN(TRIM(${L}))>0`;case"containsErrors":return`ISERROR(${L})`;case"notContainsErrors":return`NOT(ISERROR(${L}))`;default:return}})(b);y&&this.formulaXform.render(v,y),v.closeNode()}renderTimePeriod(v,b){v.openNode(this.tag,{type:"timePeriod",dxfId:b.dxfId,priority:b.priority,timePeriod:b.timePeriod});const y=(k=>{if(k.formulae&&k.formulae[0])return k.formulae[0];const N=new o(k.ref),{tl:L}=N;switch(k.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${L},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${L},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${L},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${L},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${L},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${L},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${L},1)=TODAY()-1`;case"today":return`FLOOR(${L},1)=TODAY()`;case"tomorrow":return`FLOOR(${L},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${L},1)<=6,FLOOR(${L},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${L})=MONTH(EDATE(TODAY(),0-1)),YEAR(${L})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${L})=MONTH(TODAY()),YEAR(${L})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${L})=MONTH(EDATE(TODAY(),0+1)),YEAR(${L})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(b);y&&this.formulaXform.render(v,y),v.closeNode()}createNewModel(v){let{attributes:b}=v;return{...g(b),dxfId:a.toIntValue(b.dxfId),priority:a.toIntValue(b.priority),timePeriod:b.timePeriod,percent:a.toBoolValue(b.percent),bottom:a.toBoolValue(b.bottom),rank:a.toIntValue(b.rank),aboveAverage:a.toBoolValue(b.aboveAverage)}}onParserClose(v,b){switch(v){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,b.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(b.model)}}}n.exports=m},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(e,n,s){const a=e("../../base-xform");n.exports=class extends a{get tag(){return"cfvo"}render(i,o){i.leafNode(this.tag,{type:o.type,val:o.value})}parseOpen(i){this.model={type:i.attributes.type,value:a.toFloatValue(i.attributes.val)}}parseClose(i){return i!==this.tag}}},{"../../base-xform":32}],85:[function(e,n,s){const a=e("../../composite-xform"),i=e("../../style/color-xform"),o=e("./cfvo-xform");n.exports=class extends a{constructor(){super(),this.map={cfvo:this.cfvoXform=new o,color:this.colorXform=new i}}get tag(){return"colorScale"}render(l,c){l.openNode(this.tag),c.cfvo.forEach(u=>{this.cfvoXform.render(l,u)}),c.color.forEach(u=>{this.colorXform.render(l,u)}),l.closeNode()}createNewModel(l){return{cfvo:[],color:[]}}onParserClose(l,c){this.model[l].push(c.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(e,n,s){const a=e("../../composite-xform"),i=e("./cf-rule-xform");n.exports=class extends a{constructor(){super(),this.map={cfRule:new i}}get tag(){return"conditionalFormatting"}render(o,l){l.rules.some(i.isPrimitive)&&(o.openNode(this.tag,{sqref:l.ref}),l.rules.forEach(c=>{i.isPrimitive(c)&&(c.ref=l.ref,this.map.cfRule.render(o,c))}),o.closeNode())}createNewModel(o){let{attributes:l}=o;return{ref:l.sqref,rules:[]}}onParserClose(o,l){this.model.rules.push(l.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(e,n,s){const a=e("../../base-xform"),i=e("./conditional-formatting-xform");n.exports=class extends a{constructor(){super(),this.cfXform=new i}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(o,l){let c=o.reduce((u,d)=>Math.max(u,...d.rules.map(h=>h.priority||0)),1);o.forEach(u=>{u.rules.forEach(d=>{d.priority||(d.priority=c++),d.style&&(d.dxfId=l.styles.addDxfStyle(d.style))})})}render(o,l){l.forEach(c=>{this.cfXform.render(o,c)})}parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(o),!0;default:return!1}}parseText(o){this.parser&&this.parser.parseText(o)}parseClose(o){return!!this.parser&&(!!this.parser.parseClose(o)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(o,l){o.forEach(c=>{c.rules.forEach(u=>{u.dxfId!==void 0&&(u.style=l.styles.getDxfStyle(u.dxfId),delete u.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(e,n,s){const a=e("../../composite-xform"),i=e("../../style/color-xform"),o=e("./cfvo-xform");n.exports=class extends a{constructor(){super(),this.map={cfvo:this.cfvoXform=new o,color:this.colorXform=new i}}get tag(){return"dataBar"}render(l,c){l.openNode(this.tag),c.cfvo.forEach(u=>{this.cfvoXform.render(l,u)}),this.colorXform.render(l,c.color),l.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(l,c){switch(l){case"cfvo":this.model.cfvo.push(c.model);break;case"color":this.model.color=c.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(e,n,s){const a=e("../../base-xform"),i=e("../../composite-xform");class o extends a{get tag(){return"x14:id"}render(u,d){u.leafNode(this.tag,null,d)}parseOpen(){this.model=""}parseText(u){this.model+=u}parseClose(u){return u!==this.tag}}class l extends i{constructor(){super(),this.map={"x14:id":this.idXform=new o}}get tag(){return"ext"}render(u,d){u.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(u,d.x14Id),u.closeNode()}createNewModel(){return{}}onParserClose(u,d){this.model.x14Id=d.model}}n.exports=class extends i{constructor(){super(),this.map={ext:new l}}get tag(){return"extLst"}render(c,u){c.openNode(this.tag),this.map.ext.render(c,u),c.closeNode()}createNewModel(){return{}}onParserClose(c,u){Object.assign(this.model,u.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(e,n,s){const a=e("../../base-xform");n.exports=class extends a{get tag(){return"formula"}render(i,o){i.leafNode(this.tag,null,o)}parseOpen(){this.model=""}parseText(i){this.model+=i}parseClose(i){return i!==this.tag}}},{"../../base-xform":32}],91:[function(e,n,s){const a=e("../../base-xform"),i=e("../../composite-xform"),o=e("./cfvo-xform");n.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new o}}get tag(){return"iconSet"}render(l,c){l.openNode(this.tag,{iconSet:a.toStringAttribute(c.iconSet,"3TrafficLights"),reverse:a.toBoolAttribute(c.reverse,!1),showValue:a.toBoolAttribute(c.showValue,!0)}),c.cfvo.forEach(u=>{this.cfvoXform.render(l,u)}),l.closeNode()}createNewModel(l){let{attributes:c}=l;return{iconSet:a.toStringValue(c.iconSet,"3TrafficLights"),reverse:a.toBoolValue(c.reverse),showValue:a.toBoolValue(c.showValue),cfvo:[]}}onParserClose(l,c){this.model[l].push(c.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(e,n,s){const a=e("../../../utils/utils"),i=e("../base-xform");n.exports=class extends i{get tag(){return"col"}prepare(o,l){const c=l.styles.addStyleModel(o.style||{});c&&(o.styleId=c)}render(o,l){o.openNode("col"),o.addAttribute("min",l.min),o.addAttribute("max",l.max),l.width&&o.addAttribute("width",l.width),l.styleId&&o.addAttribute("style",l.styleId),l.hidden&&o.addAttribute("hidden","1"),l.bestFit&&o.addAttribute("bestFit","1"),l.outlineLevel&&o.addAttribute("outlineLevel",l.outlineLevel),l.collapsed&&o.addAttribute("collapsed","1"),o.addAttribute("customWidth","1"),o.closeNode()}parseOpen(o){if(o.name==="col"){const l=this.model={min:parseInt(o.attributes.min||"0",10),max:parseInt(o.attributes.max||"0",10),width:o.attributes.width===void 0?void 0:parseFloat(o.attributes.width||"0")};return o.attributes.style&&(l.styleId=parseInt(o.attributes.style,10)),a.parseBoolean(o.attributes.hidden)&&(l.hidden=!0),a.parseBoolean(o.attributes.bestFit)&&(l.bestFit=!0),o.attributes.outlineLevel&&(l.outlineLevel=parseInt(o.attributes.outlineLevel,10)),a.parseBoolean(o.attributes.collapsed)&&(l.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(o,l){o.styleId&&(o.style=l.styles.getStyleModel(o.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(e,n,s){const a=e("../../../utils/under-dash"),i=e("../../../utils/utils"),o=e("../../../utils/col-cache"),l=e("../base-xform"),c=e("../../../doc/range");function u(h,f,g,m){const p=f[g];p!==void 0?h[g]=p:m!==void 0&&(h[g]=m)}function d(h,f,g,m){const p=f[g];p!==void 0&&(h[g]=i.parseBoolean(p))}n.exports=class extends l{get tag(){return"dataValidations"}render(h,f){const g=function(m){const p=a.map(m,(y,k)=>({address:k,dataValidation:y,marked:!1})).sort((y,k)=>a.strcmp(y.address,k.address)),v=a.keyBy(p,"address"),b=(y,k,N)=>{for(let L=0;L<k;L++){const F=o.encodeAddress(y.row+L,N);if(!m[F]||!a.isEqual(m[y.address],m[F]))return!1}return!0};return p.map(y=>{if(!y.marked){const k=o.decodeEx(y.address);if(k.dimensions)return v[k.dimensions].marked=!0,{...y.dataValidation,sqref:y.address};let N=1,L=o.encodeAddress(k.row+N,k.col);for(;m[L]&&a.isEqual(y.dataValidation,m[L]);)N++,L=o.encodeAddress(k.row+N,k.col);let F=1;for(;b(k,N,k.col+F);)F++;for(let R=0;R<N;R++)for(let B=0;B<F;B++)L=o.encodeAddress(k.row+R,k.col+B),v[L].marked=!0;if(N>1||F>1){const R=k.row+(N-1),B=k.col+(F-1);return{...y.dataValidation,sqref:`${y.address}:${o.encodeAddress(R,B)}`}}return{...y.dataValidation,sqref:y.address}}return null}).filter(Boolean)}(f);g.length&&(h.openNode("dataValidations",{count:g.length}),g.forEach(m=>{h.openNode("dataValidation"),m.type!=="any"&&(h.addAttribute("type",m.type),m.operator&&m.type!=="list"&&m.operator!=="between"&&h.addAttribute("operator",m.operator),m.allowBlank&&h.addAttribute("allowBlank","1")),m.showInputMessage&&h.addAttribute("showInputMessage","1"),m.promptTitle&&h.addAttribute("promptTitle",m.promptTitle),m.prompt&&h.addAttribute("prompt",m.prompt),m.showErrorMessage&&h.addAttribute("showErrorMessage","1"),m.errorStyle&&h.addAttribute("errorStyle",m.errorStyle),m.errorTitle&&h.addAttribute("errorTitle",m.errorTitle),m.error&&h.addAttribute("error",m.error),h.addAttribute("sqref",m.sqref),(m.formulae||[]).forEach((p,v)=>{h.openNode("formula"+(v+1)),m.type==="date"?h.writeText(i.dateToExcel(new Date(p))):h.writeText(p),h.closeNode()}),h.closeNode()}),h.closeNode())}parseOpen(h){switch(h.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=h.attributes.sqref;const f={type:h.attributes.type||"any",formulae:[]};switch(h.attributes.type&&d(f,h.attributes,"allowBlank"),d(f,h.attributes,"showInputMessage"),d(f,h.attributes,"showErrorMessage"),f.type){case"any":case"list":case"custom":break;default:u(f,h.attributes,"operator","between")}return u(f,h.attributes,"promptTitle"),u(f,h.attributes,"prompt"),u(f,h.attributes,"errorStyle"),u(f,h.attributes,"errorTitle"),u(f,h.attributes,"error"),this._dataValidation=f,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(h){this._formula&&this._formula.push(h)}parseClose(h){switch(h){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(f=>{f.includes(":")?new c(f).forEachAddress(g=>{this.model[g]=this._dataValidation}):this.model[f]=this._dataValidation}),!0;case"formula1":case"formula2":{let f=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":f=parseInt(f,10);break;case"decimal":f=parseFloat(f);break;case"date":f=i.excelToDate(parseFloat(f))}return this._dataValidation.formulae.push(f),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"dimension"}render(i,o){o&&i.leafNode("dimension",{ref:o})}parseOpen(i){return i.name==="dimension"&&(this.model=i.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"drawing"}render(i,o){o&&i.leafNode(this.tag,{"r:id":o.rId})}parseOpen(i){switch(i.name){case this.tag:return this.model={rId:i.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(e,n,s){const a=e("../composite-xform"),i=e("./cf-ext/conditional-formattings-ext-xform");class o extends a{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new i}}get tag(){return"ext"}hasContent(c){return this.conditionalFormattings.hasContent(c.conditionalFormattings)}prepare(c,u){this.conditionalFormattings.prepare(c.conditionalFormattings,u)}render(c,u){c.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(c,u.conditionalFormattings),c.closeNode()}createNewModel(){return{}}onParserClose(c,u){this.model[c]=u.model}}n.exports=class extends a{constructor(){super(),this.map={ext:this.ext=new o}}get tag(){return"extLst"}prepare(l,c){this.ext.prepare(l,c)}hasContent(l){return this.ext.hasContent(l)}render(l,c){this.hasContent(c)&&(l.openNode("extLst"),this.ext.render(l,c),l.closeNode())}createNewModel(){return{}}onParserClose(l,c){Object.assign(this.model,c.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"headerFooter"}render(i,o){if(o){i.addRollback();let l=!1;i.openNode("headerFooter"),o.differentFirst&&(i.addAttribute("differentFirst","1"),l=!0),o.differentOddEven&&(i.addAttribute("differentOddEven","1"),l=!0),o.oddHeader&&typeof o.oddHeader=="string"&&(i.leafNode("oddHeader",null,o.oddHeader),l=!0),o.oddFooter&&typeof o.oddFooter=="string"&&(i.leafNode("oddFooter",null,o.oddFooter),l=!0),o.evenHeader&&typeof o.evenHeader=="string"&&(i.leafNode("evenHeader",null,o.evenHeader),l=!0),o.evenFooter&&typeof o.evenFooter=="string"&&(i.leafNode("evenFooter",null,o.evenFooter),l=!0),o.firstHeader&&typeof o.firstHeader=="string"&&(i.leafNode("firstHeader",null,o.firstHeader),l=!0),o.firstFooter&&typeof o.firstFooter=="string"&&(i.leafNode("firstFooter",null,o.firstFooter),l=!0),l?(i.closeNode(),i.commit()):i.rollback()}}parseOpen(i){switch(i.name){case"headerFooter":return this.model={},i.attributes.differentFirst&&(this.model.differentFirst=parseInt(i.attributes.differentFirst,0)===1),i.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(i.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(i){switch(this.currentNode){case"oddHeader":this.model.oddHeader=i;break;case"oddFooter":this.model.oddFooter=i;break;case"evenHeader":this.model.evenHeader=i;break;case"evenFooter":this.model.evenFooter=i;break;case"firstHeader":this.model.firstHeader=i;break;case"firstFooter":this.model.firstFooter=i}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"hyperlink"}render(i,o){this.isInternalLink(o)?i.leafNode("hyperlink",{ref:o.address,"r:id":o.rId,tooltip:o.tooltip,location:o.target}):i.leafNode("hyperlink",{ref:o.address,"r:id":o.rId,tooltip:o.tooltip})}parseOpen(i){return i.name==="hyperlink"&&(this.model={address:i.attributes.ref,rId:i.attributes["r:id"],tooltip:i.attributes.tooltip},i.attributes.location&&(this.model.target=i.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(i){return i.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(i.target)}}},{"../base-xform":32}],99:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"mergeCell"}render(i,o){i.leafNode("mergeCell",{ref:o})}parseOpen(i){return i.name==="mergeCell"&&(this.model=i.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(e,n,s){const a=e("../../../utils/under-dash"),i=e("../../../doc/range"),o=e("../../../utils/col-cache"),l=e("../../../doc/enums");n.exports=class{constructor(){this.merges={}}add(c){if(this.merges[c.master])this.merges[c.master].expandToAddress(c.address);else{const u=`${c.master}:${c.address}`;this.merges[c.master]=new i(u)}}get mergeCells(){return a.map(this.merges,c=>c.range)}reconcile(c,u){a.each(c,d=>{const h=o.decode(d);for(let f=h.top;f<=h.bottom;f++){const g=u[f-1];for(let m=h.left;m<=h.right;m++){const p=g.cells[m-1];p?p.type===l.ValueType.Merge&&(p.master=h.tl):g.cells[m]={type:l.ValueType.Null,address:o.encodeAddress(f,m)}}}})}getMasterAddress(c){const u=this.hash[c];return u&&u.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(e,n,s){const a=e("../base-xform"),i=o=>o!==void 0;n.exports=class extends a{get tag(){return"outlinePr"}render(o,l){return!(!l||!i(l.summaryBelow)&&!i(l.summaryRight))&&(o.leafNode(this.tag,{summaryBelow:i(l.summaryBelow)?Number(l.summaryBelow):void 0,summaryRight:i(l.summaryRight)?Number(l.summaryRight):void 0}),!0)}parseOpen(o){return o.name===this.tag&&(this.model={summaryBelow:i(o.attributes.summaryBelow)?!!Number(o.attributes.summaryBelow):void 0,summaryRight:i(o.attributes.summaryRight)?!!Number(o.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"brk"}render(i,o){i.leafNode("brk",o)}parseOpen(i){return i.name==="brk"&&(this.model=i.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(e,n,s){const a=e("../../../utils/under-dash"),i=e("../base-xform");n.exports=class extends i{get tag(){return"pageMargins"}render(o,l){if(l){const c={left:l.left,right:l.right,top:l.top,bottom:l.bottom,header:l.header,footer:l.footer};a.some(c,u=>u!==void 0)&&o.leafNode(this.tag,c)}}parseOpen(o){switch(o.name){case this.tag:return this.model={left:parseFloat(o.attributes.left||.7),right:parseFloat(o.attributes.right||.7),top:parseFloat(o.attributes.top||.75),bottom:parseFloat(o.attributes.bottom||.75),header:parseFloat(o.attributes.header||.3),footer:parseFloat(o.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"pageSetUpPr"}render(i,o){return!(!o||!o.fitToPage)&&(i.leafNode(this.tag,{fitToPage:o.fitToPage?"1":void 0}),!0)}parseOpen(i){return i.name===this.tag&&(this.model={fitToPage:i.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(e,n,s){const a=e("../../../utils/under-dash"),i=e("../base-xform");function o(d){return d?"1":void 0}function l(d){switch(d){case"overThenDown":return d;default:return}}function c(d){switch(d){case"atEnd":case"asDisplyed":return d;default:return}}function u(d){switch(d){case"dash":case"blank":case"NA":return d;default:return}}n.exports=class extends i{get tag(){return"pageSetup"}render(d,h){if(h){const f={paperSize:h.paperSize,orientation:h.orientation,horizontalDpi:h.horizontalDpi,verticalDpi:h.verticalDpi,pageOrder:l(h.pageOrder),blackAndWhite:o(h.blackAndWhite),draft:o(h.draft),cellComments:c(h.cellComments),errors:u(h.errors),scale:h.scale,fitToWidth:h.fitToWidth,fitToHeight:h.fitToHeight,firstPageNumber:h.firstPageNumber,useFirstPageNumber:o(h.firstPageNumber),usePrinterDefaults:o(h.usePrinterDefaults),copies:h.copies};a.some(f,g=>g!==void 0)&&d.leafNode(this.tag,f)}}parseOpen(d){switch(d.name){case this.tag:return this.model={paperSize:(h=d.attributes.paperSize,h!==void 0?parseInt(h,10):void 0),orientation:d.attributes.orientation||"portrait",horizontalDpi:parseInt(d.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(d.attributes.verticalDpi||"4294967295",10),pageOrder:d.attributes.pageOrder||"downThenOver",blackAndWhite:d.attributes.blackAndWhite==="1",draft:d.attributes.draft==="1",cellComments:d.attributes.cellComments||"None",errors:d.attributes.errors||"displayed",scale:parseInt(d.attributes.scale||"100",10),fitToWidth:parseInt(d.attributes.fitToWidth||"1",10),fitToHeight:parseInt(d.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(d.attributes.firstPageNumber||"1",10),useFirstPageNumber:d.attributes.useFirstPageNumber==="1",usePrinterDefaults:d.attributes.usePrinterDefaults==="1",copies:parseInt(d.attributes.copies||"1",10)},!0;default:return!1}var h}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"picture"}render(i,o){o&&i.leafNode(this.tag,{"r:id":o.rId})}parseOpen(i){switch(i.name){case this.tag:return this.model={rId:i.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(e,n,s){const a=e("../../../utils/under-dash"),i=e("../base-xform");function o(l){return l?"1":void 0}n.exports=class extends i{get tag(){return"printOptions"}render(l,c){if(c){const u={headings:o(c.showRowColHeaders),gridLines:o(c.showGridLines),horizontalCentered:o(c.horizontalCentered),verticalCentered:o(c.verticalCentered)};a.some(u,d=>d!==void 0)&&l.leafNode(this.tag,u)}}parseOpen(l){switch(l.name){case this.tag:return this.model={showRowColHeaders:l.attributes.headings==="1",showGridLines:l.attributes.gridLines==="1",horizontalCentered:l.attributes.horizontalCentered==="1",verticalCentered:l.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(e,n,s){const a=e("./page-breaks-xform"),i=e("../list-xform");n.exports=class extends i{constructor(){super({tag:"rowBreaks",count:!0,childXform:new a})}render(o,l){if(l&&l.length){o.openNode(this.tag,this.$),this.count&&(o.addAttribute(this.$count,l.length),o.addAttribute("manualBreakCount",l.length));const{childXform:c}=this;l.forEach(u=>{c.render(o,u)}),o.closeNode()}else this.empty&&o.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(e,n,s){const a=e("../base-xform"),i=e("../../../utils/utils"),o=e("./cell-xform");n.exports=class extends a{constructor(l){super(),this.maxItems=l&&l.maxItems,this.map={c:new o}}get tag(){return"row"}prepare(l,c){const u=c.styles.addStyleModel(l.style);u&&(l.styleId=u);const d=this.map.c;l.cells.forEach(h=>{d.prepare(h,c)})}render(l,c,u){l.openNode("row"),l.addAttribute("r",c.number),c.height&&(l.addAttribute("ht",c.height),l.addAttribute("customHeight","1")),c.hidden&&l.addAttribute("hidden","1"),c.min>0&&c.max>0&&c.min<=c.max&&l.addAttribute("spans",`${c.min}:${c.max}`),c.styleId&&(l.addAttribute("s",c.styleId),l.addAttribute("customFormat","1")),l.addAttribute("x14ac:dyDescent","0.25"),c.outlineLevel&&l.addAttribute("outlineLevel",c.outlineLevel),c.collapsed&&l.addAttribute("collapsed","1");const d=this.map.c;c.cells.forEach(h=>{d.render(l,h,u)}),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;if(l.name==="row"){this.numRowsSeen+=1;const c=l.attributes.spans?l.attributes.spans.split(":").map(d=>parseInt(d,10)):[void 0,void 0],u=this.model={number:parseInt(l.attributes.r,10),min:c[0],max:c[1],cells:[]};return l.attributes.s&&(u.styleId=parseInt(l.attributes.s,10)),i.parseBoolean(l.attributes.hidden)&&(u.hidden=!0),i.parseBoolean(l.attributes.bestFit)&&(u.bestFit=!0),l.attributes.ht&&(u.height=parseFloat(l.attributes.ht)),l.attributes.outlineLevel&&(u.outlineLevel=parseInt(l.attributes.outlineLevel,10)),i.parseBoolean(l.attributes.collapsed)&&(u.collapsed=!0),!0}return this.parser=this.map[l.name],!!this.parser&&(this.parser.parseOpen(l),!0)}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(l,c){l.style=l.styleId?c.styles.getStyleModel(l.styleId):{},l.styleId!==void 0&&(l.styleId=void 0);const u=this.map.c;l.cells.forEach(d=>{u.reconcile(d,c)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(e,n,s){const a=e("../../../utils/under-dash"),i=e("../base-xform");n.exports=class extends i{get tag(){return"sheetFormatPr"}render(o,l){if(l){const c={defaultRowHeight:l.defaultRowHeight,outlineLevelRow:l.outlineLevelRow,outlineLevelCol:l.outlineLevelCol,"x14ac:dyDescent":l.dyDescent};l.defaultColWidth&&(c.defaultColWidth=l.defaultColWidth),l.defaultRowHeight&&l.defaultRowHeight===15||(c.customHeight="1"),a.some(c,u=>u!==void 0)&&o.leafNode("sheetFormatPr",c)}}parseOpen(o){return o.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(o.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(o.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(o.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(o.attributes.outlineLevelCol||"0",10)},o.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(o.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(e,n,s){const a=e("../base-xform"),i=e("../style/color-xform"),o=e("./page-setup-properties-xform"),l=e("./outline-properties-xform");n.exports=class extends a{constructor(){super(),this.map={tabColor:new i("tabColor"),pageSetUpPr:new o,outlinePr:new l}}get tag(){return"sheetPr"}render(c,u){if(u){c.addRollback(),c.openNode("sheetPr");let d=!1;d=this.map.tabColor.render(c,u.tabColor)||d,d=this.map.pageSetUpPr.render(c,u.pageSetup)||d,d=this.map.outlinePr.render(c,u.outlineProperties)||d,d?(c.closeNode(),c.commit()):c.rollback()}}parseOpen(c){return this.parser?(this.parser.parseOpen(c),!0):c.name===this.tag?(this.reset(),!0):!!this.map[c.name]&&(this.parser=this.map[c.name],this.parser.parseOpen(c),!0)}parseText(c){return!!this.parser&&(this.parser.parseText(c),!0)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(e,n,s){const a=e("../../../utils/under-dash"),i=e("../base-xform");function o(c,u){return c?u:void 0}function l(c,u){return c===u||void 0}n.exports=class extends i{get tag(){return"sheetProtection"}render(c,u){if(u){const d={sheet:o(u.sheet,"1"),selectLockedCells:u.selectLockedCells===!1?"1":void 0,selectUnlockedCells:u.selectUnlockedCells===!1?"1":void 0,formatCells:o(u.formatCells,"0"),formatColumns:o(u.formatColumns,"0"),formatRows:o(u.formatRows,"0"),insertColumns:o(u.insertColumns,"0"),insertRows:o(u.insertRows,"0"),insertHyperlinks:o(u.insertHyperlinks,"0"),deleteColumns:o(u.deleteColumns,"0"),deleteRows:o(u.deleteRows,"0"),sort:o(u.sort,"0"),autoFilter:o(u.autoFilter,"0"),pivotTables:o(u.pivotTables,"0")};u.sheet&&(d.algorithmName=u.algorithmName,d.hashValue=u.hashValue,d.saltValue=u.saltValue,d.spinCount=u.spinCount,d.objects=o(u.objects===!1,"1"),d.scenarios=o(u.scenarios===!1,"1")),a.some(d,h=>h!==void 0)&&c.leafNode(this.tag,d)}}parseOpen(c){switch(c.name){case this.tag:return this.model={sheet:l(c.attributes.sheet,"1"),objects:c.attributes.objects!=="1"&&void 0,scenarios:c.attributes.scenarios!=="1"&&void 0,selectLockedCells:c.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:c.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:l(c.attributes.formatCells,"0"),formatColumns:l(c.attributes.formatColumns,"0"),formatRows:l(c.attributes.formatRows,"0"),insertColumns:l(c.attributes.insertColumns,"0"),insertRows:l(c.attributes.insertRows,"0"),insertHyperlinks:l(c.attributes.insertHyperlinks,"0"),deleteColumns:l(c.attributes.deleteColumns,"0"),deleteRows:l(c.attributes.deleteRows,"0"),sort:l(c.attributes.sort,"0"),autoFilter:l(c.attributes.autoFilter,"0"),pivotTables:l(c.attributes.pivotTables,"0")},c.attributes.algorithmName&&(this.model.algorithmName=c.attributes.algorithmName,this.model.hashValue=c.attributes.hashValue,this.model.saltValue=c.attributes.saltValue,this.model.spinCount=parseInt(c.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(e,n,s){const a=e("../../../utils/col-cache"),i=e("../base-xform"),o={frozen:"frozen",frozenSplit:"frozen",split:"split"};n.exports=class extends i{get tag(){return"sheetView"}prepare(l){switch(l.state){case"frozen":case"split":break;default:l.state="normal"}}render(l,c){l.openNode("sheetView",{workbookViewId:c.workbookViewId||0});const u=function(m,p,v){v&&l.addAttribute(m,p)};let d,h,f,g;switch(u("rightToLeft","1",c.rightToLeft===!0),u("tabSelected","1",c.tabSelected),u("showRuler","0",c.showRuler===!1),u("showRowColHeaders","0",c.showRowColHeaders===!1),u("showGridLines","0",c.showGridLines===!1),u("zoomScale",c.zoomScale,c.zoomScale),u("zoomScaleNormal",c.zoomScaleNormal,c.zoomScaleNormal),u("view",c.style,c.style),c.state){case"frozen":h=c.xSplit||0,f=c.ySplit||0,d=c.topLeftCell||a.getAddress(f+1,h+1).address,g=(c.xSplit&&c.ySplit?"bottomRight":c.xSplit&&"topRight")||"bottomLeft",l.leafNode("pane",{xSplit:c.xSplit||void 0,ySplit:c.ySplit||void 0,topLeftCell:d,activePane:g,state:"frozen"}),l.leafNode("selection",{pane:g,activeCell:c.activeCell,sqref:c.activeCell});break;case"split":c.activePane==="topLeft"&&(c.activePane=void 0),l.leafNode("pane",{xSplit:c.xSplit||void 0,ySplit:c.ySplit||void 0,topLeftCell:c.topLeftCell,activePane:c.activePane}),l.leafNode("selection",{pane:c.activePane,activeCell:c.activeCell,sqref:c.activeCell});break;case"normal":c.activeCell&&l.leafNode("selection",{activeCell:c.activeCell,sqref:c.activeCell})}l.closeNode()}parseOpen(l){switch(l.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(l.attributes.workbookViewId,10),rightToLeft:l.attributes.rightToLeft==="1",tabSelected:l.attributes.tabSelected==="1",showRuler:l.attributes.showRuler!=="0",showRowColHeaders:l.attributes.showRowColHeaders!=="0",showGridLines:l.attributes.showGridLines!=="0",zoomScale:parseInt(l.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(l.attributes.zoomScaleNormal||"100",10),style:l.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(l.attributes.xSplit||"0",10),ySplit:parseInt(l.attributes.ySplit||"0",10),topLeftCell:l.attributes.topLeftCell,activePane:l.attributes.activePane||"topLeft",state:l.attributes.state},!0;case"selection":{const c=l.attributes.pane||"topLeft";return this.selections[c]={pane:c,activeCell:l.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(l){let c,u;switch(l){case"sheetView":return this.sheetView&&this.pane?(c=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:o[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(c.activePane=this.pane.activePane),u=this.selections[this.pane.activePane],u&&u.activeCell&&(c.activeCell=u.activeCell),this.sheetView.style&&(c.style=this.sheetView.style)):(c=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},u=this.selections.topLeft,u&&u.activeCell&&(c.activeCell=u.activeCell),this.sheetView.style&&(c.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"tablePart"}render(i,o){o&&i.leafNode(this.tag,{"r:id":o.rId})}parseOpen(i){switch(i.name){case this.tag:return this.model={rId:i.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(e,n,s){const a=e("../../../utils/under-dash"),i=e("../../../utils/col-cache"),o=e("../../../utils/xml-stream"),l=e("../../rel-type"),c=e("./merges"),u=e("../base-xform"),d=e("../list-xform"),h=e("./row-xform"),f=e("./col-xform"),g=e("./dimension-xform"),m=e("./hyperlink-xform"),p=e("./merge-cell-xform"),v=e("./data-validations-xform"),b=e("./sheet-properties-xform"),y=e("./sheet-format-properties-xform"),k=e("./sheet-view-xform"),N=e("./sheet-protection-xform"),L=e("./page-margins-xform"),F=e("./page-setup-xform"),R=e("./print-options-xform"),B=e("./auto-filter-xform"),q=e("./picture-xform"),V=e("./drawing-xform"),I=e("./table-part-xform"),C=e("./row-breaks-xform"),O=e("./header-footer-xform"),E=e("./cf/conditional-formattings-xform"),x=e("./ext-lst-xform"),w=(S,T)=>{if(!T||!T.length)return S;if(!S||!S.length)return T;const U={},A={};return S.forEach(H=>{U[H.ref]=H,H.rules.forEach(z=>{const{x14Id:K}=z;K&&(A[K]=z)})}),T.forEach(H=>{H.rules.forEach(z=>{const K=A[z.x14Id];K?((j,J)=>{Object.keys(J).forEach(P=>{const D=j[P],G=J[P];D===void 0&&G!==void 0&&(j[P]=G)})})(K,z):U[H.ref]?U[H.ref].rules.push(z):S.push({ref:H.ref,rules:[z]})})}),S};class _ extends u{constructor(T){super();const{maxRows:U,maxCols:A,ignoreNodes:H}=T||{};this.ignoreNodes=H||[],this.map={sheetPr:new b,dimension:new g,sheetViews:new d({tag:"sheetViews",count:!1,childXform:new k}),sheetFormatPr:new y,cols:new d({tag:"cols",count:!1,childXform:new f}),sheetData:new d({tag:"sheetData",count:!1,empty:!0,childXform:new h({maxItems:A}),maxItems:U}),autoFilter:new B,mergeCells:new d({tag:"mergeCells",count:!0,childXform:new p}),rowBreaks:new C,hyperlinks:new d({tag:"hyperlinks",count:!1,childXform:new m}),pageMargins:new L,dataValidations:new v,pageSetup:new F,headerFooter:new O,printOptions:new R,picture:new q,drawing:new V,sheetProtection:new N,tableParts:new d({tag:"tableParts",count:!0,childXform:new I}),conditionalFormatting:new E,extLst:new x}}prepare(T,U){U.merges=new c,T.hyperlinks=U.hyperlinks=[],T.comments=U.comments=[],U.formulae={},U.siFormulae=0,this.map.cols.prepare(T.cols,U),this.map.sheetData.prepare(T.rows,U),this.map.conditionalFormatting.prepare(T.conditionalFormattings,U),T.mergeCells=U.merges.mergeCells;const A=T.rels=[];function H(j){return"rId"+(j.length+1)}if(T.hyperlinks.forEach(j=>{const J=H(A);j.rId=J,A.push({Id:J,Type:l.Hyperlink,Target:j.target,TargetMode:"External"})}),T.comments.length>0){const j={Id:H(A),Type:l.Comments,Target:`../comments${T.id}.xml`};A.push(j);const J={Id:H(A),Type:l.VmlDrawing,Target:`../drawings/vmlDrawing${T.id}.vml`};A.push(J),T.comments.forEach(P=>{P.refAddress=i.decodeAddress(P.ref)}),U.commentRefs.push({commentName:"comments"+T.id,vmlDrawing:"vmlDrawing"+T.id})}const z=[];let K;T.media.forEach(j=>{if(j.type==="background"){const J=H(A);K=U.media[j.imageId],A.push({Id:J,Type:l.Image,Target:`../media/${K.name}.${K.extension}`}),T.background={rId:J},T.image=U.media[j.imageId]}else if(j.type==="image"){let{drawing:J}=T;K=U.media[j.imageId],J||(J=T.drawing={rId:H(A),name:"drawing"+ ++U.drawingsCount,anchors:[],rels:[]},U.drawings.push(J),A.push({Id:J.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${J.name}.xml`}));let P=this.preImageId===j.imageId?z[j.imageId]:z[J.rels.length];P||(P=H(J.rels),z[J.rels.length]=P,J.rels.push({Id:P,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${K.name}.${K.extension}`}));const D={picture:{rId:P},range:j.range};if(j.hyperlinks&&j.hyperlinks.hyperlink){const G=H(J.rels);z[J.rels.length]=G,D.picture.hyperlinks={tooltip:j.hyperlinks.tooltip,rId:G},J.rels.push({Id:G,Type:l.Hyperlink,Target:j.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=j.imageId,J.anchors.push(D)}}),T.tables.forEach(j=>{const J=H(A);j.rId=J,A.push({Id:J,Type:l.Table,Target:"../tables/"+j.target}),j.columns.forEach(P=>{const{style:D}=P;D&&(P.dxfId=U.styles.addDxfStyle(D))})}),this.map.extLst.prepare(T,U)}render(T,U){T.openXml(o.StdDocAttributes),T.openNode("worksheet",_.WORKSHEET_ATTRIBUTES);const A=U.properties?{defaultRowHeight:U.properties.defaultRowHeight,dyDescent:U.properties.dyDescent,outlineLevelCol:U.properties.outlineLevelCol,outlineLevelRow:U.properties.outlineLevelRow}:void 0;U.properties&&U.properties.defaultColWidth&&(A.defaultColWidth=U.properties.defaultColWidth);const H={outlineProperties:U.properties&&U.properties.outlineProperties,tabColor:U.properties&&U.properties.tabColor,pageSetup:U.pageSetup&&U.pageSetup.fitToPage?{fitToPage:U.pageSetup.fitToPage}:void 0},z=U.pageSetup&&U.pageSetup.margins,K={showRowColHeaders:U.pageSetup&&U.pageSetup.showRowColHeaders,showGridLines:U.pageSetup&&U.pageSetup.showGridLines,horizontalCentered:U.pageSetup&&U.pageSetup.horizontalCentered,verticalCentered:U.pageSetup&&U.pageSetup.verticalCentered},j=U.sheetProtection;this.map.sheetPr.render(T,H),this.map.dimension.render(T,U.dimensions),this.map.sheetViews.render(T,U.views),this.map.sheetFormatPr.render(T,A),this.map.cols.render(T,U.cols),this.map.sheetData.render(T,U.rows),this.map.sheetProtection.render(T,j),this.map.autoFilter.render(T,U.autoFilter),this.map.mergeCells.render(T,U.mergeCells),this.map.conditionalFormatting.render(T,U.conditionalFormattings),this.map.dataValidations.render(T,U.dataValidations),this.map.hyperlinks.render(T,U.hyperlinks),this.map.printOptions.render(T,K),this.map.pageMargins.render(T,z),this.map.pageSetup.render(T,U.pageSetup),this.map.headerFooter.render(T,U.headerFooter),this.map.rowBreaks.render(T,U.rowBreaks),this.map.drawing.render(T,U.drawing),this.map.picture.render(T,U.background),this.map.tableParts.render(T,U.tables),this.map.extLst.render(T,U),U.rels&&U.rels.forEach(J=>{J.Type===l.VmlDrawing&&T.leafNode("legacyDrawing",{"r:id":J.Id})}),T.closeNode()}parseOpen(T){return this.parser?(this.parser.parseOpen(T),!0):T.name==="worksheet"?(a.each(this.map,U=>{U.reset()}),!0):(this.map[T.name]&&!this.ignoreNodes.includes(T.name)&&(this.parser=this.map[T.name],this.parser.parseOpen(T)),!0)}parseText(T){this.parser&&this.parser.parseText(T)}parseClose(T){if(this.parser)return this.parser.parseClose(T)||(this.parser=void 0),!0;switch(T){case"worksheet":{const U=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(U.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(U.outlineProperties=this.map.sheetPr.model.outlineProperties);const A={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},H=Object.assign(A,this.map.pageSetup.model,this.map.printOptions.model),z=w(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:U,views:this.map.sheetViews.model,pageSetup:H,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:z},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(T,U){const A=(T.relationships||[]).reduce((z,K)=>{if(z[K.Id]=K,K.Type===l.Comments&&(T.comments=U.comments[K.Target].comments),K.Type===l.VmlDrawing&&T.comments&&T.comments.length){const j=U.vmlDrawings[K.Target].comments;T.comments.forEach((J,P)=>{J.note=Object.assign({},J.note,j[P])})}return z},{});if(U.commentsMap=(T.comments||[]).reduce((z,K)=>(K.ref&&(z[K.ref]=K),z),{}),U.hyperlinkMap=(T.hyperlinks||[]).reduce((z,K)=>(K.rId&&(z[K.address]=A[K.rId].Target),z),{}),U.formulae={},T.rows=T.rows&&T.rows.filter(Boolean)||[],T.rows.forEach(z=>{z.cells=z.cells&&z.cells.filter(Boolean)||[]}),this.map.cols.reconcile(T.cols,U),this.map.sheetData.reconcile(T.rows,U),this.map.conditionalFormatting.reconcile(T.conditionalFormattings,U),T.media=[],T.drawing){const z=A[T.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(z){const K=z[1];U.drawings[K].anchors.forEach(j=>{if(j.medium){const J={type:"image",imageId:j.medium.index,range:j.range,hyperlinks:j.picture.hyperlinks};T.media.push(J)}})}}const H=T.background&&A[T.background.rId];if(H){const z=H.Target.split("/media/")[1],K=U.mediaIndex&&U.mediaIndex[z];K!==void 0&&T.media.push({type:"background",imageId:K})}T.tables=(T.tables||[]).map(z=>{const K=A[z.rId];return U.tables[K.Target]}),delete T.relationships,delete T.hyperlinks,delete T.comments}}_.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},n.exports=_},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{constructor(i){super(),this.tag=i.tag,this.attr=i.attr}render(i,o){o&&(i.openNode(this.tag),i.closeNode())}parseOpen(i){i.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{constructor(i){super(),this.tag=i.tag,this.attr=i.attr,this.attrs=i.attrs,this._format=i.format||function(o){try{return Number.isNaN(o.getTime())?"":o.toISOString()}catch{return""}},this._parse=i.parse||function(o){return new Date(o)}}render(i,o){o&&(i.openNode(this.tag),this.attrs&&i.addAttributes(this.attrs),this.attr?i.addAttribute(this.attr,this._format(o)):i.writeText(this._format(o)),i.closeNode())}parseOpen(i){i.name===this.tag&&(this.attr?this.model=this._parse(i.attributes[this.attr]):this.text=[])}parseText(i){this.attr||this.text.push(i)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{constructor(i){super(),this.tag=i.tag,this.attr=i.attr,this.attrs=i.attrs,this.zero=i.zero}render(i,o){(o||this.zero)&&(i.openNode(this.tag),this.attrs&&i.addAttributes(this.attrs),this.attr?i.addAttribute(this.attr,o):i.writeText(o),i.closeNode())}parseOpen(i){return i.name===this.tag&&(this.attr?this.model=parseInt(i.attributes[this.attr],10):this.text=[],!0)}parseText(i){this.attr||this.text.push(i)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{constructor(i){super(),this.tag=i.tag,this.attr=i.attr,this.attrs=i.attrs}render(i,o){o!==void 0&&(i.openNode(this.tag),this.attrs&&i.addAttributes(this.attrs),this.attr?i.addAttribute(this.attr,o):i.writeText(o),i.closeNode())}parseOpen(i){i.name===this.tag&&(this.attr?this.model=i.attributes[this.attr]:this.text=[])}parseText(i){this.attr||this.text.push(i)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(e,n,s){const a=e("./base-xform"),i=e("../../utils/xml-stream");n.exports=class extends a{constructor(o){super(),this._model=o}render(o){if(!this._xml){const l=new i;(function c(u,d){u.openNode(d.tag,d.$),d.c&&d.c.forEach(h=>{c(u,h)}),d.t&&u.writeText(d.t),u.closeNode()})(l,this._model),this._xml=l.xml}o.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(o){switch(o){case this._model.tag:return!1;default:return!0}}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(e,n,s){const a=e("./text-xform"),i=e("./rich-text-xform"),o=e("../base-xform");n.exports=class extends o{constructor(){super(),this.map={r:new i,t:new a}}get tag(){return"rPh"}render(l,c){if(l.openNode(this.tag,{sb:c.sb||0,eb:c.eb||0}),c&&c.hasOwnProperty("richText")&&c.richText){const{r:u}=this.map;c.richText.forEach(d=>{u.render(l,d)})}else c&&this.map.t.render(l,c.text);l.closeNode()}parseOpen(l){const{name:c}=l;return this.parser?(this.parser.parseOpen(l),!0):c===this.tag?(this.model={sb:parseInt(l.attributes.sb,10),eb:parseInt(l.attributes.eb,10)},!0):(this.parser=this.map[c],!!this.parser&&(this.parser.parseOpen(l),!0))}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){switch(l){case"r":{let c=this.model.richText;c||(c=this.model.richText=[]),c.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(l){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(e,n,s){const a=e("./text-xform"),i=e("../style/font-xform"),o=e("../base-xform");class l extends o{constructor(u){super(),this.model=u}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new a)}get fontXform(){return this._fontXform||(this._fontXform=new i(l.FONT_OPTIONS))}render(u,d){d=d||this.model,u.openNode("r"),d.font&&this.fontXform.render(u,d.font),this.textXform.render(u,d.text),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(u),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){switch(u){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}}l.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},n.exports=l},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(e,n,s){const a=e("./text-xform"),i=e("./rich-text-xform"),o=e("./phonetic-text-xform"),l=e("../base-xform");n.exports=class extends l{constructor(c){super(),this.model=c,this.map={r:new i,t:new a,rPh:new o}}get tag(){return"si"}render(c,u){c.openNode(this.tag),u&&u.hasOwnProperty("richText")&&u.richText?u.richText.length?u.richText.forEach(d=>{this.map.r.render(c,d)}):this.map.t.render(c,""):u!=null&&this.map.t.render(c,u),c.closeNode()}parseOpen(c){const{name:u}=c;return this.parser?(this.parser.parseOpen(c),!0):u===this.tag?(this.model={},!0):(this.parser=this.map[u],!!this.parser&&(this.parser.parseOpen(c),!0))}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser){if(!this.parser.parseClose(c)){switch(c){case"r":{let u=this.model.richText;u||(u=this.model.richText=[]),u.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(c){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(e,n,s){const a=e("../../../utils/xml-stream"),i=e("../base-xform"),o=e("./shared-string-xform");n.exports=class extends i{constructor(l){super(),this.model=l||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new o)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(l){return this.model.values[l]}add(l){return l.richText?this.addRichText(l):this.addText(l)}addText(l){let c=this.hash[l];return c===void 0&&(c=this.hash[l]=this.model.values.length,this.model.values.push(l)),this.model.count++,c}addRichText(l){const c=this.sharedStringXform.toXml(l);let u=this.rich[c];return u===void 0&&(u=this.rich[c]=this.model.values.length,this.model.values.push(l)),this.model.count++,u}render(l,c){c=c||this._values,l.openXml(a.StdDocAttributes),l.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:c.count,uniqueCount:c.values.length});const u=this.sharedStringXform;c.values.forEach(d=>{u.render(l,d)}),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(l),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(l){case"sst":return!1;default:throw new Error("Unexpected xml node in parseClose: "+l)}}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"t"}render(i,o){i.openNode("t"),/^\s|\n|\s$/.test(o)&&i.addAttribute("xml:space","preserve"),i.writeText(o),i.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(i,o)=>String.fromCharCode(parseInt(o,16)))}parseOpen(i){switch(i.name){case"t":return this._text=[],!0;default:return!1}}parseText(i){this._text.push(i)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(e,n,s){const a=e("../../../doc/enums"),i=e("../../../utils/utils"),o=e("../base-xform"),l={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((u,d)=>(u[d]=!0,u),{}),horizontal(u){return this.horizontalValues[u]?u:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((u,d)=>(u[d]=!0,u),{}),vertical(u){return u==="middle"?"center":this.verticalValues[u]?u:void 0},wrapText:u=>!!u||void 0,shrinkToFit:u=>!!u||void 0,textRotation(u){switch(u){case"vertical":return u;default:return(u=i.validInt(u))>=-90&&u<=90?u:void 0}},indent:u=>(u=i.validInt(u),Math.max(0,u)),readingOrder(u){switch(u){case"ltr":return a.ReadingOrder.LeftToRight;case"rtl":return a.ReadingOrder.RightToLeft;default:return}}},c={toXml(u){if(u=l.textRotation(u)){if(u==="vertical")return 255;const d=Math.round(u);if(d>=0&&d<=90)return d;if(d<0&&d>=-90)return 90-d}},toModel(u){const d=i.validInt(u);if(d!==void 0){if(d===255)return"vertical";if(d>=0&&d<=90)return d;if(d>90&&d<=180)return 90-d}}};n.exports=class extends o{get tag(){return"alignment"}render(u,d){u.addRollback(),u.openNode("alignment");let h=!1;function f(g,m){m&&(u.addAttribute(g,m),h=!0)}f("horizontal",l.horizontal(d.horizontal)),f("vertical",l.vertical(d.vertical)),f("wrapText",!!l.wrapText(d.wrapText)&&"1"),f("shrinkToFit",!!l.shrinkToFit(d.shrinkToFit)&&"1"),f("indent",l.indent(d.indent)),f("textRotation",c.toXml(d.textRotation)),f("readingOrder",l.readingOrder(d.readingOrder)),u.closeNode(),h?u.commit():u.rollback()}parseOpen(u){const d={};let h=!1;function f(g,m,p){g&&(d[m]=p,h=!0)}f(u.attributes.horizontal,"horizontal",u.attributes.horizontal),f(u.attributes.vertical,"vertical",u.attributes.vertical==="center"?"middle":u.attributes.vertical),f(u.attributes.wrapText,"wrapText",i.parseBoolean(u.attributes.wrapText)),f(u.attributes.shrinkToFit,"shrinkToFit",i.parseBoolean(u.attributes.shrinkToFit)),f(u.attributes.indent,"indent",parseInt(u.attributes.indent,10)),f(u.attributes.textRotation,"textRotation",c.toModel(u.attributes.textRotation)),f(u.attributes.readingOrder,"readingOrder",u.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=h?d:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(e,n,s){const a=e("../base-xform"),i=e("../../../utils/utils"),o=e("./color-xform");class l extends a{constructor(u){super(),this.name=u,this.map={color:new o}}get tag(){return this.name}render(u,d,h){const f=d&&d.color||h||this.defaultColor;u.openNode(this.name),d&&d.style&&(u.addAttribute("style",d.style),f&&this.map.color.render(u,f)),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.name:{const{style:d}=u.attributes;return this.model=d?{style:d}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):(u===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(u){return l.validStyleValues[u]}}l.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((c,u)=>(c[u]=!0,c),{}),n.exports=class extends a{constructor(){super(),this.map={top:new l("top"),left:new l("left"),bottom:new l("bottom"),right:new l("right"),diagonal:new l("diagonal")}}render(c,u){const{color:d}=u;function h(f,g){f&&!f.color&&u.color&&(f={...f,color:u.color}),g.render(c,f,d)}c.openNode("border"),u.diagonal&&u.diagonal.style&&(u.diagonal.up&&c.addAttribute("diagonalUp","1"),u.diagonal.down&&c.addAttribute("diagonalDown","1")),h(u.left,this.map.left),h(u.right,this.map.right),h(u.top,this.map.top),h(u.bottom,this.map.bottom),h(u.diagonal,this.map.diagonal),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"border":return this.reset(),this.diagonalUp=i.parseBoolean(c.attributes.diagonalUp),this.diagonalDown=i.parseBoolean(c.attributes.diagonalDown),!0;default:return this.parser=this.map[c.name],!!this.parser&&(this.parser.parseOpen(c),!0)}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;if(c==="border"){const u=this.model={},d=function(h,f,g){f&&(g&&Object.assign(f,g),u[h]=f)};d("left",this.map.left.model),d("right",this.map.right.model),d("top",this.map.top.model),d("bottom",this.map.bottom.model),d("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{constructor(i){super(),this.name=i||"color"}get tag(){return this.name}render(i,o){return!!o&&(i.openNode(this.name),o.argb?i.addAttribute("rgb",o.argb):o.theme!==void 0?(i.addAttribute("theme",o.theme),o.tint!==void 0&&i.addAttribute("tint",o.tint)):o.indexed!==void 0?i.addAttribute("indexed",o.indexed):i.addAttribute("auto","1"),i.closeNode(),!0)}parseOpen(i){return i.name===this.name&&(i.attributes.rgb?this.model={argb:i.attributes.rgb}:i.attributes.theme?(this.model={theme:parseInt(i.attributes.theme,10)},i.attributes.tint&&(this.model.tint=parseFloat(i.attributes.tint))):i.attributes.indexed?this.model={indexed:parseInt(i.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(e,n,s){const a=e("../base-xform"),i=e("./alignment-xform"),o=e("./border-xform"),l=e("./fill-xform"),c=e("./font-xform"),u=e("./numfmt-xform"),d=e("./protection-xform");n.exports=class extends a{constructor(){super(),this.map={alignment:new i,border:new o,fill:new l,font:new c,numFmt:new u,protection:new d}}get tag(){return"dxf"}render(h,f){if(h.openNode(this.tag),f.font&&this.map.font.render(h,f.font),f.numFmt&&f.numFmtId){const g={id:f.numFmtId,formatCode:f.numFmt};this.map.numFmt.render(h,g)}f.fill&&this.map.fill.render(h,f.fill),f.alignment&&this.map.alignment.render(h,f.alignment),f.border&&this.map.border.render(h,f.border),f.protection&&this.map.protection.render(h,f.protection),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h),!0}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return this.parser?(this.parser.parseClose(h)||(this.parser=void 0),!0):h!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(e,n,s){const a=e("../base-xform"),i=e("./color-xform");class o extends a{constructor(){super(),this.map={color:new i}}get tag(){return"stop"}render(h,f){h.openNode("stop"),h.addAttribute("position",f.position),this.map.color.render(h,f.color),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"stop":return this.model={position:parseFloat(h.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(h),!0;default:return!1}}parseText(){}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class l extends a{constructor(){super(),this.map={fgColor:new i("fgColor"),bgColor:new i("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(h,f){h.openNode("patternFill"),h.addAttribute("patternType",f.pattern),f.fgColor&&this.map.fgColor.render(h,f.fgColor),f.bgColor&&this.map.bgColor.render(h,f.bgColor),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"patternFill":return this.model={type:"pattern",pattern:h.attributes.patternType},!0;default:return this.parser=this.map[h.name],!!this.parser&&(this.parser.parseOpen(h),!0)}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.parser.model&&(this.model[h]=this.parser.model),this.parser=void 0),!0)}}class c extends a{constructor(){super(),this.map={stop:new o}}get name(){return"gradient"}get tag(){return"gradientFill"}render(h,f){switch(h.openNode("gradientFill"),f.gradient){case"angle":h.addAttribute("degree",f.degree);break;case"path":h.addAttribute("type","path"),f.center.left&&(h.addAttribute("left",f.center.left),f.center.right===void 0&&h.addAttribute("right",f.center.left)),f.center.right&&h.addAttribute("right",f.center.right),f.center.top&&(h.addAttribute("top",f.center.top),f.center.bottom===void 0&&h.addAttribute("bottom",f.center.top)),f.center.bottom&&h.addAttribute("bottom",f.center.bottom)}const g=this.map.stop;f.stops.forEach(m=>{g.render(h,m)}),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"gradientFill":{const f=this.model={stops:[]};return h.attributes.degree?(f.gradient="angle",f.degree=parseInt(h.attributes.degree,10)):h.attributes.type==="path"&&(f.gradient="path",f.center={left:h.attributes.left?parseFloat(h.attributes.left):0,top:h.attributes.top?parseFloat(h.attributes.top):0},h.attributes.right!==h.attributes.left&&(f.center.right=h.attributes.right?parseFloat(h.attributes.right):0),h.attributes.bottom!==h.attributes.top&&(f.center.bottom=h.attributes.bottom?parseFloat(h.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(h),!0;default:return!1}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class u extends a{constructor(){super(),this.map={patternFill:new l,gradientFill:new c}}get tag(){return"fill"}render(h,f){switch(h.addRollback(),h.openNode("fill"),f.type){case"pattern":this.map.patternFill.render(h,f);break;case"gradient":this.map.gradientFill.render(h,f);break;default:return void h.rollback()}h.closeNode(),h.commit()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"fill":return this.model={},!0;default:return this.parser=this.map[h.name],!!this.parser&&(this.parser.parseOpen(h),!0)}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(h){return u.validPatternValues[h]}}u.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((d,h)=>(d[h]=!0,d),{}),u.StopXform=o,u.PatternFillXform=l,u.GradientFillXform=c,n.exports=u},{"../base-xform":32,"./color-xform":128}],131:[function(e,n,s){const a=e("./color-xform"),i=e("../simple/boolean-xform"),o=e("../simple/integer-xform"),l=e("../simple/string-xform"),c=e("./underline-xform"),u=e("../../../utils/under-dash"),d=e("../base-xform");class h extends d{constructor(g){super(),this.options=g||h.OPTIONS,this.map={b:{prop:"bold",xform:new i({tag:"b",attr:"val"})},i:{prop:"italic",xform:new i({tag:"i",attr:"val"})},u:{prop:"underline",xform:new c},charset:{prop:"charset",xform:new o({tag:"charset",attr:"val"})},color:{prop:"color",xform:new a},condense:{prop:"condense",xform:new i({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new i({tag:"extend",attr:"val"})},family:{prop:"family",xform:new o({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new i({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new l({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new l({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new i({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new i({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new o({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new l({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(g,m){const{map:p}=this;g.openNode(this.options.tagName),u.each(this.map,(v,b)=>{p[b].xform.render(g,m[v.prop])}),g.closeNode()}parseOpen(g){if(this.parser)return this.parser.parseOpen(g),!0;if(this.map[g.name])return this.parser=this.map[g.name].xform,this.parser.parseOpen(g);switch(g.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(g){this.parser&&this.parser.parseText(g)}parseClose(g){if(this.parser&&!this.parser.parseClose(g)){const m=this.map[g];return this.parser.model&&(this.model[m.prop]=this.parser.model),this.parser=void 0,!0}switch(g){case this.options.tagName:return!1;default:return!0}}}h.OPTIONS={tagName:"font",fontNameTag:"name"},n.exports=h},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(e,n,s){const a=e("../../../utils/under-dash"),i=e("../../defaultnumformats"),o=e("../base-xform"),l=function(){const u={};return a.each(i,(d,h)=>{d.f&&(u[d.f]=parseInt(h,10))}),u}();class c extends o{constructor(d,h){super(),this.id=d,this.formatCode=h}get tag(){return"numFmt"}render(d,h){d.leafNode("numFmt",{numFmtId:h.id,formatCode:h.formatCode})}parseOpen(d){switch(d.name){case"numFmt":return this.model={id:parseInt(d.attributes.numFmtId,10),formatCode:d.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}}c.getDefaultFmtId=function(u){return l[u]},c.getDefaultFmtCode=function(u){return i[u]&&i[u].f},n.exports=c},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(e,n,s){const a=e("../base-xform"),i={boolean:(o,l)=>o===void 0?l:o};n.exports=class extends a{get tag(){return"protection"}render(o,l){o.addRollback(),o.openNode("protection");let c=!1;function u(d,h){h!==void 0&&(o.addAttribute(d,h),c=!0)}u("locked",i.boolean(l.locked,!0)?void 0:"0"),u("hidden",i.boolean(l.hidden,!1)?"1":void 0),o.closeNode(),c?o.commit():o.rollback()}parseOpen(o){const l={locked:o.attributes.locked!=="0",hidden:o.attributes.hidden==="1"},c=!l.locked||l.hidden;this.model=c?l:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(e,n,s){const a=e("../base-xform"),i=e("./alignment-xform"),o=e("./protection-xform");n.exports=class extends a{constructor(l){super(),this.xfId=!(!l||!l.xfId),this.map={alignment:new i,protection:new o}}get tag(){return"xf"}render(l,c){l.openNode("xf",{numFmtId:c.numFmtId||0,fontId:c.fontId||0,fillId:c.fillId||0,borderId:c.borderId||0}),this.xfId&&l.addAttribute("xfId",c.xfId||0),c.numFmtId&&l.addAttribute("applyNumberFormat","1"),c.fontId&&l.addAttribute("applyFont","1"),c.fillId&&l.addAttribute("applyFill","1"),c.borderId&&l.addAttribute("applyBorder","1"),c.alignment&&l.addAttribute("applyAlignment","1"),c.protection&&l.addAttribute("applyProtection","1"),c.alignment&&this.map.alignment.render(l,c.alignment),c.protection&&this.map.protection.render(l,c.protection),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"xf":return this.model={numFmtId:parseInt(l.attributes.numFmtId,10),fontId:parseInt(l.attributes.fontId,10),fillId:parseInt(l.attributes.fillId,10),borderId:parseInt(l.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(l.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(l),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(l),!0;default:return!1}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):l!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(e,n,s){const a=e("../../../doc/enums"),i=e("../../../utils/xml-stream"),o=e("../base-xform"),l=e("../static-xform"),c=e("../list-xform"),u=e("./font-xform"),d=e("./fill-xform"),h=e("./border-xform"),f=e("./numfmt-xform"),g=e("./style-xform"),m=e("./dxf-xform");class p extends o{constructor(b){super(),this.map={numFmts:new c({tag:"numFmts",count:!0,childXform:new f}),fonts:new c({tag:"fonts",count:!0,childXform:new u,$:{"x14ac:knownFonts":1}}),fills:new c({tag:"fills",count:!0,childXform:new d}),borders:new c({tag:"borders",count:!0,childXform:new h}),cellStyleXfs:new c({tag:"cellStyleXfs",count:!0,childXform:new g}),cellXfs:new c({tag:"cellXfs",count:!0,childXform:new g({xfId:!0})}),dxfs:new c({tag:"dxfs",always:!0,count:!0,childXform:new m}),numFmt:new f,font:new u,fill:new d,border:new h,style:new g({xfId:!0}),cellStyles:p.STATIC_XFORMS.cellStyles,tableStyles:p.STATIC_XFORMS.tableStyles,extLst:p.STATIC_XFORMS.extLst},b&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(b,y){y=y||this.model,b.openXml(i.StdDocAttributes),b.openNode("styleSheet",p.STYLESHEET_ATTRIBUTES),this.index?(y.numFmts&&y.numFmts.length&&(b.openNode("numFmts",{count:y.numFmts.length}),y.numFmts.forEach(k=>{b.writeXml(k)}),b.closeNode()),y.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),b.openNode("fonts",{count:y.fonts.length,"x14ac:knownFonts":1}),y.fonts.forEach(k=>{b.writeXml(k)}),b.closeNode(),b.openNode("fills",{count:y.fills.length}),y.fills.forEach(k=>{b.writeXml(k)}),b.closeNode(),b.openNode("borders",{count:y.borders.length}),y.borders.forEach(k=>{b.writeXml(k)}),b.closeNode(),this.map.cellStyleXfs.render(b,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),b.openNode("cellXfs",{count:y.styles.length}),y.styles.forEach(k=>{b.writeXml(k)}),b.closeNode()):(this.map.numFmts.render(b,y.numFmts),this.map.fonts.render(b,y.fonts),this.map.fills.render(b,y.fills),this.map.borders.render(b,y.borders),this.map.cellStyleXfs.render(b,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(b,y.styles)),p.STATIC_XFORMS.cellStyles.render(b),this.map.dxfs.render(b,y.dxfs),p.STATIC_XFORMS.tableStyles.render(b),p.STATIC_XFORMS.extLst.render(b),b.closeNode()}parseOpen(b){if(this.parser)return this.parser.parseOpen(b),!0;switch(b.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[b.name],this.parser&&this.parser.parseOpen(b),!0}}parseText(b){this.parser&&this.parser.parseText(b)}parseClose(b){if(this.parser)return this.parser.parseClose(b)||(this.parser=void 0),!0;switch(b){case"styleSheet":{this.model={};const y=(k,N)=>{N.model&&N.model.length&&(this.model[k]=N.model)};if(y("numFmts",this.map.numFmts),y("fonts",this.map.fonts),y("fills",this.map.fills),y("borders",this.map.borders),y("styles",this.map.cellXfs),y("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const k=this.index.numFmt;this.model.numFmts.forEach(N=>{k[N.id]=N.formatCode})}return!1}default:return!0}}addStyleModel(b,y){if(!b)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(b))return this.weakMap.get(b);const k={};if(y=y||a.ValueType.Number,b.numFmt)k.numFmtId=this._addNumFmtStr(b.numFmt);else switch(y){case a.ValueType.Number:k.numFmtId=this._addNumFmtStr("General");break;case a.ValueType.Date:k.numFmtId=this._addNumFmtStr("mm-dd-yy")}b.font&&(k.fontId=this._addFont(b.font)),b.border&&(k.borderId=this._addBorder(b.border)),b.fill&&(k.fillId=this._addFill(b.fill)),b.alignment&&(k.alignment=b.alignment),b.protection&&(k.protection=b.protection);const N=this._addStyle(k);return this.weakMap&&this.weakMap.set(b,N),N}getStyleModel(b){const y=this.model.styles[b];if(!y)return null;let k=this.index.model[b];if(k)return k;if(k=this.index.model[b]={},y.numFmtId){const L=this.index.numFmt[y.numFmtId]||f.getDefaultFmtCode(y.numFmtId);L&&(k.numFmt=L)}function N(L,F,R){if(R||R===0){const B=F[R];B&&(k[L]=B)}}return N("font",this.model.fonts,y.fontId),N("border",this.model.borders,y.borderId),N("fill",this.model.fills,y.fillId),y.alignment&&(k.alignment=y.alignment),y.protection&&(k.protection=y.protection),k}addDxfStyle(b){return b.numFmt&&(b.numFmtId=this._addNumFmtStr(b.numFmt)),this.model.dxfs.push(b),this.model.dxfs.length-1}getDxfStyle(b){return this.model.dxfs[b]}_addStyle(b){const y=this.map.style.toXml(b);let k=this.index.style[y];return k===void 0&&(k=this.index.style[y]=this.model.styles.length,this.model.styles.push(y)),k}_addNumFmtStr(b){let y=f.getDefaultFmtId(b);if(y!==void 0||(y=this.index.numFmt[b],y!==void 0))return y;y=this.index.numFmt[b]=164+this.model.numFmts.length;const k=this.map.numFmt.toXml({id:y,formatCode:b});return this.model.numFmts.push(k),y}_addFont(b){const y=this.map.font.toXml(b);let k=this.index.font[y];return k===void 0&&(k=this.index.font[y]=this.model.fonts.length,this.model.fonts.push(y)),k}_addBorder(b){const y=this.map.border.toXml(b);let k=this.index.border[y];return k===void 0&&(k=this.index.border[y]=this.model.borders.length,this.model.borders.push(y)),k}_addFill(b){const y=this.map.fill.toXml(b);let k=this.index.fill[y];return k===void 0&&(k=this.index.fill[y]=this.model.fills.length,this.model.fills.push(y)),k}}p.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},p.STATIC_XFORMS={cellStyles:new l({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new l({tag:"dxfs",$:{count:0}}),tableStyles:new l({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new l({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},p.Mock=class extends p{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(v){return v.autodrain(),Promise.resolve()}addStyleModel(v,b){switch(b){case a.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){const v={numFmtId:f.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(v)}return this._dateStyleId}getStyleModel(){return{}}},n.exports=p},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(e,n,s){const a=e("../base-xform");class i extends a{constructor(l){super(),this.model=l}get tag(){return"u"}render(l,c){if((c=c||this.model)===!0)l.leafNode("u");else{const u=i.Attributes[c];u&&l.leafNode("u",u)}}parseOpen(l){l.name==="u"&&(this.model=l.attributes.val||!0)}parseText(){}parseClose(){return!1}}i.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},n.exports=i},{"../base-xform":32}],137:[function(e,n,s){const a=e("../base-xform"),i=e("./filter-column-xform");n.exports=class extends a{constructor(){super(),this.map={filterColumn:new i}}get tag(){return"autoFilter"}prepare(o){o.columns.forEach((l,c)=>{this.map.filterColumn.prepare(l,{index:c})})}render(o,l){return o.openNode(this.tag,{ref:l.autoFilterRef}),l.columns.forEach(c=>{this.map.filterColumn.render(o,c)}),o.closeNode(),!0}parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case this.tag:return this.model={autoFilterRef:o.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[o.name],this.parser)return this.parseOpen(o),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(o))}}parseText(o){this.parser&&this.parser.parseText(o)}parseClose(o){if(this.parser)return this.parser.parseClose(o)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(o){case this.tag:return!1;default:throw new Error("Unexpected xml node in parseClose: "+o)}}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"customFilter"}render(i,o){i.leafNode(this.tag,{val:o.val,operator:o.operator})}parseOpen(i){return i.name===this.tag&&(this.model={val:i.attributes.val,operator:i.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(e,n,s){const a=e("../base-xform"),i=e("../list-xform"),o=e("./custom-filter-xform"),l=e("./filter-xform");n.exports=class extends a{constructor(){super(),this.map={customFilters:new i({tag:"customFilters",count:!1,empty:!0,childXform:new o}),filters:new i({tag:"filters",count:!1,empty:!0,childXform:new l})}}get tag(){return"filterColumn"}prepare(c,u){c.colId=u.index.toString()}render(c,u){return u.customFilters?(c.openNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),this.map.customFilters.render(c,u.customFilters),c.closeNode(),!0):(c.leafNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),!0)}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;const{attributes:u}=c;switch(c.name){case this.tag:return this.model={filterButton:u.hiddenButton==="0"},!0;default:if(this.parser=this.map[c.name],this.parser)return this.parseOpen(c),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(c))}}parseText(){}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model.customFilters=this.map.customFilters.model,!1;default:return!0}}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"filter"}render(i,o){i.leafNode(this.tag,{val:o.val})}parseOpen(i){return i.name===this.tag&&(this.model={val:i.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"tableColumn"}prepare(i,o){i.id=o.index+1}render(i,o){return i.leafNode(this.tag,{id:o.id.toString(),name:o.name,totalsRowLabel:o.totalsRowLabel,totalsRowFunction:o.totalsRowFunction,dxfId:o.dxfId}),!0}parseOpen(i){if(i.name===this.tag){const{attributes:o}=i;return this.model={name:o.name,totalsRowLabel:o.totalsRowLabel,totalsRowFunction:o.totalsRowFunction,dxfId:o.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(e,n,s){const a=e("../base-xform");n.exports=class extends a{get tag(){return"tableStyleInfo"}render(i,o){return i.leafNode(this.tag,{name:o.theme?o.theme:void 0,showFirstColumn:o.showFirstColumn?"1":"0",showLastColumn:o.showLastColumn?"1":"0",showRowStripes:o.showRowStripes?"1":"0",showColumnStripes:o.showColumnStripes?"1":"0"}),!0}parseOpen(i){if(i.name===this.tag){const{attributes:o}=i;return this.model={theme:o.name?o.name:null,showFirstColumn:o.showFirstColumn==="1",showLastColumn:o.showLastColumn==="1",showRowStripes:o.showRowStripes==="1",showColumnStripes:o.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(e,n,s){const a=e("../../../utils/xml-stream"),i=e("../base-xform"),o=e("../list-xform"),l=e("./auto-filter-xform"),c=e("./table-column-xform"),u=e("./table-style-info-xform");class d extends i{constructor(){super(),this.map={autoFilter:new l,tableColumns:new o({tag:"tableColumns",count:!0,empty:!0,childXform:new c}),tableStyleInfo:new u}}prepare(f,g){this.map.autoFilter.prepare(f),this.map.tableColumns.prepare(f.columns,g)}get tag(){return"table"}render(f,g){f.openXml(a.StdDocAttributes),f.openNode(this.tag,{...d.TABLE_ATTRIBUTES,id:g.id,name:g.name,displayName:g.displayName||g.name,ref:g.tableRef,totalsRowCount:g.totalsRow?"1":void 0,totalsRowShown:g.totalsRow?void 0:"1",headerRowCount:g.headerRow?"1":"0"}),this.map.autoFilter.render(f,g),this.map.tableColumns.render(f,g.columns),this.map.tableStyleInfo.render(f,g.style),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;const{name:g,attributes:m}=f;switch(g){case this.tag:this.reset(),this.model={name:m.name,displayName:m.displayName||m.name,tableRef:m.ref,totalsRow:m.totalsRowCount==="1",headerRow:m.headerRowCount==="1"};break;default:this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f)}return!0}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((g,m)=>{this.model.columns[m].filterButton=g.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(f,g){f.columns.forEach(m=>{m.dxfId!==void 0&&(m.style=g.styles.getDxfStyle(m.dxfId))})}}d.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},n.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(e,n,s){(function(a,i){(function(){const o=e("fs"),l=e("jszip"),{PassThrough:c}=e("readable-stream"),u=e("../utils/zip-stream"),d=e("../utils/stream-buf"),h=e("../utils/utils"),f=e("../utils/xml-stream"),{bufferToString:g}=e("../utils/browser-buffer-decode"),m=e("./xform/style/styles-xform"),p=e("./xform/core/core-xform"),v=e("./xform/strings/shared-strings-xform"),b=e("./xform/core/relationships-xform"),y=e("./xform/core/content-types-xform"),k=e("./xform/core/app-xform"),N=e("./xform/book/workbook-xform"),L=e("./xform/sheet/worksheet-xform"),F=e("./xform/drawing/drawing-xform"),R=e("./xform/table/table-xform"),B=e("./xform/comment/comments-xform"),q=e("./xform/comment/vml-notes-xform"),V=e("./xml/theme1");class I{constructor(O){this.workbook=O}async readFile(O,E){if(!await h.fs.exists(O))throw new Error("File not found: "+O);const x=o.createReadStream(O);try{const w=await this.read(x,E);return x.close(),w}catch(w){throw x.close(),w}}parseRels(O){return new b().parseStream(O)}parseWorkbook(O){return new N().parseStream(O)}parseSharedStrings(O){return new v().parseStream(O)}reconcile(O,E){const x=new N,w=new L(E),_=new F,S=new R;x.reconcile(O);const T={media:O.media,mediaIndex:O.mediaIndex};Object.keys(O.drawings).forEach(H=>{const z=O.drawings[H],K=O.drawingRels[H];K&&(T.rels=K.reduce((j,J)=>(j[J.Id]=J,j),{}),(z.anchors||[]).forEach(j=>{const J=j.picture&&j.picture.hyperlinks;J&&T.rels[J.rId]&&(J.hyperlink=T.rels[J.rId].Target,delete J.rId)}),_.reconcile(z,T))});const U={styles:O.styles};Object.values(O.tables).forEach(H=>{S.reconcile(H,U)});const A={styles:O.styles,sharedStrings:O.sharedStrings,media:O.media,mediaIndex:O.mediaIndex,date1904:O.properties&&O.properties.date1904,drawings:O.drawings,comments:O.comments,tables:O.tables,vmlDrawings:O.vmlDrawings};O.worksheets.forEach(H=>{H.relationships=O.worksheetRels[H.sheetNo],w.reconcile(H,A)}),delete O.worksheetHash,delete O.worksheetRels,delete O.globalRels,delete O.sharedStrings,delete O.workbookRels,delete O.sheetDefs,delete O.styles,delete O.mediaIndex,delete O.drawings,delete O.drawingRels,delete O.vmlDrawings}async _processWorksheetEntry(O,E,x,w,_){const S=new L(w),T=await S.parseStream(O);T.sheetNo=x,E.worksheetHash[_]=T,E.worksheets.push(T)}async _processCommentEntry(O,E,x){const w=new B,_=await w.parseStream(O);E.comments[`../${x}.xml`]=_}async _processTableEntry(O,E,x){const w=new R,_=await w.parseStream(O);E.tables[`../tables/${x}.xml`]=_}async _processWorksheetRelsEntry(O,E,x){const w=new b,_=await w.parseStream(O);E.worksheetRels[x]=_}async _processMediaEntry(O,E,x){const w=x.lastIndexOf(".");if(w>=1){const _=x.substr(w+1),S=x.substr(0,w);await new Promise((T,U)=>{const A=new d;A.on("finish",()=>{E.mediaIndex[x]=E.media.length,E.mediaIndex[S]=E.media.length;const H={type:"image",name:S,extension:_,buffer:A.toBuffer()};E.media.push(H),T()}),O.on("error",H=>{U(H)}),O.pipe(A)})}}async _processDrawingEntry(O,E,x){const w=new F,_=await w.parseStream(O);E.drawings[x]=_}async _processDrawingRelsEntry(O,E,x){const w=new b,_=await w.parseStream(O);E.drawingRels[x]=_}async _processVmlDrawingEntry(O,E,x){const w=new q,_=await w.parseStream(O);E.vmlDrawings[`../drawings/${x}.vml`]=_}async _processThemeEntry(O,E,x){await new Promise((w,_)=>{const S=new d;O.on("error",_),S.on("error",_),S.on("finish",()=>{E.themes[x]=S.read().toString(),w()}),O.pipe(S)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(O,E){!O[Symbol.asyncIterator]&&O.pipe&&(O=O.pipe(new c));const x=[];for await(const w of O)x.push(w);return this.load(i.concat(x),E)}async load(O,E){let x;x=E&&E.base64?i.from(O.toString(),"base64"):O;const w={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},_=await l.loadAsync(x);for(const S of Object.values(_.files))if(!S.dir){let T,U=S.name;if(U[0]==="/"&&(U=U.substr(1)),U.match(/xl\/media\//)||U.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))T=new c,T.write(await S.async("nodebuffer"));else{let A;T=new c({writableObjectMode:!0,readableObjectMode:!0}),A=a.browser?g(await S.async("nodebuffer")):await S.async("string");const H=16384;for(let z=0;z<A.length;z+=H)T.write(A.substring(z,z+H))}switch(T.end(),U){case"_rels/.rels":w.globalRels=await this.parseRels(T);break;case"xl/workbook.xml":{const A=await this.parseWorkbook(T);w.sheets=A.sheets,w.definedNames=A.definedNames,w.views=A.views,w.properties=A.properties,w.calcProperties=A.calcProperties;break}case"xl/_rels/workbook.xml.rels":w.workbookRels=await this.parseRels(T);break;case"xl/sharedStrings.xml":w.sharedStrings=new v,await w.sharedStrings.parseStream(T);break;case"xl/styles.xml":w.styles=new m,await w.styles.parseStream(T);break;case"docProps/app.xml":{const A=new k,H=await A.parseStream(T);w.company=H.company,w.manager=H.manager;break}case"docProps/core.xml":{const A=new p,H=await A.parseStream(T);Object.assign(w,H);break}default:{let A=U.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(A){await this._processWorksheetEntry(T,w,A[1],E,U);break}if(A=U.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),A){await this._processWorksheetRelsEntry(T,w,A[1]);break}if(A=U.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),A){await this._processThemeEntry(T,w,A[1]);break}if(A=U.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),A){await this._processMediaEntry(T,w,A[1]);break}if(A=U.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),A){await this._processDrawingEntry(T,w,A[1]);break}if(A=U.match(/xl\/(comments\d+)[.]xml/),A){await this._processCommentEntry(T,w,A[1]);break}if(A=U.match(/xl\/tables\/(table\d+)[.]xml/),A){await this._processTableEntry(T,w,A[1]);break}if(A=U.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),A){await this._processDrawingRelsEntry(T,w,A[1]);break}if(A=U.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),A){await this._processVmlDrawingEntry(T,w,A[1]);break}}}}return this.reconcile(w,E),this.workbook.model=w,this.workbook}async addMedia(O,E){await Promise.all(E.media.map(async x=>{if(x.type==="image"){const w=`xl/media/${x.name}.${x.extension}`;if(x.filename){const _=await function(S,T){return new Promise((U,A)=>{o.readFile(S,T,(H,z)=>{H?A(H):U(z)})})}(x.filename);return O.append(_,{name:w})}if(x.buffer)return O.append(x.buffer,{name:w});if(x.base64){const _=x.base64,S=_.substring(_.indexOf(",")+1);return O.append(S,{name:w,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(O,E){const x=new F,w=new b;E.worksheets.forEach(_=>{const{drawing:S}=_;if(S){x.prepare(S,{});let T=x.toXml(S);O.append(T,{name:`xl/drawings/${S.name}.xml`}),T=w.toXml(S.rels),O.append(T,{name:`xl/drawings/_rels/${S.name}.xml.rels`})}})}addTables(O,E){const x=new R;E.worksheets.forEach(w=>{const{tables:_}=w;_.forEach(S=>{x.prepare(S,{});const T=x.toXml(S);O.append(T,{name:"xl/tables/"+S.target})})})}async addContentTypes(O,E){const x=new y().toXml(E);O.append(x,{name:"[Content_Types].xml"})}async addApp(O,E){const x=new k().toXml(E);O.append(x,{name:"docProps/app.xml"})}async addCore(O,E){const x=new p;O.append(x.toXml(E),{name:"docProps/core.xml"})}async addThemes(O,E){const x=E.themes||{theme1:V};Object.keys(x).forEach(w=>{const _=x[w],S=`xl/theme/${w}.xml`;O.append(_,{name:S})})}async addOfficeRels(O){const E=new b().toXml([{Id:"rId1",Type:I.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:I.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:I.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);O.append(E,{name:"_rels/.rels"})}async addWorkbookRels(O,E){let x=1;const w=[{Id:"rId"+x++,Type:I.RelType.Styles,Target:"styles.xml"},{Id:"rId"+x++,Type:I.RelType.Theme,Target:"theme/theme1.xml"}];E.sharedStrings.count&&w.push({Id:"rId"+x++,Type:I.RelType.SharedStrings,Target:"sharedStrings.xml"}),E.worksheets.forEach(S=>{S.rId="rId"+x++,w.push({Id:S.rId,Type:I.RelType.Worksheet,Target:`worksheets/sheet${S.id}.xml`})});const _=new b().toXml(w);O.append(_,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(O,E){E.sharedStrings&&E.sharedStrings.count&&O.append(E.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(O,E){const{xml:x}=E.styles;x&&O.append(x,{name:"xl/styles.xml"})}async addWorkbook(O,E){const x=new N;O.append(x.toXml(E),{name:"xl/workbook.xml"})}async addWorksheets(O,E){const x=new L,w=new b,_=new B,S=new q;E.worksheets.forEach(T=>{let U=new f;x.render(U,T),O.append(U.xml,{name:`xl/worksheets/sheet${T.id}.xml`}),T.rels&&T.rels.length&&(U=new f,w.render(U,T.rels),O.append(U.xml,{name:`xl/worksheets/_rels/sheet${T.id}.xml.rels`})),T.comments.length>0&&(U=new f,_.render(U,T),O.append(U.xml,{name:`xl/comments${T.id}.xml`}),U=new f,S.render(U,T),O.append(U.xml,{name:`xl/drawings/vmlDrawing${T.id}.vml`}))})}_finalize(O){return new Promise((E,x)=>{O.on("finish",()=>{E(this)}),O.on("error",x),O.finalize()})}prepareModel(O,E){O.creator=O.creator||"ExcelJS",O.lastModifiedBy=O.lastModifiedBy||"ExcelJS",O.created=O.created||new Date,O.modified=O.modified||new Date,O.useSharedStrings=E.useSharedStrings===void 0||E.useSharedStrings,O.useStyles=E.useStyles===void 0||E.useStyles,O.sharedStrings=new v,O.styles=O.useStyles?new m(!0):new m.Mock;const x=new N,w=new L;x.prepare(O);const _={sharedStrings:O.sharedStrings,styles:O.styles,date1904:O.properties.date1904,drawingsCount:0,media:O.media};_.drawings=O.drawings=[],_.commentRefs=O.commentRefs=[];let S=0;O.tables=[],O.worksheets.forEach(T=>{T.tables.forEach(U=>{S++,U.target=`table${S}.xml`,U.id=S,O.tables.push(U)}),w.prepare(T,_)})}async write(O,E){E=E||{};const{model:x}=this.workbook,w=new u.ZipWriter(E.zip);return w.pipe(O),this.prepareModel(x,E),await this.addContentTypes(w,x),await this.addOfficeRels(w,x),await this.addWorkbookRels(w,x),await this.addWorksheets(w,x),await this.addSharedStrings(w,x),await this.addDrawings(w,x),await this.addTables(w,x),await Promise.all([this.addThemes(w,x),this.addStyles(w,x)]),await this.addMedia(w,x),await Promise.all([this.addApp(w,x),this.addCore(w,x)]),await this.addWorkbook(w,x),this._finalize(w)}writeFile(O,E){const x=o.createWriteStream(O);return new Promise((w,_)=>{x.on("finish",()=>{w()}),x.on("error",S=>{_(S)}),this.write(x,E).then(()=>{x.end()}).catch(S=>{_(S)})})}async writeBuffer(O){const E=new d;return await this.write(E,O),E.read()}}I.RelType=e("./rel-type"),n.exports=I}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(e,n,s){n.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(e,n,s){(function(a){(function(){Object.defineProperty(s,"__esModule",{value:!0}),s.CsvFormatterStream=void 0;const i=e("stream"),o=e("./formatter");class l extends i.Transform{constructor(u){super({writableObjectMode:u.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=u,this.rowFormatter=new o.RowFormatter(u),this.hasWrittenBOM=!u.writeBOM}transform(u){return this.rowFormatter.rowTransform=u,this}_transform(u,d,h){let f=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(u,(g,m)=>g?(f=!0,h(g)):(m&&m.forEach(p=>{this.push(a.from(p,"utf8"))}),f=!0,h()))}catch(g){if(f)throw g;h(g)}}_flush(u){this.rowFormatter.finish((d,h)=>d?u(d):(h&&h.forEach(f=>{this.push(a.from(f,"utf8"))}),u()))}}s.CsvFormatterStream=l}).call(this)}).call(this,e("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.FormatterOptions=void 0,s.FormatterOptions=class{constructor(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var i;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,a||{}),(a==null?void 0:a.quoteHeaders)===void 0&&(this.quoteHeaders=this.quoteColumns),(a==null?void 0:a.quote)===!0?this.quote='"':(a==null?void 0:a.quote)===!1&&(this.quote=""),typeof(a==null?void 0:a.escape)!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((i=a.writeHeaders)===null||i===void 0||i),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(e,n,s){var a=function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(s,"__esModule",{value:!0}),s.FieldFormatter=void 0;const i=a(e("lodash.isboolean")),o=a(e("lodash.isnil")),l=a(e("lodash.escaperegexp"));s.FieldFormatter=class{constructor(c){this._headers=null,this.formatterOptions=c,c.headers!==null&&(this.headers=c.headers),this.REPLACE_REGEXP=new RegExp(c.quote,"g");const u=`[${c.delimiter}${l.default(c.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(u)}set headers(c){this._headers=c}shouldQuote(c,u){const d=u?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return i.default(d)?d:Array.isArray(d)?d[c]:this._headers!==null&&d[this._headers[c]]}format(c,u,d){const h=(""+(o.default(c)?"":c)).replace(/\0/g,""),{formatterOptions:f}=this;return f.quote!==""&&h.indexOf(f.quote)!==-1?this.quoteField(h.replace(this.REPLACE_REGEXP,f.escapedQuote)):h.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(u,d)?this.quoteField(h):h}quoteField(c){const{quote:u}=this.formatterOptions;return`${u}${c}${u}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(e,n,s){var a=function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(s,"__esModule",{value:!0}),s.RowFormatter=void 0;const i=a(e("lodash.isfunction")),o=a(e("lodash.isequal")),l=e("./FieldFormatter"),c=e("../types");class u{constructor(h){this.rowCount=0,this.formatterOptions=h,this.fieldFormatter=new l.FieldFormatter(h),this.headers=h.headers,this.shouldWriteHeaders=h.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),h.transform&&(this.rowTransform=h.transform)}static isRowHashArray(h){return!!Array.isArray(h)&&Array.isArray(h[0])&&h[0].length===2}static isRowArray(h){return Array.isArray(h)&&!this.isRowHashArray(h)}static gatherHeaders(h){return u.isRowHashArray(h)?h.map(f=>f[0]):Array.isArray(h)?h:Object.keys(h)}static createTransform(h){return c.isSyncTransform(h)?(f,g)=>{let m=null;try{m=h(f)}catch(p){return g(p)}return g(null,m)}:(f,g)=>{h(f,g)}}set rowTransform(h){if(!i.default(h))throw new TypeError("The transform should be a function");this._rowTransform=u.createTransform(h)}format(h,f){this.callTransformer(h,(g,m)=>{if(g)return f(g);if(!h)return f(null);const p=[];if(m){const{shouldFormatColumns:v,headers:b}=this.checkHeaders(m);if(this.shouldWriteHeaders&&b&&!this.hasWrittenHeaders&&(p.push(this.formatColumns(b,!0)),this.hasWrittenHeaders=!0),v){const y=this.gatherColumns(m);p.push(this.formatColumns(y,!1))}}return f(null,p)})}finish(h){const f=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return h(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));f.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&f.push(this.formatterOptions.rowDelimiter),h(null,f)}checkHeaders(h){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const f=u.gatherHeaders(h);return this.headers=f,this.fieldFormatter.headers=f,this.shouldWriteHeaders?{shouldFormatColumns:!o.default(f,h),headers:f}:{shouldFormatColumns:!0,headers:null}}gatherColumns(h){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(h)?u.isRowHashArray(h)?this.headers.map((f,g)=>{const m=h[g];return m?m[1]:""}):u.isRowArray(h)&&!this.shouldWriteHeaders?h:this.headers.map((f,g)=>h[g]):this.headers.map(f=>h[f])}callTransformer(h,f){return this._rowTransform?this._rowTransform(h,f):f(null,h)}formatColumns(h,f){const g=h.map((p,v)=>this.fieldFormatter.format(p,v,f)).join(this.formatterOptions.delimiter),{rowCount:m}=this;return this.rowCount+=1,m?[this.formatterOptions.rowDelimiter,g].join(""):g}}s.RowFormatter=u},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.FieldFormatter=s.RowFormatter=void 0;var a=e("./RowFormatter");Object.defineProperty(s,"RowFormatter",{enumerable:!0,get:function(){return a.RowFormatter}});var i=e("./FieldFormatter");Object.defineProperty(s,"FieldFormatter",{enumerable:!0,get:function(){return i.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(e,n,s){(function(a){(function(){var i=Object.create?function(v,b,y,k){k===void 0&&(k=y),Object.defineProperty(v,k,{enumerable:!0,get:function(){return b[y]}})}:function(v,b,y,k){k===void 0&&(k=y),v[k]=b[y]},o=Object.create?function(v,b){Object.defineProperty(v,"default",{enumerable:!0,value:b})}:function(v,b){v.default=b},l=function(v){if(v&&v.__esModule)return v;var b={};if(v!=null)for(var y in v)y!=="default"&&Object.prototype.hasOwnProperty.call(v,y)&&i(b,v,y);return o(b,v),b},c=function(v,b){for(var y in v)y==="default"||Object.prototype.hasOwnProperty.call(b,y)||i(b,v,y)};Object.defineProperty(s,"__esModule",{value:!0}),s.writeToPath=s.writeToString=s.writeToBuffer=s.writeToStream=s.write=s.format=s.FormatterOptions=s.CsvFormatterStream=void 0;const u=e("util"),d=e("stream"),h=l(e("fs")),f=e("./FormatterOptions"),g=e("./CsvFormatterStream");c(e("./types"),s);var m=e("./CsvFormatterStream");Object.defineProperty(s,"CsvFormatterStream",{enumerable:!0,get:function(){return m.CsvFormatterStream}});var p=e("./FormatterOptions");Object.defineProperty(s,"FormatterOptions",{enumerable:!0,get:function(){return p.FormatterOptions}}),s.format=v=>new g.CsvFormatterStream(new f.FormatterOptions(v)),s.write=(v,b)=>{const y=s.format(b),k=u.promisify((N,L)=>{y.write(N,void 0,L)});return v.reduce((N,L)=>N.then(()=>k(L)),Promise.resolve()).then(()=>y.end()).catch(N=>{y.emit("error",N)}),y},s.writeToStream=(v,b,y)=>s.write(b,y).pipe(v),s.writeToBuffer=function(v){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const y=[],k=new d.Writable({write(N,L,F){y.push(N),F()}});return new Promise((N,L)=>{k.on("error",L).on("finish",()=>N(a.concat(y))),s.write(v,b).pipe(k)})},s.writeToString=(v,b)=>s.writeToBuffer(v,b).then(y=>y.toString()),s.writeToPath=(v,b,y)=>{const k=h.createWriteStream(v,{encoding:"utf8"});return s.write(b,y).pipe(k)}}).call(this)}).call(this,e("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.isSyncTransform=void 0,s.isSyncTransform=a=>a.length===1},{}],153:[function(e,n,s){(function(a){(function(){Object.defineProperty(s,"__esModule",{value:!0}),s.CsvParserStream=void 0;const i=e("string_decoder"),o=e("stream"),l=e("./transforms"),c=e("./parser");class u extends o.Transform{constructor(h){super({objectMode:h.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=h,this.parser=new c.Parser(h),this.headerTransformer=new l.HeaderTransformer(h),this.decoder=new i.StringDecoder(h.encoding),this.rowTransformerValidator=new l.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(h){return this.rowTransformerValidator.rowTransform=h,this}validate(h){return this.rowTransformerValidator.rowValidator=h,this}emit(h){if(h==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var f=arguments.length,g=new Array(f>1?f-1:0),m=1;m<f;m++)g[m-1]=arguments[m];return super.emit(h,...g)}_transform(h,f,g){if(this.hasHitRowLimit)return g();const m=u.wrapDoneCallback(g);try{const{lines:p}=this,v=p+this.decoder.write(h),b=this.parse(v,!0);return this.processRows(b,m)}catch(p){return m(p)}}_flush(h){const f=u.wrapDoneCallback(h);if(this.hasHitRowLimit)return f();try{const g=this.lines+this.decoder.end(),m=this.parse(g,!1);return this.processRows(m,f)}catch(g){return f(g)}}parse(h,f){if(!h)return[];const{line:g,rows:m}=this.parser.parse(h,f);return this.lines=g,m}processRows(h,f){const g=h.length,m=p=>{const v=k=>k?f(k):p%100!=0?m(p+1):void a(()=>m(p+1));if(this.checkAndEmitHeaders(),p>=g||this.hasHitRowLimit)return f();if(this.parsedLineCount+=1,this.shouldSkipLine)return v();const b=h[p];this.rowCount+=1,this.parsedRowCount+=1;const y=this.rowCount;return this.transformRow(b,(k,N)=>{if(k)return this.rowCount-=1,v(k);if(!N)return v(new Error("expected transform result"));if(N.isValid){if(N.row)return this.pushRow(N.row,v)}else this.emit("data-invalid",N.row,y,N.reason);return v()})};m(0)}transformRow(h,f){try{this.headerTransformer.transform(h,(g,m)=>g?f(g):m?m.isValid?m.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(m.row,f):this.skipRow(f):(this.rowCount-=1,this.parsedRowCount-=1,f(null,{row:null,isValid:!0})):this.shouldEmitRows?f(null,{isValid:!1,row:h}):this.skipRow(f):f(new Error("Expected result from header transform")))}catch(g){f(g)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(h){return this.rowCount-=1,h(null,{row:null,isValid:!0})}pushRow(h,f){try{this.parserOptions.objectMode?this.push(h):this.push(JSON.stringify(h)),f()}catch(g){f(g)}}static wrapDoneCallback(h){let f=!1;return function(g){if(g){if(f)throw g;return f=!0,void h(g)}for(var m=arguments.length,p=new Array(m>1?m-1:0),v=1;v<m;v++)p[v-1]=arguments[v];h(...p)}}}s.CsvParserStream=u}).call(this)}).call(this,e("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(e,n,s){var a=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(s,"__esModule",{value:!0}),s.ParserOptions=void 0;const i=a(e("lodash.escaperegexp")),o=a(e("lodash.isnil"));s.ParserOptions=class{constructor(l){var c;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,l||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=i.default(this.delimiter),this.escapeChar=(c=this.escape)!==null&&c!==void 0?c:this.quote,this.supportsComments=!o.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(e,n,s){var a=Object.create?function(m,p,v,b){b===void 0&&(b=v),Object.defineProperty(m,b,{enumerable:!0,get:function(){return p[v]}})}:function(m,p,v,b){b===void 0&&(b=v),m[b]=p[v]},i=Object.create?function(m,p){Object.defineProperty(m,"default",{enumerable:!0,value:p})}:function(m,p){m.default=p},o=function(m){if(m&&m.__esModule)return m;var p={};if(m!=null)for(var v in m)v!=="default"&&Object.prototype.hasOwnProperty.call(m,v)&&a(p,m,v);return i(p,m),p},l=function(m,p){for(var v in m)v==="default"||Object.prototype.hasOwnProperty.call(p,v)||a(p,m,v)};Object.defineProperty(s,"__esModule",{value:!0}),s.parseString=s.parseFile=s.parseStream=s.parse=s.ParserOptions=s.CsvParserStream=void 0;const c=o(e("fs")),u=e("stream"),d=e("./ParserOptions"),h=e("./CsvParserStream");l(e("./types"),s);var f=e("./CsvParserStream");Object.defineProperty(s,"CsvParserStream",{enumerable:!0,get:function(){return f.CsvParserStream}});var g=e("./ParserOptions");Object.defineProperty(s,"ParserOptions",{enumerable:!0,get:function(){return g.ParserOptions}}),s.parse=m=>new h.CsvParserStream(new d.ParserOptions(m)),s.parseStream=(m,p)=>m.pipe(new h.CsvParserStream(new d.ParserOptions(p))),s.parseFile=function(m){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return c.createReadStream(m).pipe(new h.CsvParserStream(new d.ParserOptions(p)))},s.parseString=(m,p)=>{const v=new u.Readable;return v.push(m),v.push(null),v.pipe(new h.CsvParserStream(new d.ParserOptions(p)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Parser=void 0;const a=e("./Scanner"),i=e("./RowParser"),o=e("./Token");class l{constructor(u){this.parserOptions=u,this.rowParser=new i.RowParser(this.parserOptions)}static removeBOM(u){return u&&u.charCodeAt(0)===65279?u.slice(1):u}parse(u,d){const h=new a.Scanner({line:l.removeBOM(u),parserOptions:this.parserOptions,hasMoreData:d});return this.parserOptions.supportsComments?this.parseWithComments(h):this.parseWithoutComments(h)}parseWithoutComments(u){const d=[];let h=!0;for(;h;)h=this.parseRow(u,d);return{line:u.line,rows:d}}parseWithComments(u){const{parserOptions:d}=this,h=[];for(let f=u.nextCharacterToken;f!==null;f=u.nextCharacterToken)if(o.Token.isTokenComment(f,d)){if(u.advancePastLine()===null)return{line:u.lineFromCursor,rows:h};if(!u.hasMoreCharacters)return{line:u.lineFromCursor,rows:h};u.truncateToCursor()}else if(!this.parseRow(u,h))break;return{line:u.line,rows:h}}parseRow(u,d){if(!u.nextNonSpaceToken)return!1;const h=this.rowParser.parse(u);return h!==null&&(this.parserOptions.ignoreEmpty&&i.RowParser.isEmptyRow(h)||d.push(h),!0)}}s.Parser=l},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.RowParser=void 0;const a=e("./column"),i=e("./Token");s.RowParser=class{constructor(o){this.parserOptions=o,this.columnParser=new a.ColumnParser(o)}static isEmptyRow(o){return o.join("").replace(/\s+/g,"")===""}parse(o){const{parserOptions:l}=this,{hasMoreData:c}=o,u=o,d=[];let h=this.getStartToken(u,d);for(;h;){if(i.Token.isTokenRowDelimiter(h))return u.advancePastToken(h),!u.hasMoreCharacters&&i.Token.isTokenCarriageReturn(h,l)&&c?null:(u.truncateToCursor(),d);if(!this.shouldSkipColumnParse(u,h,d)){const f=this.columnParser.parse(u);if(f===null)return null;d.push(f)}h=u.nextNonSpaceToken}return c?null:(u.truncateToCursor(),d)}getStartToken(o,l){const c=o.nextNonSpaceToken;return c!==null&&i.Token.isTokenDelimiter(c,this.parserOptions)?(l.push(""),o.nextNonSpaceToken):c}shouldSkipColumnParse(o,l,c){const{parserOptions:u}=this;if(i.Token.isTokenDelimiter(l,u)){o.advancePastToken(l);const d=o.nextCharacterToken;if(!o.hasMoreCharacters||d!==null&&i.Token.isTokenRowDelimiter(d)||d!==null&&i.Token.isTokenDelimiter(d,u))return c.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Scanner=void 0;const a=e("./Token"),i=/((?:\r\n)|\n|\r)/;s.Scanner=class{constructor(o){this.cursor=0,this.line=o.line,this.lineLength=this.line.length,this.parserOptions=o.parserOptions,this.hasMoreData=o.hasMoreData,this.cursor=o.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:o}=this,l=this.parserOptions.NEXT_TOKEN_REGEXP;if(o.search(l)===-1)return null;const c=l.exec(o);if(c==null)return null;const u=c[1],d=this.cursor+(c.index||0);return new a.Token({token:u,startCursor:d,endCursor:d+u.length-1})}get nextCharacterToken(){const{cursor:o,lineLength:l}=this;return l<=o?null:new a.Token({token:this.line[o],startCursor:o,endCursor:o})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const o=i.exec(this.lineFromCursor);return o?(this.cursor+=(o.index||0)+o[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(o){return this.cursor=o,this}advanceToToken(o){return this.cursor=o.startCursor,this}advancePastToken(o){return this.cursor=o.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Token=void 0,s.Token=class{constructor(a){this.token=a.token,this.startCursor=a.startCursor,this.endCursor=a.endCursor}static isTokenRowDelimiter(a){const i=a.token;return i==="\r"||i===`
`||i===`\r
`}static isTokenCarriageReturn(a,i){return a.token===i.carriageReturn}static isTokenComment(a,i){return i.supportsComments&&!!a&&a.token===i.comment}static isTokenEscapeCharacter(a,i){return a.token===i.escapeChar}static isTokenQuote(a,i){return a.token===i.quote}static isTokenDelimiter(a,i){return a.token===i.delimiter}}},{}],160:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ColumnFormatter=void 0,s.ColumnFormatter=class{constructor(a){a.trim?this.format=i=>i.trim():a.ltrim?this.format=i=>i.trimLeft():a.rtrim?this.format=i=>i.trimRight():this.format=i=>i}}},{}],161:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ColumnParser=void 0;const a=e("./NonQuotedColumnParser"),i=e("./QuotedColumnParser"),o=e("../Token");s.ColumnParser=class{constructor(l){this.parserOptions=l,this.quotedColumnParser=new i.QuotedColumnParser(l),this.nonQuotedColumnParser=new a.NonQuotedColumnParser(l)}parse(l){const{nextNonSpaceToken:c}=l;return c!==null&&o.Token.isTokenQuote(c,this.parserOptions)?(l.advanceToToken(c),this.quotedColumnParser.parse(l)):this.nonQuotedColumnParser.parse(l)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.NonQuotedColumnParser=void 0;const a=e("./ColumnFormatter"),i=e("../Token");s.NonQuotedColumnParser=class{constructor(o){this.parserOptions=o,this.columnFormatter=new a.ColumnFormatter(o)}parse(o){if(!o.hasMoreCharacters)return null;const{parserOptions:l}=this,c=[];let u=o.nextCharacterToken;for(;u&&!i.Token.isTokenDelimiter(u,l)&&!i.Token.isTokenRowDelimiter(u);u=o.nextCharacterToken)c.push(u.token),o.advancePastToken(u);return this.columnFormatter.format(c.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.QuotedColumnParser=void 0;const a=e("./ColumnFormatter"),i=e("../Token");s.QuotedColumnParser=class{constructor(o){this.parserOptions=o,this.columnFormatter=new a.ColumnFormatter(o)}parse(o){if(!o.hasMoreCharacters)return null;const l=o.cursor,{foundClosingQuote:c,col:u}=this.gatherDataBetweenQuotes(o);if(!c){if(o.advanceTo(l),!o.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${o.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(o),u}gatherDataBetweenQuotes(o){const{parserOptions:l}=this;let c=!1,u=!1;const d=[];let h=o.nextCharacterToken;for(;!u&&h!==null;h=o.nextCharacterToken){const f=i.Token.isTokenQuote(h,l);if(!c&&f)c=!0;else if(c)if(i.Token.isTokenEscapeCharacter(h,l)){o.advancePastToken(h);const g=o.nextCharacterToken;g!==null&&(i.Token.isTokenQuote(g,l)||i.Token.isTokenEscapeCharacter(g,l))?(d.push(g.token),h=g):f?u=!0:d.push(h.token)}else f?u=!0:d.push(h.token);o.advancePastToken(h)}return{col:this.columnFormatter.format(d.join("")),foundClosingQuote:u}}checkForMalformedColumn(o){const{parserOptions:l}=this,{nextNonSpaceToken:c}=o;if(c){const u=i.Token.isTokenDelimiter(c,l),d=i.Token.isTokenRowDelimiter(c);if(!u&&!d){const h=o.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${l.escapedDelimiter}' OR new line got: '${c.token}'. at '${h}`)}o.advanceToToken(c)}else o.hasMoreData||o.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ColumnFormatter=s.QuotedColumnParser=s.NonQuotedColumnParser=s.ColumnParser=void 0;var a=e("./ColumnParser");Object.defineProperty(s,"ColumnParser",{enumerable:!0,get:function(){return a.ColumnParser}});var i=e("./NonQuotedColumnParser");Object.defineProperty(s,"NonQuotedColumnParser",{enumerable:!0,get:function(){return i.NonQuotedColumnParser}});var o=e("./QuotedColumnParser");Object.defineProperty(s,"QuotedColumnParser",{enumerable:!0,get:function(){return o.QuotedColumnParser}});var l=e("./ColumnFormatter");Object.defineProperty(s,"ColumnFormatter",{enumerable:!0,get:function(){return l.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.QuotedColumnParser=s.NonQuotedColumnParser=s.ColumnParser=s.Token=s.Scanner=s.RowParser=s.Parser=void 0;var a=e("./Parser");Object.defineProperty(s,"Parser",{enumerable:!0,get:function(){return a.Parser}});var i=e("./RowParser");Object.defineProperty(s,"RowParser",{enumerable:!0,get:function(){return i.RowParser}});var o=e("./Scanner");Object.defineProperty(s,"Scanner",{enumerable:!0,get:function(){return o.Scanner}});var l=e("./Token");Object.defineProperty(s,"Token",{enumerable:!0,get:function(){return l.Token}});var c=e("./column");Object.defineProperty(s,"ColumnParser",{enumerable:!0,get:function(){return c.ColumnParser}}),Object.defineProperty(s,"NonQuotedColumnParser",{enumerable:!0,get:function(){return c.NonQuotedColumnParser}}),Object.defineProperty(s,"QuotedColumnParser",{enumerable:!0,get:function(){return c.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(e,n,s){var a=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(s,"__esModule",{value:!0}),s.HeaderTransformer=void 0;const i=a(e("lodash.isundefined")),o=a(e("lodash.isfunction")),l=a(e("lodash.uniq")),c=a(e("lodash.groupby"));s.HeaderTransformer=class{constructor(u){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=u,u.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(u.headers)?this.setHeaders(u.headers):o.default(u.headers)&&(this.headersTransform=u.headers)}transform(u,d){return this.shouldMapRow(u)?d(null,this.processRow(u)):d(null,{row:null,isValid:!0})}shouldMapRow(u){const{parserOptions:d}=this;if(!this.headersTransform&&d.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(u)){if(this.headersTransform)this.setHeaders(this.headersTransform(u));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(u)}return!1}return!0}processRow(u){if(!this.headers)return{row:u,isValid:!0};const{parserOptions:d}=this;if(!d.discardUnmappedColumns&&u.length>this.headersLength){if(!d.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${u.length}`);return{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}}return d.strictColumnHandling&&u.length<this.headersLength?{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}:{row:this.mapHeaders(u),isValid:!0}}mapHeaders(u){const d={},{headers:h,headersLength:f}=this;for(let g=0;g<f;g+=1){const m=h[g];if(!i.default(m)){const p=u[g];i.default(p)?d[m]="":d[m]=p}}return d}setHeaders(u){var d;const h=u.filter(f=>!!f);if(l.default(h).length!==h.length){const f=c.default(h),g=Object.keys(f).filter(m=>f[m].length>1);throw new Error("Duplicate headers found "+JSON.stringify(g))}this.headers=u,this.receivedHeaders=!0,this.headersLength=((d=this.headers)===null||d===void 0?void 0:d.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(e,n,s){var a=function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(s,"__esModule",{value:!0}),s.RowTransformerValidator=void 0;const i=a(e("lodash.isfunction")),o=e("../types");class l{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(u){return o.isSyncTransform(u)?(d,h)=>{let f=null;try{f=u(d)}catch(g){return h(g)}return h(null,f)}:u}static createValidator(u){return o.isSyncValidate(u)?(d,h)=>{h(null,{row:d,isValid:u(d)})}:(d,h)=>{u(d,(f,g,m)=>f?h(f):h(null,g?{row:d,isValid:g,reason:m}:{row:d,isValid:!1,reason:m}))}}set rowTransform(u){if(!i.default(u))throw new TypeError("The transform should be a function");this._rowTransform=l.createTransform(u)}set rowValidator(u){if(!i.default(u))throw new TypeError("The validate should be a function");this._rowValidator=l.createValidator(u)}transformAndValidate(u,d){return this.callTransformer(u,(h,f)=>h?d(h):f?this.callValidator(f,(g,m)=>g?d(g):m&&!m.isValid?d(null,{row:f,isValid:!1,reason:m.reason}):d(null,{row:f,isValid:!0})):d(null,{row:null,isValid:!0}))}callTransformer(u,d){return this._rowTransform?this._rowTransform(u,d):d(null,u)}callValidator(u,d){return this._rowValidator?this._rowValidator(u,d):d(null,{row:u,isValid:!0})}}s.RowTransformerValidator=l},{"../types":169,"lodash.isfunction":446}],168:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.HeaderTransformer=s.RowTransformerValidator=void 0;var a=e("./RowTransformerValidator");Object.defineProperty(s,"RowTransformerValidator",{enumerable:!0,get:function(){return a.RowTransformerValidator}});var i=e("./HeaderTransformer");Object.defineProperty(s,"HeaderTransformer",{enumerable:!0,get:function(){return i.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.isSyncValidate=s.isSyncTransform=void 0,s.isSyncTransform=a=>a.length===1,s.isSyncValidate=a=>a.length===1},{}],170:[function(e,n,s){const a=s;a.bignum=e("bn.js"),a.define=e("./asn1/api").define,a.base=e("./asn1/base"),a.constants=e("./asn1/constants"),a.decoders=e("./asn1/decoders"),a.encoders=e("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(e,n,s){const a=e("./encoders"),i=e("./decoders"),o=e("inherits");function l(c,u){this.name=c,this.body=u,this.decoders={},this.encoders={}}s.define=function(c,u){return new l(c,u)},l.prototype._createNamed=function(c){const u=this.name;function d(h){this._initNamed(h,u)}return o(d,c),d.prototype._initNamed=function(h,f){c.call(this,h,f)},new d(this)},l.prototype._getDecoder=function(c){return c=c||"der",this.decoders.hasOwnProperty(c)||(this.decoders[c]=this._createNamed(i[c])),this.decoders[c]},l.prototype.decode=function(c,u,d){return this._getDecoder(u).decode(c,d)},l.prototype._getEncoder=function(c){return c=c||"der",this.encoders.hasOwnProperty(c)||(this.encoders[c]=this._createNamed(a[c])),this.encoders[c]},l.prototype.encode=function(c,u,d){return this._getEncoder(u).encode(c,d)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(e,n,s){const a=e("inherits"),i=e("../base/reporter").Reporter,o=e("safer-buffer").Buffer;function l(u,d){i.call(this,d),o.isBuffer(u)?(this.base=u,this.offset=0,this.length=u.length):this.error("Input not Buffer")}function c(u,d){if(Array.isArray(u))this.length=0,this.value=u.map(function(h){return c.isEncoderBuffer(h)||(h=new c(h,d)),this.length+=h.length,h},this);else if(typeof u=="number"){if(!(0<=u&&u<=255))return d.error("non-byte EncoderBuffer value");this.value=u,this.length=1}else if(typeof u=="string")this.value=u,this.length=o.byteLength(u);else{if(!o.isBuffer(u))return d.error("Unsupported type: "+typeof u);this.value=u,this.length=u.length}}a(l,i),s.DecoderBuffer=l,l.isDecoderBuffer=function(u){return u instanceof l?!0:typeof u=="object"&&o.isBuffer(u.base)&&u.constructor.name==="DecoderBuffer"&&typeof u.offset=="number"&&typeof u.length=="number"&&typeof u.save=="function"&&typeof u.restore=="function"&&typeof u.isEmpty=="function"&&typeof u.readUInt8=="function"&&typeof u.skip=="function"&&typeof u.raw=="function"},l.prototype.save=function(){return{offset:this.offset,reporter:i.prototype.save.call(this)}},l.prototype.restore=function(u){const d=new l(this.base);return d.offset=u.offset,d.length=this.offset,this.offset=u.offset,i.prototype.restore.call(this,u.reporter),d},l.prototype.isEmpty=function(){return this.offset===this.length},l.prototype.readUInt8=function(u){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(u||"DecoderBuffer overrun")},l.prototype.skip=function(u,d){if(!(this.offset+u<=this.length))return this.error(d||"DecoderBuffer overrun");const h=new l(this.base);return h._reporterState=this._reporterState,h.offset=this.offset,h.length=this.offset+u,this.offset+=u,h},l.prototype.raw=function(u){return this.base.slice(u?u.offset:this.offset,this.length)},s.EncoderBuffer=c,c.isEncoderBuffer=function(u){return u instanceof c?!0:typeof u=="object"&&u.constructor.name==="EncoderBuffer"&&typeof u.length=="number"&&typeof u.join=="function"},c.prototype.join=function(u,d){return u||(u=o.alloc(this.length)),d||(d=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(h){h.join(u,d),d+=h.length}):(typeof this.value=="number"?u[d]=this.value:typeof this.value=="string"?u.write(this.value,d):o.isBuffer(this.value)&&this.value.copy(u,d),d+=this.length)),u}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(e,n,s){const a=s;a.Reporter=e("./reporter").Reporter,a.DecoderBuffer=e("./buffer").DecoderBuffer,a.EncoderBuffer=e("./buffer").EncoderBuffer,a.Node=e("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(e,n,s){const a=e("../base/reporter").Reporter,i=e("../base/buffer").EncoderBuffer,o=e("../base/buffer").DecoderBuffer,l=e("minimalistic-assert"),c=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(c);function d(f,g,m){const p={};this._baseState=p,p.name=m,p.enc=f,p.parent=g||null,p.children=null,p.tag=null,p.args=null,p.reverseArgs=null,p.choice=null,p.optional=!1,p.any=!1,p.obj=!1,p.use=null,p.useDecoder=null,p.key=null,p.default=null,p.explicit=null,p.implicit=null,p.contains=null,p.parent||(p.children=[],this._wrap())}n.exports=d;const h=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];d.prototype.clone=function(){const f=this._baseState,g={};h.forEach(function(p){g[p]=f[p]});const m=new this.constructor(g.parent);return m._baseState=g,m},d.prototype._wrap=function(){const f=this._baseState;u.forEach(function(g){this[g]=function(){const m=new this.constructor(this);return f.children.push(m),m[g].apply(m,arguments)}},this)},d.prototype._init=function(f){const g=this._baseState;l(g.parent===null),f.call(this),g.children=g.children.filter(function(m){return m._baseState.parent===this},this),l.equal(g.children.length,1,"Root node can have only one child")},d.prototype._useArgs=function(f){const g=this._baseState,m=f.filter(function(p){return p instanceof this.constructor},this);f=f.filter(function(p){return!(p instanceof this.constructor)},this),m.length!==0&&(l(g.children===null),g.children=m,m.forEach(function(p){p._baseState.parent=this},this)),f.length!==0&&(l(g.args===null),g.args=f,g.reverseArgs=f.map(function(p){if(typeof p!="object"||p.constructor!==Object)return p;const v={};return Object.keys(p).forEach(function(b){b==(0|b)&&(b|=0);const y=p[b];v[y]=b}),v}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(f){d.prototype[f]=function(){const g=this._baseState;throw new Error(f+" not implemented for encoding: "+g.enc)}}),c.forEach(function(f){d.prototype[f]=function(){const g=this._baseState,m=Array.prototype.slice.call(arguments);return l(g.tag===null),g.tag=f,this._useArgs(m),this}}),d.prototype.use=function(f){l(f);const g=this._baseState;return l(g.use===null),g.use=f,this},d.prototype.optional=function(){return this._baseState.optional=!0,this},d.prototype.def=function(f){const g=this._baseState;return l(g.default===null),g.default=f,g.optional=!0,this},d.prototype.explicit=function(f){const g=this._baseState;return l(g.explicit===null&&g.implicit===null),g.explicit=f,this},d.prototype.implicit=function(f){const g=this._baseState;return l(g.explicit===null&&g.implicit===null),g.implicit=f,this},d.prototype.obj=function(){const f=this._baseState,g=Array.prototype.slice.call(arguments);return f.obj=!0,g.length!==0&&this._useArgs(g),this},d.prototype.key=function(f){const g=this._baseState;return l(g.key===null),g.key=f,this},d.prototype.any=function(){return this._baseState.any=!0,this},d.prototype.choice=function(f){const g=this._baseState;return l(g.choice===null),g.choice=f,this._useArgs(Object.keys(f).map(function(m){return f[m]})),this},d.prototype.contains=function(f){const g=this._baseState;return l(g.use===null),g.contains=f,this},d.prototype._decode=function(f,g){const m=this._baseState;if(m.parent===null)return f.wrapResult(m.children[0]._decode(f,g));let p,v=m.default,b=!0,y=null;if(m.key!==null&&(y=f.enterKey(m.key)),m.optional){let k=null;if(m.explicit!==null?k=m.explicit:m.implicit!==null?k=m.implicit:m.tag!==null&&(k=m.tag),k!==null||m.any){if(b=this._peekTag(f,k,m.any),f.isError(b))return b}else{const N=f.save();try{m.choice===null?this._decodeGeneric(m.tag,f,g):this._decodeChoice(f,g),b=!0}catch{b=!1}f.restore(N)}}if(m.obj&&b&&(p=f.enterObject()),b){if(m.explicit!==null){const N=this._decodeTag(f,m.explicit);if(f.isError(N))return N;f=N}const k=f.offset;if(m.use===null&&m.choice===null){let N;m.any&&(N=f.save());const L=this._decodeTag(f,m.implicit!==null?m.implicit:m.tag,m.any);if(f.isError(L))return L;m.any?v=f.raw(N):f=L}if(g&&g.track&&m.tag!==null&&g.track(f.path(),k,f.length,"tagged"),g&&g.track&&m.tag!==null&&g.track(f.path(),f.offset,f.length,"content"),m.any||(v=m.choice===null?this._decodeGeneric(m.tag,f,g):this._decodeChoice(f,g)),f.isError(v))return v;if(m.any||m.choice!==null||m.children===null||m.children.forEach(function(N){N._decode(f,g)}),m.contains&&(m.tag==="octstr"||m.tag==="bitstr")){const N=new o(v);v=this._getUse(m.contains,f._reporterState.obj)._decode(N,g)}}return m.obj&&b&&(v=f.leaveObject(p)),m.key===null||v===null&&b!==!0?y!==null&&f.exitKey(y):f.leaveKey(y,m.key,v),v},d.prototype._decodeGeneric=function(f,g,m){const p=this._baseState;return f==="seq"||f==="set"?null:f==="seqof"||f==="setof"?this._decodeList(g,f,p.args[0],m):/str$/.test(f)?this._decodeStr(g,f,m):f==="objid"&&p.args?this._decodeObjid(g,p.args[0],p.args[1],m):f==="objid"?this._decodeObjid(g,null,null,m):f==="gentime"||f==="utctime"?this._decodeTime(g,f,m):f==="null_"?this._decodeNull(g,m):f==="bool"?this._decodeBool(g,m):f==="objDesc"?this._decodeStr(g,f,m):f==="int"||f==="enum"?this._decodeInt(g,p.args&&p.args[0],m):p.use!==null?this._getUse(p.use,g._reporterState.obj)._decode(g,m):g.error("unknown tag: "+f)},d.prototype._getUse=function(f,g){const m=this._baseState;return m.useDecoder=this._use(f,g),l(m.useDecoder._baseState.parent===null),m.useDecoder=m.useDecoder._baseState.children[0],m.implicit!==m.useDecoder._baseState.implicit&&(m.useDecoder=m.useDecoder.clone(),m.useDecoder._baseState.implicit=m.implicit),m.useDecoder},d.prototype._decodeChoice=function(f,g){const m=this._baseState;let p=null,v=!1;return Object.keys(m.choice).some(function(b){const y=f.save(),k=m.choice[b];try{const N=k._decode(f,g);if(f.isError(N))return!1;p={type:b,value:N},v=!0}catch{return f.restore(y),!1}return!0},this),v?p:f.error("Choice not matched")},d.prototype._createEncoderBuffer=function(f){return new i(f,this.reporter)},d.prototype._encode=function(f,g,m){const p=this._baseState;if(p.default!==null&&p.default===f)return;const v=this._encodeValue(f,g,m);return v===void 0||this._skipDefault(v,g,m)?void 0:v},d.prototype._encodeValue=function(f,g,m){const p=this._baseState;if(p.parent===null)return p.children[0]._encode(f,g||new a);let v=null;if(this.reporter=g,p.optional&&f===void 0){if(p.default===null)return;f=p.default}let b=null,y=!1;if(p.any)v=this._createEncoderBuffer(f);else if(p.choice)v=this._encodeChoice(f,g);else if(p.contains)b=this._getUse(p.contains,m)._encode(f,g),y=!0;else if(p.children)b=p.children.map(function(k){if(k._baseState.tag==="null_")return k._encode(null,g,f);if(k._baseState.key===null)return g.error("Child should have a key");const N=g.enterKey(k._baseState.key);if(typeof f!="object")return g.error("Child expected, but input is not object");const L=k._encode(f[k._baseState.key],g,f);return g.leaveKey(N),L},this).filter(function(k){return k}),b=this._createEncoderBuffer(b);else if(p.tag==="seqof"||p.tag==="setof"){if(!p.args||p.args.length!==1)return g.error("Too many args for : "+p.tag);if(!Array.isArray(f))return g.error("seqof/setof, but data is not Array");const k=this.clone();k._baseState.implicit=null,b=this._createEncoderBuffer(f.map(function(N){const L=this._baseState;return this._getUse(L.args[0],f)._encode(N,g)},k))}else p.use!==null?v=this._getUse(p.use,m)._encode(f,g):(b=this._encodePrimitive(p.tag,f),y=!0);if(!p.any&&p.choice===null){const k=p.implicit!==null?p.implicit:p.tag,N=p.implicit===null?"universal":"context";k===null?p.use===null&&g.error("Tag could be omitted only for .use()"):p.use===null&&(v=this._encodeComposite(k,y,N,b))}return p.explicit!==null&&(v=this._encodeComposite(p.explicit,!1,"context",v)),v},d.prototype._encodeChoice=function(f,g){const m=this._baseState,p=m.choice[f.type];return p||l(!1,f.type+" not found in "+JSON.stringify(Object.keys(m.choice))),p._encode(f.value,g)},d.prototype._encodePrimitive=function(f,g){const m=this._baseState;if(/str$/.test(f))return this._encodeStr(g,f);if(f==="objid"&&m.args)return this._encodeObjid(g,m.reverseArgs[0],m.args[1]);if(f==="objid")return this._encodeObjid(g,null,null);if(f==="gentime"||f==="utctime")return this._encodeTime(g,f);if(f==="null_")return this._encodeNull();if(f==="int"||f==="enum")return this._encodeInt(g,m.args&&m.reverseArgs[0]);if(f==="bool")return this._encodeBool(g);if(f==="objDesc")return this._encodeStr(g,f);throw new Error("Unsupported tag: "+f)},d.prototype._isNumstr=function(f){return/^[0-9 ]*$/.test(f)},d.prototype._isPrintstr=function(f){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(f)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(e,n,s){const a=e("inherits");function i(l){this._reporterState={obj:null,path:[],options:l||{},errors:[]}}function o(l,c){this.path=l,this.rethrow(c)}s.Reporter=i,i.prototype.isError=function(l){return l instanceof o},i.prototype.save=function(){const l=this._reporterState;return{obj:l.obj,pathLen:l.path.length}},i.prototype.restore=function(l){const c=this._reporterState;c.obj=l.obj,c.path=c.path.slice(0,l.pathLen)},i.prototype.enterKey=function(l){return this._reporterState.path.push(l)},i.prototype.exitKey=function(l){const c=this._reporterState;c.path=c.path.slice(0,l-1)},i.prototype.leaveKey=function(l,c,u){const d=this._reporterState;this.exitKey(l),d.obj!==null&&(d.obj[c]=u)},i.prototype.path=function(){return this._reporterState.path.join("/")},i.prototype.enterObject=function(){const l=this._reporterState,c=l.obj;return l.obj={},c},i.prototype.leaveObject=function(l){const c=this._reporterState,u=c.obj;return c.obj=l,u},i.prototype.error=function(l){let c;const u=this._reporterState,d=l instanceof o;if(c=d?l:new o(u.path.map(function(h){return"["+JSON.stringify(h)+"]"}).join(""),l.message||l,l.stack),!u.options.partial)throw c;return d||u.errors.push(c),c},i.prototype.wrapResult=function(l){const c=this._reporterState;return c.options.partial?{result:this.isError(l)?null:l,errors:c.errors}:l},a(o,Error),o.prototype.rethrow=function(l){if(this.message=l+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,o),!this.stack)try{throw new Error(this.message)}catch(c){this.stack=c.stack}return this}},{inherits:440}],176:[function(e,n,s){function a(i){const o={};return Object.keys(i).forEach(function(l){(0|l)==l&&(l|=0);const c=i[l];o[c]=l}),o}s.tagClass={0:"universal",1:"application",2:"context",3:"private"},s.tagClassByName=a(s.tagClass),s.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},s.tagByName=a(s.tag)},{}],177:[function(e,n,s){const a=s;a._reverse=function(i){const o={};return Object.keys(i).forEach(function(l){(0|l)==l&&(l|=0);const c=i[l];o[c]=l}),o},a.der=e("./der")},{"./der":176}],178:[function(e,n,s){const a=e("inherits"),i=e("bn.js"),o=e("../base/buffer").DecoderBuffer,l=e("../base/node"),c=e("../constants/der");function u(g){this.enc="der",this.name=g.name,this.entity=g,this.tree=new d,this.tree._init(g.body)}function d(g){l.call(this,"der",g)}function h(g,m){let p=g.readUInt8(m);if(g.isError(p))return p;const v=c.tagClass[p>>6],b=(32&p)==0;if((31&p)==31){let y=p;for(p=0;(128&y)==128;){if(y=g.readUInt8(m),g.isError(y))return y;p<<=7,p|=127&y}}else p&=31;return{cls:v,primitive:b,tag:p,tagStr:c.tag[p]}}function f(g,m,p){let v=g.readUInt8(p);if(g.isError(v))return v;if(!m&&v===128)return null;if(!(128&v))return v;const b=127&v;if(b>4)return g.error("length octect is too long");v=0;for(let y=0;y<b;y++){v<<=8;const k=g.readUInt8(p);if(g.isError(k))return k;v|=k}return v}n.exports=u,u.prototype.decode=function(g,m){return o.isDecoderBuffer(g)||(g=new o(g,m)),this.tree._decode(g,m)},a(d,l),d.prototype._peekTag=function(g,m,p){if(g.isEmpty())return!1;const v=g.save(),b=h(g,'Failed to peek tag: "'+m+'"');return g.isError(b)?b:(g.restore(v),b.tag===m||b.tagStr===m||b.tagStr+"of"===m||p)},d.prototype._decodeTag=function(g,m,p){const v=h(g,'Failed to decode tag of "'+m+'"');if(g.isError(v))return v;let b=f(g,v.primitive,'Failed to get length of "'+m+'"');if(g.isError(b))return b;if(!p&&v.tag!==m&&v.tagStr!==m&&v.tagStr+"of"!==m)return g.error('Failed to match tag: "'+m+'"');if(v.primitive||b!==null)return g.skip(b,'Failed to match body of: "'+m+'"');const y=g.save(),k=this._skipUntilEnd(g,'Failed to skip indefinite length body: "'+this.tag+'"');return g.isError(k)?k:(b=g.offset-y.offset,g.restore(y),g.skip(b,'Failed to match body of: "'+m+'"'))},d.prototype._skipUntilEnd=function(g,m){for(;;){const p=h(g,m);if(g.isError(p))return p;const v=f(g,p.primitive,m);if(g.isError(v))return v;let b;if(b=p.primitive||v!==null?g.skip(v):this._skipUntilEnd(g,m),g.isError(b))return b;if(p.tagStr==="end")break}},d.prototype._decodeList=function(g,m,p,v){const b=[];for(;!g.isEmpty();){const y=this._peekTag(g,"end");if(g.isError(y))return y;const k=p.decode(g,"der",v);if(g.isError(k)&&y)break;b.push(k)}return b},d.prototype._decodeStr=function(g,m){if(m==="bitstr"){const p=g.readUInt8();return g.isError(p)?p:{unused:p,data:g.raw()}}if(m==="bmpstr"){const p=g.raw();if(p.length%2==1)return g.error("Decoding of string type: bmpstr length mismatch");let v="";for(let b=0;b<p.length/2;b++)v+=String.fromCharCode(p.readUInt16BE(2*b));return v}if(m==="numstr"){const p=g.raw().toString("ascii");return this._isNumstr(p)?p:g.error("Decoding of string type: numstr unsupported characters")}if(m==="octstr"||m==="objDesc")return g.raw();if(m==="printstr"){const p=g.raw().toString("ascii");return this._isPrintstr(p)?p:g.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(m)?g.raw().toString():g.error("Decoding of string type: "+m+" unsupported")},d.prototype._decodeObjid=function(g,m,p){let v;const b=[];let y=0,k=0;for(;!g.isEmpty();)k=g.readUInt8(),y<<=7,y|=127&k,!(128&k)&&(b.push(y),y=0);128&k&&b.push(y);const N=b[0]/40|0,L=b[0]%40;if(v=p?b:[N,L].concat(b.slice(1)),m){let F=m[v.join(" ")];F===void 0&&(F=m[v.join(".")]),F!==void 0&&(v=F)}return v},d.prototype._decodeTime=function(g,m){const p=g.raw().toString();let v,b,y,k,N,L;if(m==="gentime")v=0|p.slice(0,4),b=0|p.slice(4,6),y=0|p.slice(6,8),k=0|p.slice(8,10),N=0|p.slice(10,12),L=0|p.slice(12,14);else{if(m!=="utctime")return g.error("Decoding "+m+" time is not supported yet");v=0|p.slice(0,2),b=0|p.slice(2,4),y=0|p.slice(4,6),k=0|p.slice(6,8),N=0|p.slice(8,10),L=0|p.slice(10,12),v=v<70?2e3+v:1900+v}return Date.UTC(v,b-1,y,k,N,L,0)},d.prototype._decodeNull=function(){return null},d.prototype._decodeBool=function(g){const m=g.readUInt8();return g.isError(m)?m:m!==0},d.prototype._decodeInt=function(g,m){const p=g.raw();let v=new i(p);return m&&(v=m[v.toString(10)]||v),v},d.prototype._use=function(g,m){return typeof g=="function"&&(g=g(m)),g._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(e,n,s){const a=s;a.der=e("./der"),a.pem=e("./pem")},{"./der":178,"./pem":180}],180:[function(e,n,s){const a=e("inherits"),i=e("safer-buffer").Buffer,o=e("./der");function l(c){o.call(this,c),this.enc="pem"}a(l,o),n.exports=l,l.prototype.decode=function(c,u){const d=c.toString().split(/[\r\n]+/g),h=u.label.toUpperCase(),f=/^-----(BEGIN|END) ([^-]+)-----$/;let g=-1,m=-1;for(let b=0;b<d.length;b++){const y=d[b].match(f);if(y!==null&&y[2]===h){if(g!==-1){if(y[1]!=="END")break;m=b;break}if(y[1]!=="BEGIN")break;g=b}}if(g===-1||m===-1)throw new Error("PEM section not found for: "+h);const p=d.slice(g+1,m).join("");p.replace(/[^a-z0-9+/=]+/gi,"");const v=i.from(p,"base64");return o.prototype.decode.call(this,v,u)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(e,n,s){const a=e("inherits"),i=e("safer-buffer").Buffer,o=e("../base/node"),l=e("../constants/der");function c(h){this.enc="der",this.name=h.name,this.entity=h,this.tree=new u,this.tree._init(h.body)}function u(h){o.call(this,"der",h)}function d(h){return h<10?"0"+h:h}n.exports=c,c.prototype.encode=function(h,f){return this.tree._encode(h,f).join()},a(u,o),u.prototype._encodeComposite=function(h,f,g,m){const p=function(y,k,N,L){let F;if(y==="seqof"?y="seq":y==="setof"&&(y="set"),l.tagByName.hasOwnProperty(y))F=l.tagByName[y];else{if(typeof y!="number"||(0|y)!==y)return L.error("Unknown tag: "+y);F=y}return F>=31?L.error("Multi-octet tag encoding unsupported"):(k||(F|=32),F|=l.tagClassByName[N||"universal"]<<6,F)}(h,f,g,this.reporter);if(m.length<128){const y=i.alloc(2);return y[0]=p,y[1]=m.length,this._createEncoderBuffer([y,m])}let v=1;for(let y=m.length;y>=256;y>>=8)v++;const b=i.alloc(2+v);b[0]=p,b[1]=128|v;for(let y=1+v,k=m.length;k>0;y--,k>>=8)b[y]=255&k;return this._createEncoderBuffer([b,m])},u.prototype._encodeStr=function(h,f){if(f==="bitstr")return this._createEncoderBuffer([0|h.unused,h.data]);if(f==="bmpstr"){const g=i.alloc(2*h.length);for(let m=0;m<h.length;m++)g.writeUInt16BE(h.charCodeAt(m),2*m);return this._createEncoderBuffer(g)}return f==="numstr"?this._isNumstr(h)?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: numstr supports only digits and space"):f==="printstr"?this._isPrintstr(h)?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(f)||f==="objDesc"?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: "+f+" unsupported")},u.prototype._encodeObjid=function(h,f,g){if(typeof h=="string"){if(!f)return this.reporter.error("string objid given, but no values map found");if(!f.hasOwnProperty(h))return this.reporter.error("objid not found in values map");h=f[h].split(/[\s.]+/g);for(let b=0;b<h.length;b++)h[b]|=0}else if(Array.isArray(h)){h=h.slice();for(let b=0;b<h.length;b++)h[b]|=0}if(!Array.isArray(h))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(h));if(!g){if(h[1]>=40)return this.reporter.error("Second objid identifier OOB");h.splice(0,2,40*h[0]+h[1])}let m=0;for(let b=0;b<h.length;b++){let y=h[b];for(m++;y>=128;y>>=7)m++}const p=i.alloc(m);let v=p.length-1;for(let b=h.length-1;b>=0;b--){let y=h[b];for(p[v--]=127&y;(y>>=7)>0;)p[v--]=128|127&y}return this._createEncoderBuffer(p)},u.prototype._encodeTime=function(h,f){let g;const m=new Date(h);return f==="gentime"?g=[d(m.getUTCFullYear()),d(m.getUTCMonth()+1),d(m.getUTCDate()),d(m.getUTCHours()),d(m.getUTCMinutes()),d(m.getUTCSeconds()),"Z"].join(""):f==="utctime"?g=[d(m.getUTCFullYear()%100),d(m.getUTCMonth()+1),d(m.getUTCDate()),d(m.getUTCHours()),d(m.getUTCMinutes()),d(m.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+f+" time is not supported yet"),this._encodeStr(g,"octstr")},u.prototype._encodeNull=function(){return this._createEncoderBuffer("")},u.prototype._encodeInt=function(h,f){if(typeof h=="string"){if(!f)return this.reporter.error("String int or enum given, but no values map");if(!f.hasOwnProperty(h))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(h));h=f[h]}if(typeof h!="number"&&!i.isBuffer(h)){const p=h.toArray();!h.sign&&128&p[0]&&p.unshift(0),h=i.from(p)}if(i.isBuffer(h)){let p=h.length;h.length===0&&p++;const v=i.alloc(p);return h.copy(v),h.length===0&&(v[0]=0),this._createEncoderBuffer(v)}if(h<128)return this._createEncoderBuffer(h);if(h<256)return this._createEncoderBuffer([0,h]);let g=1;for(let p=h;p>=256;p>>=8)g++;const m=new Array(g);for(let p=m.length-1;p>=0;p--)m[p]=255&h,h>>=8;return 128&m[0]&&m.unshift(0),this._createEncoderBuffer(i.from(m))},u.prototype._encodeBool=function(h){return this._createEncoderBuffer(h?255:0)},u.prototype._use=function(h,f){return typeof h=="function"&&(h=h(f)),h._getEncoder("der").tree},u.prototype._skipDefault=function(h,f,g){const m=this._baseState;let p;if(m.default===null)return!1;const v=h.join();if(m.defaultBuffer===void 0&&(m.defaultBuffer=this._encodeValue(m.default,f,g).join()),v.length!==m.defaultBuffer.length)return!1;for(p=0;p<v.length;p++)if(v[p]!==m.defaultBuffer[p])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(e,n,s){const a=s;a.der=e("./der"),a.pem=e("./pem")},{"./der":181,"./pem":183}],183:[function(e,n,s){const a=e("inherits"),i=e("./der");function o(l){i.call(this,l),this.enc="pem"}a(o,i),n.exports=o,o.prototype.encode=function(l,c){const u=i.prototype.encode.call(this,l).toString("base64"),d=["-----BEGIN "+c.label+"-----"];for(let h=0;h<u.length;h+=64)d.push(u.slice(h,h+64));return d.push("-----END "+c.label+"-----"),d.join(`
`)}},{"./der":181,inherits:440}],184:[function(e,n,s){(function(a,i){function o(C,O){if(!C)throw new Error(O||"Assertion failed")}function l(C,O){C.super_=O;var E=function(){};E.prototype=O.prototype,C.prototype=new E,C.prototype.constructor=C}function c(C,O,E){if(c.isBN(C))return C;this.negative=0,this.words=null,this.length=0,this.red=null,C!==null&&(O!=="le"&&O!=="be"||(E=O,O=10),this._init(C||0,O||10,E||"be"))}var u;typeof a=="object"?a.exports=c:(void 0).BN=c,c.BN=c,c.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch{}function d(C,O){var E=C.charCodeAt(O);return E>=65&&E<=70?E-55:E>=97&&E<=102?E-87:E-48&15}function h(C,O,E){var x=d(C,E);return E-1>=O&&(x|=d(C,E-1)<<4),x}function f(C,O,E,x){for(var w=0,_=Math.min(C.length,E),S=O;S<_;S++){var T=C.charCodeAt(S)-48;w*=x,w+=T>=49?T-49+10:T>=17?T-17+10:T}return w}c.isBN=function(C){return C instanceof c||C!==null&&typeof C=="object"&&C.constructor.wordSize===c.wordSize&&Array.isArray(C.words)},c.max=function(C,O){return C.cmp(O)>0?C:O},c.min=function(C,O){return C.cmp(O)<0?C:O},c.prototype._init=function(C,O,E){if(typeof C=="number")return this._initNumber(C,O,E);if(typeof C=="object")return this._initArray(C,O,E);O==="hex"&&(O=16),o(O===(0|O)&&O>=2&&O<=36);var x=0;(C=C.toString().replace(/\s+/g,""))[0]==="-"&&(x++,this.negative=1),x<C.length&&(O===16?this._parseHex(C,x,E):(this._parseBase(C,O,x),E==="le"&&this._initArray(this.toArray(),O,E)))},c.prototype._initNumber=function(C,O,E){C<0&&(this.negative=1,C=-C),C<67108864?(this.words=[67108863&C],this.length=1):C<4503599627370496?(this.words=[67108863&C,C/67108864&67108863],this.length=2):(o(C<9007199254740992),this.words=[67108863&C,C/67108864&67108863,1],this.length=3),E==="le"&&this._initArray(this.toArray(),O,E)},c.prototype._initArray=function(C,O,E){if(o(typeof C.length=="number"),C.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(C.length/3),this.words=new Array(this.length);for(var x=0;x<this.length;x++)this.words[x]=0;var w,_,S=0;if(E==="be")for(x=C.length-1,w=0;x>=0;x-=3)_=C[x]|C[x-1]<<8|C[x-2]<<16,this.words[w]|=_<<S&67108863,this.words[w+1]=_>>>26-S&67108863,(S+=24)>=26&&(S-=26,w++);else if(E==="le")for(x=0,w=0;x<C.length;x+=3)_=C[x]|C[x+1]<<8|C[x+2]<<16,this.words[w]|=_<<S&67108863,this.words[w+1]=_>>>26-S&67108863,(S+=24)>=26&&(S-=26,w++);return this.strip()},c.prototype._parseHex=function(C,O,E){this.length=Math.ceil((C.length-O)/6),this.words=new Array(this.length);for(var x=0;x<this.length;x++)this.words[x]=0;var w,_=0,S=0;if(E==="be")for(x=C.length-1;x>=O;x-=2)w=h(C,O,x)<<_,this.words[S]|=67108863&w,_>=18?(_-=18,S+=1,this.words[S]|=w>>>26):_+=8;else for(x=(C.length-O)%2==0?O+1:O;x<C.length;x+=2)w=h(C,O,x)<<_,this.words[S]|=67108863&w,_>=18?(_-=18,S+=1,this.words[S]|=w>>>26):_+=8;this.strip()},c.prototype._parseBase=function(C,O,E){this.words=[0],this.length=1;for(var x=0,w=1;w<=67108863;w*=O)x++;x--,w=w/O|0;for(var _=C.length-E,S=_%x,T=Math.min(_,_-S)+E,U=0,A=E;A<T;A+=x)U=f(C,A,A+x,O),this.imuln(w),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U);if(S!==0){var H=1;for(U=f(C,A,C.length,O),A=0;A<S;A++)H*=O;this.imuln(H),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U)}this.strip()},c.prototype.copy=function(C){C.words=new Array(this.length);for(var O=0;O<this.length;O++)C.words[O]=this.words[O];C.length=this.length,C.negative=this.negative,C.red=this.red},c.prototype.clone=function(){var C=new c(null);return this.copy(C),C},c.prototype._expand=function(C){for(;this.length<C;)this.words[this.length++]=0;return this},c.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},c.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},c.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var g=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],m=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function v(C,O,E){E.negative=O.negative^C.negative;var x=C.length+O.length|0;E.length=x,x=x-1|0;var w=0|C.words[0],_=0|O.words[0],S=w*_,T=67108863&S,U=S/67108864|0;E.words[0]=T;for(var A=1;A<x;A++){for(var H=U>>>26,z=67108863&U,K=Math.min(A,O.length-1),j=Math.max(0,A-C.length+1);j<=K;j++){var J=A-j|0;H+=(S=(w=0|C.words[J])*(_=0|O.words[j])+z)/67108864|0,z=67108863&S}E.words[A]=0|z,U=0|H}return U!==0?E.words[A]=0|U:E.length--,E.strip()}c.prototype.toString=function(C,O){var E;if(O=0|O||1,(C=C||10)===16||C==="hex"){E="";for(var x=0,w=0,_=0;_<this.length;_++){var S=this.words[_],T=(16777215&(S<<x|w)).toString(16);E=(w=S>>>24-x&16777215)!==0||_!==this.length-1?g[6-T.length]+T+E:T+E,(x+=2)>=26&&(x-=26,_--)}for(w!==0&&(E=w.toString(16)+E);E.length%O!=0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}if(C===(0|C)&&C>=2&&C<=36){var U=m[C],A=p[C];E="";var H=this.clone();for(H.negative=0;!H.isZero();){var z=H.modn(A).toString(C);E=(H=H.idivn(A)).isZero()?z+E:g[U-z.length]+z+E}for(this.isZero()&&(E="0"+E);E.length%O!=0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}o(!1,"Base should be between 2 and 36")},c.prototype.toNumber=function(){var C=this.words[0];return this.length===2?C+=67108864*this.words[1]:this.length===3&&this.words[2]===1?C+=4503599627370496+67108864*this.words[1]:this.length>2&&o(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-C:C},c.prototype.toJSON=function(){return this.toString(16)},c.prototype.toBuffer=function(C,O){return o(u!==void 0),this.toArrayLike(u,C,O)},c.prototype.toArray=function(C,O){return this.toArrayLike(Array,C,O)},c.prototype.toArrayLike=function(C,O,E){var x=this.byteLength(),w=E||Math.max(1,x);o(x<=w,"byte array longer than desired length"),o(w>0,"Requested array length <= 0"),this.strip();var _,S,T=O==="le",U=new C(w),A=this.clone();if(T){for(S=0;!A.isZero();S++)_=A.andln(255),A.iushrn(8),U[S]=_;for(;S<w;S++)U[S]=0}else{for(S=0;S<w-x;S++)U[S]=0;for(S=0;!A.isZero();S++)_=A.andln(255),A.iushrn(8),U[w-S-1]=_}return U},Math.clz32?c.prototype._countBits=function(C){return 32-Math.clz32(C)}:c.prototype._countBits=function(C){var O=C,E=0;return O>=4096&&(E+=13,O>>>=13),O>=64&&(E+=7,O>>>=7),O>=8&&(E+=4,O>>>=4),O>=2&&(E+=2,O>>>=2),E+O},c.prototype._zeroBits=function(C){if(C===0)return 26;var O=C,E=0;return!(8191&O)&&(E+=13,O>>>=13),!(127&O)&&(E+=7,O>>>=7),!(15&O)&&(E+=4,O>>>=4),!(3&O)&&(E+=2,O>>>=2),!(1&O)&&E++,E},c.prototype.bitLength=function(){var C=this.words[this.length-1],O=this._countBits(C);return 26*(this.length-1)+O},c.prototype.zeroBits=function(){if(this.isZero())return 0;for(var C=0,O=0;O<this.length;O++){var E=this._zeroBits(this.words[O]);if(C+=E,E!==26)break}return C},c.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},c.prototype.toTwos=function(C){return this.negative!==0?this.abs().inotn(C).iaddn(1):this.clone()},c.prototype.fromTwos=function(C){return this.testn(C-1)?this.notn(C).iaddn(1).ineg():this.clone()},c.prototype.isNeg=function(){return this.negative!==0},c.prototype.neg=function(){return this.clone().ineg()},c.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},c.prototype.iuor=function(C){for(;this.length<C.length;)this.words[this.length++]=0;for(var O=0;O<C.length;O++)this.words[O]=this.words[O]|C.words[O];return this.strip()},c.prototype.ior=function(C){return o((this.negative|C.negative)==0),this.iuor(C)},c.prototype.or=function(C){return this.length>C.length?this.clone().ior(C):C.clone().ior(this)},c.prototype.uor=function(C){return this.length>C.length?this.clone().iuor(C):C.clone().iuor(this)},c.prototype.iuand=function(C){var O;O=this.length>C.length?C:this;for(var E=0;E<O.length;E++)this.words[E]=this.words[E]&C.words[E];return this.length=O.length,this.strip()},c.prototype.iand=function(C){return o((this.negative|C.negative)==0),this.iuand(C)},c.prototype.and=function(C){return this.length>C.length?this.clone().iand(C):C.clone().iand(this)},c.prototype.uand=function(C){return this.length>C.length?this.clone().iuand(C):C.clone().iuand(this)},c.prototype.iuxor=function(C){var O,E;this.length>C.length?(O=this,E=C):(O=C,E=this);for(var x=0;x<E.length;x++)this.words[x]=O.words[x]^E.words[x];if(this!==O)for(;x<O.length;x++)this.words[x]=O.words[x];return this.length=O.length,this.strip()},c.prototype.ixor=function(C){return o((this.negative|C.negative)==0),this.iuxor(C)},c.prototype.xor=function(C){return this.length>C.length?this.clone().ixor(C):C.clone().ixor(this)},c.prototype.uxor=function(C){return this.length>C.length?this.clone().iuxor(C):C.clone().iuxor(this)},c.prototype.inotn=function(C){o(typeof C=="number"&&C>=0);var O=0|Math.ceil(C/26),E=C%26;this._expand(O),E>0&&O--;for(var x=0;x<O;x++)this.words[x]=67108863&~this.words[x];return E>0&&(this.words[x]=~this.words[x]&67108863>>26-E),this.strip()},c.prototype.notn=function(C){return this.clone().inotn(C)},c.prototype.setn=function(C,O){o(typeof C=="number"&&C>=0);var E=C/26|0,x=C%26;return this._expand(E+1),this.words[E]=O?this.words[E]|1<<x:this.words[E]&~(1<<x),this.strip()},c.prototype.iadd=function(C){var O,E,x;if(this.negative!==0&&C.negative===0)return this.negative=0,O=this.isub(C),this.negative^=1,this._normSign();if(this.negative===0&&C.negative!==0)return C.negative=0,O=this.isub(C),C.negative=1,O._normSign();this.length>C.length?(E=this,x=C):(E=C,x=this);for(var w=0,_=0;_<x.length;_++)O=(0|E.words[_])+(0|x.words[_])+w,this.words[_]=67108863&O,w=O>>>26;for(;w!==0&&_<E.length;_++)O=(0|E.words[_])+w,this.words[_]=67108863&O,w=O>>>26;if(this.length=E.length,w!==0)this.words[this.length]=w,this.length++;else if(E!==this)for(;_<E.length;_++)this.words[_]=E.words[_];return this},c.prototype.add=function(C){var O;return C.negative!==0&&this.negative===0?(C.negative=0,O=this.sub(C),C.negative^=1,O):C.negative===0&&this.negative!==0?(this.negative=0,O=C.sub(this),this.negative=1,O):this.length>C.length?this.clone().iadd(C):C.clone().iadd(this)},c.prototype.isub=function(C){if(C.negative!==0){C.negative=0;var O=this.iadd(C);return C.negative=1,O._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(C),this.negative=1,this._normSign();var E,x,w=this.cmp(C);if(w===0)return this.negative=0,this.length=1,this.words[0]=0,this;w>0?(E=this,x=C):(E=C,x=this);for(var _=0,S=0;S<x.length;S++)_=(O=(0|E.words[S])-(0|x.words[S])+_)>>26,this.words[S]=67108863&O;for(;_!==0&&S<E.length;S++)_=(O=(0|E.words[S])+_)>>26,this.words[S]=67108863&O;if(_===0&&S<E.length&&E!==this)for(;S<E.length;S++)this.words[S]=E.words[S];return this.length=Math.max(this.length,S),E!==this&&(this.negative=1),this.strip()},c.prototype.sub=function(C){return this.clone().isub(C)};var b=function(C,O,E){var x,w,_,S=C.words,T=O.words,U=E.words,A=0,H=0|S[0],z=8191&H,K=H>>>13,j=0|S[1],J=8191&j,P=j>>>13,D=0|S[2],G=8191&D,re=D>>>13,te=0|S[3],ne=8191&te,le=te>>>13,oe=0|S[4],ee=8191&oe,Z=oe>>>13,se=0|S[5],ie=8191&se,ue=se>>>13,pe=0|S[6],fe=8191&pe,ye=pe>>>13,Te=0|S[7],Pe=8191&Te,je=Te>>>13,qe=0|S[8],We=8191&qe,at=qe>>>13,Ye=0|S[9],rt=8191&Ye,ht=Ye>>>13,Ce=0|T[0],Ie=8191&Ce,Ve=Ce>>>13,De=0|T[1],Oe=8191&De,Xe=De>>>13,nt=0|T[2],Je=8191&nt,wt=nt>>>13,gt=0|T[3],dt=8191&gt,ct=gt>>>13,ut=0|T[4],ft=8191&ut,Et=ut>>>13,jt=0|T[5],Ot=8191&jt,yt=jt>>>13,Vt=0|T[6],$t=8191&Vt,Fe=Vt>>>13,Be=0|T[7],tt=8191&Be,ce=Be>>>13,ke=0|T[8],me=8191&ke,xe=ke>>>13,_e=0|T[9],Ee=8191&_e,Le=_e>>>13;E.negative=C.negative^O.negative,E.length=19;var Ke=(A+(x=Math.imul(z,Ie))|0)+((8191&(w=(w=Math.imul(z,Ve))+Math.imul(K,Ie)|0))<<13)|0;A=((_=Math.imul(K,Ve))+(w>>>13)|0)+(Ke>>>26)|0,Ke&=67108863,x=Math.imul(J,Ie),w=(w=Math.imul(J,Ve))+Math.imul(P,Ie)|0,_=Math.imul(P,Ve);var Ue=(A+(x=x+Math.imul(z,Oe)|0)|0)+((8191&(w=(w=w+Math.imul(z,Xe)|0)+Math.imul(K,Oe)|0))<<13)|0;A=((_=_+Math.imul(K,Xe)|0)+(w>>>13)|0)+(Ue>>>26)|0,Ue&=67108863,x=Math.imul(G,Ie),w=(w=Math.imul(G,Ve))+Math.imul(re,Ie)|0,_=Math.imul(re,Ve),x=x+Math.imul(J,Oe)|0,w=(w=w+Math.imul(J,Xe)|0)+Math.imul(P,Oe)|0,_=_+Math.imul(P,Xe)|0;var Qe=(A+(x=x+Math.imul(z,Je)|0)|0)+((8191&(w=(w=w+Math.imul(z,wt)|0)+Math.imul(K,Je)|0))<<13)|0;A=((_=_+Math.imul(K,wt)|0)+(w>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,x=Math.imul(ne,Ie),w=(w=Math.imul(ne,Ve))+Math.imul(le,Ie)|0,_=Math.imul(le,Ve),x=x+Math.imul(G,Oe)|0,w=(w=w+Math.imul(G,Xe)|0)+Math.imul(re,Oe)|0,_=_+Math.imul(re,Xe)|0,x=x+Math.imul(J,Je)|0,w=(w=w+Math.imul(J,wt)|0)+Math.imul(P,Je)|0,_=_+Math.imul(P,wt)|0;var et=(A+(x=x+Math.imul(z,dt)|0)|0)+((8191&(w=(w=w+Math.imul(z,ct)|0)+Math.imul(K,dt)|0))<<13)|0;A=((_=_+Math.imul(K,ct)|0)+(w>>>13)|0)+(et>>>26)|0,et&=67108863,x=Math.imul(ee,Ie),w=(w=Math.imul(ee,Ve))+Math.imul(Z,Ie)|0,_=Math.imul(Z,Ve),x=x+Math.imul(ne,Oe)|0,w=(w=w+Math.imul(ne,Xe)|0)+Math.imul(le,Oe)|0,_=_+Math.imul(le,Xe)|0,x=x+Math.imul(G,Je)|0,w=(w=w+Math.imul(G,wt)|0)+Math.imul(re,Je)|0,_=_+Math.imul(re,wt)|0,x=x+Math.imul(J,dt)|0,w=(w=w+Math.imul(J,ct)|0)+Math.imul(P,dt)|0,_=_+Math.imul(P,ct)|0;var bt=(A+(x=x+Math.imul(z,ft)|0)|0)+((8191&(w=(w=w+Math.imul(z,Et)|0)+Math.imul(K,ft)|0))<<13)|0;A=((_=_+Math.imul(K,Et)|0)+(w>>>13)|0)+(bt>>>26)|0,bt&=67108863,x=Math.imul(ie,Ie),w=(w=Math.imul(ie,Ve))+Math.imul(ue,Ie)|0,_=Math.imul(ue,Ve),x=x+Math.imul(ee,Oe)|0,w=(w=w+Math.imul(ee,Xe)|0)+Math.imul(Z,Oe)|0,_=_+Math.imul(Z,Xe)|0,x=x+Math.imul(ne,Je)|0,w=(w=w+Math.imul(ne,wt)|0)+Math.imul(le,Je)|0,_=_+Math.imul(le,wt)|0,x=x+Math.imul(G,dt)|0,w=(w=w+Math.imul(G,ct)|0)+Math.imul(re,dt)|0,_=_+Math.imul(re,ct)|0,x=x+Math.imul(J,ft)|0,w=(w=w+Math.imul(J,Et)|0)+Math.imul(P,ft)|0,_=_+Math.imul(P,Et)|0;var Ct=(A+(x=x+Math.imul(z,Ot)|0)|0)+((8191&(w=(w=w+Math.imul(z,yt)|0)+Math.imul(K,Ot)|0))<<13)|0;A=((_=_+Math.imul(K,yt)|0)+(w>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,x=Math.imul(fe,Ie),w=(w=Math.imul(fe,Ve))+Math.imul(ye,Ie)|0,_=Math.imul(ye,Ve),x=x+Math.imul(ie,Oe)|0,w=(w=w+Math.imul(ie,Xe)|0)+Math.imul(ue,Oe)|0,_=_+Math.imul(ue,Xe)|0,x=x+Math.imul(ee,Je)|0,w=(w=w+Math.imul(ee,wt)|0)+Math.imul(Z,Je)|0,_=_+Math.imul(Z,wt)|0,x=x+Math.imul(ne,dt)|0,w=(w=w+Math.imul(ne,ct)|0)+Math.imul(le,dt)|0,_=_+Math.imul(le,ct)|0,x=x+Math.imul(G,ft)|0,w=(w=w+Math.imul(G,Et)|0)+Math.imul(re,ft)|0,_=_+Math.imul(re,Et)|0,x=x+Math.imul(J,Ot)|0,w=(w=w+Math.imul(J,yt)|0)+Math.imul(P,Ot)|0,_=_+Math.imul(P,yt)|0;var Pt=(A+(x=x+Math.imul(z,$t)|0)|0)+((8191&(w=(w=w+Math.imul(z,Fe)|0)+Math.imul(K,$t)|0))<<13)|0;A=((_=_+Math.imul(K,Fe)|0)+(w>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,x=Math.imul(Pe,Ie),w=(w=Math.imul(Pe,Ve))+Math.imul(je,Ie)|0,_=Math.imul(je,Ve),x=x+Math.imul(fe,Oe)|0,w=(w=w+Math.imul(fe,Xe)|0)+Math.imul(ye,Oe)|0,_=_+Math.imul(ye,Xe)|0,x=x+Math.imul(ie,Je)|0,w=(w=w+Math.imul(ie,wt)|0)+Math.imul(ue,Je)|0,_=_+Math.imul(ue,wt)|0,x=x+Math.imul(ee,dt)|0,w=(w=w+Math.imul(ee,ct)|0)+Math.imul(Z,dt)|0,_=_+Math.imul(Z,ct)|0,x=x+Math.imul(ne,ft)|0,w=(w=w+Math.imul(ne,Et)|0)+Math.imul(le,ft)|0,_=_+Math.imul(le,Et)|0,x=x+Math.imul(G,Ot)|0,w=(w=w+Math.imul(G,yt)|0)+Math.imul(re,Ot)|0,_=_+Math.imul(re,yt)|0,x=x+Math.imul(J,$t)|0,w=(w=w+Math.imul(J,Fe)|0)+Math.imul(P,$t)|0,_=_+Math.imul(P,Fe)|0;var be=(A+(x=x+Math.imul(z,tt)|0)|0)+((8191&(w=(w=w+Math.imul(z,ce)|0)+Math.imul(K,tt)|0))<<13)|0;A=((_=_+Math.imul(K,ce)|0)+(w>>>13)|0)+(be>>>26)|0,be&=67108863,x=Math.imul(We,Ie),w=(w=Math.imul(We,Ve))+Math.imul(at,Ie)|0,_=Math.imul(at,Ve),x=x+Math.imul(Pe,Oe)|0,w=(w=w+Math.imul(Pe,Xe)|0)+Math.imul(je,Oe)|0,_=_+Math.imul(je,Xe)|0,x=x+Math.imul(fe,Je)|0,w=(w=w+Math.imul(fe,wt)|0)+Math.imul(ye,Je)|0,_=_+Math.imul(ye,wt)|0,x=x+Math.imul(ie,dt)|0,w=(w=w+Math.imul(ie,ct)|0)+Math.imul(ue,dt)|0,_=_+Math.imul(ue,ct)|0,x=x+Math.imul(ee,ft)|0,w=(w=w+Math.imul(ee,Et)|0)+Math.imul(Z,ft)|0,_=_+Math.imul(Z,Et)|0,x=x+Math.imul(ne,Ot)|0,w=(w=w+Math.imul(ne,yt)|0)+Math.imul(le,Ot)|0,_=_+Math.imul(le,yt)|0,x=x+Math.imul(G,$t)|0,w=(w=w+Math.imul(G,Fe)|0)+Math.imul(re,$t)|0,_=_+Math.imul(re,Fe)|0,x=x+Math.imul(J,tt)|0,w=(w=w+Math.imul(J,ce)|0)+Math.imul(P,tt)|0,_=_+Math.imul(P,ce)|0;var Me=(A+(x=x+Math.imul(z,me)|0)|0)+((8191&(w=(w=w+Math.imul(z,xe)|0)+Math.imul(K,me)|0))<<13)|0;A=((_=_+Math.imul(K,xe)|0)+(w>>>13)|0)+(Me>>>26)|0,Me&=67108863,x=Math.imul(rt,Ie),w=(w=Math.imul(rt,Ve))+Math.imul(ht,Ie)|0,_=Math.imul(ht,Ve),x=x+Math.imul(We,Oe)|0,w=(w=w+Math.imul(We,Xe)|0)+Math.imul(at,Oe)|0,_=_+Math.imul(at,Xe)|0,x=x+Math.imul(Pe,Je)|0,w=(w=w+Math.imul(Pe,wt)|0)+Math.imul(je,Je)|0,_=_+Math.imul(je,wt)|0,x=x+Math.imul(fe,dt)|0,w=(w=w+Math.imul(fe,ct)|0)+Math.imul(ye,dt)|0,_=_+Math.imul(ye,ct)|0,x=x+Math.imul(ie,ft)|0,w=(w=w+Math.imul(ie,Et)|0)+Math.imul(ue,ft)|0,_=_+Math.imul(ue,Et)|0,x=x+Math.imul(ee,Ot)|0,w=(w=w+Math.imul(ee,yt)|0)+Math.imul(Z,Ot)|0,_=_+Math.imul(Z,yt)|0,x=x+Math.imul(ne,$t)|0,w=(w=w+Math.imul(ne,Fe)|0)+Math.imul(le,$t)|0,_=_+Math.imul(le,Fe)|0,x=x+Math.imul(G,tt)|0,w=(w=w+Math.imul(G,ce)|0)+Math.imul(re,tt)|0,_=_+Math.imul(re,ce)|0,x=x+Math.imul(J,me)|0,w=(w=w+Math.imul(J,xe)|0)+Math.imul(P,me)|0,_=_+Math.imul(P,xe)|0;var it=(A+(x=x+Math.imul(z,Ee)|0)|0)+((8191&(w=(w=w+Math.imul(z,Le)|0)+Math.imul(K,Ee)|0))<<13)|0;A=((_=_+Math.imul(K,Le)|0)+(w>>>13)|0)+(it>>>26)|0,it&=67108863,x=Math.imul(rt,Oe),w=(w=Math.imul(rt,Xe))+Math.imul(ht,Oe)|0,_=Math.imul(ht,Xe),x=x+Math.imul(We,Je)|0,w=(w=w+Math.imul(We,wt)|0)+Math.imul(at,Je)|0,_=_+Math.imul(at,wt)|0,x=x+Math.imul(Pe,dt)|0,w=(w=w+Math.imul(Pe,ct)|0)+Math.imul(je,dt)|0,_=_+Math.imul(je,ct)|0,x=x+Math.imul(fe,ft)|0,w=(w=w+Math.imul(fe,Et)|0)+Math.imul(ye,ft)|0,_=_+Math.imul(ye,Et)|0,x=x+Math.imul(ie,Ot)|0,w=(w=w+Math.imul(ie,yt)|0)+Math.imul(ue,Ot)|0,_=_+Math.imul(ue,yt)|0,x=x+Math.imul(ee,$t)|0,w=(w=w+Math.imul(ee,Fe)|0)+Math.imul(Z,$t)|0,_=_+Math.imul(Z,Fe)|0,x=x+Math.imul(ne,tt)|0,w=(w=w+Math.imul(ne,ce)|0)+Math.imul(le,tt)|0,_=_+Math.imul(le,ce)|0,x=x+Math.imul(G,me)|0,w=(w=w+Math.imul(G,xe)|0)+Math.imul(re,me)|0,_=_+Math.imul(re,xe)|0;var mt=(A+(x=x+Math.imul(J,Ee)|0)|0)+((8191&(w=(w=w+Math.imul(J,Le)|0)+Math.imul(P,Ee)|0))<<13)|0;A=((_=_+Math.imul(P,Le)|0)+(w>>>13)|0)+(mt>>>26)|0,mt&=67108863,x=Math.imul(rt,Je),w=(w=Math.imul(rt,wt))+Math.imul(ht,Je)|0,_=Math.imul(ht,wt),x=x+Math.imul(We,dt)|0,w=(w=w+Math.imul(We,ct)|0)+Math.imul(at,dt)|0,_=_+Math.imul(at,ct)|0,x=x+Math.imul(Pe,ft)|0,w=(w=w+Math.imul(Pe,Et)|0)+Math.imul(je,ft)|0,_=_+Math.imul(je,Et)|0,x=x+Math.imul(fe,Ot)|0,w=(w=w+Math.imul(fe,yt)|0)+Math.imul(ye,Ot)|0,_=_+Math.imul(ye,yt)|0,x=x+Math.imul(ie,$t)|0,w=(w=w+Math.imul(ie,Fe)|0)+Math.imul(ue,$t)|0,_=_+Math.imul(ue,Fe)|0,x=x+Math.imul(ee,tt)|0,w=(w=w+Math.imul(ee,ce)|0)+Math.imul(Z,tt)|0,_=_+Math.imul(Z,ce)|0,x=x+Math.imul(ne,me)|0,w=(w=w+Math.imul(ne,xe)|0)+Math.imul(le,me)|0,_=_+Math.imul(le,xe)|0;var Rt=(A+(x=x+Math.imul(G,Ee)|0)|0)+((8191&(w=(w=w+Math.imul(G,Le)|0)+Math.imul(re,Ee)|0))<<13)|0;A=((_=_+Math.imul(re,Le)|0)+(w>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,x=Math.imul(rt,dt),w=(w=Math.imul(rt,ct))+Math.imul(ht,dt)|0,_=Math.imul(ht,ct),x=x+Math.imul(We,ft)|0,w=(w=w+Math.imul(We,Et)|0)+Math.imul(at,ft)|0,_=_+Math.imul(at,Et)|0,x=x+Math.imul(Pe,Ot)|0,w=(w=w+Math.imul(Pe,yt)|0)+Math.imul(je,Ot)|0,_=_+Math.imul(je,yt)|0,x=x+Math.imul(fe,$t)|0,w=(w=w+Math.imul(fe,Fe)|0)+Math.imul(ye,$t)|0,_=_+Math.imul(ye,Fe)|0,x=x+Math.imul(ie,tt)|0,w=(w=w+Math.imul(ie,ce)|0)+Math.imul(ue,tt)|0,_=_+Math.imul(ue,ce)|0,x=x+Math.imul(ee,me)|0,w=(w=w+Math.imul(ee,xe)|0)+Math.imul(Z,me)|0,_=_+Math.imul(Z,xe)|0;var kt=(A+(x=x+Math.imul(ne,Ee)|0)|0)+((8191&(w=(w=w+Math.imul(ne,Le)|0)+Math.imul(le,Ee)|0))<<13)|0;A=((_=_+Math.imul(le,Le)|0)+(w>>>13)|0)+(kt>>>26)|0,kt&=67108863,x=Math.imul(rt,ft),w=(w=Math.imul(rt,Et))+Math.imul(ht,ft)|0,_=Math.imul(ht,Et),x=x+Math.imul(We,Ot)|0,w=(w=w+Math.imul(We,yt)|0)+Math.imul(at,Ot)|0,_=_+Math.imul(at,yt)|0,x=x+Math.imul(Pe,$t)|0,w=(w=w+Math.imul(Pe,Fe)|0)+Math.imul(je,$t)|0,_=_+Math.imul(je,Fe)|0,x=x+Math.imul(fe,tt)|0,w=(w=w+Math.imul(fe,ce)|0)+Math.imul(ye,tt)|0,_=_+Math.imul(ye,ce)|0,x=x+Math.imul(ie,me)|0,w=(w=w+Math.imul(ie,xe)|0)+Math.imul(ue,me)|0,_=_+Math.imul(ue,xe)|0;var Nt=(A+(x=x+Math.imul(ee,Ee)|0)|0)+((8191&(w=(w=w+Math.imul(ee,Le)|0)+Math.imul(Z,Ee)|0))<<13)|0;A=((_=_+Math.imul(Z,Le)|0)+(w>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,x=Math.imul(rt,Ot),w=(w=Math.imul(rt,yt))+Math.imul(ht,Ot)|0,_=Math.imul(ht,yt),x=x+Math.imul(We,$t)|0,w=(w=w+Math.imul(We,Fe)|0)+Math.imul(at,$t)|0,_=_+Math.imul(at,Fe)|0,x=x+Math.imul(Pe,tt)|0,w=(w=w+Math.imul(Pe,ce)|0)+Math.imul(je,tt)|0,_=_+Math.imul(je,ce)|0,x=x+Math.imul(fe,me)|0,w=(w=w+Math.imul(fe,xe)|0)+Math.imul(ye,me)|0,_=_+Math.imul(ye,xe)|0;var sr=(A+(x=x+Math.imul(ie,Ee)|0)|0)+((8191&(w=(w=w+Math.imul(ie,Le)|0)+Math.imul(ue,Ee)|0))<<13)|0;A=((_=_+Math.imul(ue,Le)|0)+(w>>>13)|0)+(sr>>>26)|0,sr&=67108863,x=Math.imul(rt,$t),w=(w=Math.imul(rt,Fe))+Math.imul(ht,$t)|0,_=Math.imul(ht,Fe),x=x+Math.imul(We,tt)|0,w=(w=w+Math.imul(We,ce)|0)+Math.imul(at,tt)|0,_=_+Math.imul(at,ce)|0,x=x+Math.imul(Pe,me)|0,w=(w=w+Math.imul(Pe,xe)|0)+Math.imul(je,me)|0,_=_+Math.imul(je,xe)|0;var Gt=(A+(x=x+Math.imul(fe,Ee)|0)|0)+((8191&(w=(w=w+Math.imul(fe,Le)|0)+Math.imul(ye,Ee)|0))<<13)|0;A=((_=_+Math.imul(ye,Le)|0)+(w>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,x=Math.imul(rt,tt),w=(w=Math.imul(rt,ce))+Math.imul(ht,tt)|0,_=Math.imul(ht,ce),x=x+Math.imul(We,me)|0,w=(w=w+Math.imul(We,xe)|0)+Math.imul(at,me)|0,_=_+Math.imul(at,xe)|0;var Xt=(A+(x=x+Math.imul(Pe,Ee)|0)|0)+((8191&(w=(w=w+Math.imul(Pe,Le)|0)+Math.imul(je,Ee)|0))<<13)|0;A=((_=_+Math.imul(je,Le)|0)+(w>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,x=Math.imul(rt,me),w=(w=Math.imul(rt,xe))+Math.imul(ht,me)|0,_=Math.imul(ht,xe);var Ht=(A+(x=x+Math.imul(We,Ee)|0)|0)+((8191&(w=(w=w+Math.imul(We,Le)|0)+Math.imul(at,Ee)|0))<<13)|0;A=((_=_+Math.imul(at,Le)|0)+(w>>>13)|0)+(Ht>>>26)|0,Ht&=67108863;var ar=(A+(x=Math.imul(rt,Ee))|0)+((8191&(w=(w=Math.imul(rt,Le))+Math.imul(ht,Ee)|0))<<13)|0;return A=((_=Math.imul(ht,Le))+(w>>>13)|0)+(ar>>>26)|0,ar&=67108863,U[0]=Ke,U[1]=Ue,U[2]=Qe,U[3]=et,U[4]=bt,U[5]=Ct,U[6]=Pt,U[7]=be,U[8]=Me,U[9]=it,U[10]=mt,U[11]=Rt,U[12]=kt,U[13]=Nt,U[14]=sr,U[15]=Gt,U[16]=Xt,U[17]=Ht,U[18]=ar,A!==0&&(U[19]=A,E.length++),E};function y(C,O,E){return new k().mulp(C,O,E)}function k(C,O){this.x=C,this.y=O}Math.imul||(b=v),c.prototype.mulTo=function(C,O){var E=this.length+C.length;return this.length===10&&C.length===10?b(this,C,O):E<63?v(this,C,O):E<1024?function(x,w,_){_.negative=w.negative^x.negative,_.length=x.length+w.length;for(var S=0,T=0,U=0;U<_.length-1;U++){var A=T;T=0;for(var H=67108863&S,z=Math.min(U,w.length-1),K=Math.max(0,U-x.length+1);K<=z;K++){var j=U-K,J=(0|x.words[j])*(0|w.words[K]),P=67108863&J;H=67108863&(P=P+H|0),T+=(A=(A=A+(J/67108864|0)|0)+(P>>>26)|0)>>>26,A&=67108863}_.words[U]=H,S=A,A=T}return S!==0?_.words[U]=S:_.length--,_.strip()}(this,C,O):y(this,C,O)},k.prototype.makeRBT=function(C){for(var O=new Array(C),E=c.prototype._countBits(C)-1,x=0;x<C;x++)O[x]=this.revBin(x,E,C);return O},k.prototype.revBin=function(C,O,E){if(C===0||C===E-1)return C;for(var x=0,w=0;w<O;w++)x|=(1&C)<<O-w-1,C>>=1;return x},k.prototype.permute=function(C,O,E,x,w,_){for(var S=0;S<_;S++)x[S]=O[C[S]],w[S]=E[C[S]]},k.prototype.transform=function(C,O,E,x,w,_){this.permute(_,C,O,E,x,w);for(var S=1;S<w;S<<=1)for(var T=S<<1,U=Math.cos(2*Math.PI/T),A=Math.sin(2*Math.PI/T),H=0;H<w;H+=T)for(var z=U,K=A,j=0;j<S;j++){var J=E[H+j],P=x[H+j],D=E[H+j+S],G=x[H+j+S],re=z*D-K*G;G=z*G+K*D,D=re,E[H+j]=J+D,x[H+j]=P+G,E[H+j+S]=J-D,x[H+j+S]=P-G,j!==T&&(re=U*z-A*K,K=U*K+A*z,z=re)}},k.prototype.guessLen13b=function(C,O){var E=1|Math.max(O,C),x=1&E,w=0;for(E=E/2|0;E;E>>>=1)w++;return 1<<w+1+x},k.prototype.conjugate=function(C,O,E){if(!(E<=1))for(var x=0;x<E/2;x++){var w=C[x];C[x]=C[E-x-1],C[E-x-1]=w,w=O[x],O[x]=-O[E-x-1],O[E-x-1]=-w}},k.prototype.normalize13b=function(C,O){for(var E=0,x=0;x<O/2;x++){var w=8192*Math.round(C[2*x+1]/O)+Math.round(C[2*x]/O)+E;C[x]=67108863&w,E=w<67108864?0:w/67108864|0}return C},k.prototype.convert13b=function(C,O,E,x){for(var w=0,_=0;_<O;_++)w+=0|C[_],E[2*_]=8191&w,w>>>=13,E[2*_+1]=8191&w,w>>>=13;for(_=2*O;_<x;++_)E[_]=0;o(w===0),o((-8192&w)==0)},k.prototype.stub=function(C){for(var O=new Array(C),E=0;E<C;E++)O[E]=0;return O},k.prototype.mulp=function(C,O,E){var x=2*this.guessLen13b(C.length,O.length),w=this.makeRBT(x),_=this.stub(x),S=new Array(x),T=new Array(x),U=new Array(x),A=new Array(x),H=new Array(x),z=new Array(x),K=E.words;K.length=x,this.convert13b(C.words,C.length,S,x),this.convert13b(O.words,O.length,A,x),this.transform(S,_,T,U,x,w),this.transform(A,_,H,z,x,w);for(var j=0;j<x;j++){var J=T[j]*H[j]-U[j]*z[j];U[j]=T[j]*z[j]+U[j]*H[j],T[j]=J}return this.conjugate(T,U,x),this.transform(T,U,K,_,x,w),this.conjugate(K,_,x),this.normalize13b(K,x),E.negative=C.negative^O.negative,E.length=C.length+O.length,E.strip()},c.prototype.mul=function(C){var O=new c(null);return O.words=new Array(this.length+C.length),this.mulTo(C,O)},c.prototype.mulf=function(C){var O=new c(null);return O.words=new Array(this.length+C.length),y(this,C,O)},c.prototype.imul=function(C){return this.clone().mulTo(C,this)},c.prototype.imuln=function(C){o(typeof C=="number"),o(C<67108864);for(var O=0,E=0;E<this.length;E++){var x=(0|this.words[E])*C,w=(67108863&x)+(67108863&O);O>>=26,O+=x/67108864|0,O+=w>>>26,this.words[E]=67108863&w}return O!==0&&(this.words[E]=O,this.length++),this},c.prototype.muln=function(C){return this.clone().imuln(C)},c.prototype.sqr=function(){return this.mul(this)},c.prototype.isqr=function(){return this.imul(this.clone())},c.prototype.pow=function(C){var O=function(_){for(var S=new Array(_.bitLength()),T=0;T<S.length;T++){var U=T/26|0,A=T%26;S[T]=(_.words[U]&1<<A)>>>A}return S}(C);if(O.length===0)return new c(1);for(var E=this,x=0;x<O.length&&O[x]===0;x++,E=E.sqr());if(++x<O.length)for(var w=E.sqr();x<O.length;x++,w=w.sqr())O[x]!==0&&(E=E.mul(w));return E},c.prototype.iushln=function(C){o(typeof C=="number"&&C>=0);var O,E=C%26,x=(C-E)/26,w=67108863>>>26-E<<26-E;if(E!==0){var _=0;for(O=0;O<this.length;O++){var S=this.words[O]&w,T=(0|this.words[O])-S<<E;this.words[O]=T|_,_=S>>>26-E}_&&(this.words[O]=_,this.length++)}if(x!==0){for(O=this.length-1;O>=0;O--)this.words[O+x]=this.words[O];for(O=0;O<x;O++)this.words[O]=0;this.length+=x}return this.strip()},c.prototype.ishln=function(C){return o(this.negative===0),this.iushln(C)},c.prototype.iushrn=function(C,O,E){var x;o(typeof C=="number"&&C>=0),x=O?(O-O%26)/26:0;var w=C%26,_=Math.min((C-w)/26,this.length),S=67108863^67108863>>>w<<w,T=E;if(x-=_,x=Math.max(0,x),T){for(var U=0;U<_;U++)T.words[U]=this.words[U];T.length=_}if(_!==0)if(this.length>_)for(this.length-=_,U=0;U<this.length;U++)this.words[U]=this.words[U+_];else this.words[0]=0,this.length=1;var A=0;for(U=this.length-1;U>=0&&(A!==0||U>=x);U--){var H=0|this.words[U];this.words[U]=A<<26-w|H>>>w,A=H&S}return T&&A!==0&&(T.words[T.length++]=A),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},c.prototype.ishrn=function(C,O,E){return o(this.negative===0),this.iushrn(C,O,E)},c.prototype.shln=function(C){return this.clone().ishln(C)},c.prototype.ushln=function(C){return this.clone().iushln(C)},c.prototype.shrn=function(C){return this.clone().ishrn(C)},c.prototype.ushrn=function(C){return this.clone().iushrn(C)},c.prototype.testn=function(C){o(typeof C=="number"&&C>=0);var O=C%26,E=(C-O)/26,x=1<<O;return!(this.length<=E)&&!!(this.words[E]&x)},c.prototype.imaskn=function(C){o(typeof C=="number"&&C>=0);var O=C%26,E=(C-O)/26;if(o(this.negative===0,"imaskn works only with positive numbers"),this.length<=E)return this;if(O!==0&&E++,this.length=Math.min(E,this.length),O!==0){var x=67108863^67108863>>>O<<O;this.words[this.length-1]&=x}return this.strip()},c.prototype.maskn=function(C){return this.clone().imaskn(C)},c.prototype.iaddn=function(C){return o(typeof C=="number"),o(C<67108864),C<0?this.isubn(-C):this.negative!==0?this.length===1&&(0|this.words[0])<C?(this.words[0]=C-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(C),this.negative=1,this):this._iaddn(C)},c.prototype._iaddn=function(C){this.words[0]+=C;for(var O=0;O<this.length&&this.words[O]>=67108864;O++)this.words[O]-=67108864,O===this.length-1?this.words[O+1]=1:this.words[O+1]++;return this.length=Math.max(this.length,O+1),this},c.prototype.isubn=function(C){if(o(typeof C=="number"),o(C<67108864),C<0)return this.iaddn(-C);if(this.negative!==0)return this.negative=0,this.iaddn(C),this.negative=1,this;if(this.words[0]-=C,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var O=0;O<this.length&&this.words[O]<0;O++)this.words[O]+=67108864,this.words[O+1]-=1;return this.strip()},c.prototype.addn=function(C){return this.clone().iaddn(C)},c.prototype.subn=function(C){return this.clone().isubn(C)},c.prototype.iabs=function(){return this.negative=0,this},c.prototype.abs=function(){return this.clone().iabs()},c.prototype._ishlnsubmul=function(C,O,E){var x,w,_=C.length+E;this._expand(_);var S=0;for(x=0;x<C.length;x++){w=(0|this.words[x+E])+S;var T=(0|C.words[x])*O;S=((w-=67108863&T)>>26)-(T/67108864|0),this.words[x+E]=67108863&w}for(;x<this.length-E;x++)S=(w=(0|this.words[x+E])+S)>>26,this.words[x+E]=67108863&w;if(S===0)return this.strip();for(o(S===-1),S=0,x=0;x<this.length;x++)S=(w=-(0|this.words[x])+S)>>26,this.words[x]=67108863&w;return this.negative=1,this.strip()},c.prototype._wordDiv=function(C,O){var E=(this.length,C.length),x=this.clone(),w=C,_=0|w.words[w.length-1];(E=26-this._countBits(_))!==0&&(w=w.ushln(E),x.iushln(E),_=0|w.words[w.length-1]);var S,T=x.length-w.length;if(O!=="mod"){(S=new c(null)).length=T+1,S.words=new Array(S.length);for(var U=0;U<S.length;U++)S.words[U]=0}var A=x.clone()._ishlnsubmul(w,1,T);A.negative===0&&(x=A,S&&(S.words[T]=1));for(var H=T-1;H>=0;H--){var z=67108864*(0|x.words[w.length+H])+(0|x.words[w.length+H-1]);for(z=Math.min(z/_|0,67108863),x._ishlnsubmul(w,z,H);x.negative!==0;)z--,x.negative=0,x._ishlnsubmul(w,1,H),x.isZero()||(x.negative^=1);S&&(S.words[H]=z)}return S&&S.strip(),x.strip(),O!=="div"&&E!==0&&x.iushrn(E),{div:S||null,mod:x}},c.prototype.divmod=function(C,O,E){return o(!C.isZero()),this.isZero()?{div:new c(0),mod:new c(0)}:this.negative!==0&&C.negative===0?(_=this.neg().divmod(C,O),O!=="mod"&&(x=_.div.neg()),O!=="div"&&(w=_.mod.neg(),E&&w.negative!==0&&w.iadd(C)),{div:x,mod:w}):this.negative===0&&C.negative!==0?(_=this.divmod(C.neg(),O),O!=="mod"&&(x=_.div.neg()),{div:x,mod:_.mod}):this.negative&C.negative?(_=this.neg().divmod(C.neg(),O),O!=="div"&&(w=_.mod.neg(),E&&w.negative!==0&&w.isub(C)),{div:_.div,mod:w}):C.length>this.length||this.cmp(C)<0?{div:new c(0),mod:this}:C.length===1?O==="div"?{div:this.divn(C.words[0]),mod:null}:O==="mod"?{div:null,mod:new c(this.modn(C.words[0]))}:{div:this.divn(C.words[0]),mod:new c(this.modn(C.words[0]))}:this._wordDiv(C,O);var x,w,_},c.prototype.div=function(C){return this.divmod(C,"div",!1).div},c.prototype.mod=function(C){return this.divmod(C,"mod",!1).mod},c.prototype.umod=function(C){return this.divmod(C,"mod",!0).mod},c.prototype.divRound=function(C){var O=this.divmod(C);if(O.mod.isZero())return O.div;var E=O.div.negative!==0?O.mod.isub(C):O.mod,x=C.ushrn(1),w=C.andln(1),_=E.cmp(x);return _<0||w===1&&_===0?O.div:O.div.negative!==0?O.div.isubn(1):O.div.iaddn(1)},c.prototype.modn=function(C){o(C<=67108863);for(var O=(1<<26)%C,E=0,x=this.length-1;x>=0;x--)E=(O*E+(0|this.words[x]))%C;return E},c.prototype.idivn=function(C){o(C<=67108863);for(var O=0,E=this.length-1;E>=0;E--){var x=(0|this.words[E])+67108864*O;this.words[E]=x/C|0,O=x%C}return this.strip()},c.prototype.divn=function(C){return this.clone().idivn(C)},c.prototype.egcd=function(C){o(C.negative===0),o(!C.isZero());var O=this,E=C.clone();O=O.negative!==0?O.umod(C):O.clone();for(var x=new c(1),w=new c(0),_=new c(0),S=new c(1),T=0;O.isEven()&&E.isEven();)O.iushrn(1),E.iushrn(1),++T;for(var U=E.clone(),A=O.clone();!O.isZero();){for(var H=0,z=1;!(O.words[0]&z)&&H<26;++H,z<<=1);if(H>0)for(O.iushrn(H);H-- >0;)(x.isOdd()||w.isOdd())&&(x.iadd(U),w.isub(A)),x.iushrn(1),w.iushrn(1);for(var K=0,j=1;!(E.words[0]&j)&&K<26;++K,j<<=1);if(K>0)for(E.iushrn(K);K-- >0;)(_.isOdd()||S.isOdd())&&(_.iadd(U),S.isub(A)),_.iushrn(1),S.iushrn(1);O.cmp(E)>=0?(O.isub(E),x.isub(_),w.isub(S)):(E.isub(O),_.isub(x),S.isub(w))}return{a:_,b:S,gcd:E.iushln(T)}},c.prototype._invmp=function(C){o(C.negative===0),o(!C.isZero());var O=this,E=C.clone();O=O.negative!==0?O.umod(C):O.clone();for(var x,w=new c(1),_=new c(0),S=E.clone();O.cmpn(1)>0&&E.cmpn(1)>0;){for(var T=0,U=1;!(O.words[0]&U)&&T<26;++T,U<<=1);if(T>0)for(O.iushrn(T);T-- >0;)w.isOdd()&&w.iadd(S),w.iushrn(1);for(var A=0,H=1;!(E.words[0]&H)&&A<26;++A,H<<=1);if(A>0)for(E.iushrn(A);A-- >0;)_.isOdd()&&_.iadd(S),_.iushrn(1);O.cmp(E)>=0?(O.isub(E),w.isub(_)):(E.isub(O),_.isub(w))}return(x=O.cmpn(1)===0?w:_).cmpn(0)<0&&x.iadd(C),x},c.prototype.gcd=function(C){if(this.isZero())return C.abs();if(C.isZero())return this.abs();var O=this.clone(),E=C.clone();O.negative=0,E.negative=0;for(var x=0;O.isEven()&&E.isEven();x++)O.iushrn(1),E.iushrn(1);for(;;){for(;O.isEven();)O.iushrn(1);for(;E.isEven();)E.iushrn(1);var w=O.cmp(E);if(w<0){var _=O;O=E,E=_}else if(w===0||E.cmpn(1)===0)break;O.isub(E)}return E.iushln(x)},c.prototype.invm=function(C){return this.egcd(C).a.umod(C)},c.prototype.isEven=function(){return(1&this.words[0])==0},c.prototype.isOdd=function(){return(1&this.words[0])==1},c.prototype.andln=function(C){return this.words[0]&C},c.prototype.bincn=function(C){o(typeof C=="number");var O=C%26,E=(C-O)/26,x=1<<O;if(this.length<=E)return this._expand(E+1),this.words[E]|=x,this;for(var w=x,_=E;w!==0&&_<this.length;_++){var S=0|this.words[_];w=(S+=w)>>>26,S&=67108863,this.words[_]=S}return w!==0&&(this.words[_]=w,this.length++),this},c.prototype.isZero=function(){return this.length===1&&this.words[0]===0},c.prototype.cmpn=function(C){var O,E=C<0;if(this.negative!==0&&!E)return-1;if(this.negative===0&&E)return 1;if(this.strip(),this.length>1)O=1;else{E&&(C=-C),o(C<=67108863,"Number is too big");var x=0|this.words[0];O=x===C?0:x<C?-1:1}return this.negative!==0?0|-O:O},c.prototype.cmp=function(C){if(this.negative!==0&&C.negative===0)return-1;if(this.negative===0&&C.negative!==0)return 1;var O=this.ucmp(C);return this.negative!==0?0|-O:O},c.prototype.ucmp=function(C){if(this.length>C.length)return 1;if(this.length<C.length)return-1;for(var O=0,E=this.length-1;E>=0;E--){var x=0|this.words[E],w=0|C.words[E];if(x!==w){x<w?O=-1:x>w&&(O=1);break}}return O},c.prototype.gtn=function(C){return this.cmpn(C)===1},c.prototype.gt=function(C){return this.cmp(C)===1},c.prototype.gten=function(C){return this.cmpn(C)>=0},c.prototype.gte=function(C){return this.cmp(C)>=0},c.prototype.ltn=function(C){return this.cmpn(C)===-1},c.prototype.lt=function(C){return this.cmp(C)===-1},c.prototype.lten=function(C){return this.cmpn(C)<=0},c.prototype.lte=function(C){return this.cmp(C)<=0},c.prototype.eqn=function(C){return this.cmpn(C)===0},c.prototype.eq=function(C){return this.cmp(C)===0},c.red=function(C){return new V(C)},c.prototype.toRed=function(C){return o(!this.red,"Already a number in reduction context"),o(this.negative===0,"red works only with positives"),C.convertTo(this)._forceRed(C)},c.prototype.fromRed=function(){return o(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},c.prototype._forceRed=function(C){return this.red=C,this},c.prototype.forceRed=function(C){return o(!this.red,"Already a number in reduction context"),this._forceRed(C)},c.prototype.redAdd=function(C){return o(this.red,"redAdd works only with red numbers"),this.red.add(this,C)},c.prototype.redIAdd=function(C){return o(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,C)},c.prototype.redSub=function(C){return o(this.red,"redSub works only with red numbers"),this.red.sub(this,C)},c.prototype.redISub=function(C){return o(this.red,"redISub works only with red numbers"),this.red.isub(this,C)},c.prototype.redShl=function(C){return o(this.red,"redShl works only with red numbers"),this.red.shl(this,C)},c.prototype.redMul=function(C){return o(this.red,"redMul works only with red numbers"),this.red._verify2(this,C),this.red.mul(this,C)},c.prototype.redIMul=function(C){return o(this.red,"redMul works only with red numbers"),this.red._verify2(this,C),this.red.imul(this,C)},c.prototype.redSqr=function(){return o(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},c.prototype.redISqr=function(){return o(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},c.prototype.redSqrt=function(){return o(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},c.prototype.redInvm=function(){return o(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},c.prototype.redNeg=function(){return o(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},c.prototype.redPow=function(C){return o(this.red&&!C.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,C)};var N={k256:null,p224:null,p192:null,p25519:null};function L(C,O){this.name=C,this.p=new c(O,16),this.n=this.p.bitLength(),this.k=new c(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function F(){L.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function R(){L.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function B(){L.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function q(){L.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function V(C){if(typeof C=="string"){var O=c._prime(C);this.m=O.p,this.prime=O}else o(C.gtn(1),"modulus must be greater than 1"),this.m=C,this.prime=null}function I(C){V.call(this,C),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new c(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}L.prototype._tmp=function(){var C=new c(null);return C.words=new Array(Math.ceil(this.n/13)),C},L.prototype.ireduce=function(C){var O,E=C;do this.split(E,this.tmp),O=(E=(E=this.imulK(E)).iadd(this.tmp)).bitLength();while(O>this.n);var x=O<this.n?-1:E.ucmp(this.p);return x===0?(E.words[0]=0,E.length=1):x>0?E.isub(this.p):E.strip!==void 0?E.strip():E._strip(),E},L.prototype.split=function(C,O){C.iushrn(this.n,0,O)},L.prototype.imulK=function(C){return C.imul(this.k)},l(F,L),F.prototype.split=function(C,O){for(var E=Math.min(C.length,9),x=0;x<E;x++)O.words[x]=C.words[x];if(O.length=E,C.length<=9)return C.words[0]=0,void(C.length=1);var w=C.words[9];for(O.words[O.length++]=4194303&w,x=10;x<C.length;x++){var _=0|C.words[x];C.words[x-10]=(4194303&_)<<4|w>>>22,w=_}w>>>=22,C.words[x-10]=w,w===0&&C.length>10?C.length-=10:C.length-=9},F.prototype.imulK=function(C){C.words[C.length]=0,C.words[C.length+1]=0,C.length+=2;for(var O=0,E=0;E<C.length;E++){var x=0|C.words[E];O+=977*x,C.words[E]=67108863&O,O=64*x+(O/67108864|0)}return C.words[C.length-1]===0&&(C.length--,C.words[C.length-1]===0&&C.length--),C},l(R,L),l(B,L),l(q,L),q.prototype.imulK=function(C){for(var O=0,E=0;E<C.length;E++){var x=19*(0|C.words[E])+O,w=67108863&x;x>>>=26,C.words[E]=w,O=x}return O!==0&&(C.words[C.length++]=O),C},c._prime=function(C){if(N[C])return N[C];var O;if(C==="k256")O=new F;else if(C==="p224")O=new R;else if(C==="p192")O=new B;else{if(C!=="p25519")throw new Error("Unknown prime "+C);O=new q}return N[C]=O,O},V.prototype._verify1=function(C){o(C.negative===0,"red works only with positives"),o(C.red,"red works only with red numbers")},V.prototype._verify2=function(C,O){o((C.negative|O.negative)==0,"red works only with positives"),o(C.red&&C.red===O.red,"red works only with red numbers")},V.prototype.imod=function(C){return this.prime?this.prime.ireduce(C)._forceRed(this):C.umod(this.m)._forceRed(this)},V.prototype.neg=function(C){return C.isZero()?C.clone():this.m.sub(C)._forceRed(this)},V.prototype.add=function(C,O){this._verify2(C,O);var E=C.add(O);return E.cmp(this.m)>=0&&E.isub(this.m),E._forceRed(this)},V.prototype.iadd=function(C,O){this._verify2(C,O);var E=C.iadd(O);return E.cmp(this.m)>=0&&E.isub(this.m),E},V.prototype.sub=function(C,O){this._verify2(C,O);var E=C.sub(O);return E.cmpn(0)<0&&E.iadd(this.m),E._forceRed(this)},V.prototype.isub=function(C,O){this._verify2(C,O);var E=C.isub(O);return E.cmpn(0)<0&&E.iadd(this.m),E},V.prototype.shl=function(C,O){return this._verify1(C),this.imod(C.ushln(O))},V.prototype.imul=function(C,O){return this._verify2(C,O),this.imod(C.imul(O))},V.prototype.mul=function(C,O){return this._verify2(C,O),this.imod(C.mul(O))},V.prototype.isqr=function(C){return this.imul(C,C.clone())},V.prototype.sqr=function(C){return this.mul(C,C)},V.prototype.sqrt=function(C){if(C.isZero())return C.clone();var O=this.m.andln(3);if(o(O%2==1),O===3){var E=this.m.add(new c(1)).iushrn(2);return this.pow(C,E)}for(var x=this.m.subn(1),w=0;!x.isZero()&&x.andln(1)===0;)w++,x.iushrn(1);o(!x.isZero());var _=new c(1).toRed(this),S=_.redNeg(),T=this.m.subn(1).iushrn(1),U=this.m.bitLength();for(U=new c(2*U*U).toRed(this);this.pow(U,T).cmp(S)!==0;)U.redIAdd(S);for(var A=this.pow(U,x),H=this.pow(C,x.addn(1).iushrn(1)),z=this.pow(C,x),K=w;z.cmp(_)!==0;){for(var j=z,J=0;j.cmp(_)!==0;J++)j=j.redSqr();o(J<K);var P=this.pow(A,new c(1).iushln(K-J-1));H=H.redMul(P),A=P.redSqr(),z=z.redMul(A),K=J}return H},V.prototype.invm=function(C){var O=C._invmp(this.m);return O.negative!==0?(O.negative=0,this.imod(O).redNeg()):this.imod(O)},V.prototype.pow=function(C,O){if(O.isZero())return new c(1).toRed(this);if(O.cmpn(1)===0)return C.clone();var E=new Array(16);E[0]=new c(1).toRed(this),E[1]=C;for(var x=2;x<E.length;x++)E[x]=this.mul(E[x-1],C);var w=E[0],_=0,S=0,T=O.bitLength()%26;for(T===0&&(T=26),x=O.length-1;x>=0;x--){for(var U=O.words[x],A=T-1;A>=0;A--){var H=U>>A&1;w!==E[0]&&(w=this.sqr(w)),H!==0||_!==0?(_<<=1,_|=H,(++S===4||x===0&&A===0)&&(w=this.mul(w,E[_]),S=0,_=0)):S=0}T=26}return w},V.prototype.convertTo=function(C){var O=C.umod(this.m);return O===C?O.clone():O},V.prototype.convertFrom=function(C){var O=C.clone();return O.red=null,O},c.mont=function(C){return new I(C)},l(I,V),I.prototype.convertTo=function(C){return this.imod(C.ushln(this.shift))},I.prototype.convertFrom=function(C){var O=this.imod(C.mul(this.rinv));return O.red=null,O},I.prototype.imul=function(C,O){if(C.isZero()||O.isZero())return C.words[0]=0,C.length=1,C;var E=C.imul(O),x=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),w=E.isub(x).iushrn(this.shift),_=w;return w.cmp(this.m)>=0?_=w.isub(this.m):w.cmpn(0)<0&&(_=w.iadd(this.m)),_._forceRed(this)},I.prototype.mul=function(C,O){if(C.isZero()||O.isZero())return new c(0)._forceRed(this);var E=C.mul(O),x=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),w=E.isub(x).iushrn(this.shift),_=w;return w.cmp(this.m)>=0?_=w.isub(this.m):w.cmpn(0)<0&&(_=w.iadd(this.m)),_._forceRed(this)},I.prototype.invm=function(C){return this.imod(C._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],185:[function(e,n,s){s.byteLength=function(f){var g=d(f),m=g[0],p=g[1];return 3*(m+p)/4-p},s.toByteArray=function(f){var g,m,p=d(f),v=p[0],b=p[1],y=new o(function(L,F,R){return 3*(F+R)/4-R}(0,v,b)),k=0,N=b>0?v-4:v;for(m=0;m<N;m+=4)g=i[f.charCodeAt(m)]<<18|i[f.charCodeAt(m+1)]<<12|i[f.charCodeAt(m+2)]<<6|i[f.charCodeAt(m+3)],y[k++]=g>>16&255,y[k++]=g>>8&255,y[k++]=255&g;return b===2&&(g=i[f.charCodeAt(m)]<<2|i[f.charCodeAt(m+1)]>>4,y[k++]=255&g),b===1&&(g=i[f.charCodeAt(m)]<<10|i[f.charCodeAt(m+1)]<<4|i[f.charCodeAt(m+2)]>>2,y[k++]=g>>8&255,y[k++]=255&g),y},s.fromByteArray=function(f){for(var g,m=f.length,p=m%3,v=[],b=0,y=m-p;b<y;b+=16383)v.push(h(f,b,b+16383>y?y:b+16383));return p===1?(g=f[m-1],v.push(a[g>>2]+a[g<<4&63]+"==")):p===2&&(g=(f[m-2]<<8)+f[m-1],v.push(a[g>>10]+a[g>>4&63]+a[g<<2&63]+"=")),v.join("")};for(var a=[],i=[],o=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,u=l.length;c<u;++c)a[c]=l[c],i[l.charCodeAt(c)]=c;function d(f){var g=f.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var m=f.indexOf("=");return m===-1&&(m=g),[m,m===g?0:4-m%4]}function h(f,g,m){for(var p,v,b=[],y=g;y<m;y+=3)p=(f[y]<<16&16711680)+(f[y+1]<<8&65280)+(255&f[y+2]),b.push(a[(v=p)>>18&63]+a[v>>12&63]+a[v>>6&63]+a[63&v]);return b.join("")}i[45]=62,i[95]=63},{}],186:[function(e,n,s){(function(a,i){function o(E,x){if(!E)throw new Error(x||"Assertion failed")}function l(E,x){E.super_=x;var w=function(){};w.prototype=x.prototype,E.prototype=new w,E.prototype.constructor=E}function c(E,x,w){if(c.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&(x!=="le"&&x!=="be"||(w=x,x=10),this._init(E||0,x||10,w||"be"))}var u;typeof a=="object"?a.exports=c:(void 0).BN=c,c.BN=c,c.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch{}function d(E,x){var w=E.charCodeAt(x);return w>=48&&w<=57?w-48:w>=65&&w<=70?w-55:w>=97&&w<=102?w-87:void o(!1,"Invalid character in "+E)}function h(E,x,w){var _=d(E,w);return w-1>=x&&(_|=d(E,w-1)<<4),_}function f(E,x,w,_){for(var S=0,T=0,U=Math.min(E.length,w),A=x;A<U;A++){var H=E.charCodeAt(A)-48;S*=_,T=H>=49?H-49+10:H>=17?H-17+10:H,o(H>=0&&T<_,"Invalid character"),S+=T}return S}function g(E,x){E.words=x.words,E.length=x.length,E.negative=x.negative,E.red=x.red}if(c.isBN=function(E){return E instanceof c||E!==null&&typeof E=="object"&&E.constructor.wordSize===c.wordSize&&Array.isArray(E.words)},c.max=function(E,x){return E.cmp(x)>0?E:x},c.min=function(E,x){return E.cmp(x)<0?E:x},c.prototype._init=function(E,x,w){if(typeof E=="number")return this._initNumber(E,x,w);if(typeof E=="object")return this._initArray(E,x,w);x==="hex"&&(x=16),o(x===(0|x)&&x>=2&&x<=36);var _=0;(E=E.toString().replace(/\s+/g,""))[0]==="-"&&(_++,this.negative=1),_<E.length&&(x===16?this._parseHex(E,_,w):(this._parseBase(E,x,_),w==="le"&&this._initArray(this.toArray(),x,w)))},c.prototype._initNumber=function(E,x,w){E<0&&(this.negative=1,E=-E),E<67108864?(this.words=[67108863&E],this.length=1):E<4503599627370496?(this.words=[67108863&E,E/67108864&67108863],this.length=2):(o(E<9007199254740992),this.words=[67108863&E,E/67108864&67108863,1],this.length=3),w==="le"&&this._initArray(this.toArray(),x,w)},c.prototype._initArray=function(E,x,w){if(o(typeof E.length=="number"),E.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(E.length/3),this.words=new Array(this.length);for(var _=0;_<this.length;_++)this.words[_]=0;var S,T,U=0;if(w==="be")for(_=E.length-1,S=0;_>=0;_-=3)T=E[_]|E[_-1]<<8|E[_-2]<<16,this.words[S]|=T<<U&67108863,this.words[S+1]=T>>>26-U&67108863,(U+=24)>=26&&(U-=26,S++);else if(w==="le")for(_=0,S=0;_<E.length;_+=3)T=E[_]|E[_+1]<<8|E[_+2]<<16,this.words[S]|=T<<U&67108863,this.words[S+1]=T>>>26-U&67108863,(U+=24)>=26&&(U-=26,S++);return this._strip()},c.prototype._parseHex=function(E,x,w){this.length=Math.ceil((E.length-x)/6),this.words=new Array(this.length);for(var _=0;_<this.length;_++)this.words[_]=0;var S,T=0,U=0;if(w==="be")for(_=E.length-1;_>=x;_-=2)S=h(E,x,_)<<T,this.words[U]|=67108863&S,T>=18?(T-=18,U+=1,this.words[U]|=S>>>26):T+=8;else for(_=(E.length-x)%2==0?x+1:x;_<E.length;_+=2)S=h(E,x,_)<<T,this.words[U]|=67108863&S,T>=18?(T-=18,U+=1,this.words[U]|=S>>>26):T+=8;this._strip()},c.prototype._parseBase=function(E,x,w){this.words=[0],this.length=1;for(var _=0,S=1;S<=67108863;S*=x)_++;_--,S=S/x|0;for(var T=E.length-w,U=T%_,A=Math.min(T,T-U)+w,H=0,z=w;z<A;z+=_)H=f(E,z,z+_,x),this.imuln(S),this.words[0]+H<67108864?this.words[0]+=H:this._iaddn(H);if(U!==0){var K=1;for(H=f(E,z,E.length,x),z=0;z<U;z++)K*=x;this.imuln(K),this.words[0]+H<67108864?this.words[0]+=H:this._iaddn(H)}this._strip()},c.prototype.copy=function(E){E.words=new Array(this.length);for(var x=0;x<this.length;x++)E.words[x]=this.words[x];E.length=this.length,E.negative=this.negative,E.red=this.red},c.prototype._move=function(E){g(E,this)},c.prototype.clone=function(){var E=new c(null);return this.copy(E),E},c.prototype._expand=function(E){for(;this.length<E;)this.words[this.length++]=0;return this},c.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},c.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{c.prototype[Symbol.for("nodejs.util.inspect.custom")]=m}catch{c.prototype.inspect=m}else c.prototype.inspect=m;function m(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],b=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];c.prototype.toString=function(E,x){var w;if(x=0|x||1,(E=E||10)===16||E==="hex"){w="";for(var _=0,S=0,T=0;T<this.length;T++){var U=this.words[T],A=(16777215&(U<<_|S)).toString(16);S=U>>>24-_&16777215,(_+=2)>=26&&(_-=26,T--),w=S!==0||T!==this.length-1?p[6-A.length]+A+w:A+w}for(S!==0&&(w=S.toString(16)+w);w.length%x!=0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}if(E===(0|E)&&E>=2&&E<=36){var H=v[E],z=b[E];w="";var K=this.clone();for(K.negative=0;!K.isZero();){var j=K.modrn(z).toString(E);w=(K=K.idivn(z)).isZero()?j+w:p[H-j.length]+j+w}for(this.isZero()&&(w="0"+w);w.length%x!=0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}o(!1,"Base should be between 2 and 36")},c.prototype.toNumber=function(){var E=this.words[0];return this.length===2?E+=67108864*this.words[1]:this.length===3&&this.words[2]===1?E+=4503599627370496+67108864*this.words[1]:this.length>2&&o(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-E:E},c.prototype.toJSON=function(){return this.toString(16,2)},u&&(c.prototype.toBuffer=function(E,x){return this.toArrayLike(u,E,x)}),c.prototype.toArray=function(E,x){return this.toArrayLike(Array,E,x)};function y(E,x,w){w.negative=x.negative^E.negative;var _=E.length+x.length|0;w.length=_,_=_-1|0;var S=0|E.words[0],T=0|x.words[0],U=S*T,A=67108863&U,H=U/67108864|0;w.words[0]=A;for(var z=1;z<_;z++){for(var K=H>>>26,j=67108863&H,J=Math.min(z,x.length-1),P=Math.max(0,z-E.length+1);P<=J;P++){var D=z-P|0;K+=(U=(S=0|E.words[D])*(T=0|x.words[P])+j)/67108864|0,j=67108863&U}w.words[z]=0|j,H=0|K}return H!==0?w.words[z]=0|H:w.length--,w._strip()}c.prototype.toArrayLike=function(E,x,w){this._strip();var _=this.byteLength(),S=w||Math.max(1,_);o(_<=S,"byte array longer than desired length"),o(S>0,"Requested array length <= 0");var T=function(U,A){return U.allocUnsafe?U.allocUnsafe(A):new U(A)}(E,S);return this["_toArrayLike"+(x==="le"?"LE":"BE")](T,_),T},c.prototype._toArrayLikeLE=function(E,x){for(var w=0,_=0,S=0,T=0;S<this.length;S++){var U=this.words[S]<<T|_;E[w++]=255&U,w<E.length&&(E[w++]=U>>8&255),w<E.length&&(E[w++]=U>>16&255),T===6?(w<E.length&&(E[w++]=U>>24&255),_=0,T=0):(_=U>>>24,T+=2)}if(w<E.length)for(E[w++]=_;w<E.length;)E[w++]=0},c.prototype._toArrayLikeBE=function(E,x){for(var w=E.length-1,_=0,S=0,T=0;S<this.length;S++){var U=this.words[S]<<T|_;E[w--]=255&U,w>=0&&(E[w--]=U>>8&255),w>=0&&(E[w--]=U>>16&255),T===6?(w>=0&&(E[w--]=U>>24&255),_=0,T=0):(_=U>>>24,T+=2)}if(w>=0)for(E[w--]=_;w>=0;)E[w--]=0},Math.clz32?c.prototype._countBits=function(E){return 32-Math.clz32(E)}:c.prototype._countBits=function(E){var x=E,w=0;return x>=4096&&(w+=13,x>>>=13),x>=64&&(w+=7,x>>>=7),x>=8&&(w+=4,x>>>=4),x>=2&&(w+=2,x>>>=2),w+x},c.prototype._zeroBits=function(E){if(E===0)return 26;var x=E,w=0;return!(8191&x)&&(w+=13,x>>>=13),!(127&x)&&(w+=7,x>>>=7),!(15&x)&&(w+=4,x>>>=4),!(3&x)&&(w+=2,x>>>=2),!(1&x)&&w++,w},c.prototype.bitLength=function(){var E=this.words[this.length-1],x=this._countBits(E);return 26*(this.length-1)+x},c.prototype.zeroBits=function(){if(this.isZero())return 0;for(var E=0,x=0;x<this.length;x++){var w=this._zeroBits(this.words[x]);if(E+=w,w!==26)break}return E},c.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},c.prototype.toTwos=function(E){return this.negative!==0?this.abs().inotn(E).iaddn(1):this.clone()},c.prototype.fromTwos=function(E){return this.testn(E-1)?this.notn(E).iaddn(1).ineg():this.clone()},c.prototype.isNeg=function(){return this.negative!==0},c.prototype.neg=function(){return this.clone().ineg()},c.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},c.prototype.iuor=function(E){for(;this.length<E.length;)this.words[this.length++]=0;for(var x=0;x<E.length;x++)this.words[x]=this.words[x]|E.words[x];return this._strip()},c.prototype.ior=function(E){return o((this.negative|E.negative)==0),this.iuor(E)},c.prototype.or=function(E){return this.length>E.length?this.clone().ior(E):E.clone().ior(this)},c.prototype.uor=function(E){return this.length>E.length?this.clone().iuor(E):E.clone().iuor(this)},c.prototype.iuand=function(E){var x;x=this.length>E.length?E:this;for(var w=0;w<x.length;w++)this.words[w]=this.words[w]&E.words[w];return this.length=x.length,this._strip()},c.prototype.iand=function(E){return o((this.negative|E.negative)==0),this.iuand(E)},c.prototype.and=function(E){return this.length>E.length?this.clone().iand(E):E.clone().iand(this)},c.prototype.uand=function(E){return this.length>E.length?this.clone().iuand(E):E.clone().iuand(this)},c.prototype.iuxor=function(E){var x,w;this.length>E.length?(x=this,w=E):(x=E,w=this);for(var _=0;_<w.length;_++)this.words[_]=x.words[_]^w.words[_];if(this!==x)for(;_<x.length;_++)this.words[_]=x.words[_];return this.length=x.length,this._strip()},c.prototype.ixor=function(E){return o((this.negative|E.negative)==0),this.iuxor(E)},c.prototype.xor=function(E){return this.length>E.length?this.clone().ixor(E):E.clone().ixor(this)},c.prototype.uxor=function(E){return this.length>E.length?this.clone().iuxor(E):E.clone().iuxor(this)},c.prototype.inotn=function(E){o(typeof E=="number"&&E>=0);var x=0|Math.ceil(E/26),w=E%26;this._expand(x),w>0&&x--;for(var _=0;_<x;_++)this.words[_]=67108863&~this.words[_];return w>0&&(this.words[_]=~this.words[_]&67108863>>26-w),this._strip()},c.prototype.notn=function(E){return this.clone().inotn(E)},c.prototype.setn=function(E,x){o(typeof E=="number"&&E>=0);var w=E/26|0,_=E%26;return this._expand(w+1),this.words[w]=x?this.words[w]|1<<_:this.words[w]&~(1<<_),this._strip()},c.prototype.iadd=function(E){var x,w,_;if(this.negative!==0&&E.negative===0)return this.negative=0,x=this.isub(E),this.negative^=1,this._normSign();if(this.negative===0&&E.negative!==0)return E.negative=0,x=this.isub(E),E.negative=1,x._normSign();this.length>E.length?(w=this,_=E):(w=E,_=this);for(var S=0,T=0;T<_.length;T++)x=(0|w.words[T])+(0|_.words[T])+S,this.words[T]=67108863&x,S=x>>>26;for(;S!==0&&T<w.length;T++)x=(0|w.words[T])+S,this.words[T]=67108863&x,S=x>>>26;if(this.length=w.length,S!==0)this.words[this.length]=S,this.length++;else if(w!==this)for(;T<w.length;T++)this.words[T]=w.words[T];return this},c.prototype.add=function(E){var x;return E.negative!==0&&this.negative===0?(E.negative=0,x=this.sub(E),E.negative^=1,x):E.negative===0&&this.negative!==0?(this.negative=0,x=E.sub(this),this.negative=1,x):this.length>E.length?this.clone().iadd(E):E.clone().iadd(this)},c.prototype.isub=function(E){if(E.negative!==0){E.negative=0;var x=this.iadd(E);return E.negative=1,x._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(E),this.negative=1,this._normSign();var w,_,S=this.cmp(E);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;S>0?(w=this,_=E):(w=E,_=this);for(var T=0,U=0;U<_.length;U++)T=(x=(0|w.words[U])-(0|_.words[U])+T)>>26,this.words[U]=67108863&x;for(;T!==0&&U<w.length;U++)T=(x=(0|w.words[U])+T)>>26,this.words[U]=67108863&x;if(T===0&&U<w.length&&w!==this)for(;U<w.length;U++)this.words[U]=w.words[U];return this.length=Math.max(this.length,U),w!==this&&(this.negative=1),this._strip()},c.prototype.sub=function(E){return this.clone().isub(E)};var k=function(E,x,w){var _,S,T,U=E.words,A=x.words,H=w.words,z=0,K=0|U[0],j=8191&K,J=K>>>13,P=0|U[1],D=8191&P,G=P>>>13,re=0|U[2],te=8191&re,ne=re>>>13,le=0|U[3],oe=8191&le,ee=le>>>13,Z=0|U[4],se=8191&Z,ie=Z>>>13,ue=0|U[5],pe=8191&ue,fe=ue>>>13,ye=0|U[6],Te=8191&ye,Pe=ye>>>13,je=0|U[7],qe=8191&je,We=je>>>13,at=0|U[8],Ye=8191&at,rt=at>>>13,ht=0|U[9],Ce=8191&ht,Ie=ht>>>13,Ve=0|A[0],De=8191&Ve,Oe=Ve>>>13,Xe=0|A[1],nt=8191&Xe,Je=Xe>>>13,wt=0|A[2],gt=8191&wt,dt=wt>>>13,ct=0|A[3],ut=8191&ct,ft=ct>>>13,Et=0|A[4],jt=8191&Et,Ot=Et>>>13,yt=0|A[5],Vt=8191&yt,$t=yt>>>13,Fe=0|A[6],Be=8191&Fe,tt=Fe>>>13,ce=0|A[7],ke=8191&ce,me=ce>>>13,xe=0|A[8],_e=8191&xe,Ee=xe>>>13,Le=0|A[9],Ke=8191&Le,Ue=Le>>>13;w.negative=E.negative^x.negative,w.length=19;var Qe=(z+(_=Math.imul(j,De))|0)+((8191&(S=(S=Math.imul(j,Oe))+Math.imul(J,De)|0))<<13)|0;z=((T=Math.imul(J,Oe))+(S>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,_=Math.imul(D,De),S=(S=Math.imul(D,Oe))+Math.imul(G,De)|0,T=Math.imul(G,Oe);var et=(z+(_=_+Math.imul(j,nt)|0)|0)+((8191&(S=(S=S+Math.imul(j,Je)|0)+Math.imul(J,nt)|0))<<13)|0;z=((T=T+Math.imul(J,Je)|0)+(S>>>13)|0)+(et>>>26)|0,et&=67108863,_=Math.imul(te,De),S=(S=Math.imul(te,Oe))+Math.imul(ne,De)|0,T=Math.imul(ne,Oe),_=_+Math.imul(D,nt)|0,S=(S=S+Math.imul(D,Je)|0)+Math.imul(G,nt)|0,T=T+Math.imul(G,Je)|0;var bt=(z+(_=_+Math.imul(j,gt)|0)|0)+((8191&(S=(S=S+Math.imul(j,dt)|0)+Math.imul(J,gt)|0))<<13)|0;z=((T=T+Math.imul(J,dt)|0)+(S>>>13)|0)+(bt>>>26)|0,bt&=67108863,_=Math.imul(oe,De),S=(S=Math.imul(oe,Oe))+Math.imul(ee,De)|0,T=Math.imul(ee,Oe),_=_+Math.imul(te,nt)|0,S=(S=S+Math.imul(te,Je)|0)+Math.imul(ne,nt)|0,T=T+Math.imul(ne,Je)|0,_=_+Math.imul(D,gt)|0,S=(S=S+Math.imul(D,dt)|0)+Math.imul(G,gt)|0,T=T+Math.imul(G,dt)|0;var Ct=(z+(_=_+Math.imul(j,ut)|0)|0)+((8191&(S=(S=S+Math.imul(j,ft)|0)+Math.imul(J,ut)|0))<<13)|0;z=((T=T+Math.imul(J,ft)|0)+(S>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,_=Math.imul(se,De),S=(S=Math.imul(se,Oe))+Math.imul(ie,De)|0,T=Math.imul(ie,Oe),_=_+Math.imul(oe,nt)|0,S=(S=S+Math.imul(oe,Je)|0)+Math.imul(ee,nt)|0,T=T+Math.imul(ee,Je)|0,_=_+Math.imul(te,gt)|0,S=(S=S+Math.imul(te,dt)|0)+Math.imul(ne,gt)|0,T=T+Math.imul(ne,dt)|0,_=_+Math.imul(D,ut)|0,S=(S=S+Math.imul(D,ft)|0)+Math.imul(G,ut)|0,T=T+Math.imul(G,ft)|0;var Pt=(z+(_=_+Math.imul(j,jt)|0)|0)+((8191&(S=(S=S+Math.imul(j,Ot)|0)+Math.imul(J,jt)|0))<<13)|0;z=((T=T+Math.imul(J,Ot)|0)+(S>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,_=Math.imul(pe,De),S=(S=Math.imul(pe,Oe))+Math.imul(fe,De)|0,T=Math.imul(fe,Oe),_=_+Math.imul(se,nt)|0,S=(S=S+Math.imul(se,Je)|0)+Math.imul(ie,nt)|0,T=T+Math.imul(ie,Je)|0,_=_+Math.imul(oe,gt)|0,S=(S=S+Math.imul(oe,dt)|0)+Math.imul(ee,gt)|0,T=T+Math.imul(ee,dt)|0,_=_+Math.imul(te,ut)|0,S=(S=S+Math.imul(te,ft)|0)+Math.imul(ne,ut)|0,T=T+Math.imul(ne,ft)|0,_=_+Math.imul(D,jt)|0,S=(S=S+Math.imul(D,Ot)|0)+Math.imul(G,jt)|0,T=T+Math.imul(G,Ot)|0;var be=(z+(_=_+Math.imul(j,Vt)|0)|0)+((8191&(S=(S=S+Math.imul(j,$t)|0)+Math.imul(J,Vt)|0))<<13)|0;z=((T=T+Math.imul(J,$t)|0)+(S>>>13)|0)+(be>>>26)|0,be&=67108863,_=Math.imul(Te,De),S=(S=Math.imul(Te,Oe))+Math.imul(Pe,De)|0,T=Math.imul(Pe,Oe),_=_+Math.imul(pe,nt)|0,S=(S=S+Math.imul(pe,Je)|0)+Math.imul(fe,nt)|0,T=T+Math.imul(fe,Je)|0,_=_+Math.imul(se,gt)|0,S=(S=S+Math.imul(se,dt)|0)+Math.imul(ie,gt)|0,T=T+Math.imul(ie,dt)|0,_=_+Math.imul(oe,ut)|0,S=(S=S+Math.imul(oe,ft)|0)+Math.imul(ee,ut)|0,T=T+Math.imul(ee,ft)|0,_=_+Math.imul(te,jt)|0,S=(S=S+Math.imul(te,Ot)|0)+Math.imul(ne,jt)|0,T=T+Math.imul(ne,Ot)|0,_=_+Math.imul(D,Vt)|0,S=(S=S+Math.imul(D,$t)|0)+Math.imul(G,Vt)|0,T=T+Math.imul(G,$t)|0;var Me=(z+(_=_+Math.imul(j,Be)|0)|0)+((8191&(S=(S=S+Math.imul(j,tt)|0)+Math.imul(J,Be)|0))<<13)|0;z=((T=T+Math.imul(J,tt)|0)+(S>>>13)|0)+(Me>>>26)|0,Me&=67108863,_=Math.imul(qe,De),S=(S=Math.imul(qe,Oe))+Math.imul(We,De)|0,T=Math.imul(We,Oe),_=_+Math.imul(Te,nt)|0,S=(S=S+Math.imul(Te,Je)|0)+Math.imul(Pe,nt)|0,T=T+Math.imul(Pe,Je)|0,_=_+Math.imul(pe,gt)|0,S=(S=S+Math.imul(pe,dt)|0)+Math.imul(fe,gt)|0,T=T+Math.imul(fe,dt)|0,_=_+Math.imul(se,ut)|0,S=(S=S+Math.imul(se,ft)|0)+Math.imul(ie,ut)|0,T=T+Math.imul(ie,ft)|0,_=_+Math.imul(oe,jt)|0,S=(S=S+Math.imul(oe,Ot)|0)+Math.imul(ee,jt)|0,T=T+Math.imul(ee,Ot)|0,_=_+Math.imul(te,Vt)|0,S=(S=S+Math.imul(te,$t)|0)+Math.imul(ne,Vt)|0,T=T+Math.imul(ne,$t)|0,_=_+Math.imul(D,Be)|0,S=(S=S+Math.imul(D,tt)|0)+Math.imul(G,Be)|0,T=T+Math.imul(G,tt)|0;var it=(z+(_=_+Math.imul(j,ke)|0)|0)+((8191&(S=(S=S+Math.imul(j,me)|0)+Math.imul(J,ke)|0))<<13)|0;z=((T=T+Math.imul(J,me)|0)+(S>>>13)|0)+(it>>>26)|0,it&=67108863,_=Math.imul(Ye,De),S=(S=Math.imul(Ye,Oe))+Math.imul(rt,De)|0,T=Math.imul(rt,Oe),_=_+Math.imul(qe,nt)|0,S=(S=S+Math.imul(qe,Je)|0)+Math.imul(We,nt)|0,T=T+Math.imul(We,Je)|0,_=_+Math.imul(Te,gt)|0,S=(S=S+Math.imul(Te,dt)|0)+Math.imul(Pe,gt)|0,T=T+Math.imul(Pe,dt)|0,_=_+Math.imul(pe,ut)|0,S=(S=S+Math.imul(pe,ft)|0)+Math.imul(fe,ut)|0,T=T+Math.imul(fe,ft)|0,_=_+Math.imul(se,jt)|0,S=(S=S+Math.imul(se,Ot)|0)+Math.imul(ie,jt)|0,T=T+Math.imul(ie,Ot)|0,_=_+Math.imul(oe,Vt)|0,S=(S=S+Math.imul(oe,$t)|0)+Math.imul(ee,Vt)|0,T=T+Math.imul(ee,$t)|0,_=_+Math.imul(te,Be)|0,S=(S=S+Math.imul(te,tt)|0)+Math.imul(ne,Be)|0,T=T+Math.imul(ne,tt)|0,_=_+Math.imul(D,ke)|0,S=(S=S+Math.imul(D,me)|0)+Math.imul(G,ke)|0,T=T+Math.imul(G,me)|0;var mt=(z+(_=_+Math.imul(j,_e)|0)|0)+((8191&(S=(S=S+Math.imul(j,Ee)|0)+Math.imul(J,_e)|0))<<13)|0;z=((T=T+Math.imul(J,Ee)|0)+(S>>>13)|0)+(mt>>>26)|0,mt&=67108863,_=Math.imul(Ce,De),S=(S=Math.imul(Ce,Oe))+Math.imul(Ie,De)|0,T=Math.imul(Ie,Oe),_=_+Math.imul(Ye,nt)|0,S=(S=S+Math.imul(Ye,Je)|0)+Math.imul(rt,nt)|0,T=T+Math.imul(rt,Je)|0,_=_+Math.imul(qe,gt)|0,S=(S=S+Math.imul(qe,dt)|0)+Math.imul(We,gt)|0,T=T+Math.imul(We,dt)|0,_=_+Math.imul(Te,ut)|0,S=(S=S+Math.imul(Te,ft)|0)+Math.imul(Pe,ut)|0,T=T+Math.imul(Pe,ft)|0,_=_+Math.imul(pe,jt)|0,S=(S=S+Math.imul(pe,Ot)|0)+Math.imul(fe,jt)|0,T=T+Math.imul(fe,Ot)|0,_=_+Math.imul(se,Vt)|0,S=(S=S+Math.imul(se,$t)|0)+Math.imul(ie,Vt)|0,T=T+Math.imul(ie,$t)|0,_=_+Math.imul(oe,Be)|0,S=(S=S+Math.imul(oe,tt)|0)+Math.imul(ee,Be)|0,T=T+Math.imul(ee,tt)|0,_=_+Math.imul(te,ke)|0,S=(S=S+Math.imul(te,me)|0)+Math.imul(ne,ke)|0,T=T+Math.imul(ne,me)|0,_=_+Math.imul(D,_e)|0,S=(S=S+Math.imul(D,Ee)|0)+Math.imul(G,_e)|0,T=T+Math.imul(G,Ee)|0;var Rt=(z+(_=_+Math.imul(j,Ke)|0)|0)+((8191&(S=(S=S+Math.imul(j,Ue)|0)+Math.imul(J,Ke)|0))<<13)|0;z=((T=T+Math.imul(J,Ue)|0)+(S>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,_=Math.imul(Ce,nt),S=(S=Math.imul(Ce,Je))+Math.imul(Ie,nt)|0,T=Math.imul(Ie,Je),_=_+Math.imul(Ye,gt)|0,S=(S=S+Math.imul(Ye,dt)|0)+Math.imul(rt,gt)|0,T=T+Math.imul(rt,dt)|0,_=_+Math.imul(qe,ut)|0,S=(S=S+Math.imul(qe,ft)|0)+Math.imul(We,ut)|0,T=T+Math.imul(We,ft)|0,_=_+Math.imul(Te,jt)|0,S=(S=S+Math.imul(Te,Ot)|0)+Math.imul(Pe,jt)|0,T=T+Math.imul(Pe,Ot)|0,_=_+Math.imul(pe,Vt)|0,S=(S=S+Math.imul(pe,$t)|0)+Math.imul(fe,Vt)|0,T=T+Math.imul(fe,$t)|0,_=_+Math.imul(se,Be)|0,S=(S=S+Math.imul(se,tt)|0)+Math.imul(ie,Be)|0,T=T+Math.imul(ie,tt)|0,_=_+Math.imul(oe,ke)|0,S=(S=S+Math.imul(oe,me)|0)+Math.imul(ee,ke)|0,T=T+Math.imul(ee,me)|0,_=_+Math.imul(te,_e)|0,S=(S=S+Math.imul(te,Ee)|0)+Math.imul(ne,_e)|0,T=T+Math.imul(ne,Ee)|0;var kt=(z+(_=_+Math.imul(D,Ke)|0)|0)+((8191&(S=(S=S+Math.imul(D,Ue)|0)+Math.imul(G,Ke)|0))<<13)|0;z=((T=T+Math.imul(G,Ue)|0)+(S>>>13)|0)+(kt>>>26)|0,kt&=67108863,_=Math.imul(Ce,gt),S=(S=Math.imul(Ce,dt))+Math.imul(Ie,gt)|0,T=Math.imul(Ie,dt),_=_+Math.imul(Ye,ut)|0,S=(S=S+Math.imul(Ye,ft)|0)+Math.imul(rt,ut)|0,T=T+Math.imul(rt,ft)|0,_=_+Math.imul(qe,jt)|0,S=(S=S+Math.imul(qe,Ot)|0)+Math.imul(We,jt)|0,T=T+Math.imul(We,Ot)|0,_=_+Math.imul(Te,Vt)|0,S=(S=S+Math.imul(Te,$t)|0)+Math.imul(Pe,Vt)|0,T=T+Math.imul(Pe,$t)|0,_=_+Math.imul(pe,Be)|0,S=(S=S+Math.imul(pe,tt)|0)+Math.imul(fe,Be)|0,T=T+Math.imul(fe,tt)|0,_=_+Math.imul(se,ke)|0,S=(S=S+Math.imul(se,me)|0)+Math.imul(ie,ke)|0,T=T+Math.imul(ie,me)|0,_=_+Math.imul(oe,_e)|0,S=(S=S+Math.imul(oe,Ee)|0)+Math.imul(ee,_e)|0,T=T+Math.imul(ee,Ee)|0;var Nt=(z+(_=_+Math.imul(te,Ke)|0)|0)+((8191&(S=(S=S+Math.imul(te,Ue)|0)+Math.imul(ne,Ke)|0))<<13)|0;z=((T=T+Math.imul(ne,Ue)|0)+(S>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,_=Math.imul(Ce,ut),S=(S=Math.imul(Ce,ft))+Math.imul(Ie,ut)|0,T=Math.imul(Ie,ft),_=_+Math.imul(Ye,jt)|0,S=(S=S+Math.imul(Ye,Ot)|0)+Math.imul(rt,jt)|0,T=T+Math.imul(rt,Ot)|0,_=_+Math.imul(qe,Vt)|0,S=(S=S+Math.imul(qe,$t)|0)+Math.imul(We,Vt)|0,T=T+Math.imul(We,$t)|0,_=_+Math.imul(Te,Be)|0,S=(S=S+Math.imul(Te,tt)|0)+Math.imul(Pe,Be)|0,T=T+Math.imul(Pe,tt)|0,_=_+Math.imul(pe,ke)|0,S=(S=S+Math.imul(pe,me)|0)+Math.imul(fe,ke)|0,T=T+Math.imul(fe,me)|0,_=_+Math.imul(se,_e)|0,S=(S=S+Math.imul(se,Ee)|0)+Math.imul(ie,_e)|0,T=T+Math.imul(ie,Ee)|0;var sr=(z+(_=_+Math.imul(oe,Ke)|0)|0)+((8191&(S=(S=S+Math.imul(oe,Ue)|0)+Math.imul(ee,Ke)|0))<<13)|0;z=((T=T+Math.imul(ee,Ue)|0)+(S>>>13)|0)+(sr>>>26)|0,sr&=67108863,_=Math.imul(Ce,jt),S=(S=Math.imul(Ce,Ot))+Math.imul(Ie,jt)|0,T=Math.imul(Ie,Ot),_=_+Math.imul(Ye,Vt)|0,S=(S=S+Math.imul(Ye,$t)|0)+Math.imul(rt,Vt)|0,T=T+Math.imul(rt,$t)|0,_=_+Math.imul(qe,Be)|0,S=(S=S+Math.imul(qe,tt)|0)+Math.imul(We,Be)|0,T=T+Math.imul(We,tt)|0,_=_+Math.imul(Te,ke)|0,S=(S=S+Math.imul(Te,me)|0)+Math.imul(Pe,ke)|0,T=T+Math.imul(Pe,me)|0,_=_+Math.imul(pe,_e)|0,S=(S=S+Math.imul(pe,Ee)|0)+Math.imul(fe,_e)|0,T=T+Math.imul(fe,Ee)|0;var Gt=(z+(_=_+Math.imul(se,Ke)|0)|0)+((8191&(S=(S=S+Math.imul(se,Ue)|0)+Math.imul(ie,Ke)|0))<<13)|0;z=((T=T+Math.imul(ie,Ue)|0)+(S>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,_=Math.imul(Ce,Vt),S=(S=Math.imul(Ce,$t))+Math.imul(Ie,Vt)|0,T=Math.imul(Ie,$t),_=_+Math.imul(Ye,Be)|0,S=(S=S+Math.imul(Ye,tt)|0)+Math.imul(rt,Be)|0,T=T+Math.imul(rt,tt)|0,_=_+Math.imul(qe,ke)|0,S=(S=S+Math.imul(qe,me)|0)+Math.imul(We,ke)|0,T=T+Math.imul(We,me)|0,_=_+Math.imul(Te,_e)|0,S=(S=S+Math.imul(Te,Ee)|0)+Math.imul(Pe,_e)|0,T=T+Math.imul(Pe,Ee)|0;var Xt=(z+(_=_+Math.imul(pe,Ke)|0)|0)+((8191&(S=(S=S+Math.imul(pe,Ue)|0)+Math.imul(fe,Ke)|0))<<13)|0;z=((T=T+Math.imul(fe,Ue)|0)+(S>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,_=Math.imul(Ce,Be),S=(S=Math.imul(Ce,tt))+Math.imul(Ie,Be)|0,T=Math.imul(Ie,tt),_=_+Math.imul(Ye,ke)|0,S=(S=S+Math.imul(Ye,me)|0)+Math.imul(rt,ke)|0,T=T+Math.imul(rt,me)|0,_=_+Math.imul(qe,_e)|0,S=(S=S+Math.imul(qe,Ee)|0)+Math.imul(We,_e)|0,T=T+Math.imul(We,Ee)|0;var Ht=(z+(_=_+Math.imul(Te,Ke)|0)|0)+((8191&(S=(S=S+Math.imul(Te,Ue)|0)+Math.imul(Pe,Ke)|0))<<13)|0;z=((T=T+Math.imul(Pe,Ue)|0)+(S>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,_=Math.imul(Ce,ke),S=(S=Math.imul(Ce,me))+Math.imul(Ie,ke)|0,T=Math.imul(Ie,me),_=_+Math.imul(Ye,_e)|0,S=(S=S+Math.imul(Ye,Ee)|0)+Math.imul(rt,_e)|0,T=T+Math.imul(rt,Ee)|0;var ar=(z+(_=_+Math.imul(qe,Ke)|0)|0)+((8191&(S=(S=S+Math.imul(qe,Ue)|0)+Math.imul(We,Ke)|0))<<13)|0;z=((T=T+Math.imul(We,Ue)|0)+(S>>>13)|0)+(ar>>>26)|0,ar&=67108863,_=Math.imul(Ce,_e),S=(S=Math.imul(Ce,Ee))+Math.imul(Ie,_e)|0,T=Math.imul(Ie,Ee);var Kt=(z+(_=_+Math.imul(Ye,Ke)|0)|0)+((8191&(S=(S=S+Math.imul(Ye,Ue)|0)+Math.imul(rt,Ke)|0))<<13)|0;z=((T=T+Math.imul(rt,Ue)|0)+(S>>>13)|0)+(Kt>>>26)|0,Kt&=67108863;var xr=(z+(_=Math.imul(Ce,Ke))|0)+((8191&(S=(S=Math.imul(Ce,Ue))+Math.imul(Ie,Ke)|0))<<13)|0;return z=((T=Math.imul(Ie,Ue))+(S>>>13)|0)+(xr>>>26)|0,xr&=67108863,H[0]=Qe,H[1]=et,H[2]=bt,H[3]=Ct,H[4]=Pt,H[5]=be,H[6]=Me,H[7]=it,H[8]=mt,H[9]=Rt,H[10]=kt,H[11]=Nt,H[12]=sr,H[13]=Gt,H[14]=Xt,H[15]=Ht,H[16]=ar,H[17]=Kt,H[18]=xr,z!==0&&(H[19]=z,w.length++),w};function N(E,x,w){w.negative=x.negative^E.negative,w.length=E.length+x.length;for(var _=0,S=0,T=0;T<w.length-1;T++){var U=S;S=0;for(var A=67108863&_,H=Math.min(T,x.length-1),z=Math.max(0,T-E.length+1);z<=H;z++){var K=T-z,j=(0|E.words[K])*(0|x.words[z]),J=67108863&j;A=67108863&(J=J+A|0),S+=(U=(U=U+(j/67108864|0)|0)+(J>>>26)|0)>>>26,U&=67108863}w.words[T]=A,_=U,U=S}return _!==0?w.words[T]=_:w.length--,w._strip()}function L(E,x,w){return N(E,x,w)}Math.imul||(k=y),c.prototype.mulTo=function(E,x){var w=this.length+E.length;return this.length===10&&E.length===10?k(this,E,x):w<63?y(this,E,x):w<1024?N(this,E,x):L(this,E,x)},c.prototype.mul=function(E){var x=new c(null);return x.words=new Array(this.length+E.length),this.mulTo(E,x)},c.prototype.mulf=function(E){var x=new c(null);return x.words=new Array(this.length+E.length),L(this,E,x)},c.prototype.imul=function(E){return this.clone().mulTo(E,this)},c.prototype.imuln=function(E){var x=E<0;x&&(E=-E),o(typeof E=="number"),o(E<67108864);for(var w=0,_=0;_<this.length;_++){var S=(0|this.words[_])*E,T=(67108863&S)+(67108863&w);w>>=26,w+=S/67108864|0,w+=T>>>26,this.words[_]=67108863&T}return w!==0&&(this.words[_]=w,this.length++),x?this.ineg():this},c.prototype.muln=function(E){return this.clone().imuln(E)},c.prototype.sqr=function(){return this.mul(this)},c.prototype.isqr=function(){return this.imul(this.clone())},c.prototype.pow=function(E){var x=function(T){for(var U=new Array(T.bitLength()),A=0;A<U.length;A++){var H=A/26|0,z=A%26;U[A]=T.words[H]>>>z&1}return U}(E);if(x.length===0)return new c(1);for(var w=this,_=0;_<x.length&&x[_]===0;_++,w=w.sqr());if(++_<x.length)for(var S=w.sqr();_<x.length;_++,S=S.sqr())x[_]!==0&&(w=w.mul(S));return w},c.prototype.iushln=function(E){o(typeof E=="number"&&E>=0);var x,w=E%26,_=(E-w)/26,S=67108863>>>26-w<<26-w;if(w!==0){var T=0;for(x=0;x<this.length;x++){var U=this.words[x]&S,A=(0|this.words[x])-U<<w;this.words[x]=A|T,T=U>>>26-w}T&&(this.words[x]=T,this.length++)}if(_!==0){for(x=this.length-1;x>=0;x--)this.words[x+_]=this.words[x];for(x=0;x<_;x++)this.words[x]=0;this.length+=_}return this._strip()},c.prototype.ishln=function(E){return o(this.negative===0),this.iushln(E)},c.prototype.iushrn=function(E,x,w){var _;o(typeof E=="number"&&E>=0),_=x?(x-x%26)/26:0;var S=E%26,T=Math.min((E-S)/26,this.length),U=67108863^67108863>>>S<<S,A=w;if(_-=T,_=Math.max(0,_),A){for(var H=0;H<T;H++)A.words[H]=this.words[H];A.length=T}if(T!==0)if(this.length>T)for(this.length-=T,H=0;H<this.length;H++)this.words[H]=this.words[H+T];else this.words[0]=0,this.length=1;var z=0;for(H=this.length-1;H>=0&&(z!==0||H>=_);H--){var K=0|this.words[H];this.words[H]=z<<26-S|K>>>S,z=K&U}return A&&z!==0&&(A.words[A.length++]=z),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},c.prototype.ishrn=function(E,x,w){return o(this.negative===0),this.iushrn(E,x,w)},c.prototype.shln=function(E){return this.clone().ishln(E)},c.prototype.ushln=function(E){return this.clone().iushln(E)},c.prototype.shrn=function(E){return this.clone().ishrn(E)},c.prototype.ushrn=function(E){return this.clone().iushrn(E)},c.prototype.testn=function(E){o(typeof E=="number"&&E>=0);var x=E%26,w=(E-x)/26,_=1<<x;return!(this.length<=w)&&!!(this.words[w]&_)},c.prototype.imaskn=function(E){o(typeof E=="number"&&E>=0);var x=E%26,w=(E-x)/26;if(o(this.negative===0,"imaskn works only with positive numbers"),this.length<=w)return this;if(x!==0&&w++,this.length=Math.min(w,this.length),x!==0){var _=67108863^67108863>>>x<<x;this.words[this.length-1]&=_}return this._strip()},c.prototype.maskn=function(E){return this.clone().imaskn(E)},c.prototype.iaddn=function(E){return o(typeof E=="number"),o(E<67108864),E<0?this.isubn(-E):this.negative!==0?this.length===1&&(0|this.words[0])<=E?(this.words[0]=E-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(E),this.negative=1,this):this._iaddn(E)},c.prototype._iaddn=function(E){this.words[0]+=E;for(var x=0;x<this.length&&this.words[x]>=67108864;x++)this.words[x]-=67108864,x===this.length-1?this.words[x+1]=1:this.words[x+1]++;return this.length=Math.max(this.length,x+1),this},c.prototype.isubn=function(E){if(o(typeof E=="number"),o(E<67108864),E<0)return this.iaddn(-E);if(this.negative!==0)return this.negative=0,this.iaddn(E),this.negative=1,this;if(this.words[0]-=E,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var x=0;x<this.length&&this.words[x]<0;x++)this.words[x]+=67108864,this.words[x+1]-=1;return this._strip()},c.prototype.addn=function(E){return this.clone().iaddn(E)},c.prototype.subn=function(E){return this.clone().isubn(E)},c.prototype.iabs=function(){return this.negative=0,this},c.prototype.abs=function(){return this.clone().iabs()},c.prototype._ishlnsubmul=function(E,x,w){var _,S,T=E.length+w;this._expand(T);var U=0;for(_=0;_<E.length;_++){S=(0|this.words[_+w])+U;var A=(0|E.words[_])*x;U=((S-=67108863&A)>>26)-(A/67108864|0),this.words[_+w]=67108863&S}for(;_<this.length-w;_++)U=(S=(0|this.words[_+w])+U)>>26,this.words[_+w]=67108863&S;if(U===0)return this._strip();for(o(U===-1),U=0,_=0;_<this.length;_++)U=(S=-(0|this.words[_])+U)>>26,this.words[_]=67108863&S;return this.negative=1,this._strip()},c.prototype._wordDiv=function(E,x){var w=(this.length,E.length),_=this.clone(),S=E,T=0|S.words[S.length-1];(w=26-this._countBits(T))!==0&&(S=S.ushln(w),_.iushln(w),T=0|S.words[S.length-1]);var U,A=_.length-S.length;if(x!=="mod"){(U=new c(null)).length=A+1,U.words=new Array(U.length);for(var H=0;H<U.length;H++)U.words[H]=0}var z=_.clone()._ishlnsubmul(S,1,A);z.negative===0&&(_=z,U&&(U.words[A]=1));for(var K=A-1;K>=0;K--){var j=67108864*(0|_.words[S.length+K])+(0|_.words[S.length+K-1]);for(j=Math.min(j/T|0,67108863),_._ishlnsubmul(S,j,K);_.negative!==0;)j--,_.negative=0,_._ishlnsubmul(S,1,K),_.isZero()||(_.negative^=1);U&&(U.words[K]=j)}return U&&U._strip(),_._strip(),x!=="div"&&w!==0&&_.iushrn(w),{div:U||null,mod:_}},c.prototype.divmod=function(E,x,w){return o(!E.isZero()),this.isZero()?{div:new c(0),mod:new c(0)}:this.negative!==0&&E.negative===0?(T=this.neg().divmod(E,x),x!=="mod"&&(_=T.div.neg()),x!=="div"&&(S=T.mod.neg(),w&&S.negative!==0&&S.iadd(E)),{div:_,mod:S}):this.negative===0&&E.negative!==0?(T=this.divmod(E.neg(),x),x!=="mod"&&(_=T.div.neg()),{div:_,mod:T.mod}):this.negative&E.negative?(T=this.neg().divmod(E.neg(),x),x!=="div"&&(S=T.mod.neg(),w&&S.negative!==0&&S.isub(E)),{div:T.div,mod:S}):E.length>this.length||this.cmp(E)<0?{div:new c(0),mod:this}:E.length===1?x==="div"?{div:this.divn(E.words[0]),mod:null}:x==="mod"?{div:null,mod:new c(this.modrn(E.words[0]))}:{div:this.divn(E.words[0]),mod:new c(this.modrn(E.words[0]))}:this._wordDiv(E,x);var _,S,T},c.prototype.div=function(E){return this.divmod(E,"div",!1).div},c.prototype.mod=function(E){return this.divmod(E,"mod",!1).mod},c.prototype.umod=function(E){return this.divmod(E,"mod",!0).mod},c.prototype.divRound=function(E){var x=this.divmod(E);if(x.mod.isZero())return x.div;var w=x.div.negative!==0?x.mod.isub(E):x.mod,_=E.ushrn(1),S=E.andln(1),T=w.cmp(_);return T<0||S===1&&T===0?x.div:x.div.negative!==0?x.div.isubn(1):x.div.iaddn(1)},c.prototype.modrn=function(E){var x=E<0;x&&(E=-E),o(E<=67108863);for(var w=(1<<26)%E,_=0,S=this.length-1;S>=0;S--)_=(w*_+(0|this.words[S]))%E;return x?-_:_},c.prototype.modn=function(E){return this.modrn(E)},c.prototype.idivn=function(E){var x=E<0;x&&(E=-E),o(E<=67108863);for(var w=0,_=this.length-1;_>=0;_--){var S=(0|this.words[_])+67108864*w;this.words[_]=S/E|0,w=S%E}return this._strip(),x?this.ineg():this},c.prototype.divn=function(E){return this.clone().idivn(E)},c.prototype.egcd=function(E){o(E.negative===0),o(!E.isZero());var x=this,w=E.clone();x=x.negative!==0?x.umod(E):x.clone();for(var _=new c(1),S=new c(0),T=new c(0),U=new c(1),A=0;x.isEven()&&w.isEven();)x.iushrn(1),w.iushrn(1),++A;for(var H=w.clone(),z=x.clone();!x.isZero();){for(var K=0,j=1;!(x.words[0]&j)&&K<26;++K,j<<=1);if(K>0)for(x.iushrn(K);K-- >0;)(_.isOdd()||S.isOdd())&&(_.iadd(H),S.isub(z)),_.iushrn(1),S.iushrn(1);for(var J=0,P=1;!(w.words[0]&P)&&J<26;++J,P<<=1);if(J>0)for(w.iushrn(J);J-- >0;)(T.isOdd()||U.isOdd())&&(T.iadd(H),U.isub(z)),T.iushrn(1),U.iushrn(1);x.cmp(w)>=0?(x.isub(w),_.isub(T),S.isub(U)):(w.isub(x),T.isub(_),U.isub(S))}return{a:T,b:U,gcd:w.iushln(A)}},c.prototype._invmp=function(E){o(E.negative===0),o(!E.isZero());var x=this,w=E.clone();x=x.negative!==0?x.umod(E):x.clone();for(var _,S=new c(1),T=new c(0),U=w.clone();x.cmpn(1)>0&&w.cmpn(1)>0;){for(var A=0,H=1;!(x.words[0]&H)&&A<26;++A,H<<=1);if(A>0)for(x.iushrn(A);A-- >0;)S.isOdd()&&S.iadd(U),S.iushrn(1);for(var z=0,K=1;!(w.words[0]&K)&&z<26;++z,K<<=1);if(z>0)for(w.iushrn(z);z-- >0;)T.isOdd()&&T.iadd(U),T.iushrn(1);x.cmp(w)>=0?(x.isub(w),S.isub(T)):(w.isub(x),T.isub(S))}return(_=x.cmpn(1)===0?S:T).cmpn(0)<0&&_.iadd(E),_},c.prototype.gcd=function(E){if(this.isZero())return E.abs();if(E.isZero())return this.abs();var x=this.clone(),w=E.clone();x.negative=0,w.negative=0;for(var _=0;x.isEven()&&w.isEven();_++)x.iushrn(1),w.iushrn(1);for(;;){for(;x.isEven();)x.iushrn(1);for(;w.isEven();)w.iushrn(1);var S=x.cmp(w);if(S<0){var T=x;x=w,w=T}else if(S===0||w.cmpn(1)===0)break;x.isub(w)}return w.iushln(_)},c.prototype.invm=function(E){return this.egcd(E).a.umod(E)},c.prototype.isEven=function(){return(1&this.words[0])==0},c.prototype.isOdd=function(){return(1&this.words[0])==1},c.prototype.andln=function(E){return this.words[0]&E},c.prototype.bincn=function(E){o(typeof E=="number");var x=E%26,w=(E-x)/26,_=1<<x;if(this.length<=w)return this._expand(w+1),this.words[w]|=_,this;for(var S=_,T=w;S!==0&&T<this.length;T++){var U=0|this.words[T];S=(U+=S)>>>26,U&=67108863,this.words[T]=U}return S!==0&&(this.words[T]=S,this.length++),this},c.prototype.isZero=function(){return this.length===1&&this.words[0]===0},c.prototype.cmpn=function(E){var x,w=E<0;if(this.negative!==0&&!w)return-1;if(this.negative===0&&w)return 1;if(this._strip(),this.length>1)x=1;else{w&&(E=-E),o(E<=67108863,"Number is too big");var _=0|this.words[0];x=_===E?0:_<E?-1:1}return this.negative!==0?0|-x:x},c.prototype.cmp=function(E){if(this.negative!==0&&E.negative===0)return-1;if(this.negative===0&&E.negative!==0)return 1;var x=this.ucmp(E);return this.negative!==0?0|-x:x},c.prototype.ucmp=function(E){if(this.length>E.length)return 1;if(this.length<E.length)return-1;for(var x=0,w=this.length-1;w>=0;w--){var _=0|this.words[w],S=0|E.words[w];if(_!==S){_<S?x=-1:_>S&&(x=1);break}}return x},c.prototype.gtn=function(E){return this.cmpn(E)===1},c.prototype.gt=function(E){return this.cmp(E)===1},c.prototype.gten=function(E){return this.cmpn(E)>=0},c.prototype.gte=function(E){return this.cmp(E)>=0},c.prototype.ltn=function(E){return this.cmpn(E)===-1},c.prototype.lt=function(E){return this.cmp(E)===-1},c.prototype.lten=function(E){return this.cmpn(E)<=0},c.prototype.lte=function(E){return this.cmp(E)<=0},c.prototype.eqn=function(E){return this.cmpn(E)===0},c.prototype.eq=function(E){return this.cmp(E)===0},c.red=function(E){return new C(E)},c.prototype.toRed=function(E){return o(!this.red,"Already a number in reduction context"),o(this.negative===0,"red works only with positives"),E.convertTo(this)._forceRed(E)},c.prototype.fromRed=function(){return o(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},c.prototype._forceRed=function(E){return this.red=E,this},c.prototype.forceRed=function(E){return o(!this.red,"Already a number in reduction context"),this._forceRed(E)},c.prototype.redAdd=function(E){return o(this.red,"redAdd works only with red numbers"),this.red.add(this,E)},c.prototype.redIAdd=function(E){return o(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,E)},c.prototype.redSub=function(E){return o(this.red,"redSub works only with red numbers"),this.red.sub(this,E)},c.prototype.redISub=function(E){return o(this.red,"redISub works only with red numbers"),this.red.isub(this,E)},c.prototype.redShl=function(E){return o(this.red,"redShl works only with red numbers"),this.red.shl(this,E)},c.prototype.redMul=function(E){return o(this.red,"redMul works only with red numbers"),this.red._verify2(this,E),this.red.mul(this,E)},c.prototype.redIMul=function(E){return o(this.red,"redMul works only with red numbers"),this.red._verify2(this,E),this.red.imul(this,E)},c.prototype.redSqr=function(){return o(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},c.prototype.redISqr=function(){return o(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},c.prototype.redSqrt=function(){return o(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},c.prototype.redInvm=function(){return o(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},c.prototype.redNeg=function(){return o(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},c.prototype.redPow=function(E){return o(this.red&&!E.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,E)};var F={k256:null,p224:null,p192:null,p25519:null};function R(E,x){this.name=E,this.p=new c(x,16),this.n=this.p.bitLength(),this.k=new c(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function B(){R.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function q(){R.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function V(){R.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function I(){R.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function C(E){if(typeof E=="string"){var x=c._prime(E);this.m=x.p,this.prime=x}else o(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}function O(E){C.call(this,E),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new c(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}R.prototype._tmp=function(){var E=new c(null);return E.words=new Array(Math.ceil(this.n/13)),E},R.prototype.ireduce=function(E){var x,w=E;do this.split(w,this.tmp),x=(w=(w=this.imulK(w)).iadd(this.tmp)).bitLength();while(x>this.n);var _=x<this.n?-1:w.ucmp(this.p);return _===0?(w.words[0]=0,w.length=1):_>0?w.isub(this.p):w.strip!==void 0?w.strip():w._strip(),w},R.prototype.split=function(E,x){E.iushrn(this.n,0,x)},R.prototype.imulK=function(E){return E.imul(this.k)},l(B,R),B.prototype.split=function(E,x){for(var w=Math.min(E.length,9),_=0;_<w;_++)x.words[_]=E.words[_];if(x.length=w,E.length<=9)return E.words[0]=0,void(E.length=1);var S=E.words[9];for(x.words[x.length++]=4194303&S,_=10;_<E.length;_++){var T=0|E.words[_];E.words[_-10]=(4194303&T)<<4|S>>>22,S=T}S>>>=22,E.words[_-10]=S,S===0&&E.length>10?E.length-=10:E.length-=9},B.prototype.imulK=function(E){E.words[E.length]=0,E.words[E.length+1]=0,E.length+=2;for(var x=0,w=0;w<E.length;w++){var _=0|E.words[w];x+=977*_,E.words[w]=67108863&x,x=64*_+(x/67108864|0)}return E.words[E.length-1]===0&&(E.length--,E.words[E.length-1]===0&&E.length--),E},l(q,R),l(V,R),l(I,R),I.prototype.imulK=function(E){for(var x=0,w=0;w<E.length;w++){var _=19*(0|E.words[w])+x,S=67108863&_;_>>>=26,E.words[w]=S,x=_}return x!==0&&(E.words[E.length++]=x),E},c._prime=function(E){if(F[E])return F[E];var x;if(E==="k256")x=new B;else if(E==="p224")x=new q;else if(E==="p192")x=new V;else{if(E!=="p25519")throw new Error("Unknown prime "+E);x=new I}return F[E]=x,x},C.prototype._verify1=function(E){o(E.negative===0,"red works only with positives"),o(E.red,"red works only with red numbers")},C.prototype._verify2=function(E,x){o((E.negative|x.negative)==0,"red works only with positives"),o(E.red&&E.red===x.red,"red works only with red numbers")},C.prototype.imod=function(E){return this.prime?this.prime.ireduce(E)._forceRed(this):(g(E,E.umod(this.m)._forceRed(this)),E)},C.prototype.neg=function(E){return E.isZero()?E.clone():this.m.sub(E)._forceRed(this)},C.prototype.add=function(E,x){this._verify2(E,x);var w=E.add(x);return w.cmp(this.m)>=0&&w.isub(this.m),w._forceRed(this)},C.prototype.iadd=function(E,x){this._verify2(E,x);var w=E.iadd(x);return w.cmp(this.m)>=0&&w.isub(this.m),w},C.prototype.sub=function(E,x){this._verify2(E,x);var w=E.sub(x);return w.cmpn(0)<0&&w.iadd(this.m),w._forceRed(this)},C.prototype.isub=function(E,x){this._verify2(E,x);var w=E.isub(x);return w.cmpn(0)<0&&w.iadd(this.m),w},C.prototype.shl=function(E,x){return this._verify1(E),this.imod(E.ushln(x))},C.prototype.imul=function(E,x){return this._verify2(E,x),this.imod(E.imul(x))},C.prototype.mul=function(E,x){return this._verify2(E,x),this.imod(E.mul(x))},C.prototype.isqr=function(E){return this.imul(E,E.clone())},C.prototype.sqr=function(E){return this.mul(E,E)},C.prototype.sqrt=function(E){if(E.isZero())return E.clone();var x=this.m.andln(3);if(o(x%2==1),x===3){var w=this.m.add(new c(1)).iushrn(2);return this.pow(E,w)}for(var _=this.m.subn(1),S=0;!_.isZero()&&_.andln(1)===0;)S++,_.iushrn(1);o(!_.isZero());var T=new c(1).toRed(this),U=T.redNeg(),A=this.m.subn(1).iushrn(1),H=this.m.bitLength();for(H=new c(2*H*H).toRed(this);this.pow(H,A).cmp(U)!==0;)H.redIAdd(U);for(var z=this.pow(H,_),K=this.pow(E,_.addn(1).iushrn(1)),j=this.pow(E,_),J=S;j.cmp(T)!==0;){for(var P=j,D=0;P.cmp(T)!==0;D++)P=P.redSqr();o(D<J);var G=this.pow(z,new c(1).iushln(J-D-1));K=K.redMul(G),z=G.redSqr(),j=j.redMul(z),J=D}return K},C.prototype.invm=function(E){var x=E._invmp(this.m);return x.negative!==0?(x.negative=0,this.imod(x).redNeg()):this.imod(x)},C.prototype.pow=function(E,x){if(x.isZero())return new c(1).toRed(this);if(x.cmpn(1)===0)return E.clone();var w=new Array(16);w[0]=new c(1).toRed(this),w[1]=E;for(var _=2;_<w.length;_++)w[_]=this.mul(w[_-1],E);var S=w[0],T=0,U=0,A=x.bitLength()%26;for(A===0&&(A=26),_=x.length-1;_>=0;_--){for(var H=x.words[_],z=A-1;z>=0;z--){var K=H>>z&1;S!==w[0]&&(S=this.sqr(S)),K!==0||T!==0?(T<<=1,T|=K,(++U===4||_===0&&z===0)&&(S=this.mul(S,w[T]),U=0,T=0)):U=0}A=26}return S},C.prototype.convertTo=function(E){var x=E.umod(this.m);return x===E?x.clone():x},C.prototype.convertFrom=function(E){var x=E.clone();return x.red=null,x},c.mont=function(E){return new O(E)},l(O,C),O.prototype.convertTo=function(E){return this.imod(E.ushln(this.shift))},O.prototype.convertFrom=function(E){var x=this.imod(E.mul(this.rinv));return x.red=null,x},O.prototype.imul=function(E,x){if(E.isZero()||x.isZero())return E.words[0]=0,E.length=1,E;var w=E.imul(x),_=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=w.isub(_).iushrn(this.shift),T=S;return S.cmp(this.m)>=0?T=S.isub(this.m):S.cmpn(0)<0&&(T=S.iadd(this.m)),T._forceRed(this)},O.prototype.mul=function(E,x){if(E.isZero()||x.isZero())return new c(0)._forceRed(this);var w=E.mul(x),_=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=w.isub(_).iushrn(this.shift),T=S;return S.cmp(this.m)>=0?T=S.isub(this.m):S.cmpn(0)<0&&(T=S.iadd(this.m)),T._forceRed(this)},O.prototype.invm=function(E){return this.imod(E._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],187:[function(e,n,s){var a;function i(l){this.rand=l}if(n.exports=function(l){return a||(a=new i(null)),a.generate(l)},n.exports.Rand=i,i.prototype.generate=function(l){return this._rand(l)},i.prototype._rand=function(l){if(this.rand.getBytes)return this.rand.getBytes(l);for(var c=new Uint8Array(l),u=0;u<c.length;u++)c[u]=this.rand.getByte();return c},typeof self=="object")self.crypto&&self.crypto.getRandomValues?i.prototype._rand=function(l){var c=new Uint8Array(l);return self.crypto.getRandomValues(c),c}:self.msCrypto&&self.msCrypto.getRandomValues?i.prototype._rand=function(l){var c=new Uint8Array(l);return self.msCrypto.getRandomValues(c),c}:typeof window=="object"&&(i.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var o=e("crypto");if(typeof o.randomBytes!="function")throw new Error("Not supported");i.prototype._rand=function(l){return o.randomBytes(l)}}catch{}},{crypto:188}],188:[function(e,n,s){},{}],189:[function(e,n,s){var a=e("safe-buffer").Buffer;function i(h){a.isBuffer(h)||(h=a.from(h));for(var f=h.length/4|0,g=new Array(f),m=0;m<f;m++)g[m]=h.readUInt32BE(4*m);return g}function o(h){for(;0<h.length;h++)h[0]=0}function l(h,f,g,m,p){for(var v,b,y,k,N=g[0],L=g[1],F=g[2],R=g[3],B=h[0]^f[0],q=h[1]^f[1],V=h[2]^f[2],I=h[3]^f[3],C=4,O=1;O<p;O++)v=N[B>>>24]^L[q>>>16&255]^F[V>>>8&255]^R[255&I]^f[C++],b=N[q>>>24]^L[V>>>16&255]^F[I>>>8&255]^R[255&B]^f[C++],y=N[V>>>24]^L[I>>>16&255]^F[B>>>8&255]^R[255&q]^f[C++],k=N[I>>>24]^L[B>>>16&255]^F[q>>>8&255]^R[255&V]^f[C++],B=v,q=b,V=y,I=k;return v=(m[B>>>24]<<24|m[q>>>16&255]<<16|m[V>>>8&255]<<8|m[255&I])^f[C++],b=(m[q>>>24]<<24|m[V>>>16&255]<<16|m[I>>>8&255]<<8|m[255&B])^f[C++],y=(m[V>>>24]<<24|m[I>>>16&255]<<16|m[B>>>8&255]<<8|m[255&q])^f[C++],k=(m[I>>>24]<<24|m[B>>>16&255]<<16|m[q>>>8&255]<<8|m[255&V])^f[C++],[v>>>=0,b>>>=0,y>>>=0,k>>>=0]}var c=[0,1,2,4,8,16,32,64,128,27,54],u=function(){for(var h=new Array(256),f=0;f<256;f++)h[f]=f<128?f<<1:f<<1^283;for(var g=[],m=[],p=[[],[],[],[]],v=[[],[],[],[]],b=0,y=0,k=0;k<256;++k){var N=y^y<<1^y<<2^y<<3^y<<4;N=N>>>8^255&N^99,g[b]=N,m[N]=b;var L=h[b],F=h[L],R=h[F],B=257*h[N]^16843008*N;p[0][b]=B<<24|B>>>8,p[1][b]=B<<16|B>>>16,p[2][b]=B<<8|B>>>24,p[3][b]=B,B=16843009*R^65537*F^257*L^16843008*b,v[0][N]=B<<24|B>>>8,v[1][N]=B<<16|B>>>16,v[2][N]=B<<8|B>>>24,v[3][N]=B,b===0?b=y=1:(b=L^h[h[h[R^L]]],y^=h[h[y]])}return{SBOX:g,INV_SBOX:m,SUB_MIX:p,INV_SUB_MIX:v}}();function d(h){this._key=i(h),this._reset()}d.blockSize=16,d.keySize=32,d.prototype.blockSize=d.blockSize,d.prototype.keySize=d.keySize,d.prototype._reset=function(){for(var h=this._key,f=h.length,g=f+6,m=4*(g+1),p=[],v=0;v<f;v++)p[v]=h[v];for(v=f;v<m;v++){var b=p[v-1];v%f==0?(b=b<<8|b>>>24,b=u.SBOX[b>>>24]<<24|u.SBOX[b>>>16&255]<<16|u.SBOX[b>>>8&255]<<8|u.SBOX[255&b],b^=c[v/f|0]<<24):f>6&&v%f==4&&(b=u.SBOX[b>>>24]<<24|u.SBOX[b>>>16&255]<<16|u.SBOX[b>>>8&255]<<8|u.SBOX[255&b]),p[v]=p[v-f]^b}for(var y=[],k=0;k<m;k++){var N=m-k,L=p[N-(k%4?0:4)];y[k]=k<4||N<=4?L:u.INV_SUB_MIX[0][u.SBOX[L>>>24]]^u.INV_SUB_MIX[1][u.SBOX[L>>>16&255]]^u.INV_SUB_MIX[2][u.SBOX[L>>>8&255]]^u.INV_SUB_MIX[3][u.SBOX[255&L]]}this._nRounds=g,this._keySchedule=p,this._invKeySchedule=y},d.prototype.encryptBlockRaw=function(h){return l(h=i(h),this._keySchedule,u.SUB_MIX,u.SBOX,this._nRounds)},d.prototype.encryptBlock=function(h){var f=this.encryptBlockRaw(h),g=a.allocUnsafe(16);return g.writeUInt32BE(f[0],0),g.writeUInt32BE(f[1],4),g.writeUInt32BE(f[2],8),g.writeUInt32BE(f[3],12),g},d.prototype.decryptBlock=function(h){var f=(h=i(h))[1];h[1]=h[3],h[3]=f;var g=l(h,this._invKeySchedule,u.INV_SUB_MIX,u.INV_SBOX,this._nRounds),m=a.allocUnsafe(16);return m.writeUInt32BE(g[0],0),m.writeUInt32BE(g[3],4),m.writeUInt32BE(g[2],8),m.writeUInt32BE(g[1],12),m},d.prototype.scrub=function(){o(this._keySchedule),o(this._invKeySchedule),o(this._key)},n.exports.AES=d},{"safe-buffer":494}],190:[function(e,n,s){var a=e("./aes"),i=e("safe-buffer").Buffer,o=e("cipher-base"),l=e("inherits"),c=e("./ghash"),u=e("buffer-xor"),d=e("./incr32");function h(f,g,m,p){o.call(this);var v=i.alloc(4,0);this._cipher=new a.AES(g);var b=this._cipher.encryptBlock(v);this._ghash=new c(b),m=function(y,k,N){if(k.length===12)return y._finID=i.concat([k,i.from([0,0,0,1])]),i.concat([k,i.from([0,0,0,2])]);var L=new c(N),F=k.length,R=F%16;L.update(k),R&&(R=16-R,L.update(i.alloc(R,0))),L.update(i.alloc(8,0));var B=8*F,q=i.alloc(8);q.writeUIntBE(B,0,8),L.update(q),y._finID=L.state;var V=i.from(y._finID);return d(V),V}(this,m,b),this._prev=i.from(m),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=p,this._alen=0,this._len=0,this._mode=f,this._authTag=null,this._called=!1}l(h,o),h.prototype._update=function(f){if(!this._called&&this._alen){var g=16-this._alen%16;g<16&&(g=i.alloc(g,0),this._ghash.update(g))}this._called=!0;var m=this._mode.encrypt(this,f);return this._decrypt?this._ghash.update(f):this._ghash.update(m),this._len+=f.length,m},h.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var f=u(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(g,m){var p=0;g.length!==m.length&&p++;for(var v=Math.min(g.length,m.length),b=0;b<v;++b)p+=g[b]^m[b];return p}(f,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=f,this._cipher.scrub()},h.prototype.getAuthTag=function(){if(this._decrypt||!i.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},h.prototype.setAuthTag=function(f){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=f},h.prototype.setAAD=function(f){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(f),this._alen+=f.length},n.exports=h},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(e,n,s){var a=e("./encrypter"),i=e("./decrypter"),o=e("./modes/list.json");s.createCipher=s.Cipher=a.createCipher,s.createCipheriv=s.Cipheriv=a.createCipheriv,s.createDecipher=s.Decipher=i.createDecipher,s.createDecipheriv=s.Decipheriv=i.createDecipheriv,s.listCiphers=s.getCiphers=function(){return Object.keys(o)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(e,n,s){var a=e("./authCipher"),i=e("safe-buffer").Buffer,o=e("./modes"),l=e("./streamCipher"),c=e("cipher-base"),u=e("./aes"),d=e("evp_bytestokey");function h(m,p,v){c.call(this),this._cache=new f,this._last=void 0,this._cipher=new u.AES(p),this._prev=i.from(v),this._mode=m,this._autopadding=!0}function f(){this.cache=i.allocUnsafe(0)}function g(m,p,v){var b=o[m.toLowerCase()];if(!b)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=i.from(v)),b.mode!=="GCM"&&v.length!==b.iv)throw new TypeError("invalid iv length "+v.length);if(typeof p=="string"&&(p=i.from(p)),p.length!==b.key/8)throw new TypeError("invalid key length "+p.length);return b.type==="stream"?new l(b.module,p,v,!0):b.type==="auth"?new a(b.module,p,v,!0):new h(b.module,p,v)}e("inherits")(h,c),h.prototype._update=function(m){var p,v;this._cache.add(m);for(var b=[];p=this._cache.get(this._autopadding);)v=this._mode.decrypt(this,p),b.push(v);return i.concat(b)},h.prototype._final=function(){var m=this._cache.flush();if(this._autopadding)return function(p){var v=p[15];if(v<1||v>16)throw new Error("unable to decrypt data");for(var b=-1;++b<v;)if(p[b+(16-v)]!==v)throw new Error("unable to decrypt data");if(v!==16)return p.slice(0,16-v)}(this._mode.decrypt(this,m));if(m)throw new Error("data not multiple of block length")},h.prototype.setAutoPadding=function(m){return this._autopadding=!!m,this},f.prototype.add=function(m){this.cache=i.concat([this.cache,m])},f.prototype.get=function(m){var p;if(m){if(this.cache.length>16)return p=this.cache.slice(0,16),this.cache=this.cache.slice(16),p}else if(this.cache.length>=16)return p=this.cache.slice(0,16),this.cache=this.cache.slice(16),p;return null},f.prototype.flush=function(){if(this.cache.length)return this.cache},s.createDecipher=function(m,p){var v=o[m.toLowerCase()];if(!v)throw new TypeError("invalid suite type");var b=d(p,!1,v.key,v.iv);return g(m,b.key,b.iv)},s.createDecipheriv=g},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(e,n,s){var a=e("./modes"),i=e("./authCipher"),o=e("safe-buffer").Buffer,l=e("./streamCipher"),c=e("cipher-base"),u=e("./aes"),d=e("evp_bytestokey");function h(p,v,b){c.call(this),this._cache=new g,this._cipher=new u.AES(v),this._prev=o.from(b),this._mode=p,this._autopadding=!0}e("inherits")(h,c),h.prototype._update=function(p){var v,b;this._cache.add(p);for(var y=[];v=this._cache.get();)b=this._mode.encrypt(this,v),y.push(b);return o.concat(y)};var f=o.alloc(16,16);function g(){this.cache=o.allocUnsafe(0)}function m(p,v,b){var y=a[p.toLowerCase()];if(!y)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=o.from(v)),v.length!==y.key/8)throw new TypeError("invalid key length "+v.length);if(typeof b=="string"&&(b=o.from(b)),y.mode!=="GCM"&&b.length!==y.iv)throw new TypeError("invalid iv length "+b.length);return y.type==="stream"?new l(y.module,v,b):y.type==="auth"?new i(y.module,v,b):new h(y.module,v,b)}h.prototype._final=function(){var p=this._cache.flush();if(this._autopadding)return p=this._mode.encrypt(this,p),this._cipher.scrub(),p;if(!p.equals(f))throw this._cipher.scrub(),new Error("data not multiple of block length")},h.prototype.setAutoPadding=function(p){return this._autopadding=!!p,this},g.prototype.add=function(p){this.cache=o.concat([this.cache,p])},g.prototype.get=function(){if(this.cache.length>15){var p=this.cache.slice(0,16);return this.cache=this.cache.slice(16),p}return null},g.prototype.flush=function(){for(var p=16-this.cache.length,v=o.allocUnsafe(p),b=-1;++b<p;)v.writeUInt8(p,b);return o.concat([this.cache,v])},s.createCipheriv=m,s.createCipher=function(p,v){var b=a[p.toLowerCase()];if(!b)throw new TypeError("invalid suite type");var y=d(v,!1,b.key,b.iv);return m(p,y.key,y.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(e,n,s){var a=e("safe-buffer").Buffer,i=a.alloc(16,0);function o(c){var u=a.allocUnsafe(16);return u.writeUInt32BE(c[0]>>>0,0),u.writeUInt32BE(c[1]>>>0,4),u.writeUInt32BE(c[2]>>>0,8),u.writeUInt32BE(c[3]>>>0,12),u}function l(c){this.h=c,this.state=a.alloc(16,0),this.cache=a.allocUnsafe(0)}l.prototype.ghash=function(c){for(var u=-1;++u<c.length;)this.state[u]^=c[u];this._multiply()},l.prototype._multiply=function(){for(var c,u,d,h=[(c=this.h).readUInt32BE(0),c.readUInt32BE(4),c.readUInt32BE(8),c.readUInt32BE(12)],f=[0,0,0,0],g=-1;++g<128;){for(this.state[~~(g/8)]&1<<7-g%8&&(f[0]^=h[0],f[1]^=h[1],f[2]^=h[2],f[3]^=h[3]),d=(1&h[3])!=0,u=3;u>0;u--)h[u]=h[u]>>>1|(1&h[u-1])<<31;h[0]=h[0]>>>1,d&&(h[0]=h[0]^225<<24)}this.state=o(f)},l.prototype.update=function(c){var u;for(this.cache=a.concat([this.cache,c]);this.cache.length>=16;)u=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(u)},l.prototype.final=function(c,u){return this.cache.length&&this.ghash(a.concat([this.cache,i],16)),this.ghash(o([0,c,0,u])),this.state},n.exports=l},{"safe-buffer":494}],195:[function(e,n,s){n.exports=function(a){for(var i,o=a.length;o--;){if((i=a.readUInt8(o))!==255){i++,a.writeUInt8(i,o);break}a.writeUInt8(0,o)}}},{}],196:[function(e,n,s){var a=e("buffer-xor");s.encrypt=function(i,o){var l=a(o,i._prev);return i._prev=i._cipher.encryptBlock(l),i._prev},s.decrypt=function(i,o){var l=i._prev;i._prev=o;var c=i._cipher.decryptBlock(o);return a(c,l)}},{"buffer-xor":219}],197:[function(e,n,s){var a=e("safe-buffer").Buffer,i=e("buffer-xor");function o(l,c,u){var d=c.length,h=i(c,l._cache);return l._cache=l._cache.slice(d),l._prev=a.concat([l._prev,u?c:h]),h}s.encrypt=function(l,c,u){for(var d,h=a.allocUnsafe(0);c.length;){if(l._cache.length===0&&(l._cache=l._cipher.encryptBlock(l._prev),l._prev=a.allocUnsafe(0)),!(l._cache.length<=c.length)){h=a.concat([h,o(l,c,u)]);break}d=l._cache.length,h=a.concat([h,o(l,c.slice(0,d),u)]),c=c.slice(d)}return h}},{"buffer-xor":219,"safe-buffer":494}],198:[function(e,n,s){var a=e("safe-buffer").Buffer;function i(l,c,u){for(var d,h,f=-1,g=0;++f<8;)d=c&1<<7-f?128:0,g+=(128&(h=l._cipher.encryptBlock(l._prev)[0]^d))>>f%8,l._prev=o(l._prev,u?d:h);return g}function o(l,c){var u=l.length,d=-1,h=a.allocUnsafe(l.length);for(l=a.concat([l,a.from([c])]);++d<u;)h[d]=l[d]<<1|l[d+1]>>7;return h}s.encrypt=function(l,c,u){for(var d=c.length,h=a.allocUnsafe(d),f=-1;++f<d;)h[f]=i(l,c[f],u);return h}},{"safe-buffer":494}],199:[function(e,n,s){var a=e("safe-buffer").Buffer;function i(o,l,c){var u=o._cipher.encryptBlock(o._prev)[0]^l;return o._prev=a.concat([o._prev.slice(1),a.from([c?l:u])]),u}s.encrypt=function(o,l,c){for(var u=l.length,d=a.allocUnsafe(u),h=-1;++h<u;)d[h]=i(o,l[h],c);return d}},{"safe-buffer":494}],200:[function(e,n,s){var a=e("buffer-xor"),i=e("safe-buffer").Buffer,o=e("../incr32");function l(c){var u=c._cipher.encryptBlockRaw(c._prev);return o(c._prev),u}s.encrypt=function(c,u){var d=Math.ceil(u.length/16),h=c._cache.length;c._cache=i.concat([c._cache,i.allocUnsafe(16*d)]);for(var f=0;f<d;f++){var g=l(c),m=h+16*f;c._cache.writeUInt32BE(g[0],m+0),c._cache.writeUInt32BE(g[1],m+4),c._cache.writeUInt32BE(g[2],m+8),c._cache.writeUInt32BE(g[3],m+12)}var p=c._cache.slice(0,u.length);return c._cache=c._cache.slice(u.length),a(u,p)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(e,n,s){s.encrypt=function(a,i){return a._cipher.encryptBlock(i)},s.decrypt=function(a,i){return a._cipher.decryptBlock(i)}},{}],202:[function(e,n,s){var a={ECB:e("./ecb"),CBC:e("./cbc"),CFB:e("./cfb"),CFB8:e("./cfb8"),CFB1:e("./cfb1"),OFB:e("./ofb"),CTR:e("./ctr"),GCM:e("./ctr")},i=e("./list.json");for(var o in i)i[o].module=a[i[o].mode];n.exports=i},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(e,n,s){n.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(e,n,s){(function(a){(function(){var i=e("buffer-xor");function o(l){return l._prev=l._cipher.encryptBlock(l._prev),l._prev}s.encrypt=function(l,c){for(;l._cache.length<c.length;)l._cache=a.concat([l._cache,o(l)]);var u=l._cache.slice(0,c.length);return l._cache=l._cache.slice(c.length),i(c,u)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(e,n,s){var a=e("./aes"),i=e("safe-buffer").Buffer,o=e("cipher-base");function l(c,u,d,h){o.call(this),this._cipher=new a.AES(u),this._prev=i.from(d),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=h,this._mode=c}e("inherits")(l,o),l.prototype._update=function(c){return this._mode.encrypt(this,c,this._decrypt)},l.prototype._final=function(){this._cipher.scrub()},n.exports=l},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(e,n,s){var a=e("browserify-des"),i=e("browserify-aes/browser"),o=e("browserify-aes/modes"),l=e("browserify-des/modes"),c=e("evp_bytestokey");function u(h,f,g){if(h=h.toLowerCase(),o[h])return i.createCipheriv(h,f,g);if(l[h])return new a({key:f,iv:g,mode:h});throw new TypeError("invalid suite type")}function d(h,f,g){if(h=h.toLowerCase(),o[h])return i.createDecipheriv(h,f,g);if(l[h])return new a({key:f,iv:g,mode:h,decrypt:!0});throw new TypeError("invalid suite type")}s.createCipher=s.Cipher=function(h,f){var g,m;if(h=h.toLowerCase(),o[h])g=o[h].key,m=o[h].iv;else{if(!l[h])throw new TypeError("invalid suite type");g=8*l[h].key,m=l[h].iv}var p=c(f,!1,g,m);return u(h,p.key,p.iv)},s.createCipheriv=s.Cipheriv=u,s.createDecipher=s.Decipher=function(h,f){var g,m;if(h=h.toLowerCase(),o[h])g=o[h].key,m=o[h].iv;else{if(!l[h])throw new TypeError("invalid suite type");g=8*l[h].key,m=l[h].iv}var p=c(f,!1,g,m);return d(h,p.key,p.iv)},s.createDecipheriv=s.Decipheriv=d,s.listCiphers=s.getCiphers=function(){return Object.keys(l).concat(i.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(e,n,s){var a=e("cipher-base"),i=e("des.js"),o=e("inherits"),l=e("safe-buffer").Buffer,c={"des-ede3-cbc":i.CBC.instantiate(i.EDE),"des-ede3":i.EDE,"des-ede-cbc":i.CBC.instantiate(i.EDE),"des-ede":i.EDE,"des-cbc":i.CBC.instantiate(i.DES),"des-ecb":i.DES};function u(d){a.call(this);var h,f=d.mode.toLowerCase(),g=c[f];h=d.decrypt?"decrypt":"encrypt";var m=d.key;l.isBuffer(m)||(m=l.from(m)),f!=="des-ede"&&f!=="des-ede-cbc"||(m=l.concat([m,m.slice(0,8)]));var p=d.iv;l.isBuffer(p)||(p=l.from(p)),this._des=g.create({key:m,iv:p,type:h})}c.des=c["des-cbc"],c.des3=c["des-ede3-cbc"],n.exports=u,o(u,a),u.prototype._update=function(d){return l.from(this._des.update(d))},u.prototype._final=function(){return l.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(e,n,s){s["des-ecb"]={key:8,iv:0},s["des-cbc"]=s.des={key:8,iv:8},s["des-ede3-cbc"]=s.des3={key:24,iv:8},s["des-ede3"]={key:24,iv:0},s["des-ede-cbc"]={key:16,iv:8},s["des-ede"]={key:16,iv:0}},{}],209:[function(e,n,s){(function(a){(function(){var i=e("bn.js"),o=e("randombytes");function l(u){var d,h=u.modulus.byteLength();do d=new i(o(h));while(d.cmp(u.modulus)>=0||!d.umod(u.prime1)||!d.umod(u.prime2));return d}function c(u,d){var h=function(F){var R=l(F);return{blinder:R.toRed(i.mont(F.modulus)).redPow(new i(F.publicExponent)).fromRed(),unblinder:R.invm(F.modulus)}}(d),f=d.modulus.byteLength(),g=new i(u).mul(h.blinder).umod(d.modulus),m=g.toRed(i.mont(d.prime1)),p=g.toRed(i.mont(d.prime2)),v=d.coefficient,b=d.prime1,y=d.prime2,k=m.redPow(d.exponent1).fromRed(),N=p.redPow(d.exponent2).fromRed(),L=k.isub(N).imul(v).umod(b).imul(y);return N.iadd(L).imul(h.unblinder).umod(d.modulus).toArrayLike(a,"be",f)}c.getr=l,n.exports=c}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(e,n,s){n.exports=e("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(e,n,s){n.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(e,n,s){n.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(e,n,s){var a=e("safe-buffer").Buffer,i=e("create-hash"),o=e("readable-stream"),l=e("inherits"),c=e("./sign"),u=e("./verify"),d=e("./algorithms.json");function h(p){o.Writable.call(this);var v=d[p];if(!v)throw new Error("Unknown message digest");this._hashType=v.hash,this._hash=i(v.hash),this._tag=v.id,this._signType=v.sign}function f(p){o.Writable.call(this);var v=d[p];if(!v)throw new Error("Unknown message digest");this._hash=i(v.hash),this._tag=v.id,this._signType=v.sign}function g(p){return new h(p)}function m(p){return new f(p)}Object.keys(d).forEach(function(p){d[p].id=a.from(d[p].id,"hex"),d[p.toLowerCase()]=d[p]}),l(h,o.Writable),h.prototype._write=function(p,v,b){this._hash.update(p),b()},h.prototype.update=function(p,v){return typeof p=="string"&&(p=a.from(p,v)),this._hash.update(p),this},h.prototype.sign=function(p,v){this.end();var b=this._hash.digest(),y=c(b,p,this._hashType,this._signType,this._tag);return v?y.toString(v):y},l(f,o.Writable),f.prototype._write=function(p,v,b){this._hash.update(p),b()},f.prototype.update=function(p,v){return typeof p=="string"&&(p=a.from(p,v)),this._hash.update(p),this},f.prototype.verify=function(p,v,b){typeof v=="string"&&(v=a.from(v,b)),this.end();var y=this._hash.digest();return u(v,y,p,this._signType,this._tag)},n.exports={Sign:g,Verify:m,createSign:g,createVerify:m}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(e,n,s){var a=e("safe-buffer").Buffer,i=e("create-hmac"),o=e("browserify-rsa"),l=e("elliptic").ec,c=e("bn.js"),u=e("parse-asn1"),d=e("./curves.json");function h(p,v,b,y){if((p=a.from(p.toArray())).length<v.byteLength()){var k=a.alloc(v.byteLength()-p.length);p=a.concat([k,p])}var N=b.length,L=function(B,q){B=(B=f(B,q)).mod(q);var V=a.from(B.toArray());if(V.length<q.byteLength()){var I=a.alloc(q.byteLength()-V.length);V=a.concat([I,V])}return V}(b,v),F=a.alloc(N);F.fill(1);var R=a.alloc(N);return R=i(y,R).update(F).update(a.from([0])).update(p).update(L).digest(),F=i(y,R).update(F).digest(),{k:R=i(y,R).update(F).update(a.from([1])).update(p).update(L).digest(),v:F=i(y,R).update(F).digest()}}function f(p,v){var b=new c(p),y=(p.length<<3)-v.bitLength();return y>0&&b.ishrn(y),b}function g(p,v,b){var y,k;do{for(y=a.alloc(0);8*y.length<p.bitLength();)v.v=i(b,v.k).update(v.v).digest(),y=a.concat([y,v.v]);k=f(y,p),v.k=i(b,v.k).update(v.v).update(a.from([0])).digest(),v.v=i(b,v.k).update(v.v).digest()}while(k.cmp(p)!==-1);return k}function m(p,v,b,y){return p.toRed(c.mont(b)).redPow(v).fromRed().mod(y)}n.exports=function(p,v,b,y,k){var N=u(v);if(N.curve){if(y!=="ecdsa"&&y!=="ecdsa/rsa")throw new Error("wrong private key type");return function(B,q){var V=d[q.curve.join(".")];if(!V)throw new Error("unknown curve "+q.curve.join("."));var I=new l(V).keyFromPrivate(q.privateKey).sign(B);return a.from(I.toDER())}(p,N)}if(N.type==="dsa"){if(y!=="dsa")throw new Error("wrong private key type");return function(B,q,V){for(var I,C=q.params.priv_key,O=q.params.p,E=q.params.q,x=q.params.g,w=new c(0),_=f(B,E).mod(E),S=!1,T=h(C,E,B,V);S===!1;)I=g(E,T,V),w=m(x,I,O,E),(S=I.invm(E).imul(_.add(C.mul(w))).mod(E)).cmpn(0)===0&&(S=!1,w=new c(0));return function(U,A){U=U.toArray(),A=A.toArray(),128&U[0]&&(U=[0].concat(U)),128&A[0]&&(A=[0].concat(A));var H=[48,U.length+A.length+4,2,U.length];return H=H.concat(U,[2,A.length],A),a.from(H)}(w,S)}(p,N,b)}if(y!=="rsa"&&y!=="ecdsa/rsa")throw new Error("wrong private key type");p=a.concat([k,p]);for(var L=N.modulus.byteLength(),F=[0,1];p.length+F.length+1<L;)F.push(255);F.push(0);for(var R=-1;++R<p.length;)F.push(p[R]);return o(F,N)},n.exports.getKey=h,n.exports.makeKey=g},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(e,n,s){var a=e("safe-buffer").Buffer,i=e("bn.js"),o=e("elliptic").ec,l=e("parse-asn1"),c=e("./curves.json");function u(d,h){if(d.cmpn(0)<=0)throw new Error("invalid sig");if(d.cmp(h)>=h)throw new Error("invalid sig")}n.exports=function(d,h,f,g,m){var p=l(f);if(p.type==="ec"){if(g!=="ecdsa"&&g!=="ecdsa/rsa")throw new Error("wrong public key type");return function(F,R,B){var q=c[B.data.algorithm.curve.join(".")];if(!q)throw new Error("unknown curve "+B.data.algorithm.curve.join("."));var V=new o(q),I=B.data.subjectPrivateKey.data;return V.verify(R,F,I)}(d,h,p)}if(p.type==="dsa"){if(g!=="dsa")throw new Error("wrong public key type");return function(F,R,B){var q=B.data.p,V=B.data.q,I=B.data.g,C=B.data.pub_key,O=l.signature.decode(F,"der"),E=O.s,x=O.r;u(E,V),u(x,V);var w=i.mont(q),_=E.invm(V);return I.toRed(w).redPow(new i(R).mul(_).mod(V)).fromRed().mul(C.toRed(w).redPow(x.mul(_).mod(V)).fromRed()).mod(q).mod(V).cmp(x)===0}(d,h,p)}if(g!=="rsa"&&g!=="ecdsa/rsa")throw new Error("wrong public key type");h=a.concat([m,h]);for(var v=p.modulus.byteLength(),b=[1],y=0;h.length+b.length+2<v;)b.push(255),y++;b.push(0);for(var k=-1;++k<h.length;)b.push(h[k]);b=a.from(b);var N=i.mont(p.modulus);d=(d=new i(d).toRed(N)).redPow(new i(p.publicExponent)),d=a.from(d.fromRed().toArray());var L=y<8?1:0;for(v=Math.min(d.length,b.length),d.length!==b.length&&(L=1),k=-1;++k<v;)L|=d[k]^b[k];return L===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(e,n,s){},{}],217:[function(e,n,s){var a=e("buffer"),i=a.Buffer;function o(c,u){for(var d in c)u[d]=c[d]}function l(c,u,d){return i(c,u,d)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?n.exports=a:(o(a,s),s.Buffer=l),o(i,l),l.from=function(c,u,d){if(typeof c=="number")throw new TypeError("Argument must not be a number");return i(c,u,d)},l.alloc=function(c,u,d){if(typeof c!="number")throw new TypeError("Argument must be a number");var h=i(c);return u!==void 0?typeof d=="string"?h.fill(u,d):h.fill(u):h.fill(0),h},l.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return i(c)},l.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return a.SlowBuffer(c)}},{buffer:220}],218:[function(e,n,s){var a=e("safe-buffer").Buffer,i=a.isEncoding||function(p){switch((p=""+p)&&p.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(p){var v;switch(this.encoding=function(b){var y=function(k){if(!k)return"utf8";for(var N;;)switch(k){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return k;default:if(N)return;k=(""+k).toLowerCase(),N=!0}}(b);if(typeof y!="string"&&(a.isEncoding===i||!i(b)))throw new Error("Unknown encoding: "+b);return y||b}(p),this.encoding){case"utf16le":this.text=u,this.end=d,v=4;break;case"utf8":this.fillLast=c,v=4;break;case"base64":this.text=h,this.end=f,v=3;break;default:return this.write=g,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=a.allocUnsafe(v)}function l(p){return p<=127?0:p>>5==6?2:p>>4==14?3:p>>3==30?4:p>>6==2?-1:-2}function c(p){var v=this.lastTotal-this.lastNeed,b=function(y,k,N){if((192&k[0])!=128)return y.lastNeed=0,"";if(y.lastNeed>1&&k.length>1){if((192&k[1])!=128)return y.lastNeed=1,"";if(y.lastNeed>2&&k.length>2&&(192&k[2])!=128)return y.lastNeed=2,""}}(this,p);return b!==void 0?b:this.lastNeed<=p.length?(p.copy(this.lastChar,v,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(p.copy(this.lastChar,v,0,p.length),void(this.lastNeed-=p.length))}function u(p,v){if((p.length-v)%2==0){var b=p.toString("utf16le",v);if(b){var y=b.charCodeAt(b.length-1);if(y>=55296&&y<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=p[p.length-2],this.lastChar[1]=p[p.length-1],b.slice(0,-1)}return b}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=p[p.length-1],p.toString("utf16le",v,p.length-1)}function d(p){var v=p&&p.length?this.write(p):"";if(this.lastNeed){var b=this.lastTotal-this.lastNeed;return v+this.lastChar.toString("utf16le",0,b)}return v}function h(p,v){var b=(p.length-v)%3;return b===0?p.toString("base64",v):(this.lastNeed=3-b,this.lastTotal=3,b===1?this.lastChar[0]=p[p.length-1]:(this.lastChar[0]=p[p.length-2],this.lastChar[1]=p[p.length-1]),p.toString("base64",v,p.length-b))}function f(p){var v=p&&p.length?this.write(p):"";return this.lastNeed?v+this.lastChar.toString("base64",0,3-this.lastNeed):v}function g(p){return p.toString(this.encoding)}function m(p){return p&&p.length?this.write(p):""}s.StringDecoder=o,o.prototype.write=function(p){if(p.length===0)return"";var v,b;if(this.lastNeed){if((v=this.fillLast(p))===void 0)return"";b=this.lastNeed,this.lastNeed=0}else b=0;return b<p.length?v?v+this.text(p,b):this.text(p,b):v||""},o.prototype.end=function(p){var v=p&&p.length?this.write(p):"";return this.lastNeed?v+"":v},o.prototype.text=function(p,v){var b=function(k,N,L){var F=N.length-1;if(F<L)return 0;var R=l(N[F]);return R>=0?(R>0&&(k.lastNeed=R-1),R):--F<L||R===-2?0:(R=l(N[F]))>=0?(R>0&&(k.lastNeed=R-2),R):--F<L||R===-2?0:(R=l(N[F]))>=0?(R>0&&(R===2?R=0:k.lastNeed=R-3),R):0}(this,p,v);if(!this.lastNeed)return p.toString("utf8",v);this.lastTotal=b;var y=p.length-(b-this.lastNeed);return p.copy(this.lastChar,0,y),p.toString("utf8",v,y)},o.prototype.fillLast=function(p){if(this.lastNeed<=p.length)return p.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);p.copy(this.lastChar,this.lastTotal-this.lastNeed,0,p.length),this.lastNeed-=p.length}},{"safe-buffer":217}],219:[function(e,n,s){(function(a){(function(){n.exports=function(i,o){for(var l=Math.min(i.length,o.length),c=new a(l),u=0;u<l;++u)c[u]=i[u]^o[u];return c}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],220:[function(e,n,s){(function(a){(function(){var i=e("base64-js"),o=e("ieee754");s.Buffer=c,s.SlowBuffer=function(P){return+P!=P&&(P=0),c.alloc(+P)},s.INSPECT_MAX_BYTES=50;function l(P){if(P>2147483647)throw new RangeError('The value "'+P+'" is invalid for option "size"');var D=new Uint8Array(P);return D.__proto__=c.prototype,D}function c(P,D,G){if(typeof P=="number"){if(typeof D=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(P)}return u(P,D,G)}function u(P,D,G){if(typeof P=="string")return function(ne,le){if(typeof le=="string"&&le!==""||(le="utf8"),!c.isEncoding(le))throw new TypeError("Unknown encoding: "+le);var oe=0|m(ne,le),ee=l(oe),Z=ee.write(ne,le);return Z!==oe&&(ee=ee.slice(0,Z)),ee}(P,D);if(ArrayBuffer.isView(P))return f(P);if(P==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof P);if(j(P,ArrayBuffer)||P&&j(P.buffer,ArrayBuffer))return function(ne,le,oe){if(le<0||ne.byteLength<le)throw new RangeError('"offset" is outside of buffer bounds');if(ne.byteLength<le+(oe||0))throw new RangeError('"length" is outside of buffer bounds');var ee;return ee=le===void 0&&oe===void 0?new Uint8Array(ne):oe===void 0?new Uint8Array(ne,le):new Uint8Array(ne,le,oe),ee.__proto__=c.prototype,ee}(P,D,G);if(typeof P=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var re=P.valueOf&&P.valueOf();if(re!=null&&re!==P)return c.from(re,D,G);var te=function(ne){if(c.isBuffer(ne)){var le=0|g(ne.length),oe=l(le);return oe.length===0||ne.copy(oe,0,0,le),oe}if(ne.length!==void 0)return typeof ne.length!="number"||J(ne.length)?l(0):f(ne);if(ne.type==="Buffer"&&Array.isArray(ne.data))return f(ne.data)}(P);if(te)return te;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof P[Symbol.toPrimitive]=="function")return c.from(P[Symbol.toPrimitive]("string"),D,G);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof P)}function d(P){if(typeof P!="number")throw new TypeError('"size" argument must be of type number');if(P<0)throw new RangeError('The value "'+P+'" is invalid for option "size"')}function h(P){return d(P),l(P<0?0:0|g(P))}function f(P){for(var D=P.length<0?0:0|g(P.length),G=l(D),re=0;re<D;re+=1)G[re]=255&P[re];return G}function g(P){if(P>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|P}function m(P,D){if(c.isBuffer(P))return P.length;if(ArrayBuffer.isView(P)||j(P,ArrayBuffer))return P.byteLength;if(typeof P!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof P);var G=P.length,re=arguments.length>2&&arguments[2]===!0;if(!re&&G===0)return 0;for(var te=!1;;)switch(D){case"ascii":case"latin1":case"binary":return G;case"utf8":case"utf-8":return H(P).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*G;case"hex":return G>>>1;case"base64":return z(P).length;default:if(te)return re?-1:H(P).length;D=(""+D).toLowerCase(),te=!0}}function p(P,D,G){var re=!1;if((D===void 0||D<0)&&(D=0),D>this.length||((G===void 0||G>this.length)&&(G=this.length),G<=0)||(G>>>=0)<=(D>>>=0))return"";for(P||(P="utf8");;)switch(P){case"hex":return O(this,D,G);case"utf8":case"utf-8":return V(this,D,G);case"ascii":return I(this,D,G);case"latin1":case"binary":return C(this,D,G);case"base64":return q(this,D,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,D,G);default:if(re)throw new TypeError("Unknown encoding: "+P);P=(P+"").toLowerCase(),re=!0}}function v(P,D,G){var re=P[D];P[D]=P[G],P[G]=re}function b(P,D,G,re,te){if(P.length===0)return-1;if(typeof G=="string"?(re=G,G=0):G>2147483647?G=2147483647:G<-2147483648&&(G=-2147483648),J(G=+G)&&(G=te?0:P.length-1),G<0&&(G=P.length+G),G>=P.length){if(te)return-1;G=P.length-1}else if(G<0){if(!te)return-1;G=0}if(typeof D=="string"&&(D=c.from(D,re)),c.isBuffer(D))return D.length===0?-1:y(P,D,G,re,te);if(typeof D=="number")return D&=255,typeof Uint8Array.prototype.indexOf=="function"?te?Uint8Array.prototype.indexOf.call(P,D,G):Uint8Array.prototype.lastIndexOf.call(P,D,G):y(P,[D],G,re,te);throw new TypeError("val must be string, number or Buffer")}function y(P,D,G,re,te){var ne,le=1,oe=P.length,ee=D.length;if(re!==void 0&&((re=String(re).toLowerCase())==="ucs2"||re==="ucs-2"||re==="utf16le"||re==="utf-16le")){if(P.length<2||D.length<2)return-1;le=2,oe/=2,ee/=2,G/=2}function Z(pe,fe){return le===1?pe[fe]:pe.readUInt16BE(fe*le)}if(te){var se=-1;for(ne=G;ne<oe;ne++)if(Z(P,ne)===Z(D,se===-1?0:ne-se)){if(se===-1&&(se=ne),ne-se+1===ee)return se*le}else se!==-1&&(ne-=ne-se),se=-1}else for(G+ee>oe&&(G=oe-ee),ne=G;ne>=0;ne--){for(var ie=!0,ue=0;ue<ee;ue++)if(Z(P,ne+ue)!==Z(D,ue)){ie=!1;break}if(ie)return ne}return-1}function k(P,D,G,re){G=Number(G)||0;var te=P.length-G;re?(re=Number(re))>te&&(re=te):re=te;var ne=D.length;re>ne/2&&(re=ne/2);for(var le=0;le<re;++le){var oe=parseInt(D.substr(2*le,2),16);if(J(oe))return le;P[G+le]=oe}return le}function N(P,D,G,re){return K(H(D,P.length-G),P,G,re)}function L(P,D,G,re){return K(function(te){for(var ne=[],le=0;le<te.length;++le)ne.push(255&te.charCodeAt(le));return ne}(D),P,G,re)}function F(P,D,G,re){return L(P,D,G,re)}function R(P,D,G,re){return K(z(D),P,G,re)}function B(P,D,G,re){return K(function(te,ne){for(var le,oe,ee,Z=[],se=0;se<te.length&&!((ne-=2)<0);++se)le=te.charCodeAt(se),oe=le>>8,ee=le%256,Z.push(ee),Z.push(oe);return Z}(D,P.length-G),P,G,re)}function q(P,D,G){return D===0&&G===P.length?i.fromByteArray(P):i.fromByteArray(P.slice(D,G))}function V(P,D,G){G=Math.min(P.length,G);for(var re=[],te=D;te<G;){var ne,le,oe,ee,Z=P[te],se=null,ie=Z>239?4:Z>223?3:Z>191?2:1;if(te+ie<=G)switch(ie){case 1:Z<128&&(se=Z);break;case 2:(192&(ne=P[te+1]))==128&&(ee=(31&Z)<<6|63&ne)>127&&(se=ee);break;case 3:ne=P[te+1],le=P[te+2],(192&ne)==128&&(192&le)==128&&(ee=(15&Z)<<12|(63&ne)<<6|63&le)>2047&&(ee<55296||ee>57343)&&(se=ee);break;case 4:ne=P[te+1],le=P[te+2],oe=P[te+3],(192&ne)==128&&(192&le)==128&&(192&oe)==128&&(ee=(15&Z)<<18|(63&ne)<<12|(63&le)<<6|63&oe)>65535&&ee<1114112&&(se=ee)}se===null?(se=65533,ie=1):se>65535&&(se-=65536,re.push(se>>>10&1023|55296),se=56320|1023&se),re.push(se),te+=ie}return function(ue){var pe=ue.length;if(pe<=4096)return String.fromCharCode.apply(String,ue);for(var fe="",ye=0;ye<pe;)fe+=String.fromCharCode.apply(String,ue.slice(ye,ye+=4096));return fe}(re)}s.kMaxLength=2147483647,c.TYPED_ARRAY_SUPPORT=function(){try{var P=new Uint8Array(1);return P.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},P.foo()===42}catch{return!1}}(),c.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),c.poolSize=8192,c.from=function(P,D,G){return u(P,D,G)},c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,c.alloc=function(P,D,G){return function(re,te,ne){return d(re),re<=0?l(re):te!==void 0?typeof ne=="string"?l(re).fill(te,ne):l(re).fill(te):l(re)}(P,D,G)},c.allocUnsafe=function(P){return h(P)},c.allocUnsafeSlow=function(P){return h(P)},c.isBuffer=function(P){return P!=null&&P._isBuffer===!0&&P!==c.prototype},c.compare=function(P,D){if(j(P,Uint8Array)&&(P=c.from(P,P.offset,P.byteLength)),j(D,Uint8Array)&&(D=c.from(D,D.offset,D.byteLength)),!c.isBuffer(P)||!c.isBuffer(D))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(P===D)return 0;for(var G=P.length,re=D.length,te=0,ne=Math.min(G,re);te<ne;++te)if(P[te]!==D[te]){G=P[te],re=D[te];break}return G<re?-1:re<G?1:0},c.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(P,D){if(!Array.isArray(P))throw new TypeError('"list" argument must be an Array of Buffers');if(P.length===0)return c.alloc(0);var G;if(D===void 0)for(D=0,G=0;G<P.length;++G)D+=P[G].length;var re=c.allocUnsafe(D),te=0;for(G=0;G<P.length;++G){var ne=P[G];if(j(ne,Uint8Array)&&(ne=c.from(ne)),!c.isBuffer(ne))throw new TypeError('"list" argument must be an Array of Buffers');ne.copy(re,te),te+=ne.length}return re},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var P=this.length;if(P%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var D=0;D<P;D+=2)v(this,D,D+1);return this},c.prototype.swap32=function(){var P=this.length;if(P%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var D=0;D<P;D+=4)v(this,D,D+3),v(this,D+1,D+2);return this},c.prototype.swap64=function(){var P=this.length;if(P%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var D=0;D<P;D+=8)v(this,D,D+7),v(this,D+1,D+6),v(this,D+2,D+5),v(this,D+3,D+4);return this},c.prototype.toString=function(){var P=this.length;return P===0?"":arguments.length===0?V(this,0,P):p.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(P){if(!c.isBuffer(P))throw new TypeError("Argument must be a Buffer");return this===P||c.compare(this,P)===0},c.prototype.inspect=function(){var P="",D=s.INSPECT_MAX_BYTES;return P=this.toString("hex",0,D).replace(/(.{2})/g,"$1 ").trim(),this.length>D&&(P+=" ... "),"<Buffer "+P+">"},c.prototype.compare=function(P,D,G,re,te){if(j(P,Uint8Array)&&(P=c.from(P,P.offset,P.byteLength)),!c.isBuffer(P))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof P);if(D===void 0&&(D=0),G===void 0&&(G=P?P.length:0),re===void 0&&(re=0),te===void 0&&(te=this.length),D<0||G>P.length||re<0||te>this.length)throw new RangeError("out of range index");if(re>=te&&D>=G)return 0;if(re>=te)return-1;if(D>=G)return 1;if(this===P)return 0;for(var ne=(te>>>=0)-(re>>>=0),le=(G>>>=0)-(D>>>=0),oe=Math.min(ne,le),ee=this.slice(re,te),Z=P.slice(D,G),se=0;se<oe;++se)if(ee[se]!==Z[se]){ne=ee[se],le=Z[se];break}return ne<le?-1:le<ne?1:0},c.prototype.includes=function(P,D,G){return this.indexOf(P,D,G)!==-1},c.prototype.indexOf=function(P,D,G){return b(this,P,D,G,!0)},c.prototype.lastIndexOf=function(P,D,G){return b(this,P,D,G,!1)},c.prototype.write=function(P,D,G,re){if(D===void 0)re="utf8",G=this.length,D=0;else if(G===void 0&&typeof D=="string")re=D,G=this.length,D=0;else{if(!isFinite(D))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");D>>>=0,isFinite(G)?(G>>>=0,re===void 0&&(re="utf8")):(re=G,G=void 0)}var te=this.length-D;if((G===void 0||G>te)&&(G=te),P.length>0&&(G<0||D<0)||D>this.length)throw new RangeError("Attempt to write outside buffer bounds");re||(re="utf8");for(var ne=!1;;)switch(re){case"hex":return k(this,P,D,G);case"utf8":case"utf-8":return N(this,P,D,G);case"ascii":return L(this,P,D,G);case"latin1":case"binary":return F(this,P,D,G);case"base64":return R(this,P,D,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,P,D,G);default:if(ne)throw new TypeError("Unknown encoding: "+re);re=(""+re).toLowerCase(),ne=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(P,D,G){var re="";G=Math.min(P.length,G);for(var te=D;te<G;++te)re+=String.fromCharCode(127&P[te]);return re}function C(P,D,G){var re="";G=Math.min(P.length,G);for(var te=D;te<G;++te)re+=String.fromCharCode(P[te]);return re}function O(P,D,G){var re=P.length;(!D||D<0)&&(D=0),(!G||G<0||G>re)&&(G=re);for(var te="",ne=D;ne<G;++ne)te+=A(P[ne]);return te}function E(P,D,G){for(var re=P.slice(D,G),te="",ne=0;ne<re.length;ne+=2)te+=String.fromCharCode(re[ne]+256*re[ne+1]);return te}function x(P,D,G){if(P%1!=0||P<0)throw new RangeError("offset is not uint");if(P+D>G)throw new RangeError("Trying to access beyond buffer length")}function w(P,D,G,re,te,ne){if(!c.isBuffer(P))throw new TypeError('"buffer" argument must be a Buffer instance');if(D>te||D<ne)throw new RangeError('"value" argument is out of bounds');if(G+re>P.length)throw new RangeError("Index out of range")}function _(P,D,G,re,te,ne){if(G+re>P.length)throw new RangeError("Index out of range");if(G<0)throw new RangeError("Index out of range")}function S(P,D,G,re,te){return D=+D,G>>>=0,te||_(P,0,G,4),o.write(P,D,G,re,23,4),G+4}function T(P,D,G,re,te){return D=+D,G>>>=0,te||_(P,0,G,8),o.write(P,D,G,re,52,8),G+8}c.prototype.slice=function(P,D){var G=this.length;(P=~~P)<0?(P+=G)<0&&(P=0):P>G&&(P=G),(D=D===void 0?G:~~D)<0?(D+=G)<0&&(D=0):D>G&&(D=G),D<P&&(D=P);var re=this.subarray(P,D);return re.__proto__=c.prototype,re},c.prototype.readUIntLE=function(P,D,G){P>>>=0,D>>>=0,G||x(P,D,this.length);for(var re=this[P],te=1,ne=0;++ne<D&&(te*=256);)re+=this[P+ne]*te;return re},c.prototype.readUIntBE=function(P,D,G){P>>>=0,D>>>=0,G||x(P,D,this.length);for(var re=this[P+--D],te=1;D>0&&(te*=256);)re+=this[P+--D]*te;return re},c.prototype.readUInt8=function(P,D){return P>>>=0,D||x(P,1,this.length),this[P]},c.prototype.readUInt16LE=function(P,D){return P>>>=0,D||x(P,2,this.length),this[P]|this[P+1]<<8},c.prototype.readUInt16BE=function(P,D){return P>>>=0,D||x(P,2,this.length),this[P]<<8|this[P+1]},c.prototype.readUInt32LE=function(P,D){return P>>>=0,D||x(P,4,this.length),(this[P]|this[P+1]<<8|this[P+2]<<16)+16777216*this[P+3]},c.prototype.readUInt32BE=function(P,D){return P>>>=0,D||x(P,4,this.length),16777216*this[P]+(this[P+1]<<16|this[P+2]<<8|this[P+3])},c.prototype.readIntLE=function(P,D,G){P>>>=0,D>>>=0,G||x(P,D,this.length);for(var re=this[P],te=1,ne=0;++ne<D&&(te*=256);)re+=this[P+ne]*te;return re>=(te*=128)&&(re-=Math.pow(2,8*D)),re},c.prototype.readIntBE=function(P,D,G){P>>>=0,D>>>=0,G||x(P,D,this.length);for(var re=D,te=1,ne=this[P+--re];re>0&&(te*=256);)ne+=this[P+--re]*te;return ne>=(te*=128)&&(ne-=Math.pow(2,8*D)),ne},c.prototype.readInt8=function(P,D){return P>>>=0,D||x(P,1,this.length),128&this[P]?-1*(255-this[P]+1):this[P]},c.prototype.readInt16LE=function(P,D){P>>>=0,D||x(P,2,this.length);var G=this[P]|this[P+1]<<8;return 32768&G?4294901760|G:G},c.prototype.readInt16BE=function(P,D){P>>>=0,D||x(P,2,this.length);var G=this[P+1]|this[P]<<8;return 32768&G?4294901760|G:G},c.prototype.readInt32LE=function(P,D){return P>>>=0,D||x(P,4,this.length),this[P]|this[P+1]<<8|this[P+2]<<16|this[P+3]<<24},c.prototype.readInt32BE=function(P,D){return P>>>=0,D||x(P,4,this.length),this[P]<<24|this[P+1]<<16|this[P+2]<<8|this[P+3]},c.prototype.readFloatLE=function(P,D){return P>>>=0,D||x(P,4,this.length),o.read(this,P,!0,23,4)},c.prototype.readFloatBE=function(P,D){return P>>>=0,D||x(P,4,this.length),o.read(this,P,!1,23,4)},c.prototype.readDoubleLE=function(P,D){return P>>>=0,D||x(P,8,this.length),o.read(this,P,!0,52,8)},c.prototype.readDoubleBE=function(P,D){return P>>>=0,D||x(P,8,this.length),o.read(this,P,!1,52,8)},c.prototype.writeUIntLE=function(P,D,G,re){P=+P,D>>>=0,G>>>=0,re||w(this,P,D,G,Math.pow(2,8*G)-1,0);var te=1,ne=0;for(this[D]=255&P;++ne<G&&(te*=256);)this[D+ne]=P/te&255;return D+G},c.prototype.writeUIntBE=function(P,D,G,re){P=+P,D>>>=0,G>>>=0,re||w(this,P,D,G,Math.pow(2,8*G)-1,0);var te=G-1,ne=1;for(this[D+te]=255&P;--te>=0&&(ne*=256);)this[D+te]=P/ne&255;return D+G},c.prototype.writeUInt8=function(P,D,G){return P=+P,D>>>=0,G||w(this,P,D,1,255,0),this[D]=255&P,D+1},c.prototype.writeUInt16LE=function(P,D,G){return P=+P,D>>>=0,G||w(this,P,D,2,65535,0),this[D]=255&P,this[D+1]=P>>>8,D+2},c.prototype.writeUInt16BE=function(P,D,G){return P=+P,D>>>=0,G||w(this,P,D,2,65535,0),this[D]=P>>>8,this[D+1]=255&P,D+2},c.prototype.writeUInt32LE=function(P,D,G){return P=+P,D>>>=0,G||w(this,P,D,4,4294967295,0),this[D+3]=P>>>24,this[D+2]=P>>>16,this[D+1]=P>>>8,this[D]=255&P,D+4},c.prototype.writeUInt32BE=function(P,D,G){return P=+P,D>>>=0,G||w(this,P,D,4,4294967295,0),this[D]=P>>>24,this[D+1]=P>>>16,this[D+2]=P>>>8,this[D+3]=255&P,D+4},c.prototype.writeIntLE=function(P,D,G,re){if(P=+P,D>>>=0,!re){var te=Math.pow(2,8*G-1);w(this,P,D,G,te-1,-te)}var ne=0,le=1,oe=0;for(this[D]=255&P;++ne<G&&(le*=256);)P<0&&oe===0&&this[D+ne-1]!==0&&(oe=1),this[D+ne]=(P/le>>0)-oe&255;return D+G},c.prototype.writeIntBE=function(P,D,G,re){if(P=+P,D>>>=0,!re){var te=Math.pow(2,8*G-1);w(this,P,D,G,te-1,-te)}var ne=G-1,le=1,oe=0;for(this[D+ne]=255&P;--ne>=0&&(le*=256);)P<0&&oe===0&&this[D+ne+1]!==0&&(oe=1),this[D+ne]=(P/le>>0)-oe&255;return D+G},c.prototype.writeInt8=function(P,D,G){return P=+P,D>>>=0,G||w(this,P,D,1,127,-128),P<0&&(P=255+P+1),this[D]=255&P,D+1},c.prototype.writeInt16LE=function(P,D,G){return P=+P,D>>>=0,G||w(this,P,D,2,32767,-32768),this[D]=255&P,this[D+1]=P>>>8,D+2},c.prototype.writeInt16BE=function(P,D,G){return P=+P,D>>>=0,G||w(this,P,D,2,32767,-32768),this[D]=P>>>8,this[D+1]=255&P,D+2},c.prototype.writeInt32LE=function(P,D,G){return P=+P,D>>>=0,G||w(this,P,D,4,2147483647,-2147483648),this[D]=255&P,this[D+1]=P>>>8,this[D+2]=P>>>16,this[D+3]=P>>>24,D+4},c.prototype.writeInt32BE=function(P,D,G){return P=+P,D>>>=0,G||w(this,P,D,4,2147483647,-2147483648),P<0&&(P=4294967295+P+1),this[D]=P>>>24,this[D+1]=P>>>16,this[D+2]=P>>>8,this[D+3]=255&P,D+4},c.prototype.writeFloatLE=function(P,D,G){return S(this,P,D,!0,G)},c.prototype.writeFloatBE=function(P,D,G){return S(this,P,D,!1,G)},c.prototype.writeDoubleLE=function(P,D,G){return T(this,P,D,!0,G)},c.prototype.writeDoubleBE=function(P,D,G){return T(this,P,D,!1,G)},c.prototype.copy=function(P,D,G,re){if(!c.isBuffer(P))throw new TypeError("argument should be a Buffer");if(G||(G=0),re||re===0||(re=this.length),D>=P.length&&(D=P.length),D||(D=0),re>0&&re<G&&(re=G),re===G||P.length===0||this.length===0)return 0;if(D<0)throw new RangeError("targetStart out of bounds");if(G<0||G>=this.length)throw new RangeError("Index out of range");if(re<0)throw new RangeError("sourceEnd out of bounds");re>this.length&&(re=this.length),P.length-D<re-G&&(re=P.length-D+G);var te=re-G;if(this===P&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(D,G,re);else if(this===P&&G<D&&D<re)for(var ne=te-1;ne>=0;--ne)P[ne+D]=this[ne+G];else Uint8Array.prototype.set.call(P,this.subarray(G,re),D);return te},c.prototype.fill=function(P,D,G,re){if(typeof P=="string"){if(typeof D=="string"?(re=D,D=0,G=this.length):typeof G=="string"&&(re=G,G=this.length),re!==void 0&&typeof re!="string")throw new TypeError("encoding must be a string");if(typeof re=="string"&&!c.isEncoding(re))throw new TypeError("Unknown encoding: "+re);if(P.length===1){var te=P.charCodeAt(0);(re==="utf8"&&te<128||re==="latin1")&&(P=te)}}else typeof P=="number"&&(P&=255);if(D<0||this.length<D||this.length<G)throw new RangeError("Out of range index");if(G<=D)return this;var ne;if(D>>>=0,G=G===void 0?this.length:G>>>0,P||(P=0),typeof P=="number")for(ne=D;ne<G;++ne)this[ne]=P;else{var le=c.isBuffer(P)?P:c.from(P,re),oe=le.length;if(oe===0)throw new TypeError('The value "'+P+'" is invalid for argument "value"');for(ne=0;ne<G-D;++ne)this[ne+D]=le[ne%oe]}return this};var U=/[^+/0-9A-Za-z-_]/g;function A(P){return P<16?"0"+P.toString(16):P.toString(16)}function H(P,D){var G;D=D||1/0;for(var re=P.length,te=null,ne=[],le=0;le<re;++le){if((G=P.charCodeAt(le))>55295&&G<57344){if(!te){if(G>56319){(D-=3)>-1&&ne.push(239,191,189);continue}if(le+1===re){(D-=3)>-1&&ne.push(239,191,189);continue}te=G;continue}if(G<56320){(D-=3)>-1&&ne.push(239,191,189),te=G;continue}G=65536+(te-55296<<10|G-56320)}else te&&(D-=3)>-1&&ne.push(239,191,189);if(te=null,G<128){if((D-=1)<0)break;ne.push(G)}else if(G<2048){if((D-=2)<0)break;ne.push(G>>6|192,63&G|128)}else if(G<65536){if((D-=3)<0)break;ne.push(G>>12|224,G>>6&63|128,63&G|128)}else{if(!(G<1114112))throw new Error("Invalid code point");if((D-=4)<0)break;ne.push(G>>18|240,G>>12&63|128,G>>6&63|128,63&G|128)}}return ne}function z(P){return i.toByteArray(function(D){if((D=(D=D.split("=")[0]).trim().replace(U,"")).length<2)return"";for(;D.length%4!=0;)D+="=";return D}(P))}function K(P,D,G,re){for(var te=0;te<re&&!(te+G>=D.length||te>=P.length);++te)D[te+G]=P[te];return te}function j(P,D){return P instanceof D||P!=null&&P.constructor!=null&&P.constructor.name!=null&&P.constructor.name===D.name}function J(P){return P!=P}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(e,n,s){var a=e("safe-buffer").Buffer,i=e("stream").Transform,o=e("string_decoder").StringDecoder;function l(c){i.call(this),this.hashMode=typeof c=="string",this.hashMode?this[c]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}e("inherits")(l,i),l.prototype.update=function(c,u,d){typeof c=="string"&&(c=a.from(c,u));var h=this._update(c);return this.hashMode?this:(d&&(h=this._toString(h,d)),h)},l.prototype.setAutoPadding=function(){},l.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},l.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},l.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},l.prototype._transform=function(c,u,d){var h;try{this.hashMode?this._update(c):this.push(this._update(c))}catch(f){h=f}finally{d(h)}},l.prototype._flush=function(c){var u;try{this.push(this.__final())}catch(d){u=d}c(u)},l.prototype._finalOrDigest=function(c){var u=this.__final()||a.alloc(0);return c&&(u=this._toString(u,c,!0)),u},l.prototype._toString=function(c,u,d){if(this._decoder||(this._decoder=new o(u),this._encoding=u),this._encoding!==u)throw new Error("can't switch encodings");var h=this._decoder.write(c);return d&&(h+=this._decoder.end()),h},n.exports=l},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(e,n,s){var a=e("../internals/is-callable"),i=e("../internals/try-to-string"),o=TypeError;n.exports=function(l){if(a(l))return l;throw new o(i(l)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(e,n,s){var a=e("../internals/is-constructor"),i=e("../internals/try-to-string"),o=TypeError;n.exports=function(l){if(a(l))return l;throw new o(i(l)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(e,n,s){var a=e("../internals/is-callable"),i=String,o=TypeError;n.exports=function(l){if(typeof l=="object"||a(l))return l;throw new o("Can't set "+i(l)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(e,n,s){var a=e("../internals/well-known-symbol"),i=e("../internals/object-create"),o=e("../internals/object-define-property").f,l=a("unscopables"),c=Array.prototype;c[l]===void 0&&o(c,l,{configurable:!0,value:i(null)}),n.exports=function(u){c[l][u]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(e,n,s){var a=e("../internals/object-is-prototype-of"),i=TypeError;n.exports=function(o,l){if(a(l,o))return o;throw new i("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(e,n,s){var a=e("../internals/is-object"),i=String,o=TypeError;n.exports=function(l){if(a(l))return l;throw new o(i(l)+" is not an object")}},{"../internals/is-object":289}],228:[function(e,n,s){var a=e("../internals/to-indexed-object"),i=e("../internals/to-absolute-index"),o=e("../internals/length-of-array-like"),l=function(c){return function(u,d,h){var f,g=a(u),m=o(g),p=i(h,m);if(c&&d!=d){for(;m>p;)if((f=g[p++])!=f)return!0}else for(;m>p;p++)if((c||p in g)&&g[p]===d)return c||p||0;return!c&&-1}};n.exports={includes:l(!0),indexOf:l(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(e,n,s){var a=e("../internals/function-bind-context"),i=e("../internals/function-uncurry-this"),o=e("../internals/indexed-object"),l=e("../internals/to-object"),c=e("../internals/length-of-array-like"),u=e("../internals/array-species-create"),d=i([].push),h=function(f){var g=f===1,m=f===2,p=f===3,v=f===4,b=f===6,y=f===7,k=f===5||b;return function(N,L,F,R){for(var B,q,V=l(N),I=o(V),C=a(L,F),O=c(I),E=0,x=R||u,w=g?x(N,O):m||y?x(N,0):void 0;O>E;E++)if((k||E in I)&&(q=C(B=I[E],E,V),f))if(g)w[E]=q;else if(q)switch(f){case 3:return!0;case 5:return B;case 6:return E;case 2:d(w,B)}else switch(f){case 4:return!1;case 7:d(w,B)}return b?-1:p||v?v:w}};n.exports={forEach:h(0),map:h(1),filter:h(2),some:h(3),every:h(4),find:h(5),findIndex:h(6),filterReject:h(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(e,n,s){var a=e("../internals/to-absolute-index"),i=e("../internals/length-of-array-like"),o=e("../internals/create-property"),l=Array,c=Math.max;n.exports=function(u,d,h){for(var f=i(u),g=a(d,f),m=a(h===void 0?f:h,f),p=l(c(m-g,0)),v=0;g<m;g++,v++)o(p,v,u[g]);return p.length=v,p}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(e,n,s){var a=e("../internals/function-uncurry-this");n.exports=a([].slice)},{"../internals/function-uncurry-this":268}],232:[function(e,n,s){var a=e("../internals/is-array"),i=e("../internals/is-constructor"),o=e("../internals/is-object"),l=e("../internals/well-known-symbol")("species"),c=Array;n.exports=function(u){var d;return a(u)&&(d=u.constructor,(i(d)&&(d===c||a(d.prototype))||o(d)&&(d=d[l])===null)&&(d=void 0)),d===void 0?c:d}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(e,n,s){var a=e("../internals/array-species-constructor");n.exports=function(i,o){return new(a(i))(o===0?0:o)}},{"../internals/array-species-constructor":232}],234:[function(e,n,s){var a=e("../internals/well-known-symbol")("iterator"),i=!1;try{var o=0,l={next:function(){return{done:!!o++}},return:function(){i=!0}};l[a]=function(){return this},Array.from(l,function(){throw 2})}catch{}n.exports=function(c,u){try{if(!u&&!i)return!1}catch{return!1}var d=!1;try{var h={};h[a]=function(){return{next:function(){return{done:d=!0}}}},c(h)}catch{}return d}},{"../internals/well-known-symbol":357}],235:[function(e,n,s){var a=e("../internals/function-uncurry-this"),i=a({}.toString),o=a("".slice);n.exports=function(l){return o(i(l),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(e,n,s){var a=e("../internals/to-string-tag-support"),i=e("../internals/is-callable"),o=e("../internals/classof-raw"),l=e("../internals/well-known-symbol")("toStringTag"),c=Object,u=o(function(){return arguments}())==="Arguments";n.exports=a?o:function(d){var h,f,g;return d===void 0?"Undefined":d===null?"Null":typeof(f=function(m,p){try{return m[p]}catch{}}(h=c(d),l))=="string"?f:u?o(h):(g=o(h))==="Object"&&i(h.callee)?"Arguments":g}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(e,n,s){var a=e("../internals/has-own-property"),i=e("../internals/own-keys"),o=e("../internals/object-get-own-property-descriptor"),l=e("../internals/object-define-property");n.exports=function(c,u,d){for(var h=i(u),f=l.f,g=o.f,m=0;m<h.length;m++){var p=h[m];a(c,p)||d&&a(d,p)||f(c,p,g(u,p))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(e,n,s){var a=e("../internals/well-known-symbol")("match");n.exports=function(i){var o=/./;try{"/./"[i](o)}catch{try{return o[a]=!1,"/./"[i](o)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(e,n,s){var a=e("../internals/fails");n.exports=!a(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})},{"../internals/fails":260}],240:[function(e,n,s){n.exports=function(a,i){return{value:a,done:i}}},{}],241:[function(e,n,s){var a=e("../internals/descriptors"),i=e("../internals/object-define-property"),o=e("../internals/create-property-descriptor");n.exports=a?function(l,c,u){return i.f(l,c,o(1,u))}:function(l,c,u){return l[c]=u,l}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(e,n,s){n.exports=function(a,i){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:i}}},{}],243:[function(e,n,s){var a=e("../internals/to-property-key"),i=e("../internals/object-define-property"),o=e("../internals/create-property-descriptor");n.exports=function(l,c,u){var d=a(c);d in l?i.f(l,d,o(0,u)):l[d]=u}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(e,n,s){var a=e("../internals/make-built-in"),i=e("../internals/object-define-property");n.exports=function(o,l,c){return c.get&&a(c.get,l,{getter:!0}),c.set&&a(c.set,l,{setter:!0}),i.f(o,l,c)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(e,n,s){var a=e("../internals/is-callable"),i=e("../internals/object-define-property"),o=e("../internals/make-built-in"),l=e("../internals/define-global-property");n.exports=function(c,u,d,h){h||(h={});var f=h.enumerable,g=h.name!==void 0?h.name:u;if(a(d)&&o(d,g,h),h.global)f?c[u]=d:l(u,d);else{try{h.unsafe?c[u]&&(f=!0):delete c[u]}catch{}f?c[u]=d:i.f(c,u,{value:d,enumerable:!1,configurable:!h.nonConfigurable,writable:!h.nonWritable})}return c}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(e,n,s){var a=e("../internals/global"),i=Object.defineProperty;n.exports=function(o,l){try{i(a,o,{value:l,configurable:!0,writable:!0})}catch{a[o]=l}return l}},{"../internals/global":274}],247:[function(e,n,s){var a=e("../internals/fails");n.exports=!a(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},{"../internals/fails":260}],248:[function(e,n,s){var a=typeof document=="object"&&document.all,i=a===void 0&&a!==void 0;n.exports={all:a,IS_HTMLDDA:i}},{}],249:[function(e,n,s){var a=e("../internals/global"),i=e("../internals/is-object"),o=a.document,l=i(o)&&i(o.createElement);n.exports=function(c){return l?o.createElement(c):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(e,n,s){var a=e("../internals/engine-is-deno"),i=e("../internals/engine-is-node");n.exports=!a&&!i&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(e,n,s){n.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(e,n,s){var a=e("../internals/engine-user-agent");n.exports=/ipad|iphone|ipod/i.test(a)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(e,n,s){var a=e("../internals/engine-user-agent");n.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(a)},{"../internals/engine-user-agent":256}],254:[function(e,n,s){var a=e("../internals/global"),i=e("../internals/classof-raw");n.exports=i(a.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(e,n,s){var a=e("../internals/engine-user-agent");n.exports=/web0s(?!.*chrome)/i.test(a)},{"../internals/engine-user-agent":256}],256:[function(e,n,s){n.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(e,n,s){var a,i,o=e("../internals/global"),l=e("../internals/engine-user-agent"),c=o.process,u=o.Deno,d=c&&c.versions||u&&u.version,h=d&&d.v8;h&&(i=(a=h.split("."))[0]>0&&a[0]<4?1:+(a[0]+a[1])),!i&&l&&(!(a=l.match(/Edge\/(\d+)/))||a[1]>=74)&&(a=l.match(/Chrome\/(\d+)/))&&(i=+a[1]),n.exports=i},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(e,n,s){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(e,n,s){var a=e("../internals/global"),i=e("../internals/object-get-own-property-descriptor").f,o=e("../internals/create-non-enumerable-property"),l=e("../internals/define-built-in"),c=e("../internals/define-global-property"),u=e("../internals/copy-constructor-properties"),d=e("../internals/is-forced");n.exports=function(h,f){var g,m,p,v,b,y=h.target,k=h.global,N=h.stat;if(g=k?a:N?a[y]||c(y,{}):(a[y]||{}).prototype)for(m in f){if(v=f[m],p=h.dontCallGetSet?(b=i(g,m))&&b.value:g[m],!d(k?m:y+(N?".":"#")+m,h.forced)&&p!==void 0){if(typeof v==typeof p)continue;u(v,p)}(h.sham||p&&p.sham)&&o(v,"sham",!0),l(g,m,v,h)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(e,n,s){n.exports=function(a){try{return!!a()}catch{return!0}}},{}],261:[function(e,n,s){var a=e("../internals/function-bind-native"),i=Function.prototype,o=i.apply,l=i.call;n.exports=typeof Reflect=="object"&&Reflect.apply||(a?l.bind(o):function(){return l.apply(o,arguments)})},{"../internals/function-bind-native":263}],262:[function(e,n,s){var a=e("../internals/function-uncurry-this-clause"),i=e("../internals/a-callable"),o=e("../internals/function-bind-native"),l=a(a.bind);n.exports=function(c,u){return i(c),u===void 0?c:o?l(c,u):function(){return c.apply(u,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(e,n,s){var a=e("../internals/fails");n.exports=!a(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")})},{"../internals/fails":260}],264:[function(e,n,s){var a=e("../internals/function-bind-native"),i=Function.prototype.call;n.exports=a?i.bind(i):function(){return i.apply(i,arguments)}},{"../internals/function-bind-native":263}],265:[function(e,n,s){var a=e("../internals/descriptors"),i=e("../internals/has-own-property"),o=Function.prototype,l=a&&Object.getOwnPropertyDescriptor,c=i(o,"name"),u=c&&(function(){}).name==="something",d=c&&(!a||a&&l(o,"name").configurable);n.exports={EXISTS:c,PROPER:u,CONFIGURABLE:d}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(e,n,s){var a=e("../internals/function-uncurry-this"),i=e("../internals/a-callable");n.exports=function(o,l,c){try{return a(i(Object.getOwnPropertyDescriptor(o,l)[c]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(e,n,s){var a=e("../internals/classof-raw"),i=e("../internals/function-uncurry-this");n.exports=function(o){if(a(o)==="Function")return i(o)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(e,n,s){var a=e("../internals/function-bind-native"),i=Function.prototype,o=i.call,l=a&&i.bind.bind(o,o);n.exports=a?l:function(c){return function(){return o.apply(c,arguments)}}},{"../internals/function-bind-native":263}],269:[function(e,n,s){var a=e("../internals/global"),i=e("../internals/is-callable"),o=function(l){return i(l)?l:void 0};n.exports=function(l,c){return arguments.length<2?o(a[l]):a[l]&&a[l][c]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(e,n,s){var a=e("../internals/classof"),i=e("../internals/get-method"),o=e("../internals/is-null-or-undefined"),l=e("../internals/iterators"),c=e("../internals/well-known-symbol")("iterator");n.exports=function(u){if(!o(u))return i(u,c)||i(u,"@@iterator")||l[a(u)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(e,n,s){var a=e("../internals/function-call"),i=e("../internals/a-callable"),o=e("../internals/an-object"),l=e("../internals/try-to-string"),c=e("../internals/get-iterator-method"),u=TypeError;n.exports=function(d,h){var f=arguments.length<2?c(d):h;if(i(f))return o(a(f,d));throw new u(l(d)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(e,n,s){var a=e("../internals/function-uncurry-this"),i=e("../internals/is-array"),o=e("../internals/is-callable"),l=e("../internals/classof-raw"),c=e("../internals/to-string"),u=a([].push);n.exports=function(d){if(o(d))return d;if(i(d)){for(var h=d.length,f=[],g=0;g<h;g++){var m=d[g];typeof m=="string"?u(f,m):typeof m!="number"&&l(m)!=="Number"&&l(m)!=="String"||u(f,c(m))}var p=f.length,v=!0;return function(b,y){if(v)return v=!1,y;if(i(this))return y;for(var k=0;k<p;k++)if(f[k]===b)return y}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(e,n,s){var a=e("../internals/a-callable"),i=e("../internals/is-null-or-undefined");n.exports=function(o,l){var c=o[l];return i(c)?void 0:a(c)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(e,n,s){(function(a){(function(){var i=function(o){return o&&o.Math===Math&&o};n.exports=i(typeof globalThis=="object"&&globalThis)||i(typeof window=="object"&&window)||i(typeof self=="object"&&self)||i(typeof a=="object"&&a)||function(){return this}()||this||Function("return this")()}).call(this)}).call(this,typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(e,n,s){var a=e("../internals/function-uncurry-this"),i=e("../internals/to-object"),o=a({}.hasOwnProperty);n.exports=Object.hasOwn||function(l,c){return o(i(l),c)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(e,n,s){n.exports={}},{}],277:[function(e,n,s){n.exports=function(a,i){try{arguments.length===1?console.error(a):console.error(a,i)}catch{}}},{}],278:[function(e,n,s){var a=e("../internals/get-built-in");n.exports=a("document","documentElement")},{"../internals/get-built-in":269}],279:[function(e,n,s){var a=e("../internals/descriptors"),i=e("../internals/fails"),o=e("../internals/document-create-element");n.exports=!a&&!i(function(){return Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a!==7})},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(e,n,s){var a=e("../internals/function-uncurry-this"),i=e("../internals/fails"),o=e("../internals/classof-raw"),l=Object,c=a("".split);n.exports=i(function(){return!l("z").propertyIsEnumerable(0)})?function(u){return o(u)==="String"?c(u,""):l(u)}:l},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(e,n,s){var a=e("../internals/function-uncurry-this"),i=e("../internals/is-callable"),o=e("../internals/shared-store"),l=a(Function.toString);i(o.inspectSource)||(o.inspectSource=function(c){return l(c)}),n.exports=o.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(e,n,s){var a,i,o,l=e("../internals/weak-map-basic-detection"),c=e("../internals/global"),u=e("../internals/is-object"),d=e("../internals/create-non-enumerable-property"),h=e("../internals/has-own-property"),f=e("../internals/shared-store"),g=e("../internals/shared-key"),m=e("../internals/hidden-keys"),p=c.TypeError,v=c.WeakMap;if(l||f.state){var b=f.state||(f.state=new v);b.get=b.get,b.has=b.has,b.set=b.set,a=function(k,N){if(b.has(k))throw new p("Object already initialized");return N.facade=k,b.set(k,N),N},i=function(k){return b.get(k)||{}},o=function(k){return b.has(k)}}else{var y=g("state");m[y]=!0,a=function(k,N){if(h(k,y))throw new p("Object already initialized");return N.facade=k,d(k,y,N),N},i=function(k){return h(k,y)?k[y]:{}},o=function(k){return h(k,y)}}n.exports={set:a,get:i,has:o,enforce:function(k){return o(k)?i(k):a(k,{})},getterFor:function(k){return function(N){var L;if(!u(N)||(L=i(N)).type!==k)throw new p("Incompatible receiver, "+k+" required");return L}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(e,n,s){var a=e("../internals/well-known-symbol"),i=e("../internals/iterators"),o=a("iterator"),l=Array.prototype;n.exports=function(c){return c!==void 0&&(i.Array===c||l[o]===c)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(e,n,s){var a=e("../internals/classof-raw");n.exports=Array.isArray||function(i){return a(i)==="Array"}},{"../internals/classof-raw":235}],285:[function(e,n,s){var a=e("../internals/document-all"),i=a.all;n.exports=a.IS_HTMLDDA?function(o){return typeof o=="function"||o===i}:function(o){return typeof o=="function"}},{"../internals/document-all":248}],286:[function(e,n,s){var a=e("../internals/function-uncurry-this"),i=e("../internals/fails"),o=e("../internals/is-callable"),l=e("../internals/classof"),c=e("../internals/get-built-in"),u=e("../internals/inspect-source"),d=function(){},h=[],f=c("Reflect","construct"),g=/^\s*(?:class|function)\b/,m=a(g.exec),p=!g.test(d),v=function(y){if(!o(y))return!1;try{return f(d,h,y),!0}catch{return!1}},b=function(y){if(!o(y))return!1;switch(l(y)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!m(g,u(y))}catch{return!0}};b.sham=!0,n.exports=!f||i(function(){var y;return v(v.call)||!v(Object)||!v(function(){y=!0})||y})?b:v},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(e,n,s){var a=e("../internals/fails"),i=e("../internals/is-callable"),o=/#|\.prototype\./,l=function(f,g){var m=u[c(f)];return m===h||m!==d&&(i(g)?a(g):!!g)},c=l.normalize=function(f){return String(f).replace(o,".").toLowerCase()},u=l.data={},d=l.NATIVE="N",h=l.POLYFILL="P";n.exports=l},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(e,n,s){n.exports=function(a){return a==null}},{}],289:[function(e,n,s){var a=e("../internals/is-callable"),i=e("../internals/document-all"),o=i.all;n.exports=i.IS_HTMLDDA?function(l){return typeof l=="object"?l!==null:a(l)||l===o}:function(l){return typeof l=="object"?l!==null:a(l)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(e,n,s){n.exports=!1},{}],291:[function(e,n,s){var a=e("../internals/is-object"),i=e("../internals/classof-raw"),o=e("../internals/well-known-symbol")("match");n.exports=function(l){var c;return a(l)&&((c=l[o])!==void 0?!!c:i(l)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(e,n,s){var a=e("../internals/get-built-in"),i=e("../internals/is-callable"),o=e("../internals/object-is-prototype-of"),l=e("../internals/use-symbol-as-uid"),c=Object;n.exports=l?function(u){return typeof u=="symbol"}:function(u){var d=a("Symbol");return i(d)&&o(d.prototype,c(u))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(e,n,s){var a=e("../internals/function-bind-context"),i=e("../internals/function-call"),o=e("../internals/an-object"),l=e("../internals/try-to-string"),c=e("../internals/is-array-iterator-method"),u=e("../internals/length-of-array-like"),d=e("../internals/object-is-prototype-of"),h=e("../internals/get-iterator"),f=e("../internals/get-iterator-method"),g=e("../internals/iterator-close"),m=TypeError,p=function(b,y){this.stopped=b,this.result=y},v=p.prototype;n.exports=function(b,y,k){var N,L,F,R,B,q,V,I=k&&k.that,C=!(!k||!k.AS_ENTRIES),O=!(!k||!k.IS_RECORD),E=!(!k||!k.IS_ITERATOR),x=!(!k||!k.INTERRUPTED),w=a(y,I),_=function(T){return N&&g(N,"normal",T),new p(!0,T)},S=function(T){return C?(o(T),x?w(T[0],T[1],_):w(T[0],T[1])):x?w(T,_):w(T)};if(O)N=b.iterator;else if(E)N=b;else{if(!(L=f(b)))throw new m(l(b)+" is not iterable");if(c(L)){for(F=0,R=u(b);R>F;F++)if((B=S(b[F]))&&d(v,B))return B;return new p(!1)}N=h(b,L)}for(q=O?b.next:N.next;!(V=i(q,N)).done;){try{B=S(V.value)}catch(T){g(N,"throw",T)}if(typeof B=="object"&&B&&d(v,B))return B}return new p(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(e,n,s){var a=e("../internals/function-call"),i=e("../internals/an-object"),o=e("../internals/get-method");n.exports=function(l,c,u){var d,h;i(l);try{if(!(d=o(l,"return"))){if(c==="throw")throw u;return u}d=a(d,l)}catch(f){h=!0,d=f}if(c==="throw")throw u;if(h)throw d;return i(d),u}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(e,n,s){var a=e("../internals/iterators-core").IteratorPrototype,i=e("../internals/object-create"),o=e("../internals/create-property-descriptor"),l=e("../internals/set-to-string-tag"),c=e("../internals/iterators"),u=function(){return this};n.exports=function(d,h,f,g){var m=h+" Iterator";return d.prototype=i(a,{next:o(+!g,f)}),l(d,m,!1,!0),c[m]=u,d}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/function-call"),o=e("../internals/is-pure"),l=e("../internals/function-name"),c=e("../internals/is-callable"),u=e("../internals/iterator-create-constructor"),d=e("../internals/object-get-prototype-of"),h=e("../internals/object-set-prototype-of"),f=e("../internals/set-to-string-tag"),g=e("../internals/create-non-enumerable-property"),m=e("../internals/define-built-in"),p=e("../internals/well-known-symbol"),v=e("../internals/iterators"),b=e("../internals/iterators-core"),y=l.PROPER,k=l.CONFIGURABLE,N=b.IteratorPrototype,L=b.BUGGY_SAFARI_ITERATORS,F=p("iterator"),R=function(){return this};n.exports=function(B,q,V,I,C,O,E){u(V,q,I);var x,w,_,S=function(j){if(j===C&&z)return z;if(!L&&j&&j in A)return A[j];switch(j){case"keys":case"values":case"entries":return function(){return new V(this,j)}}return function(){return new V(this)}},T=q+" Iterator",U=!1,A=B.prototype,H=A[F]||A["@@iterator"]||C&&A[C],z=!L&&H||S(C),K=q==="Array"&&A.entries||H;if(K&&(x=d(K.call(new B)))!==Object.prototype&&x.next&&(o||d(x)===N||(h?h(x,N):c(x[F])||m(x,F,R)),f(x,T,!0,!0),o&&(v[T]=R)),y&&C==="values"&&H&&H.name!=="values"&&(!o&&k?g(A,"name","values"):(U=!0,z=function(){return i(H,this)})),C)if(w={values:S("values"),keys:O?z:S("keys"),entries:S("entries")},E)for(_ in w)(L||U||!(_ in A))&&m(A,_,w[_]);else a({target:q,proto:!0,forced:L||U},w);return o&&!E||A[F]===z||m(A,F,z,{name:C}),v[q]=z,w}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(e,n,s){var a,i,o,l=e("../internals/fails"),c=e("../internals/is-callable"),u=e("../internals/is-object"),d=e("../internals/object-create"),h=e("../internals/object-get-prototype-of"),f=e("../internals/define-built-in"),g=e("../internals/well-known-symbol"),m=e("../internals/is-pure"),p=g("iterator"),v=!1;[].keys&&("next"in(o=[].keys())?(i=h(h(o)))!==Object.prototype&&(a=i):v=!0),!u(a)||l(function(){var b={};return a[p].call(b)!==b})?a={}:m&&(a=d(a)),c(a[p])||f(a,p,function(){return this}),n.exports={IteratorPrototype:a,BUGGY_SAFARI_ITERATORS:v}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(e,n,s){arguments[4][276][0].apply(s,arguments)},{dup:276}],299:[function(e,n,s){var a=e("../internals/to-length");n.exports=function(i){return a(i.length)}},{"../internals/to-length":343}],300:[function(e,n,s){var a=e("../internals/function-uncurry-this"),i=e("../internals/fails"),o=e("../internals/is-callable"),l=e("../internals/has-own-property"),c=e("../internals/descriptors"),u=e("../internals/function-name").CONFIGURABLE,d=e("../internals/inspect-source"),h=e("../internals/internal-state"),f=h.enforce,g=h.get,m=String,p=Object.defineProperty,v=a("".slice),b=a("".replace),y=a([].join),k=c&&!i(function(){return p(function(){},"length",{value:8}).length!==8}),N=String(String).split("String"),L=n.exports=function(F,R,B){v(m(R),0,7)==="Symbol("&&(R="["+b(m(R),/^Symbol\(([^)]*)\)/,"$1")+"]"),B&&B.getter&&(R="get "+R),B&&B.setter&&(R="set "+R),(!l(F,"name")||u&&F.name!==R)&&(c?p(F,"name",{value:R,configurable:!0}):F.name=R),k&&B&&l(B,"arity")&&F.length!==B.arity&&p(F,"length",{value:B.arity});try{B&&l(B,"constructor")&&B.constructor?c&&p(F,"prototype",{writable:!1}):F.prototype&&(F.prototype=void 0)}catch{}var q=f(F);return l(q,"source")||(q.source=y(N,typeof R=="string"?R:"")),F};Function.prototype.toString=L(function(){return o(this)&&g(this).source||d(this)},"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(e,n,s){var a=Math.ceil,i=Math.floor;n.exports=Math.trunc||function(o){var l=+o;return(l>0?i:a)(l)}},{}],302:[function(e,n,s){var a,i,o,l,c,u=e("../internals/global"),d=e("../internals/function-bind-context"),h=e("../internals/object-get-own-property-descriptor").f,f=e("../internals/task").set,g=e("../internals/queue"),m=e("../internals/engine-is-ios"),p=e("../internals/engine-is-ios-pebble"),v=e("../internals/engine-is-webos-webkit"),b=e("../internals/engine-is-node"),y=u.MutationObserver||u.WebKitMutationObserver,k=u.document,N=u.process,L=u.Promise,F=h(u,"queueMicrotask"),R=F&&F.value;if(!R){var B=new g,q=function(){var V,I;for(b&&(V=N.domain)&&V.exit();I=B.get();)try{I()}catch(C){throw B.head&&a(),C}V&&V.enter()};m||b||v||!y||!k?!p&&L&&L.resolve?((l=L.resolve(void 0)).constructor=L,c=d(l.then,l),a=function(){c(q)}):b?a=function(){N.nextTick(q)}:(f=d(f,u),a=function(){f(q)}):(i=!0,o=k.createTextNode(""),new y(q).observe(o,{characterData:!0}),a=function(){o.data=i=!i}),R=function(V){B.head||a(),B.add(V)}}n.exports=R},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(e,n,s){var a=e("../internals/a-callable"),i=TypeError,o=function(l){var c,u;this.promise=new l(function(d,h){if(c!==void 0||u!==void 0)throw new i("Bad Promise constructor");c=d,u=h}),this.resolve=a(c),this.reject=a(u)};n.exports.f=function(l){return new o(l)}},{"../internals/a-callable":222}],304:[function(e,n,s){var a=e("../internals/is-regexp"),i=TypeError;n.exports=function(o){if(a(o))throw new i("The method doesn't accept regular expressions");return o}},{"../internals/is-regexp":291}],305:[function(e,n,s){var a=e("../internals/descriptors"),i=e("../internals/function-uncurry-this"),o=e("../internals/function-call"),l=e("../internals/fails"),c=e("../internals/object-keys"),u=e("../internals/object-get-own-property-symbols"),d=e("../internals/object-property-is-enumerable"),h=e("../internals/to-object"),f=e("../internals/indexed-object"),g=Object.assign,m=Object.defineProperty,p=i([].concat);n.exports=!g||l(function(){if(a&&g({b:1},g(m({},"a",{enumerable:!0,get:function(){m(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var v={},b={},y=Symbol("assign detection");return v[y]=7,"abcdefghijklmnopqrst".split("").forEach(function(k){b[k]=k}),g({},v)[y]!==7||c(g({},b)).join("")!=="abcdefghijklmnopqrst"})?function(v,b){for(var y=h(v),k=arguments.length,N=1,L=u.f,F=d.f;k>N;)for(var R,B=f(arguments[N++]),q=L?p(c(B),L(B)):c(B),V=q.length,I=0;V>I;)R=q[I++],a&&!o(F,B,R)||(y[R]=B[R]);return y}:g},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(e,n,s){var a,i=e("../internals/an-object"),o=e("../internals/object-define-properties"),l=e("../internals/enum-bug-keys"),c=e("../internals/hidden-keys"),u=e("../internals/html"),d=e("../internals/document-create-element"),h=e("../internals/shared-key"),f=h("IE_PROTO"),g=function(){},m=function(b){return"<script>"+b+"<\/script>"},p=function(b){b.write(m("")),b.close();var y=b.parentWindow.Object;return b=null,y},v=function(){try{a=new ActiveXObject("htmlfile")}catch{}var b,y;v=typeof document<"u"?document.domain&&a?p(a):((y=d("iframe")).style.display="none",u.appendChild(y),y.src="javascript:",(b=y.contentWindow.document).open(),b.write(m("document.F=Object")),b.close(),b.F):p(a);for(var k=l.length;k--;)delete v.prototype[l[k]];return v()};c[f]=!0,n.exports=Object.create||function(b,y){var k;return b!==null?(g.prototype=i(b),k=new g,g.prototype=null,k[f]=b):k=v(),y===void 0?k:o.f(k,y)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(e,n,s){var a=e("../internals/descriptors"),i=e("../internals/v8-prototype-define-bug"),o=e("../internals/object-define-property"),l=e("../internals/an-object"),c=e("../internals/to-indexed-object"),u=e("../internals/object-keys");s.f=a&&!i?Object.defineProperties:function(d,h){l(d);for(var f,g=c(h),m=u(h),p=m.length,v=0;p>v;)o.f(d,f=m[v++],g[f]);return d}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(e,n,s){var a=e("../internals/descriptors"),i=e("../internals/ie8-dom-define"),o=e("../internals/v8-prototype-define-bug"),l=e("../internals/an-object"),c=e("../internals/to-property-key"),u=TypeError,d=Object.defineProperty,h=Object.getOwnPropertyDescriptor;s.f=a?o?function(f,g,m){if(l(f),g=c(g),l(m),typeof f=="function"&&g==="prototype"&&"value"in m&&"writable"in m&&!m.writable){var p=h(f,g);p&&p.writable&&(f[g]=m.value,m={configurable:"configurable"in m?m.configurable:p.configurable,enumerable:"enumerable"in m?m.enumerable:p.enumerable,writable:!1})}return d(f,g,m)}:d:function(f,g,m){if(l(f),g=c(g),l(m),i)try{return d(f,g,m)}catch{}if("get"in m||"set"in m)throw new u("Accessors not supported");return"value"in m&&(f[g]=m.value),f}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(e,n,s){var a=e("../internals/descriptors"),i=e("../internals/function-call"),o=e("../internals/object-property-is-enumerable"),l=e("../internals/create-property-descriptor"),c=e("../internals/to-indexed-object"),u=e("../internals/to-property-key"),d=e("../internals/has-own-property"),h=e("../internals/ie8-dom-define"),f=Object.getOwnPropertyDescriptor;s.f=a?f:function(g,m){if(g=c(g),m=u(m),h)try{return f(g,m)}catch{}if(d(g,m))return l(!i(o.f,g,m),g[m])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(e,n,s){var a=e("../internals/classof-raw"),i=e("../internals/to-indexed-object"),o=e("../internals/object-get-own-property-names").f,l=e("../internals/array-slice-simple"),c=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(u){return c&&a(u)==="Window"?function(d){try{return o(d)}catch{return l(c)}}(u):o(i(u))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(e,n,s){var a=e("../internals/object-keys-internal"),i=e("../internals/enum-bug-keys").concat("length","prototype");s.f=Object.getOwnPropertyNames||function(o){return a(o,i)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(e,n,s){s.f=Object.getOwnPropertySymbols},{}],313:[function(e,n,s){var a=e("../internals/has-own-property"),i=e("../internals/is-callable"),o=e("../internals/to-object"),l=e("../internals/shared-key"),c=e("../internals/correct-prototype-getter"),u=l("IE_PROTO"),d=Object,h=d.prototype;n.exports=c?d.getPrototypeOf:function(f){var g=o(f);if(a(g,u))return g[u];var m=g.constructor;return i(m)&&g instanceof m?m.prototype:g instanceof d?h:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(e,n,s){var a=e("../internals/function-uncurry-this");n.exports=a({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(e,n,s){var a=e("../internals/function-uncurry-this"),i=e("../internals/has-own-property"),o=e("../internals/to-indexed-object"),l=e("../internals/array-includes").indexOf,c=e("../internals/hidden-keys"),u=a([].push);n.exports=function(d,h){var f,g=o(d),m=0,p=[];for(f in g)!i(c,f)&&i(g,f)&&u(p,f);for(;h.length>m;)i(g,f=h[m++])&&(~l(p,f)||u(p,f));return p}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(e,n,s){var a=e("../internals/object-keys-internal"),i=e("../internals/enum-bug-keys");n.exports=Object.keys||function(o){return a(o,i)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(e,n,s){var a={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!a.call({1:2},1);s.f=o?function(l){var c=i(this,l);return!!c&&c.enumerable}:a},{}],318:[function(e,n,s){var a=e("../internals/function-uncurry-this-accessor"),i=e("../internals/an-object"),o=e("../internals/a-possible-prototype");n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var l,c=!1,u={};try{(l=a(Object.prototype,"__proto__","set"))(u,[]),c=u instanceof Array}catch{}return function(d,h){return i(d),o(h),c?l(d,h):d.__proto__=h,d}}():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(e,n,s){var a=e("../internals/descriptors"),i=e("../internals/fails"),o=e("../internals/function-uncurry-this"),l=e("../internals/object-get-prototype-of"),c=e("../internals/object-keys"),u=e("../internals/to-indexed-object"),d=o(e("../internals/object-property-is-enumerable").f),h=o([].push),f=a&&i(function(){var m=Object.create(null);return m[2]=2,!d(m,2)}),g=function(m){return function(p){for(var v,b=u(p),y=c(b),k=f&&l(b)===null,N=y.length,L=0,F=[];N>L;)v=y[L++],a&&!(k?v in b:d(b,v))||h(F,m?[v,b[v]]:b[v]);return F}};n.exports={entries:g(!0),values:g(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(e,n,s){var a=e("../internals/function-call"),i=e("../internals/is-callable"),o=e("../internals/is-object"),l=TypeError;n.exports=function(c,u){var d,h;if(u==="string"&&i(d=c.toString)&&!o(h=a(d,c))||i(d=c.valueOf)&&!o(h=a(d,c))||u!=="string"&&i(d=c.toString)&&!o(h=a(d,c)))return h;throw new l("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(e,n,s){var a=e("../internals/get-built-in"),i=e("../internals/function-uncurry-this"),o=e("../internals/object-get-own-property-names"),l=e("../internals/object-get-own-property-symbols"),c=e("../internals/an-object"),u=i([].concat);n.exports=a("Reflect","ownKeys")||function(d){var h=o.f(c(d)),f=l.f;return f?u(h,f(d)):h}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(e,n,s){var a=e("../internals/global");n.exports=a},{"../internals/global":274}],323:[function(e,n,s){n.exports=function(a){try{return{error:!1,value:a()}}catch(i){return{error:!0,value:i}}}},{}],324:[function(e,n,s){var a=e("../internals/global"),i=e("../internals/promise-native-constructor"),o=e("../internals/is-callable"),l=e("../internals/is-forced"),c=e("../internals/inspect-source"),u=e("../internals/well-known-symbol"),d=e("../internals/engine-is-browser"),h=e("../internals/engine-is-deno"),f=e("../internals/is-pure"),g=e("../internals/engine-v8-version"),m=i&&i.prototype,p=u("species"),v=!1,b=o(a.PromiseRejectionEvent),y=l("Promise",function(){var k=c(i),N=k!==String(i);if(!N&&g===66||f&&(!m.catch||!m.finally))return!0;if(!g||g<51||!/native code/.test(k)){var L=new i(function(R){R(1)}),F=function(R){R(function(){},function(){})};if((L.constructor={})[p]=F,!(v=L.then(function(){})instanceof F))return!0}return!N&&(d||h)&&!b});n.exports={CONSTRUCTOR:y,REJECTION_EVENT:b,SUBCLASSING:v}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(e,n,s){var a=e("../internals/global");n.exports=a.Promise},{"../internals/global":274}],326:[function(e,n,s){var a=e("../internals/an-object"),i=e("../internals/is-object"),o=e("../internals/new-promise-capability");n.exports=function(l,c){if(a(l),i(c)&&c.constructor===l)return c;var u=o.f(l);return(0,u.resolve)(c),u.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(e,n,s){var a=e("../internals/promise-native-constructor"),i=e("../internals/check-correctness-of-iteration"),o=e("../internals/promise-constructor-detection").CONSTRUCTOR;n.exports=o||!i(function(l){a.all(l).then(void 0,function(){})})},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(e,n,s){var a=function(){this.head=null,this.tail=null};a.prototype={add:function(i){var o={item:i,next:null},l=this.tail;l?l.next=o:this.head=o,this.tail=o},get:function(){var i=this.head;if(i)return(this.head=i.next)===null&&(this.tail=null),i.item}},n.exports=a},{}],329:[function(e,n,s){var a=e("../internals/is-null-or-undefined"),i=TypeError;n.exports=function(o){if(a(o))throw new i("Can't call method on "+o);return o}},{"../internals/is-null-or-undefined":288}],330:[function(e,n,s){var a=e("../internals/get-built-in"),i=e("../internals/define-built-in-accessor"),o=e("../internals/well-known-symbol"),l=e("../internals/descriptors"),c=o("species");n.exports=function(u){var d=a(u);l&&d&&!d[c]&&i(d,c,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(e,n,s){var a=e("../internals/object-define-property").f,i=e("../internals/has-own-property"),o=e("../internals/well-known-symbol")("toStringTag");n.exports=function(l,c,u){l&&!u&&(l=l.prototype),l&&!i(l,o)&&a(l,o,{configurable:!0,value:c})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(e,n,s){var a=e("../internals/shared"),i=e("../internals/uid"),o=a("keys");n.exports=function(l){return o[l]||(o[l]=i(l))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(e,n,s){var a=e("../internals/global"),i=e("../internals/define-global-property"),o=a["__core-js_shared__"]||i("__core-js_shared__",{});n.exports=o},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(e,n,s){var a=e("../internals/is-pure"),i=e("../internals/shared-store");(n.exports=function(o,l){return i[o]||(i[o]=l!==void 0?l:{})})("versions",[]).push({version:"3.33.0",mode:a?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(e,n,s){var a=e("../internals/an-object"),i=e("../internals/a-constructor"),o=e("../internals/is-null-or-undefined"),l=e("../internals/well-known-symbol")("species");n.exports=function(c,u){var d,h=a(c).constructor;return h===void 0||o(d=a(h)[l])?u:i(d)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(e,n,s){var a=e("../internals/engine-v8-version"),i=e("../internals/fails"),o=e("../internals/global").String;n.exports=!!Object.getOwnPropertySymbols&&!i(function(){var l=Symbol("symbol detection");return!o(l)||!(Object(l)instanceof Symbol)||!Symbol.sham&&a&&a<41})},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(e,n,s){var a=e("../internals/function-call"),i=e("../internals/get-built-in"),o=e("../internals/well-known-symbol"),l=e("../internals/define-built-in");n.exports=function(){var c=i("Symbol"),u=c&&c.prototype,d=u&&u.valueOf,h=o("toPrimitive");u&&!u[h]&&l(u,h,function(f){return a(d,this)},{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(e,n,s){var a=e("../internals/symbol-constructor-detection");n.exports=a&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(e,n,s){var a,i,o,l,c=e("../internals/global"),u=e("../internals/function-apply"),d=e("../internals/function-bind-context"),h=e("../internals/is-callable"),f=e("../internals/has-own-property"),g=e("../internals/fails"),m=e("../internals/html"),p=e("../internals/array-slice"),v=e("../internals/document-create-element"),b=e("../internals/validate-arguments-length"),y=e("../internals/engine-is-ios"),k=e("../internals/engine-is-node"),N=c.setImmediate,L=c.clearImmediate,F=c.process,R=c.Dispatch,B=c.Function,q=c.MessageChannel,V=c.String,I=0,C={};g(function(){a=c.location});var O=function(_){if(f(C,_)){var S=C[_];delete C[_],S()}},E=function(_){return function(){O(_)}},x=function(_){O(_.data)},w=function(_){c.postMessage(V(_),a.protocol+"//"+a.host)};N&&L||(N=function(_){b(arguments.length,1);var S=h(_)?_:B(_),T=p(arguments,1);return C[++I]=function(){u(S,void 0,T)},i(I),I},L=function(_){delete C[_]},k?i=function(_){F.nextTick(E(_))}:R&&R.now?i=function(_){R.now(E(_))}:q&&!y?(l=(o=new q).port2,o.port1.onmessage=x,i=d(l.postMessage,l)):c.addEventListener&&h(c.postMessage)&&!c.importScripts&&a&&a.protocol!=="file:"&&!g(w)?(i=w,c.addEventListener("message",x,!1)):i="onreadystatechange"in v("script")?function(_){m.appendChild(v("script")).onreadystatechange=function(){m.removeChild(this),O(_)}}:function(_){setTimeout(E(_),0)}),n.exports={set:N,clear:L}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(e,n,s){var a=e("../internals/to-integer-or-infinity"),i=Math.max,o=Math.min;n.exports=function(l,c){var u=a(l);return u<0?i(u+c,0):o(u,c)}},{"../internals/to-integer-or-infinity":342}],341:[function(e,n,s){var a=e("../internals/indexed-object"),i=e("../internals/require-object-coercible");n.exports=function(o){return a(i(o))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(e,n,s){var a=e("../internals/math-trunc");n.exports=function(i){var o=+i;return o!=o||o===0?0:a(o)}},{"../internals/math-trunc":301}],343:[function(e,n,s){var a=e("../internals/to-integer-or-infinity"),i=Math.min;n.exports=function(o){return o>0?i(a(o),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(e,n,s){var a=e("../internals/require-object-coercible"),i=Object;n.exports=function(o){return i(a(o))}},{"../internals/require-object-coercible":329}],345:[function(e,n,s){var a=e("../internals/function-call"),i=e("../internals/is-object"),o=e("../internals/is-symbol"),l=e("../internals/get-method"),c=e("../internals/ordinary-to-primitive"),u=e("../internals/well-known-symbol"),d=TypeError,h=u("toPrimitive");n.exports=function(f,g){if(!i(f)||o(f))return f;var m,p=l(f,h);if(p){if(g===void 0&&(g="default"),m=a(p,f,g),!i(m)||o(m))return m;throw new d("Can't convert object to primitive value")}return g===void 0&&(g="number"),c(f,g)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(e,n,s){var a=e("../internals/to-primitive"),i=e("../internals/is-symbol");n.exports=function(o){var l=a(o,"string");return i(l)?l:l+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(e,n,s){var a={};a[e("../internals/well-known-symbol")("toStringTag")]="z",n.exports=String(a)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(e,n,s){var a=e("../internals/classof"),i=String;n.exports=function(o){if(a(o)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return i(o)}},{"../internals/classof":236}],349:[function(e,n,s){var a=String;n.exports=function(i){try{return a(i)}catch{return"Object"}}},{}],350:[function(e,n,s){var a=e("../internals/function-uncurry-this"),i=0,o=Math.random(),l=a(1 .toString);n.exports=function(c){return"Symbol("+(c===void 0?"":c)+")_"+l(++i+o,36)}},{"../internals/function-uncurry-this":268}],351:[function(e,n,s){var a=e("../internals/symbol-constructor-detection");n.exports=a&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(e,n,s){var a=e("../internals/descriptors"),i=e("../internals/fails");n.exports=a&&i(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(e,n,s){var a=TypeError;n.exports=function(i,o){if(i<o)throw new a("Not enough arguments");return i}},{}],354:[function(e,n,s){var a=e("../internals/global"),i=e("../internals/is-callable"),o=a.WeakMap;n.exports=i(o)&&/native code/.test(String(o))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(e,n,s){var a=e("../internals/path"),i=e("../internals/has-own-property"),o=e("../internals/well-known-symbol-wrapped"),l=e("../internals/object-define-property").f;n.exports=function(c){var u=a.Symbol||(a.Symbol={});i(u,c)||l(u,c,{value:o.f(c)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(e,n,s){var a=e("../internals/well-known-symbol");s.f=a},{"../internals/well-known-symbol":357}],357:[function(e,n,s){var a=e("../internals/global"),i=e("../internals/shared"),o=e("../internals/has-own-property"),l=e("../internals/uid"),c=e("../internals/symbol-constructor-detection"),u=e("../internals/use-symbol-as-uid"),d=a.Symbol,h=i("wks"),f=u?d.for||d:d&&d.withoutSetter||l;n.exports=function(g){return o(h,g)||(h[g]=c&&o(d,g)?d[g]:f("Symbol."+g)),h[g]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/array-iteration").findIndex,o=e("../internals/add-to-unscopables"),l=!0;"findIndex"in[]&&Array(1).findIndex(function(){l=!1}),a({target:"Array",proto:!0,forced:l},{findIndex:function(c){return i(this,c,arguments.length>1?arguments[1]:void 0)}}),o("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/array-iteration").find,o=e("../internals/add-to-unscopables"),l=!0;"find"in[]&&Array(1).find(function(){l=!1}),a({target:"Array",proto:!0,forced:l},{find:function(c){return i(this,c,arguments.length>1?arguments[1]:void 0)}}),o("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/array-includes").includes,o=e("../internals/fails"),l=e("../internals/add-to-unscopables");a({target:"Array",proto:!0,forced:o(function(){return!Array(1).includes()})},{includes:function(c){return i(this,c,arguments.length>1?arguments[1]:void 0)}}),l("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(e,n,s){var a=e("../internals/to-indexed-object"),i=e("../internals/add-to-unscopables"),o=e("../internals/iterators"),l=e("../internals/internal-state"),c=e("../internals/object-define-property").f,u=e("../internals/iterator-define"),d=e("../internals/create-iter-result-object"),h=e("../internals/is-pure"),f=e("../internals/descriptors"),g=l.set,m=l.getterFor("Array Iterator");n.exports=u(Array,"Array",function(v,b){g(this,{type:"Array Iterator",target:a(v),index:0,kind:b})},function(){var v=m(this),b=v.target,y=v.kind,k=v.index++;if(!b||k>=b.length)return v.target=void 0,d(void 0,!0);switch(y){case"keys":return d(k,!1);case"values":return d(b[k],!1)}return d([k,b[k]],!1)},"values");var p=o.Arguments=o.Array;if(i("keys"),i("values"),i("entries"),!h&&f&&p.name!=="values")try{c(p,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/get-built-in"),o=e("../internals/function-apply"),l=e("../internals/function-call"),c=e("../internals/function-uncurry-this"),u=e("../internals/fails"),d=e("../internals/is-callable"),h=e("../internals/is-symbol"),f=e("../internals/array-slice"),g=e("../internals/get-json-replacer-function"),m=e("../internals/symbol-constructor-detection"),p=String,v=i("JSON","stringify"),b=c(/./.exec),y=c("".charAt),k=c("".charCodeAt),N=c("".replace),L=c(1 .toString),F=/[\uD800-\uDFFF]/g,R=/^[\uD800-\uDBFF]$/,B=/^[\uDC00-\uDFFF]$/,q=!m||u(function(){var O=i("Symbol")("stringify detection");return v([O])!=="[null]"||v({a:O})!=="{}"||v(Object(O))!=="{}"}),V=u(function(){return v("\uDF06\uD834")!=='"\\udf06\\ud834"'||v("\uDEAD")!=='"\\udead"'}),I=function(O,E){var x=f(arguments),w=g(E);if(d(w)||O!==void 0&&!h(O))return x[1]=function(_,S){if(d(w)&&(S=l(w,this,p(_),S)),!h(S))return S},o(v,null,x)},C=function(O,E,x){var w=y(x,E-1),_=y(x,E+1);return b(R,O)&&!b(B,_)||b(B,O)&&!b(R,w)?"\\u"+L(k(O,0),16):O};v&&a({target:"JSON",stat:!0,arity:3,forced:q||V},{stringify:function(O,E,x){var w=f(arguments),_=o(q?I:v,null,w);return V&&typeof _=="string"?N(_,F,C):_}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(e,n,s){e("../internals/export")({target:"Number",stat:!0},{isNaN:function(a){return a!=a}})},{"../internals/export":259}],364:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/object-assign");a({target:"Object",stat:!0,arity:2,forced:Object.assign!==i},{assign:i})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/symbol-constructor-detection"),o=e("../internals/fails"),l=e("../internals/object-get-own-property-symbols"),c=e("../internals/to-object");a({target:"Object",stat:!0,forced:!i||o(function(){l.f(1)})},{getOwnPropertySymbols:function(u){var d=l.f;return d?d(c(u)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/to-object"),o=e("../internals/object-keys");a({target:"Object",stat:!0,forced:e("../internals/fails")(function(){o(1)})},{keys:function(l){return o(i(l))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/object-to-array").values;a({target:"Object",stat:!0},{values:function(o){return i(o)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/function-call"),o=e("../internals/a-callable"),l=e("../internals/new-promise-capability"),c=e("../internals/perform"),u=e("../internals/iterate");a({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{all:function(d){var h=this,f=l.f(h),g=f.resolve,m=f.reject,p=c(function(){var v=o(h.resolve),b=[],y=0,k=1;u(d,function(N){var L=y++,F=!1;k++,i(v,h,N).then(function(R){F||(F=!0,b[L]=R,--k||g(b))},m)}),--k||g(b)});return p.error&&m(p.value),f.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/is-pure"),o=e("../internals/promise-constructor-detection").CONSTRUCTOR,l=e("../internals/promise-native-constructor"),c=e("../internals/get-built-in"),u=e("../internals/is-callable"),d=e("../internals/define-built-in"),h=l&&l.prototype;if(a({target:"Promise",proto:!0,forced:o,real:!0},{catch:function(g){return this.then(void 0,g)}}),!i&&u(l)){var f=c("Promise").prototype.catch;h.catch!==f&&d(h,"catch",f,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(e,n,s){var a,i,o,l=e("../internals/export"),c=e("../internals/is-pure"),u=e("../internals/engine-is-node"),d=e("../internals/global"),h=e("../internals/function-call"),f=e("../internals/define-built-in"),g=e("../internals/object-set-prototype-of"),m=e("../internals/set-to-string-tag"),p=e("../internals/set-species"),v=e("../internals/a-callable"),b=e("../internals/is-callable"),y=e("../internals/is-object"),k=e("../internals/an-instance"),N=e("../internals/species-constructor"),L=e("../internals/task").set,F=e("../internals/microtask"),R=e("../internals/host-report-errors"),B=e("../internals/perform"),q=e("../internals/queue"),V=e("../internals/internal-state"),I=e("../internals/promise-native-constructor"),C=e("../internals/promise-constructor-detection"),O=e("../internals/new-promise-capability"),E=C.CONSTRUCTOR,x=C.REJECTION_EVENT,w=C.SUBCLASSING,_=V.getterFor("Promise"),S=V.set,T=I&&I.prototype,U=I,A=T,H=d.TypeError,z=d.document,K=d.process,j=O.f,J=j,P=!!(z&&z.createEvent&&d.dispatchEvent),D=function(ie){var ue;return!(!y(ie)||!b(ue=ie.then))&&ue},G=function(ie,ue){var pe,fe,ye,Te=ue.value,Pe=ue.state===1,je=Pe?ie.ok:ie.fail,qe=ie.resolve,We=ie.reject,at=ie.domain;try{je?(Pe||(ue.rejection===2&&oe(ue),ue.rejection=1),je===!0?pe=Te:(at&&at.enter(),pe=je(Te),at&&(at.exit(),ye=!0)),pe===ie.promise?We(new H("Promise-chain cycle")):(fe=D(pe))?h(fe,pe,qe,We):qe(pe)):We(Te)}catch(Ye){at&&!ye&&at.exit(),We(Ye)}},re=function(ie,ue){ie.notified||(ie.notified=!0,F(function(){for(var pe,fe=ie.reactions;pe=fe.get();)G(pe,ie);ie.notified=!1,ue&&!ie.rejection&&ne(ie)}))},te=function(ie,ue,pe){var fe,ye;P?((fe=z.createEvent("Event")).promise=ue,fe.reason=pe,fe.initEvent(ie,!1,!0),d.dispatchEvent(fe)):fe={promise:ue,reason:pe},!x&&(ye=d["on"+ie])?ye(fe):ie==="unhandledrejection"&&R("Unhandled promise rejection",pe)},ne=function(ie){h(L,d,function(){var ue,pe=ie.facade,fe=ie.value;if(le(ie)&&(ue=B(function(){u?K.emit("unhandledRejection",fe,pe):te("unhandledrejection",pe,fe)}),ie.rejection=u||le(ie)?2:1,ue.error))throw ue.value})},le=function(ie){return ie.rejection!==1&&!ie.parent},oe=function(ie){h(L,d,function(){var ue=ie.facade;u?K.emit("rejectionHandled",ue):te("rejectionhandled",ue,ie.value)})},ee=function(ie,ue,pe){return function(fe){ie(ue,fe,pe)}},Z=function(ie,ue,pe){ie.done||(ie.done=!0,pe&&(ie=pe),ie.value=ue,ie.state=2,re(ie,!0))},se=function(ie,ue,pe){if(!ie.done){ie.done=!0,pe&&(ie=pe);try{if(ie.facade===ue)throw new H("Promise can't be resolved itself");var fe=D(ue);fe?F(function(){var ye={done:!1};try{h(fe,ue,ee(se,ye,ie),ee(Z,ye,ie))}catch(Te){Z(ye,Te,ie)}}):(ie.value=ue,ie.state=1,re(ie,!1))}catch(ye){Z({done:!1},ye,ie)}}};if(E&&(A=(U=function(ie){k(this,A),v(ie),h(a,this);var ue=_(this);try{ie(ee(se,ue),ee(Z,ue))}catch(pe){Z(ue,pe)}}).prototype,(a=function(ie){S(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new q,rejection:!1,state:0,value:void 0})}).prototype=f(A,"then",function(ie,ue){var pe=_(this),fe=j(N(this,U));return pe.parent=!0,fe.ok=!b(ie)||ie,fe.fail=b(ue)&&ue,fe.domain=u?K.domain:void 0,pe.state===0?pe.reactions.add(fe):F(function(){G(fe,pe)}),fe.promise}),i=function(){var ie=new a,ue=_(ie);this.promise=ie,this.resolve=ee(se,ue),this.reject=ee(Z,ue)},O.f=j=function(ie){return ie===U||ie===void 0?new i(ie):J(ie)},!c&&b(I)&&T!==Object.prototype)){o=T.then,w||f(T,"then",function(ie,ue){var pe=this;return new U(function(fe,ye){h(o,pe,fe,ye)}).then(ie,ue)},{unsafe:!0});try{delete T.constructor}catch{}g&&g(T,A)}l({global:!0,constructor:!0,wrap:!0,forced:E},{Promise:U}),m(U,"Promise",!1,!0),p("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/is-pure"),o=e("../internals/promise-native-constructor"),l=e("../internals/fails"),c=e("../internals/get-built-in"),u=e("../internals/is-callable"),d=e("../internals/species-constructor"),h=e("../internals/promise-resolve"),f=e("../internals/define-built-in"),g=o&&o.prototype;if(a({target:"Promise",proto:!0,real:!0,forced:!!o&&l(function(){g.finally.call({then:function(){}},function(){})})},{finally:function(p){var v=d(this,c("Promise")),b=u(p);return this.then(b?function(y){return h(v,p()).then(function(){return y})}:p,b?function(y){return h(v,p()).then(function(){throw y})}:p)}}),!i&&u(o)){var m=c("Promise").prototype.finally;g.finally!==m&&f(g,"finally",m,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(e,n,s){e("../modules/es.promise.constructor"),e("../modules/es.promise.all"),e("../modules/es.promise.catch"),e("../modules/es.promise.race"),e("../modules/es.promise.reject"),e("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/function-call"),o=e("../internals/a-callable"),l=e("../internals/new-promise-capability"),c=e("../internals/perform"),u=e("../internals/iterate");a({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{race:function(d){var h=this,f=l.f(h),g=f.reject,m=c(function(){var p=o(h.resolve);u(d,function(v){i(p,h,v).then(f.resolve,g)})});return m.error&&g(m.value),f.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/function-call"),o=e("../internals/new-promise-capability");a({target:"Promise",stat:!0,forced:e("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(l){var c=o.f(this);return i(c.reject,void 0,l),c.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/get-built-in"),o=e("../internals/is-pure"),l=e("../internals/promise-native-constructor"),c=e("../internals/promise-constructor-detection").CONSTRUCTOR,u=e("../internals/promise-resolve"),d=i("Promise"),h=o&&!c;a({target:"Promise",stat:!0,forced:o||c},{resolve:function(f){return u(h&&this===d?l:this,f)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/function-uncurry-this"),o=e("../internals/to-absolute-index"),l=RangeError,c=String.fromCharCode,u=String.fromCodePoint,d=i([].join);a({target:"String",stat:!0,arity:1,forced:!!u&&u.length!==1},{fromCodePoint:function(h){for(var f,g=[],m=arguments.length,p=0;m>p;){if(f=+arguments[p++],o(f,1114111)!==f)throw new l(f+" is not a valid code point");g[p]=f<65536?c(f):c(55296+((f-=65536)>>10),f%1024+56320)}return d(g,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/function-uncurry-this"),o=e("../internals/not-a-regexp"),l=e("../internals/require-object-coercible"),c=e("../internals/to-string"),u=e("../internals/correct-is-regexp-logic"),d=i("".indexOf);a({target:"String",proto:!0,forced:!u("includes")},{includes:function(h){return!!~d(c(l(this)),c(o(h)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(e,n,s){e("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/global"),o=e("../internals/function-call"),l=e("../internals/function-uncurry-this"),c=e("../internals/is-pure"),u=e("../internals/descriptors"),d=e("../internals/symbol-constructor-detection"),h=e("../internals/fails"),f=e("../internals/has-own-property"),g=e("../internals/object-is-prototype-of"),m=e("../internals/an-object"),p=e("../internals/to-indexed-object"),v=e("../internals/to-property-key"),b=e("../internals/to-string"),y=e("../internals/create-property-descriptor"),k=e("../internals/object-create"),N=e("../internals/object-keys"),L=e("../internals/object-get-own-property-names"),F=e("../internals/object-get-own-property-names-external"),R=e("../internals/object-get-own-property-symbols"),B=e("../internals/object-get-own-property-descriptor"),q=e("../internals/object-define-property"),V=e("../internals/object-define-properties"),I=e("../internals/object-property-is-enumerable"),C=e("../internals/define-built-in"),O=e("../internals/define-built-in-accessor"),E=e("../internals/shared"),x=e("../internals/shared-key"),w=e("../internals/hidden-keys"),_=e("../internals/uid"),S=e("../internals/well-known-symbol"),T=e("../internals/well-known-symbol-wrapped"),U=e("../internals/well-known-symbol-define"),A=e("../internals/symbol-define-to-primitive"),H=e("../internals/set-to-string-tag"),z=e("../internals/internal-state"),K=e("../internals/array-iteration").forEach,j=x("hidden"),J=z.set,P=z.getterFor("Symbol"),D=Object.prototype,G=i.Symbol,re=G&&G.prototype,te=i.RangeError,ne=i.TypeError,le=i.QObject,oe=B.f,ee=q.f,Z=F.f,se=I.f,ie=l([].push),ue=E("symbols"),pe=E("op-symbols"),fe=E("wks"),ye=!le||!le.prototype||!le.prototype.findChild,Te=function(Ce,Ie,Ve){var De=oe(D,Ie);De&&delete D[Ie],ee(Ce,Ie,Ve),De&&Ce!==D&&ee(D,Ie,De)},Pe=u&&h(function(){return k(ee({},"a",{get:function(){return ee(this,"a",{value:7}).a}})).a!==7})?Te:ee,je=function(Ce,Ie){var Ve=ue[Ce]=k(re);return J(Ve,{type:"Symbol",tag:Ce,description:Ie}),u||(Ve.description=Ie),Ve},qe=function(Ce,Ie,Ve){Ce===D&&qe(pe,Ie,Ve),m(Ce);var De=v(Ie);return m(Ve),f(ue,De)?(Ve.enumerable?(f(Ce,j)&&Ce[j][De]&&(Ce[j][De]=!1),Ve=k(Ve,{enumerable:y(0,!1)})):(f(Ce,j)||ee(Ce,j,y(1,{})),Ce[j][De]=!0),Pe(Ce,De,Ve)):ee(Ce,De,Ve)},We=function(Ce,Ie){m(Ce);var Ve=p(Ie),De=N(Ve).concat(ht(Ve));return K(De,function(Oe){u&&!o(at,Ve,Oe)||qe(Ce,Oe,Ve[Oe])}),Ce},at=function(Ce){var Ie=v(Ce),Ve=o(se,this,Ie);return!(this===D&&f(ue,Ie)&&!f(pe,Ie))&&(!(Ve||!f(this,Ie)||!f(ue,Ie)||f(this,j)&&this[j][Ie])||Ve)},Ye=function(Ce,Ie){var Ve=p(Ce),De=v(Ie);if(Ve!==D||!f(ue,De)||f(pe,De)){var Oe=oe(Ve,De);return!Oe||!f(ue,De)||f(Ve,j)&&Ve[j][De]||(Oe.enumerable=!0),Oe}},rt=function(Ce){var Ie=Z(p(Ce)),Ve=[];return K(Ie,function(De){f(ue,De)||f(w,De)||ie(Ve,De)}),Ve},ht=function(Ce){var Ie=Ce===D,Ve=Z(Ie?pe:p(Ce)),De=[];return K(Ve,function(Oe){!f(ue,Oe)||Ie&&!f(D,Oe)||ie(De,ue[Oe])}),De};d||(C(re=(G=function(){if(g(re,this))throw new ne("Symbol is not a constructor");var Ce=arguments.length&&arguments[0]!==void 0?b(arguments[0]):void 0,Ie=_(Ce),Ve=function(De){this===D&&o(Ve,pe,De),f(this,j)&&f(this[j],Ie)&&(this[j][Ie]=!1);var Oe=y(1,De);try{Pe(this,Ie,Oe)}catch(Xe){if(!(Xe instanceof te))throw Xe;Te(this,Ie,Oe)}};return u&&ye&&Pe(D,Ie,{configurable:!0,set:Ve}),je(Ie,Ce)}).prototype,"toString",function(){return P(this).tag}),C(G,"withoutSetter",function(Ce){return je(_(Ce),Ce)}),I.f=at,q.f=qe,V.f=We,B.f=Ye,L.f=F.f=rt,R.f=ht,T.f=function(Ce){return je(S(Ce),Ce)},u&&(O(re,"description",{configurable:!0,get:function(){return P(this).description}}),c||C(D,"propertyIsEnumerable",at,{unsafe:!0}))),a({global:!0,constructor:!0,wrap:!0,forced:!d,sham:!d},{Symbol:G}),K(N(fe),function(Ce){U(Ce)}),a({target:"Symbol",stat:!0,forced:!d},{useSetter:function(){ye=!0},useSimple:function(){ye=!1}}),a({target:"Object",stat:!0,forced:!d,sham:!u},{create:function(Ce,Ie){return Ie===void 0?k(Ce):We(k(Ce),Ie)},defineProperty:qe,defineProperties:We,getOwnPropertyDescriptor:Ye}),a({target:"Object",stat:!0,forced:!d},{getOwnPropertyNames:rt}),A(),H(G,"Symbol"),w[j]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/get-built-in"),o=e("../internals/has-own-property"),l=e("../internals/to-string"),c=e("../internals/shared"),u=e("../internals/symbol-registry-detection"),d=c("string-to-symbol-registry"),h=c("symbol-to-string-registry");a({target:"Symbol",stat:!0,forced:!u},{for:function(f){var g=l(f);if(o(d,g))return d[g];var m=i("Symbol")(g);return d[g]=m,h[m]=g,m}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(e,n,s){e("../modules/es.symbol.constructor"),e("../modules/es.symbol.for"),e("../modules/es.symbol.key-for"),e("../modules/es.json.stringify"),e("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(e,n,s){var a=e("../internals/export"),i=e("../internals/has-own-property"),o=e("../internals/is-symbol"),l=e("../internals/try-to-string"),c=e("../internals/shared"),u=e("../internals/symbol-registry-detection"),d=c("symbol-to-string-registry");a({target:"Symbol",stat:!0,forced:!u},{keyFor:function(h){if(!o(h))throw new TypeError(l(h)+" is not a symbol");if(i(d,h))return d[h]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(e,n,s){function a(i){return Object.prototype.toString.call(i)}s.isArray=function(i){return Array.isArray?Array.isArray(i):a(i)==="[object Array]"},s.isBoolean=function(i){return typeof i=="boolean"},s.isNull=function(i){return i===null},s.isNullOrUndefined=function(i){return i==null},s.isNumber=function(i){return typeof i=="number"},s.isString=function(i){return typeof i=="string"},s.isSymbol=function(i){return typeof i=="symbol"},s.isUndefined=function(i){return i===void 0},s.isRegExp=function(i){return a(i)==="[object RegExp]"},s.isObject=function(i){return typeof i=="object"&&i!==null},s.isDate=function(i){return a(i)==="[object Date]"},s.isError=function(i){return a(i)==="[object Error]"||i instanceof Error},s.isFunction=function(i){return typeof i=="function"},s.isPrimitive=function(i){return i===null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||typeof i=="symbol"||i===void 0},s.isBuffer=e("buffer").Buffer.isBuffer},{buffer:220}],384:[function(e,n,s){(function(a){(function(){var i=e("elliptic"),o=e("bn.js");n.exports=function(d){return new c(d)};var l={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function c(d){this.curveType=l[d],this.curveType||(this.curveType={name:d}),this.curve=new i.ec(this.curveType.name),this.keys=void 0}function u(d,h,f){Array.isArray(d)||(d=d.toArray());var g=new a(d);if(f&&g.length<f){var m=new a(f-g.length);m.fill(0),g=a.concat([m,g])}return h?g.toString(h):g}l.p224=l.secp224r1,l.p256=l.secp256r1=l.prime256v1,l.p192=l.secp192r1=l.prime192v1,l.p384=l.secp384r1,l.p521=l.secp521r1,c.prototype.generateKeys=function(d,h){return this.keys=this.curve.genKeyPair(),this.getPublicKey(d,h)},c.prototype.computeSecret=function(d,h,f){return h=h||"utf8",a.isBuffer(d)||(d=new a(d,h)),u(this.curve.keyFromPublic(d).getPublic().mul(this.keys.getPrivate()).getX(),f,this.curveType.byteLength)},c.prototype.getPublicKey=function(d,h){var f=this.keys.getPublic(h==="compressed",!0);return h==="hybrid"&&(f[f.length-1]%2?f[0]=7:f[0]=6),u(f,d)},c.prototype.getPrivateKey=function(d){return u(this.keys.getPrivate(),d)},c.prototype.setPublicKey=function(d,h){return h=h||"utf8",a.isBuffer(d)||(d=new a(d,h)),this.keys._importPublic(d),this},c.prototype.setPrivateKey=function(d,h){h=h||"utf8",a.isBuffer(d)||(d=new a(d,h));var f=new o(d);return f=f.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(f),this}}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(e,n,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],386:[function(e,n,s){var a=e("inherits"),i=e("md5.js"),o=e("ripemd160"),l=e("sha.js"),c=e("cipher-base");function u(d){c.call(this,"digest"),this._hash=d}a(u,c),u.prototype._update=function(d){this._hash.update(d)},u.prototype._final=function(){return this._hash.digest()},n.exports=function(d){return(d=d.toLowerCase())==="md5"?new i:d==="rmd160"||d==="ripemd160"?new o:new u(l(d))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(e,n,s){var a=e("md5.js");n.exports=function(i){return new a().update(i).digest()}},{"md5.js":450}],388:[function(e,n,s){var a=e("inherits"),i=e("./legacy"),o=e("cipher-base"),l=e("safe-buffer").Buffer,c=e("create-hash/md5"),u=e("ripemd160"),d=e("sha.js"),h=l.alloc(128);function f(g,m){o.call(this,"digest"),typeof m=="string"&&(m=l.from(m));var p=g==="sha512"||g==="sha384"?128:64;this._alg=g,this._key=m,m.length>p?m=(g==="rmd160"?new u:d(g)).update(m).digest():m.length<p&&(m=l.concat([m,h],p));for(var v=this._ipad=l.allocUnsafe(p),b=this._opad=l.allocUnsafe(p),y=0;y<p;y++)v[y]=54^m[y],b[y]=92^m[y];this._hash=g==="rmd160"?new u:d(g),this._hash.update(v)}a(f,o),f.prototype._update=function(g){this._hash.update(g)},f.prototype._final=function(){var g=this._hash.digest();return(this._alg==="rmd160"?new u:d(this._alg)).update(this._opad).update(g).digest()},n.exports=function(g,m){return(g=g.toLowerCase())==="rmd160"||g==="ripemd160"?new f("rmd160",m):g==="md5"?new i(c,m):new f(g,m)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(e,n,s){var a=e("inherits"),i=e("safe-buffer").Buffer,o=e("cipher-base"),l=i.alloc(128);function c(u,d){o.call(this,"digest"),typeof d=="string"&&(d=i.from(d)),this._alg=u,this._key=d,d.length>64?d=u(d):d.length<64&&(d=i.concat([d,l],64));for(var h=this._ipad=i.allocUnsafe(64),f=this._opad=i.allocUnsafe(64),g=0;g<64;g++)h[g]=54^d[g],f[g]=92^d[g];this._hash=[h]}a(c,o),c.prototype._update=function(u){this._hash.push(u)},c.prototype._final=function(){var u=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,u]))},n.exports=c},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(e,n,s){s.randomBytes=s.rng=s.pseudoRandomBytes=s.prng=e("randombytes"),s.createHash=s.Hash=e("create-hash"),s.createHmac=s.Hmac=e("create-hmac");var a=e("browserify-sign/algos"),i=Object.keys(a),o=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(i);s.getHashes=function(){return o};var l=e("pbkdf2");s.pbkdf2=l.pbkdf2,s.pbkdf2Sync=l.pbkdf2Sync;var c=e("browserify-cipher");s.Cipher=c.Cipher,s.createCipher=c.createCipher,s.Cipheriv=c.Cipheriv,s.createCipheriv=c.createCipheriv,s.Decipher=c.Decipher,s.createDecipher=c.createDecipher,s.Decipheriv=c.Decipheriv,s.createDecipheriv=c.createDecipheriv,s.getCiphers=c.getCiphers,s.listCiphers=c.listCiphers;var u=e("diffie-hellman");s.DiffieHellmanGroup=u.DiffieHellmanGroup,s.createDiffieHellmanGroup=u.createDiffieHellmanGroup,s.getDiffieHellman=u.getDiffieHellman,s.createDiffieHellman=u.createDiffieHellman,s.DiffieHellman=u.DiffieHellman;var d=e("browserify-sign");s.createSign=d.createSign,s.Sign=d.Sign,s.createVerify=d.createVerify,s.Verify=d.Verify,s.createECDH=e("create-ecdh");var h=e("public-encrypt");s.publicEncrypt=h.publicEncrypt,s.privateEncrypt=h.privateEncrypt,s.publicDecrypt=h.publicDecrypt,s.privateDecrypt=h.privateDecrypt;var f=e("randomfill");s.randomFill=f.randomFill,s.randomFillSync=f.randomFillSync,s.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},s.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(e,n,s){(function(a,i){typeof s=="object"&&n!==void 0?n.exports=i():(a=typeof globalThis<"u"?globalThis:a||self).dayjs=i()})(void 0,function(){var a=6e4,i=36e5,o="millisecond",l="second",c="minute",u="hour",d="day",h="week",f="month",g="quarter",m="year",p="date",v="Invalid Date",b=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,k={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(x){var w=["th","st","nd","rd"],_=x%100;return"["+x+(w[(_-20)%10]||w[_]||w[0])+"]"}},N=function(x,w,_){var S=String(x);return!S||S.length>=w?x:""+Array(w+1-S.length).join(_)+x},L={s:N,z:function(x){var w=-x.utcOffset(),_=Math.abs(w),S=Math.floor(_/60),T=_%60;return(w<=0?"+":"-")+N(S,2,"0")+":"+N(T,2,"0")},m:function x(w,_){if(w.date()<_.date())return-x(_,w);var S=12*(_.year()-w.year())+(_.month()-w.month()),T=w.clone().add(S,f),U=_-T<0,A=w.clone().add(S+(U?-1:1),f);return+(-(S+(_-T)/(U?T-A:A-T))||0)},a:function(x){return x<0?Math.ceil(x)||0:Math.floor(x)},p:function(x){return{M:f,y:m,w:h,d,D:p,h:u,m:c,s:l,ms:o,Q:g}[x]||String(x||"").toLowerCase().replace(/s$/,"")},u:function(x){return x===void 0}},F="en",R={};R[F]=k;var B="$isDayjsObject",q=function(x){return x instanceof O||!(!x||!x[B])},V=function x(w,_,S){var T;if(!w)return F;if(typeof w=="string"){var U=w.toLowerCase();R[U]&&(T=U),_&&(R[U]=_,T=U);var A=w.split("-");if(!T&&A.length>1)return x(A[0])}else{var H=w.name;R[H]=w,T=H}return!S&&T&&(F=T),T||!S&&F},I=function(x,w){if(q(x))return x.clone();var _=typeof w=="object"?w:{};return _.date=x,_.args=arguments,new O(_)},C=L;C.l=V,C.i=q,C.w=function(x,w){return I(x,{locale:w.$L,utc:w.$u,x:w.$x,$offset:w.$offset})};var O=function(){function x(_){this.$L=V(_.locale,null,!0),this.parse(_),this.$x=this.$x||_.x||{},this[B]=!0}var w=x.prototype;return w.parse=function(_){this.$d=function(S){var T=S.date,U=S.utc;if(T===null)return new Date(NaN);if(C.u(T))return new Date;if(T instanceof Date)return new Date(T);if(typeof T=="string"&&!/Z$/i.test(T)){var A=T.match(b);if(A){var H=A[2]-1||0,z=(A[7]||"0").substring(0,3);return U?new Date(Date.UTC(A[1],H,A[3]||1,A[4]||0,A[5]||0,A[6]||0,z)):new Date(A[1],H,A[3]||1,A[4]||0,A[5]||0,A[6]||0,z)}}return new Date(T)}(_),this.init()},w.init=function(){var _=this.$d;this.$y=_.getFullYear(),this.$M=_.getMonth(),this.$D=_.getDate(),this.$W=_.getDay(),this.$H=_.getHours(),this.$m=_.getMinutes(),this.$s=_.getSeconds(),this.$ms=_.getMilliseconds()},w.$utils=function(){return C},w.isValid=function(){return this.$d.toString()!==v},w.isSame=function(_,S){var T=I(_);return this.startOf(S)<=T&&T<=this.endOf(S)},w.isAfter=function(_,S){return I(_)<this.startOf(S)},w.isBefore=function(_,S){return this.endOf(S)<I(_)},w.$g=function(_,S,T){return C.u(_)?this[S]:this.set(T,_)},w.unix=function(){return Math.floor(this.valueOf()/1e3)},w.valueOf=function(){return this.$d.getTime()},w.startOf=function(_,S){var T=this,U=!!C.u(S)||S,A=C.p(_),H=function(re,te){var ne=C.w(T.$u?Date.UTC(T.$y,te,re):new Date(T.$y,te,re),T);return U?ne:ne.endOf(d)},z=function(re,te){return C.w(T.toDate()[re].apply(T.toDate("s"),(U?[0,0,0,0]:[23,59,59,999]).slice(te)),T)},K=this.$W,j=this.$M,J=this.$D,P="set"+(this.$u?"UTC":"");switch(A){case m:return U?H(1,0):H(31,11);case f:return U?H(1,j):H(0,j+1);case h:var D=this.$locale().weekStart||0,G=(K<D?K+7:K)-D;return H(U?J-G:J+(6-G),j);case d:case p:return z(P+"Hours",0);case u:return z(P+"Minutes",1);case c:return z(P+"Seconds",2);case l:return z(P+"Milliseconds",3);default:return this.clone()}},w.endOf=function(_){return this.startOf(_,!1)},w.$set=function(_,S){var T,U=C.p(_),A="set"+(this.$u?"UTC":""),H=(T={},T[d]=A+"Date",T[p]=A+"Date",T[f]=A+"Month",T[m]=A+"FullYear",T[u]=A+"Hours",T[c]=A+"Minutes",T[l]=A+"Seconds",T[o]=A+"Milliseconds",T)[U],z=U===d?this.$D+(S-this.$W):S;if(U===f||U===m){var K=this.clone().set(p,1);K.$d[H](z),K.init(),this.$d=K.set(p,Math.min(this.$D,K.daysInMonth())).$d}else H&&this.$d[H](z);return this.init(),this},w.set=function(_,S){return this.clone().$set(_,S)},w.get=function(_){return this[C.p(_)]()},w.add=function(_,S){var T,U=this;_=Number(_);var A=C.p(S),H=function(j){var J=I(U);return C.w(J.date(J.date()+Math.round(j*_)),U)};if(A===f)return this.set(f,this.$M+_);if(A===m)return this.set(m,this.$y+_);if(A===d)return H(1);if(A===h)return H(7);var z=(T={},T[c]=a,T[u]=i,T[l]=1e3,T)[A]||1,K=this.$d.getTime()+_*z;return C.w(K,this)},w.subtract=function(_,S){return this.add(-1*_,S)},w.format=function(_){var S=this,T=this.$locale();if(!this.isValid())return T.invalidDate||v;var U=_||"YYYY-MM-DDTHH:mm:ssZ",A=C.z(this),H=this.$H,z=this.$m,K=this.$M,j=T.weekdays,J=T.months,P=T.meridiem,D=function(te,ne,le,oe){return te&&(te[ne]||te(S,U))||le[ne].slice(0,oe)},G=function(te){return C.s(H%12||12,te,"0")},re=P||function(te,ne,le){var oe=te<12?"AM":"PM";return le?oe.toLowerCase():oe};return U.replace(y,function(te,ne){return ne||function(le){switch(le){case"YY":return String(S.$y).slice(-2);case"YYYY":return C.s(S.$y,4,"0");case"M":return K+1;case"MM":return C.s(K+1,2,"0");case"MMM":return D(T.monthsShort,K,J,3);case"MMMM":return D(J,K);case"D":return S.$D;case"DD":return C.s(S.$D,2,"0");case"d":return String(S.$W);case"dd":return D(T.weekdaysMin,S.$W,j,2);case"ddd":return D(T.weekdaysShort,S.$W,j,3);case"dddd":return j[S.$W];case"H":return String(H);case"HH":return C.s(H,2,"0");case"h":return G(1);case"hh":return G(2);case"a":return re(H,z,!0);case"A":return re(H,z,!1);case"m":return String(z);case"mm":return C.s(z,2,"0");case"s":return String(S.$s);case"ss":return C.s(S.$s,2,"0");case"SSS":return C.s(S.$ms,3,"0");case"Z":return A}return null}(te)||A.replace(":","")})},w.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},w.diff=function(_,S,T){var U,A=this,H=C.p(S),z=I(_),K=(z.utcOffset()-this.utcOffset())*a,j=this-z,J=function(){return C.m(A,z)};switch(H){case m:U=J()/12;break;case f:U=J();break;case g:U=J()/3;break;case h:U=(j-K)/6048e5;break;case d:U=(j-K)/864e5;break;case u:U=j/i;break;case c:U=j/a;break;case l:U=j/1e3;break;default:U=j}return T?U:C.a(U)},w.daysInMonth=function(){return this.endOf(f).$D},w.$locale=function(){return R[this.$L]},w.locale=function(_,S){if(!_)return this.$L;var T=this.clone(),U=V(_,S,!0);return U&&(T.$L=U),T},w.clone=function(){return C.w(this.$d,this)},w.toDate=function(){return new Date(this.valueOf())},w.toJSON=function(){return this.isValid()?this.toISOString():null},w.toISOString=function(){return this.$d.toISOString()},w.toString=function(){return this.$d.toUTCString()},x}(),E=O.prototype;return I.prototype=E,[["$ms",o],["$s",l],["$m",c],["$H",u],["$W",d],["$M",f],["$y",m],["$D",p]].forEach(function(x){E[x[1]]=function(w){return this.$g(w,x[0],x[1])}}),I.extend=function(x,w){return x.$i||(x(w,O,I),x.$i=!0),I},I.locale=V,I.isDayjs=q,I.unix=function(x){return I(1e3*x)},I.en=R[F],I.Ls=R,I.p={},I})},{}],392:[function(e,n,s){(function(a,i){typeof s=="object"&&n!==void 0?n.exports=i():(a=typeof globalThis<"u"?globalThis:a||self).dayjs_plugin_customParseFormat=i()})(void 0,function(){var a={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},i=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,o=/\d\d/,l=/\d\d?/,c=/\d*[^-_:/,()\s\d]+/,u={},d=function(b){return(b=+b)+(b>68?1900:2e3)},h=function(b){return function(y){this[b]=+y}},f=[/[+-]\d\d:?(\d\d)?|Z/,function(b){(this.zone||(this.zone={})).offset=function(y){if(!y||y==="Z")return 0;var k=y.match(/([+-]|\d\d)/g),N=60*k[1]+(+k[2]||0);return N===0?0:k[0]==="+"?-N:N}(b)}],g=function(b){var y=u[b];return y&&(y.indexOf?y:y.s.concat(y.f))},m=function(b,y){var k,N=u.meridiem;if(N){for(var L=1;L<=24;L+=1)if(b.indexOf(N(L,0,y))>-1){k=L>12;break}}else k=b===(y?"pm":"PM");return k},p={A:[c,function(b){this.afternoon=m(b,!1)}],a:[c,function(b){this.afternoon=m(b,!0)}],S:[/\d/,function(b){this.milliseconds=100*+b}],SS:[o,function(b){this.milliseconds=10*+b}],SSS:[/\d{3}/,function(b){this.milliseconds=+b}],s:[l,h("seconds")],ss:[l,h("seconds")],m:[l,h("minutes")],mm:[l,h("minutes")],H:[l,h("hours")],h:[l,h("hours")],HH:[l,h("hours")],hh:[l,h("hours")],D:[l,h("day")],DD:[o,h("day")],Do:[c,function(b){var y=u.ordinal,k=b.match(/\d+/);if(this.day=k[0],y)for(var N=1;N<=31;N+=1)y(N).replace(/\[|\]/g,"")===b&&(this.day=N)}],M:[l,h("month")],MM:[o,h("month")],MMM:[c,function(b){var y=g("months"),k=(g("monthsShort")||y.map(function(N){return N.slice(0,3)})).indexOf(b)+1;if(k<1)throw new Error;this.month=k%12||k}],MMMM:[c,function(b){var y=g("months").indexOf(b)+1;if(y<1)throw new Error;this.month=y%12||y}],Y:[/[+-]?\d+/,h("year")],YY:[o,function(b){this.year=d(b)}],YYYY:[/\d{4}/,h("year")],Z:f,ZZ:f};function v(b){var y,k;y=b,k=u&&u.formats;for(var N=(b=y.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(I,C,O){var E=O&&O.toUpperCase();return C||k[O]||a[O]||k[E].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(x,w,_){return w||_.slice(1)})})).match(i),L=N.length,F=0;F<L;F+=1){var R=N[F],B=p[R],q=B&&B[0],V=B&&B[1];N[F]=V?{regex:q,parser:V}:R.replace(/^\[|\]$/g,"")}return function(I){for(var C={},O=0,E=0;O<L;O+=1){var x=N[O];if(typeof x=="string")E+=x.length;else{var w=x.regex,_=x.parser,S=I.slice(E),T=w.exec(S)[0];_.call(C,T),I=I.replace(T,"")}}return function(U){var A=U.afternoon;if(A!==void 0){var H=U.hours;A?H<12&&(U.hours+=12):H===12&&(U.hours=0),delete U.afternoon}}(C),C}}return function(b,y,k){k.p.customParseFormat=!0,b&&b.parseTwoDigitYear&&(d=b.parseTwoDigitYear);var N=y.prototype,L=N.parse;N.parse=function(F){var R=F.date,B=F.utc,q=F.args;this.$u=B;var V=q[1];if(typeof V=="string"){var I=q[2]===!0,C=q[3]===!0,O=I||C,E=q[2];C&&(E=q[2]),u=this.$locale(),!I&&E&&(u=k.Ls[E]),this.$d=function(S,T,U){try{if(["x","X"].indexOf(T)>-1)return new Date((T==="X"?1e3:1)*S);var A=v(T)(S),H=A.year,z=A.month,K=A.day,j=A.hours,J=A.minutes,P=A.seconds,D=A.milliseconds,G=A.zone,re=new Date,te=K||(H||z?1:re.getDate()),ne=H||re.getFullYear(),le=0;H&&!z||(le=z>0?z-1:re.getMonth());var oe=j||0,ee=J||0,Z=P||0,se=D||0;return G?new Date(Date.UTC(ne,le,te,oe,ee,Z,se+60*G.offset*1e3)):U?new Date(Date.UTC(ne,le,te,oe,ee,Z,se)):new Date(ne,le,te,oe,ee,Z,se)}catch{return new Date("")}}(R,V,B),this.init(),E&&E!==!0&&(this.$L=this.locale(E).$L),O&&R!=this.format(V)&&(this.$d=new Date("")),u={}}else if(V instanceof Array)for(var x=V.length,w=1;w<=x;w+=1){q[1]=V[w-1];var _=k.apply(this,q);if(_.isValid()){this.$d=_.$d,this.$L=_.$L,this.init();break}w===x&&(this.$d=new Date(""))}else L.call(this,F)}}})},{}],393:[function(e,n,s){(function(a,i){typeof s=="object"&&n!==void 0?n.exports=i():(a=typeof globalThis<"u"?globalThis:a||self).dayjs_plugin_utc=i()})(void 0,function(){var a="minute",i=/[+-]\d\d(?::?\d\d)?/g,o=/([+-]|\d\d)/g;return function(l,c,u){var d=c.prototype;u.utc=function(b){var y={date:b,utc:!0,args:arguments};return new c(y)},d.utc=function(b){var y=u(this.toDate(),{locale:this.$L,utc:!0});return b?y.add(this.utcOffset(),a):y},d.local=function(){return u(this.toDate(),{locale:this.$L,utc:!1})};var h=d.parse;d.parse=function(b){b.utc&&(this.$u=!0),this.$utils().u(b.$offset)||(this.$offset=b.$offset),h.call(this,b)};var f=d.init;d.init=function(){if(this.$u){var b=this.$d;this.$y=b.getUTCFullYear(),this.$M=b.getUTCMonth(),this.$D=b.getUTCDate(),this.$W=b.getUTCDay(),this.$H=b.getUTCHours(),this.$m=b.getUTCMinutes(),this.$s=b.getUTCSeconds(),this.$ms=b.getUTCMilliseconds()}else f.call(this)};var g=d.utcOffset;d.utcOffset=function(b,y){var k=this.$utils().u;if(k(b))return this.$u?0:k(this.$offset)?g.call(this):this.$offset;if(typeof b=="string"&&(b=function(R){R===void 0&&(R="");var B=R.match(i);if(!B)return null;var q=(""+B[0]).match(o)||["-",0,0],V=q[0],I=60*+q[1]+ +q[2];return I===0?0:V==="+"?I:-I}(b))===null)return this;var N=Math.abs(b)<=16?60*b:b,L=this;if(y)return L.$offset=N,L.$u=b===0,L;if(b!==0){var F=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(L=this.local().add(N+F,a)).$offset=N,L.$x.$localOffset=F}else L=this.utc();return L};var m=d.format;d.format=function(b){var y=b||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return m.call(this,y)},d.valueOf=function(){var b=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*b},d.isUTC=function(){return!!this.$u},d.toISOString=function(){return this.toDate().toISOString()},d.toString=function(){return this.toDate().toUTCString()};var p=d.toDate;d.toDate=function(b){return b==="s"&&this.$offset?u(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():p.call(this)};var v=d.diff;d.diff=function(b,y,k){if(b&&this.$u===b.$u)return v.call(this,b,y,k);var N=this.local(),L=u(b).local();return v.call(N,L,y,k)}}})},{}],394:[function(e,n,s){s.utils=e("./des/utils"),s.Cipher=e("./des/cipher"),s.DES=e("./des/des"),s.CBC=e("./des/cbc"),s.EDE=e("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(e,n,s){var a=e("minimalistic-assert"),i=e("inherits"),o={};function l(c){a.equal(c.length,8,"Invalid IV length"),this.iv=new Array(8);for(var u=0;u<this.iv.length;u++)this.iv[u]=c[u]}s.instantiate=function(c){function u(g){c.call(this,g),this._cbcInit()}i(u,c);for(var d=Object.keys(o),h=0;h<d.length;h++){var f=d[h];u.prototype[f]=o[f]}return u.create=function(g){return new u(g)},u},o._cbcInit=function(){var c=new l(this.options.iv);this._cbcState=c},o._update=function(c,u,d,h){var f=this._cbcState,g=this.constructor.super_.prototype,m=f.iv;if(this.type==="encrypt"){for(var p=0;p<this.blockSize;p++)m[p]^=c[u+p];for(g._update.call(this,m,0,d,h),p=0;p<this.blockSize;p++)m[p]=d[h+p]}else{for(g._update.call(this,c,u,d,h),p=0;p<this.blockSize;p++)d[h+p]^=m[p];for(p=0;p<this.blockSize;p++)m[p]=c[u+p]}}},{inherits:440,"minimalistic-assert":453}],396:[function(e,n,s){var a=e("minimalistic-assert");function i(o){this.options=o,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=o.padding!==!1}n.exports=i,i.prototype._init=function(){},i.prototype.update=function(o){return o.length===0?[]:this.type==="decrypt"?this._updateDecrypt(o):this._updateEncrypt(o)},i.prototype._buffer=function(o,l){for(var c=Math.min(this.buffer.length-this.bufferOff,o.length-l),u=0;u<c;u++)this.buffer[this.bufferOff+u]=o[l+u];return this.bufferOff+=c,c},i.prototype._flushBuffer=function(o,l){return this._update(this.buffer,0,o,l),this.bufferOff=0,this.blockSize},i.prototype._updateEncrypt=function(o){var l=0,c=0,u=(this.bufferOff+o.length)/this.blockSize|0,d=new Array(u*this.blockSize);this.bufferOff!==0&&(l+=this._buffer(o,l),this.bufferOff===this.buffer.length&&(c+=this._flushBuffer(d,c)));for(var h=o.length-(o.length-l)%this.blockSize;l<h;l+=this.blockSize)this._update(o,l,d,c),c+=this.blockSize;for(;l<o.length;l++,this.bufferOff++)this.buffer[this.bufferOff]=o[l];return d},i.prototype._updateDecrypt=function(o){for(var l=0,c=0,u=Math.ceil((this.bufferOff+o.length)/this.blockSize)-1,d=new Array(u*this.blockSize);u>0;u--)l+=this._buffer(o,l),c+=this._flushBuffer(d,c);return l+=this._buffer(o,l),d},i.prototype.final=function(o){var l,c;return o&&(l=this.update(o)),c=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),l?l.concat(c):c},i.prototype._pad=function(o,l){if(l===0)return!1;for(;l<o.length;)o[l++]=0;return!0},i.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var o=new Array(this.blockSize);return this._update(this.buffer,0,o,0),o},i.prototype._unpad=function(o){return o},i.prototype._finalDecrypt=function(){a.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var o=new Array(this.blockSize);return this._flushBuffer(o,0),this._unpad(o)}},{"minimalistic-assert":453}],397:[function(e,n,s){var a=e("minimalistic-assert"),i=e("inherits"),o=e("./utils"),l=e("./cipher");function c(){this.tmp=new Array(2),this.keys=null}function u(h){l.call(this,h);var f=new c;this._desState=f,this.deriveKeys(f,h.key)}i(u,l),n.exports=u,u.create=function(h){return new u(h)};var d=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];u.prototype.deriveKeys=function(h,f){h.keys=new Array(32),a.equal(f.length,this.blockSize,"Invalid key length");var g=o.readUInt32BE(f,0),m=o.readUInt32BE(f,4);o.pc1(g,m,h.tmp,0),g=h.tmp[0],m=h.tmp[1];for(var p=0;p<h.keys.length;p+=2){var v=d[p>>>1];g=o.r28shl(g,v),m=o.r28shl(m,v),o.pc2(g,m,h.keys,p)}},u.prototype._update=function(h,f,g,m){var p=this._desState,v=o.readUInt32BE(h,f),b=o.readUInt32BE(h,f+4);o.ip(v,b,p.tmp,0),v=p.tmp[0],b=p.tmp[1],this.type==="encrypt"?this._encrypt(p,v,b,p.tmp,0):this._decrypt(p,v,b,p.tmp,0),v=p.tmp[0],b=p.tmp[1],o.writeUInt32BE(g,v,m),o.writeUInt32BE(g,b,m+4)},u.prototype._pad=function(h,f){if(this.padding===!1)return!1;for(var g=h.length-f,m=f;m<h.length;m++)h[m]=g;return!0},u.prototype._unpad=function(h){if(this.padding===!1)return h;for(var f=h[h.length-1],g=h.length-f;g<h.length;g++)a.equal(h[g],f);return h.slice(0,h.length-f)},u.prototype._encrypt=function(h,f,g,m,p){for(var v=f,b=g,y=0;y<h.keys.length;y+=2){var k=h.keys[y],N=h.keys[y+1];o.expand(b,h.tmp,0),k^=h.tmp[0],N^=h.tmp[1];var L=o.substitute(k,N),F=b;b=(v^o.permute(L))>>>0,v=F}o.rip(b,v,m,p)},u.prototype._decrypt=function(h,f,g,m,p){for(var v=g,b=f,y=h.keys.length-2;y>=0;y-=2){var k=h.keys[y],N=h.keys[y+1];o.expand(v,h.tmp,0),k^=h.tmp[0],N^=h.tmp[1];var L=o.substitute(k,N),F=v;v=(b^o.permute(L))>>>0,b=F}o.rip(v,b,m,p)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(e,n,s){var a=e("minimalistic-assert"),i=e("inherits"),o=e("./cipher"),l=e("./des");function c(d,h){a.equal(h.length,24,"Invalid key length");var f=h.slice(0,8),g=h.slice(8,16),m=h.slice(16,24);this.ciphers=d==="encrypt"?[l.create({type:"encrypt",key:f}),l.create({type:"decrypt",key:g}),l.create({type:"encrypt",key:m})]:[l.create({type:"decrypt",key:m}),l.create({type:"encrypt",key:g}),l.create({type:"decrypt",key:f})]}function u(d){o.call(this,d);var h=new c(this.type,this.options.key);this._edeState=h}i(u,o),n.exports=u,u.create=function(d){return new u(d)},u.prototype._update=function(d,h,f,g){var m=this._edeState;m.ciphers[0]._update(d,h,f,g),m.ciphers[1]._update(f,g,f,g),m.ciphers[2]._update(f,g,f,g)},u.prototype._pad=l.prototype._pad,u.prototype._unpad=l.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(e,n,s){s.readUInt32BE=function(l,c){return(l[0+c]<<24|l[1+c]<<16|l[2+c]<<8|l[3+c])>>>0},s.writeUInt32BE=function(l,c,u){l[0+u]=c>>>24,l[1+u]=c>>>16&255,l[2+u]=c>>>8&255,l[3+u]=255&c},s.ip=function(l,c,u,d){for(var h=0,f=0,g=6;g>=0;g-=2){for(var m=0;m<=24;m+=8)h<<=1,h|=c>>>m+g&1;for(m=0;m<=24;m+=8)h<<=1,h|=l>>>m+g&1}for(g=6;g>=0;g-=2){for(m=1;m<=25;m+=8)f<<=1,f|=c>>>m+g&1;for(m=1;m<=25;m+=8)f<<=1,f|=l>>>m+g&1}u[d+0]=h>>>0,u[d+1]=f>>>0},s.rip=function(l,c,u,d){for(var h=0,f=0,g=0;g<4;g++)for(var m=24;m>=0;m-=8)h<<=1,h|=c>>>m+g&1,h<<=1,h|=l>>>m+g&1;for(g=4;g<8;g++)for(m=24;m>=0;m-=8)f<<=1,f|=c>>>m+g&1,f<<=1,f|=l>>>m+g&1;u[d+0]=h>>>0,u[d+1]=f>>>0},s.pc1=function(l,c,u,d){for(var h=0,f=0,g=7;g>=5;g--){for(var m=0;m<=24;m+=8)h<<=1,h|=c>>m+g&1;for(m=0;m<=24;m+=8)h<<=1,h|=l>>m+g&1}for(m=0;m<=24;m+=8)h<<=1,h|=c>>m+g&1;for(g=1;g<=3;g++){for(m=0;m<=24;m+=8)f<<=1,f|=c>>m+g&1;for(m=0;m<=24;m+=8)f<<=1,f|=l>>m+g&1}for(m=0;m<=24;m+=8)f<<=1,f|=l>>m+g&1;u[d+0]=h>>>0,u[d+1]=f>>>0},s.r28shl=function(l,c){return l<<c&268435455|l>>>28-c};var a=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];s.pc2=function(l,c,u,d){for(var h=0,f=0,g=a.length>>>1,m=0;m<g;m++)h<<=1,h|=l>>>a[m]&1;for(m=g;m<a.length;m++)f<<=1,f|=c>>>a[m]&1;u[d+0]=h>>>0,u[d+1]=f>>>0},s.expand=function(l,c,u){var d=0,h=0;d=(1&l)<<5|l>>>27;for(var f=23;f>=15;f-=4)d<<=6,d|=l>>>f&63;for(f=11;f>=3;f-=4)h|=l>>>f&63,h<<=6;h|=(31&l)<<1|l>>>31,c[u+0]=d>>>0,c[u+1]=h>>>0};var i=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];s.substitute=function(l,c){for(var u=0,d=0;d<4;d++)u<<=4,u|=i[64*d+(l>>>18-6*d&63)];for(d=0;d<4;d++)u<<=4,u|=i[256+64*d+(c>>>18-6*d&63)];return u>>>0};var o=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];s.permute=function(l){for(var c=0,u=0;u<o.length;u++)c<<=1,c|=l>>>o[u]&1;return c>>>0},s.padSplit=function(l,c,u){for(var d=l.toString(2);d.length<c;)d="0"+d;for(var h=[],f=0;f<c;f+=u)h.push(d.slice(f,f+u));return h.join(" ")}},{}],400:[function(e,n,s){(function(a){(function(){var i=e("./lib/generatePrime"),o=e("./lib/primes.json"),l=e("./lib/dh"),c={binary:!0,hex:!0,base64:!0};s.DiffieHellmanGroup=s.createDiffieHellmanGroup=s.getDiffieHellman=function(u){var d=new a(o[u].prime,"hex"),h=new a(o[u].gen,"hex");return new l(d,h)},s.createDiffieHellman=s.DiffieHellman=function u(d,h,f,g){return a.isBuffer(h)||c[h]===void 0?u(d,"binary",h,f):(h=h||"binary",g=g||"binary",f=f||new a([2]),a.isBuffer(f)||(f=new a(f,g)),typeof d=="number"?new l(i(d,f),f,!0):(a.isBuffer(d)||(d=new a(d,h)),new l(d,f,!0)))}}).call(this)}).call(this,e("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(e,n,s){(function(a){(function(){var i=e("bn.js"),o=new(e("miller-rabin")),l=new i(24),c=new i(11),u=new i(10),d=new i(3),h=new i(7),f=e("./generatePrime"),g=e("randombytes");function m(k,N){return N=N||"utf8",a.isBuffer(k)||(k=new a(k,N)),this._pub=new i(k),this}function p(k,N){return N=N||"utf8",a.isBuffer(k)||(k=new a(k,N)),this._priv=new i(k),this}n.exports=b;var v={};function b(k,N,L){this.setGenerator(N),this.__prime=new i(k),this._prime=i.mont(this.__prime),this._primeLen=k.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,L?(this.setPublicKey=m,this.setPrivateKey=p):this._primeCode=8}function y(k,N){var L=new a(k.toArray());return N?L.toString(N):L}Object.defineProperty(b.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=function(k,N){var L=N.toString("hex"),F=[L,k.toString(16)].join("_");if(F in v)return v[F];var R,B=0;if(k.isEven()||!f.simpleSieve||!f.fermatTest(k)||!o.test(k))return B+=1,B+=L==="02"||L==="05"?8:4,v[F]=B,B;switch(o.test(k.shrn(1))||(B+=2),L){case"02":k.mod(l).cmp(c)&&(B+=8);break;case"05":(R=k.mod(u)).cmp(d)&&R.cmp(h)&&(B+=8);break;default:B+=4}return v[F]=B,B}(this.__prime,this.__gen)),this._primeCode}}),b.prototype.generateKeys=function(){return this._priv||(this._priv=new i(g(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},b.prototype.computeSecret=function(k){var N=(k=(k=new i(k)).toRed(this._prime)).redPow(this._priv).fromRed(),L=new a(N.toArray()),F=this.getPrime();if(L.length<F.length){var R=new a(F.length-L.length);R.fill(0),L=a.concat([R,L])}return L},b.prototype.getPublicKey=function(k){return y(this._pub,k)},b.prototype.getPrivateKey=function(k){return y(this._priv,k)},b.prototype.getPrime=function(k){return y(this.__prime,k)},b.prototype.getGenerator=function(k){return y(this._gen,k)},b.prototype.setGenerator=function(k,N){return N=N||"utf8",a.isBuffer(k)||(k=new a(k,N)),this.__gen=k,this._gen=new i(k),this}}).call(this)}).call(this,e("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(e,n,s){var a=e("randombytes");n.exports=k,k.simpleSieve=b,k.fermatTest=y;var i=e("bn.js"),o=new i(24),l=new(e("miller-rabin")),c=new i(1),u=new i(2),d=new i(5),h=(new i(16),new i(8),new i(10)),f=new i(3),g=(new i(7),new i(11)),m=new i(4),p=(new i(12),null);function v(){if(p!==null)return p;var N=[];N[0]=2;for(var L=1,F=3;F<1048576;F+=2){for(var R=Math.ceil(Math.sqrt(F)),B=0;B<L&&N[B]<=R&&F%N[B]!=0;B++);L!==B&&N[B]<=R||(N[L++]=F)}return p=N,N}function b(N){for(var L=v(),F=0;F<L.length;F++)if(N.modn(L[F])===0)return N.cmpn(L[F])===0;return!0}function y(N){var L=i.mont(N);return u.toRed(L).redPow(N.subn(1)).fromRed().cmpn(1)===0}function k(N,L){if(N<16)return new i(L===2||L===5?[140,123]:[140,39]);var F,R;for(L=new i(L);;){for(F=new i(a(Math.ceil(N/8)));F.bitLength()>N;)F.ishrn(1);if(F.isEven()&&F.iadd(c),F.testn(1)||F.iadd(u),L.cmp(u)){if(!L.cmp(d))for(;F.mod(h).cmp(f);)F.iadd(m)}else for(;F.mod(o).cmp(g);)F.iadd(m);if(b(R=F.shrn(1))&&b(F)&&y(R)&&y(F)&&l.test(R)&&l.test(F))return F}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(e,n,s){n.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(e,n,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],405:[function(e,n,s){var a=s;a.version=e("../package.json").version,a.utils=e("./elliptic/utils"),a.rand=e("brorand"),a.curve=e("./elliptic/curve"),a.curves=e("./elliptic/curves"),a.ec=e("./elliptic/ec"),a.eddsa=e("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(e,n,s){var a=e("bn.js"),i=e("../utils"),o=i.getNAF,l=i.getJSF,c=i.assert;function u(h,f){this.type=h,this.p=new a(f.p,16),this.red=f.prime?a.red(f.prime):a.mont(this.p),this.zero=new a(0).toRed(this.red),this.one=new a(1).toRed(this.red),this.two=new a(2).toRed(this.red),this.n=f.n&&new a(f.n,16),this.g=f.g&&this.pointFromJSON(f.g,f.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var g=this.n&&this.p.div(this.n);!g||g.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function d(h,f){this.curve=h,this.type=f,this.precomputed=null}n.exports=u,u.prototype.point=function(){throw new Error("Not implemented")},u.prototype.validate=function(){throw new Error("Not implemented")},u.prototype._fixedNafMul=function(h,f){c(h.precomputed);var g=h._getDoubles(),m=o(f,1,this._bitLength),p=(1<<g.step+1)-(g.step%2==0?2:1);p/=3;var v,b,y=[];for(v=0;v<m.length;v+=g.step){b=0;for(var k=v+g.step-1;k>=v;k--)b=(b<<1)+m[k];y.push(b)}for(var N=this.jpoint(null,null,null),L=this.jpoint(null,null,null),F=p;F>0;F--){for(v=0;v<y.length;v++)(b=y[v])===F?L=L.mixedAdd(g.points[v]):b===-F&&(L=L.mixedAdd(g.points[v].neg()));N=N.add(L)}return N.toP()},u.prototype._wnafMul=function(h,f){var g=4,m=h._getNAFPoints(g);g=m.wnd;for(var p=m.points,v=o(f,g,this._bitLength),b=this.jpoint(null,null,null),y=v.length-1;y>=0;y--){for(var k=0;y>=0&&v[y]===0;y--)k++;if(y>=0&&k++,b=b.dblp(k),y<0)break;var N=v[y];c(N!==0),b=h.type==="affine"?N>0?b.mixedAdd(p[N-1>>1]):b.mixedAdd(p[-N-1>>1].neg()):N>0?b.add(p[N-1>>1]):b.add(p[-N-1>>1].neg())}return h.type==="affine"?b.toP():b},u.prototype._wnafMulAdd=function(h,f,g,m,p){var v,b,y,k=this._wnafT1,N=this._wnafT2,L=this._wnafT3,F=0;for(v=0;v<m;v++){var R=(y=f[v])._getNAFPoints(h);k[v]=R.wnd,N[v]=R.points}for(v=m-1;v>=1;v-=2){var B=v-1,q=v;if(k[B]===1&&k[q]===1){var V=[f[B],null,null,f[q]];f[B].y.cmp(f[q].y)===0?(V[1]=f[B].add(f[q]),V[2]=f[B].toJ().mixedAdd(f[q].neg())):f[B].y.cmp(f[q].y.redNeg())===0?(V[1]=f[B].toJ().mixedAdd(f[q]),V[2]=f[B].add(f[q].neg())):(V[1]=f[B].toJ().mixedAdd(f[q]),V[2]=f[B].toJ().mixedAdd(f[q].neg()));var I=[-3,-1,-5,-7,0,7,5,1,3],C=l(g[B],g[q]);for(F=Math.max(C[0].length,F),L[B]=new Array(F),L[q]=new Array(F),b=0;b<F;b++){var O=0|C[0][b],E=0|C[1][b];L[B][b]=I[3*(O+1)+(E+1)],L[q][b]=0,N[B]=V}}else L[B]=o(g[B],k[B],this._bitLength),L[q]=o(g[q],k[q],this._bitLength),F=Math.max(L[B].length,F),F=Math.max(L[q].length,F)}var x=this.jpoint(null,null,null),w=this._wnafT4;for(v=F;v>=0;v--){for(var _=0;v>=0;){var S=!0;for(b=0;b<m;b++)w[b]=0|L[b][v],w[b]!==0&&(S=!1);if(!S)break;_++,v--}if(v>=0&&_++,x=x.dblp(_),v<0)break;for(b=0;b<m;b++){var T=w[b];T!==0&&(T>0?y=N[b][T-1>>1]:T<0&&(y=N[b][-T-1>>1].neg()),x=y.type==="affine"?x.mixedAdd(y):x.add(y))}}for(v=0;v<m;v++)N[v]=null;return p?x:x.toP()},u.BasePoint=d,d.prototype.eq=function(){throw new Error("Not implemented")},d.prototype.validate=function(){return this.curve.validate(this)},u.prototype.decodePoint=function(h,f){h=i.toArray(h,f);var g=this.p.byteLength();if((h[0]===4||h[0]===6||h[0]===7)&&h.length-1==2*g)return h[0]===6?c(h[h.length-1]%2==0):h[0]===7&&c(h[h.length-1]%2==1),this.point(h.slice(1,1+g),h.slice(1+g,1+2*g));if((h[0]===2||h[0]===3)&&h.length-1===g)return this.pointFromX(h.slice(1,1+g),h[0]===3);throw new Error("Unknown point format")},d.prototype.encodeCompressed=function(h){return this.encode(h,!0)},d.prototype._encode=function(h){var f=this.curve.p.byteLength(),g=this.getX().toArray("be",f);return h?[this.getY().isEven()?2:3].concat(g):[4].concat(g,this.getY().toArray("be",f))},d.prototype.encode=function(h,f){return i.encode(this._encode(f),h)},d.prototype.precompute=function(h){if(this.precomputed)return this;var f={doubles:null,naf:null,beta:null};return f.naf=this._getNAFPoints(8),f.doubles=this._getDoubles(4,h),f.beta=this._getBeta(),this.precomputed=f,this},d.prototype._hasDoubles=function(h){if(!this.precomputed)return!1;var f=this.precomputed.doubles;return!!f&&f.points.length>=Math.ceil((h.bitLength()+1)/f.step)},d.prototype._getDoubles=function(h,f){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var g=[this],m=this,p=0;p<f;p+=h){for(var v=0;v<h;v++)m=m.dbl();g.push(m)}return{step:h,points:g}},d.prototype._getNAFPoints=function(h){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var f=[this],g=(1<<h)-1,m=g===1?null:this.dbl(),p=1;p<g;p++)f[p]=f[p-1].add(m);return{wnd:h,points:f}},d.prototype._getBeta=function(){return null},d.prototype.dblp=function(h){for(var f=this,g=0;g<h;g++)f=f.dbl();return f}},{"../utils":419,"bn.js":420}],407:[function(e,n,s){var a=e("../utils"),i=e("bn.js"),o=e("inherits"),l=e("./base"),c=a.assert;function u(h){this.twisted=(0|h.a)!=1,this.mOneA=this.twisted&&(0|h.a)==-1,this.extended=this.mOneA,l.call(this,"edwards",h),this.a=new i(h.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new i(h.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new i(h.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),c(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|h.c)==1}function d(h,f,g,m,p){l.BasePoint.call(this,h,"projective"),f===null&&g===null&&m===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new i(f,16),this.y=new i(g,16),this.z=m?new i(m,16):this.curve.one,this.t=p&&new i(p,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}o(u,l),n.exports=u,u.prototype._mulA=function(h){return this.mOneA?h.redNeg():this.a.redMul(h)},u.prototype._mulC=function(h){return this.oneC?h:this.c.redMul(h)},u.prototype.jpoint=function(h,f,g,m){return this.point(h,f,g,m)},u.prototype.pointFromX=function(h,f){(h=new i(h,16)).red||(h=h.toRed(this.red));var g=h.redSqr(),m=this.c2.redSub(this.a.redMul(g)),p=this.one.redSub(this.c2.redMul(this.d).redMul(g)),v=m.redMul(p.redInvm()),b=v.redSqrt();if(b.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");var y=b.fromRed().isOdd();return(f&&!y||!f&&y)&&(b=b.redNeg()),this.point(h,b)},u.prototype.pointFromY=function(h,f){(h=new i(h,16)).red||(h=h.toRed(this.red));var g=h.redSqr(),m=g.redSub(this.c2),p=g.redMul(this.d).redMul(this.c2).redSub(this.a),v=m.redMul(p.redInvm());if(v.cmp(this.zero)===0){if(f)throw new Error("invalid point");return this.point(this.zero,h)}var b=v.redSqrt();if(b.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");return b.fromRed().isOdd()!==f&&(b=b.redNeg()),this.point(b,h)},u.prototype.validate=function(h){if(h.isInfinity())return!0;h.normalize();var f=h.x.redSqr(),g=h.y.redSqr(),m=f.redMul(this.a).redAdd(g),p=this.c2.redMul(this.one.redAdd(this.d.redMul(f).redMul(g)));return m.cmp(p)===0},o(d,l.BasePoint),u.prototype.pointFromJSON=function(h){return d.fromJSON(this,h)},u.prototype.point=function(h,f,g,m){return new d(this,h,f,g,m)},d.fromJSON=function(h,f){return new d(h,f[0],f[1],f[2])},d.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},d.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},d.prototype._extDbl=function(){var h=this.x.redSqr(),f=this.y.redSqr(),g=this.z.redSqr();g=g.redIAdd(g);var m=this.curve._mulA(h),p=this.x.redAdd(this.y).redSqr().redISub(h).redISub(f),v=m.redAdd(f),b=v.redSub(g),y=m.redSub(f),k=p.redMul(b),N=v.redMul(y),L=p.redMul(y),F=b.redMul(v);return this.curve.point(k,N,F,L)},d.prototype._projDbl=function(){var h,f,g,m,p,v,b=this.x.redAdd(this.y).redSqr(),y=this.x.redSqr(),k=this.y.redSqr();if(this.curve.twisted){var N=(m=this.curve._mulA(y)).redAdd(k);this.zOne?(h=b.redSub(y).redSub(k).redMul(N.redSub(this.curve.two)),f=N.redMul(m.redSub(k)),g=N.redSqr().redSub(N).redSub(N)):(p=this.z.redSqr(),v=N.redSub(p).redISub(p),h=b.redSub(y).redISub(k).redMul(v),f=N.redMul(m.redSub(k)),g=N.redMul(v))}else m=y.redAdd(k),p=this.curve._mulC(this.z).redSqr(),v=m.redSub(p).redSub(p),h=this.curve._mulC(b.redISub(m)).redMul(v),f=this.curve._mulC(m).redMul(y.redISub(k)),g=m.redMul(v);return this.curve.point(h,f,g)},d.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},d.prototype._extAdd=function(h){var f=this.y.redSub(this.x).redMul(h.y.redSub(h.x)),g=this.y.redAdd(this.x).redMul(h.y.redAdd(h.x)),m=this.t.redMul(this.curve.dd).redMul(h.t),p=this.z.redMul(h.z.redAdd(h.z)),v=g.redSub(f),b=p.redSub(m),y=p.redAdd(m),k=g.redAdd(f),N=v.redMul(b),L=y.redMul(k),F=v.redMul(k),R=b.redMul(y);return this.curve.point(N,L,R,F)},d.prototype._projAdd=function(h){var f,g,m=this.z.redMul(h.z),p=m.redSqr(),v=this.x.redMul(h.x),b=this.y.redMul(h.y),y=this.curve.d.redMul(v).redMul(b),k=p.redSub(y),N=p.redAdd(y),L=this.x.redAdd(this.y).redMul(h.x.redAdd(h.y)).redISub(v).redISub(b),F=m.redMul(k).redMul(L);return this.curve.twisted?(f=m.redMul(N).redMul(b.redSub(this.curve._mulA(v))),g=k.redMul(N)):(f=m.redMul(N).redMul(b.redSub(v)),g=this.curve._mulC(k).redMul(N)),this.curve.point(F,f,g)},d.prototype.add=function(h){return this.isInfinity()?h:h.isInfinity()?this:this.curve.extended?this._extAdd(h):this._projAdd(h)},d.prototype.mul=function(h){return this._hasDoubles(h)?this.curve._fixedNafMul(this,h):this.curve._wnafMul(this,h)},d.prototype.mulAdd=function(h,f,g){return this.curve._wnafMulAdd(1,[this,f],[h,g],2,!1)},d.prototype.jmulAdd=function(h,f,g){return this.curve._wnafMulAdd(1,[this,f],[h,g],2,!0)},d.prototype.normalize=function(){if(this.zOne)return this;var h=this.z.redInvm();return this.x=this.x.redMul(h),this.y=this.y.redMul(h),this.t&&(this.t=this.t.redMul(h)),this.z=this.curve.one,this.zOne=!0,this},d.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},d.prototype.getX=function(){return this.normalize(),this.x.fromRed()},d.prototype.getY=function(){return this.normalize(),this.y.fromRed()},d.prototype.eq=function(h){return this===h||this.getX().cmp(h.getX())===0&&this.getY().cmp(h.getY())===0},d.prototype.eqXToP=function(h){var f=h.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(f)===0)return!0;for(var g=h.clone(),m=this.curve.redN.redMul(this.z);;){if(g.iadd(this.curve.n),g.cmp(this.curve.p)>=0)return!1;if(f.redIAdd(m),this.x.cmp(f)===0)return!0}},d.prototype.toP=d.prototype.normalize,d.prototype.mixedAdd=d.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(e,n,s){var a=s;a.base=e("./base"),a.short=e("./short"),a.mont=e("./mont"),a.edwards=e("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(e,n,s){var a=e("bn.js"),i=e("inherits"),o=e("./base"),l=e("../utils");function c(d){o.call(this,"mont",d),this.a=new a(d.a,16).toRed(this.red),this.b=new a(d.b,16).toRed(this.red),this.i4=new a(4).toRed(this.red).redInvm(),this.two=new a(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function u(d,h,f){o.BasePoint.call(this,d,"projective"),h===null&&f===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new a(h,16),this.z=new a(f,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}i(c,o),n.exports=c,c.prototype.validate=function(d){var h=d.normalize().x,f=h.redSqr(),g=f.redMul(h).redAdd(f.redMul(this.a)).redAdd(h);return g.redSqrt().redSqr().cmp(g)===0},i(u,o.BasePoint),c.prototype.decodePoint=function(d,h){return this.point(l.toArray(d,h),1)},c.prototype.point=function(d,h){return new u(this,d,h)},c.prototype.pointFromJSON=function(d){return u.fromJSON(this,d)},u.prototype.precompute=function(){},u.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},u.fromJSON=function(d,h){return new u(d,h[0],h[1]||d.one)},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.z.cmpn(0)===0},u.prototype.dbl=function(){var d=this.x.redAdd(this.z).redSqr(),h=this.x.redSub(this.z).redSqr(),f=d.redSub(h),g=d.redMul(h),m=f.redMul(h.redAdd(this.curve.a24.redMul(f)));return this.curve.point(g,m)},u.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.diffAdd=function(d,h){var f=this.x.redAdd(this.z),g=this.x.redSub(this.z),m=d.x.redAdd(d.z),p=d.x.redSub(d.z).redMul(f),v=m.redMul(g),b=h.z.redMul(p.redAdd(v).redSqr()),y=h.x.redMul(p.redISub(v).redSqr());return this.curve.point(b,y)},u.prototype.mul=function(d){for(var h=d.clone(),f=this,g=this.curve.point(null,null),m=[];h.cmpn(0)!==0;h.iushrn(1))m.push(h.andln(1));for(var p=m.length-1;p>=0;p--)m[p]===0?(f=f.diffAdd(g,this),g=g.dbl()):(g=f.diffAdd(g,this),f=f.dbl());return g},u.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.eq=function(d){return this.getX().cmp(d.getX())===0},u.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(e,n,s){var a=e("../utils"),i=e("bn.js"),o=e("inherits"),l=e("./base"),c=a.assert;function u(f){l.call(this,"short",f),this.a=new i(f.a,16).toRed(this.red),this.b=new i(f.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(f),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function d(f,g,m,p){l.BasePoint.call(this,f,"affine"),g===null&&m===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(g,16),this.y=new i(m,16),p&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function h(f,g,m,p){l.BasePoint.call(this,f,"jacobian"),g===null&&m===null&&p===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(g,16),this.y=new i(m,16),this.z=new i(p,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}o(u,l),n.exports=u,u.prototype._getEndomorphism=function(f){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var g,m;if(f.beta)g=new i(f.beta,16).toRed(this.red);else{var p=this._getEndoRoots(this.p);g=(g=p[0].cmp(p[1])<0?p[0]:p[1]).toRed(this.red)}if(f.lambda)m=new i(f.lambda,16);else{var v=this._getEndoRoots(this.n);this.g.mul(v[0]).x.cmp(this.g.x.redMul(g))===0?m=v[0]:(m=v[1],c(this.g.mul(m).x.cmp(this.g.x.redMul(g))===0))}return{beta:g,lambda:m,basis:f.basis?f.basis.map(function(b){return{a:new i(b.a,16),b:new i(b.b,16)}}):this._getEndoBasis(m)}}},u.prototype._getEndoRoots=function(f){var g=f===this.p?this.red:i.mont(f),m=new i(2).toRed(g).redInvm(),p=m.redNeg(),v=new i(3).toRed(g).redNeg().redSqrt().redMul(m);return[p.redAdd(v).fromRed(),p.redSub(v).fromRed()]},u.prototype._getEndoBasis=function(f){for(var g,m,p,v,b,y,k,N,L,F=this.n.ushrn(Math.floor(this.n.bitLength()/2)),R=f,B=this.n.clone(),q=new i(1),V=new i(0),I=new i(0),C=new i(1),O=0;R.cmpn(0)!==0;){var E=B.div(R);N=B.sub(E.mul(R)),L=I.sub(E.mul(q));var x=C.sub(E.mul(V));if(!p&&N.cmp(F)<0)g=k.neg(),m=q,p=N.neg(),v=L;else if(p&&++O==2)break;k=N,B=R,R=N,I=q,q=L,C=V,V=x}b=N.neg(),y=L;var w=p.sqr().add(v.sqr());return b.sqr().add(y.sqr()).cmp(w)>=0&&(b=g,y=m),p.negative&&(p=p.neg(),v=v.neg()),b.negative&&(b=b.neg(),y=y.neg()),[{a:p,b:v},{a:b,b:y}]},u.prototype._endoSplit=function(f){var g=this.endo.basis,m=g[0],p=g[1],v=p.b.mul(f).divRound(this.n),b=m.b.neg().mul(f).divRound(this.n),y=v.mul(m.a),k=b.mul(p.a),N=v.mul(m.b),L=b.mul(p.b);return{k1:f.sub(y).sub(k),k2:N.add(L).neg()}},u.prototype.pointFromX=function(f,g){(f=new i(f,16)).red||(f=f.toRed(this.red));var m=f.redSqr().redMul(f).redIAdd(f.redMul(this.a)).redIAdd(this.b),p=m.redSqrt();if(p.redSqr().redSub(m).cmp(this.zero)!==0)throw new Error("invalid point");var v=p.fromRed().isOdd();return(g&&!v||!g&&v)&&(p=p.redNeg()),this.point(f,p)},u.prototype.validate=function(f){if(f.inf)return!0;var g=f.x,m=f.y,p=this.a.redMul(g),v=g.redSqr().redMul(g).redIAdd(p).redIAdd(this.b);return m.redSqr().redISub(v).cmpn(0)===0},u.prototype._endoWnafMulAdd=function(f,g,m){for(var p=this._endoWnafT1,v=this._endoWnafT2,b=0;b<f.length;b++){var y=this._endoSplit(g[b]),k=f[b],N=k._getBeta();y.k1.negative&&(y.k1.ineg(),k=k.neg(!0)),y.k2.negative&&(y.k2.ineg(),N=N.neg(!0)),p[2*b]=k,p[2*b+1]=N,v[2*b]=y.k1,v[2*b+1]=y.k2}for(var L=this._wnafMulAdd(1,p,v,2*b,m),F=0;F<2*b;F++)p[F]=null,v[F]=null;return L},o(d,l.BasePoint),u.prototype.point=function(f,g,m){return new d(this,f,g,m)},u.prototype.pointFromJSON=function(f,g){return d.fromJSON(this,f,g)},d.prototype._getBeta=function(){if(this.curve.endo){var f=this.precomputed;if(f&&f.beta)return f.beta;var g=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(f){var m=this.curve,p=function(v){return m.point(v.x.redMul(m.endo.beta),v.y)};f.beta=g,g.precomputed={beta:null,naf:f.naf&&{wnd:f.naf.wnd,points:f.naf.points.map(p)},doubles:f.doubles&&{step:f.doubles.step,points:f.doubles.points.map(p)}}}return g}},d.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},d.fromJSON=function(f,g,m){typeof g=="string"&&(g=JSON.parse(g));var p=f.point(g[0],g[1],m);if(!g[2])return p;function v(y){return f.point(y[0],y[1],m)}var b=g[2];return p.precomputed={beta:null,doubles:b.doubles&&{step:b.doubles.step,points:[p].concat(b.doubles.points.map(v))},naf:b.naf&&{wnd:b.naf.wnd,points:[p].concat(b.naf.points.map(v))}},p},d.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},d.prototype.isInfinity=function(){return this.inf},d.prototype.add=function(f){if(this.inf)return f;if(f.inf)return this;if(this.eq(f))return this.dbl();if(this.neg().eq(f))return this.curve.point(null,null);if(this.x.cmp(f.x)===0)return this.curve.point(null,null);var g=this.y.redSub(f.y);g.cmpn(0)!==0&&(g=g.redMul(this.x.redSub(f.x).redInvm()));var m=g.redSqr().redISub(this.x).redISub(f.x),p=g.redMul(this.x.redSub(m)).redISub(this.y);return this.curve.point(m,p)},d.prototype.dbl=function(){if(this.inf)return this;var f=this.y.redAdd(this.y);if(f.cmpn(0)===0)return this.curve.point(null,null);var g=this.curve.a,m=this.x.redSqr(),p=f.redInvm(),v=m.redAdd(m).redIAdd(m).redIAdd(g).redMul(p),b=v.redSqr().redISub(this.x.redAdd(this.x)),y=v.redMul(this.x.redSub(b)).redISub(this.y);return this.curve.point(b,y)},d.prototype.getX=function(){return this.x.fromRed()},d.prototype.getY=function(){return this.y.fromRed()},d.prototype.mul=function(f){return f=new i(f,16),this.isInfinity()?this:this._hasDoubles(f)?this.curve._fixedNafMul(this,f):this.curve.endo?this.curve._endoWnafMulAdd([this],[f]):this.curve._wnafMul(this,f)},d.prototype.mulAdd=function(f,g,m){var p=[this,g],v=[f,m];return this.curve.endo?this.curve._endoWnafMulAdd(p,v):this.curve._wnafMulAdd(1,p,v,2)},d.prototype.jmulAdd=function(f,g,m){var p=[this,g],v=[f,m];return this.curve.endo?this.curve._endoWnafMulAdd(p,v,!0):this.curve._wnafMulAdd(1,p,v,2,!0)},d.prototype.eq=function(f){return this===f||this.inf===f.inf&&(this.inf||this.x.cmp(f.x)===0&&this.y.cmp(f.y)===0)},d.prototype.neg=function(f){if(this.inf)return this;var g=this.curve.point(this.x,this.y.redNeg());if(f&&this.precomputed){var m=this.precomputed,p=function(v){return v.neg()};g.precomputed={naf:m.naf&&{wnd:m.naf.wnd,points:m.naf.points.map(p)},doubles:m.doubles&&{step:m.doubles.step,points:m.doubles.points.map(p)}}}return g},d.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},o(h,l.BasePoint),u.prototype.jpoint=function(f,g,m){return new h(this,f,g,m)},h.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var f=this.z.redInvm(),g=f.redSqr(),m=this.x.redMul(g),p=this.y.redMul(g).redMul(f);return this.curve.point(m,p)},h.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},h.prototype.add=function(f){if(this.isInfinity())return f;if(f.isInfinity())return this;var g=f.z.redSqr(),m=this.z.redSqr(),p=this.x.redMul(g),v=f.x.redMul(m),b=this.y.redMul(g.redMul(f.z)),y=f.y.redMul(m.redMul(this.z)),k=p.redSub(v),N=b.redSub(y);if(k.cmpn(0)===0)return N.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var L=k.redSqr(),F=L.redMul(k),R=p.redMul(L),B=N.redSqr().redIAdd(F).redISub(R).redISub(R),q=N.redMul(R.redISub(B)).redISub(b.redMul(F)),V=this.z.redMul(f.z).redMul(k);return this.curve.jpoint(B,q,V)},h.prototype.mixedAdd=function(f){if(this.isInfinity())return f.toJ();if(f.isInfinity())return this;var g=this.z.redSqr(),m=this.x,p=f.x.redMul(g),v=this.y,b=f.y.redMul(g).redMul(this.z),y=m.redSub(p),k=v.redSub(b);if(y.cmpn(0)===0)return k.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var N=y.redSqr(),L=N.redMul(y),F=m.redMul(N),R=k.redSqr().redIAdd(L).redISub(F).redISub(F),B=k.redMul(F.redISub(R)).redISub(v.redMul(L)),q=this.z.redMul(y);return this.curve.jpoint(R,B,q)},h.prototype.dblp=function(f){if(f===0)return this;if(this.isInfinity())return this;if(!f)return this.dbl();var g;if(this.curve.zeroA||this.curve.threeA){var m=this;for(g=0;g<f;g++)m=m.dbl();return m}var p=this.curve.a,v=this.curve.tinv,b=this.x,y=this.y,k=this.z,N=k.redSqr().redSqr(),L=y.redAdd(y);for(g=0;g<f;g++){var F=b.redSqr(),R=L.redSqr(),B=R.redSqr(),q=F.redAdd(F).redIAdd(F).redIAdd(p.redMul(N)),V=b.redMul(R),I=q.redSqr().redISub(V.redAdd(V)),C=V.redISub(I),O=q.redMul(C);O=O.redIAdd(O).redISub(B);var E=L.redMul(k);g+1<f&&(N=N.redMul(B)),b=I,k=E,L=O}return this.curve.jpoint(b,L.redMul(v),k)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},h.prototype._zeroDbl=function(){var f,g,m;if(this.zOne){var p=this.x.redSqr(),v=this.y.redSqr(),b=v.redSqr(),y=this.x.redAdd(v).redSqr().redISub(p).redISub(b);y=y.redIAdd(y);var k=p.redAdd(p).redIAdd(p),N=k.redSqr().redISub(y).redISub(y),L=b.redIAdd(b);L=(L=L.redIAdd(L)).redIAdd(L),f=N,g=k.redMul(y.redISub(N)).redISub(L),m=this.y.redAdd(this.y)}else{var F=this.x.redSqr(),R=this.y.redSqr(),B=R.redSqr(),q=this.x.redAdd(R).redSqr().redISub(F).redISub(B);q=q.redIAdd(q);var V=F.redAdd(F).redIAdd(F),I=V.redSqr(),C=B.redIAdd(B);C=(C=C.redIAdd(C)).redIAdd(C),f=I.redISub(q).redISub(q),g=V.redMul(q.redISub(f)).redISub(C),m=(m=this.y.redMul(this.z)).redIAdd(m)}return this.curve.jpoint(f,g,m)},h.prototype._threeDbl=function(){var f,g,m;if(this.zOne){var p=this.x.redSqr(),v=this.y.redSqr(),b=v.redSqr(),y=this.x.redAdd(v).redSqr().redISub(p).redISub(b);y=y.redIAdd(y);var k=p.redAdd(p).redIAdd(p).redIAdd(this.curve.a),N=k.redSqr().redISub(y).redISub(y);f=N;var L=b.redIAdd(b);L=(L=L.redIAdd(L)).redIAdd(L),g=k.redMul(y.redISub(N)).redISub(L),m=this.y.redAdd(this.y)}else{var F=this.z.redSqr(),R=this.y.redSqr(),B=this.x.redMul(R),q=this.x.redSub(F).redMul(this.x.redAdd(F));q=q.redAdd(q).redIAdd(q);var V=B.redIAdd(B),I=(V=V.redIAdd(V)).redAdd(V);f=q.redSqr().redISub(I),m=this.y.redAdd(this.z).redSqr().redISub(R).redISub(F);var C=R.redSqr();C=(C=(C=C.redIAdd(C)).redIAdd(C)).redIAdd(C),g=q.redMul(V.redISub(f)).redISub(C)}return this.curve.jpoint(f,g,m)},h.prototype._dbl=function(){var f=this.curve.a,g=this.x,m=this.y,p=this.z,v=p.redSqr().redSqr(),b=g.redSqr(),y=m.redSqr(),k=b.redAdd(b).redIAdd(b).redIAdd(f.redMul(v)),N=g.redAdd(g),L=(N=N.redIAdd(N)).redMul(y),F=k.redSqr().redISub(L.redAdd(L)),R=L.redISub(F),B=y.redSqr();B=(B=(B=B.redIAdd(B)).redIAdd(B)).redIAdd(B);var q=k.redMul(R).redISub(B),V=m.redAdd(m).redMul(p);return this.curve.jpoint(F,q,V)},h.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var f=this.x.redSqr(),g=this.y.redSqr(),m=this.z.redSqr(),p=g.redSqr(),v=f.redAdd(f).redIAdd(f),b=v.redSqr(),y=this.x.redAdd(g).redSqr().redISub(f).redISub(p),k=(y=(y=(y=y.redIAdd(y)).redAdd(y).redIAdd(y)).redISub(b)).redSqr(),N=p.redIAdd(p);N=(N=(N=N.redIAdd(N)).redIAdd(N)).redIAdd(N);var L=v.redIAdd(y).redSqr().redISub(b).redISub(k).redISub(N),F=g.redMul(L);F=(F=F.redIAdd(F)).redIAdd(F);var R=this.x.redMul(k).redISub(F);R=(R=R.redIAdd(R)).redIAdd(R);var B=this.y.redMul(L.redMul(N.redISub(L)).redISub(y.redMul(k)));B=(B=(B=B.redIAdd(B)).redIAdd(B)).redIAdd(B);var q=this.z.redAdd(y).redSqr().redISub(m).redISub(k);return this.curve.jpoint(R,B,q)},h.prototype.mul=function(f,g){return f=new i(f,g),this.curve._wnafMul(this,f)},h.prototype.eq=function(f){if(f.type==="affine")return this.eq(f.toJ());if(this===f)return!0;var g=this.z.redSqr(),m=f.z.redSqr();if(this.x.redMul(m).redISub(f.x.redMul(g)).cmpn(0)!==0)return!1;var p=g.redMul(this.z),v=m.redMul(f.z);return this.y.redMul(v).redISub(f.y.redMul(p)).cmpn(0)===0},h.prototype.eqXToP=function(f){var g=this.z.redSqr(),m=f.toRed(this.curve.red).redMul(g);if(this.x.cmp(m)===0)return!0;for(var p=f.clone(),v=this.curve.redN.redMul(g);;){if(p.iadd(this.curve.n),p.cmp(this.curve.p)>=0)return!1;if(m.redIAdd(v),this.x.cmp(m)===0)return!0}},h.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},h.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(e,n,s){var a,i=s,o=e("hash.js"),l=e("./curve"),c=e("./utils").assert;function u(h){h.type==="short"?this.curve=new l.short(h):h.type==="edwards"?this.curve=new l.edwards(h):this.curve=new l.mont(h),this.g=this.curve.g,this.n=this.curve.n,this.hash=h.hash,c(this.g.validate(),"Invalid curve"),c(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function d(h,f){Object.defineProperty(i,h,{configurable:!0,enumerable:!0,get:function(){var g=new u(f);return Object.defineProperty(i,h,{configurable:!0,enumerable:!0,value:g}),g}})}i.PresetCurve=u,d("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:o.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),d("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:o.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),d("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:o.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),d("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:o.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),d("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:o.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),d("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["9"]}),d("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{a=e("./precomputed/secp256k1")}catch{a=void 0}d("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:o.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",a]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(e,n,s){var a=e("bn.js"),i=e("hmac-drbg"),o=e("../utils"),l=e("../curves"),c=e("brorand"),u=o.assert,d=e("./key"),h=e("./signature");function f(g){if(!(this instanceof f))return new f(g);typeof g=="string"&&(u(Object.prototype.hasOwnProperty.call(l,g),"Unknown curve "+g),g=l[g]),g instanceof l.PresetCurve&&(g={curve:g}),this.curve=g.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=g.curve.g,this.g.precompute(g.curve.n.bitLength()+1),this.hash=g.hash||g.curve.hash}n.exports=f,f.prototype.keyPair=function(g){return new d(this,g)},f.prototype.keyFromPrivate=function(g,m){return d.fromPrivate(this,g,m)},f.prototype.keyFromPublic=function(g,m){return d.fromPublic(this,g,m)},f.prototype.genKeyPair=function(g){g||(g={});for(var m=new i({hash:this.hash,pers:g.pers,persEnc:g.persEnc||"utf8",entropy:g.entropy||c(this.hash.hmacStrength),entropyEnc:g.entropy&&g.entropyEnc||"utf8",nonce:this.n.toArray()}),p=this.n.byteLength(),v=this.n.sub(new a(2));;){var b=new a(m.generate(p));if(!(b.cmp(v)>0))return b.iaddn(1),this.keyFromPrivate(b)}},f.prototype._truncateToN=function(g,m){var p=8*g.byteLength()-this.n.bitLength();return p>0&&(g=g.ushrn(p)),!m&&g.cmp(this.n)>=0?g.sub(this.n):g},f.prototype.sign=function(g,m,p,v){typeof p=="object"&&(v=p,p=null),v||(v={}),m=this.keyFromPrivate(m,p),g=this._truncateToN(new a(g,16));for(var b=this.n.byteLength(),y=m.getPrivate().toArray("be",b),k=g.toArray("be",b),N=new i({hash:this.hash,entropy:y,nonce:k,pers:v.pers,persEnc:v.persEnc||"utf8"}),L=this.n.sub(new a(1)),F=0;;F++){var R=v.k?v.k(F):new a(N.generate(this.n.byteLength()));if(!((R=this._truncateToN(R,!0)).cmpn(1)<=0||R.cmp(L)>=0)){var B=this.g.mul(R);if(!B.isInfinity()){var q=B.getX(),V=q.umod(this.n);if(V.cmpn(0)!==0){var I=R.invm(this.n).mul(V.mul(m.getPrivate()).iadd(g));if((I=I.umod(this.n)).cmpn(0)!==0){var C=(B.getY().isOdd()?1:0)|(q.cmp(V)!==0?2:0);return v.canonical&&I.cmp(this.nh)>0&&(I=this.n.sub(I),C^=1),new h({r:V,s:I,recoveryParam:C})}}}}}},f.prototype.verify=function(g,m,p,v){g=this._truncateToN(new a(g,16)),p=this.keyFromPublic(p,v);var b=(m=new h(m,"hex")).r,y=m.s;if(b.cmpn(1)<0||b.cmp(this.n)>=0||y.cmpn(1)<0||y.cmp(this.n)>=0)return!1;var k,N=y.invm(this.n),L=N.mul(g).umod(this.n),F=N.mul(b).umod(this.n);return this.curve._maxwellTrick?!(k=this.g.jmulAdd(L,p.getPublic(),F)).isInfinity()&&k.eqXToP(b):!(k=this.g.mulAdd(L,p.getPublic(),F)).isInfinity()&&k.getX().umod(this.n).cmp(b)===0},f.prototype.recoverPubKey=function(g,m,p,v){u((3&p)===p,"The recovery param is more than two bits"),m=new h(m,v);var b=this.n,y=new a(g),k=m.r,N=m.s,L=1&p,F=p>>1;if(k.cmp(this.curve.p.umod(this.curve.n))>=0&&F)throw new Error("Unable to find sencond key candinate");k=F?this.curve.pointFromX(k.add(this.curve.n),L):this.curve.pointFromX(k,L);var R=m.r.invm(b),B=b.sub(y).mul(R).umod(b),q=N.mul(R).umod(b);return this.g.mulAdd(B,k,q)},f.prototype.getKeyRecoveryParam=function(g,m,p,v){if((m=new h(m,v)).recoveryParam!==null)return m.recoveryParam;for(var b=0;b<4;b++){var y;try{y=this.recoverPubKey(g,m,b)}catch{continue}if(y.eq(p))return b}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(e,n,s){var a=e("bn.js"),i=e("../utils").assert;function o(l,c){this.ec=l,this.priv=null,this.pub=null,c.priv&&this._importPrivate(c.priv,c.privEnc),c.pub&&this._importPublic(c.pub,c.pubEnc)}n.exports=o,o.fromPublic=function(l,c,u){return c instanceof o?c:new o(l,{pub:c,pubEnc:u})},o.fromPrivate=function(l,c,u){return c instanceof o?c:new o(l,{priv:c,privEnc:u})},o.prototype.validate=function(){var l=this.getPublic();return l.isInfinity()?{result:!1,reason:"Invalid public key"}:l.validate()?l.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},o.prototype.getPublic=function(l,c){return typeof l=="string"&&(c=l,l=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),c?this.pub.encode(c,l):this.pub},o.prototype.getPrivate=function(l){return l==="hex"?this.priv.toString(16,2):this.priv},o.prototype._importPrivate=function(l,c){this.priv=new a(l,c||16),this.priv=this.priv.umod(this.ec.curve.n)},o.prototype._importPublic=function(l,c){if(l.x||l.y)return this.ec.curve.type==="mont"?i(l.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||i(l.x&&l.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(l.x,l.y));this.pub=this.ec.curve.decodePoint(l,c)},o.prototype.derive=function(l){return l.validate()||i(l.validate(),"public point not validated"),l.mul(this.priv).getX()},o.prototype.sign=function(l,c,u){return this.ec.sign(l,this,c,u)},o.prototype.verify=function(l,c){return this.ec.verify(l,c,this)},o.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(e,n,s){var a=e("bn.js"),i=e("../utils"),o=i.assert;function l(f,g){if(f instanceof l)return f;this._importDER(f,g)||(o(f.r&&f.s,"Signature without r or s"),this.r=new a(f.r,16),this.s=new a(f.s,16),f.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=f.recoveryParam)}function c(){this.place=0}function u(f,g){var m=f[g.place++];if(!(128&m))return m;var p=15&m;if(p===0||p>4)return!1;for(var v=0,b=0,y=g.place;b<p;b++,y++)v<<=8,v|=f[y],v>>>=0;return!(v<=127)&&(g.place=y,v)}function d(f){for(var g=0,m=f.length-1;!f[g]&&!(128&f[g+1])&&g<m;)g++;return g===0?f:f.slice(g)}function h(f,g){if(g<128)f.push(g);else{var m=1+(Math.log(g)/Math.LN2>>>3);for(f.push(128|m);--m;)f.push(g>>>(m<<3)&255);f.push(g)}}n.exports=l,l.prototype._importDER=function(f,g){f=i.toArray(f,g);var m=new c;if(f[m.place++]!==48)return!1;var p=u(f,m);if(p===!1||p+m.place!==f.length||f[m.place++]!==2)return!1;var v=u(f,m);if(v===!1)return!1;var b=f.slice(m.place,v+m.place);if(m.place+=v,f[m.place++]!==2)return!1;var y=u(f,m);if(y===!1||f.length!==y+m.place)return!1;var k=f.slice(m.place,y+m.place);if(b[0]===0){if(!(128&b[1]))return!1;b=b.slice(1)}if(k[0]===0){if(!(128&k[1]))return!1;k=k.slice(1)}return this.r=new a(b),this.s=new a(k),this.recoveryParam=null,!0},l.prototype.toDER=function(f){var g=this.r.toArray(),m=this.s.toArray();for(128&g[0]&&(g=[0].concat(g)),128&m[0]&&(m=[0].concat(m)),g=d(g),m=d(m);!(m[0]||128&m[1]);)m=m.slice(1);var p=[2];h(p,g.length),(p=p.concat(g)).push(2),h(p,m.length);var v=p.concat(m),b=[48];return h(b,v.length),b=b.concat(v),i.encode(b,f)}},{"../utils":419,"bn.js":420}],415:[function(e,n,s){var a=e("hash.js"),i=e("../curves"),o=e("../utils"),l=o.assert,c=o.parseBytes,u=e("./key"),d=e("./signature");function h(f){if(l(f==="ed25519","only tested with ed25519 so far"),!(this instanceof h))return new h(f);f=i[f].curve,this.curve=f,this.g=f.g,this.g.precompute(f.n.bitLength()+1),this.pointClass=f.point().constructor,this.encodingLength=Math.ceil(f.n.bitLength()/8),this.hash=a.sha512}n.exports=h,h.prototype.sign=function(f,g){f=c(f);var m=this.keyFromSecret(g),p=this.hashInt(m.messagePrefix(),f),v=this.g.mul(p),b=this.encodePoint(v),y=this.hashInt(b,m.pubBytes(),f).mul(m.priv()),k=p.add(y).umod(this.curve.n);return this.makeSignature({R:v,S:k,Rencoded:b})},h.prototype.verify=function(f,g,m){f=c(f),g=this.makeSignature(g);var p=this.keyFromPublic(m),v=this.hashInt(g.Rencoded(),p.pubBytes(),f),b=this.g.mul(g.S());return g.R().add(p.pub().mul(v)).eq(b)},h.prototype.hashInt=function(){for(var f=this.hash(),g=0;g<arguments.length;g++)f.update(arguments[g]);return o.intFromLE(f.digest()).umod(this.curve.n)},h.prototype.keyFromPublic=function(f){return u.fromPublic(this,f)},h.prototype.keyFromSecret=function(f){return u.fromSecret(this,f)},h.prototype.makeSignature=function(f){return f instanceof d?f:new d(this,f)},h.prototype.encodePoint=function(f){var g=f.getY().toArray("le",this.encodingLength);return g[this.encodingLength-1]|=f.getX().isOdd()?128:0,g},h.prototype.decodePoint=function(f){var g=(f=o.parseBytes(f)).length-1,m=f.slice(0,g).concat(-129&f[g]),p=(128&f[g])!=0,v=o.intFromLE(m);return this.curve.pointFromY(v,p)},h.prototype.encodeInt=function(f){return f.toArray("le",this.encodingLength)},h.prototype.decodeInt=function(f){return o.intFromLE(f)},h.prototype.isPoint=function(f){return f instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(e,n,s){var a=e("../utils"),i=a.assert,o=a.parseBytes,l=a.cachedProperty;function c(u,d){this.eddsa=u,this._secret=o(d.secret),u.isPoint(d.pub)?this._pub=d.pub:this._pubBytes=o(d.pub)}c.fromPublic=function(u,d){return d instanceof c?d:new c(u,{pub:d})},c.fromSecret=function(u,d){return d instanceof c?d:new c(u,{secret:d})},c.prototype.secret=function(){return this._secret},l(c,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),l(c,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),l(c,"privBytes",function(){var u=this.eddsa,d=this.hash(),h=u.encodingLength-1,f=d.slice(0,u.encodingLength);return f[0]&=248,f[h]&=127,f[h]|=64,f}),l(c,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),l(c,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),l(c,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),c.prototype.sign=function(u){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(u,this)},c.prototype.verify=function(u,d){return this.eddsa.verify(u,d,this)},c.prototype.getSecret=function(u){return i(this._secret,"KeyPair is public only"),a.encode(this.secret(),u)},c.prototype.getPublic=function(u){return a.encode(this.pubBytes(),u)},n.exports=c},{"../utils":419}],417:[function(e,n,s){var a=e("bn.js"),i=e("../utils"),o=i.assert,l=i.cachedProperty,c=i.parseBytes;function u(d,h){this.eddsa=d,typeof h!="object"&&(h=c(h)),Array.isArray(h)&&(h={R:h.slice(0,d.encodingLength),S:h.slice(d.encodingLength)}),o(h.R&&h.S,"Signature without R or S"),d.isPoint(h.R)&&(this._R=h.R),h.S instanceof a&&(this._S=h.S),this._Rencoded=Array.isArray(h.R)?h.R:h.Rencoded,this._Sencoded=Array.isArray(h.S)?h.S:h.Sencoded}l(u,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),l(u,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),l(u,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),l(u,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),u.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},u.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},n.exports=u},{"../utils":419,"bn.js":420}],418:[function(e,n,s){n.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(e,n,s){var a=s,i=e("bn.js"),o=e("minimalistic-assert"),l=e("minimalistic-crypto-utils");a.assert=o,a.toArray=l.toArray,a.zero2=l.zero2,a.toHex=l.toHex,a.encode=l.encode,a.getNAF=function(c,u,d){var h=new Array(Math.max(c.bitLength(),d)+1);h.fill(0);for(var f=1<<u+1,g=c.clone(),m=0;m<h.length;m++){var p,v=g.andln(f-1);g.isOdd()?(p=v>(f>>1)-1?(f>>1)-v:v,g.isubn(p)):p=0,h[m]=p,g.iushrn(1)}return h},a.getJSF=function(c,u){var d=[[],[]];c=c.clone(),u=u.clone();for(var h,f=0,g=0;c.cmpn(-f)>0||u.cmpn(-g)>0;){var m,p,v=c.andln(3)+f&3,b=u.andln(3)+g&3;v===3&&(v=-1),b===3&&(b=-1),m=1&v?(h=c.andln(7)+f&7)!==3&&h!==5||b!==2?v:-v:0,d[0].push(m),p=1&b?(h=u.andln(7)+g&7)!==3&&h!==5||v!==2?b:-b:0,d[1].push(p),2*f===m+1&&(f=1-f),2*g===p+1&&(g=1-g),c.iushrn(1),u.iushrn(1)}return d},a.cachedProperty=function(c,u,d){var h="_"+u;c.prototype[u]=function(){return this[h]!==void 0?this[h]:this[h]=d.call(this)}},a.parseBytes=function(c){return typeof c=="string"?a.toArray(c,"hex"):c},a.intFromLE=function(c){return new i(c,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(e,n,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],421:[function(e,n,s){n.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(e,n,s){var a=Object.create||function(R){var B=function(){};return B.prototype=R,new B},i=Object.keys||function(R){var B=[];for(var q in R)Object.prototype.hasOwnProperty.call(R,q)&&B.push(q);return q},o=Function.prototype.bind||function(R){var B=this;return function(){return B.apply(R,arguments)}};function l(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=a(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}n.exports=l,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._maxListeners=void 0;var c,u=10;try{var d={};Object.defineProperty&&Object.defineProperty(d,"x",{value:0}),c=d.x===0}catch{c=!1}function h(R){return R._maxListeners===void 0?l.defaultMaxListeners:R._maxListeners}function f(R,B,q){if(B)R.call(q);else for(var V=R.length,I=F(R,V),C=0;C<V;++C)I[C].call(q)}function g(R,B,q,V){if(B)R.call(q,V);else for(var I=R.length,C=F(R,I),O=0;O<I;++O)C[O].call(q,V)}function m(R,B,q,V,I){if(B)R.call(q,V,I);else for(var C=R.length,O=F(R,C),E=0;E<C;++E)O[E].call(q,V,I)}function p(R,B,q,V,I,C){if(B)R.call(q,V,I,C);else for(var O=R.length,E=F(R,O),x=0;x<O;++x)E[x].call(q,V,I,C)}function v(R,B,q,V){if(B)R.apply(q,V);else for(var I=R.length,C=F(R,I),O=0;O<I;++O)C[O].apply(q,V)}function b(R,B,q,V){var I,C,O;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if((C=R._events)?(C.newListener&&(R.emit("newListener",B,q.listener?q.listener:q),C=R._events),O=C[B]):(C=R._events=a(null),R._eventsCount=0),O){if(typeof O=="function"?O=C[B]=V?[q,O]:[O,q]:V?O.unshift(q):O.push(q),!O.warned&&(I=h(R))&&I>0&&O.length>I){O.warned=!0;var E=new Error("Possible EventEmitter memory leak detected. "+O.length+' "'+String(B)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');E.name="MaxListenersExceededWarning",E.emitter=R,E.type=B,E.count=O.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",E.name,E.message)}}else O=C[B]=q,++R._eventsCount;return R}function y(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var R=new Array(arguments.length),B=0;B<R.length;++B)R[B]=arguments[B];this.listener.apply(this.target,R)}}function k(R,B,q){var V={fired:!1,wrapFn:void 0,target:R,type:B,listener:q},I=o.call(y,V);return I.listener=q,V.wrapFn=I,I}function N(R,B,q){var V=R._events;if(!V)return[];var I=V[B];return I?typeof I=="function"?q?[I.listener||I]:[I]:q?function(C){for(var O=new Array(C.length),E=0;E<O.length;++E)O[E]=C[E].listener||C[E];return O}(I):F(I,I.length):[]}function L(R){var B=this._events;if(B){var q=B[R];if(typeof q=="function")return 1;if(q)return q.length}return 0}function F(R,B){for(var q=new Array(B),V=0;V<B;++V)q[V]=R[V];return q}c?Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(R){if(typeof R!="number"||R<0||R!=R)throw new TypeError('"defaultMaxListeners" must be a positive number');u=R}}):l.defaultMaxListeners=u,l.prototype.setMaxListeners=function(R){if(typeof R!="number"||R<0||isNaN(R))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=R,this},l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(R){var B,q,V,I,C,O,E=R==="error";if(O=this._events)E=E&&O.error==null;else if(!E)return!1;if(E){if(arguments.length>1&&(B=arguments[1]),B instanceof Error)throw B;var x=new Error('Unhandled "error" event. ('+B+")");throw x.context=B,x}if(!(q=O[R]))return!1;var w=typeof q=="function";switch(V=arguments.length){case 1:f(q,w,this);break;case 2:g(q,w,this,arguments[1]);break;case 3:m(q,w,this,arguments[1],arguments[2]);break;case 4:p(q,w,this,arguments[1],arguments[2],arguments[3]);break;default:for(I=new Array(V-1),C=1;C<V;C++)I[C-1]=arguments[C];v(q,w,this,I)}return!0},l.prototype.addListener=function(R,B){return b(this,R,B,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(R,B){return b(this,R,B,!0)},l.prototype.once=function(R,B){if(typeof B!="function")throw new TypeError('"listener" argument must be a function');return this.on(R,k(this,R,B)),this},l.prototype.prependOnceListener=function(R,B){if(typeof B!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(R,k(this,R,B)),this},l.prototype.removeListener=function(R,B){var q,V,I,C,O;if(typeof B!="function")throw new TypeError('"listener" argument must be a function');if(!(V=this._events))return this;if(!(q=V[R]))return this;if(q===B||q.listener===B)--this._eventsCount==0?this._events=a(null):(delete V[R],V.removeListener&&this.emit("removeListener",R,q.listener||B));else if(typeof q!="function"){for(I=-1,C=q.length-1;C>=0;C--)if(q[C]===B||q[C].listener===B){O=q[C].listener,I=C;break}if(I<0)return this;I===0?q.shift():function(E,x){for(var w=x,_=w+1,S=E.length;_<S;w+=1,_+=1)E[w]=E[_];E.pop()}(q,I),q.length===1&&(V[R]=q[0]),V.removeListener&&this.emit("removeListener",R,O||B)}return this},l.prototype.removeAllListeners=function(R){var B,q,V;if(!(q=this._events))return this;if(!q.removeListener)return arguments.length===0?(this._events=a(null),this._eventsCount=0):q[R]&&(--this._eventsCount==0?this._events=a(null):delete q[R]),this;if(arguments.length===0){var I,C=i(q);for(V=0;V<C.length;++V)(I=C[V])!=="removeListener"&&this.removeAllListeners(I);return this.removeAllListeners("removeListener"),this._events=a(null),this._eventsCount=0,this}if(typeof(B=q[R])=="function")this.removeListener(R,B);else if(B)for(V=B.length-1;V>=0;V--)this.removeListener(R,B[V]);return this},l.prototype.listeners=function(R){return N(this,R,!0)},l.prototype.rawListeners=function(R){return N(this,R,!1)},l.listenerCount=function(R,B){return typeof R.listenerCount=="function"?R.listenerCount(B):L.call(R,B)},l.prototype.listenerCount=L,l.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(e,n,s){var a=e("safe-buffer").Buffer,i=e("md5.js");n.exports=function(o,l,c,u){if(a.isBuffer(o)||(o=a.from(o,"binary")),l&&(a.isBuffer(l)||(l=a.from(l,"binary")),l.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var d=c/8,h=a.alloc(d),f=a.alloc(u||0),g=a.alloc(0);d>0||u>0;){var m=new i;m.update(g),m.update(o),l&&m.update(l),g=m.digest();var p=0;if(d>0){var v=h.length-d;p=Math.min(d,g.length),g.copy(h,v,0,p),d-=p}if(p<g.length&&u>0){var b=f.length-u,y=Math.min(u,g.length-p);g.copy(f,b,p,p+y),u-=y}}return g.fill(0),{key:h,iv:f}}},{"md5.js":450,"safe-buffer":494}],424:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.CsvParserStream=s.ParserOptions=s.parseFile=s.parseStream=s.parseString=s.parse=s.FormatterOptions=s.CsvFormatterStream=s.writeToPath=s.writeToString=s.writeToBuffer=s.writeToStream=s.write=s.format=void 0;var a=e("@fast-csv/format");Object.defineProperty(s,"format",{enumerable:!0,get:function(){return a.format}}),Object.defineProperty(s,"write",{enumerable:!0,get:function(){return a.write}}),Object.defineProperty(s,"writeToStream",{enumerable:!0,get:function(){return a.writeToStream}}),Object.defineProperty(s,"writeToBuffer",{enumerable:!0,get:function(){return a.writeToBuffer}}),Object.defineProperty(s,"writeToString",{enumerable:!0,get:function(){return a.writeToString}}),Object.defineProperty(s,"writeToPath",{enumerable:!0,get:function(){return a.writeToPath}}),Object.defineProperty(s,"CsvFormatterStream",{enumerable:!0,get:function(){return a.CsvFormatterStream}}),Object.defineProperty(s,"FormatterOptions",{enumerable:!0,get:function(){return a.FormatterOptions}});var i=e("@fast-csv/parse");Object.defineProperty(s,"parse",{enumerable:!0,get:function(){return i.parse}}),Object.defineProperty(s,"parseString",{enumerable:!0,get:function(){return i.parseString}}),Object.defineProperty(s,"parseStream",{enumerable:!0,get:function(){return i.parseStream}}),Object.defineProperty(s,"parseFile",{enumerable:!0,get:function(){return i.parseFile}}),Object.defineProperty(s,"ParserOptions",{enumerable:!0,get:function(){return i.ParserOptions}}),Object.defineProperty(s,"CsvParserStream",{enumerable:!0,get:function(){return i.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(e,n,s){var a=e("safe-buffer").Buffer,i=e("readable-stream").Transform;function o(l){i.call(this),this._block=a.allocUnsafe(l),this._blockSize=l,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}e("inherits")(o,i),o.prototype._transform=function(l,c,u){var d=null;try{this.update(l,c)}catch(h){d=h}u(d)},o.prototype._flush=function(l){var c=null;try{this.push(this.digest())}catch(u){c=u}l(c)},o.prototype.update=function(l,c){if(function(m,p){if(!a.isBuffer(m)&&typeof m!="string")throw new TypeError(p+" must be a string or a buffer")}(l,"Data"),this._finalized)throw new Error("Digest already called");a.isBuffer(l)||(l=a.from(l,c));for(var u=this._block,d=0;this._blockOffset+l.length-d>=this._blockSize;){for(var h=this._blockOffset;h<this._blockSize;)u[h++]=l[d++];this._update(),this._blockOffset=0}for(;d<l.length;)u[this._blockOffset++]=l[d++];for(var f=0,g=8*l.length;g>0;++f)this._length[f]+=g,(g=this._length[f]/4294967296|0)>0&&(this._length[f]-=4294967296*g);return this},o.prototype._update=function(){throw new Error("_update is not implemented")},o.prototype.digest=function(l){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var c=this._digest();l!==void 0&&(c=c.toString(l)),this._block.fill(0),this._blockOffset=0;for(var u=0;u<4;++u)this._length[u]=0;return c},o.prototype._digest=function(){throw new Error("_digest is not implemented")},n.exports=o},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(e,n,s){var a=s;a.utils=e("./hash/utils"),a.common=e("./hash/common"),a.sha=e("./hash/sha"),a.ripemd=e("./hash/ripemd"),a.hmac=e("./hash/hmac"),a.sha1=a.sha.sha1,a.sha256=a.sha.sha256,a.sha224=a.sha.sha224,a.sha384=a.sha.sha384,a.sha512=a.sha.sha512,a.ripemd160=a.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(e,n,s){var a=e("./utils"),i=e("minimalistic-assert");function o(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}s.BlockHash=o,o.prototype.update=function(l,c){if(l=a.toArray(l,c),this.pending?this.pending=this.pending.concat(l):this.pending=l,this.pendingTotal+=l.length,this.pending.length>=this._delta8){var u=(l=this.pending).length%this._delta8;this.pending=l.slice(l.length-u,l.length),this.pending.length===0&&(this.pending=null),l=a.join32(l,0,l.length-u,this.endian);for(var d=0;d<l.length;d+=this._delta32)this._update(l,d,d+this._delta32)}return this},o.prototype.digest=function(l){return this.update(this._pad()),i(this.pending===null),this._digest(l)},o.prototype._pad=function(){var l=this.pendingTotal,c=this._delta8,u=c-(l+this.padLength)%c,d=new Array(u+this.padLength);d[0]=128;for(var h=1;h<u;h++)d[h]=0;if(l<<=3,this.endian==="big"){for(var f=8;f<this.padLength;f++)d[h++]=0;d[h++]=0,d[h++]=0,d[h++]=0,d[h++]=0,d[h++]=l>>>24&255,d[h++]=l>>>16&255,d[h++]=l>>>8&255,d[h++]=255&l}else for(d[h++]=255&l,d[h++]=l>>>8&255,d[h++]=l>>>16&255,d[h++]=l>>>24&255,d[h++]=0,d[h++]=0,d[h++]=0,d[h++]=0,f=8;f<this.padLength;f++)d[h++]=0;return d}},{"./utils":437,"minimalistic-assert":453}],428:[function(e,n,s){var a=e("./utils"),i=e("minimalistic-assert");function o(l,c,u){if(!(this instanceof o))return new o(l,c,u);this.Hash=l,this.blockSize=l.blockSize/8,this.outSize=l.outSize/8,this.inner=null,this.outer=null,this._init(a.toArray(c,u))}n.exports=o,o.prototype._init=function(l){l.length>this.blockSize&&(l=new this.Hash().update(l).digest()),i(l.length<=this.blockSize);for(var c=l.length;c<this.blockSize;c++)l.push(0);for(c=0;c<l.length;c++)l[c]^=54;for(this.inner=new this.Hash().update(l),c=0;c<l.length;c++)l[c]^=106;this.outer=new this.Hash().update(l)},o.prototype.update=function(l,c){return this.inner.update(l,c),this},o.prototype.digest=function(l){return this.outer.update(this.inner.digest()),this.outer.digest(l)}},{"./utils":437,"minimalistic-assert":453}],429:[function(e,n,s){var a=e("./utils"),i=e("./common"),o=a.rotl32,l=a.sum32,c=a.sum32_3,u=a.sum32_4,d=i.BlockHash;function h(){if(!(this instanceof h))return new h;d.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function f(k,N,L,F){return k<=15?N^L^F:k<=31?N&L|~N&F:k<=47?(N|~L)^F:k<=63?N&F|L&~F:N^(L|~F)}function g(k){return k<=15?0:k<=31?1518500249:k<=47?1859775393:k<=63?2400959708:2840853838}function m(k){return k<=15?1352829926:k<=31?1548603684:k<=47?1836072691:k<=63?2053994217:0}a.inherits(h,d),s.ripemd160=h,h.blockSize=512,h.outSize=160,h.hmacStrength=192,h.padLength=64,h.prototype._update=function(k,N){for(var L=this.h[0],F=this.h[1],R=this.h[2],B=this.h[3],q=this.h[4],V=L,I=F,C=R,O=B,E=q,x=0;x<80;x++){var w=l(o(u(L,f(x,F,R,B),k[p[x]+N],g(x)),b[x]),q);L=q,q=B,B=o(R,10),R=F,F=w,w=l(o(u(V,f(79-x,I,C,O),k[v[x]+N],m(x)),y[x]),E),V=E,E=O,O=o(C,10),C=I,I=w}w=c(this.h[1],R,O),this.h[1]=c(this.h[2],B,E),this.h[2]=c(this.h[3],q,V),this.h[3]=c(this.h[4],L,I),this.h[4]=c(this.h[0],F,C),this.h[0]=w},h.prototype._digest=function(k){return k==="hex"?a.toHex32(this.h,"little"):a.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],v=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],b=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],y=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(e,n,s){s.sha1=e("./sha/1"),s.sha224=e("./sha/224"),s.sha256=e("./sha/256"),s.sha384=e("./sha/384"),s.sha512=e("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(e,n,s){var a=e("../utils"),i=e("../common"),o=e("./common"),l=a.rotl32,c=a.sum32,u=a.sum32_5,d=o.ft_1,h=i.BlockHash,f=[1518500249,1859775393,2400959708,3395469782];function g(){if(!(this instanceof g))return new g;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}a.inherits(g,h),n.exports=g,g.blockSize=512,g.outSize=160,g.hmacStrength=80,g.padLength=64,g.prototype._update=function(m,p){for(var v=this.W,b=0;b<16;b++)v[b]=m[p+b];for(;b<v.length;b++)v[b]=l(v[b-3]^v[b-8]^v[b-14]^v[b-16],1);var y=this.h[0],k=this.h[1],N=this.h[2],L=this.h[3],F=this.h[4];for(b=0;b<v.length;b++){var R=~~(b/20),B=u(l(y,5),d(R,k,N,L),F,v[b],f[R]);F=L,L=N,N=l(k,30),k=y,y=B}this.h[0]=c(this.h[0],y),this.h[1]=c(this.h[1],k),this.h[2]=c(this.h[2],N),this.h[3]=c(this.h[3],L),this.h[4]=c(this.h[4],F)},g.prototype._digest=function(m){return m==="hex"?a.toHex32(this.h,"big"):a.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(e,n,s){var a=e("../utils"),i=e("./256");function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}a.inherits(o,i),n.exports=o,o.blockSize=512,o.outSize=224,o.hmacStrength=192,o.padLength=64,o.prototype._digest=function(l){return l==="hex"?a.toHex32(this.h.slice(0,7),"big"):a.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(e,n,s){var a=e("../utils"),i=e("../common"),o=e("./common"),l=e("minimalistic-assert"),c=a.sum32,u=a.sum32_4,d=a.sum32_5,h=o.ch32,f=o.maj32,g=o.s0_256,m=o.s1_256,p=o.g0_256,v=o.g1_256,b=i.BlockHash,y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function k(){if(!(this instanceof k))return new k;b.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=y,this.W=new Array(64)}a.inherits(k,b),n.exports=k,k.blockSize=512,k.outSize=256,k.hmacStrength=192,k.padLength=64,k.prototype._update=function(N,L){for(var F=this.W,R=0;R<16;R++)F[R]=N[L+R];for(;R<F.length;R++)F[R]=u(v(F[R-2]),F[R-7],p(F[R-15]),F[R-16]);var B=this.h[0],q=this.h[1],V=this.h[2],I=this.h[3],C=this.h[4],O=this.h[5],E=this.h[6],x=this.h[7];for(l(this.k.length===F.length),R=0;R<F.length;R++){var w=d(x,m(C),h(C,O,E),this.k[R],F[R]),_=c(g(B),f(B,q,V));x=E,E=O,O=C,C=c(I,w),I=V,V=q,q=B,B=c(w,_)}this.h[0]=c(this.h[0],B),this.h[1]=c(this.h[1],q),this.h[2]=c(this.h[2],V),this.h[3]=c(this.h[3],I),this.h[4]=c(this.h[4],C),this.h[5]=c(this.h[5],O),this.h[6]=c(this.h[6],E),this.h[7]=c(this.h[7],x)},k.prototype._digest=function(N){return N==="hex"?a.toHex32(this.h,"big"):a.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(e,n,s){var a=e("../utils"),i=e("./512");function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}a.inherits(o,i),n.exports=o,o.blockSize=1024,o.outSize=384,o.hmacStrength=192,o.padLength=128,o.prototype._digest=function(l){return l==="hex"?a.toHex32(this.h.slice(0,12),"big"):a.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(e,n,s){var a=e("../utils"),i=e("../common"),o=e("minimalistic-assert"),l=a.rotr64_hi,c=a.rotr64_lo,u=a.shr64_hi,d=a.shr64_lo,h=a.sum64,f=a.sum64_hi,g=a.sum64_lo,m=a.sum64_4_hi,p=a.sum64_4_lo,v=a.sum64_5_hi,b=a.sum64_5_lo,y=i.BlockHash,k=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function N(){if(!(this instanceof N))return new N;y.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=k,this.W=new Array(160)}function L(_,S,T,U,A){var H=_&T^~_&A;return H<0&&(H+=4294967296),H}function F(_,S,T,U,A,H){var z=S&U^~S&H;return z<0&&(z+=4294967296),z}function R(_,S,T,U,A){var H=_&T^_&A^T&A;return H<0&&(H+=4294967296),H}function B(_,S,T,U,A,H){var z=S&U^S&H^U&H;return z<0&&(z+=4294967296),z}function q(_,S){var T=l(_,S,28)^l(S,_,2)^l(S,_,7);return T<0&&(T+=4294967296),T}function V(_,S){var T=c(_,S,28)^c(S,_,2)^c(S,_,7);return T<0&&(T+=4294967296),T}function I(_,S){var T=l(_,S,14)^l(_,S,18)^l(S,_,9);return T<0&&(T+=4294967296),T}function C(_,S){var T=c(_,S,14)^c(_,S,18)^c(S,_,9);return T<0&&(T+=4294967296),T}function O(_,S){var T=l(_,S,1)^l(_,S,8)^u(_,S,7);return T<0&&(T+=4294967296),T}function E(_,S){var T=c(_,S,1)^c(_,S,8)^d(_,S,7);return T<0&&(T+=4294967296),T}function x(_,S){var T=l(_,S,19)^l(S,_,29)^u(_,S,6);return T<0&&(T+=4294967296),T}function w(_,S){var T=c(_,S,19)^c(S,_,29)^d(_,S,6);return T<0&&(T+=4294967296),T}a.inherits(N,y),n.exports=N,N.blockSize=1024,N.outSize=512,N.hmacStrength=192,N.padLength=128,N.prototype._prepareBlock=function(_,S){for(var T=this.W,U=0;U<32;U++)T[U]=_[S+U];for(;U<T.length;U+=2){var A=x(T[U-4],T[U-3]),H=w(T[U-4],T[U-3]),z=T[U-14],K=T[U-13],j=O(T[U-30],T[U-29]),J=E(T[U-30],T[U-29]),P=T[U-32],D=T[U-31];T[U]=m(A,H,z,K,j,J,P,D),T[U+1]=p(A,H,z,K,j,J,P,D)}},N.prototype._update=function(_,S){this._prepareBlock(_,S);var T=this.W,U=this.h[0],A=this.h[1],H=this.h[2],z=this.h[3],K=this.h[4],j=this.h[5],J=this.h[6],P=this.h[7],D=this.h[8],G=this.h[9],re=this.h[10],te=this.h[11],ne=this.h[12],le=this.h[13],oe=this.h[14],ee=this.h[15];o(this.k.length===T.length);for(var Z=0;Z<T.length;Z+=2){var se=oe,ie=ee,ue=I(D,G),pe=C(D,G),fe=L(D,G,re,te,ne),ye=F(D,G,re,te,ne,le),Te=this.k[Z],Pe=this.k[Z+1],je=T[Z],qe=T[Z+1],We=v(se,ie,ue,pe,fe,ye,Te,Pe,je,qe),at=b(se,ie,ue,pe,fe,ye,Te,Pe,je,qe);se=q(U,A),ie=V(U,A),ue=R(U,A,H,z,K),pe=B(U,A,H,z,K,j);var Ye=f(se,ie,ue,pe),rt=g(se,ie,ue,pe);oe=ne,ee=le,ne=re,le=te,re=D,te=G,D=f(J,P,We,at),G=g(P,P,We,at),J=K,P=j,K=H,j=z,H=U,z=A,U=f(We,at,Ye,rt),A=g(We,at,Ye,rt)}h(this.h,0,U,A),h(this.h,2,H,z),h(this.h,4,K,j),h(this.h,6,J,P),h(this.h,8,D,G),h(this.h,10,re,te),h(this.h,12,ne,le),h(this.h,14,oe,ee)},N.prototype._digest=function(_){return _==="hex"?a.toHex32(this.h,"big"):a.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(e,n,s){var a=e("../utils").rotr32;function i(c,u,d){return c&u^~c&d}function o(c,u,d){return c&u^c&d^u&d}function l(c,u,d){return c^u^d}s.ft_1=function(c,u,d,h){return c===0?i(u,d,h):c===1||c===3?l(u,d,h):c===2?o(u,d,h):void 0},s.ch32=i,s.maj32=o,s.p32=l,s.s0_256=function(c){return a(c,2)^a(c,13)^a(c,22)},s.s1_256=function(c){return a(c,6)^a(c,11)^a(c,25)},s.g0_256=function(c){return a(c,7)^a(c,18)^c>>>3},s.g1_256=function(c){return a(c,17)^a(c,19)^c>>>10}},{"../utils":437}],437:[function(e,n,s){var a=e("minimalistic-assert"),i=e("inherits");function o(d,h){return(64512&d.charCodeAt(h))==55296&&!(h<0||h+1>=d.length)&&(64512&d.charCodeAt(h+1))==56320}function l(d){return(d>>>24|d>>>8&65280|d<<8&16711680|(255&d)<<24)>>>0}function c(d){return d.length===1?"0"+d:d}function u(d){return d.length===7?"0"+d:d.length===6?"00"+d:d.length===5?"000"+d:d.length===4?"0000"+d:d.length===3?"00000"+d:d.length===2?"000000"+d:d.length===1?"0000000"+d:d}s.inherits=i,s.toArray=function(d,h){if(Array.isArray(d))return d.slice();if(!d)return[];var f=[];if(typeof d=="string")if(h){if(h==="hex")for((d=d.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(d="0"+d),m=0;m<d.length;m+=2)f.push(parseInt(d[m]+d[m+1],16))}else for(var g=0,m=0;m<d.length;m++){var p=d.charCodeAt(m);p<128?f[g++]=p:p<2048?(f[g++]=p>>6|192,f[g++]=63&p|128):o(d,m)?(p=65536+((1023&p)<<10)+(1023&d.charCodeAt(++m)),f[g++]=p>>18|240,f[g++]=p>>12&63|128,f[g++]=p>>6&63|128,f[g++]=63&p|128):(f[g++]=p>>12|224,f[g++]=p>>6&63|128,f[g++]=63&p|128)}else for(m=0;m<d.length;m++)f[m]=0|d[m];return f},s.toHex=function(d){for(var h="",f=0;f<d.length;f++)h+=c(d[f].toString(16));return h},s.htonl=l,s.toHex32=function(d,h){for(var f="",g=0;g<d.length;g++){var m=d[g];h==="little"&&(m=l(m)),f+=u(m.toString(16))}return f},s.zero2=c,s.zero8=u,s.join32=function(d,h,f,g){var m=f-h;a(m%4==0);for(var p=new Array(m/4),v=0,b=h;v<p.length;v++,b+=4){var y;y=g==="big"?d[b]<<24|d[b+1]<<16|d[b+2]<<8|d[b+3]:d[b+3]<<24|d[b+2]<<16|d[b+1]<<8|d[b],p[v]=y>>>0}return p},s.split32=function(d,h){for(var f=new Array(4*d.length),g=0,m=0;g<d.length;g++,m+=4){var p=d[g];h==="big"?(f[m]=p>>>24,f[m+1]=p>>>16&255,f[m+2]=p>>>8&255,f[m+3]=255&p):(f[m+3]=p>>>24,f[m+2]=p>>>16&255,f[m+1]=p>>>8&255,f[m]=255&p)}return f},s.rotr32=function(d,h){return d>>>h|d<<32-h},s.rotl32=function(d,h){return d<<h|d>>>32-h},s.sum32=function(d,h){return d+h>>>0},s.sum32_3=function(d,h,f){return d+h+f>>>0},s.sum32_4=function(d,h,f,g){return d+h+f+g>>>0},s.sum32_5=function(d,h,f,g,m){return d+h+f+g+m>>>0},s.sum64=function(d,h,f,g){var m=d[h],p=g+d[h+1]>>>0,v=(p<g?1:0)+f+m;d[h]=v>>>0,d[h+1]=p},s.sum64_hi=function(d,h,f,g){return(h+g>>>0<h?1:0)+d+f>>>0},s.sum64_lo=function(d,h,f,g){return h+g>>>0},s.sum64_4_hi=function(d,h,f,g,m,p,v,b){var y=0,k=h;return y+=(k=k+g>>>0)<h?1:0,y+=(k=k+p>>>0)<p?1:0,d+f+m+v+(y+=(k=k+b>>>0)<b?1:0)>>>0},s.sum64_4_lo=function(d,h,f,g,m,p,v,b){return h+g+p+b>>>0},s.sum64_5_hi=function(d,h,f,g,m,p,v,b,y,k){var N=0,L=h;return N+=(L=L+g>>>0)<h?1:0,N+=(L=L+p>>>0)<p?1:0,N+=(L=L+b>>>0)<b?1:0,d+f+m+v+y+(N+=(L=L+k>>>0)<k?1:0)>>>0},s.sum64_5_lo=function(d,h,f,g,m,p,v,b,y,k){return h+g+p+b+k>>>0},s.rotr64_hi=function(d,h,f){return(h<<32-f|d>>>f)>>>0},s.rotr64_lo=function(d,h,f){return(d<<32-f|h>>>f)>>>0},s.shr64_hi=function(d,h,f){return d>>>f},s.shr64_lo=function(d,h,f){return(d<<32-f|h>>>f)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(e,n,s){var a=e("hash.js"),i=e("minimalistic-crypto-utils"),o=e("minimalistic-assert");function l(c){if(!(this instanceof l))return new l(c);this.hash=c.hash,this.predResist=!!c.predResist,this.outLen=this.hash.outSize,this.minEntropy=c.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var u=i.toArray(c.entropy,c.entropyEnc||"hex"),d=i.toArray(c.nonce,c.nonceEnc||"hex"),h=i.toArray(c.pers,c.persEnc||"hex");o(u.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(u,d,h)}n.exports=l,l.prototype._init=function(c,u,d){var h=c.concat(u).concat(d);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var f=0;f<this.V.length;f++)this.K[f]=0,this.V[f]=1;this._update(h),this._reseed=1,this.reseedInterval=281474976710656},l.prototype._hmac=function(){return new a.hmac(this.hash,this.K)},l.prototype._update=function(c){var u=this._hmac().update(this.V).update([0]);c&&(u=u.update(c)),this.K=u.digest(),this.V=this._hmac().update(this.V).digest(),c&&(this.K=this._hmac().update(this.V).update([1]).update(c).digest(),this.V=this._hmac().update(this.V).digest())},l.prototype.reseed=function(c,u,d,h){typeof u!="string"&&(h=d,d=u,u=null),c=i.toArray(c,u),d=i.toArray(d,h),o(c.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(c.concat(d||[])),this._reseed=1},l.prototype.generate=function(c,u,d,h){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof u!="string"&&(h=d,d=u,u=null),d&&(d=i.toArray(d,h||"hex"),this._update(d));for(var f=[];f.length<c;)this.V=this._hmac().update(this.V).digest(),f=f.concat(this.V);var g=f.slice(0,c);return this._update(d),this._reseed++,i.encode(g,u)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(e,n,s){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */s.read=function(a,i,o,l,c){var u,d,h=8*c-l-1,f=(1<<h)-1,g=f>>1,m=-7,p=o?c-1:0,v=o?-1:1,b=a[i+p];for(p+=v,u=b&(1<<-m)-1,b>>=-m,m+=h;m>0;u=256*u+a[i+p],p+=v,m-=8);for(d=u&(1<<-m)-1,u>>=-m,m+=l;m>0;d=256*d+a[i+p],p+=v,m-=8);if(u===0)u=1-g;else{if(u===f)return d?NaN:1/0*(b?-1:1);d+=Math.pow(2,l),u-=g}return(b?-1:1)*d*Math.pow(2,u-l)},s.write=function(a,i,o,l,c,u){var d,h,f,g=8*u-c-1,m=(1<<g)-1,p=m>>1,v=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=l?0:u-1,y=l?1:-1,k=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(h=isNaN(i)?1:0,d=m):(d=Math.floor(Math.log(i)/Math.LN2),i*(f=Math.pow(2,-d))<1&&(d--,f*=2),(i+=d+p>=1?v/f:v*Math.pow(2,1-p))*f>=2&&(d++,f/=2),d+p>=m?(h=0,d=m):d+p>=1?(h=(i*f-1)*Math.pow(2,c),d+=p):(h=i*Math.pow(2,p-1)*Math.pow(2,c),d=0));c>=8;a[o+b]=255&h,b+=y,h/=256,c-=8);for(d=d<<c|h,g+=c;g>0;a[o+b]=255&d,b+=y,d/=256,g-=8);a[o+b-y]|=128*k}},{}],440:[function(e,n,s){typeof Object.create=="function"?n.exports=function(a,i){i&&(a.super_=i,a.prototype=Object.create(i.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(a,i){if(i){a.super_=i;var o=function(){};o.prototype=i.prototype,a.prototype=new o,a.prototype.constructor=a}}},{}],441:[function(e,n,s){(function(a,i,o,l,c,u,d,h){(function(){/*!

	JSZip v3.10.1 - A JavaScript class for generating and reading zip files
	<http://stuartk.com/jszip>

	(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
	Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

	JSZip uses the library pako released under the MIT license :
	https://github.com/nodeca/pako/blob/main/LICENSE
	*/(function(f){typeof s=="object"&&n!==void 0?n.exports=f():(typeof window<"u"?window:i!==void 0?i:typeof self<"u"?self:this).JSZip=f()})(function(){return function f(g,m,p){function v(k,N){if(!m[k]){if(!g[k]){var L=typeof e=="function"&&e;if(!N&&L)return L(k,!0);if(b)return b(k,!0);var F=new Error("Cannot find module '"+k+"'");throw F.code="MODULE_NOT_FOUND",F}var R=m[k]={exports:{}};g[k][0].call(R.exports,function(B){return v(g[k][1][B]||B)},R,R.exports,f,g,m,p)}return m[k].exports}for(var b=typeof e=="function"&&e,y=0;y<p.length;y++)v(p[y]);return v}({1:[function(f,g,m){var p=f("./utils"),v=f("./support"),b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";m.encode=function(y){for(var k,N,L,F,R,B,q,V=[],I=0,C=y.length,O=C,E=p.getTypeOf(y)!=="string";I<y.length;)O=C-I,L=E?(k=y[I++],N=I<C?y[I++]:0,I<C?y[I++]:0):(k=y.charCodeAt(I++),N=I<C?y.charCodeAt(I++):0,I<C?y.charCodeAt(I++):0),F=k>>2,R=(3&k)<<4|N>>4,B=1<O?(15&N)<<2|L>>6:64,q=2<O?63&L:64,V.push(b.charAt(F)+b.charAt(R)+b.charAt(B)+b.charAt(q));return V.join("")},m.decode=function(y){var k,N,L,F,R,B,q=0,V=0,I="data:";if(y.substr(0,I.length)===I)throw new Error("Invalid base64 input, it looks like a data url.");var C,O=3*(y=y.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(y.charAt(y.length-1)===b.charAt(64)&&O--,y.charAt(y.length-2)===b.charAt(64)&&O--,O%1!=0)throw new Error("Invalid base64 input, bad content length.");for(C=v.uint8array?new Uint8Array(0|O):new Array(0|O);q<y.length;)k=b.indexOf(y.charAt(q++))<<2|(F=b.indexOf(y.charAt(q++)))>>4,N=(15&F)<<4|(R=b.indexOf(y.charAt(q++)))>>2,L=(3&R)<<6|(B=b.indexOf(y.charAt(q++))),C[V++]=k,R!==64&&(C[V++]=N),B!==64&&(C[V++]=L);return C}},{"./support":30,"./utils":32}],2:[function(f,g,m){var p=f("./external"),v=f("./stream/DataWorker"),b=f("./stream/Crc32Probe"),y=f("./stream/DataLengthProbe");function k(N,L,F,R,B){this.compressedSize=N,this.uncompressedSize=L,this.crc32=F,this.compression=R,this.compressedContent=B}k.prototype={getContentWorker:function(){var N=new v(p.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new y("data_length")),L=this;return N.on("end",function(){if(this.streamInfo.data_length!==L.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),N},getCompressedWorker:function(){return new v(p.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},k.createWorkerFrom=function(N,L,F){return N.pipe(new b).pipe(new y("uncompressedSize")).pipe(L.compressWorker(F)).pipe(new y("compressedSize")).withStreamInfo("compression",L)},g.exports=k},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(f,g,m){var p=f("./stream/GenericWorker");m.STORE={magic:"\0\0",compressWorker:function(){return new p("STORE compression")},uncompressWorker:function(){return new p("STORE decompression")}},m.DEFLATE=f("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(f,g,m){var p=f("./utils"),v=function(){for(var b,y=[],k=0;k<256;k++){b=k;for(var N=0;N<8;N++)b=1&b?3988292384^b>>>1:b>>>1;y[k]=b}return y}();g.exports=function(b,y){return b!==void 0&&b.length?p.getTypeOf(b)!=="string"?function(k,N,L,F){var R=v,B=0+L;k^=-1;for(var q=0;q<B;q++)k=k>>>8^R[255&(k^N[q])];return-1^k}(0|y,b,b.length):function(k,N,L,F){var R=v,B=0+L;k^=-1;for(var q=0;q<B;q++)k=k>>>8^R[255&(k^N.charCodeAt(q))];return-1^k}(0|y,b,b.length):0}},{"./utils":32}],5:[function(f,g,m){m.base64=!1,m.binary=!1,m.dir=!1,m.createFolders=!0,m.date=null,m.compression=null,m.compressionOptions=null,m.comment=null,m.unixPermissions=null,m.dosPermissions=null},{}],6:[function(f,g,m){var p;p=typeof Promise<"u"?Promise:f("lie"),g.exports={Promise:p}},{lie:37}],7:[function(f,g,m){var p=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",v=f("pako"),b=f("./utils"),y=f("./stream/GenericWorker"),k=p?"uint8array":"array";function N(L,F){y.call(this,"FlateWorker/"+L),this._pako=null,this._pakoAction=L,this._pakoOptions=F,this.meta={}}m.magic="\b\0",b.inherits(N,y),N.prototype.processChunk=function(L){this.meta=L.meta,this._pako===null&&this._createPako(),this._pako.push(b.transformTo(k,L.data),!1)},N.prototype.flush=function(){y.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},N.prototype.cleanUp=function(){y.prototype.cleanUp.call(this),this._pako=null},N.prototype._createPako=function(){this._pako=new v[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var L=this;this._pako.onData=function(F){L.push({data:F,meta:L.meta})}},m.compressWorker=function(L){return new N("Deflate",L)},m.uncompressWorker=function(){return new N("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(f,g,m){function p(R,B){var q,V="";for(q=0;q<B;q++)V+=String.fromCharCode(255&R),R>>>=8;return V}function v(R,B,q,V,I,C){var O,E,x=R.file,w=R.compression,_=C!==k.utf8encode,S=b.transformTo("string",C(x.name)),T=b.transformTo("string",k.utf8encode(x.name)),U=x.comment,A=b.transformTo("string",C(U)),H=b.transformTo("string",k.utf8encode(U)),z=T.length!==x.name.length,K=H.length!==U.length,j="",J="",P="",D=x.dir,G=x.date,re={crc32:0,compressedSize:0,uncompressedSize:0};B&&!q||(re.crc32=R.crc32,re.compressedSize=R.compressedSize,re.uncompressedSize=R.uncompressedSize);var te=0;B&&(te|=8),_||!z&&!K||(te|=2048);var ne=0,le=0;D&&(ne|=16),I==="UNIX"?(le=798,ne|=function(ee,Z){var se=ee;return ee||(se=Z?16893:33204),(65535&se)<<16}(x.unixPermissions,D)):(le=20,ne|=function(ee){return 63&(ee||0)}(x.dosPermissions)),O=G.getUTCHours(),O<<=6,O|=G.getUTCMinutes(),O<<=5,O|=G.getUTCSeconds()/2,E=G.getUTCFullYear()-1980,E<<=4,E|=G.getUTCMonth()+1,E<<=5,E|=G.getUTCDate(),z&&(J=p(1,1)+p(N(S),4)+T,j+="up"+p(J.length,2)+J),K&&(P=p(1,1)+p(N(A),4)+H,j+="uc"+p(P.length,2)+P);var oe="";return oe+=`
\0`,oe+=p(te,2),oe+=w.magic,oe+=p(O,2),oe+=p(E,2),oe+=p(re.crc32,4),oe+=p(re.compressedSize,4),oe+=p(re.uncompressedSize,4),oe+=p(S.length,2),oe+=p(j.length,2),{fileRecord:L.LOCAL_FILE_HEADER+oe+S+j,dirRecord:L.CENTRAL_FILE_HEADER+p(le,2)+oe+p(A.length,2)+"\0\0\0\0"+p(ne,4)+p(V,4)+S+j+A}}var b=f("../utils"),y=f("../stream/GenericWorker"),k=f("../utf8"),N=f("../crc32"),L=f("../signature");function F(R,B,q,V){y.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=B,this.zipPlatform=q,this.encodeFileName=V,this.streamFiles=R,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}b.inherits(F,y),F.prototype.push=function(R){var B=R.meta.percent||0,q=this.entriesCount,V=this._sources.length;this.accumulate?this.contentBuffer.push(R):(this.bytesWritten+=R.data.length,y.prototype.push.call(this,{data:R.data,meta:{currentFile:this.currentFile,percent:q?(B+100*(q-V-1))/q:100}}))},F.prototype.openedSource=function(R){this.currentSourceOffset=this.bytesWritten,this.currentFile=R.file.name;var B=this.streamFiles&&!R.file.dir;if(B){var q=v(R,B,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:q.fileRecord,meta:{percent:0}})}else this.accumulate=!0},F.prototype.closedSource=function(R){this.accumulate=!1;var B=this.streamFiles&&!R.file.dir,q=v(R,B,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(q.dirRecord),B)this.push({data:function(V){return L.DATA_DESCRIPTOR+p(V.crc32,4)+p(V.compressedSize,4)+p(V.uncompressedSize,4)}(R),meta:{percent:100}});else for(this.push({data:q.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},F.prototype.flush=function(){for(var R=this.bytesWritten,B=0;B<this.dirRecords.length;B++)this.push({data:this.dirRecords[B],meta:{percent:100}});var q=this.bytesWritten-R,V=function(I,C,O,E,x){var w=b.transformTo("string",x(E));return L.CENTRAL_DIRECTORY_END+"\0\0\0\0"+p(I,2)+p(I,2)+p(C,4)+p(O,4)+p(w.length,2)+w}(this.dirRecords.length,q,R,this.zipComment,this.encodeFileName);this.push({data:V,meta:{percent:100}})},F.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},F.prototype.registerPrevious=function(R){this._sources.push(R);var B=this;return R.on("data",function(q){B.processChunk(q)}),R.on("end",function(){B.closedSource(B.previous.streamInfo),B._sources.length?B.prepareNextSource():B.end()}),R.on("error",function(q){B.error(q)}),this},F.prototype.resume=function(){return!!y.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},F.prototype.error=function(R){var B=this._sources;if(!y.prototype.error.call(this,R))return!1;for(var q=0;q<B.length;q++)try{B[q].error(R)}catch{}return!0},F.prototype.lock=function(){y.prototype.lock.call(this);for(var R=this._sources,B=0;B<R.length;B++)R[B].lock()},g.exports=F},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(f,g,m){var p=f("../compressions"),v=f("./ZipFileWorker");m.generateWorker=function(b,y,k){var N=new v(y.streamFiles,k,y.platform,y.encodeFileName),L=0;try{b.forEach(function(F,R){L++;var B=function(C,O){var E=C||O,x=p[E];if(!x)throw new Error(E+" is not a valid compression method !");return x}(R.options.compression,y.compression),q=R.options.compressionOptions||y.compressionOptions||{},V=R.dir,I=R.date;R._compressWorker(B,q).withStreamInfo("file",{name:F,dir:V,date:I,comment:R.comment||"",unixPermissions:R.unixPermissions,dosPermissions:R.dosPermissions}).pipe(N)}),N.entriesCount=L}catch(F){N.error(F)}return N}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(f,g,m){function p(){if(!(this instanceof p))return new p;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var v=new p;for(var b in this)typeof this[b]!="function"&&(v[b]=this[b]);return v}}(p.prototype=f("./object")).loadAsync=f("./load"),p.support=f("./support"),p.defaults=f("./defaults"),p.version="3.10.1",p.loadAsync=function(v,b){return new p().loadAsync(v,b)},p.external=f("./external"),g.exports=p},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(f,g,m){var p=f("./utils"),v=f("./external"),b=f("./utf8"),y=f("./zipEntries"),k=f("./stream/Crc32Probe"),N=f("./nodejsUtils");function L(F){return new v.Promise(function(R,B){var q=F.decompressed.getContentWorker().pipe(new k);q.on("error",function(V){B(V)}).on("end",function(){q.streamInfo.crc32!==F.decompressed.crc32?B(new Error("Corrupted zip : CRC32 mismatch")):R()}).resume()})}g.exports=function(F,R){var B=this;return R=p.extend(R||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:b.utf8decode}),N.isNode&&N.isStream(F)?v.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):p.prepareContent("the loaded zip file",F,!0,R.optimizedBinaryString,R.base64).then(function(q){var V=new y(R);return V.load(q),V}).then(function(q){var V=[v.Promise.resolve(q)],I=q.files;if(R.checkCRC32)for(var C=0;C<I.length;C++)V.push(L(I[C]));return v.Promise.all(V)}).then(function(q){for(var V=q.shift(),I=V.files,C=0;C<I.length;C++){var O=I[C],E=O.fileNameStr,x=p.resolve(O.fileNameStr);B.file(x,O.decompressed,{binary:!0,optimizedBinaryString:!0,date:O.date,dir:O.dir,comment:O.fileCommentStr.length?O.fileCommentStr:null,unixPermissions:O.unixPermissions,dosPermissions:O.dosPermissions,createFolders:R.createFolders}),O.dir||(B.file(x).unsafeOriginalName=E)}return V.zipComment.length&&(B.comment=V.zipComment),B})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(f,g,m){var p=f("../utils"),v=f("../stream/GenericWorker");function b(y,k){v.call(this,"Nodejs stream input adapter for "+y),this._upstreamEnded=!1,this._bindStream(k)}p.inherits(b,v),b.prototype._bindStream=function(y){var k=this;(this._stream=y).pause(),y.on("data",function(N){k.push({data:N,meta:{percent:0}})}).on("error",function(N){k.isPaused?this.generatedError=N:k.error(N)}).on("end",function(){k.isPaused?k._upstreamEnded=!0:k.end()})},b.prototype.pause=function(){return!!v.prototype.pause.call(this)&&(this._stream.pause(),!0)},b.prototype.resume=function(){return!!v.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},g.exports=b},{"../stream/GenericWorker":28,"../utils":32}],13:[function(f,g,m){var p=f("readable-stream").Readable;function v(b,y,k){p.call(this,y),this._helper=b;var N=this;b.on("data",function(L,F){N.push(L)||N._helper.pause(),k&&k(F)}).on("error",function(L){N.emit("error",L)}).on("end",function(){N.push(null)})}f("../utils").inherits(v,p),v.prototype._read=function(){this._helper.resume()},g.exports=v},{"../utils":32,"readable-stream":16}],14:[function(f,g,m){g.exports={isNode:o!==void 0,newBufferFrom:function(p,v){if(o.from&&o.from!==Uint8Array.from)return o.from(p,v);if(typeof p=="number")throw new Error('The "data" argument must not be a number');return new o(p,v)},allocBuffer:function(p){if(o.alloc)return o.alloc(p);var v=new o(p);return v.fill(0),v},isBuffer:function(p){return o.isBuffer(p)},isStream:function(p){return p&&typeof p.on=="function"&&typeof p.pause=="function"&&typeof p.resume=="function"}}},{}],15:[function(f,g,m){function p(x,w,_){var S,T=b.getTypeOf(w),U=b.extend(_||{},N);U.date=U.date||new Date,U.compression!==null&&(U.compression=U.compression.toUpperCase()),typeof U.unixPermissions=="string"&&(U.unixPermissions=parseInt(U.unixPermissions,8)),U.unixPermissions&&16384&U.unixPermissions&&(U.dir=!0),U.dosPermissions&&16&U.dosPermissions&&(U.dir=!0),U.dir&&(x=I(x)),U.createFolders&&(S=V(x))&&C.call(this,S,!0);var A=T==="string"&&U.binary===!1&&U.base64===!1;_&&_.binary!==void 0||(U.binary=!A),(w instanceof L&&w.uncompressedSize===0||U.dir||!w||w.length===0)&&(U.base64=!1,U.binary=!0,w="",U.compression="STORE",T="string");var H;H=w instanceof L||w instanceof y?w:B.isNode&&B.isStream(w)?new q(x,w):b.prepareContent(x,w,U.binary,U.optimizedBinaryString,U.base64);var z=new F(x,H,U);this.files[x]=z}var v=f("./utf8"),b=f("./utils"),y=f("./stream/GenericWorker"),k=f("./stream/StreamHelper"),N=f("./defaults"),L=f("./compressedObject"),F=f("./zipObject"),R=f("./generate"),B=f("./nodejsUtils"),q=f("./nodejs/NodejsStreamInputAdapter"),V=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var w=x.lastIndexOf("/");return 0<w?x.substring(0,w):""},I=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},C=function(x,w){return w=w!==void 0?w:N.createFolders,x=I(x),this.files[x]||p.call(this,x,null,{dir:!0,createFolders:w}),this.files[x]};function O(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var w,_,S;for(w in this.files)S=this.files[w],(_=w.slice(this.root.length,w.length))&&w.slice(0,this.root.length)===this.root&&x(_,S)},filter:function(x){var w=[];return this.forEach(function(_,S){x(_,S)&&w.push(S)}),w},file:function(x,w,_){if(arguments.length!==1)return x=this.root+x,p.call(this,x,w,_),this;if(O(x)){var S=x;return this.filter(function(U,A){return!A.dir&&S.test(U)})}var T=this.files[this.root+x];return T&&!T.dir?T:null},folder:function(x){if(!x)return this;if(O(x))return this.filter(function(T,U){return U.dir&&x.test(T)});var w=this.root+x,_=C.call(this,w),S=this.clone();return S.root=_.name,S},remove:function(x){x=this.root+x;var w=this.files[x];if(w||(x.slice(-1)!=="/"&&(x+="/"),w=this.files[x]),w&&!w.dir)delete this.files[x];else for(var _=this.filter(function(T,U){return U.name.slice(0,x.length)===x}),S=0;S<_.length;S++)delete this.files[_[S].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var w,_={};try{if((_=b.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:v.utf8encode})).type=_.type.toLowerCase(),_.compression=_.compression.toUpperCase(),_.type==="binarystring"&&(_.type="string"),!_.type)throw new Error("No output type specified.");b.checkSupport(_.type),_.platform!=="darwin"&&_.platform!=="freebsd"&&_.platform!=="linux"&&_.platform!=="sunos"||(_.platform="UNIX"),_.platform==="win32"&&(_.platform="DOS");var S=_.comment||this.comment||"";w=R.generateWorker(this,_,S)}catch(T){(w=new y("error")).error(T)}return new k(w,_.type||"string",_.mimeType)},generateAsync:function(x,w){return this.generateInternalStream(x).accumulate(w)},generateNodeStream:function(x,w){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(w)}};g.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(f,g,m){g.exports=f("stream")},{stream:void 0}],17:[function(f,g,m){var p=f("./DataReader");function v(b){p.call(this,b);for(var y=0;y<this.data.length;y++)b[y]=255&b[y]}f("../utils").inherits(v,p),v.prototype.byteAt=function(b){return this.data[this.zero+b]},v.prototype.lastIndexOfSignature=function(b){for(var y=b.charCodeAt(0),k=b.charCodeAt(1),N=b.charCodeAt(2),L=b.charCodeAt(3),F=this.length-4;0<=F;--F)if(this.data[F]===y&&this.data[F+1]===k&&this.data[F+2]===N&&this.data[F+3]===L)return F-this.zero;return-1},v.prototype.readAndCheckSignature=function(b){var y=b.charCodeAt(0),k=b.charCodeAt(1),N=b.charCodeAt(2),L=b.charCodeAt(3),F=this.readData(4);return y===F[0]&&k===F[1]&&N===F[2]&&L===F[3]},v.prototype.readData=function(b){if(this.checkOffset(b),b===0)return[];var y=this.data.slice(this.zero+this.index,this.zero+this.index+b);return this.index+=b,y},g.exports=v},{"../utils":32,"./DataReader":18}],18:[function(f,g,m){var p=f("../utils");function v(b){this.data=b,this.length=b.length,this.index=0,this.zero=0}v.prototype={checkOffset:function(b){this.checkIndex(this.index+b)},checkIndex:function(b){if(this.length<this.zero+b||b<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+b+"). Corrupted zip ?")},setIndex:function(b){this.checkIndex(b),this.index=b},skip:function(b){this.setIndex(this.index+b)},byteAt:function(){},readInt:function(b){var y,k=0;for(this.checkOffset(b),y=this.index+b-1;y>=this.index;y--)k=(k<<8)+this.byteAt(y);return this.index+=b,k},readString:function(b){return p.transformTo("string",this.readData(b))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var b=this.readInt(4);return new Date(Date.UTC(1980+(b>>25&127),(b>>21&15)-1,b>>16&31,b>>11&31,b>>5&63,(31&b)<<1))}},g.exports=v},{"../utils":32}],19:[function(f,g,m){var p=f("./Uint8ArrayReader");function v(b){p.call(this,b)}f("../utils").inherits(v,p),v.prototype.readData=function(b){this.checkOffset(b);var y=this.data.slice(this.zero+this.index,this.zero+this.index+b);return this.index+=b,y},g.exports=v},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(f,g,m){var p=f("./DataReader");function v(b){p.call(this,b)}f("../utils").inherits(v,p),v.prototype.byteAt=function(b){return this.data.charCodeAt(this.zero+b)},v.prototype.lastIndexOfSignature=function(b){return this.data.lastIndexOf(b)-this.zero},v.prototype.readAndCheckSignature=function(b){return b===this.readData(4)},v.prototype.readData=function(b){this.checkOffset(b);var y=this.data.slice(this.zero+this.index,this.zero+this.index+b);return this.index+=b,y},g.exports=v},{"../utils":32,"./DataReader":18}],21:[function(f,g,m){var p=f("./ArrayReader");function v(b){p.call(this,b)}f("../utils").inherits(v,p),v.prototype.readData=function(b){if(this.checkOffset(b),b===0)return new Uint8Array(0);var y=this.data.subarray(this.zero+this.index,this.zero+this.index+b);return this.index+=b,y},g.exports=v},{"../utils":32,"./ArrayReader":17}],22:[function(f,g,m){var p=f("../utils"),v=f("../support"),b=f("./ArrayReader"),y=f("./StringReader"),k=f("./NodeBufferReader"),N=f("./Uint8ArrayReader");g.exports=function(L){var F=p.getTypeOf(L);return p.checkSupport(F),F!=="string"||v.uint8array?F==="nodebuffer"?new k(L):v.uint8array?new N(p.transformTo("uint8array",L)):new b(p.transformTo("array",L)):new y(L)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(f,g,m){m.LOCAL_FILE_HEADER="PK",m.CENTRAL_FILE_HEADER="PK",m.CENTRAL_DIRECTORY_END="PK",m.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",m.ZIP64_CENTRAL_DIRECTORY_END="PK",m.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(f,g,m){var p=f("./GenericWorker"),v=f("../utils");function b(y){p.call(this,"ConvertWorker to "+y),this.destType=y}v.inherits(b,p),b.prototype.processChunk=function(y){this.push({data:v.transformTo(this.destType,y.data),meta:y.meta})},g.exports=b},{"../utils":32,"./GenericWorker":28}],25:[function(f,g,m){var p=f("./GenericWorker"),v=f("../crc32");function b(){p.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}f("../utils").inherits(b,p),b.prototype.processChunk=function(y){this.streamInfo.crc32=v(y.data,this.streamInfo.crc32||0),this.push(y)},g.exports=b},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(f,g,m){var p=f("../utils"),v=f("./GenericWorker");function b(y){v.call(this,"DataLengthProbe for "+y),this.propName=y,this.withStreamInfo(y,0)}p.inherits(b,v),b.prototype.processChunk=function(y){if(y){var k=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=k+y.data.length}v.prototype.processChunk.call(this,y)},g.exports=b},{"../utils":32,"./GenericWorker":28}],27:[function(f,g,m){var p=f("../utils"),v=f("./GenericWorker");function b(y){v.call(this,"DataWorker");var k=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,y.then(function(N){k.dataIsReady=!0,k.data=N,k.max=N&&N.length||0,k.type=p.getTypeOf(N),k.isPaused||k._tickAndRepeat()},function(N){k.error(N)})}p.inherits(b,v),b.prototype.cleanUp=function(){v.prototype.cleanUp.call(this),this.data=null},b.prototype.resume=function(){return!!v.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,p.delay(this._tickAndRepeat,[],this)),!0)},b.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(p.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},b.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var y=null,k=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":y=this.data.substring(this.index,k);break;case"uint8array":y=this.data.subarray(this.index,k);break;case"array":case"nodebuffer":y=this.data.slice(this.index,k)}return this.index=k,this.push({data:y,meta:{percent:this.max?this.index/this.max*100:0}})},g.exports=b},{"../utils":32,"./GenericWorker":28}],28:[function(f,g,m){function p(v){this.name=v||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}p.prototype={push:function(v){this.emit("data",v)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(v){this.emit("error",v)}return!0},error:function(v){return!this.isFinished&&(this.isPaused?this.generatedError=v:(this.isFinished=!0,this.emit("error",v),this.previous&&this.previous.error(v),this.cleanUp()),!0)},on:function(v,b){return this._listeners[v].push(b),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(v,b){if(this._listeners[v])for(var y=0;y<this._listeners[v].length;y++)this._listeners[v][y].call(this,b)},pipe:function(v){return v.registerPrevious(this)},registerPrevious:function(v){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=v.streamInfo,this.mergeStreamInfo(),this.previous=v;var b=this;return v.on("data",function(y){b.processChunk(y)}),v.on("end",function(){b.end()}),v.on("error",function(y){b.error(y)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var v=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),v=!0),this.previous&&this.previous.resume(),!v},flush:function(){},processChunk:function(v){this.push(v)},withStreamInfo:function(v,b){return this.extraStreamInfo[v]=b,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var v in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,v)&&(this.streamInfo[v]=this.extraStreamInfo[v])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var v="Worker "+this.name;return this.previous?this.previous+" -> "+v:v}},g.exports=p},{}],29:[function(f,g,m){var p=f("../utils"),v=f("./ConvertWorker"),b=f("./GenericWorker"),y=f("../base64"),k=f("../support"),N=f("../external"),L=null;if(k.nodestream)try{L=f("../nodejs/NodejsStreamOutputAdapter")}catch{}function F(R,B,q){var V=B;switch(B){case"blob":case"arraybuffer":V="uint8array";break;case"base64":V="string"}try{this._internalType=V,this._outputType=B,this._mimeType=q,p.checkSupport(V),this._worker=R.pipe(new v(V)),R.lock()}catch(I){this._worker=new b("error"),this._worker.error(I)}}F.prototype={accumulate:function(R){return function(B,q){return new N.Promise(function(V,I){var C=[],O=B._internalType,E=B._outputType,x=B._mimeType;B.on("data",function(w,_){C.push(w),q&&q(_)}).on("error",function(w){C=[],I(w)}).on("end",function(){try{var w=function(_,S,T){switch(_){case"blob":return p.newBlob(p.transformTo("arraybuffer",S),T);case"base64":return y.encode(S);default:return p.transformTo(_,S)}}(E,function(_,S){var T,U=0,A=null,H=0;for(T=0;T<S.length;T++)H+=S[T].length;switch(_){case"string":return S.join("");case"array":return Array.prototype.concat.apply([],S);case"uint8array":for(A=new Uint8Array(H),T=0;T<S.length;T++)A.set(S[T],U),U+=S[T].length;return A;case"nodebuffer":return o.concat(S);default:throw new Error("concat : unsupported type '"+_+"'")}}(O,C),x);V(w)}catch(_){I(_)}C=[]}).resume()})}(this,R)},on:function(R,B){var q=this;return R==="data"?this._worker.on(R,function(V){B.call(q,V.data,V.meta)}):this._worker.on(R,function(){p.delay(B,arguments,q)}),this},resume:function(){return p.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(R){if(p.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new L(this,{objectMode:this._outputType!=="nodebuffer"},R)}},g.exports=F},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(f,g,m){if(m.base64=!0,m.array=!0,m.string=!0,m.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",m.nodebuffer=o!==void 0,m.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")m.blob=!1;else{var p=new ArrayBuffer(0);try{m.blob=new Blob([p],{type:"application/zip"}).size===0}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);v.append(p),m.blob=v.getBlob("application/zip").size===0}catch{m.blob=!1}}}try{m.nodestream=!!f("readable-stream").Readable}catch{m.nodestream=!1}},{"readable-stream":16}],31:[function(f,g,m){for(var p=f("./utils"),v=f("./support"),b=f("./nodejsUtils"),y=f("./stream/GenericWorker"),k=new Array(256),N=0;N<256;N++)k[N]=252<=N?6:248<=N?5:240<=N?4:224<=N?3:192<=N?2:1;function L(){y.call(this,"utf-8 decode"),this.leftOver=null}function F(){y.call(this,"utf-8 encode")}k[254]=k[254]=1,m.utf8encode=function(R){return v.nodebuffer?b.newBufferFrom(R,"utf-8"):function(B){var q,V,I,C,O,E=B.length,x=0;for(C=0;C<E;C++)(64512&(V=B.charCodeAt(C)))==55296&&C+1<E&&(64512&(I=B.charCodeAt(C+1)))==56320&&(V=65536+(V-55296<<10)+(I-56320),C++),x+=V<128?1:V<2048?2:V<65536?3:4;for(q=v.uint8array?new Uint8Array(x):new Array(x),C=O=0;O<x;C++)(64512&(V=B.charCodeAt(C)))==55296&&C+1<E&&(64512&(I=B.charCodeAt(C+1)))==56320&&(V=65536+(V-55296<<10)+(I-56320),C++),V<128?q[O++]=V:(V<2048?q[O++]=192|V>>>6:(V<65536?q[O++]=224|V>>>12:(q[O++]=240|V>>>18,q[O++]=128|V>>>12&63),q[O++]=128|V>>>6&63),q[O++]=128|63&V);return q}(R)},m.utf8decode=function(R){return v.nodebuffer?p.transformTo("nodebuffer",R).toString("utf-8"):function(B){var q,V,I,C,O=B.length,E=new Array(2*O);for(q=V=0;q<O;)if((I=B[q++])<128)E[V++]=I;else if(4<(C=k[I]))E[V++]=65533,q+=C-1;else{for(I&=C===2?31:C===3?15:7;1<C&&q<O;)I=I<<6|63&B[q++],C--;1<C?E[V++]=65533:I<65536?E[V++]=I:(I-=65536,E[V++]=55296|I>>10&1023,E[V++]=56320|1023&I)}return E.length!==V&&(E.subarray?E=E.subarray(0,V):E.length=V),p.applyFromCharCode(E)}(R=p.transformTo(v.uint8array?"uint8array":"array",R))},p.inherits(L,y),L.prototype.processChunk=function(R){var B=p.transformTo(v.uint8array?"uint8array":"array",R.data);if(this.leftOver&&this.leftOver.length){if(v.uint8array){var q=B;(B=new Uint8Array(q.length+this.leftOver.length)).set(this.leftOver,0),B.set(q,this.leftOver.length)}else B=this.leftOver.concat(B);this.leftOver=null}var V=function(C,O){var E;for((O=O||C.length)>C.length&&(O=C.length),E=O-1;0<=E&&(192&C[E])==128;)E--;return E<0||E===0?O:E+k[C[E]]>O?E:O}(B),I=B;V!==B.length&&(v.uint8array?(I=B.subarray(0,V),this.leftOver=B.subarray(V,B.length)):(I=B.slice(0,V),this.leftOver=B.slice(V,B.length))),this.push({data:m.utf8decode(I),meta:R.meta})},L.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:m.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},m.Utf8DecodeWorker=L,p.inherits(F,y),F.prototype.processChunk=function(R){this.push({data:m.utf8encode(R.data),meta:R.meta})},m.Utf8EncodeWorker=F},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(f,g,m){var p=f("./support"),v=f("./base64"),b=f("./nodejsUtils"),y=f("./external");function k(q){return q}function N(q,V){for(var I=0;I<q.length;++I)V[I]=255&q.charCodeAt(I);return V}f("setimmediate"),m.newBlob=function(q,V){m.checkSupport("blob");try{return new Blob([q],{type:V})}catch{try{var I=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return I.append(q),I.getBlob(V)}catch{throw new Error("Bug : can't construct the Blob.")}}};var L={stringifyByChunk:function(q,V,I){var C=[],O=0,E=q.length;if(E<=I)return String.fromCharCode.apply(null,q);for(;O<E;)V==="array"||V==="nodebuffer"?C.push(String.fromCharCode.apply(null,q.slice(O,Math.min(O+I,E)))):C.push(String.fromCharCode.apply(null,q.subarray(O,Math.min(O+I,E)))),O+=I;return C.join("")},stringifyByChar:function(q){for(var V="",I=0;I<q.length;I++)V+=String.fromCharCode(q[I]);return V},applyCanBeUsed:{uint8array:function(){try{return p.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return p.nodebuffer&&String.fromCharCode.apply(null,b.allocBuffer(1)).length===1}catch{return!1}}()}};function F(q){var V=65536,I=m.getTypeOf(q),C=!0;if(I==="uint8array"?C=L.applyCanBeUsed.uint8array:I==="nodebuffer"&&(C=L.applyCanBeUsed.nodebuffer),C)for(;1<V;)try{return L.stringifyByChunk(q,I,V)}catch{V=Math.floor(V/2)}return L.stringifyByChar(q)}function R(q,V){for(var I=0;I<q.length;I++)V[I]=q[I];return V}m.applyFromCharCode=F;var B={};B.string={string:k,array:function(q){return N(q,new Array(q.length))},arraybuffer:function(q){return B.string.uint8array(q).buffer},uint8array:function(q){return N(q,new Uint8Array(q.length))},nodebuffer:function(q){return N(q,b.allocBuffer(q.length))}},B.array={string:F,array:k,arraybuffer:function(q){return new Uint8Array(q).buffer},uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return b.newBufferFrom(q)}},B.arraybuffer={string:function(q){return F(new Uint8Array(q))},array:function(q){return R(new Uint8Array(q),new Array(q.byteLength))},arraybuffer:k,uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return b.newBufferFrom(new Uint8Array(q))}},B.uint8array={string:F,array:function(q){return R(q,new Array(q.length))},arraybuffer:function(q){return q.buffer},uint8array:k,nodebuffer:function(q){return b.newBufferFrom(q)}},B.nodebuffer={string:F,array:function(q){return R(q,new Array(q.length))},arraybuffer:function(q){return B.nodebuffer.uint8array(q).buffer},uint8array:function(q){return R(q,new Uint8Array(q.length))},nodebuffer:k},m.transformTo=function(q,V){if(V=V||"",!q)return V;m.checkSupport(q);var I=m.getTypeOf(V);return B[I][q](V)},m.resolve=function(q){for(var V=q.split("/"),I=[],C=0;C<V.length;C++){var O=V[C];O==="."||O===""&&C!==0&&C!==V.length-1||(O===".."?I.pop():I.push(O))}return I.join("/")},m.getTypeOf=function(q){return typeof q=="string"?"string":Object.prototype.toString.call(q)==="[object Array]"?"array":p.nodebuffer&&b.isBuffer(q)?"nodebuffer":p.uint8array&&q instanceof Uint8Array?"uint8array":p.arraybuffer&&q instanceof ArrayBuffer?"arraybuffer":void 0},m.checkSupport=function(q){if(!p[q.toLowerCase()])throw new Error(q+" is not supported by this platform")},m.MAX_VALUE_16BITS=65535,m.MAX_VALUE_32BITS=-1,m.pretty=function(q){var V,I,C="";for(I=0;I<(q||"").length;I++)C+="\\x"+((V=q.charCodeAt(I))<16?"0":"")+V.toString(16).toUpperCase();return C},m.delay=function(q,V,I){h(function(){q.apply(I||null,V||[])})},m.inherits=function(q,V){function I(){}I.prototype=V.prototype,q.prototype=new I},m.extend=function(){var q,V,I={};for(q=0;q<arguments.length;q++)for(V in arguments[q])Object.prototype.hasOwnProperty.call(arguments[q],V)&&I[V]===void 0&&(I[V]=arguments[q][V]);return I},m.prepareContent=function(q,V,I,C,O){return y.Promise.resolve(V).then(function(E){return p.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new y.Promise(function(x,w){var _=new FileReader;_.onload=function(S){x(S.target.result)},_.onerror=function(S){w(S.target.error)},_.readAsArrayBuffer(E)}):E}).then(function(E){var x=m.getTypeOf(E);return x?(x==="arraybuffer"?E=m.transformTo("uint8array",E):x==="string"&&(O?E=v.decode(E):I&&C!==!0&&(E=function(w){return N(w,p.uint8array?new Uint8Array(w.length):new Array(w.length))}(E))),E):y.Promise.reject(new Error("Can't read the data of '"+q+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(f,g,m){var p=f("./reader/readerFor"),v=f("./utils"),b=f("./signature"),y=f("./zipEntry"),k=f("./support");function N(L){this.files=[],this.loadOptions=L}N.prototype={checkSignature:function(L){if(!this.reader.readAndCheckSignature(L)){this.reader.index-=4;var F=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+v.pretty(F)+", expected "+v.pretty(L)+")")}},isSignature:function(L,F){var R=this.reader.index;this.reader.setIndex(L);var B=this.reader.readString(4)===F;return this.reader.setIndex(R),B},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var L=this.reader.readData(this.zipCommentLength),F=k.uint8array?"uint8array":"array",R=v.transformTo(F,L);this.zipComment=this.loadOptions.decodeFileName(R)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var L,F,R,B=this.zip64EndOfCentralSize-44;0<B;)L=this.reader.readInt(2),F=this.reader.readInt(4),R=this.reader.readData(F),this.zip64ExtensibleData[L]={id:L,length:F,value:R}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var L,F;for(L=0;L<this.files.length;L++)F=this.files[L],this.reader.setIndex(F.localHeaderOffset),this.checkSignature(b.LOCAL_FILE_HEADER),F.readLocalPart(this.reader),F.handleUTF8(),F.processAttributes()},readCentralDir:function(){var L;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(b.CENTRAL_FILE_HEADER);)(L=new y({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(L);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var L=this.reader.lastIndexOfSignature(b.CENTRAL_DIRECTORY_END);if(L<0)throw this.isSignature(0,b.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(L);var F=L;if(this.checkSignature(b.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===v.MAX_VALUE_16BITS||this.diskWithCentralDirStart===v.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===v.MAX_VALUE_16BITS||this.centralDirRecords===v.MAX_VALUE_16BITS||this.centralDirSize===v.MAX_VALUE_32BITS||this.centralDirOffset===v.MAX_VALUE_32BITS){if(this.zip64=!0,(L=this.reader.lastIndexOfSignature(b.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(L),this.checkSignature(b.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,b.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(b.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(b.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var R=this.centralDirOffset+this.centralDirSize;this.zip64&&(R+=20,R+=12+this.zip64EndOfCentralSize);var B=F-R;if(0<B)this.isSignature(F,b.CENTRAL_FILE_HEADER)||(this.reader.zero=B);else if(B<0)throw new Error("Corrupted zip: missing "+Math.abs(B)+" bytes.")},prepareReader:function(L){this.reader=p(L)},load:function(L){this.prepareReader(L),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},g.exports=N},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(f,g,m){var p=f("./reader/readerFor"),v=f("./utils"),b=f("./compressedObject"),y=f("./crc32"),k=f("./utf8"),N=f("./compressions"),L=f("./support");function F(R,B){this.options=R,this.loadOptions=B}F.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(R){var B,q;if(R.skip(22),this.fileNameLength=R.readInt(2),q=R.readInt(2),this.fileName=R.readData(this.fileNameLength),R.skip(q),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((B=function(V){for(var I in N)if(Object.prototype.hasOwnProperty.call(N,I)&&N[I].magic===V)return N[I];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+v.pretty(this.compressionMethod)+" unknown (inner file : "+v.transformTo("string",this.fileName)+")");this.decompressed=new b(this.compressedSize,this.uncompressedSize,this.crc32,B,R.readData(this.compressedSize))},readCentralPart:function(R){this.versionMadeBy=R.readInt(2),R.skip(2),this.bitFlag=R.readInt(2),this.compressionMethod=R.readString(2),this.date=R.readDate(),this.crc32=R.readInt(4),this.compressedSize=R.readInt(4),this.uncompressedSize=R.readInt(4);var B=R.readInt(2);if(this.extraFieldsLength=R.readInt(2),this.fileCommentLength=R.readInt(2),this.diskNumberStart=R.readInt(2),this.internalFileAttributes=R.readInt(2),this.externalFileAttributes=R.readInt(4),this.localHeaderOffset=R.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");R.skip(B),this.readExtraFields(R),this.parseZIP64ExtraField(R),this.fileComment=R.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var R=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),R==0&&(this.dosPermissions=63&this.externalFileAttributes),R==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var R=p(this.extraFields[1].value);this.uncompressedSize===v.MAX_VALUE_32BITS&&(this.uncompressedSize=R.readInt(8)),this.compressedSize===v.MAX_VALUE_32BITS&&(this.compressedSize=R.readInt(8)),this.localHeaderOffset===v.MAX_VALUE_32BITS&&(this.localHeaderOffset=R.readInt(8)),this.diskNumberStart===v.MAX_VALUE_32BITS&&(this.diskNumberStart=R.readInt(4))}},readExtraFields:function(R){var B,q,V,I=R.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});R.index+4<I;)B=R.readInt(2),q=R.readInt(2),V=R.readData(q),this.extraFields[B]={id:B,length:q,value:V};R.setIndex(I)},handleUTF8:function(){var R=L.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=k.utf8decode(this.fileName),this.fileCommentStr=k.utf8decode(this.fileComment);else{var B=this.findExtraFieldUnicodePath();if(B!==null)this.fileNameStr=B;else{var q=v.transformTo(R,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(q)}var V=this.findExtraFieldUnicodeComment();if(V!==null)this.fileCommentStr=V;else{var I=v.transformTo(R,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(I)}}},findExtraFieldUnicodePath:function(){var R=this.extraFields[28789];if(R){var B=p(R.value);return B.readInt(1)!==1||y(this.fileName)!==B.readInt(4)?null:k.utf8decode(B.readData(R.length-5))}return null},findExtraFieldUnicodeComment:function(){var R=this.extraFields[25461];if(R){var B=p(R.value);return B.readInt(1)!==1||y(this.fileComment)!==B.readInt(4)?null:k.utf8decode(B.readData(R.length-5))}return null}},g.exports=F},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(f,g,m){function p(B,q,V){this.name=B,this.dir=V.dir,this.date=V.date,this.comment=V.comment,this.unixPermissions=V.unixPermissions,this.dosPermissions=V.dosPermissions,this._data=q,this._dataBinary=V.binary,this.options={compression:V.compression,compressionOptions:V.compressionOptions}}var v=f("./stream/StreamHelper"),b=f("./stream/DataWorker"),y=f("./utf8"),k=f("./compressedObject"),N=f("./stream/GenericWorker");p.prototype={internalStream:function(B){var q=null,V="string";try{if(!B)throw new Error("No output type specified.");var I=(V=B.toLowerCase())==="string"||V==="text";V!=="binarystring"&&V!=="text"||(V="string"),q=this._decompressWorker();var C=!this._dataBinary;C&&!I&&(q=q.pipe(new y.Utf8EncodeWorker)),!C&&I&&(q=q.pipe(new y.Utf8DecodeWorker))}catch(O){(q=new N("error")).error(O)}return new v(q,V,"")},async:function(B,q){return this.internalStream(B).accumulate(q)},nodeStream:function(B,q){return this.internalStream(B||"nodebuffer").toNodejsStream(q)},_compressWorker:function(B,q){if(this._data instanceof k&&this._data.compression.magic===B.magic)return this._data.getCompressedWorker();var V=this._decompressWorker();return this._dataBinary||(V=V.pipe(new y.Utf8EncodeWorker)),k.createWorkerFrom(V,B,q)},_decompressWorker:function(){return this._data instanceof k?this._data.getContentWorker():this._data instanceof N?this._data:new b(this._data)}};for(var L=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],F=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},R=0;R<L.length;R++)p.prototype[L[R]]=F;g.exports=p},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(f,g,m){(function(p){var v,b,y=p.MutationObserver||p.WebKitMutationObserver;if(y){var k=0,N=new y(B),L=p.document.createTextNode("");N.observe(L,{characterData:!0}),v=function(){L.data=k=++k%2}}else if(p.setImmediate||p.MessageChannel===void 0)v="document"in p&&"onreadystatechange"in p.document.createElement("script")?function(){var q=p.document.createElement("script");q.onreadystatechange=function(){B(),q.onreadystatechange=null,q.parentNode.removeChild(q),q=null},p.document.documentElement.appendChild(q)}:function(){setTimeout(B,0)};else{var F=new p.MessageChannel;F.port1.onmessage=B,v=function(){F.port2.postMessage(0)}}var R=[];function B(){var q,V;b=!0;for(var I=R.length;I;){for(V=R,R=[],q=-1;++q<I;)V[q]();I=R.length}b=!1}g.exports=function(q){R.push(q)!==1||b||v()}}).call(this,i!==void 0?i:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(f,g,m){var p=f("immediate");function v(){}var b={},y=["REJECTED"],k=["FULFILLED"],N=["PENDING"];function L(I){if(typeof I!="function")throw new TypeError("resolver must be a function");this.state=N,this.queue=[],this.outcome=void 0,I!==v&&q(this,I)}function F(I,C,O){this.promise=I,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof O=="function"&&(this.onRejected=O,this.callRejected=this.otherCallRejected)}function R(I,C,O){p(function(){var E;try{E=C(O)}catch(x){return b.reject(I,x)}E===I?b.reject(I,new TypeError("Cannot resolve promise with itself")):b.resolve(I,E)})}function B(I){var C=I&&I.then;if(I&&(typeof I=="object"||typeof I=="function")&&typeof C=="function")return function(){C.apply(I,arguments)}}function q(I,C){var O=!1;function E(_){O||(O=!0,b.reject(I,_))}function x(_){O||(O=!0,b.resolve(I,_))}var w=V(function(){C(x,E)});w.status==="error"&&E(w.value)}function V(I,C){var O={};try{O.value=I(C),O.status="success"}catch(E){O.status="error",O.value=E}return O}(g.exports=L).prototype.finally=function(I){if(typeof I!="function")return this;var C=this.constructor;return this.then(function(O){return C.resolve(I()).then(function(){return O})},function(O){return C.resolve(I()).then(function(){throw O})})},L.prototype.catch=function(I){return this.then(null,I)},L.prototype.then=function(I,C){if(typeof I!="function"&&this.state===k||typeof C!="function"&&this.state===y)return this;var O=new this.constructor(v);return this.state!==N?R(O,this.state===k?I:C,this.outcome):this.queue.push(new F(O,I,C)),O},F.prototype.callFulfilled=function(I){b.resolve(this.promise,I)},F.prototype.otherCallFulfilled=function(I){R(this.promise,this.onFulfilled,I)},F.prototype.callRejected=function(I){b.reject(this.promise,I)},F.prototype.otherCallRejected=function(I){R(this.promise,this.onRejected,I)},b.resolve=function(I,C){var O=V(B,C);if(O.status==="error")return b.reject(I,O.value);var E=O.value;if(E)q(I,E);else{I.state=k,I.outcome=C;for(var x=-1,w=I.queue.length;++x<w;)I.queue[x].callFulfilled(C)}return I},b.reject=function(I,C){I.state=y,I.outcome=C;for(var O=-1,E=I.queue.length;++O<E;)I.queue[O].callRejected(C);return I},L.resolve=function(I){return I instanceof this?I:b.resolve(new this(v),I)},L.reject=function(I){var C=new this(v);return b.reject(C,I)},L.all=function(I){var C=this;if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=I.length,E=!1;if(!O)return this.resolve([]);for(var x=new Array(O),w=0,_=-1,S=new this(v);++_<O;)T(I[_],_);return S;function T(U,A){C.resolve(U).then(function(H){x[A]=H,++w!==O||E||(E=!0,b.resolve(S,x))},function(H){E||(E=!0,b.reject(S,H))})}},L.race=function(I){if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=I.length,O=!1;if(!C)return this.resolve([]);for(var E,x=-1,w=new this(v);++x<C;)E=I[x],this.resolve(E).then(function(_){O||(O=!0,b.resolve(w,_))},function(_){O||(O=!0,b.reject(w,_))});return w}},{immediate:36}],38:[function(f,g,m){var p={};(0,f("./lib/utils/common").assign)(p,f("./lib/deflate"),f("./lib/inflate"),f("./lib/zlib/constants")),g.exports=p},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(f,g,m){var p=f("./zlib/deflate"),v=f("./utils/common"),b=f("./utils/strings"),y=f("./zlib/messages"),k=f("./zlib/zstream"),N=Object.prototype.toString;function L(R){if(!(this instanceof L))return new L(R);this.options=v.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},R||{});var B=this.options;B.raw&&0<B.windowBits?B.windowBits=-B.windowBits:B.gzip&&0<B.windowBits&&B.windowBits<16&&(B.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new k,this.strm.avail_out=0;var q=p.deflateInit2(this.strm,B.level,B.method,B.windowBits,B.memLevel,B.strategy);if(q!==0)throw new Error(y[q]);if(B.header&&p.deflateSetHeader(this.strm,B.header),B.dictionary){var V;if(V=typeof B.dictionary=="string"?b.string2buf(B.dictionary):N.call(B.dictionary)==="[object ArrayBuffer]"?new Uint8Array(B.dictionary):B.dictionary,(q=p.deflateSetDictionary(this.strm,V))!==0)throw new Error(y[q]);this._dict_set=!0}}function F(R,B){var q=new L(B);if(q.push(R,!0),q.err)throw q.msg||y[q.err];return q.result}L.prototype.push=function(R,B){var q,V,I=this.strm,C=this.options.chunkSize;if(this.ended)return!1;V=B===~~B?B:B===!0?4:0,typeof R=="string"?I.input=b.string2buf(R):N.call(R)==="[object ArrayBuffer]"?I.input=new Uint8Array(R):I.input=R,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new v.Buf8(C),I.next_out=0,I.avail_out=C),(q=p.deflate(I,V))!==1&&q!==0)return this.onEnd(q),!(this.ended=!0);I.avail_out!==0&&(I.avail_in!==0||V!==4&&V!==2)||(this.options.to==="string"?this.onData(b.buf2binstring(v.shrinkBuf(I.output,I.next_out))):this.onData(v.shrinkBuf(I.output,I.next_out)))}while((0<I.avail_in||I.avail_out===0)&&q!==1);return V===4?(q=p.deflateEnd(this.strm),this.onEnd(q),this.ended=!0,q===0):V!==2||(this.onEnd(0),!(I.avail_out=0))},L.prototype.onData=function(R){this.chunks.push(R)},L.prototype.onEnd=function(R){R===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=R,this.msg=this.strm.msg},m.Deflate=L,m.deflate=F,m.deflateRaw=function(R,B){return(B=B||{}).raw=!0,F(R,B)},m.gzip=function(R,B){return(B=B||{}).gzip=!0,F(R,B)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(f,g,m){var p=f("./zlib/inflate"),v=f("./utils/common"),b=f("./utils/strings"),y=f("./zlib/constants"),k=f("./zlib/messages"),N=f("./zlib/zstream"),L=f("./zlib/gzheader"),F=Object.prototype.toString;function R(q){if(!(this instanceof R))return new R(q);this.options=v.assign({chunkSize:16384,windowBits:0,to:""},q||{});var V=this.options;V.raw&&0<=V.windowBits&&V.windowBits<16&&(V.windowBits=-V.windowBits,V.windowBits===0&&(V.windowBits=-15)),!(0<=V.windowBits&&V.windowBits<16)||q&&q.windowBits||(V.windowBits+=32),15<V.windowBits&&V.windowBits<48&&!(15&V.windowBits)&&(V.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N,this.strm.avail_out=0;var I=p.inflateInit2(this.strm,V.windowBits);if(I!==y.Z_OK)throw new Error(k[I]);this.header=new L,p.inflateGetHeader(this.strm,this.header)}function B(q,V){var I=new R(V);if(I.push(q,!0),I.err)throw I.msg||k[I.err];return I.result}R.prototype.push=function(q,V){var I,C,O,E,x,w,_=this.strm,S=this.options.chunkSize,T=this.options.dictionary,U=!1;if(this.ended)return!1;C=V===~~V?V:V===!0?y.Z_FINISH:y.Z_NO_FLUSH,typeof q=="string"?_.input=b.binstring2buf(q):F.call(q)==="[object ArrayBuffer]"?_.input=new Uint8Array(q):_.input=q,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new v.Buf8(S),_.next_out=0,_.avail_out=S),(I=p.inflate(_,y.Z_NO_FLUSH))===y.Z_NEED_DICT&&T&&(w=typeof T=="string"?b.string2buf(T):F.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,I=p.inflateSetDictionary(this.strm,w)),I===y.Z_BUF_ERROR&&U===!0&&(I=y.Z_OK,U=!1),I!==y.Z_STREAM_END&&I!==y.Z_OK)return this.onEnd(I),!(this.ended=!0);_.next_out&&(_.avail_out!==0&&I!==y.Z_STREAM_END&&(_.avail_in!==0||C!==y.Z_FINISH&&C!==y.Z_SYNC_FLUSH)||(this.options.to==="string"?(O=b.utf8border(_.output,_.next_out),E=_.next_out-O,x=b.buf2string(_.output,O),_.next_out=E,_.avail_out=S-E,E&&v.arraySet(_.output,_.output,O,E,0),this.onData(x)):this.onData(v.shrinkBuf(_.output,_.next_out)))),_.avail_in===0&&_.avail_out===0&&(U=!0)}while((0<_.avail_in||_.avail_out===0)&&I!==y.Z_STREAM_END);return I===y.Z_STREAM_END&&(C=y.Z_FINISH),C===y.Z_FINISH?(I=p.inflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===y.Z_OK):C!==y.Z_SYNC_FLUSH||(this.onEnd(y.Z_OK),!(_.avail_out=0))},R.prototype.onData=function(q){this.chunks.push(q)},R.prototype.onEnd=function(q){q===y.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=q,this.msg=this.strm.msg},m.Inflate=R,m.inflate=B,m.inflateRaw=function(q,V){return(V=V||{}).raw=!0,B(q,V)},m.ungzip=B},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(f,g,m){var p=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";m.assign=function(y){for(var k=Array.prototype.slice.call(arguments,1);k.length;){var N=k.shift();if(N){if(typeof N!="object")throw new TypeError(N+"must be non-object");for(var L in N)N.hasOwnProperty(L)&&(y[L]=N[L])}}return y},m.shrinkBuf=function(y,k){return y.length===k?y:y.subarray?y.subarray(0,k):(y.length=k,y)};var v={arraySet:function(y,k,N,L,F){if(k.subarray&&y.subarray)y.set(k.subarray(N,N+L),F);else for(var R=0;R<L;R++)y[F+R]=k[N+R]},flattenChunks:function(y){var k,N,L,F,R,B;for(k=L=0,N=y.length;k<N;k++)L+=y[k].length;for(B=new Uint8Array(L),k=F=0,N=y.length;k<N;k++)R=y[k],B.set(R,F),F+=R.length;return B}},b={arraySet:function(y,k,N,L,F){for(var R=0;R<L;R++)y[F+R]=k[N+R]},flattenChunks:function(y){return[].concat.apply([],y)}};m.setTyped=function(y){y?(m.Buf8=Uint8Array,m.Buf16=Uint16Array,m.Buf32=Int32Array,m.assign(m,v)):(m.Buf8=Array,m.Buf16=Array,m.Buf32=Array,m.assign(m,b))},m.setTyped(p)},{}],42:[function(f,g,m){var p=f("./common"),v=!0,b=!0;try{String.fromCharCode.apply(null,[0])}catch{v=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{b=!1}for(var y=new p.Buf8(256),k=0;k<256;k++)y[k]=252<=k?6:248<=k?5:240<=k?4:224<=k?3:192<=k?2:1;function N(L,F){if(F<65537&&(L.subarray&&b||!L.subarray&&v))return String.fromCharCode.apply(null,p.shrinkBuf(L,F));for(var R="",B=0;B<F;B++)R+=String.fromCharCode(L[B]);return R}y[254]=y[254]=1,m.string2buf=function(L){var F,R,B,q,V,I=L.length,C=0;for(q=0;q<I;q++)(64512&(R=L.charCodeAt(q)))==55296&&q+1<I&&(64512&(B=L.charCodeAt(q+1)))==56320&&(R=65536+(R-55296<<10)+(B-56320),q++),C+=R<128?1:R<2048?2:R<65536?3:4;for(F=new p.Buf8(C),q=V=0;V<C;q++)(64512&(R=L.charCodeAt(q)))==55296&&q+1<I&&(64512&(B=L.charCodeAt(q+1)))==56320&&(R=65536+(R-55296<<10)+(B-56320),q++),R<128?F[V++]=R:(R<2048?F[V++]=192|R>>>6:(R<65536?F[V++]=224|R>>>12:(F[V++]=240|R>>>18,F[V++]=128|R>>>12&63),F[V++]=128|R>>>6&63),F[V++]=128|63&R);return F},m.buf2binstring=function(L){return N(L,L.length)},m.binstring2buf=function(L){for(var F=new p.Buf8(L.length),R=0,B=F.length;R<B;R++)F[R]=L.charCodeAt(R);return F},m.buf2string=function(L,F){var R,B,q,V,I=F||L.length,C=new Array(2*I);for(R=B=0;R<I;)if((q=L[R++])<128)C[B++]=q;else if(4<(V=y[q]))C[B++]=65533,R+=V-1;else{for(q&=V===2?31:V===3?15:7;1<V&&R<I;)q=q<<6|63&L[R++],V--;1<V?C[B++]=65533:q<65536?C[B++]=q:(q-=65536,C[B++]=55296|q>>10&1023,C[B++]=56320|1023&q)}return N(C,B)},m.utf8border=function(L,F){var R;for((F=F||L.length)>L.length&&(F=L.length),R=F-1;0<=R&&(192&L[R])==128;)R--;return R<0||R===0?F:R+y[L[R]]>F?R:F}},{"./common":41}],43:[function(f,g,m){g.exports=function(p,v,b,y){for(var k=65535&p|0,N=p>>>16&65535|0,L=0;b!==0;){for(b-=L=2e3<b?2e3:b;N=N+(k=k+v[y++]|0)|0,--L;);k%=65521,N%=65521}return k|N<<16|0}},{}],44:[function(f,g,m){g.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(f,g,m){var p=function(){for(var v,b=[],y=0;y<256;y++){v=y;for(var k=0;k<8;k++)v=1&v?3988292384^v>>>1:v>>>1;b[y]=v}return b}();g.exports=function(v,b,y,k){var N=p,L=k+y;v^=-1;for(var F=k;F<L;F++)v=v>>>8^N[255&(v^b[F])];return-1^v}},{}],46:[function(f,g,m){var p,v=f("../utils/common"),b=f("./trees"),y=f("./adler32"),k=f("./crc32"),N=f("./messages"),L=-2,F=258,R=262,B=113;function q(j,J){return j.msg=N[J],J}function V(j){return(j<<1)-(4<j?9:0)}function I(j){for(var J=j.length;0<=--J;)j[J]=0}function C(j){var J=j.state,P=J.pending;P>j.avail_out&&(P=j.avail_out),P!==0&&(v.arraySet(j.output,J.pending_buf,J.pending_out,P,j.next_out),j.next_out+=P,J.pending_out+=P,j.total_out+=P,j.avail_out-=P,J.pending-=P,J.pending===0&&(J.pending_out=0))}function O(j,J){b._tr_flush_block(j,0<=j.block_start?j.block_start:-1,j.strstart-j.block_start,J),j.block_start=j.strstart,C(j.strm)}function E(j,J){j.pending_buf[j.pending++]=J}function x(j,J){j.pending_buf[j.pending++]=J>>>8&255,j.pending_buf[j.pending++]=255&J}function w(j,J){var P,D,G=j.max_chain_length,re=j.strstart,te=j.prev_length,ne=j.nice_match,le=j.strstart>j.w_size-R?j.strstart-(j.w_size-R):0,oe=j.window,ee=j.w_mask,Z=j.prev,se=j.strstart+F,ie=oe[re+te-1],ue=oe[re+te];j.prev_length>=j.good_match&&(G>>=2),ne>j.lookahead&&(ne=j.lookahead);do if(oe[(P=J)+te]===ue&&oe[P+te-1]===ie&&oe[P]===oe[re]&&oe[++P]===oe[re+1]){re+=2,P++;do;while(oe[++re]===oe[++P]&&oe[++re]===oe[++P]&&oe[++re]===oe[++P]&&oe[++re]===oe[++P]&&oe[++re]===oe[++P]&&oe[++re]===oe[++P]&&oe[++re]===oe[++P]&&oe[++re]===oe[++P]&&re<se);if(D=F-(se-re),re=se-F,te<D){if(j.match_start=J,ne<=(te=D))break;ie=oe[re+te-1],ue=oe[re+te]}}while((J=Z[J&ee])>le&&--G!=0);return te<=j.lookahead?te:j.lookahead}function _(j){var J,P,D,G,re,te,ne,le,oe,ee,Z=j.w_size;do{if(G=j.window_size-j.lookahead-j.strstart,j.strstart>=Z+(Z-R)){for(v.arraySet(j.window,j.window,Z,Z,0),j.match_start-=Z,j.strstart-=Z,j.block_start-=Z,J=P=j.hash_size;D=j.head[--J],j.head[J]=Z<=D?D-Z:0,--P;);for(J=P=Z;D=j.prev[--J],j.prev[J]=Z<=D?D-Z:0,--P;);G+=Z}if(j.strm.avail_in===0)break;if(te=j.strm,ne=j.window,le=j.strstart+j.lookahead,ee=void 0,(oe=G)<(ee=te.avail_in)&&(ee=oe),P=ee===0?0:(te.avail_in-=ee,v.arraySet(ne,te.input,te.next_in,ee,le),te.state.wrap===1?te.adler=y(te.adler,ne,ee,le):te.state.wrap===2&&(te.adler=k(te.adler,ne,ee,le)),te.next_in+=ee,te.total_in+=ee,ee),j.lookahead+=P,j.lookahead+j.insert>=3)for(re=j.strstart-j.insert,j.ins_h=j.window[re],j.ins_h=(j.ins_h<<j.hash_shift^j.window[re+1])&j.hash_mask;j.insert&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[re+3-1])&j.hash_mask,j.prev[re&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=re,re++,j.insert--,!(j.lookahead+j.insert<3)););}while(j.lookahead<R&&j.strm.avail_in!==0)}function S(j,J){for(var P,D;;){if(j.lookahead<R){if(_(j),j.lookahead<R&&J===0)return 1;if(j.lookahead===0)break}if(P=0,j.lookahead>=3&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+3-1])&j.hash_mask,P=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),P!==0&&j.strstart-P<=j.w_size-R&&(j.match_length=w(j,P)),j.match_length>=3)if(D=b._tr_tally(j,j.strstart-j.match_start,j.match_length-3),j.lookahead-=j.match_length,j.match_length<=j.max_lazy_match&&j.lookahead>=3){for(j.match_length--;j.strstart++,j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+3-1])&j.hash_mask,P=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart,--j.match_length!=0;);j.strstart++}else j.strstart+=j.match_length,j.match_length=0,j.ins_h=j.window[j.strstart],j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+1])&j.hash_mask;else D=b._tr_tally(j,0,j.window[j.strstart]),j.lookahead--,j.strstart++;if(D&&(O(j,!1),j.strm.avail_out===0))return 1}return j.insert=j.strstart<2?j.strstart:2,J===4?(O(j,!0),j.strm.avail_out===0?3:4):j.last_lit&&(O(j,!1),j.strm.avail_out===0)?1:2}function T(j,J){for(var P,D,G;;){if(j.lookahead<R){if(_(j),j.lookahead<R&&J===0)return 1;if(j.lookahead===0)break}if(P=0,j.lookahead>=3&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+3-1])&j.hash_mask,P=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),j.prev_length=j.match_length,j.prev_match=j.match_start,j.match_length=2,P!==0&&j.prev_length<j.max_lazy_match&&j.strstart-P<=j.w_size-R&&(j.match_length=w(j,P),j.match_length<=5&&(j.strategy===1||j.match_length===3&&4096<j.strstart-j.match_start)&&(j.match_length=2)),j.prev_length>=3&&j.match_length<=j.prev_length){for(G=j.strstart+j.lookahead-3,D=b._tr_tally(j,j.strstart-1-j.prev_match,j.prev_length-3),j.lookahead-=j.prev_length-1,j.prev_length-=2;++j.strstart<=G&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+3-1])&j.hash_mask,P=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),--j.prev_length!=0;);if(j.match_available=0,j.match_length=2,j.strstart++,D&&(O(j,!1),j.strm.avail_out===0))return 1}else if(j.match_available){if((D=b._tr_tally(j,0,j.window[j.strstart-1]))&&O(j,!1),j.strstart++,j.lookahead--,j.strm.avail_out===0)return 1}else j.match_available=1,j.strstart++,j.lookahead--}return j.match_available&&(D=b._tr_tally(j,0,j.window[j.strstart-1]),j.match_available=0),j.insert=j.strstart<2?j.strstart:2,J===4?(O(j,!0),j.strm.avail_out===0?3:4):j.last_lit&&(O(j,!1),j.strm.avail_out===0)?1:2}function U(j,J,P,D,G){this.good_length=j,this.max_lazy=J,this.nice_length=P,this.max_chain=D,this.func=G}function A(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new v.Buf16(1146),this.dyn_dtree=new v.Buf16(122),this.bl_tree=new v.Buf16(78),I(this.dyn_ltree),I(this.dyn_dtree),I(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new v.Buf16(16),this.heap=new v.Buf16(573),I(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new v.Buf16(573),I(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function H(j){var J;return j&&j.state?(j.total_in=j.total_out=0,j.data_type=2,(J=j.state).pending=0,J.pending_out=0,J.wrap<0&&(J.wrap=-J.wrap),J.status=J.wrap?42:B,j.adler=J.wrap===2?0:1,J.last_flush=0,b._tr_init(J),0):q(j,L)}function z(j){var J=H(j);return J===0&&function(P){P.window_size=2*P.w_size,I(P.head),P.max_lazy_match=p[P.level].max_lazy,P.good_match=p[P.level].good_length,P.nice_match=p[P.level].nice_length,P.max_chain_length=p[P.level].max_chain,P.strstart=0,P.block_start=0,P.lookahead=0,P.insert=0,P.match_length=P.prev_length=2,P.match_available=0,P.ins_h=0}(j.state),J}function K(j,J,P,D,G,re){if(!j)return L;var te=1;if(J===-1&&(J=6),D<0?(te=0,D=-D):15<D&&(te=2,D-=16),G<1||9<G||P!==8||D<8||15<D||J<0||9<J||re<0||4<re)return q(j,L);D===8&&(D=9);var ne=new A;return(j.state=ne).strm=j,ne.wrap=te,ne.gzhead=null,ne.w_bits=D,ne.w_size=1<<ne.w_bits,ne.w_mask=ne.w_size-1,ne.hash_bits=G+7,ne.hash_size=1<<ne.hash_bits,ne.hash_mask=ne.hash_size-1,ne.hash_shift=~~((ne.hash_bits+3-1)/3),ne.window=new v.Buf8(2*ne.w_size),ne.head=new v.Buf16(ne.hash_size),ne.prev=new v.Buf16(ne.w_size),ne.lit_bufsize=1<<G+6,ne.pending_buf_size=4*ne.lit_bufsize,ne.pending_buf=new v.Buf8(ne.pending_buf_size),ne.d_buf=1*ne.lit_bufsize,ne.l_buf=3*ne.lit_bufsize,ne.level=J,ne.strategy=re,ne.method=P,z(j)}p=[new U(0,0,0,0,function(j,J){var P=65535;for(P>j.pending_buf_size-5&&(P=j.pending_buf_size-5);;){if(j.lookahead<=1){if(_(j),j.lookahead===0&&J===0)return 1;if(j.lookahead===0)break}j.strstart+=j.lookahead,j.lookahead=0;var D=j.block_start+P;if((j.strstart===0||j.strstart>=D)&&(j.lookahead=j.strstart-D,j.strstart=D,O(j,!1),j.strm.avail_out===0)||j.strstart-j.block_start>=j.w_size-R&&(O(j,!1),j.strm.avail_out===0))return 1}return j.insert=0,J===4?(O(j,!0),j.strm.avail_out===0?3:4):(j.strstart>j.block_start&&(O(j,!1),j.strm.avail_out),1)}),new U(4,4,8,4,S),new U(4,5,16,8,S),new U(4,6,32,32,S),new U(4,4,16,16,T),new U(8,16,32,32,T),new U(8,16,128,128,T),new U(8,32,128,256,T),new U(32,128,258,1024,T),new U(32,258,258,4096,T)],m.deflateInit=function(j,J){return K(j,J,8,15,8,0)},m.deflateInit2=K,m.deflateReset=z,m.deflateResetKeep=H,m.deflateSetHeader=function(j,J){return j&&j.state?j.state.wrap!==2?L:(j.state.gzhead=J,0):L},m.deflate=function(j,J){var P,D,G,re;if(!j||!j.state||5<J||J<0)return j?q(j,L):L;if(D=j.state,!j.output||!j.input&&j.avail_in!==0||D.status===666&&J!==4)return q(j,j.avail_out===0?-5:L);if(D.strm=j,P=D.last_flush,D.last_flush=J,D.status===42)if(D.wrap===2)j.adler=0,E(D,31),E(D,139),E(D,8),D.gzhead?(E(D,(D.gzhead.text?1:0)+(D.gzhead.hcrc?2:0)+(D.gzhead.extra?4:0)+(D.gzhead.name?8:0)+(D.gzhead.comment?16:0)),E(D,255&D.gzhead.time),E(D,D.gzhead.time>>8&255),E(D,D.gzhead.time>>16&255),E(D,D.gzhead.time>>24&255),E(D,D.level===9?2:2<=D.strategy||D.level<2?4:0),E(D,255&D.gzhead.os),D.gzhead.extra&&D.gzhead.extra.length&&(E(D,255&D.gzhead.extra.length),E(D,D.gzhead.extra.length>>8&255)),D.gzhead.hcrc&&(j.adler=k(j.adler,D.pending_buf,D.pending,0)),D.gzindex=0,D.status=69):(E(D,0),E(D,0),E(D,0),E(D,0),E(D,0),E(D,D.level===9?2:2<=D.strategy||D.level<2?4:0),E(D,3),D.status=B);else{var te=8+(D.w_bits-8<<4)<<8;te|=(2<=D.strategy||D.level<2?0:D.level<6?1:D.level===6?2:3)<<6,D.strstart!==0&&(te|=32),te+=31-te%31,D.status=B,x(D,te),D.strstart!==0&&(x(D,j.adler>>>16),x(D,65535&j.adler)),j.adler=1}if(D.status===69)if(D.gzhead.extra){for(G=D.pending;D.gzindex<(65535&D.gzhead.extra.length)&&(D.pending!==D.pending_buf_size||(D.gzhead.hcrc&&D.pending>G&&(j.adler=k(j.adler,D.pending_buf,D.pending-G,G)),C(j),G=D.pending,D.pending!==D.pending_buf_size));)E(D,255&D.gzhead.extra[D.gzindex]),D.gzindex++;D.gzhead.hcrc&&D.pending>G&&(j.adler=k(j.adler,D.pending_buf,D.pending-G,G)),D.gzindex===D.gzhead.extra.length&&(D.gzindex=0,D.status=73)}else D.status=73;if(D.status===73)if(D.gzhead.name){G=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>G&&(j.adler=k(j.adler,D.pending_buf,D.pending-G,G)),C(j),G=D.pending,D.pending===D.pending_buf_size)){re=1;break}re=D.gzindex<D.gzhead.name.length?255&D.gzhead.name.charCodeAt(D.gzindex++):0,E(D,re)}while(re!==0);D.gzhead.hcrc&&D.pending>G&&(j.adler=k(j.adler,D.pending_buf,D.pending-G,G)),re===0&&(D.gzindex=0,D.status=91)}else D.status=91;if(D.status===91)if(D.gzhead.comment){G=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>G&&(j.adler=k(j.adler,D.pending_buf,D.pending-G,G)),C(j),G=D.pending,D.pending===D.pending_buf_size)){re=1;break}re=D.gzindex<D.gzhead.comment.length?255&D.gzhead.comment.charCodeAt(D.gzindex++):0,E(D,re)}while(re!==0);D.gzhead.hcrc&&D.pending>G&&(j.adler=k(j.adler,D.pending_buf,D.pending-G,G)),re===0&&(D.status=103)}else D.status=103;if(D.status===103&&(D.gzhead.hcrc?(D.pending+2>D.pending_buf_size&&C(j),D.pending+2<=D.pending_buf_size&&(E(D,255&j.adler),E(D,j.adler>>8&255),j.adler=0,D.status=B)):D.status=B),D.pending!==0){if(C(j),j.avail_out===0)return D.last_flush=-1,0}else if(j.avail_in===0&&V(J)<=V(P)&&J!==4)return q(j,-5);if(D.status===666&&j.avail_in!==0)return q(j,-5);if(j.avail_in!==0||D.lookahead!==0||J!==0&&D.status!==666){var ne=D.strategy===2?function(le,oe){for(var ee;;){if(le.lookahead===0&&(_(le),le.lookahead===0)){if(oe===0)return 1;break}if(le.match_length=0,ee=b._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++,ee&&(O(le,!1),le.strm.avail_out===0))return 1}return le.insert=0,oe===4?(O(le,!0),le.strm.avail_out===0?3:4):le.last_lit&&(O(le,!1),le.strm.avail_out===0)?1:2}(D,J):D.strategy===3?function(le,oe){for(var ee,Z,se,ie,ue=le.window;;){if(le.lookahead<=F){if(_(le),le.lookahead<=F&&oe===0)return 1;if(le.lookahead===0)break}if(le.match_length=0,le.lookahead>=3&&0<le.strstart&&(Z=ue[se=le.strstart-1])===ue[++se]&&Z===ue[++se]&&Z===ue[++se]){ie=le.strstart+F;do;while(Z===ue[++se]&&Z===ue[++se]&&Z===ue[++se]&&Z===ue[++se]&&Z===ue[++se]&&Z===ue[++se]&&Z===ue[++se]&&Z===ue[++se]&&se<ie);le.match_length=F-(ie-se),le.match_length>le.lookahead&&(le.match_length=le.lookahead)}if(le.match_length>=3?(ee=b._tr_tally(le,1,le.match_length-3),le.lookahead-=le.match_length,le.strstart+=le.match_length,le.match_length=0):(ee=b._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++),ee&&(O(le,!1),le.strm.avail_out===0))return 1}return le.insert=0,oe===4?(O(le,!0),le.strm.avail_out===0?3:4):le.last_lit&&(O(le,!1),le.strm.avail_out===0)?1:2}(D,J):p[D.level].func(D,J);if(ne!==3&&ne!==4||(D.status=666),ne===1||ne===3)return j.avail_out===0&&(D.last_flush=-1),0;if(ne===2&&(J===1?b._tr_align(D):J!==5&&(b._tr_stored_block(D,0,0,!1),J===3&&(I(D.head),D.lookahead===0&&(D.strstart=0,D.block_start=0,D.insert=0))),C(j),j.avail_out===0))return D.last_flush=-1,0}return J!==4?0:D.wrap<=0?1:(D.wrap===2?(E(D,255&j.adler),E(D,j.adler>>8&255),E(D,j.adler>>16&255),E(D,j.adler>>24&255),E(D,255&j.total_in),E(D,j.total_in>>8&255),E(D,j.total_in>>16&255),E(D,j.total_in>>24&255)):(x(D,j.adler>>>16),x(D,65535&j.adler)),C(j),0<D.wrap&&(D.wrap=-D.wrap),D.pending!==0?0:1)},m.deflateEnd=function(j){var J;return j&&j.state?(J=j.state.status)!==42&&J!==69&&J!==73&&J!==91&&J!==103&&J!==B&&J!==666?q(j,L):(j.state=null,J===B?q(j,-3):0):L},m.deflateSetDictionary=function(j,J){var P,D,G,re,te,ne,le,oe,ee=J.length;if(!j||!j.state||(re=(P=j.state).wrap)===2||re===1&&P.status!==42||P.lookahead)return L;for(re===1&&(j.adler=y(j.adler,J,ee,0)),P.wrap=0,ee>=P.w_size&&(re===0&&(I(P.head),P.strstart=0,P.block_start=0,P.insert=0),oe=new v.Buf8(P.w_size),v.arraySet(oe,J,ee-P.w_size,P.w_size,0),J=oe,ee=P.w_size),te=j.avail_in,ne=j.next_in,le=j.input,j.avail_in=ee,j.next_in=0,j.input=J,_(P);P.lookahead>=3;){for(D=P.strstart,G=P.lookahead-2;P.ins_h=(P.ins_h<<P.hash_shift^P.window[D+3-1])&P.hash_mask,P.prev[D&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=D,D++,--G;);P.strstart=D,P.lookahead=2,_(P)}return P.strstart+=P.lookahead,P.block_start=P.strstart,P.insert=P.lookahead,P.lookahead=0,P.match_length=P.prev_length=2,P.match_available=0,j.next_in=ne,j.input=le,j.avail_in=te,P.wrap=re,0},m.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(f,g,m){g.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(f,g,m){g.exports=function(p,v){var b,y,k,N,L,F,R,B,q,V,I,C,O,E,x,w,_,S,T,U,A,H,z,K,j;b=p.state,y=p.next_in,K=p.input,k=y+(p.avail_in-5),N=p.next_out,j=p.output,L=N-(v-p.avail_out),F=N+(p.avail_out-257),R=b.dmax,B=b.wsize,q=b.whave,V=b.wnext,I=b.window,C=b.hold,O=b.bits,E=b.lencode,x=b.distcode,w=(1<<b.lenbits)-1,_=(1<<b.distbits)-1;e:do{O<15&&(C+=K[y++]<<O,O+=8,C+=K[y++]<<O,O+=8),S=E[C&w];t:for(;;){if(C>>>=T=S>>>24,O-=T,(T=S>>>16&255)==0)j[N++]=65535&S;else{if(!(16&T)){if(!(64&T)){S=E[(65535&S)+(C&(1<<T)-1)];continue t}if(32&T){b.mode=12;break e}p.msg="invalid literal/length code",b.mode=30;break e}U=65535&S,(T&=15)&&(O<T&&(C+=K[y++]<<O,O+=8),U+=C&(1<<T)-1,C>>>=T,O-=T),O<15&&(C+=K[y++]<<O,O+=8,C+=K[y++]<<O,O+=8),S=x[C&_];r:for(;;){if(C>>>=T=S>>>24,O-=T,!(16&(T=S>>>16&255))){if(!(64&T)){S=x[(65535&S)+(C&(1<<T)-1)];continue r}p.msg="invalid distance code",b.mode=30;break e}if(A=65535&S,O<(T&=15)&&(C+=K[y++]<<O,(O+=8)<T&&(C+=K[y++]<<O,O+=8)),R<(A+=C&(1<<T)-1)){p.msg="invalid distance too far back",b.mode=30;break e}if(C>>>=T,O-=T,(T=N-L)<A){if(q<(T=A-T)&&b.sane){p.msg="invalid distance too far back",b.mode=30;break e}if(z=I,(H=0)===V){if(H+=B-T,T<U){for(U-=T;j[N++]=I[H++],--T;);H=N-A,z=j}}else if(V<T){if(H+=B+V-T,(T-=V)<U){for(U-=T;j[N++]=I[H++],--T;);if(H=0,V<U){for(U-=T=V;j[N++]=I[H++],--T;);H=N-A,z=j}}}else if(H+=V-T,T<U){for(U-=T;j[N++]=I[H++],--T;);H=N-A,z=j}for(;2<U;)j[N++]=z[H++],j[N++]=z[H++],j[N++]=z[H++],U-=3;U&&(j[N++]=z[H++],1<U&&(j[N++]=z[H++]))}else{for(H=N-A;j[N++]=j[H++],j[N++]=j[H++],j[N++]=j[H++],2<(U-=3););U&&(j[N++]=j[H++],1<U&&(j[N++]=j[H++]))}break}}break}}while(y<k&&N<F);y-=U=O>>3,C&=(1<<(O-=U<<3))-1,p.next_in=y,p.next_out=N,p.avail_in=y<k?k-y+5:5-(y-k),p.avail_out=N<F?F-N+257:257-(N-F),b.hold=C,b.bits=O}},{}],49:[function(f,g,m){var p=f("../utils/common"),v=f("./adler32"),b=f("./crc32"),y=f("./inffast"),k=f("./inftrees"),N=-2;function L(w){return(w>>>24&255)+(w>>>8&65280)+((65280&w)<<8)+((255&w)<<24)}function F(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new p.Buf16(320),this.work=new p.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function R(w){var _;return w&&w.state?(_=w.state,w.total_in=w.total_out=_.total=0,w.msg="",_.wrap&&(w.adler=1&_.wrap),_.mode=1,_.last=0,_.havedict=0,_.dmax=32768,_.head=null,_.hold=0,_.bits=0,_.lencode=_.lendyn=new p.Buf32(852),_.distcode=_.distdyn=new p.Buf32(592),_.sane=1,_.back=-1,0):N}function B(w){var _;return w&&w.state?((_=w.state).wsize=0,_.whave=0,_.wnext=0,R(w)):N}function q(w,_){var S,T;return w&&w.state?(T=w.state,_<0?(S=0,_=-_):(S=1+(_>>4),_<48&&(_&=15)),_&&(_<8||15<_)?N:(T.window!==null&&T.wbits!==_&&(T.window=null),T.wrap=S,T.wbits=_,B(w))):N}function V(w,_){var S,T;return w?(T=new F,(w.state=T).window=null,(S=q(w,_))!==0&&(w.state=null),S):N}var I,C,O=!0;function E(w){if(O){var _;for(I=new p.Buf32(512),C=new p.Buf32(32),_=0;_<144;)w.lens[_++]=8;for(;_<256;)w.lens[_++]=9;for(;_<280;)w.lens[_++]=7;for(;_<288;)w.lens[_++]=8;for(k(1,w.lens,0,288,I,0,w.work,{bits:9}),_=0;_<32;)w.lens[_++]=5;k(2,w.lens,0,32,C,0,w.work,{bits:5}),O=!1}w.lencode=I,w.lenbits=9,w.distcode=C,w.distbits=5}function x(w,_,S,T){var U,A=w.state;return A.window===null&&(A.wsize=1<<A.wbits,A.wnext=0,A.whave=0,A.window=new p.Buf8(A.wsize)),T>=A.wsize?(p.arraySet(A.window,_,S-A.wsize,A.wsize,0),A.wnext=0,A.whave=A.wsize):(T<(U=A.wsize-A.wnext)&&(U=T),p.arraySet(A.window,_,S-T,U,A.wnext),(T-=U)?(p.arraySet(A.window,_,S-T,T,0),A.wnext=T,A.whave=A.wsize):(A.wnext+=U,A.wnext===A.wsize&&(A.wnext=0),A.whave<A.wsize&&(A.whave+=U))),0}m.inflateReset=B,m.inflateReset2=q,m.inflateResetKeep=R,m.inflateInit=function(w){return V(w,15)},m.inflateInit2=V,m.inflate=function(w,_){var S,T,U,A,H,z,K,j,J,P,D,G,re,te,ne,le,oe,ee,Z,se,ie,ue,pe,fe,ye=0,Te=new p.Buf8(4),Pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!w||!w.state||!w.output||!w.input&&w.avail_in!==0)return N;(S=w.state).mode===12&&(S.mode=13),H=w.next_out,U=w.output,K=w.avail_out,A=w.next_in,T=w.input,z=w.avail_in,j=S.hold,J=S.bits,P=z,D=K,ue=0;e:for(;;)switch(S.mode){case 1:if(S.wrap===0){S.mode=13;break}for(;J<16;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}if(2&S.wrap&&j===35615){Te[S.check=0]=255&j,Te[1]=j>>>8&255,S.check=b(S.check,Te,2,0),J=j=0,S.mode=2;break}if(S.flags=0,S.head&&(S.head.done=!1),!(1&S.wrap)||(((255&j)<<8)+(j>>8))%31){w.msg="incorrect header check",S.mode=30;break}if((15&j)!=8){w.msg="unknown compression method",S.mode=30;break}if(J-=4,ie=8+(15&(j>>>=4)),S.wbits===0)S.wbits=ie;else if(ie>S.wbits){w.msg="invalid window size",S.mode=30;break}S.dmax=1<<ie,w.adler=S.check=1,S.mode=512&j?10:12,J=j=0;break;case 2:for(;J<16;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}if(S.flags=j,(255&S.flags)!=8){w.msg="unknown compression method",S.mode=30;break}if(57344&S.flags){w.msg="unknown header flags set",S.mode=30;break}S.head&&(S.head.text=j>>8&1),512&S.flags&&(Te[0]=255&j,Te[1]=j>>>8&255,S.check=b(S.check,Te,2,0)),J=j=0,S.mode=3;case 3:for(;J<32;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}S.head&&(S.head.time=j),512&S.flags&&(Te[0]=255&j,Te[1]=j>>>8&255,Te[2]=j>>>16&255,Te[3]=j>>>24&255,S.check=b(S.check,Te,4,0)),J=j=0,S.mode=4;case 4:for(;J<16;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}S.head&&(S.head.xflags=255&j,S.head.os=j>>8),512&S.flags&&(Te[0]=255&j,Te[1]=j>>>8&255,S.check=b(S.check,Te,2,0)),J=j=0,S.mode=5;case 5:if(1024&S.flags){for(;J<16;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}S.length=j,S.head&&(S.head.extra_len=j),512&S.flags&&(Te[0]=255&j,Te[1]=j>>>8&255,S.check=b(S.check,Te,2,0)),J=j=0}else S.head&&(S.head.extra=null);S.mode=6;case 6:if(1024&S.flags&&(z<(G=S.length)&&(G=z),G&&(S.head&&(ie=S.head.extra_len-S.length,S.head.extra||(S.head.extra=new Array(S.head.extra_len)),p.arraySet(S.head.extra,T,A,G,ie)),512&S.flags&&(S.check=b(S.check,T,G,A)),z-=G,A+=G,S.length-=G),S.length))break e;S.length=0,S.mode=7;case 7:if(2048&S.flags){if(z===0)break e;for(G=0;ie=T[A+G++],S.head&&ie&&S.length<65536&&(S.head.name+=String.fromCharCode(ie)),ie&&G<z;);if(512&S.flags&&(S.check=b(S.check,T,G,A)),z-=G,A+=G,ie)break e}else S.head&&(S.head.name=null);S.length=0,S.mode=8;case 8:if(4096&S.flags){if(z===0)break e;for(G=0;ie=T[A+G++],S.head&&ie&&S.length<65536&&(S.head.comment+=String.fromCharCode(ie)),ie&&G<z;);if(512&S.flags&&(S.check=b(S.check,T,G,A)),z-=G,A+=G,ie)break e}else S.head&&(S.head.comment=null);S.mode=9;case 9:if(512&S.flags){for(;J<16;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}if(j!==(65535&S.check)){w.msg="header crc mismatch",S.mode=30;break}J=j=0}S.head&&(S.head.hcrc=S.flags>>9&1,S.head.done=!0),w.adler=S.check=0,S.mode=12;break;case 10:for(;J<32;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}w.adler=S.check=L(j),J=j=0,S.mode=11;case 11:if(S.havedict===0)return w.next_out=H,w.avail_out=K,w.next_in=A,w.avail_in=z,S.hold=j,S.bits=J,2;w.adler=S.check=1,S.mode=12;case 12:if(_===5||_===6)break e;case 13:if(S.last){j>>>=7&J,J-=7&J,S.mode=27;break}for(;J<3;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}switch(S.last=1&j,J-=1,3&(j>>>=1)){case 0:S.mode=14;break;case 1:if(E(S),S.mode=20,_!==6)break;j>>>=2,J-=2;break e;case 2:S.mode=17;break;case 3:w.msg="invalid block type",S.mode=30}j>>>=2,J-=2;break;case 14:for(j>>>=7&J,J-=7&J;J<32;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}if((65535&j)!=(j>>>16^65535)){w.msg="invalid stored block lengths",S.mode=30;break}if(S.length=65535&j,J=j=0,S.mode=15,_===6)break e;case 15:S.mode=16;case 16:if(G=S.length){if(z<G&&(G=z),K<G&&(G=K),G===0)break e;p.arraySet(U,T,A,G,H),z-=G,A+=G,K-=G,H+=G,S.length-=G;break}S.mode=12;break;case 17:for(;J<14;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}if(S.nlen=257+(31&j),j>>>=5,J-=5,S.ndist=1+(31&j),j>>>=5,J-=5,S.ncode=4+(15&j),j>>>=4,J-=4,286<S.nlen||30<S.ndist){w.msg="too many length or distance symbols",S.mode=30;break}S.have=0,S.mode=18;case 18:for(;S.have<S.ncode;){for(;J<3;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}S.lens[Pe[S.have++]]=7&j,j>>>=3,J-=3}for(;S.have<19;)S.lens[Pe[S.have++]]=0;if(S.lencode=S.lendyn,S.lenbits=7,pe={bits:S.lenbits},ue=k(0,S.lens,0,19,S.lencode,0,S.work,pe),S.lenbits=pe.bits,ue){w.msg="invalid code lengths set",S.mode=30;break}S.have=0,S.mode=19;case 19:for(;S.have<S.nlen+S.ndist;){for(;le=(ye=S.lencode[j&(1<<S.lenbits)-1])>>>16&255,oe=65535&ye,!((ne=ye>>>24)<=J);){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}if(oe<16)j>>>=ne,J-=ne,S.lens[S.have++]=oe;else{if(oe===16){for(fe=ne+2;J<fe;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}if(j>>>=ne,J-=ne,S.have===0){w.msg="invalid bit length repeat",S.mode=30;break}ie=S.lens[S.have-1],G=3+(3&j),j>>>=2,J-=2}else if(oe===17){for(fe=ne+3;J<fe;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}J-=ne,ie=0,G=3+(7&(j>>>=ne)),j>>>=3,J-=3}else{for(fe=ne+7;J<fe;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}J-=ne,ie=0,G=11+(127&(j>>>=ne)),j>>>=7,J-=7}if(S.have+G>S.nlen+S.ndist){w.msg="invalid bit length repeat",S.mode=30;break}for(;G--;)S.lens[S.have++]=ie}}if(S.mode===30)break;if(S.lens[256]===0){w.msg="invalid code -- missing end-of-block",S.mode=30;break}if(S.lenbits=9,pe={bits:S.lenbits},ue=k(1,S.lens,0,S.nlen,S.lencode,0,S.work,pe),S.lenbits=pe.bits,ue){w.msg="invalid literal/lengths set",S.mode=30;break}if(S.distbits=6,S.distcode=S.distdyn,pe={bits:S.distbits},ue=k(2,S.lens,S.nlen,S.ndist,S.distcode,0,S.work,pe),S.distbits=pe.bits,ue){w.msg="invalid distances set",S.mode=30;break}if(S.mode=20,_===6)break e;case 20:S.mode=21;case 21:if(6<=z&&258<=K){w.next_out=H,w.avail_out=K,w.next_in=A,w.avail_in=z,S.hold=j,S.bits=J,y(w,D),H=w.next_out,U=w.output,K=w.avail_out,A=w.next_in,T=w.input,z=w.avail_in,j=S.hold,J=S.bits,S.mode===12&&(S.back=-1);break}for(S.back=0;le=(ye=S.lencode[j&(1<<S.lenbits)-1])>>>16&255,oe=65535&ye,!((ne=ye>>>24)<=J);){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}if(le&&!(240&le)){for(ee=ne,Z=le,se=oe;le=(ye=S.lencode[se+((j&(1<<ee+Z)-1)>>ee)])>>>16&255,oe=65535&ye,!(ee+(ne=ye>>>24)<=J);){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}j>>>=ee,J-=ee,S.back+=ee}if(j>>>=ne,J-=ne,S.back+=ne,S.length=oe,le===0){S.mode=26;break}if(32&le){S.back=-1,S.mode=12;break}if(64&le){w.msg="invalid literal/length code",S.mode=30;break}S.extra=15&le,S.mode=22;case 22:if(S.extra){for(fe=S.extra;J<fe;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}S.length+=j&(1<<S.extra)-1,j>>>=S.extra,J-=S.extra,S.back+=S.extra}S.was=S.length,S.mode=23;case 23:for(;le=(ye=S.distcode[j&(1<<S.distbits)-1])>>>16&255,oe=65535&ye,!((ne=ye>>>24)<=J);){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}if(!(240&le)){for(ee=ne,Z=le,se=oe;le=(ye=S.distcode[se+((j&(1<<ee+Z)-1)>>ee)])>>>16&255,oe=65535&ye,!(ee+(ne=ye>>>24)<=J);){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}j>>>=ee,J-=ee,S.back+=ee}if(j>>>=ne,J-=ne,S.back+=ne,64&le){w.msg="invalid distance code",S.mode=30;break}S.offset=oe,S.extra=15&le,S.mode=24;case 24:if(S.extra){for(fe=S.extra;J<fe;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}S.offset+=j&(1<<S.extra)-1,j>>>=S.extra,J-=S.extra,S.back+=S.extra}if(S.offset>S.dmax){w.msg="invalid distance too far back",S.mode=30;break}S.mode=25;case 25:if(K===0)break e;if(G=D-K,S.offset>G){if((G=S.offset-G)>S.whave&&S.sane){w.msg="invalid distance too far back",S.mode=30;break}re=G>S.wnext?(G-=S.wnext,S.wsize-G):S.wnext-G,G>S.length&&(G=S.length),te=S.window}else te=U,re=H-S.offset,G=S.length;for(K<G&&(G=K),K-=G,S.length-=G;U[H++]=te[re++],--G;);S.length===0&&(S.mode=21);break;case 26:if(K===0)break e;U[H++]=S.length,K--,S.mode=21;break;case 27:if(S.wrap){for(;J<32;){if(z===0)break e;z--,j|=T[A++]<<J,J+=8}if(D-=K,w.total_out+=D,S.total+=D,D&&(w.adler=S.check=S.flags?b(S.check,U,D,H-D):v(S.check,U,D,H-D)),D=K,(S.flags?j:L(j))!==S.check){w.msg="incorrect data check",S.mode=30;break}J=j=0}S.mode=28;case 28:if(S.wrap&&S.flags){for(;J<32;){if(z===0)break e;z--,j+=T[A++]<<J,J+=8}if(j!==(4294967295&S.total)){w.msg="incorrect length check",S.mode=30;break}J=j=0}S.mode=29;case 29:ue=1;break e;case 30:ue=-3;break e;case 31:return-4;case 32:default:return N}return w.next_out=H,w.avail_out=K,w.next_in=A,w.avail_in=z,S.hold=j,S.bits=J,(S.wsize||D!==w.avail_out&&S.mode<30&&(S.mode<27||_!==4))&&x(w,w.output,w.next_out,D-w.avail_out)?(S.mode=31,-4):(P-=w.avail_in,D-=w.avail_out,w.total_in+=P,w.total_out+=D,S.total+=D,S.wrap&&D&&(w.adler=S.check=S.flags?b(S.check,U,D,w.next_out-D):v(S.check,U,D,w.next_out-D)),w.data_type=S.bits+(S.last?64:0)+(S.mode===12?128:0)+(S.mode===20||S.mode===15?256:0),(P==0&&D===0||_===4)&&ue===0&&(ue=-5),ue)},m.inflateEnd=function(w){if(!w||!w.state)return N;var _=w.state;return _.window&&(_.window=null),w.state=null,0},m.inflateGetHeader=function(w,_){var S;return w&&w.state&&2&(S=w.state).wrap?((S.head=_).done=!1,0):N},m.inflateSetDictionary=function(w,_){var S,T=_.length;return w&&w.state?(S=w.state).wrap!==0&&S.mode!==11?N:S.mode===11&&v(1,_,T,0)!==S.check?-3:x(w,_,T,T)?(S.mode=31,-4):(S.havedict=1,0):N},m.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(f,g,m){var p=f("../utils/common"),v=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],b=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],k=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];g.exports=function(N,L,F,R,B,q,V,I){var C,O,E,x,w,_,S,T,U,A=I.bits,H=0,z=0,K=0,j=0,J=0,P=0,D=0,G=0,re=0,te=0,ne=null,le=0,oe=new p.Buf16(16),ee=new p.Buf16(16),Z=null,se=0;for(H=0;H<=15;H++)oe[H]=0;for(z=0;z<R;z++)oe[L[F+z]]++;for(J=A,j=15;1<=j&&oe[j]===0;j--);if(j<J&&(J=j),j===0)return B[q++]=20971520,B[q++]=20971520,I.bits=1,0;for(K=1;K<j&&oe[K]===0;K++);for(J<K&&(J=K),H=G=1;H<=15;H++)if(G<<=1,(G-=oe[H])<0)return-1;if(0<G&&(N===0||j!==1))return-1;for(ee[1]=0,H=1;H<15;H++)ee[H+1]=ee[H]+oe[H];for(z=0;z<R;z++)L[F+z]!==0&&(V[ee[L[F+z]]++]=z);if(_=N===0?(ne=Z=V,19):N===1?(ne=v,le-=257,Z=b,se-=257,256):(ne=y,Z=k,-1),H=K,w=q,D=z=te=0,E=-1,x=(re=1<<(P=J))-1,N===1&&852<re||N===2&&592<re)return 1;for(;;){for(S=H-D,U=V[z]<_?(T=0,V[z]):V[z]>_?(T=Z[se+V[z]],ne[le+V[z]]):(T=96,0),C=1<<H-D,K=O=1<<P;B[w+(te>>D)+(O-=C)]=S<<24|T<<16|U|0,O!==0;);for(C=1<<H-1;te&C;)C>>=1;if(C!==0?(te&=C-1,te+=C):te=0,z++,--oe[H]==0){if(H===j)break;H=L[F+V[z]]}if(J<H&&(te&x)!==E){for(D===0&&(D=J),w+=K,G=1<<(P=H-D);P+D<j&&!((G-=oe[P+D])<=0);)P++,G<<=1;if(re+=1<<P,N===1&&852<re||N===2&&592<re)return 1;B[E=te&x]=J<<24|P<<16|w-q|0}}return te!==0&&(B[w+te]=H-D<<24|64<<16|0),I.bits=J,0}},{"../utils/common":41}],51:[function(f,g,m){g.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(f,g,m){var p=f("../utils/common");function v(Z){for(var se=Z.length;0<=--se;)Z[se]=0}var b=256,y=286,k=30,N=15,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],F=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=new Array(576);v(q);var V=new Array(60);v(V);var I=new Array(512);v(I);var C=new Array(256);v(C);var O=new Array(29);v(O);var E,x,w,_=new Array(k);function S(Z,se,ie,ue,pe){this.static_tree=Z,this.extra_bits=se,this.extra_base=ie,this.elems=ue,this.max_length=pe,this.has_stree=Z&&Z.length}function T(Z,se){this.dyn_tree=Z,this.max_code=0,this.stat_desc=se}function U(Z){return Z<256?I[Z]:I[256+(Z>>>7)]}function A(Z,se){Z.pending_buf[Z.pending++]=255&se,Z.pending_buf[Z.pending++]=se>>>8&255}function H(Z,se,ie){Z.bi_valid>16-ie?(Z.bi_buf|=se<<Z.bi_valid&65535,A(Z,Z.bi_buf),Z.bi_buf=se>>16-Z.bi_valid,Z.bi_valid+=ie-16):(Z.bi_buf|=se<<Z.bi_valid&65535,Z.bi_valid+=ie)}function z(Z,se,ie){H(Z,ie[2*se],ie[2*se+1])}function K(Z,se){for(var ie=0;ie|=1&Z,Z>>>=1,ie<<=1,0<--se;);return ie>>>1}function j(Z,se,ie){var ue,pe,fe=new Array(16),ye=0;for(ue=1;ue<=N;ue++)fe[ue]=ye=ye+ie[ue-1]<<1;for(pe=0;pe<=se;pe++){var Te=Z[2*pe+1];Te!==0&&(Z[2*pe]=K(fe[Te]++,Te))}}function J(Z){var se;for(se=0;se<y;se++)Z.dyn_ltree[2*se]=0;for(se=0;se<k;se++)Z.dyn_dtree[2*se]=0;for(se=0;se<19;se++)Z.bl_tree[2*se]=0;Z.dyn_ltree[512]=1,Z.opt_len=Z.static_len=0,Z.last_lit=Z.matches=0}function P(Z){8<Z.bi_valid?A(Z,Z.bi_buf):0<Z.bi_valid&&(Z.pending_buf[Z.pending++]=Z.bi_buf),Z.bi_buf=0,Z.bi_valid=0}function D(Z,se,ie,ue){var pe=2*se,fe=2*ie;return Z[pe]<Z[fe]||Z[pe]===Z[fe]&&ue[se]<=ue[ie]}function G(Z,se,ie){for(var ue=Z.heap[ie],pe=ie<<1;pe<=Z.heap_len&&(pe<Z.heap_len&&D(se,Z.heap[pe+1],Z.heap[pe],Z.depth)&&pe++,!D(se,ue,Z.heap[pe],Z.depth));)Z.heap[ie]=Z.heap[pe],ie=pe,pe<<=1;Z.heap[ie]=ue}function re(Z,se,ie){var ue,pe,fe,ye,Te=0;if(Z.last_lit!==0)for(;ue=Z.pending_buf[Z.d_buf+2*Te]<<8|Z.pending_buf[Z.d_buf+2*Te+1],pe=Z.pending_buf[Z.l_buf+Te],Te++,ue===0?z(Z,pe,se):(z(Z,(fe=C[pe])+b+1,se),(ye=L[fe])!==0&&H(Z,pe-=O[fe],ye),z(Z,fe=U(--ue),ie),(ye=F[fe])!==0&&H(Z,ue-=_[fe],ye)),Te<Z.last_lit;);z(Z,256,se)}function te(Z,se){var ie,ue,pe,fe=se.dyn_tree,ye=se.stat_desc.static_tree,Te=se.stat_desc.has_stree,Pe=se.stat_desc.elems,je=-1;for(Z.heap_len=0,Z.heap_max=573,ie=0;ie<Pe;ie++)fe[2*ie]!==0?(Z.heap[++Z.heap_len]=je=ie,Z.depth[ie]=0):fe[2*ie+1]=0;for(;Z.heap_len<2;)fe[2*(pe=Z.heap[++Z.heap_len]=je<2?++je:0)]=1,Z.depth[pe]=0,Z.opt_len--,Te&&(Z.static_len-=ye[2*pe+1]);for(se.max_code=je,ie=Z.heap_len>>1;1<=ie;ie--)G(Z,fe,ie);for(pe=Pe;ie=Z.heap[1],Z.heap[1]=Z.heap[Z.heap_len--],G(Z,fe,1),ue=Z.heap[1],Z.heap[--Z.heap_max]=ie,Z.heap[--Z.heap_max]=ue,fe[2*pe]=fe[2*ie]+fe[2*ue],Z.depth[pe]=(Z.depth[ie]>=Z.depth[ue]?Z.depth[ie]:Z.depth[ue])+1,fe[2*ie+1]=fe[2*ue+1]=pe,Z.heap[1]=pe++,G(Z,fe,1),2<=Z.heap_len;);Z.heap[--Z.heap_max]=Z.heap[1],function(qe,We){var at,Ye,rt,ht,Ce,Ie,Ve=We.dyn_tree,De=We.max_code,Oe=We.stat_desc.static_tree,Xe=We.stat_desc.has_stree,nt=We.stat_desc.extra_bits,Je=We.stat_desc.extra_base,wt=We.stat_desc.max_length,gt=0;for(ht=0;ht<=N;ht++)qe.bl_count[ht]=0;for(Ve[2*qe.heap[qe.heap_max]+1]=0,at=qe.heap_max+1;at<573;at++)wt<(ht=Ve[2*Ve[2*(Ye=qe.heap[at])+1]+1]+1)&&(ht=wt,gt++),Ve[2*Ye+1]=ht,De<Ye||(qe.bl_count[ht]++,Ce=0,Je<=Ye&&(Ce=nt[Ye-Je]),Ie=Ve[2*Ye],qe.opt_len+=Ie*(ht+Ce),Xe&&(qe.static_len+=Ie*(Oe[2*Ye+1]+Ce)));if(gt!==0){do{for(ht=wt-1;qe.bl_count[ht]===0;)ht--;qe.bl_count[ht]--,qe.bl_count[ht+1]+=2,qe.bl_count[wt]--,gt-=2}while(0<gt);for(ht=wt;ht!==0;ht--)for(Ye=qe.bl_count[ht];Ye!==0;)De<(rt=qe.heap[--at])||(Ve[2*rt+1]!==ht&&(qe.opt_len+=(ht-Ve[2*rt+1])*Ve[2*rt],Ve[2*rt+1]=ht),Ye--)}}(Z,se),j(fe,je,Z.bl_count)}function ne(Z,se,ie){var ue,pe,fe=-1,ye=se[1],Te=0,Pe=7,je=4;for(ye===0&&(Pe=138,je=3),se[2*(ie+1)+1]=65535,ue=0;ue<=ie;ue++)pe=ye,ye=se[2*(ue+1)+1],++Te<Pe&&pe===ye||(Te<je?Z.bl_tree[2*pe]+=Te:pe!==0?(pe!==fe&&Z.bl_tree[2*pe]++,Z.bl_tree[32]++):Te<=10?Z.bl_tree[34]++:Z.bl_tree[36]++,fe=pe,je=(Te=0)===ye?(Pe=138,3):pe===ye?(Pe=6,3):(Pe=7,4))}function le(Z,se,ie){var ue,pe,fe=-1,ye=se[1],Te=0,Pe=7,je=4;for(ye===0&&(Pe=138,je=3),ue=0;ue<=ie;ue++)if(pe=ye,ye=se[2*(ue+1)+1],!(++Te<Pe&&pe===ye)){if(Te<je)for(;z(Z,pe,Z.bl_tree),--Te!=0;);else pe!==0?(pe!==fe&&(z(Z,pe,Z.bl_tree),Te--),z(Z,16,Z.bl_tree),H(Z,Te-3,2)):Te<=10?(z(Z,17,Z.bl_tree),H(Z,Te-3,3)):(z(Z,18,Z.bl_tree),H(Z,Te-11,7));fe=pe,je=(Te=0)===ye?(Pe=138,3):pe===ye?(Pe=6,3):(Pe=7,4)}}v(_);var oe=!1;function ee(Z,se,ie,ue){H(Z,0+(ue?1:0),3),function(pe,fe,ye,Te){P(pe),A(pe,ye),A(pe,~ye),p.arraySet(pe.pending_buf,pe.window,fe,ye,pe.pending),pe.pending+=ye}(Z,se,ie)}m._tr_init=function(Z){oe||(function(){var se,ie,ue,pe,fe,ye=new Array(16);for(pe=ue=0;pe<28;pe++)for(O[pe]=ue,se=0;se<1<<L[pe];se++)C[ue++]=pe;for(C[ue-1]=pe,pe=fe=0;pe<16;pe++)for(_[pe]=fe,se=0;se<1<<F[pe];se++)I[fe++]=pe;for(fe>>=7;pe<k;pe++)for(_[pe]=fe<<7,se=0;se<1<<F[pe]-7;se++)I[256+fe++]=pe;for(ie=0;ie<=N;ie++)ye[ie]=0;for(se=0;se<=143;)q[2*se+1]=8,se++,ye[8]++;for(;se<=255;)q[2*se+1]=9,se++,ye[9]++;for(;se<=279;)q[2*se+1]=7,se++,ye[7]++;for(;se<=287;)q[2*se+1]=8,se++,ye[8]++;for(j(q,287,ye),se=0;se<k;se++)V[2*se+1]=5,V[2*se]=K(se,5);E=new S(q,L,257,y,N),x=new S(V,F,0,k,N),w=new S(new Array(0),R,0,19,7)}(),oe=!0),Z.l_desc=new T(Z.dyn_ltree,E),Z.d_desc=new T(Z.dyn_dtree,x),Z.bl_desc=new T(Z.bl_tree,w),Z.bi_buf=0,Z.bi_valid=0,J(Z)},m._tr_stored_block=ee,m._tr_flush_block=function(Z,se,ie,ue){var pe,fe,ye=0;0<Z.level?(Z.strm.data_type===2&&(Z.strm.data_type=function(Te){var Pe,je=4093624447;for(Pe=0;Pe<=31;Pe++,je>>>=1)if(1&je&&Te.dyn_ltree[2*Pe]!==0)return 0;if(Te.dyn_ltree[18]!==0||Te.dyn_ltree[20]!==0||Te.dyn_ltree[26]!==0)return 1;for(Pe=32;Pe<b;Pe++)if(Te.dyn_ltree[2*Pe]!==0)return 1;return 0}(Z)),te(Z,Z.l_desc),te(Z,Z.d_desc),ye=function(Te){var Pe;for(ne(Te,Te.dyn_ltree,Te.l_desc.max_code),ne(Te,Te.dyn_dtree,Te.d_desc.max_code),te(Te,Te.bl_desc),Pe=18;3<=Pe&&Te.bl_tree[2*B[Pe]+1]===0;Pe--);return Te.opt_len+=3*(Pe+1)+5+5+4,Pe}(Z),pe=Z.opt_len+3+7>>>3,(fe=Z.static_len+3+7>>>3)<=pe&&(pe=fe)):pe=fe=ie+5,ie+4<=pe&&se!==-1?ee(Z,se,ie,ue):Z.strategy===4||fe===pe?(H(Z,2+(ue?1:0),3),re(Z,q,V)):(H(Z,4+(ue?1:0),3),function(Te,Pe,je,qe){var We;for(H(Te,Pe-257,5),H(Te,je-1,5),H(Te,qe-4,4),We=0;We<qe;We++)H(Te,Te.bl_tree[2*B[We]+1],3);le(Te,Te.dyn_ltree,Pe-1),le(Te,Te.dyn_dtree,je-1)}(Z,Z.l_desc.max_code+1,Z.d_desc.max_code+1,ye+1),re(Z,Z.dyn_ltree,Z.dyn_dtree)),J(Z),ue&&P(Z)},m._tr_tally=function(Z,se,ie){return Z.pending_buf[Z.d_buf+2*Z.last_lit]=se>>>8&255,Z.pending_buf[Z.d_buf+2*Z.last_lit+1]=255&se,Z.pending_buf[Z.l_buf+Z.last_lit]=255&ie,Z.last_lit++,se===0?Z.dyn_ltree[2*ie]++:(Z.matches++,se--,Z.dyn_ltree[2*(C[ie]+b+1)]++,Z.dyn_dtree[2*U(se)]++),Z.last_lit===Z.lit_bufsize-1},m._tr_align=function(Z){H(Z,2,3),z(Z,256,q),function(se){se.bi_valid===16?(A(se,se.bi_buf),se.bi_buf=0,se.bi_valid=0):8<=se.bi_valid&&(se.pending_buf[se.pending++]=255&se.bi_buf,se.bi_buf>>=8,se.bi_valid-=8)}(Z)}},{"../utils/common":41}],53:[function(f,g,m){g.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(f,g,m){(function(p){(function(v,b){if(!v.setImmediate){var y,k,N,L,F=1,R={},B=!1,q=v.document,V=Object.getPrototypeOf&&Object.getPrototypeOf(v);V=V&&V.setTimeout?V:v,y={}.toString.call(v.process)==="[object process]"?function(E){a.nextTick(function(){C(E)})}:function(){if(v.postMessage&&!v.importScripts){var E=!0,x=v.onmessage;return v.onmessage=function(){E=!1},v.postMessage("","*"),v.onmessage=x,E}}()?(L="setImmediate$"+Math.random()+"$",v.addEventListener?v.addEventListener("message",O,!1):v.attachEvent("onmessage",O),function(E){v.postMessage(L+E,"*")}):v.MessageChannel?((N=new MessageChannel).port1.onmessage=function(E){C(E.data)},function(E){N.port2.postMessage(E)}):q&&"onreadystatechange"in q.createElement("script")?(k=q.documentElement,function(E){var x=q.createElement("script");x.onreadystatechange=function(){C(E),x.onreadystatechange=null,k.removeChild(x),x=null},k.appendChild(x)}):function(E){setTimeout(C,0,E)},V.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var x=new Array(arguments.length-1),w=0;w<x.length;w++)x[w]=arguments[w+1];var _={callback:E,args:x};return R[F]=_,y(F),F++},V.clearImmediate=I}function I(E){delete R[E]}function C(E){if(B)setTimeout(C,0,E);else{var x=R[E];if(x){B=!0;try{(function(w){var _=w.callback,S=w.args;switch(S.length){case 0:_();break;case 1:_(S[0]);break;case 2:_(S[0],S[1]);break;case 3:_(S[0],S[1],S[2]);break;default:_.apply(void 0,S)}})(x)}finally{I(E),B=!1}}}}function O(E){E.source===v&&typeof E.data=="string"&&E.data.indexOf(L)===0&&C(+E.data.slice(L.length))}})(typeof self>"u"?p===void 0?this:p:self)}).call(this,i!==void 0?i:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}).call(this)}).call(this,e("_process"),typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],e("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(e,n,s){(function(a){(function(){var i=/[\\^$.*+?()[\]{}|]/g,o=RegExp(i.source),l=typeof a=="object"&&a&&a.Object===Object&&a,c=typeof self=="object"&&self&&self.Object===Object&&self,u=l||c||Function("return this")(),d=Object.prototype.toString,h=u.Symbol,f=h?h.prototype:void 0,g=f?f.toString:void 0;function m(p){if(typeof p=="string")return p;if(function(b){return typeof b=="symbol"||function(y){return!!y&&typeof y=="object"}(b)&&d.call(b)=="[object Symbol]"}(p))return g?g.call(p):"";var v=p+"";return v=="0"&&1/p==-1/0?"-0":v}n.exports=function(p){var v;return(p=(v=p)==null?"":m(v))&&o.test(p)?p.replace(i,"\\$&"):p}}).call(this)}).call(this,typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(e,n,s){(function(a){(function(){var i="[object Arguments]",o="[object Map]",l="[object Object]",c="[object Set]",u=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,d=/^\w*$/,h=/^\./,f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,g=/\\(\\)?/g,m=/^\[object .+?Constructor\]$/,p=/^(?:0|[1-9]\d*)$/,v={};v["[object Float32Array]"]=v["[object Float64Array]"]=v["[object Int8Array]"]=v["[object Int16Array]"]=v["[object Int32Array]"]=v["[object Uint8Array]"]=v["[object Uint8ClampedArray]"]=v["[object Uint16Array]"]=v["[object Uint32Array]"]=!0,v[i]=v["[object Array]"]=v["[object ArrayBuffer]"]=v["[object Boolean]"]=v["[object DataView]"]=v["[object Date]"]=v["[object Error]"]=v["[object Function]"]=v[o]=v["[object Number]"]=v[l]=v["[object RegExp]"]=v[c]=v["[object String]"]=v["[object WeakMap]"]=!1;var b=typeof a=="object"&&a&&a.Object===Object&&a,y=typeof self=="object"&&self&&self.Object===Object&&self,k=b||y||Function("return this")(),N=typeof s=="object"&&s&&!s.nodeType&&s,L=N&&typeof n=="object"&&n&&!n.nodeType&&n,F=L&&L.exports===N&&b.process,R=function(){try{return F&&F.binding("util")}catch{}}(),B=R&&R.isTypedArray;function q(be,Me,it,mt){for(var Rt=-1,kt=be?be.length:0;++Rt<kt;){var Nt=be[Rt];Me(mt,Nt,it(Nt),be)}return mt}function V(be,Me){for(var it=-1,mt=be?be.length:0;++it<mt;)if(Me(be[it],it,be))return!0;return!1}function I(be){var Me=!1;if(be!=null&&typeof be.toString!="function")try{Me=!!(be+"")}catch{}return Me}function C(be){var Me=-1,it=Array(be.size);return be.forEach(function(mt,Rt){it[++Me]=[Rt,mt]}),it}function O(be){var Me=-1,it=Array(be.size);return be.forEach(function(mt){it[++Me]=mt}),it}var E,x,w,_=Array.prototype,S=Function.prototype,T=Object.prototype,U=k["__core-js_shared__"],A=(E=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||""))?"Symbol(src)_1."+E:"",H=S.toString,z=T.hasOwnProperty,K=T.toString,j=RegExp("^"+H.call(z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),J=k.Symbol,P=k.Uint8Array,D=T.propertyIsEnumerable,G=_.splice,re=(x=Object.keys,w=Object,function(be){return x(w(be))}),te=ft(k,"DataView"),ne=ft(k,"Map"),le=ft(k,"Promise"),oe=ft(k,"Set"),ee=ft(k,"WeakMap"),Z=ft(Object,"create"),se=Be(te),ie=Be(ne),ue=Be(le),pe=Be(oe),fe=Be(ee),ye=J?J.prototype:void 0,Te=ye?ye.valueOf:void 0,Pe=ye?ye.toString:void 0;function je(be){var Me=-1,it=be?be.length:0;for(this.clear();++Me<it;){var mt=be[Me];this.set(mt[0],mt[1])}}function qe(be){var Me=-1,it=be?be.length:0;for(this.clear();++Me<it;){var mt=be[Me];this.set(mt[0],mt[1])}}function We(be){var Me=-1,it=be?be.length:0;for(this.clear();++Me<it;){var mt=be[Me];this.set(mt[0],mt[1])}}function at(be){var Me=-1,it=be?be.length:0;for(this.__data__=new We;++Me<it;)this.add(be[Me])}function Ye(be){this.__data__=new qe(be)}function rt(be,Me){var it=_e(be)||xe(be)?function(Nt,sr){for(var Gt=-1,Xt=Array(Nt);++Gt<Nt;)Xt[Gt]=sr(Gt);return Xt}(be.length,String):[],mt=it.length,Rt=!!mt;for(var kt in be)!z.call(be,kt)||Rt&&(kt=="length"||jt(kt,mt))||it.push(kt);return it}function ht(be,Me){for(var it=be.length;it--;)if(me(be[it][0],Me))return it;return-1}function Ce(be,Me,it,mt){return Ve(be,function(Rt,kt,Nt){Me(mt,Rt,it(Rt),Nt)}),mt}je.prototype.clear=function(){this.__data__=Z?Z(null):{}},je.prototype.delete=function(be){return this.has(be)&&delete this.__data__[be]},je.prototype.get=function(be){var Me=this.__data__;if(Z){var it=Me[be];return it==="__lodash_hash_undefined__"?void 0:it}return z.call(Me,be)?Me[be]:void 0},je.prototype.has=function(be){var Me=this.__data__;return Z?Me[be]!==void 0:z.call(Me,be)},je.prototype.set=function(be,Me){return this.__data__[be]=Z&&Me===void 0?"__lodash_hash_undefined__":Me,this},qe.prototype.clear=function(){this.__data__=[]},qe.prototype.delete=function(be){var Me=this.__data__,it=ht(Me,be);return!(it<0)&&(it==Me.length-1?Me.pop():G.call(Me,it,1),!0)},qe.prototype.get=function(be){var Me=this.__data__,it=ht(Me,be);return it<0?void 0:Me[it][1]},qe.prototype.has=function(be){return ht(this.__data__,be)>-1},qe.prototype.set=function(be,Me){var it=this.__data__,mt=ht(it,be);return mt<0?it.push([be,Me]):it[mt][1]=Me,this},We.prototype.clear=function(){this.__data__={hash:new je,map:new(ne||qe),string:new je}},We.prototype.delete=function(be){return ut(this,be).delete(be)},We.prototype.get=function(be){return ut(this,be).get(be)},We.prototype.has=function(be){return ut(this,be).has(be)},We.prototype.set=function(be,Me){return ut(this,be).set(be,Me),this},at.prototype.add=at.prototype.push=function(be){return this.__data__.set(be,"__lodash_hash_undefined__"),this},at.prototype.has=function(be){return this.__data__.has(be)},Ye.prototype.clear=function(){this.__data__=new qe},Ye.prototype.delete=function(be){return this.__data__.delete(be)},Ye.prototype.get=function(be){return this.__data__.get(be)},Ye.prototype.has=function(be){return this.__data__.has(be)},Ye.prototype.set=function(be,Me){var it=this.__data__;if(it instanceof qe){var mt=it.__data__;if(!ne||mt.length<199)return mt.push([be,Me]),this;it=this.__data__=new We(mt)}return it.set(be,Me),this};var Ie,Ve=(Ie=function(be,Me){return be&&De(be,Me,Ct)},function(be,Me){if(be==null)return be;if(!Ee(be))return Ie(be,Me);for(var it=be.length,mt=-1,Rt=Object(be);++mt<it&&Me(Rt[mt],mt,Rt)!==!1;);return be}),De=function(be){return function(Me,it,mt){for(var Rt=-1,kt=Object(Me),Nt=mt(Me),sr=Nt.length;sr--;){var Gt=Nt[++Rt];if(it(kt[Gt],Gt,kt)===!1)break}return Me}}();function Oe(be,Me){for(var it=0,mt=(Me=Ot(Me,be)?[Me]:dt(Me)).length;be!=null&&it<mt;)be=be[Fe(Me[it++])];return it&&it==mt?be:void 0}function Xe(be,Me){return be!=null&&Me in Object(be)}function nt(be,Me,it,mt,Rt){return be===Me||(be==null||Me==null||!Ue(be)&&!Qe(Me)?be!=be&&Me!=Me:function(kt,Nt,sr,Gt,Xt,Ht){var ar=_e(kt),Kt=_e(Nt),xr="[object Array]",Fr="[object Array]";ar||(xr=(xr=Et(kt))==i?l:xr),Kt||(Fr=(Fr=Et(Nt))==i?l:Fr);var Yr=xr==l&&!I(kt),cn=Fr==l&&!I(Nt),_s=xr==Fr;if(_s&&!Yr)return Ht||(Ht=new Ye),ar||bt(kt)?ct(kt,Nt,sr,Gt,Xt,Ht):function(br,pr,ea,Ba,Oi,Wn,Ss){switch(ea){case"[object DataView]":if(br.byteLength!=pr.byteLength||br.byteOffset!=pr.byteOffset)return!1;br=br.buffer,pr=pr.buffer;case"[object ArrayBuffer]":return!(br.byteLength!=pr.byteLength||!Ba(new P(br),new P(pr)));case"[object Boolean]":case"[object Date]":case"[object Number]":return me(+br,+pr);case"[object Error]":return br.name==pr.name&&br.message==pr.message;case"[object RegExp]":case"[object String]":return br==pr+"";case o:var ya=C;case c:var Mi=2&Wn;if(ya||(ya=O),br.size!=pr.size&&!Mi)return!1;var bo=Ss.get(br);if(bo)return bo==pr;Wn|=1,Ss.set(br,pr);var rs=ct(ya(br),ya(pr),Ba,Oi,Wn,Ss);return Ss.delete(br),rs;case"[object Symbol]":if(Te)return Te.call(br)==Te.call(pr)}return!1}(kt,Nt,xr,sr,Gt,Xt,Ht);if(!(2&Xt)){var Tn=Yr&&z.call(kt,"__wrapped__"),Qs=cn&&z.call(Nt,"__wrapped__");if(Tn||Qs){var un=Tn?kt.value():kt,ba=Qs?Nt.value():Nt;return Ht||(Ht=new Ye),sr(un,ba,Gt,Xt,Ht)}}return _s?(Ht||(Ht=new Ye),function(br,pr,ea,Ba,Oi,Wn){var Ss=2&Oi,ya=Ct(br),Mi=ya.length,bo=Ct(pr).length;if(Mi!=bo&&!Ss)return!1;for(var rs=Mi;rs--;){var ks=ya[rs];if(!(Ss?ks in pr:z.call(pr,ks)))return!1}var Fi=Wn.get(br);if(Fi&&Wn.get(pr))return Fi==pr;var ji=!0;Wn.set(br,pr),Wn.set(pr,br);for(var yn=Ss;++rs<Mi;){ks=ya[rs];var yo=br[ks],Li=pr[ks];if(Ba)var tr=Ss?Ba(Li,yo,ks,pr,br,Wn):Ba(yo,Li,ks,br,pr,Wn);if(!(tr===void 0?yo===Li||ea(yo,Li,Ba,Oi,Wn):tr)){ji=!1;break}yn||(yn=ks=="constructor")}if(ji&&!yn){var xo=br.constructor,wo=pr.constructor;xo==wo||!("constructor"in br)||!("constructor"in pr)||typeof xo=="function"&&xo instanceof xo&&typeof wo=="function"&&wo instanceof wo||(ji=!1)}return Wn.delete(br),Wn.delete(pr),ji}(kt,Nt,sr,Gt,Xt,Ht)):!1}(be,Me,nt,it,mt,Rt))}function Je(be){return!(!Ue(be)||function(Me){return!!A&&A in Me}(be))&&(Le(be)||I(be)?j:m).test(Be(be))}function wt(be){return typeof be=="function"?be:be==null?Pt:typeof be=="object"?_e(be)?function(mt,Rt){return Ot(mt)&&yt(Rt)?Vt(Fe(mt),Rt):function(kt){var Nt=function(sr,Gt,Xt){var Ht=sr==null?void 0:Oe(sr,Gt);return Ht===void 0?Xt:Ht}(kt,mt);return Nt===void 0&&Nt===Rt?function(sr,Gt){return sr!=null&&function(Xt,Ht,ar){Ht=Ot(Ht,Xt)?[Ht]:dt(Ht);for(var Kt,xr=-1,Fr=Ht.length;++xr<Fr;){var Yr=Fe(Ht[xr]);if(!(Kt=Xt!=null&&ar(Xt,Yr)))break;Xt=Xt[Yr]}return Kt||!!(Fr=Xt?Xt.length:0)&&Ke(Fr)&&jt(Yr,Fr)&&(_e(Xt)||xe(Xt))}(sr,Gt,Xe)}(kt,mt):nt(Rt,Nt,void 0,3)}}(be[0],be[1]):function(mt){var Rt=function(kt){for(var Nt=Ct(kt),sr=Nt.length;sr--;){var Gt=Nt[sr],Xt=kt[Gt];Nt[sr]=[Gt,Xt,yt(Xt)]}return Nt}(mt);return Rt.length==1&&Rt[0][2]?Vt(Rt[0][0],Rt[0][1]):function(kt){return kt===mt||function(Nt,sr,Gt,Xt){var Ht=Gt.length,ar=Ht;if(Nt==null)return!ar;for(Nt=Object(Nt);Ht--;){var Kt=Gt[Ht];if(Kt[2]?Kt[1]!==Nt[Kt[0]]:!(Kt[0]in Nt))return!1}for(;++Ht<ar;){var xr=(Kt=Gt[Ht])[0],Fr=Nt[xr],Yr=Kt[1];if(Kt[2]){if(Fr===void 0&&!(xr in Nt))return!1}else{var cn=new Ye,_s;if(!(_s===void 0?nt(Yr,Fr,Xt,3,cn):_s))return!1}}return!0}(kt,mt,Rt)}}(be):Ot(Me=be)?(it=Fe(Me),function(mt){return mt==null?void 0:mt[it]}):function(mt){return function(Rt){return Oe(Rt,mt)}}(Me);var Me,it}function gt(be){if(it=(Me=be)&&Me.constructor,mt=typeof it=="function"&&it.prototype||T,Me!==mt)return re(be);var Me,it,mt,Rt=[];for(var kt in Object(be))z.call(be,kt)&&kt!="constructor"&&Rt.push(kt);return Rt}function dt(be){return _e(be)?be:$t(be)}function ct(be,Me,it,mt,Rt,kt){var Nt=2&Rt,sr=be.length,Gt=Me.length;if(sr!=Gt&&!(Nt&&Gt>sr))return!1;var Xt=kt.get(be);if(Xt&&kt.get(Me))return Xt==Me;var Ht=-1,ar=!0,Kt=1&Rt?new at:void 0;for(kt.set(be,Me),kt.set(Me,be);++Ht<sr;){var xr=be[Ht],Fr=Me[Ht];if(mt)var Yr=Nt?mt(Fr,xr,Ht,Me,be,kt):mt(xr,Fr,Ht,be,Me,kt);if(Yr!==void 0){if(Yr)continue;ar=!1;break}if(Kt){if(!V(Me,function(cn,_s){if(!Kt.has(_s)&&(xr===cn||it(xr,cn,mt,Rt,kt)))return Kt.add(_s)})){ar=!1;break}}else if(xr!==Fr&&!it(xr,Fr,mt,Rt,kt)){ar=!1;break}}return kt.delete(be),kt.delete(Me),ar}function ut(be,Me){var it,mt,Rt=be.__data__;return((mt=typeof(it=Me))=="string"||mt=="number"||mt=="symbol"||mt=="boolean"?it!=="__proto__":it===null)?Rt[typeof Me=="string"?"string":"hash"]:Rt.map}function ft(be,Me){var it=function(mt,Rt){return mt==null?void 0:mt[Rt]}(be,Me);return Je(it)?it:void 0}var Et=function(be){return K.call(be)};function jt(be,Me){return!!(Me=Me??9007199254740991)&&(typeof be=="number"||p.test(be))&&be>-1&&be%1==0&&be<Me}function Ot(be,Me){if(_e(be))return!1;var it=typeof be;return!(it!="number"&&it!="symbol"&&it!="boolean"&&be!=null&&!et(be))||d.test(be)||!u.test(be)||Me!=null&&be in Object(Me)}function yt(be){return be==be&&!Ue(be)}function Vt(be,Me){return function(it){return it!=null&&it[be]===Me&&(Me!==void 0||be in Object(it))}}(te&&Et(new te(new ArrayBuffer(1)))!="[object DataView]"||ne&&Et(new ne)!=o||le&&Et(le.resolve())!="[object Promise]"||oe&&Et(new oe)!=c||ee&&Et(new ee)!="[object WeakMap]")&&(Et=function(be){var Me=K.call(be),it=Me==l?be.constructor:void 0,mt=it?Be(it):void 0;if(mt)switch(mt){case se:return"[object DataView]";case ie:return o;case ue:return"[object Promise]";case pe:return c;case fe:return"[object WeakMap]"}return Me});var $t=ke(function(be){var Me;be=(Me=be)==null?"":function(mt){if(typeof mt=="string")return mt;if(et(mt))return Pe?Pe.call(mt):"";var Rt=mt+"";return Rt=="0"&&1/mt==-1/0?"-0":Rt}(Me);var it=[];return h.test(be)&&it.push(""),be.replace(f,function(mt,Rt,kt,Nt){it.push(kt?Nt.replace(g,"$1"):Rt||mt)}),it});function Fe(be){if(typeof be=="string"||et(be))return be;var Me=be+"";return Me=="0"&&1/be==-1/0?"-0":Me}function Be(be){if(be!=null){try{return H.call(be)}catch{}try{return be+""}catch{}}return""}var tt,ce=(tt=function(be,Me,it){z.call(be,it)?be[it].push(Me):be[it]=[Me]},function(be,Me){var it=_e(be)?q:Ce,mt={};return it(be,tt,wt(Me),mt)});function ke(be,Me){if(typeof be!="function"||Me&&typeof Me!="function")throw new TypeError("Expected a function");var it=function(){var mt=arguments,Rt=Me?Me.apply(this,mt):mt[0],kt=it.cache;if(kt.has(Rt))return kt.get(Rt);var Nt=be.apply(this,mt);return it.cache=kt.set(Rt,Nt),Nt};return it.cache=new(ke.Cache||We),it}function me(be,Me){return be===Me||be!=be&&Me!=Me}function xe(be){return function(Me){return Qe(Me)&&Ee(Me)}(be)&&z.call(be,"callee")&&(!D.call(be,"callee")||K.call(be)==i)}ke.Cache=We;var _e=Array.isArray;function Ee(be){return be!=null&&Ke(be.length)&&!Le(be)}function Le(be){var Me=Ue(be)?K.call(be):"";return Me=="[object Function]"||Me=="[object GeneratorFunction]"}function Ke(be){return typeof be=="number"&&be>-1&&be%1==0&&be<=9007199254740991}function Ue(be){var Me=typeof be;return!!be&&(Me=="object"||Me=="function")}function Qe(be){return!!be&&typeof be=="object"}function et(be){return typeof be=="symbol"||Qe(be)&&K.call(be)=="[object Symbol]"}var bt=B?function(be){return function(Me){return be(Me)}}(B):function(be){return Qe(be)&&Ke(be.length)&&!!v[K.call(be)]};function Ct(be){return Ee(be)?rt(be):gt(be)}function Pt(be){return be}n.exports=ce}).call(this)}).call(this,typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(e,n,s){var a=Object.prototype.toString;n.exports=function(i){return i===!0||i===!1||function(o){return!!o&&typeof o=="object"}(i)&&a.call(i)=="[object Boolean]"}},{}],445:[function(e,n,s){(function(a){(function(){var i="[object Arguments]",o="[object Map]",l="[object Object]",c="[object Set]",u=/^\[object .+?Constructor\]$/,d=/^(?:0|[1-9]\d*)$/,h={};h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h[i]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object Boolean]"]=h["[object DataView]"]=h["[object Date]"]=h["[object Error]"]=h["[object Function]"]=h[o]=h["[object Number]"]=h[l]=h["[object RegExp]"]=h[c]=h["[object String]"]=h["[object WeakMap]"]=!1;var f=typeof a=="object"&&a&&a.Object===Object&&a,g=typeof self=="object"&&self&&self.Object===Object&&self,m=f||g||Function("return this")(),p=typeof s=="object"&&s&&!s.nodeType&&s,v=p&&typeof n=="object"&&n&&!n.nodeType&&n,b=v&&v.exports===p,y=b&&f.process,k=function(){try{return y&&y.binding&&y.binding("util")}catch{}}(),N=k&&k.isTypedArray;function L(Fe,Be){for(var tt=-1,ce=Fe==null?0:Fe.length;++tt<ce;)if(Be(Fe[tt],tt,Fe))return!0;return!1}function F(Fe){var Be=-1,tt=Array(Fe.size);return Fe.forEach(function(ce,ke){tt[++Be]=[ke,ce]}),tt}function R(Fe){var Be=-1,tt=Array(Fe.size);return Fe.forEach(function(ce){tt[++Be]=ce}),tt}var B,q,V,I=Array.prototype,C=Function.prototype,O=Object.prototype,E=m["__core-js_shared__"],x=C.toString,w=O.hasOwnProperty,_=(B=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"",S=O.toString,T=RegExp("^"+x.call(w).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),U=b?m.Buffer:void 0,A=m.Symbol,H=m.Uint8Array,z=O.propertyIsEnumerable,K=I.splice,j=A?A.toStringTag:void 0,J=Object.getOwnPropertySymbols,P=U?U.isBuffer:void 0,D=(q=Object.keys,V=Object,function(Fe){return q(V(Fe))}),G=Xe(m,"DataView"),re=Xe(m,"Map"),te=Xe(m,"Promise"),ne=Xe(m,"Set"),le=Xe(m,"WeakMap"),oe=Xe(Object,"create"),ee=gt(G),Z=gt(re),se=gt(te),ie=gt(ne),ue=gt(le),pe=A?A.prototype:void 0,fe=pe?pe.valueOf:void 0;function ye(Fe){var Be=-1,tt=Fe==null?0:Fe.length;for(this.clear();++Be<tt;){var ce=Fe[Be];this.set(ce[0],ce[1])}}function Te(Fe){var Be=-1,tt=Fe==null?0:Fe.length;for(this.clear();++Be<tt;){var ce=Fe[Be];this.set(ce[0],ce[1])}}function Pe(Fe){var Be=-1,tt=Fe==null?0:Fe.length;for(this.clear();++Be<tt;){var ce=Fe[Be];this.set(ce[0],ce[1])}}function je(Fe){var Be=-1,tt=Fe==null?0:Fe.length;for(this.__data__=new Pe;++Be<tt;)this.add(Fe[Be])}function qe(Fe){var Be=this.__data__=new Te(Fe);this.size=Be.size}function We(Fe,Be){var tt=ut(Fe),ce=!tt&&ct(Fe),ke=!tt&&!ce&&ft(Fe),me=!tt&&!ce&&!ke&&Vt(Fe),xe=tt||ce||ke||me,_e=xe?function(Ke,Ue){for(var Qe=-1,et=Array(Ke);++Qe<Ke;)et[Qe]=Ue(Qe);return et}(Fe.length,String):[],Ee=_e.length;for(var Le in Fe)!w.call(Fe,Le)||xe&&(Le=="length"||ke&&(Le=="offset"||Le=="parent")||me&&(Le=="buffer"||Le=="byteLength"||Le=="byteOffset")||wt(Le,Ee))||_e.push(Le);return _e}function at(Fe,Be){for(var tt=Fe.length;tt--;)if(dt(Fe[tt][0],Be))return tt;return-1}function Ye(Fe){return Fe==null?Fe===void 0?"[object Undefined]":"[object Null]":j&&j in Object(Fe)?function(Be){var tt=w.call(Be,j),ce=Be[j];try{Be[j]=void 0;var ke=!0}catch{}var me=S.call(Be);return ke&&(tt?Be[j]=ce:delete Be[j]),me}(Fe):function(Be){return S.call(Be)}(Fe)}function rt(Fe){return yt(Fe)&&Ye(Fe)==i}function ht(Fe,Be,tt,ce,ke){return Fe===Be||(Fe==null||Be==null||!yt(Fe)&&!yt(Be)?Fe!=Fe&&Be!=Be:function(me,xe,_e,Ee,Le,Ke){var Ue=ut(me),Qe=ut(xe),et=Ue?"[object Array]":Je(me),bt=Qe?"[object Array]":Je(xe),Ct=(et=et==i?l:et)==l,Pt=(bt=bt==i?l:bt)==l,be=et==bt;if(be&&ft(me)){if(!ft(xe))return!1;Ue=!0,Ct=!1}if(be&&!Ct)return Ke||(Ke=new qe),Ue||Vt(me)?Ve(me,xe,_e,Ee,Le,Ke):function(kt,Nt,sr,Gt,Xt,Ht,ar){switch(sr){case"[object DataView]":if(kt.byteLength!=Nt.byteLength||kt.byteOffset!=Nt.byteOffset)return!1;kt=kt.buffer,Nt=Nt.buffer;case"[object ArrayBuffer]":return!(kt.byteLength!=Nt.byteLength||!Ht(new H(kt),new H(Nt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return dt(+kt,+Nt);case"[object Error]":return kt.name==Nt.name&&kt.message==Nt.message;case"[object RegExp]":case"[object String]":return kt==Nt+"";case o:var Kt=F;case c:var xr=1&Gt;if(Kt||(Kt=R),kt.size!=Nt.size&&!xr)return!1;var Fr=ar.get(kt);if(Fr)return Fr==Nt;Gt|=2,ar.set(kt,Nt);var Yr=Ve(Kt(kt),Kt(Nt),Gt,Xt,Ht,ar);return ar.delete(kt),Yr;case"[object Symbol]":if(fe)return fe.call(kt)==fe.call(Nt)}return!1}(me,xe,et,_e,Ee,Le,Ke);if(!(1&_e)){var Me=Ct&&w.call(me,"__wrapped__"),it=Pt&&w.call(xe,"__wrapped__");if(Me||it){var mt=Me?me.value():me,Rt=it?xe.value():xe;return Ke||(Ke=new qe),Le(mt,Rt,_e,Ee,Ke)}}return be?(Ke||(Ke=new qe),function(kt,Nt,sr,Gt,Xt,Ht){var ar=1&sr,Kt=De(kt),xr=Kt.length,Fr=De(Nt).length;if(xr!=Fr&&!ar)return!1;for(var Yr=xr;Yr--;){var cn=Kt[Yr];if(!(ar?cn in Nt:w.call(Nt,cn)))return!1}var _s=Ht.get(kt);if(_s&&Ht.get(Nt))return _s==Nt;var Tn=!0;Ht.set(kt,Nt),Ht.set(Nt,kt);for(var Qs=ar;++Yr<xr;){cn=Kt[Yr];var un=kt[cn],ba=Nt[cn];if(Gt)var br=ar?Gt(ba,un,cn,Nt,kt,Ht):Gt(un,ba,cn,kt,Nt,Ht);if(!(br===void 0?un===ba||Xt(un,ba,sr,Gt,Ht):br)){Tn=!1;break}Qs||(Qs=cn=="constructor")}if(Tn&&!Qs){var pr=kt.constructor,ea=Nt.constructor;pr==ea||!("constructor"in kt)||!("constructor"in Nt)||typeof pr=="function"&&pr instanceof pr&&typeof ea=="function"&&ea instanceof ea||(Tn=!1)}return Ht.delete(kt),Ht.delete(Nt),Tn}(me,xe,_e,Ee,Le,Ke)):!1}(Fe,Be,tt,ce,ht,ke))}function Ce(Fe){return!(!Ot(Fe)||function(Be){return!!_&&_ in Be}(Fe))&&(Et(Fe)?T:u).test(gt(Fe))}function Ie(Fe){if(tt=(Be=Fe)&&Be.constructor,ce=typeof tt=="function"&&tt.prototype||O,Be!==ce)return D(Fe);var Be,tt,ce,ke=[];for(var me in Object(Fe))w.call(Fe,me)&&me!="constructor"&&ke.push(me);return ke}function Ve(Fe,Be,tt,ce,ke,me){var xe=1&tt,_e=Fe.length,Ee=Be.length;if(_e!=Ee&&!(xe&&Ee>_e))return!1;var Le=me.get(Fe);if(Le&&me.get(Be))return Le==Be;var Ke=-1,Ue=!0,Qe=2&tt?new je:void 0;for(me.set(Fe,Be),me.set(Be,Fe);++Ke<_e;){var et=Fe[Ke],bt=Be[Ke];if(ce)var Ct=xe?ce(bt,et,Ke,Be,Fe,me):ce(et,bt,Ke,Fe,Be,me);if(Ct!==void 0){if(Ct)continue;Ue=!1;break}if(Qe){if(!L(Be,function(Pt,be){if(Me=be,!Qe.has(Me)&&(et===Pt||ke(et,Pt,tt,ce,me)))return Qe.push(be);var Me})){Ue=!1;break}}else if(et!==bt&&!ke(et,bt,tt,ce,me)){Ue=!1;break}}return me.delete(Fe),me.delete(Be),Ue}function De(Fe){return function(Be,tt,ce){var ke=tt(Be);return ut(Be)?ke:function(me,xe){for(var _e=-1,Ee=xe.length,Le=me.length;++_e<Ee;)me[Le+_e]=xe[_e];return me}(ke,ce(Be))}(Fe,$t,nt)}function Oe(Fe,Be){var tt,ce,ke=Fe.__data__;return((ce=typeof(tt=Be))=="string"||ce=="number"||ce=="symbol"||ce=="boolean"?tt!=="__proto__":tt===null)?ke[typeof Be=="string"?"string":"hash"]:ke.map}function Xe(Fe,Be){var tt=function(ce,ke){return ce==null?void 0:ce[ke]}(Fe,Be);return Ce(tt)?tt:void 0}ye.prototype.clear=function(){this.__data__=oe?oe(null):{},this.size=0},ye.prototype.delete=function(Fe){var Be=this.has(Fe)&&delete this.__data__[Fe];return this.size-=Be?1:0,Be},ye.prototype.get=function(Fe){var Be=this.__data__;if(oe){var tt=Be[Fe];return tt==="__lodash_hash_undefined__"?void 0:tt}return w.call(Be,Fe)?Be[Fe]:void 0},ye.prototype.has=function(Fe){var Be=this.__data__;return oe?Be[Fe]!==void 0:w.call(Be,Fe)},ye.prototype.set=function(Fe,Be){var tt=this.__data__;return this.size+=this.has(Fe)?0:1,tt[Fe]=oe&&Be===void 0?"__lodash_hash_undefined__":Be,this},Te.prototype.clear=function(){this.__data__=[],this.size=0},Te.prototype.delete=function(Fe){var Be=this.__data__,tt=at(Be,Fe);return!(tt<0)&&(tt==Be.length-1?Be.pop():K.call(Be,tt,1),--this.size,!0)},Te.prototype.get=function(Fe){var Be=this.__data__,tt=at(Be,Fe);return tt<0?void 0:Be[tt][1]},Te.prototype.has=function(Fe){return at(this.__data__,Fe)>-1},Te.prototype.set=function(Fe,Be){var tt=this.__data__,ce=at(tt,Fe);return ce<0?(++this.size,tt.push([Fe,Be])):tt[ce][1]=Be,this},Pe.prototype.clear=function(){this.size=0,this.__data__={hash:new ye,map:new(re||Te),string:new ye}},Pe.prototype.delete=function(Fe){var Be=Oe(this,Fe).delete(Fe);return this.size-=Be?1:0,Be},Pe.prototype.get=function(Fe){return Oe(this,Fe).get(Fe)},Pe.prototype.has=function(Fe){return Oe(this,Fe).has(Fe)},Pe.prototype.set=function(Fe,Be){var tt=Oe(this,Fe),ce=tt.size;return tt.set(Fe,Be),this.size+=tt.size==ce?0:1,this},je.prototype.add=je.prototype.push=function(Fe){return this.__data__.set(Fe,"__lodash_hash_undefined__"),this},je.prototype.has=function(Fe){return this.__data__.has(Fe)},qe.prototype.clear=function(){this.__data__=new Te,this.size=0},qe.prototype.delete=function(Fe){var Be=this.__data__,tt=Be.delete(Fe);return this.size=Be.size,tt},qe.prototype.get=function(Fe){return this.__data__.get(Fe)},qe.prototype.has=function(Fe){return this.__data__.has(Fe)},qe.prototype.set=function(Fe,Be){var tt=this.__data__;if(tt instanceof Te){var ce=tt.__data__;if(!re||ce.length<199)return ce.push([Fe,Be]),this.size=++tt.size,this;tt=this.__data__=new Pe(ce)}return tt.set(Fe,Be),this.size=tt.size,this};var nt=J?function(Fe){return Fe==null?[]:(Fe=Object(Fe),function(Be,tt){for(var ce=-1,ke=Be==null?0:Be.length,me=0,xe=[];++ce<ke;){var _e=Be[ce];tt(_e,ce,Be)&&(xe[me++]=_e)}return xe}(J(Fe),function(Be){return z.call(Fe,Be)}))}:function(){return[]},Je=Ye;function wt(Fe,Be){return!!(Be=Be??9007199254740991)&&(typeof Fe=="number"||d.test(Fe))&&Fe>-1&&Fe%1==0&&Fe<Be}function gt(Fe){if(Fe!=null){try{return x.call(Fe)}catch{}try{return Fe+""}catch{}}return""}function dt(Fe,Be){return Fe===Be||Fe!=Fe&&Be!=Be}(G&&Je(new G(new ArrayBuffer(1)))!="[object DataView]"||re&&Je(new re)!=o||te&&Je(te.resolve())!="[object Promise]"||ne&&Je(new ne)!=c||le&&Je(new le)!="[object WeakMap]")&&(Je=function(Fe){var Be=Ye(Fe),tt=Be==l?Fe.constructor:void 0,ce=tt?gt(tt):"";if(ce)switch(ce){case ee:return"[object DataView]";case Z:return o;case se:return"[object Promise]";case ie:return c;case ue:return"[object WeakMap]"}return Be});var ct=rt(function(){return arguments}())?rt:function(Fe){return yt(Fe)&&w.call(Fe,"callee")&&!z.call(Fe,"callee")},ut=Array.isArray,ft=P||function(){return!1};function Et(Fe){if(!Ot(Fe))return!1;var Be=Ye(Fe);return Be=="[object Function]"||Be=="[object GeneratorFunction]"||Be=="[object AsyncFunction]"||Be=="[object Proxy]"}function jt(Fe){return typeof Fe=="number"&&Fe>-1&&Fe%1==0&&Fe<=9007199254740991}function Ot(Fe){var Be=typeof Fe;return Fe!=null&&(Be=="object"||Be=="function")}function yt(Fe){return Fe!=null&&typeof Fe=="object"}var Vt=N?function(Fe){return function(Be){return Fe(Be)}}(N):function(Fe){return yt(Fe)&&jt(Fe.length)&&!!h[Ye(Fe)]};function $t(Fe){return(Be=Fe)!=null&&jt(Be.length)&&!Et(Be)?We(Fe):Ie(Fe);var Be}n.exports=function(Fe,Be){return ht(Fe,Be)}}).call(this)}).call(this,typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(e,n,s){(function(a){(function(){var i=typeof a=="object"&&a&&a.Object===Object&&a,o=typeof self=="object"&&self&&self.Object===Object&&self,l=i||o||Function("return this")(),c=Object.prototype,u=c.hasOwnProperty,d=c.toString,h=l.Symbol,f=h?h.toStringTag:void 0;function g(m){return m==null?m===void 0?"[object Undefined]":"[object Null]":f&&f in Object(m)?function(p){var v=u.call(p,f),b=p[f];try{p[f]=void 0;var y=!0}catch{}var k=d.call(p);return y&&(v?p[f]=b:delete p[f]),k}(m):function(p){return d.call(p)}(m)}n.exports=function(m){if(!function(v){var b=typeof v;return v!=null&&(b=="object"||b=="function")}(m))return!1;var p=g(m);return p=="[object Function]"||p=="[object GeneratorFunction]"||p=="[object AsyncFunction]"||p=="[object Proxy]"}}).call(this)}).call(this,typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(e,n,s){n.exports=function(a){return a==null}},{}],448:[function(e,n,s){n.exports=function(a){return a===void 0}},{}],449:[function(e,n,s){(function(a){(function(){var i=/^\[object .+?Constructor\]$/,o=typeof a=="object"&&a&&a.Object===Object&&a,l=typeof self=="object"&&self&&self.Object===Object&&self,c=o||l||Function("return this")();function u(A,H){return!!(A&&A.length)&&function(z,K,j){if(K!=K)return function(D,G,re,te){for(var ne=D.length,le=re+-1;++le<ne;)if(G(D[le],le,D))return le;return-1}(z,d,j);for(var J=j-1,P=z.length;++J<P;)if(z[J]===K)return J;return-1}(A,H,0)>-1}function d(A){return A!=A}function h(A,H){return A.has(H)}function f(A){var H=-1,z=Array(A.size);return A.forEach(function(K){z[++H]=K}),z}var g,m=Array.prototype,p=Function.prototype,v=Object.prototype,b=c["__core-js_shared__"],y=(g=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"",k=p.toString,N=v.hasOwnProperty,L=v.toString,F=RegExp("^"+k.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),R=m.splice,B=T(c,"Map"),q=T(c,"Set"),V=T(Object,"create");function I(A){var H=-1,z=A?A.length:0;for(this.clear();++H<z;){var K=A[H];this.set(K[0],K[1])}}function C(A){var H=-1,z=A?A.length:0;for(this.clear();++H<z;){var K=A[H];this.set(K[0],K[1])}}function O(A){var H=-1,z=A?A.length:0;for(this.clear();++H<z;){var K=A[H];this.set(K[0],K[1])}}function E(A){var H=-1,z=A?A.length:0;for(this.__data__=new O;++H<z;)this.add(A[H])}function x(A,H){for(var z,K,j=A.length;j--;)if((z=A[j][0])===(K=H)||z!=z&&K!=K)return j;return-1}function w(A){return!(!U(A)||(H=A,y&&y in H))&&(function(z){var K=U(z)?L.call(z):"";return K=="[object Function]"||K=="[object GeneratorFunction]"}(A)||function(z){var K=!1;if(z!=null&&typeof z.toString!="function")try{K=!!(z+"")}catch{}return K}(A)?F:i).test(function(z){if(z!=null){try{return k.call(z)}catch{}try{return z+""}catch{}}return""}(A));var H}I.prototype.clear=function(){this.__data__=V?V(null):{}},I.prototype.delete=function(A){return this.has(A)&&delete this.__data__[A]},I.prototype.get=function(A){var H=this.__data__;if(V){var z=H[A];return z==="__lodash_hash_undefined__"?void 0:z}return N.call(H,A)?H[A]:void 0},I.prototype.has=function(A){var H=this.__data__;return V?H[A]!==void 0:N.call(H,A)},I.prototype.set=function(A,H){return this.__data__[A]=V&&H===void 0?"__lodash_hash_undefined__":H,this},C.prototype.clear=function(){this.__data__=[]},C.prototype.delete=function(A){var H=this.__data__,z=x(H,A);return!(z<0)&&(z==H.length-1?H.pop():R.call(H,z,1),!0)},C.prototype.get=function(A){var H=this.__data__,z=x(H,A);return z<0?void 0:H[z][1]},C.prototype.has=function(A){return x(this.__data__,A)>-1},C.prototype.set=function(A,H){var z=this.__data__,K=x(z,A);return K<0?z.push([A,H]):z[K][1]=H,this},O.prototype.clear=function(){this.__data__={hash:new I,map:new(B||C),string:new I}},O.prototype.delete=function(A){return S(this,A).delete(A)},O.prototype.get=function(A){return S(this,A).get(A)},O.prototype.has=function(A){return S(this,A).has(A)},O.prototype.set=function(A,H){return S(this,A).set(A,H),this},E.prototype.add=E.prototype.push=function(A){return this.__data__.set(A,"__lodash_hash_undefined__"),this},E.prototype.has=function(A){return this.__data__.has(A)};var _=q&&1/f(new q([,-0]))[1]==1/0?function(A){return new q(A)}:function(){};function S(A,H){var z,K,j=A.__data__;return((K=typeof(z=H))=="string"||K=="number"||K=="symbol"||K=="boolean"?z!=="__proto__":z===null)?j[typeof H=="string"?"string":"hash"]:j.map}function T(A,H){var z=function(K,j){return K==null?void 0:K[j]}(A,H);return w(z)?z:void 0}function U(A){var H=typeof A;return!!A&&(H=="object"||H=="function")}n.exports=function(A){return A&&A.length?function(H,z,K){var j=-1,J=u,P=H.length,D=!0,G=[],re=G;if(P>=200){var te=_(H);if(te)return f(te);D=!1,J=h,re=new E}else re=G;e:for(;++j<P;){var ne=H[j],le=ne;if(ne=ne!==0?ne:0,D&&le==le){for(var oe=re.length;oe--;)if(re[oe]===le)continue e;G.push(ne)}else J(re,le,K)||(re!==G&&re.push(le),G.push(ne))}return G}(A):[]}}).call(this)}).call(this,typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(e,n,s){var a=e("inherits"),i=e("hash-base"),o=e("safe-buffer").Buffer,l=new Array(16);function c(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function u(m,p){return m<<p|m>>>32-p}function d(m,p,v,b,y,k,N){return u(m+(p&v|~p&b)+y+k|0,N)+p|0}function h(m,p,v,b,y,k,N){return u(m+(p&b|v&~b)+y+k|0,N)+p|0}function f(m,p,v,b,y,k,N){return u(m+(p^v^b)+y+k|0,N)+p|0}function g(m,p,v,b,y,k,N){return u(m+(v^(p|~b))+y+k|0,N)+p|0}a(c,i),c.prototype._update=function(){for(var m=l,p=0;p<16;++p)m[p]=this._block.readInt32LE(4*p);var v=this._a,b=this._b,y=this._c,k=this._d;v=d(v,b,y,k,m[0],3614090360,7),k=d(k,v,b,y,m[1],3905402710,12),y=d(y,k,v,b,m[2],606105819,17),b=d(b,y,k,v,m[3],3250441966,22),v=d(v,b,y,k,m[4],4118548399,7),k=d(k,v,b,y,m[5],1200080426,12),y=d(y,k,v,b,m[6],2821735955,17),b=d(b,y,k,v,m[7],4249261313,22),v=d(v,b,y,k,m[8],1770035416,7),k=d(k,v,b,y,m[9],2336552879,12),y=d(y,k,v,b,m[10],4294925233,17),b=d(b,y,k,v,m[11],2304563134,22),v=d(v,b,y,k,m[12],1804603682,7),k=d(k,v,b,y,m[13],4254626195,12),y=d(y,k,v,b,m[14],2792965006,17),v=h(v,b=d(b,y,k,v,m[15],1236535329,22),y,k,m[1],4129170786,5),k=h(k,v,b,y,m[6],3225465664,9),y=h(y,k,v,b,m[11],643717713,14),b=h(b,y,k,v,m[0],3921069994,20),v=h(v,b,y,k,m[5],3593408605,5),k=h(k,v,b,y,m[10],38016083,9),y=h(y,k,v,b,m[15],3634488961,14),b=h(b,y,k,v,m[4],3889429448,20),v=h(v,b,y,k,m[9],568446438,5),k=h(k,v,b,y,m[14],3275163606,9),y=h(y,k,v,b,m[3],4107603335,14),b=h(b,y,k,v,m[8],1163531501,20),v=h(v,b,y,k,m[13],2850285829,5),k=h(k,v,b,y,m[2],4243563512,9),y=h(y,k,v,b,m[7],1735328473,14),v=f(v,b=h(b,y,k,v,m[12],2368359562,20),y,k,m[5],4294588738,4),k=f(k,v,b,y,m[8],2272392833,11),y=f(y,k,v,b,m[11],1839030562,16),b=f(b,y,k,v,m[14],4259657740,23),v=f(v,b,y,k,m[1],2763975236,4),k=f(k,v,b,y,m[4],1272893353,11),y=f(y,k,v,b,m[7],4139469664,16),b=f(b,y,k,v,m[10],3200236656,23),v=f(v,b,y,k,m[13],681279174,4),k=f(k,v,b,y,m[0],3936430074,11),y=f(y,k,v,b,m[3],3572445317,16),b=f(b,y,k,v,m[6],76029189,23),v=f(v,b,y,k,m[9],3654602809,4),k=f(k,v,b,y,m[12],3873151461,11),y=f(y,k,v,b,m[15],530742520,16),v=g(v,b=f(b,y,k,v,m[2],3299628645,23),y,k,m[0],4096336452,6),k=g(k,v,b,y,m[7],1126891415,10),y=g(y,k,v,b,m[14],2878612391,15),b=g(b,y,k,v,m[5],4237533241,21),v=g(v,b,y,k,m[12],1700485571,6),k=g(k,v,b,y,m[3],2399980690,10),y=g(y,k,v,b,m[10],4293915773,15),b=g(b,y,k,v,m[1],2240044497,21),v=g(v,b,y,k,m[8],1873313359,6),k=g(k,v,b,y,m[15],4264355552,10),y=g(y,k,v,b,m[6],2734768916,15),b=g(b,y,k,v,m[13],1309151649,21),v=g(v,b,y,k,m[4],4149444226,6),k=g(k,v,b,y,m[11],3174756917,10),y=g(y,k,v,b,m[2],718787259,15),b=g(b,y,k,v,m[9],3951481745,21),this._a=this._a+v|0,this._b=this._b+b|0,this._c=this._c+y|0,this._d=this._d+k|0},c.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var m=o.allocUnsafe(16);return m.writeInt32LE(this._a,0),m.writeInt32LE(this._b,4),m.writeInt32LE(this._c,8),m.writeInt32LE(this._d,12),m},n.exports=c},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(e,n,s){var a=e("bn.js"),i=e("brorand");function o(l){this.rand=l||new i.Rand}n.exports=o,o.create=function(l){return new o(l)},o.prototype._randbelow=function(l){var c=l.bitLength(),u=Math.ceil(c/8);do var d=new a(this.rand.generate(u));while(d.cmp(l)>=0);return d},o.prototype._randrange=function(l,c){var u=c.sub(l);return l.add(this._randbelow(u))},o.prototype.test=function(l,c,u){var d=l.bitLength(),h=a.mont(l),f=new a(1).toRed(h);c||(c=Math.max(1,d/48|0));for(var g=l.subn(1),m=0;!g.testn(m);m++);for(var p=l.shrn(m),v=g.toRed(h);c>0;c--){var b=this._randrange(new a(2),g);u&&u(b);var y=b.toRed(h).redPow(p);if(y.cmp(f)!==0&&y.cmp(v)!==0){for(var k=1;k<m;k++){if((y=y.redSqr()).cmp(f)===0)return!1;if(y.cmp(v)===0)break}if(k===m)return!1}}return!0},o.prototype.getDivisor=function(l,c){var u=l.bitLength(),d=a.mont(l),h=new a(1).toRed(d);c||(c=Math.max(1,u/48|0));for(var f=l.subn(1),g=0;!f.testn(g);g++);for(var m=l.shrn(g),p=f.toRed(d);c>0;c--){var v=this._randrange(new a(2),f),b=l.gcd(v);if(b.cmpn(1)!==0)return b;var y=v.toRed(d).redPow(m);if(y.cmp(h)!==0&&y.cmp(p)!==0){for(var k=1;k<g;k++){if((y=y.redSqr()).cmp(h)===0)return y.fromRed().subn(1).gcd(l);if(y.cmp(p)===0)break}if(k===g)return(y=y.redSqr()).fromRed().subn(1).gcd(l)}}return!1}},{"bn.js":452,brorand:187}],452:[function(e,n,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],453:[function(e,n,s){function a(i,o){if(!i)throw new Error(o||"Assertion failed")}n.exports=a,a.equal=function(i,o,l){if(i!=o)throw new Error(l||"Assertion failed: "+i+" != "+o)}},{}],454:[function(e,n,s){var a=s;function i(l){return l.length===1?"0"+l:l}function o(l){for(var c="",u=0;u<l.length;u++)c+=i(l[u].toString(16));return c}a.toArray=function(l,c){if(Array.isArray(l))return l.slice();if(!l)return[];var u=[];if(typeof l!="string"){for(var d=0;d<l.length;d++)u[d]=0|l[d];return u}if(c==="hex")for((l=l.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(l="0"+l),d=0;d<l.length;d+=2)u.push(parseInt(l[d]+l[d+1],16));else for(d=0;d<l.length;d++){var h=l.charCodeAt(d),f=h>>8,g=255&h;f?u.push(f,g):u.push(g)}return u},a.zero2=i,a.toHex=o,a.encode=function(l,c){return c==="hex"?o(l):l}},{}],455:[function(e,n,s){n.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(e,n,s){var a=e("asn1.js");s.certificate=e("./certificate");var i=a.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});s.RSAPrivateKey=i;var o=a.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});s.RSAPublicKey=o;var l=a.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(c),this.key("subjectPublicKey").bitstr())});s.PublicKey=l;var c=a.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),u=a.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(c),this.key("subjectPrivateKey").octstr())});s.PrivateKey=u;var d=a.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});s.EncryptedPrivateKey=d;var h=a.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});s.DSAPrivateKey=h,s.DSAparam=a.define("DSAparam",function(){this.int()});var f=a.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(g),this.key("publicKey").optional().explicit(1).bitstr())});s.ECPrivateKey=f;var g=a.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});s.signature=a.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":457,"asn1.js":170}],457:[function(e,n,s){var a=e("asn1.js"),i=a.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),o=a.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),l=a.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),c=a.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(l),this.key("subjectPublicKey").bitstr())}),u=a.define("RelativeDistinguishedName",function(){this.setof(o)}),d=a.define("RDNSequence",function(){this.seqof(u)}),h=a.define("Name",function(){this.choice({rdnSequence:this.use(d)})}),f=a.define("Validity",function(){this.seq().obj(this.key("notBefore").use(i),this.key("notAfter").use(i))}),g=a.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),m=a.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(l),this.key("issuer").use(h),this.key("validity").use(f),this.key("subject").use(h),this.key("subjectPublicKeyInfo").use(c),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(g).optional())}),p=a.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(m),this.key("signatureAlgorithm").use(l),this.key("signatureValue").bitstr())});n.exports=p},{"asn1.js":170}],458:[function(e,n,s){var a=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,i=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,o=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,l=e("evp_bytestokey"),c=e("browserify-aes"),u=e("safe-buffer").Buffer;n.exports=function(d,h){var f,g=d.toString(),m=g.match(a);if(m){var p="aes"+m[1],v=u.from(m[2],"hex"),b=u.from(m[3].replace(/[\r\n]/g,""),"base64"),y=l(h,v.slice(0,8),parseInt(m[1],10)).key,k=[],N=c.createDecipheriv(p,y,v);k.push(N.update(b)),k.push(N.final()),f=u.concat(k)}else{var L=g.match(o);f=u.from(L[2].replace(/[\r\n]/g,""),"base64")}return{tag:g.match(i)[1],data:f}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(e,n,s){var a=e("./asn1"),i=e("./aesid.json"),o=e("./fixProc"),l=e("browserify-aes"),c=e("pbkdf2"),u=e("safe-buffer").Buffer;function d(h){var f;typeof h!="object"||u.isBuffer(h)||(f=h.passphrase,h=h.key),typeof h=="string"&&(h=u.from(h));var g,m,p=o(h,f),v=p.tag,b=p.data;switch(v){case"CERTIFICATE":m=a.certificate.decode(b,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(m||(m=a.PublicKey.decode(b,"der")),g=m.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return a.RSAPublicKey.decode(m.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return m.subjectPrivateKey=m.subjectPublicKey,{type:"ec",data:m};case"1.2.840.10040.4.1":return m.algorithm.params.pub_key=a.DSAparam.decode(m.subjectPublicKey.data,"der"),{type:"dsa",data:m.algorithm.params};default:throw new Error("unknown key id "+g)}case"ENCRYPTED PRIVATE KEY":b=function(y,k){var N=y.algorithm.decrypt.kde.kdeparams.salt,L=parseInt(y.algorithm.decrypt.kde.kdeparams.iters.toString(),10),F=i[y.algorithm.decrypt.cipher.algo.join(".")],R=y.algorithm.decrypt.cipher.iv,B=y.subjectPrivateKey,q=parseInt(F.split("-")[1],10)/8,V=c.pbkdf2Sync(k,N,L,q,"sha1"),I=l.createDecipheriv(F,V,R),C=[];return C.push(I.update(B)),C.push(I.final()),u.concat(C)}(b=a.EncryptedPrivateKey.decode(b,"der"),f);case"PRIVATE KEY":switch(g=(m=a.PrivateKey.decode(b,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return a.RSAPrivateKey.decode(m.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:m.algorithm.curve,privateKey:a.ECPrivateKey.decode(m.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return m.algorithm.params.priv_key=a.DSAparam.decode(m.subjectPrivateKey,"der"),{type:"dsa",params:m.algorithm.params};default:throw new Error("unknown key id "+g)}case"RSA PUBLIC KEY":return a.RSAPublicKey.decode(b,"der");case"RSA PRIVATE KEY":return a.RSAPrivateKey.decode(b,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:a.DSAPrivateKey.decode(b,"der")};case"EC PRIVATE KEY":return{curve:(b=a.ECPrivateKey.decode(b,"der")).parameters.value,privateKey:b.privateKey};default:throw new Error("unknown key type "+v)}}n.exports=d,d.signature=a.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(e,n,s){s.pbkdf2=e("./lib/async"),s.pbkdf2Sync=e("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(e,n,s){(function(a){(function(){var i,o,l=e("safe-buffer").Buffer,c=e("./precondition"),u=e("./default-encoding"),d=e("./sync"),h=e("./to-buffer"),f=a.crypto&&a.crypto.subtle,g={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},m=[];function p(){return o||(o=a.process&&a.process.nextTick?a.process.nextTick:a.queueMicrotask?a.queueMicrotask:a.setImmediate?a.setImmediate:a.setTimeout)}function v(b,y,k,N,L){return f.importKey("raw",b,{name:"PBKDF2"},!1,["deriveBits"]).then(function(F){return f.deriveBits({name:"PBKDF2",salt:y,iterations:k,hash:{name:L}},F,N<<3)}).then(function(F){return l.from(F)})}n.exports=function(b,y,k,N,L,F){typeof L=="function"&&(F=L,L=void 0);var R=g[(L=L||"sha1").toLowerCase()];if(R&&typeof a.Promise=="function"){if(c(k,N),b=h(b,u,"Password"),y=h(y,u,"Salt"),typeof F!="function")throw new Error("No callback provided to pbkdf2");(function(B,q){B.then(function(V){p()(function(){q(null,V)})},function(V){p()(function(){q(V)})})})(function(B){if(a.process&&!a.process.browser||!f||!f.importKey||!f.deriveBits)return Promise.resolve(!1);if(m[B]!==void 0)return m[B];var q=v(i=i||l.alloc(8),i,10,128,B).then(function(){return!0}).catch(function(){return!1});return m[B]=q,q}(R).then(function(B){return B?v(b,y,k,N,R):d(b,y,k,N,L)}),F)}else p()(function(){var B;try{B=d(b,y,k,N,L)}catch(q){return F(q)}F(null,B)})}}).call(this)}).call(this,typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(e,n,s){(function(a,i){(function(){var o;i.process&&i.process.browser?o="utf-8":i.process&&i.process.version?o=parseInt(a.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":o="utf-8",n.exports=o}).call(this)}).call(this,e("_process"),typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(e,n,s){var a=Math.pow(2,30)-1;n.exports=function(i,o){if(typeof i!="number")throw new TypeError("Iterations not a number");if(i<0)throw new TypeError("Bad iterations");if(typeof o!="number")throw new TypeError("Key length not a number");if(o<0||o>a||o!=o)throw new TypeError("Bad key length")}},{}],464:[function(e,n,s){var a=e("create-hash/md5"),i=e("ripemd160"),o=e("sha.js"),l=e("safe-buffer").Buffer,c=e("./precondition"),u=e("./default-encoding"),d=e("./to-buffer"),h=l.alloc(128),f={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function g(m,p,v){var b=function(R){function B(q){return o(R).update(q).digest()}return R==="rmd160"||R==="ripemd160"?function(q){return new i().update(q).digest()}:R==="md5"?a:B}(m),y=m==="sha512"||m==="sha384"?128:64;p.length>y?p=b(p):p.length<y&&(p=l.concat([p,h],y));for(var k=l.allocUnsafe(y+f[m]),N=l.allocUnsafe(y+f[m]),L=0;L<y;L++)k[L]=54^p[L],N[L]=92^p[L];var F=l.allocUnsafe(y+v+4);k.copy(F,0,0,y),this.ipad1=F,this.ipad2=k,this.opad=N,this.alg=m,this.blocksize=y,this.hash=b,this.size=f[m]}g.prototype.run=function(m,p){return m.copy(p,this.blocksize),this.hash(p).copy(this.opad,this.blocksize),this.hash(this.opad)},n.exports=function(m,p,v,b,y){c(v,b);var k=new g(y=y||"sha1",m=d(m,u,"Password"),(p=d(p,u,"Salt")).length),N=l.allocUnsafe(b),L=l.allocUnsafe(p.length+4);p.copy(L,0,0,p.length);for(var F=0,R=f[y],B=Math.ceil(b/R),q=1;q<=B;q++){L.writeUInt32BE(q,p.length);for(var V=k.run(L,k.ipad1),I=V,C=1;C<v;C++){I=k.run(I,k.ipad2);for(var O=0;O<R;O++)V[O]^=I[O]}V.copy(N,F),F+=R}return N}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(e,n,s){var a=e("safe-buffer").Buffer;n.exports=function(i,o,l){if(a.isBuffer(i))return i;if(typeof i=="string")return a.from(i,o);if(ArrayBuffer.isView(i))return a.from(i.buffer);throw new TypeError(l+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(e,n,s){(function(a){(function(){a===void 0||!a.version||a.version.indexOf("v0.")===0||a.version.indexOf("v1.")===0&&a.version.indexOf("v1.8.")!==0?n.exports={nextTick:function(i,o,l,c){if(typeof i!="function")throw new TypeError('"callback" argument must be a function');var u,d,h=arguments.length;switch(h){case 0:case 1:return a.nextTick(i);case 2:return a.nextTick(function(){i.call(null,o)});case 3:return a.nextTick(function(){i.call(null,o,l)});case 4:return a.nextTick(function(){i.call(null,o,l,c)});default:for(u=new Array(h-1),d=0;d<u.length;)u[d++]=arguments[d];return a.nextTick(function(){i.apply(null,u)})}}}:n.exports=a}).call(this)}).call(this,e("_process"))},{_process:467}],467:[function(e,n,s){var a,i,o=n.exports={};function l(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function u(y){if(a===setTimeout)return setTimeout(y,0);if((a===l||!a)&&setTimeout)return a=setTimeout,setTimeout(y,0);try{return a(y,0)}catch{try{return a.call(null,y,0)}catch{return a.call(this,y,0)}}}(function(){try{a=typeof setTimeout=="function"?setTimeout:l}catch{a=l}try{i=typeof clearTimeout=="function"?clearTimeout:c}catch{i=c}})();var d,h=[],f=!1,g=-1;function m(){f&&d&&(f=!1,d.length?h=d.concat(h):g=-1,h.length&&p())}function p(){if(!f){var y=u(m);f=!0;for(var k=h.length;k;){for(d=h,h=[];++g<k;)d&&d[g].run();g=-1,k=h.length}d=null,f=!1,function(N){if(i===clearTimeout)return clearTimeout(N);if((i===c||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(N);try{i(N)}catch{try{return i.call(null,N)}catch{return i.call(this,N)}}}(y)}}function v(y,k){this.fun=y,this.array=k}function b(){}o.nextTick=function(y){var k=new Array(arguments.length-1);if(arguments.length>1)for(var N=1;N<arguments.length;N++)k[N-1]=arguments[N];h.push(new v(y,k)),h.length!==1||f||u(p)},v.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=b,o.addListener=b,o.once=b,o.off=b,o.removeListener=b,o.removeAllListeners=b,o.emit=b,o.prependListener=b,o.prependOnceListener=b,o.listeners=function(y){return[]},o.binding=function(y){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(y){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],468:[function(e,n,s){s.publicEncrypt=e("./publicEncrypt"),s.privateDecrypt=e("./privateDecrypt"),s.privateEncrypt=function(a,i){return s.publicEncrypt(a,i,!0)},s.publicDecrypt=function(a,i){return s.privateDecrypt(a,i,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(e,n,s){var a=e("create-hash"),i=e("safe-buffer").Buffer;function o(l){var c=i.allocUnsafe(4);return c.writeUInt32BE(l,0),c}n.exports=function(l,c){for(var u,d=i.alloc(0),h=0;d.length<c;)u=o(h++),d=i.concat([d,a("sha1").update(l).update(u).digest()]);return d.slice(0,c)}},{"create-hash":386,"safe-buffer":494}],470:[function(e,n,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],471:[function(e,n,s){var a=e("parse-asn1"),i=e("./mgf"),o=e("./xor"),l=e("bn.js"),c=e("browserify-rsa"),u=e("create-hash"),d=e("./withPublic"),h=e("safe-buffer").Buffer;n.exports=function(f,g,m){var p;p=f.padding?f.padding:m?1:4;var v,b=a(f),y=b.modulus.byteLength();if(g.length>y||new l(g).cmp(b.modulus)>=0)throw new Error("decryption error");v=m?d(new l(g),b):c(g,b);var k=h.alloc(y-v.length);if(v=h.concat([k,v],y),p===4)return function(N,L){var F=N.modulus.byteLength(),R=u("sha1").update(h.alloc(0)).digest(),B=R.length;if(L[0]!==0)throw new Error("decryption error");var q=L.slice(1,B+1),V=L.slice(B+1),I=o(q,i(V,B)),C=o(V,i(I,F-B-1));if(function(E,x){E=h.from(E),x=h.from(x);var w=0,_=E.length;E.length!==x.length&&(w++,_=Math.min(E.length,x.length));for(var S=-1;++S<_;)w+=E[S]^x[S];return w}(R,C.slice(0,B)))throw new Error("decryption error");for(var O=B;C[O]===0;)O++;if(C[O++]!==1)throw new Error("decryption error");return C.slice(O)}(b,v);if(p===1)return function(N,L,F){for(var R=L.slice(0,2),B=2,q=0;L[B++]!==0;)if(B>=L.length){q++;break}var V=L.slice(2,B-1);if((R.toString("hex")!=="0002"&&!F||R.toString("hex")!=="0001"&&F)&&q++,V.length<8&&q++,q)throw new Error("decryption error");return L.slice(B)}(0,v,m);if(p===3)return v;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(e,n,s){var a=e("parse-asn1"),i=e("randombytes"),o=e("create-hash"),l=e("./mgf"),c=e("./xor"),u=e("bn.js"),d=e("./withPublic"),h=e("browserify-rsa"),f=e("safe-buffer").Buffer;n.exports=function(g,m,p){var v;v=g.padding?g.padding:p?1:4;var b,y=a(g);if(v===4)b=function(k,N){var L=k.modulus.byteLength(),F=N.length,R=o("sha1").update(f.alloc(0)).digest(),B=R.length,q=2*B;if(F>L-q-2)throw new Error("message too long");var V=f.alloc(L-F-q-2),I=L-B-1,C=i(B),O=c(f.concat([R,V,f.alloc(1,1),N],I),l(C,I)),E=c(C,l(O,B));return new u(f.concat([f.alloc(1),E,O],L))}(y,m);else if(v===1)b=function(k,N,L){var F,R=N.length,B=k.modulus.byteLength();if(R>B-11)throw new Error("message too long");return F=L?f.alloc(B-R-3,255):function(q){for(var V,I=f.allocUnsafe(q),C=0,O=i(2*q),E=0;C<q;)E===O.length&&(O=i(2*q),E=0),(V=O[E++])&&(I[C++]=V);return I}(B-R-3),new u(f.concat([f.from([0,L?1:2]),F,f.alloc(1),N],B))}(y,m,p);else{if(v!==3)throw new Error("unknown padding");if((b=new u(m)).cmp(y.modulus)>=0)throw new Error("data too long for modulus")}return p?h(b,y):d(b,y)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(e,n,s){var a=e("bn.js"),i=e("safe-buffer").Buffer;n.exports=function(o,l){return i.from(o.toRed(a.mont(l.modulus)).redPow(new a(l.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(e,n,s){n.exports=function(a,i){for(var o=a.length,l=-1;++l<o;)a[l]^=i[l];return a}},{}],475:[function(e,n,s){(function(a,i){(function(){var o=e("safe-buffer").Buffer,l=i.crypto||i.msCrypto;l&&l.getRandomValues?n.exports=function(c,u){if(c>4294967295)throw new RangeError("requested too many random bytes");var d=o.allocUnsafe(c);if(c>0)if(c>65536)for(var h=0;h<c;h+=65536)l.getRandomValues(d.slice(h,h+65536));else l.getRandomValues(d);return typeof u=="function"?a.nextTick(function(){u(null,d)}):d}:n.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,e("_process"),typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(e,n,s){(function(a,i){(function(){function o(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var l=e("safe-buffer"),c=e("randombytes"),u=l.Buffer,d=l.kMaxLength,h=i.crypto||i.msCrypto,f=Math.pow(2,32)-1;function g(v,b){if(typeof v!="number"||v!=v)throw new TypeError("offset must be a number");if(v>f||v<0)throw new TypeError("offset must be a uint32");if(v>d||v>b)throw new RangeError("offset out of range")}function m(v,b,y){if(typeof v!="number"||v!=v)throw new TypeError("size must be a number");if(v>f||v<0)throw new TypeError("size must be a uint32");if(v+b>y||v>d)throw new RangeError("buffer too small")}function p(v,b,y,k){if(a.browser){var N=v.buffer,L=new Uint8Array(N,b,y);return h.getRandomValues(L),k?void a.nextTick(function(){k(null,v)}):v}if(!k)return c(y).copy(v,b),v;c(y,function(F,R){if(F)return k(F);R.copy(v,b),k(null,v)})}h&&h.getRandomValues||!a.browser?(s.randomFill=function(v,b,y,k){if(!(u.isBuffer(v)||v instanceof i.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof b=="function")k=b,b=0,y=v.length;else if(typeof y=="function")k=y,y=v.length-b;else if(typeof k!="function")throw new TypeError('"cb" argument must be a function');return g(b,v.length),m(y,b,v.length),p(v,b,y,k)},s.randomFillSync=function(v,b,y){if(b===void 0&&(b=0),!(u.isBuffer(v)||v instanceof i.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return g(b,v.length),y===void 0&&(y=v.length-b),m(y,b,v.length),p(v,b,y)}):(s.randomFill=o,s.randomFillSync=o)}).call(this)}).call(this,e("_process"),typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(e,n,s){var a={};function i(l,c,u){u||(u=Error);var d=function(h){var f,g;function m(p,v,b){return h.call(this,function(y,k,N){return typeof c=="string"?c:c(y,k,N)}(p,v,b))||this}return g=h,(f=m).prototype=Object.create(g.prototype),f.prototype.constructor=f,f.__proto__=g,m}(u);d.prototype.name=u.name,d.prototype.code=l,a[l]=d}function o(l,c){if(Array.isArray(l)){var u=l.length;return l=l.map(function(d){return String(d)}),u>2?"one of ".concat(c," ").concat(l.slice(0,u-1).join(", "),", or ")+l[u-1]:u===2?"one of ".concat(c," ").concat(l[0]," or ").concat(l[1]):"of ".concat(c," ").concat(l[0])}return"of ".concat(c," ").concat(String(l))}i("ERR_INVALID_OPT_VALUE",function(l,c){return'The value "'+c+'" is invalid for option "'+l+'"'},TypeError),i("ERR_INVALID_ARG_TYPE",function(l,c,u){var d,h,f;if(typeof c=="string"&&(h="not ",c.substr(0,h.length)===h)?(d="must not be",c=c.replace(/^not /,"")):d="must be",function(m,p,v){return(v===void 0||v>m.length)&&(v=m.length),m.substring(v-p.length,v)===p}(l," argument"))f="The ".concat(l," ").concat(d," ").concat(o(c,"type"));else{var g=function(m,p,v){return typeof v!="number"&&(v=0),!(v+p.length>m.length)&&m.indexOf(p,v)!==-1}(l,".")?"property":"argument";f='The "'.concat(l,'" ').concat(g," ").concat(d," ").concat(o(c,"type"))}return f+=". Received type ".concat(typeof u)},TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",function(l){return"The "+l+" method is not implemented"}),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",function(l){return"Cannot call "+l+" after a stream was destroyed"}),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",function(l){return"Unknown encoding: "+l},TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n.exports.codes=a},{}],478:[function(e,n,s){(function(a){(function(){var i=Object.keys||function(m){var p=[];for(var v in m)p.push(v);return p};n.exports=h;var o=e("./_stream_readable"),l=e("./_stream_writable");e("inherits")(h,o);for(var c=i(l.prototype),u=0;u<c.length;u++){var d=c[u];h.prototype[d]||(h.prototype[d]=l.prototype[d])}function h(m){if(!(this instanceof h))return new h(m);o.call(this,m),l.call(this,m),this.allowHalfOpen=!0,m&&(m.readable===!1&&(this.readable=!1),m.writable===!1&&(this.writable=!1),m.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",f)))}function f(){this._writableState.ended||a.nextTick(g,this)}function g(m){m.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(m){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=m,this._writableState.destroyed=m)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(e,n,s){n.exports=i;var a=e("./_stream_transform");function i(o){if(!(this instanceof i))return new i(o);a.call(this,o)}e("inherits")(i,a),i.prototype._transform=function(o,l,c){c(null,o)}},{"./_stream_transform":481,inherits:440}],480:[function(e,n,s){(function(a,i){(function(){var o;n.exports=I,I.ReadableState=V,e("events").EventEmitter;var l=function(P,D){return P.listeners(D).length},c=e("./internal/streams/stream"),u=e("buffer").Buffer,d=(i!==void 0?i:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},h,f=e("util");h=f&&f.debuglog?f.debuglog("stream"):function(){};var g,m,p,v=e("./internal/streams/buffer_list"),b=e("./internal/streams/destroy"),y=e("./internal/streams/state").getHighWaterMark,k=e("../errors").codes,N=k.ERR_INVALID_ARG_TYPE,L=k.ERR_STREAM_PUSH_AFTER_EOF,F=k.ERR_METHOD_NOT_IMPLEMENTED,R=k.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(I,c);var B=b.errorOrDestroy,q=["error","close","destroy","pause","resume"];function V(P,D,G){o=o||e("./_stream_duplex"),P=P||{},typeof G!="boolean"&&(G=D instanceof o),this.objectMode=!!P.objectMode,G&&(this.objectMode=this.objectMode||!!P.readableObjectMode),this.highWaterMark=y(this,P,"readableHighWaterMark",G),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=P.emitClose!==!1,this.autoDestroy=!!P.autoDestroy,this.destroyed=!1,this.defaultEncoding=P.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,P.encoding&&(g||(g=e("string_decoder/").StringDecoder),this.decoder=new g(P.encoding),this.encoding=P.encoding)}function I(P){if(o=o||e("./_stream_duplex"),!(this instanceof I))return new I(P);var D=this instanceof o;this._readableState=new V(P,this,D),this.readable=!0,P&&(typeof P.read=="function"&&(this._read=P.read),typeof P.destroy=="function"&&(this._destroy=P.destroy)),c.call(this)}function C(P,D,G,re,te){h("readableAddChunk",D);var ne,le=P._readableState;if(D===null)le.reading=!1,function(oe,ee){if(h("onEofChunk"),!ee.ended){if(ee.decoder){var Z=ee.decoder.end();Z&&Z.length&&(ee.buffer.push(Z),ee.length+=ee.objectMode?1:Z.length)}ee.ended=!0,ee.sync?x(oe):(ee.needReadable=!1,ee.emittedReadable||(ee.emittedReadable=!0,w(oe)))}}(P,le);else if(te||(ne=function(oe,ee){var Z;se=ee,u.isBuffer(se)||se instanceof d||typeof ee=="string"||ee===void 0||oe.objectMode||(Z=new N("chunk",["string","Buffer","Uint8Array"],ee));var se;return Z}(le,D)),ne)B(P,ne);else if(le.objectMode||D&&D.length>0)if(typeof D=="string"||le.objectMode||Object.getPrototypeOf(D)===u.prototype||(D=function(oe){return u.from(oe)}(D)),re)le.endEmitted?B(P,new R):O(P,le,D,!0);else if(le.ended)B(P,new L);else{if(le.destroyed)return!1;le.reading=!1,le.decoder&&!G?(D=le.decoder.write(D),le.objectMode||D.length!==0?O(P,le,D,!1):_(P,le)):O(P,le,D,!1)}else re||(le.reading=!1,_(P,le));return!le.ended&&(le.length<le.highWaterMark||le.length===0)}function O(P,D,G,re){D.flowing&&D.length===0&&!D.sync?(D.awaitDrain=0,P.emit("data",G)):(D.length+=D.objectMode?1:G.length,re?D.buffer.unshift(G):D.buffer.push(G),D.needReadable&&x(P)),_(P,D)}Object.defineProperty(I.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(P){this._readableState&&(this._readableState.destroyed=P)}}),I.prototype.destroy=b.destroy,I.prototype._undestroy=b.undestroy,I.prototype._destroy=function(P,D){D(P)},I.prototype.push=function(P,D){var G,re=this._readableState;return re.objectMode?G=!0:typeof P=="string"&&((D=D||re.defaultEncoding)!==re.encoding&&(P=u.from(P,D),D=""),G=!0),C(this,P,D,!1,G)},I.prototype.unshift=function(P){return C(this,P,null,!0,!1)},I.prototype.isPaused=function(){return this._readableState.flowing===!1},I.prototype.setEncoding=function(P){g||(g=e("string_decoder/").StringDecoder);var D=new g(P);this._readableState.decoder=D,this._readableState.encoding=this._readableState.decoder.encoding;for(var G=this._readableState.buffer.head,re="";G!==null;)re+=D.write(G.data),G=G.next;return this._readableState.buffer.clear(),re!==""&&this._readableState.buffer.push(re),this._readableState.length=re.length,this};function E(P,D){return P<=0||D.length===0&&D.ended?0:D.objectMode?1:P!=P?D.flowing&&D.length?D.buffer.head.data.length:D.length:(P>D.highWaterMark&&(D.highWaterMark=function(G){return G>=1073741824?G=1073741824:(G--,G|=G>>>1,G|=G>>>2,G|=G>>>4,G|=G>>>8,G|=G>>>16,G++),G}(P)),P<=D.length?P:D.ended?D.length:(D.needReadable=!0,0))}function x(P){var D=P._readableState;h("emitReadable",D.needReadable,D.emittedReadable),D.needReadable=!1,D.emittedReadable||(h("emitReadable",D.flowing),D.emittedReadable=!0,a.nextTick(w,P))}function w(P){var D=P._readableState;h("emitReadable_",D.destroyed,D.length,D.ended),D.destroyed||!D.length&&!D.ended||(P.emit("readable"),D.emittedReadable=!1),D.needReadable=!D.flowing&&!D.ended&&D.length<=D.highWaterMark,H(P)}function _(P,D){D.readingMore||(D.readingMore=!0,a.nextTick(S,P,D))}function S(P,D){for(;!D.reading&&!D.ended&&(D.length<D.highWaterMark||D.flowing&&D.length===0);){var G=D.length;if(h("maybeReadMore read 0"),P.read(0),G===D.length)break}D.readingMore=!1}function T(P){var D=P._readableState;D.readableListening=P.listenerCount("readable")>0,D.resumeScheduled&&!D.paused?D.flowing=!0:P.listenerCount("data")>0&&P.resume()}function U(P){h("readable nexttick read 0"),P.read(0)}function A(P,D){h("resume",D.reading),D.reading||P.read(0),D.resumeScheduled=!1,P.emit("resume"),H(P),D.flowing&&!D.reading&&P.read(0)}function H(P){var D=P._readableState;for(h("flow",D.flowing);D.flowing&&P.read()!==null;);}function z(P,D){return D.length===0?null:(D.objectMode?G=D.buffer.shift():!P||P>=D.length?(G=D.decoder?D.buffer.join(""):D.buffer.length===1?D.buffer.first():D.buffer.concat(D.length),D.buffer.clear()):G=D.buffer.consume(P,D.decoder),G);var G}function K(P){var D=P._readableState;h("endReadable",D.endEmitted),D.endEmitted||(D.ended=!0,a.nextTick(j,D,P))}function j(P,D){if(h("endReadableNT",P.endEmitted,P.length),!P.endEmitted&&P.length===0&&(P.endEmitted=!0,D.readable=!1,D.emit("end"),P.autoDestroy)){var G=D._writableState;(!G||G.autoDestroy&&G.finished)&&D.destroy()}}function J(P,D){for(var G=0,re=P.length;G<re;G++)if(P[G]===D)return G;return-1}I.prototype.read=function(P){h("read",P),P=parseInt(P,10);var D=this._readableState,G=P;if(P!==0&&(D.emittedReadable=!1),P===0&&D.needReadable&&((D.highWaterMark!==0?D.length>=D.highWaterMark:D.length>0)||D.ended))return h("read: emitReadable",D.length,D.ended),D.length===0&&D.ended?K(this):x(this),null;if((P=E(P,D))===0&&D.ended)return D.length===0&&K(this),null;var re,te=D.needReadable;return h("need readable",te),(D.length===0||D.length-P<D.highWaterMark)&&h("length less than watermark",te=!0),D.ended||D.reading?h("reading or ended",te=!1):te&&(h("do read"),D.reading=!0,D.sync=!0,D.length===0&&(D.needReadable=!0),this._read(D.highWaterMark),D.sync=!1,D.reading||(P=E(G,D))),(re=P>0?z(P,D):null)===null?(D.needReadable=D.length<=D.highWaterMark,P=0):(D.length-=P,D.awaitDrain=0),D.length===0&&(D.ended||(D.needReadable=!0),G!==P&&D.ended&&K(this)),re!==null&&this.emit("data",re),re},I.prototype._read=function(P){B(this,new F("_read()"))},I.prototype.pipe=function(P,D){var G=this,re=this._readableState;switch(re.pipesCount){case 0:re.pipes=P;break;case 1:re.pipes=[re.pipes,P];break;default:re.pipes.push(P)}re.pipesCount+=1,h("pipe count=%d opts=%j",re.pipesCount,D);var te=(!D||D.end!==!1)&&P!==a.stdout&&P!==a.stderr?le:pe;function ne(fe,ye){h("onunpipe"),fe===G&&ye&&ye.hasUnpiped===!1&&(ye.hasUnpiped=!0,h("cleanup"),P.removeListener("close",ie),P.removeListener("finish",ue),P.removeListener("drain",oe),P.removeListener("error",se),P.removeListener("unpipe",ne),G.removeListener("end",le),G.removeListener("end",pe),G.removeListener("data",Z),ee=!0,!re.awaitDrain||P._writableState&&!P._writableState.needDrain||oe())}function le(){h("onend"),P.end()}re.endEmitted?a.nextTick(te):G.once("end",te),P.on("unpipe",ne);var oe=function(fe){return function(){var ye=fe._readableState;h("pipeOnDrain",ye.awaitDrain),ye.awaitDrain&&ye.awaitDrain--,ye.awaitDrain===0&&l(fe,"data")&&(ye.flowing=!0,H(fe))}}(G);P.on("drain",oe);var ee=!1;function Z(fe){h("ondata");var ye=P.write(fe);h("dest.write",ye),ye===!1&&((re.pipesCount===1&&re.pipes===P||re.pipesCount>1&&J(re.pipes,P)!==-1)&&!ee&&(h("false write response, pause",re.awaitDrain),re.awaitDrain++),G.pause())}function se(fe){h("onerror",fe),pe(),P.removeListener("error",se),l(P,"error")===0&&B(P,fe)}function ie(){P.removeListener("finish",ue),pe()}function ue(){h("onfinish"),P.removeListener("close",ie),pe()}function pe(){h("unpipe"),G.unpipe(P)}return G.on("data",Z),function(fe,ye,Te){if(typeof fe.prependListener=="function")return fe.prependListener(ye,Te);fe._events&&fe._events[ye]?Array.isArray(fe._events[ye])?fe._events[ye].unshift(Te):fe._events[ye]=[Te,fe._events[ye]]:fe.on(ye,Te)}(P,"error",se),P.once("close",ie),P.once("finish",ue),P.emit("pipe",G),re.flowing||(h("pipe resume"),G.resume()),P},I.prototype.unpipe=function(P){var D=this._readableState,G={hasUnpiped:!1};if(D.pipesCount===0)return this;if(D.pipesCount===1)return P&&P!==D.pipes||(P||(P=D.pipes),D.pipes=null,D.pipesCount=0,D.flowing=!1,P&&P.emit("unpipe",this,G)),this;if(!P){var re=D.pipes,te=D.pipesCount;D.pipes=null,D.pipesCount=0,D.flowing=!1;for(var ne=0;ne<te;ne++)re[ne].emit("unpipe",this,{hasUnpiped:!1});return this}var le=J(D.pipes,P);return le===-1||(D.pipes.splice(le,1),D.pipesCount-=1,D.pipesCount===1&&(D.pipes=D.pipes[0]),P.emit("unpipe",this,G)),this},I.prototype.on=function(P,D){var G=c.prototype.on.call(this,P,D),re=this._readableState;return P==="data"?(re.readableListening=this.listenerCount("readable")>0,re.flowing!==!1&&this.resume()):P==="readable"&&(re.endEmitted||re.readableListening||(re.readableListening=re.needReadable=!0,re.flowing=!1,re.emittedReadable=!1,h("on readable",re.length,re.reading),re.length?x(this):re.reading||a.nextTick(U,this))),G},I.prototype.addListener=I.prototype.on,I.prototype.removeListener=function(P,D){var G=c.prototype.removeListener.call(this,P,D);return P==="readable"&&a.nextTick(T,this),G},I.prototype.removeAllListeners=function(P){var D=c.prototype.removeAllListeners.apply(this,arguments);return P!=="readable"&&P!==void 0||a.nextTick(T,this),D},I.prototype.resume=function(){var P=this._readableState;return P.flowing||(h("resume"),P.flowing=!P.readableListening,function(D,G){G.resumeScheduled||(G.resumeScheduled=!0,a.nextTick(A,D,G))}(this,P)),P.paused=!1,this},I.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},I.prototype.wrap=function(P){var D=this,G=this._readableState,re=!1;for(var te in P.on("end",function(){if(h("wrapped end"),G.decoder&&!G.ended){var le=G.decoder.end();le&&le.length&&D.push(le)}D.push(null)}),P.on("data",function(le){h("wrapped data"),G.decoder&&(le=G.decoder.write(le)),G.objectMode&&le==null||(G.objectMode||le&&le.length)&&(D.push(le)||(re=!0,P.pause()))}),P)this[te]===void 0&&typeof P[te]=="function"&&(this[te]=function(le){return function(){return P[le].apply(P,arguments)}}(te));for(var ne=0;ne<q.length;ne++)P.on(q[ne],this.emit.bind(this,q[ne]));return this._read=function(le){h("wrapped _read",le),re&&(re=!1,P.resume())},this},typeof Symbol=="function"&&(I.prototype[Symbol.asyncIterator]=function(){return m===void 0&&(m=e("./internal/streams/async_iterator")),m(this)}),Object.defineProperty(I.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(I.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(I.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(P){this._readableState&&(this._readableState.flowing=P)}}),I._fromList=z,Object.defineProperty(I.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(I.from=function(P,D){return p===void 0&&(p=e("./internal/streams/from")),p(I,P,D)})}).call(this)}).call(this,e("_process"),typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(e,n,s){n.exports=h;var a=e("../errors").codes,i=a.ERR_METHOD_NOT_IMPLEMENTED,o=a.ERR_MULTIPLE_CALLBACK,l=a.ERR_TRANSFORM_ALREADY_TRANSFORMING,c=a.ERR_TRANSFORM_WITH_LENGTH_0,u=e("./_stream_duplex");function d(m,p){var v=this._transformState;v.transforming=!1;var b=v.writecb;if(b===null)return this.emit("error",new o);v.writechunk=null,v.writecb=null,p!=null&&this.push(p),b(m);var y=this._readableState;y.reading=!1,(y.needReadable||y.length<y.highWaterMark)&&this._read(y.highWaterMark)}function h(m){if(!(this instanceof h))return new h(m);u.call(this,m),this._transformState={afterTransform:d.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,m&&(typeof m.transform=="function"&&(this._transform=m.transform),typeof m.flush=="function"&&(this._flush=m.flush)),this.on("prefinish",f)}function f(){var m=this;typeof this._flush!="function"||this._readableState.destroyed?g(this,null,null):this._flush(function(p,v){g(m,p,v)})}function g(m,p,v){if(p)return m.emit("error",p);if(v!=null&&m.push(v),m._writableState.length)throw new c;if(m._transformState.transforming)throw new l;return m.push(null)}e("inherits")(h,u),h.prototype.push=function(m,p){return this._transformState.needTransform=!1,u.prototype.push.call(this,m,p)},h.prototype._transform=function(m,p,v){v(new i("_transform()"))},h.prototype._write=function(m,p,v){var b=this._transformState;if(b.writecb=v,b.writechunk=m,b.writeencoding=p,!b.transforming){var y=this._readableState;(b.needTransform||y.needReadable||y.length<y.highWaterMark)&&this._read(y.highWaterMark)}},h.prototype._read=function(m){var p=this._transformState;p.writechunk===null||p.transforming?p.needTransform=!0:(p.transforming=!0,this._transform(p.writechunk,p.writeencoding,p.afterTransform))},h.prototype._destroy=function(m,p){u.prototype._destroy.call(this,m,function(v){p(v)})}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(e,n,s){(function(a,i){(function(){function o(S){var T=this;this.next=null,this.entry=null,this.finish=function(){(function(U,A,H){var z=U.entry;for(U.entry=null;z;){var K=z.callback;A.pendingcb--,K(H),z=z.next}A.corkedRequestsFree.next=U})(T,S)}}var l;n.exports=I,I.WritableState=V;var c={deprecate:e("util-deprecate")},u=e("./internal/streams/stream"),d=e("buffer").Buffer,h=(i!==void 0?i:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},f,g=e("./internal/streams/destroy"),m=e("./internal/streams/state").getHighWaterMark,p=e("../errors").codes,v=p.ERR_INVALID_ARG_TYPE,b=p.ERR_METHOD_NOT_IMPLEMENTED,y=p.ERR_MULTIPLE_CALLBACK,k=p.ERR_STREAM_CANNOT_PIPE,N=p.ERR_STREAM_DESTROYED,L=p.ERR_STREAM_NULL_VALUES,F=p.ERR_STREAM_WRITE_AFTER_END,R=p.ERR_UNKNOWN_ENCODING,B=g.errorOrDestroy;function q(){}function V(S,T,U){l=l||e("./_stream_duplex"),S=S||{},typeof U!="boolean"&&(U=T instanceof l),this.objectMode=!!S.objectMode,U&&(this.objectMode=this.objectMode||!!S.writableObjectMode),this.highWaterMark=m(this,S,"writableHighWaterMark",U),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var A=S.decodeStrings===!1;this.decodeStrings=!A,this.defaultEncoding=S.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(H){(function(z,K){var j=z._writableState,J=j.sync,P=j.writecb;if(typeof P!="function")throw new y;if(function(G){G.writing=!1,G.writecb=null,G.length-=G.writelen,G.writelen=0}(j),K)(function(G,re,te,ne,le){--re.pendingcb,te?(a.nextTick(le,ne),a.nextTick(_,G,re),G._writableState.errorEmitted=!0,B(G,ne)):(le(ne),G._writableState.errorEmitted=!0,B(G,ne),_(G,re))})(z,j,J,K,P);else{var D=x(j)||z.destroyed;D||j.corked||j.bufferProcessing||!j.bufferedRequest||E(z,j),J?a.nextTick(O,z,j,D,P):O(z,j,D,P)}})(T,H)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=S.emitClose!==!1,this.autoDestroy=!!S.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function I(S){var T=this instanceof(l=l||e("./_stream_duplex"));if(!T&&!f.call(I,this))return new I(S);this._writableState=new V(S,this,T),this.writable=!0,S&&(typeof S.write=="function"&&(this._write=S.write),typeof S.writev=="function"&&(this._writev=S.writev),typeof S.destroy=="function"&&(this._destroy=S.destroy),typeof S.final=="function"&&(this._final=S.final)),u.call(this)}function C(S,T,U,A,H,z,K){T.writelen=A,T.writecb=K,T.writing=!0,T.sync=!0,T.destroyed?T.onwrite(new N("write")):U?S._writev(H,T.onwrite):S._write(H,z,T.onwrite),T.sync=!1}function O(S,T,U,A){U||function(H,z){z.length===0&&z.needDrain&&(z.needDrain=!1,H.emit("drain"))}(S,T),T.pendingcb--,A(),_(S,T)}function E(S,T){T.bufferProcessing=!0;var U=T.bufferedRequest;if(S._writev&&U&&U.next){var A=T.bufferedRequestCount,H=new Array(A),z=T.corkedRequestsFree;z.entry=U;for(var K=0,j=!0;U;)H[K]=U,U.isBuf||(j=!1),U=U.next,K+=1;H.allBuffers=j,C(S,T,!0,T.length,H,"",z.finish),T.pendingcb++,T.lastBufferedRequest=null,z.next?(T.corkedRequestsFree=z.next,z.next=null):T.corkedRequestsFree=new o(T),T.bufferedRequestCount=0}else{for(;U;){var J=U.chunk,P=U.encoding,D=U.callback;if(C(S,T,!1,T.objectMode?1:J.length,J,P,D),U=U.next,T.bufferedRequestCount--,T.writing)break}U===null&&(T.lastBufferedRequest=null)}T.bufferedRequest=U,T.bufferProcessing=!1}function x(S){return S.ending&&S.length===0&&S.bufferedRequest===null&&!S.finished&&!S.writing}function w(S,T){S._final(function(U){T.pendingcb--,U&&B(S,U),T.prefinished=!0,S.emit("prefinish"),_(S,T)})}function _(S,T){var U=x(T);if(U&&(function(H,z){z.prefinished||z.finalCalled||(typeof H._final!="function"||z.destroyed?(z.prefinished=!0,H.emit("prefinish")):(z.pendingcb++,z.finalCalled=!0,a.nextTick(w,H,z)))}(S,T),T.pendingcb===0&&(T.finished=!0,S.emit("finish"),T.autoDestroy))){var A=S._readableState;(!A||A.autoDestroy&&A.endEmitted)&&S.destroy()}return U}e("inherits")(I,u),V.prototype.getBuffer=function(){for(var S=this.bufferedRequest,T=[];S;)T.push(S),S=S.next;return T},function(){try{Object.defineProperty(V.prototype,"buffer",{get:c.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(I,Symbol.hasInstance,{value:function(S){return!!f.call(this,S)||this===I&&S&&S._writableState instanceof V}})):f=function(S){return S instanceof this},I.prototype.pipe=function(){B(this,new k)},I.prototype.write=function(S,T,U){var A,H=this._writableState,z=!1,K=!H.objectMode&&(A=S,d.isBuffer(A)||A instanceof h);return K&&!d.isBuffer(S)&&(S=function(j){return d.from(j)}(S)),typeof T=="function"&&(U=T,T=null),K?T="buffer":T||(T=H.defaultEncoding),typeof U!="function"&&(U=q),H.ending?function(j,J){var P=new F;B(j,P),a.nextTick(J,P)}(this,U):(K||function(j,J,P,D){var G;return P===null?G=new L:typeof P=="string"||J.objectMode||(G=new v("chunk",["string","Buffer"],P)),!G||(B(j,G),a.nextTick(D,G),!1)}(this,H,S,U))&&(H.pendingcb++,z=function(j,J,P,D,G,re){if(!P){var te=function(ee,Z,se){return ee.objectMode||ee.decodeStrings===!1||typeof Z!="string"||(Z=d.from(Z,se)),Z}(J,D,G);D!==te&&(P=!0,G="buffer",D=te)}var ne=J.objectMode?1:D.length;J.length+=ne;var le=J.length<J.highWaterMark;if(le||(J.needDrain=!0),J.writing||J.corked){var oe=J.lastBufferedRequest;J.lastBufferedRequest={chunk:D,encoding:G,isBuf:P,callback:re,next:null},oe?oe.next=J.lastBufferedRequest:J.bufferedRequest=J.lastBufferedRequest,J.bufferedRequestCount+=1}else C(j,J,!1,ne,D,G,re);return le}(this,H,K,S,T,U)),z},I.prototype.cork=function(){this._writableState.corked++},I.prototype.uncork=function(){var S=this._writableState;S.corked&&(S.corked--,S.writing||S.corked||S.bufferProcessing||!S.bufferedRequest||E(this,S))},I.prototype.setDefaultEncoding=function(S){if(typeof S=="string"&&(S=S.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((S+"").toLowerCase())>-1))throw new R(S);return this._writableState.defaultEncoding=S,this},Object.defineProperty(I.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(I.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),I.prototype._write=function(S,T,U){U(new b("_write()"))},I.prototype._writev=null,I.prototype.end=function(S,T,U){var A=this._writableState;return typeof S=="function"?(U=S,S=null,T=null):typeof T=="function"&&(U=T,T=null),S!=null&&this.write(S,T),A.corked&&(A.corked=1,this.uncork()),A.ending||function(H,z,K){z.ending=!0,_(H,z),K&&(z.finished?a.nextTick(K):H.once("finish",K)),z.ended=!0,H.writable=!1}(this,A,U),this},Object.defineProperty(I.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(I.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(S){this._writableState&&(this._writableState.destroyed=S)}}),I.prototype.destroy=g.destroy,I.prototype._undestroy=g.undestroy,I.prototype._destroy=function(S,T){T(S)}}).call(this)}).call(this,e("_process"),typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(e,n,s){(function(a){(function(){var i;function o(N,L,F){return(L=function(R){var B=function(q,V){if(typeof q!="object"||q===null)return q;var I=q[Symbol.toPrimitive];if(I!==void 0){var C=I.call(q,V);if(typeof C!="object")return C;throw new TypeError("@@toPrimitive must return a primitive value.")}return(V==="string"?String:Number)(q)}(R,"string");return typeof B=="symbol"?B:String(B)}(L))in N?Object.defineProperty(N,L,{value:F,enumerable:!0,configurable:!0,writable:!0}):N[L]=F,N}var l=e("./end-of-stream"),c=Symbol("lastResolve"),u=Symbol("lastReject"),d=Symbol("error"),h=Symbol("ended"),f=Symbol("lastPromise"),g=Symbol("handlePromise"),m=Symbol("stream");function p(N,L){return{value:N,done:L}}function v(N){var L=N[c];if(L!==null){var F=N[m].read();F!==null&&(N[f]=null,N[c]=null,N[u]=null,L(p(F,!1)))}}function b(N){a.nextTick(v,N)}var y=Object.getPrototypeOf(function(){}),k=Object.setPrototypeOf((o(i={get stream(){return this[m]},next:function(){var N=this,L=this[d];if(L!==null)return Promise.reject(L);if(this[h])return Promise.resolve(p(void 0,!0));if(this[m].destroyed)return new Promise(function(q,V){a.nextTick(function(){N[d]?V(N[d]):q(p(void 0,!0))})});var F,R=this[f];if(R)F=new Promise(function(q,V){return function(I,C){q.then(function(){V[h]?I(p(void 0,!0)):V[g](I,C)},C)}}(R,this));else{var B=this[m].read();if(B!==null)return Promise.resolve(p(B,!1));F=new Promise(this[g])}return this[f]=F,F}},Symbol.asyncIterator,function(){return this}),o(i,"return",function(){var N=this;return new Promise(function(L,F){N[m].destroy(null,function(R){R?F(R):L(p(void 0,!0))})})}),i),y);n.exports=function(N){var L,F=Object.create(k,(o(L={},m,{value:N,writable:!0}),o(L,c,{value:null,writable:!0}),o(L,u,{value:null,writable:!0}),o(L,d,{value:null,writable:!0}),o(L,h,{value:N._readableState.endEmitted,writable:!0}),o(L,g,{value:function(R,B){var q=F[m].read();q?(F[f]=null,F[c]=null,F[u]=null,R(p(q,!1))):(F[c]=R,F[u]=B)},writable:!0}),L));return F[f]=null,l(N,function(R){if(R&&R.code!=="ERR_STREAM_PREMATURE_CLOSE"){var B=F[u];return B!==null&&(F[f]=null,F[c]=null,F[u]=null,B(R)),void(F[d]=R)}var q=F[c];q!==null&&(F[f]=null,F[c]=null,F[u]=null,q(p(void 0,!0))),F[h]=!0}),N.on("readable",b.bind(null,F)),F}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":486,_process:467}],484:[function(e,n,s){function a(f,g){var m=Object.keys(f);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(f);g&&(p=p.filter(function(v){return Object.getOwnPropertyDescriptor(f,v).enumerable})),m.push.apply(m,p)}return m}function i(f){for(var g=1;g<arguments.length;g++){var m=arguments[g]!=null?arguments[g]:{};g%2?a(Object(m),!0).forEach(function(p){o(f,p,m[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(m)):a(Object(m)).forEach(function(p){Object.defineProperty(f,p,Object.getOwnPropertyDescriptor(m,p))})}return f}function o(f,g,m){return(g=c(g))in f?Object.defineProperty(f,g,{value:m,enumerable:!0,configurable:!0,writable:!0}):f[g]=m,f}function l(f,g){for(var m=0;m<g.length;m++){var p=g[m];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(f,c(p.key),p)}}function c(f){var g=function(m,p){if(typeof m!="object"||m===null)return m;var v=m[Symbol.toPrimitive];if(v!==void 0){var b=v.call(m,p);if(typeof b!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return(p==="string"?String:Number)(m)}(f,"string");return typeof g=="symbol"?g:String(g)}var u=e("buffer").Buffer,d=e("util").inspect,h=d&&d.custom||"inspect";n.exports=function(){function f(){(function(p,v){if(!(p instanceof v))throw new TypeError("Cannot call a class as a function")})(this,f),this.head=null,this.tail=null,this.length=0}var g,m;return g=f,(m=[{key:"push",value:function(p){var v={data:p,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(p){var v={data:p,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var p=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,p}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(p){if(this.length===0)return"";for(var v=this.head,b=""+v.data;v=v.next;)b+=p+v.data;return b}},{key:"concat",value:function(p){if(this.length===0)return u.alloc(0);for(var v,b,y,k=u.allocUnsafe(p>>>0),N=this.head,L=0;N;)v=N.data,b=k,y=L,u.prototype.copy.call(v,b,y),L+=N.data.length,N=N.next;return k}},{key:"consume",value:function(p,v){var b;return p<this.head.data.length?(b=this.head.data.slice(0,p),this.head.data=this.head.data.slice(p)):b=p===this.head.data.length?this.shift():v?this._getString(p):this._getBuffer(p),b}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(p){var v=this.head,b=1,y=v.data;for(p-=y.length;v=v.next;){var k=v.data,N=p>k.length?k.length:p;if(N===k.length?y+=k:y+=k.slice(0,p),(p-=N)==0){N===k.length?(++b,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=k.slice(N));break}++b}return this.length-=b,y}},{key:"_getBuffer",value:function(p){var v=u.allocUnsafe(p),b=this.head,y=1;for(b.data.copy(v),p-=b.data.length;b=b.next;){var k=b.data,N=p>k.length?k.length:p;if(k.copy(v,v.length-p,0,N),(p-=N)==0){N===k.length?(++y,b.next?this.head=b.next:this.head=this.tail=null):(this.head=b,b.data=k.slice(N));break}++y}return this.length-=y,v}},{key:h,value:function(p,v){return d(this,i(i({},v),{},{depth:0,customInspect:!1}))}}])&&l(g.prototype,m),Object.defineProperty(g,"prototype",{writable:!1}),f}()},{buffer:220,util:188}],485:[function(e,n,s){(function(a){(function(){function i(c,u){l(c,u),o(c)}function o(c){c._writableState&&!c._writableState.emitClose||c._readableState&&!c._readableState.emitClose||c.emit("close")}function l(c,u){c.emit("error",u)}n.exports={destroy:function(c,u){var d=this,h=this._readableState&&this._readableState.destroyed,f=this._writableState&&this._writableState.destroyed;return h||f?(u?u(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,a.nextTick(l,this,c)):a.nextTick(l,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,function(g){!u&&g?d._writableState?d._writableState.errorEmitted?a.nextTick(o,d):(d._writableState.errorEmitted=!0,a.nextTick(i,d,g)):a.nextTick(i,d,g):u?(a.nextTick(o,d),u(g)):a.nextTick(o,d)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(c,u){var d=c._readableState,h=c._writableState;d&&d.autoDestroy||h&&h.autoDestroy?c.destroy(u):c.emit("error",u)}}}).call(this)}).call(this,e("_process"))},{_process:467}],486:[function(e,n,s){var a=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}n.exports=function o(l,c,u){if(typeof c=="function")return o(l,null,c);c||(c={}),u=function(N){var L=!1;return function(){if(!L){L=!0;for(var F=arguments.length,R=new Array(F),B=0;B<F;B++)R[B]=arguments[B];N.apply(this,R)}}}(u||i);var d=c.readable||c.readable!==!1&&l.readable,h=c.writable||c.writable!==!1&&l.writable,f=function(){l.writable||m()},g=l._writableState&&l._writableState.finished,m=function(){h=!1,g=!0,d||u.call(l)},p=l._readableState&&l._readableState.endEmitted,v=function(){d=!1,p=!0,h||u.call(l)},b=function(N){u.call(l,N)},y=function(){var N;return d&&!p?(l._readableState&&l._readableState.ended||(N=new a),u.call(l,N)):h&&!g?(l._writableState&&l._writableState.ended||(N=new a),u.call(l,N)):void 0},k=function(){l.req.on("finish",m)};return function(N){return N.setHeader&&typeof N.abort=="function"}(l)?(l.on("complete",m),l.on("abort",y),l.req?k():l.on("request",k)):h&&!l._writableState&&(l.on("end",f),l.on("close",f)),l.on("end",v),l.on("finish",m),c.error!==!1&&l.on("error",b),l.on("close",y),function(){l.removeListener("complete",m),l.removeListener("abort",y),l.removeListener("request",k),l.req&&l.req.removeListener("finish",m),l.removeListener("end",f),l.removeListener("close",f),l.removeListener("finish",m),l.removeListener("end",v),l.removeListener("error",b),l.removeListener("close",y)}}},{"../../../errors":477}],487:[function(e,n,s){n.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(e,n,s){var a,i=e("../../../errors").codes,o=i.ERR_MISSING_ARGS,l=i.ERR_STREAM_DESTROYED;function c(g){if(g)throw g}function u(g,m,p,v){v=function(k){var N=!1;return function(){N||(N=!0,k.apply(void 0,arguments))}}(v);var b=!1;g.on("close",function(){b=!0}),a===void 0&&(a=e("./end-of-stream")),a(g,{readable:m,writable:p},function(k){if(k)return v(k);b=!0,v()});var y=!1;return function(k){if(!b&&!y)return y=!0,function(N){return N.setHeader&&typeof N.abort=="function"}(g)?g.abort():typeof g.destroy=="function"?g.destroy():void v(k||new l("pipe"))}}function d(g){g()}function h(g,m){return g.pipe(m)}function f(g){return g.length?typeof g[g.length-1]!="function"?c:g.pop():c}n.exports=function(){for(var g=arguments.length,m=new Array(g),p=0;p<g;p++)m[p]=arguments[p];var v,b=f(m);if(Array.isArray(m[0])&&(m=m[0]),m.length<2)throw new o("streams");var y=m.map(function(k,N){var L=N<m.length-1;return u(k,L,N>0,function(F){v||(v=F),F&&y.forEach(d),L||(y.forEach(d),b(v))})});return m.reduce(h)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(e,n,s){var a=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;n.exports={getHighWaterMark:function(i,o,l,c){var u=function(d,h,f){return d.highWaterMark!=null?d.highWaterMark:h?d[f]:null}(o,c,l);if(u!=null){if(!isFinite(u)||Math.floor(u)!==u||u<0)throw new a(c?l:"highWaterMark",u);return Math.floor(u)}return i.objectMode?16:16384}}},{"../../../errors":477}],490:[function(e,n,s){n.exports=e("events").EventEmitter},{events:422}],491:[function(e,n,s){(s=n.exports=e("./lib/_stream_readable.js")).Stream=s,s.Readable=s,s.Writable=e("./lib/_stream_writable.js"),s.Duplex=e("./lib/_stream_duplex.js"),s.Transform=e("./lib/_stream_transform.js"),s.PassThrough=e("./lib/_stream_passthrough.js"),s.finished=e("./lib/internal/streams/end-of-stream.js"),s.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(e,n,s){var a=function(i){var o=Object.prototype,l=o.hasOwnProperty,c=Object.defineProperty||function(_,S,T){_[S]=T.value},u=typeof Symbol=="function"?Symbol:{},d=u.iterator||"@@iterator",h=u.asyncIterator||"@@asyncIterator",f=u.toStringTag||"@@toStringTag";function g(_,S,T){return Object.defineProperty(_,S,{value:T,enumerable:!0,configurable:!0,writable:!0}),_[S]}try{g({},"")}catch{g=function(S,T,U){return S[T]=U}}function m(_,S,T,U){var A=S&&S.prototype instanceof b?S:b,H=Object.create(A.prototype),z=new E(U||[]);return c(H,"_invoke",{value:V(_,T,z)}),H}function p(_,S,T){try{return{type:"normal",arg:_.call(S,T)}}catch(U){return{type:"throw",arg:U}}}i.wrap=m;var v={};function b(){}function y(){}function k(){}var N={};g(N,d,function(){return this});var L=Object.getPrototypeOf,F=L&&L(L(x([])));F&&F!==o&&l.call(F,d)&&(N=F);var R=k.prototype=b.prototype=Object.create(N);function B(_){["next","throw","return"].forEach(function(S){g(_,S,function(T){return this._invoke(S,T)})})}function q(_,S){var T;c(this,"_invoke",{value:function(U,A){function H(){return new S(function(z,K){(function j(J,P,D,G){var re=p(_[J],_,P);if(re.type!=="throw"){var te=re.arg,ne=te.value;return ne&&typeof ne=="object"&&l.call(ne,"__await")?S.resolve(ne.__await).then(function(le){j("next",le,D,G)},function(le){j("throw",le,D,G)}):S.resolve(ne).then(function(le){te.value=le,D(te)},function(le){return j("throw",le,D,G)})}G(re.arg)})(U,A,z,K)})}return T=T?T.then(H,H):H()}})}function V(_,S,T){var U="suspendedStart";return function(A,H){if(U==="executing")throw new Error("Generator is already running");if(U==="completed"){if(A==="throw")throw H;return w()}for(T.method=A,T.arg=H;;){var z=T.delegate;if(z){var K=I(z,T);if(K){if(K===v)continue;return K}}if(T.method==="next")T.sent=T._sent=T.arg;else if(T.method==="throw"){if(U==="suspendedStart")throw U="completed",T.arg;T.dispatchException(T.arg)}else T.method==="return"&&T.abrupt("return",T.arg);U="executing";var j=p(_,S,T);if(j.type==="normal"){if(U=T.done?"completed":"suspendedYield",j.arg===v)continue;return{value:j.arg,done:T.done}}j.type==="throw"&&(U="completed",T.method="throw",T.arg=j.arg)}}}function I(_,S){var T=S.method,U=_.iterator[T];if(U===void 0)return S.delegate=null,T==="throw"&&_.iterator.return&&(S.method="return",S.arg=void 0,I(_,S),S.method==="throw")||T!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+T+"' method")),v;var A=p(U,_.iterator,S.arg);if(A.type==="throw")return S.method="throw",S.arg=A.arg,S.delegate=null,v;var H=A.arg;return H?H.done?(S[_.resultName]=H.value,S.next=_.nextLoc,S.method!=="return"&&(S.method="next",S.arg=void 0),S.delegate=null,v):H:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,v)}function C(_){var S={tryLoc:_[0]};1 in _&&(S.catchLoc=_[1]),2 in _&&(S.finallyLoc=_[2],S.afterLoc=_[3]),this.tryEntries.push(S)}function O(_){var S=_.completion||{};S.type="normal",delete S.arg,_.completion=S}function E(_){this.tryEntries=[{tryLoc:"root"}],_.forEach(C,this),this.reset(!0)}function x(_){if(_){var S=_[d];if(S)return S.call(_);if(typeof _.next=="function")return _;if(!isNaN(_.length)){var T=-1,U=function A(){for(;++T<_.length;)if(l.call(_,T))return A.value=_[T],A.done=!1,A;return A.value=void 0,A.done=!0,A};return U.next=U}}return{next:w}}function w(){return{value:void 0,done:!0}}return y.prototype=k,c(R,"constructor",{value:k,configurable:!0}),c(k,"constructor",{value:y,configurable:!0}),y.displayName=g(k,f,"GeneratorFunction"),i.isGeneratorFunction=function(_){var S=typeof _=="function"&&_.constructor;return!!S&&(S===y||(S.displayName||S.name)==="GeneratorFunction")},i.mark=function(_){return Object.setPrototypeOf?Object.setPrototypeOf(_,k):(_.__proto__=k,g(_,f,"GeneratorFunction")),_.prototype=Object.create(R),_},i.awrap=function(_){return{__await:_}},B(q.prototype),g(q.prototype,h,function(){return this}),i.AsyncIterator=q,i.async=function(_,S,T,U,A){A===void 0&&(A=Promise);var H=new q(m(_,S,T,U),A);return i.isGeneratorFunction(S)?H:H.next().then(function(z){return z.done?z.value:H.next()})},B(R),g(R,f,"Generator"),g(R,d,function(){return this}),g(R,"toString",function(){return"[object Generator]"}),i.keys=function(_){var S=Object(_),T=[];for(var U in S)T.push(U);return T.reverse(),function A(){for(;T.length;){var H=T.pop();if(H in S)return A.value=H,A.done=!1,A}return A.done=!0,A}},i.values=x,E.prototype={constructor:E,reset:function(_){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!_)for(var S in this)S.charAt(0)==="t"&&l.call(this,S)&&!isNaN(+S.slice(1))&&(this[S]=void 0)},stop:function(){this.done=!0;var _=this.tryEntries[0].completion;if(_.type==="throw")throw _.arg;return this.rval},dispatchException:function(_){if(this.done)throw _;var S=this;function T(j,J){return H.type="throw",H.arg=_,S.next=j,J&&(S.method="next",S.arg=void 0),!!J}for(var U=this.tryEntries.length-1;U>=0;--U){var A=this.tryEntries[U],H=A.completion;if(A.tryLoc==="root")return T("end");if(A.tryLoc<=this.prev){var z=l.call(A,"catchLoc"),K=l.call(A,"finallyLoc");if(z&&K){if(this.prev<A.catchLoc)return T(A.catchLoc,!0);if(this.prev<A.finallyLoc)return T(A.finallyLoc)}else if(z){if(this.prev<A.catchLoc)return T(A.catchLoc,!0)}else{if(!K)throw new Error("try statement without catch or finally");if(this.prev<A.finallyLoc)return T(A.finallyLoc)}}}},abrupt:function(_,S){for(var T=this.tryEntries.length-1;T>=0;--T){var U=this.tryEntries[T];if(U.tryLoc<=this.prev&&l.call(U,"finallyLoc")&&this.prev<U.finallyLoc){var A=U;break}}A&&(_==="break"||_==="continue")&&A.tryLoc<=S&&S<=A.finallyLoc&&(A=null);var H=A?A.completion:{};return H.type=_,H.arg=S,A?(this.method="next",this.next=A.finallyLoc,v):this.complete(H)},complete:function(_,S){if(_.type==="throw")throw _.arg;return _.type==="break"||_.type==="continue"?this.next=_.arg:_.type==="return"?(this.rval=this.arg=_.arg,this.method="return",this.next="end"):_.type==="normal"&&S&&(this.next=S),v},finish:function(_){for(var S=this.tryEntries.length-1;S>=0;--S){var T=this.tryEntries[S];if(T.finallyLoc===_)return this.complete(T.completion,T.afterLoc),O(T),v}},catch:function(_){for(var S=this.tryEntries.length-1;S>=0;--S){var T=this.tryEntries[S];if(T.tryLoc===_){var U=T.completion;if(U.type==="throw"){var A=U.arg;O(T)}return A}}throw new Error("illegal catch attempt")},delegateYield:function(_,S,T){return this.delegate={iterator:x(_),resultName:S,nextLoc:T},this.method==="next"&&(this.arg=void 0),v}},i}(typeof n=="object"?n.exports:{});try{regeneratorRuntime=a}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}},{}],493:[function(e,n,s){var a=e("buffer").Buffer,i=e("inherits"),o=e("hash-base"),l=new Array(16),c=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],u=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],d=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],h=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],f=[0,1518500249,1859775393,2400959708,2840853838],g=[1352829926,1548603684,1836072691,2053994217,0];function m(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function p(L,F){return L<<F|L>>>32-F}function v(L,F,R,B,q,V,I,C){return p(L+(F^R^B)+V+I|0,C)+q|0}function b(L,F,R,B,q,V,I,C){return p(L+(F&R|~F&B)+V+I|0,C)+q|0}function y(L,F,R,B,q,V,I,C){return p(L+((F|~R)^B)+V+I|0,C)+q|0}function k(L,F,R,B,q,V,I,C){return p(L+(F&B|R&~B)+V+I|0,C)+q|0}function N(L,F,R,B,q,V,I,C){return p(L+(F^(R|~B))+V+I|0,C)+q|0}i(m,o),m.prototype._update=function(){for(var L=l,F=0;F<16;++F)L[F]=this._block.readInt32LE(4*F);for(var R=0|this._a,B=0|this._b,q=0|this._c,V=0|this._d,I=0|this._e,C=0|this._a,O=0|this._b,E=0|this._c,x=0|this._d,w=0|this._e,_=0;_<80;_+=1){var S,T;_<16?(S=v(R,B,q,V,I,L[c[_]],f[0],d[_]),T=N(C,O,E,x,w,L[u[_]],g[0],h[_])):_<32?(S=b(R,B,q,V,I,L[c[_]],f[1],d[_]),T=k(C,O,E,x,w,L[u[_]],g[1],h[_])):_<48?(S=y(R,B,q,V,I,L[c[_]],f[2],d[_]),T=y(C,O,E,x,w,L[u[_]],g[2],h[_])):_<64?(S=k(R,B,q,V,I,L[c[_]],f[3],d[_]),T=b(C,O,E,x,w,L[u[_]],g[3],h[_])):(S=N(R,B,q,V,I,L[c[_]],f[4],d[_]),T=v(C,O,E,x,w,L[u[_]],g[4],h[_])),R=I,I=V,V=p(q,10),q=B,B=S,C=w,w=x,x=p(E,10),E=O,O=T}var U=this._b+q+x|0;this._b=this._c+V+w|0,this._c=this._d+I+C|0,this._d=this._e+R+O|0,this._e=this._a+B+E|0,this._a=U},m.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var L=a.alloc?a.alloc(20):new a(20);return L.writeInt32LE(this._a,0),L.writeInt32LE(this._b,4),L.writeInt32LE(this._c,8),L.writeInt32LE(this._d,12),L.writeInt32LE(this._e,16),L},n.exports=m},{buffer:220,"hash-base":425,inherits:440}],494:[function(e,n,s){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var a=e("buffer"),i=a.Buffer;function o(c,u){for(var d in c)u[d]=c[d]}function l(c,u,d){return i(c,u,d)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?n.exports=a:(o(a,s),s.Buffer=l),l.prototype=Object.create(i.prototype),o(i,l),l.from=function(c,u,d){if(typeof c=="number")throw new TypeError("Argument must not be a number");return i(c,u,d)},l.alloc=function(c,u,d){if(typeof c!="number")throw new TypeError("Argument must be a number");var h=i(c);return u!==void 0?typeof d=="string"?h.fill(u,d):h.fill(u):h.fill(0),h},l.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return i(c)},l.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return a.SlowBuffer(c)}},{buffer:220}],495:[function(e,n,s){(function(a){(function(){var i,o=e("buffer"),l=o.Buffer,c={};for(i in o)o.hasOwnProperty(i)&&i!=="SlowBuffer"&&i!=="Buffer"&&(c[i]=o[i]);var u=c.Buffer={};for(i in l)l.hasOwnProperty(i)&&i!=="allocUnsafe"&&i!=="allocUnsafeSlow"&&(u[i]=l[i]);if(c.Buffer.prototype=l.prototype,u.from&&u.from!==Uint8Array.from||(u.from=function(d,h,f){if(typeof d=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof d);if(d&&d.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);return l(d,h,f)}),u.alloc||(u.alloc=function(d,h,f){if(typeof d!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof d);if(d<0||d>=2*(1<<30))throw new RangeError('The value "'+d+'" is invalid for option "size"');var g=l(d);return h&&h.length!==0?typeof f=="string"?g.fill(h,f):g.fill(h):g.fill(0),g}),!c.kStringMaxLength)try{c.kStringMaxLength=a.binding("buffer").kStringMaxLength}catch{}c.constants||(c.constants={MAX_LENGTH:c.kMaxLength},c.kStringMaxLength&&(c.constants.MAX_STRING_LENGTH=c.kStringMaxLength)),n.exports=c}).call(this)}).call(this,e("_process"))},{_process:467,buffer:220}],496:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0});const a=e("xmlchars/xml/1.0/ed5"),i=e("xmlchars/xml/1.1/ed2"),o=e("xmlchars/xmlns/1.0/ed3");var l=a.isS,c=a.isChar,u=a.isNameStartChar,d=a.isNameChar,h=a.S_LIST,f=a.NAME_RE,g=i.isChar,m=o.isNCNameStartChar,p=o.isNCNameChar,v=o.NC_NAME_RE;const b="http://www.w3.org/XML/1998/namespace",y="http://www.w3.org/2000/xmlns/",k={__proto__:null,xml:b,xmlns:y},N={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},L=x=>x===34||x===39,F=[34,39],R=[...F,91,62],B=[...F,60,93],q=[61,63,...h],V=[...h,62,38,60];function I(x,w,_){switch(w){case"xml":_!==b&&x.fail(`xml prefix must be bound to ${b}.`);break;case"xmlns":_!==y&&x.fail(`xmlns prefix must be bound to ${y}.`)}switch(_){case y:x.fail(w===""?`the default namespace may not be set to ${_}.`:`may not assign a prefix (even "xmlns") to the URI ${y}.`);break;case b:switch(w){case"xml":break;case"":x.fail(`the default namespace may not be set to ${_}.`);break;default:x.fail("may not assign the xml namespace to another prefix.")}}}const C=x=>v.test(x),O=x=>f.test(x);s.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const E={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};s.SaxesParser=class{constructor(x){this.opt=x??{},this.fragmentOpt=!!this.opt.fragment;const w=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,w){this.nameStartCheck=m,this.nameCheck=p,this.isName=C,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},k);const _=this.opt.additionalNamespaces;_!=null&&(function(S,T){for(const U of Object.keys(T))I(S,U,T[U])}(this,_),Object.assign(this.ns,_))}else this.nameStartCheck=u,this.nameCheck=d,this.isName=O,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var x;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:w}=this;this.state=w?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=w,this.xmlDeclPossible=!w,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:_}=this.opt;if(_===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");_="1.0"}this.setXMLVersion(_),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(N),(x=this.readyHandler)===null||x===void 0||x.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(x,w){this[E[x]]=w}off(x){this[E[x]]=void 0}makeError(x){var w;let _=(w=this.fileName)!==null&&w!==void 0?w:"";return this.trackPosition&&(_.length>0&&(_+=":"),_+=`${this.line}:${this.column}`),_.length>0&&(_+=": "),new Error(_+x)}fail(x){const w=this.makeError(x),_=this.errorHandler;if(_===void 0)throw w;return _(w),this}write(x){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let w=!1;x===null?(w=!0,x=""):typeof x=="object"&&(x=x.toString()),this.carriedFromPrevious!==void 0&&(x=`${this.carriedFromPrevious}${x}`,this.carriedFromPrevious=void 0);let _=x.length;const S=x.charCodeAt(_-1);!w&&(S===13||S>=55296&&S<=56319)&&(this.carriedFromPrevious=x[_-1],_--,x=x.slice(0,_));const{stateTable:T}=this;for(this.chunk=x,this.i=0;this.i<_;)T[this.state].call(this);return this.chunkPosition+=_,w?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:x,i:w}=this;if(this.prevI=w,this.i=w+1,w>=x.length)return-1;const _=x.charCodeAt(w);if(this.column++,_<55296){if(_>=32||_===9)return _;switch(_){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return x.charCodeAt(w+1)===10&&(this.i=w+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),_}}if(_>56319)return _>=57344&&_<=65533||this.fail("disallowed character."),_;const S=65536+1024*(_-55296)+(x.charCodeAt(w+1)-56320);return this.i=w+2,S>1114111&&this.fail("disallowed character."),S}getCode11(){const{chunk:x,i:w}=this;if(this.prevI=w,this.i=w+1,w>=x.length)return-1;const _=x.charCodeAt(w);if(this.column++,_<55296){if(_>31&&_<127||_>159&&_!==8232||_===9)return _;switch(_){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const T=x.charCodeAt(w+1);T!==10&&T!==133||(this.i=w+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),_}}if(_>56319)return _>=57344&&_<=65533||this.fail("disallowed character."),_;const S=65536+1024*(_-55296)+(x.charCodeAt(w+1)-56320);return this.i=w+2,S>1114111&&this.fail("disallowed character."),S}getCodeNorm(){const x=this.getCode();return x===-2?10:x}unget(){this.i=this.prevI,this.column--}captureTo(x){let{i:w}=this;const{chunk:_}=this;for(;;){const S=this.getCode(),T=S===-2,U=T?10:S;if(U===-1||x.includes(U))return this.text+=_.slice(w,this.prevI),U;T&&(this.text+=_.slice(w,this.prevI)+`
`,w=this.i)}}captureToChar(x){let{i:w}=this;const{chunk:_}=this;for(;;){let S=this.getCode();switch(S){case-2:this.text+=_.slice(w,this.prevI)+`
`,w=this.i,S=10;break;case-1:return this.text+=_.slice(w),!1}if(S===x)return this.text+=_.slice(w,this.prevI),!0}}captureNameChars(){const{chunk:x,i:w}=this;for(;;){const _=this.getCode();if(_===-1)return this.name+=x.slice(w),-1;if(!d(_))return this.name+=x.slice(w,this.prevI),_===-2?10:_}}skipSpaces(){for(;;){const x=this.getCodeNorm();if(x===-1||!l(x))return x}}setXMLVersion(x){this.currentXMLVersion=x,x==="1.0"?(this.isChar=c,this.getCode=this.getCode10):(this.isChar=g,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const x=this.i,w=this.skipSpaces();switch(this.prevI!==x&&(this.xmlDeclPossible=!1),w){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var x;const w=this.captureTo(R);switch(w){case 62:(x=this.doctypeHandler)===null||x===void 0||x.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(w),w===91?this.state=4:L(w)&&(this.state=3,this.q=w)}}sDoctypeQuote(){const x=this.q;this.captureToChar(x)&&(this.text+=String.fromCodePoint(x),this.q=null,this.state=2)}sDTD(){const x=this.captureTo(B);x!==-1&&(this.text+=String.fromCodePoint(x),x===93?this.state=2:x===60?this.state=6:L(x)&&(this.state=5,this.q=x))}sDTDQuoted(){const x=this.q;this.captureToChar(x)&&(this.text+=String.fromCodePoint(x),this.state=4,this.q=null)}sDTDOpenWaka(){const x=this.getCodeNorm();switch(this.text+=String.fromCodePoint(x),x){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const x=String.fromCodePoint(this.getCodeNorm()),w=this.openWakaBang+=x;this.text+=x,w!=="-"&&(this.state=w==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const x=this.getCodeNorm();this.text+=String.fromCodePoint(x),this.state=x===45?10:8}sDTDCommentEnded(){const x=this.getCodeNorm();this.text+=String.fromCodePoint(x),x===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const x=this.getCodeNorm();this.text+=String.fromCodePoint(x),x===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:x}=this;const{chunk:w}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=w.slice(x,this.prevI)+`
`,x=this.i;break;case 59:{const{entityReturnState:_}=this,S=this.entity+w.slice(x,this.prevI);let T;this.state=_,S===""?(this.fail("empty entity name."),T="&;"):(T=this.parseEntity(S),this.entity=""),_===13&&this.textHandler===void 0||(this.text+=T);break e}case-1:this.entity+=w.slice(x);break e}}sOpenWaka(){const x=this.getCode();if(u(x))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(x){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var x;const w=this.getCodeNorm();w===45?(this.state=19,(x=this.commentHandler)===null||x===void 0||x.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(w),this.state=17)}sCommentEnded(){const x=this.getCodeNorm();x!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(x),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const x=this.getCodeNorm();x===93?this.state=22:(this.text+="]"+String.fromCodePoint(x),this.state=20)}sCDataEnding2(){var x;const w=this.getCodeNorm();switch(w){case 62:(x=this.cdataHandler)===null||x===void 0||x.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(w),this.state=20}}sPIFirstChar(){const x=this.getCodeNorm();this.nameStartCheck(x)?(this.piTarget+=String.fromCodePoint(x),this.state=24):x===63||l(x)?(this.fail("processing instruction without a target."),this.state=x===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(x),this.state=24)}sPIRest(){const{chunk:x,i:w}=this;for(;;){const _=this.getCodeNorm();if(_===-1)return void(this.piTarget+=x.slice(w));if(!this.nameCheck(_)){this.piTarget+=x.slice(w,this.prevI);const S=_===63;S||l(_)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=S?33:27):this.state=S?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(_));break}}}sPIBody(){if(this.text.length===0){const x=this.getCodeNorm();x===63?this.state=26:l(x)||(this.text=String.fromCodePoint(x))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var x;const w=this.getCodeNorm();if(w===62){const{piTarget:_}=this;_.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(x=this.piHandler)===null||x===void 0||x.call(this,{target:_,body:this.text}),this.piTarget=this.text="",this.state=13}else w===63?this.text+="?":(this.text+="?"+String.fromCodePoint(w),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const x=this.skipSpaces();x!==63?x!==-1&&(this.state=28,this.name=String.fromCodePoint(x)):this.state=33}sXMLDeclName(){const x=this.captureTo(q);if(x===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(l(x)||x===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=x===61?30:29}}sXMLDeclEq(){const x=this.getCodeNorm();if(x===63)return this.state=33,void this.fail("XML declaration is incomplete.");l(x)||(x!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const x=this.getCodeNorm();if(x===63)return this.state=33,void this.fail("XML declaration is incomplete.");l(x)||(L(x)?this.q=x:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const x=this.captureTo([this.q,63]);if(x===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(x===-1)return;const w=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const _=w;this.xmlDecl.version=_,/^1\.[0-9]+$/.test(_)?this.opt.forceXMLVersion||this.setXMLVersion(_):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(w)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=w;break;case"standalone":w!=="yes"&&w!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=w}this.name="",this.state=32}sXMLDeclSeparator(){const x=this.getCodeNorm();x!==63?(l(x)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var x;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(x=this.xmldeclHandler)===null||x===void 0||x.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var x;const w=this.captureNameChars();if(w===-1)return;const _=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=_.ns=Object.create(null)),(x=this.openTagStartHandler)===null||x===void 0||x.call(this,_),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),w){case 62:this.openTag();break;case 47:this.state=35;break;default:l(w)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const x=this.skipSpaces();x!==-1&&(u(x)?(this.unget(),this.state=37):x===62?this.openTag():x===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const x=this.captureNameChars();x===61?this.state=39:l(x)?this.state=38:x===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):x!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const x=this.skipSpaces();switch(x){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",x===62?this.openTag():u(x)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const x=this.getCodeNorm();L(x)?(this.q=x,this.state=40):l(x)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:x,chunk:w}=this;let{i:_}=this;for(;;)switch(this.getCode()){case x:return this.pushAttrib(this.name,this.text+w.slice(_,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=w.slice(_,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=w.slice(_,this.prevI)+" ",_=this.i;break;case 60:return this.text+=w.slice(_,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=w.slice(_))}}sAttribValueClosed(){const x=this.getCodeNorm();l(x)?this.state=36:x===62?this.openTag():x===47?this.state=35:u(x)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const x=this.captureTo(V);switch(x){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",x===62?this.openTag():this.state=36}}sCloseTag(){const x=this.captureNameChars();x===62?this.closeTag():l(x)?this.state=44:x!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:x,forbiddenState:w}=this;const{chunk:_,textHandler:S}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,S!==void 0){const{text:T}=this,U=_.slice(x,this.prevI);T.length!==0?(S(T+U),this.text=""):U.length!==0&&S(U)}w=0;break e;case 38:this.state=14,this.entityReturnState=13,S!==void 0&&(this.text+=_.slice(x,this.prevI)),w=0;break e;case 93:switch(w){case 0:w=1;break;case 1:w=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:w===2&&this.fail('the string "]]>" is disallowed in char data.'),w=0;break;case-2:S!==void 0&&(this.text+=_.slice(x,this.prevI)+`
`),x=this.i,w=0;break;case-1:S!==void 0&&(this.text+=_.slice(x));break e;default:w=0}this.forbiddenState=w}handleTextOutsideRoot(){let{i:x}=this;const{chunk:w,textHandler:_}=this;let S=!1;e:for(;;){const T=this.getCode();switch(T){case 60:if(this.state=15,_!==void 0){const{text:U}=this,A=w.slice(x,this.prevI);U.length!==0?(_(U+A),this.text=""):A.length!==0&&_(A)}break e;case 38:this.state=14,this.entityReturnState=13,_!==void 0&&(this.text+=w.slice(x,this.prevI)),S=!0;break e;case-2:_!==void 0&&(this.text+=w.slice(x,this.prevI)+`
`),x=this.i;break;case-1:_!==void 0&&(this.text+=w.slice(x));break e;default:l(T)||(S=!0)}}S&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(x,w){var _;const{prefix:S,local:T}=this.qname(x),U={name:x,prefix:S,local:T,value:w};if(this.attribList.push(U),(_=this.attributeHandler)===null||_===void 0||_.call(this,U),S==="xmlns"){const A=w.trim();this.currentXMLVersion==="1.0"&&A===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[T]=A,I(this,T,A)}else if(x==="xmlns"){const A=w.trim();this.topNS[""]=A,I(this,"",A)}}pushAttribPlain(x,w){var _;const S={name:x,value:w};this.attribList.push(S),(_=this.attributeHandler)===null||_===void 0||_.call(this,S)}end(){var x,w;this.sawRoot||this.fail("document must contain a root element.");const{tags:_}=this;for(;_.length>0;){const T=_.pop();this.fail("unclosed tag: "+T.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:S}=this;return S.length!==0&&((x=this.textHandler)===null||x===void 0||x.call(this,S),this.text=""),this._closed=!0,(w=this.endHandler)===null||w===void 0||w.call(this),this._init(),this}resolve(x){var w,_;let S=this.topNS[x];if(S!==void 0)return S;const{tags:T}=this;for(let U=T.length-1;U>=0;U--)if(S=T[U].ns[x],S!==void 0)return S;return S=this.ns[x],S!==void 0?S:(_=(w=this.opt).resolvePrefix)===null||_===void 0?void 0:_.call(w,x)}qname(x){const w=x.indexOf(":");if(w===-1)return{prefix:"",local:x};const _=x.slice(w+1),S=x.slice(0,w);return(S===""||_===""||_.includes(":"))&&this.fail(`malformed name: ${x}.`),{prefix:S,local:_}}processAttribsNS(){var x;const{attribList:w}=this,_=this.tag;{const{prefix:U,local:A}=this.qname(_.name);_.prefix=U,_.local=A;const H=_.uri=(x=this.resolve(U))!==null&&x!==void 0?x:"";U!==""&&(U==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),H===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(U)}.`),_.uri=U))}if(w.length===0)return;const{attributes:S}=_,T=new Set;for(const U of w){const{name:A,prefix:H,local:z}=U;let K,j;H===""?(K=A==="xmlns"?y:"",j=A):(K=this.resolve(H),K===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(H)}.`),K=H),j=`{${K}}${z}`),T.has(j)&&this.fail(`duplicate attribute: ${j}.`),T.add(j),U.uri=K,S[A]=U}this.attribList=[]}processAttribsPlain(){const{attribList:x}=this,w=this.tag.attributes;for(const{name:_,value:S}of x)w[_]!==void 0&&this.fail(`duplicate attribute: ${_}.`),w[_]=S;this.attribList=[]}openTag(){var x;this.processAttribs();const{tags:w}=this,_=this.tag;_.isSelfClosing=!1,(x=this.openTagHandler)===null||x===void 0||x.call(this,_),w.push(_),this.state=13,this.name=""}openSelfClosingTag(){var x,w,_;this.processAttribs();const{tags:S}=this,T=this.tag;T.isSelfClosing=!0,(x=this.openTagHandler)===null||x===void 0||x.call(this,T),(w=this.closeTagHandler)===null||w===void 0||w.call(this,T),(this.tag=(_=S[S.length-1])!==null&&_!==void 0?_:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:x,name:w}=this;if(this.state=13,this.name="",w==="")return this.fail("weird empty close tag."),void(this.text+="</>");const _=this.closeTagHandler;let S=x.length;for(;S-- >0;){const T=this.tag=x.pop();if(this.topNS=T.ns,_==null||_(T),T.name===w)break;this.fail("unexpected close tag.")}S===0?this.closedRoot=!0:S<0&&(this.fail(`unmatched closing tag: ${w}.`),this.text+=`</${w}>`)}parseEntity(x){if(x[0]!=="#"){const _=this.ENTITIES[x];return _!==void 0?_:(this.fail(this.isName(x)?"undefined entity.":"disallowed character in entity name."),`&${x};`)}let w=NaN;return x[1]==="x"&&/^#x[0-9a-f]+$/i.test(x)?w=parseInt(x.slice(2),16):/^#[0-9]+$/.test(x)&&(w=parseInt(x.slice(1),10)),this.isChar(w)?String.fromCodePoint(w):(this.fail("malformed character entity."),`&${x};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(e,n,s){var a=e("safe-buffer").Buffer;function i(o,l){this._block=a.alloc(o),this._finalSize=l,this._blockSize=o,this._len=0}i.prototype.update=function(o,l){typeof o=="string"&&(l=l||"utf8",o=a.from(o,l));for(var c=this._block,u=this._blockSize,d=o.length,h=this._len,f=0;f<d;){for(var g=h%u,m=Math.min(d-f,u-g),p=0;p<m;p++)c[g+p]=o[f+p];f+=m,(h+=m)%u==0&&this._update(c)}return this._len+=d,this},i.prototype.digest=function(o){var l=this._len%this._blockSize;this._block[l]=128,this._block.fill(0,l+1),l>=this._finalSize&&(this._update(this._block),this._block.fill(0));var c=8*this._len;if(c<=4294967295)this._block.writeUInt32BE(c,this._blockSize-4);else{var u=(4294967295&c)>>>0,d=(c-u)/4294967296;this._block.writeUInt32BE(d,this._blockSize-8),this._block.writeUInt32BE(u,this._blockSize-4)}this._update(this._block);var h=this._hash();return o?h.toString(o):h},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},n.exports=i},{"safe-buffer":494}],498:[function(e,n,s){var a=n.exports=function(i){i=i.toLowerCase();var o=a[i];if(!o)throw new Error(i+" is not supported (we accept pull requests)");return new o};a.sha=e("./sha"),a.sha1=e("./sha1"),a.sha224=e("./sha224"),a.sha256=e("./sha256"),a.sha384=e("./sha384"),a.sha512=e("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(e,n,s){var a=e("inherits"),i=e("./hash"),o=e("safe-buffer").Buffer,l=[1518500249,1859775393,-1894007588,-899497514],c=new Array(80);function u(){this.init(),this._w=c,i.call(this,64,56)}function d(f){return f<<30|f>>>2}function h(f,g,m,p){return f===0?g&m|~g&p:f===2?g&m|g&p|m&p:g^m^p}a(u,i),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(f){for(var g,m=this._w,p=0|this._a,v=0|this._b,b=0|this._c,y=0|this._d,k=0|this._e,N=0;N<16;++N)m[N]=f.readInt32BE(4*N);for(;N<80;++N)m[N]=m[N-3]^m[N-8]^m[N-14]^m[N-16];for(var L=0;L<80;++L){var F=~~(L/20),R=0|((g=p)<<5|g>>>27)+h(F,v,b,y)+k+m[L]+l[F];k=y,y=b,b=d(v),v=p,p=R}this._a=p+this._a|0,this._b=v+this._b|0,this._c=b+this._c|0,this._d=y+this._d|0,this._e=k+this._e|0},u.prototype._hash=function(){var f=o.allocUnsafe(20);return f.writeInt32BE(0|this._a,0),f.writeInt32BE(0|this._b,4),f.writeInt32BE(0|this._c,8),f.writeInt32BE(0|this._d,12),f.writeInt32BE(0|this._e,16),f},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(e,n,s){var a=e("inherits"),i=e("./hash"),o=e("safe-buffer").Buffer,l=[1518500249,1859775393,-1894007588,-899497514],c=new Array(80);function u(){this.init(),this._w=c,i.call(this,64,56)}function d(g){return g<<5|g>>>27}function h(g){return g<<30|g>>>2}function f(g,m,p,v){return g===0?m&p|~m&v:g===2?m&p|m&v|p&v:m^p^v}a(u,i),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(g){for(var m,p=this._w,v=0|this._a,b=0|this._b,y=0|this._c,k=0|this._d,N=0|this._e,L=0;L<16;++L)p[L]=g.readInt32BE(4*L);for(;L<80;++L)p[L]=(m=p[L-3]^p[L-8]^p[L-14]^p[L-16])<<1|m>>>31;for(var F=0;F<80;++F){var R=~~(F/20),B=d(v)+f(R,b,y,k)+N+p[F]+l[R]|0;N=k,k=y,y=h(b),b=v,v=B}this._a=v+this._a|0,this._b=b+this._b|0,this._c=y+this._c|0,this._d=k+this._d|0,this._e=N+this._e|0},u.prototype._hash=function(){var g=o.allocUnsafe(20);return g.writeInt32BE(0|this._a,0),g.writeInt32BE(0|this._b,4),g.writeInt32BE(0|this._c,8),g.writeInt32BE(0|this._d,12),g.writeInt32BE(0|this._e,16),g},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(e,n,s){var a=e("inherits"),i=e("./sha256"),o=e("./hash"),l=e("safe-buffer").Buffer,c=new Array(64);function u(){this.init(),this._w=c,o.call(this,64,56)}a(u,i),u.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},u.prototype._hash=function(){var d=l.allocUnsafe(28);return d.writeInt32BE(this._a,0),d.writeInt32BE(this._b,4),d.writeInt32BE(this._c,8),d.writeInt32BE(this._d,12),d.writeInt32BE(this._e,16),d.writeInt32BE(this._f,20),d.writeInt32BE(this._g,24),d},n.exports=u},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(e,n,s){var a=e("inherits"),i=e("./hash"),o=e("safe-buffer").Buffer,l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],c=new Array(64);function u(){this.init(),this._w=c,i.call(this,64,56)}function d(p,v,b){return b^p&(v^b)}function h(p,v,b){return p&v|b&(p|v)}function f(p){return(p>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10)}function g(p){return(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7)}function m(p){return(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3}a(u,i),u.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},u.prototype._update=function(p){for(var v,b=this._w,y=0|this._a,k=0|this._b,N=0|this._c,L=0|this._d,F=0|this._e,R=0|this._f,B=0|this._g,q=0|this._h,V=0;V<16;++V)b[V]=p.readInt32BE(4*V);for(;V<64;++V)b[V]=0|(((v=b[V-2])>>>17|v<<15)^(v>>>19|v<<13)^v>>>10)+b[V-7]+m(b[V-15])+b[V-16];for(var I=0;I<64;++I){var C=q+g(F)+d(F,R,B)+l[I]+b[I]|0,O=f(y)+h(y,k,N)|0;q=B,B=R,R=F,F=L+C|0,L=N,N=k,k=y,y=C+O|0}this._a=y+this._a|0,this._b=k+this._b|0,this._c=N+this._c|0,this._d=L+this._d|0,this._e=F+this._e|0,this._f=R+this._f|0,this._g=B+this._g|0,this._h=q+this._h|0},u.prototype._hash=function(){var p=o.allocUnsafe(32);return p.writeInt32BE(this._a,0),p.writeInt32BE(this._b,4),p.writeInt32BE(this._c,8),p.writeInt32BE(this._d,12),p.writeInt32BE(this._e,16),p.writeInt32BE(this._f,20),p.writeInt32BE(this._g,24),p.writeInt32BE(this._h,28),p},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(e,n,s){var a=e("inherits"),i=e("./sha512"),o=e("./hash"),l=e("safe-buffer").Buffer,c=new Array(160);function u(){this.init(),this._w=c,o.call(this,128,112)}a(u,i),u.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},u.prototype._hash=function(){var d=l.allocUnsafe(48);function h(f,g,m){d.writeInt32BE(f,m),d.writeInt32BE(g,m+4)}return h(this._ah,this._al,0),h(this._bh,this._bl,8),h(this._ch,this._cl,16),h(this._dh,this._dl,24),h(this._eh,this._el,32),h(this._fh,this._fl,40),d},n.exports=u},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(e,n,s){var a=e("inherits"),i=e("./hash"),o=e("safe-buffer").Buffer,l=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],c=new Array(160);function u(){this.init(),this._w=c,i.call(this,128,112)}function d(k,N,L){return L^k&(N^L)}function h(k,N,L){return k&N|L&(k|N)}function f(k,N){return(k>>>28|N<<4)^(N>>>2|k<<30)^(N>>>7|k<<25)}function g(k,N){return(k>>>14|N<<18)^(k>>>18|N<<14)^(N>>>9|k<<23)}function m(k,N){return(k>>>1|N<<31)^(k>>>8|N<<24)^k>>>7}function p(k,N){return(k>>>1|N<<31)^(k>>>8|N<<24)^(k>>>7|N<<25)}function v(k,N){return(k>>>19|N<<13)^(N>>>29|k<<3)^k>>>6}function b(k,N){return(k>>>19|N<<13)^(N>>>29|k<<3)^(k>>>6|N<<26)}function y(k,N){return k>>>0<N>>>0?1:0}a(u,i),u.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},u.prototype._update=function(k){for(var N=this._w,L=0|this._ah,F=0|this._bh,R=0|this._ch,B=0|this._dh,q=0|this._eh,V=0|this._fh,I=0|this._gh,C=0|this._hh,O=0|this._al,E=0|this._bl,x=0|this._cl,w=0|this._dl,_=0|this._el,S=0|this._fl,T=0|this._gl,U=0|this._hl,A=0;A<32;A+=2)N[A]=k.readInt32BE(4*A),N[A+1]=k.readInt32BE(4*A+4);for(;A<160;A+=2){var H=N[A-30],z=N[A-30+1],K=m(H,z),j=p(z,H),J=v(H=N[A-4],z=N[A-4+1]),P=b(z,H),D=N[A-14],G=N[A-14+1],re=N[A-32],te=N[A-32+1],ne=j+G|0,le=K+D+y(ne,j)|0;le=(le=le+J+y(ne=ne+P|0,P)|0)+re+y(ne=ne+te|0,te)|0,N[A]=le,N[A+1]=ne}for(var oe=0;oe<160;oe+=2){le=N[oe],ne=N[oe+1];var ee=h(L,F,R),Z=h(O,E,x),se=f(L,O),ie=f(O,L),ue=g(q,_),pe=g(_,q),fe=l[oe],ye=l[oe+1],Te=d(q,V,I),Pe=d(_,S,T),je=U+pe|0,qe=C+ue+y(je,U)|0;qe=(qe=(qe=qe+Te+y(je=je+Pe|0,Pe)|0)+fe+y(je=je+ye|0,ye)|0)+le+y(je=je+ne|0,ne)|0;var We=ie+Z|0,at=se+ee+y(We,ie)|0;C=I,U=T,I=V,T=S,V=q,S=_,q=B+qe+y(_=w+je|0,w)|0,B=R,w=x,R=F,x=E,F=L,E=O,L=qe+at+y(O=je+We|0,je)|0}this._al=this._al+O|0,this._bl=this._bl+E|0,this._cl=this._cl+x|0,this._dl=this._dl+w|0,this._el=this._el+_|0,this._fl=this._fl+S|0,this._gl=this._gl+T|0,this._hl=this._hl+U|0,this._ah=this._ah+L+y(this._al,O)|0,this._bh=this._bh+F+y(this._bl,E)|0,this._ch=this._ch+R+y(this._cl,x)|0,this._dh=this._dh+B+y(this._dl,w)|0,this._eh=this._eh+q+y(this._el,_)|0,this._fh=this._fh+V+y(this._fl,S)|0,this._gh=this._gh+I+y(this._gl,T)|0,this._hh=this._hh+C+y(this._hl,U)|0},u.prototype._hash=function(){var k=o.allocUnsafe(64);function N(L,F,R){k.writeInt32BE(L,R),k.writeInt32BE(F,R+4)}return N(this._ah,this._al,0),N(this._bh,this._bl,8),N(this._ch,this._cl,16),N(this._dh,this._dl,24),N(this._eh,this._el,32),N(this._fh,this._fl,40),N(this._gh,this._gl,48),N(this._hh,this._hl,56),k},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(e,n,s){n.exports=i;var a=e("events").EventEmitter;function i(){a.call(this)}e("inherits")(i,a),i.Readable=e("readable-stream/readable.js"),i.Writable=e("readable-stream/writable.js"),i.Duplex=e("readable-stream/duplex.js"),i.Transform=e("readable-stream/transform.js"),i.PassThrough=e("readable-stream/passthrough.js"),i.Stream=i,i.prototype.pipe=function(o,l){var c=this;function u(v){o.writable&&o.write(v)===!1&&c.pause&&c.pause()}function d(){c.readable&&c.resume&&c.resume()}c.on("data",u),o.on("drain",d),o._isStdio||l&&l.end===!1||(c.on("end",f),c.on("close",g));var h=!1;function f(){h||(h=!0,o.end())}function g(){h||(h=!0,typeof o.destroy=="function"&&o.destroy())}function m(v){if(p(),a.listenerCount(this,"error")===0)throw v}function p(){c.removeListener("data",u),o.removeListener("drain",d),c.removeListener("end",f),c.removeListener("close",g),c.removeListener("error",m),o.removeListener("error",m),c.removeListener("end",p),c.removeListener("close",p),o.removeListener("close",p)}return c.on("error",m),o.on("error",m),c.on("end",p),c.on("close",p),o.on("close",p),o.emit("pipe",c),o}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(e,n,s){var a={}.toString;n.exports=Array.isArray||function(i){return a.call(i)=="[object Array]"}},{}],507:[function(e,n,s){n.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(e,n,s){var a=e("process-nextick-args"),i=Object.keys||function(p){var v=[];for(var b in p)v.push(b);return v};n.exports=f;var o=Object.create(e("core-util-is"));o.inherits=e("inherits");var l=e("./_stream_readable"),c=e("./_stream_writable");o.inherits(f,l);for(var u=i(c.prototype),d=0;d<u.length;d++){var h=u[d];f.prototype[h]||(f.prototype[h]=c.prototype[h])}function f(p){if(!(this instanceof f))return new f(p);l.call(this,p),c.call(this,p),p&&p.readable===!1&&(this.readable=!1),p&&p.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,p&&p.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",g)}function g(){this.allowHalfOpen||this._writableState.ended||a.nextTick(m,this)}function m(p){p.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(p){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=p,this._writableState.destroyed=p)}}),f.prototype._destroy=function(p,v){this.push(null),this.end(),a.nextTick(v,p)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(e,n,s){n.exports=o;var a=e("./_stream_transform"),i=Object.create(e("core-util-is"));function o(l){if(!(this instanceof o))return new o(l);a.call(this,l)}i.inherits=e("inherits"),i.inherits(o,a),o.prototype._transform=function(l,c,u){u(null,l)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(e,n,s){(function(a,i){(function(){var o=e("process-nextick-args");n.exports=L;var l,c=e("isarray");L.ReadableState=N,e("events").EventEmitter;var u=function(U,A){return U.listeners(A).length},d=e("./internal/streams/stream"),h=e("safe-buffer").Buffer,f=(i!==void 0?i:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},g=Object.create(e("core-util-is"));g.inherits=e("inherits");var m=e("util"),p=void 0;p=m&&m.debuglog?m.debuglog("stream"):function(){};var v,b=e("./internal/streams/BufferList"),y=e("./internal/streams/destroy");g.inherits(L,d);var k=["error","close","destroy","pause","resume"];function N(U,A){U=U||{};var H=A instanceof(l=l||e("./_stream_duplex"));this.objectMode=!!U.objectMode,H&&(this.objectMode=this.objectMode||!!U.readableObjectMode);var z=U.highWaterMark,K=U.readableHighWaterMark,j=this.objectMode?16:16384;this.highWaterMark=z||z===0?z:H&&(K||K===0)?K:j,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new b,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=U.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,U.encoding&&(v||(v=e("string_decoder/").StringDecoder),this.decoder=new v(U.encoding),this.encoding=U.encoding)}function L(U){if(l=l||e("./_stream_duplex"),!(this instanceof L))return new L(U);this._readableState=new N(U,this),this.readable=!0,U&&(typeof U.read=="function"&&(this._read=U.read),typeof U.destroy=="function"&&(this._destroy=U.destroy)),d.call(this)}function F(U,A,H,z,K){var j,J=U._readableState;return A===null?(J.reading=!1,function(P,D){if(!D.ended){if(D.decoder){var G=D.decoder.end();G&&G.length&&(D.buffer.push(G),D.length+=D.objectMode?1:G.length)}D.ended=!0,q(P)}}(U,J)):(K||(j=function(P,D){var G;re=D,h.isBuffer(re)||re instanceof f||typeof D=="string"||D===void 0||P.objectMode||(G=new TypeError("Invalid non-string/buffer chunk"));var re;return G}(J,A)),j?U.emit("error",j):J.objectMode||A&&A.length>0?(typeof A=="string"||J.objectMode||Object.getPrototypeOf(A)===h.prototype||(A=function(P){return h.from(P)}(A)),z?J.endEmitted?U.emit("error",new Error("stream.unshift() after end event")):R(U,J,A,!0):J.ended?U.emit("error",new Error("stream.push() after EOF")):(J.reading=!1,J.decoder&&!H?(A=J.decoder.write(A),J.objectMode||A.length!==0?R(U,J,A,!1):I(U,J)):R(U,J,A,!1))):z||(J.reading=!1)),function(P){return!P.ended&&(P.needReadable||P.length<P.highWaterMark||P.length===0)}(J)}function R(U,A,H,z){A.flowing&&A.length===0&&!A.sync?(U.emit("data",H),U.read(0)):(A.length+=A.objectMode?1:H.length,z?A.buffer.unshift(H):A.buffer.push(H),A.needReadable&&q(U)),I(U,A)}Object.defineProperty(L.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(U){this._readableState&&(this._readableState.destroyed=U)}}),L.prototype.destroy=y.destroy,L.prototype._undestroy=y.undestroy,L.prototype._destroy=function(U,A){this.push(null),A(U)},L.prototype.push=function(U,A){var H,z=this._readableState;return z.objectMode?H=!0:typeof U=="string"&&((A=A||z.defaultEncoding)!==z.encoding&&(U=h.from(U,A),A=""),H=!0),F(this,U,A,!1,H)},L.prototype.unshift=function(U){return F(this,U,null,!0,!1)},L.prototype.isPaused=function(){return this._readableState.flowing===!1},L.prototype.setEncoding=function(U){return v||(v=e("string_decoder/").StringDecoder),this._readableState.decoder=new v(U),this._readableState.encoding=U,this};function B(U,A){return U<=0||A.length===0&&A.ended?0:A.objectMode?1:U!=U?A.flowing&&A.length?A.buffer.head.data.length:A.length:(U>A.highWaterMark&&(A.highWaterMark=function(H){return H>=8388608?H=8388608:(H--,H|=H>>>1,H|=H>>>2,H|=H>>>4,H|=H>>>8,H|=H>>>16,H++),H}(U)),U<=A.length?U:A.ended?A.length:(A.needReadable=!0,0))}function q(U){var A=U._readableState;A.needReadable=!1,A.emittedReadable||(p("emitReadable",A.flowing),A.emittedReadable=!0,A.sync?o.nextTick(V,U):V(U))}function V(U){p("emit readable"),U.emit("readable"),x(U)}function I(U,A){A.readingMore||(A.readingMore=!0,o.nextTick(C,U,A))}function C(U,A){for(var H=A.length;!A.reading&&!A.flowing&&!A.ended&&A.length<A.highWaterMark&&(p("maybeReadMore read 0"),U.read(0),H!==A.length);)H=A.length;A.readingMore=!1}function O(U){p("readable nexttick read 0"),U.read(0)}function E(U,A){A.reading||(p("resume read 0"),U.read(0)),A.resumeScheduled=!1,A.awaitDrain=0,U.emit("resume"),x(U),A.flowing&&!A.reading&&U.read(0)}function x(U){var A=U._readableState;for(p("flow",A.flowing);A.flowing&&U.read()!==null;);}function w(U,A){return A.length===0?null:(A.objectMode?H=A.buffer.shift():!U||U>=A.length?(H=A.decoder?A.buffer.join(""):A.buffer.length===1?A.buffer.head.data:A.buffer.concat(A.length),A.buffer.clear()):H=function(z,K,j){var J;return z<K.head.data.length?(J=K.head.data.slice(0,z),K.head.data=K.head.data.slice(z)):J=z===K.head.data.length?K.shift():j?function(P,D){var G=D.head,re=1,te=G.data;for(P-=te.length;G=G.next;){var ne=G.data,le=P>ne.length?ne.length:P;if(le===ne.length?te+=ne:te+=ne.slice(0,P),(P-=le)===0){le===ne.length?(++re,G.next?D.head=G.next:D.head=D.tail=null):(D.head=G,G.data=ne.slice(le));break}++re}return D.length-=re,te}(z,K):function(P,D){var G=h.allocUnsafe(P),re=D.head,te=1;for(re.data.copy(G),P-=re.data.length;re=re.next;){var ne=re.data,le=P>ne.length?ne.length:P;if(ne.copy(G,G.length-P,0,le),(P-=le)===0){le===ne.length?(++te,re.next?D.head=re.next:D.head=D.tail=null):(D.head=re,re.data=ne.slice(le));break}++te}return D.length-=te,G}(z,K),J}(U,A.buffer,A.decoder),H);var H}function _(U){var A=U._readableState;if(A.length>0)throw new Error('"endReadable()" called on non-empty stream');A.endEmitted||(A.ended=!0,o.nextTick(S,A,U))}function S(U,A){U.endEmitted||U.length!==0||(U.endEmitted=!0,A.readable=!1,A.emit("end"))}function T(U,A){for(var H=0,z=U.length;H<z;H++)if(U[H]===A)return H;return-1}L.prototype.read=function(U){p("read",U),U=parseInt(U,10);var A=this._readableState,H=U;if(U!==0&&(A.emittedReadable=!1),U===0&&A.needReadable&&(A.length>=A.highWaterMark||A.ended))return p("read: emitReadable",A.length,A.ended),A.length===0&&A.ended?_(this):q(this),null;if((U=B(U,A))===0&&A.ended)return A.length===0&&_(this),null;var z,K=A.needReadable;return p("need readable",K),(A.length===0||A.length-U<A.highWaterMark)&&p("length less than watermark",K=!0),A.ended||A.reading?p("reading or ended",K=!1):K&&(p("do read"),A.reading=!0,A.sync=!0,A.length===0&&(A.needReadable=!0),this._read(A.highWaterMark),A.sync=!1,A.reading||(U=B(H,A))),(z=U>0?w(U,A):null)===null?(A.needReadable=!0,U=0):A.length-=U,A.length===0&&(A.ended||(A.needReadable=!0),H!==U&&A.ended&&_(this)),z!==null&&this.emit("data",z),z},L.prototype._read=function(U){this.emit("error",new Error("_read() is not implemented"))},L.prototype.pipe=function(U,A){var H=this,z=this._readableState;switch(z.pipesCount){case 0:z.pipes=U;break;case 1:z.pipes=[z.pipes,U];break;default:z.pipes.push(U)}z.pipesCount+=1,p("pipe count=%d opts=%j",z.pipesCount,A);var K=(!A||A.end!==!1)&&U!==a.stdout&&U!==a.stderr?J:oe;function j(ee,Z){p("onunpipe"),ee===H&&Z&&Z.hasUnpiped===!1&&(Z.hasUnpiped=!0,p("cleanup"),U.removeListener("close",ne),U.removeListener("finish",le),U.removeListener("drain",P),U.removeListener("error",te),U.removeListener("unpipe",j),H.removeListener("end",J),H.removeListener("end",oe),H.removeListener("data",re),D=!0,!z.awaitDrain||U._writableState&&!U._writableState.needDrain||P())}function J(){p("onend"),U.end()}z.endEmitted?o.nextTick(K):H.once("end",K),U.on("unpipe",j);var P=function(ee){return function(){var Z=ee._readableState;p("pipeOnDrain",Z.awaitDrain),Z.awaitDrain&&Z.awaitDrain--,Z.awaitDrain===0&&u(ee,"data")&&(Z.flowing=!0,x(ee))}}(H);U.on("drain",P);var D=!1,G=!1;function re(ee){p("ondata"),G=!1,U.write(ee)!==!1||G||((z.pipesCount===1&&z.pipes===U||z.pipesCount>1&&T(z.pipes,U)!==-1)&&!D&&(p("false write response, pause",z.awaitDrain),z.awaitDrain++,G=!0),H.pause())}function te(ee){p("onerror",ee),oe(),U.removeListener("error",te),u(U,"error")===0&&U.emit("error",ee)}function ne(){U.removeListener("finish",le),oe()}function le(){p("onfinish"),U.removeListener("close",ne),oe()}function oe(){p("unpipe"),H.unpipe(U)}return H.on("data",re),function(ee,Z,se){if(typeof ee.prependListener=="function")return ee.prependListener(Z,se);ee._events&&ee._events[Z]?c(ee._events[Z])?ee._events[Z].unshift(se):ee._events[Z]=[se,ee._events[Z]]:ee.on(Z,se)}(U,"error",te),U.once("close",ne),U.once("finish",le),U.emit("pipe",H),z.flowing||(p("pipe resume"),H.resume()),U},L.prototype.unpipe=function(U){var A=this._readableState,H={hasUnpiped:!1};if(A.pipesCount===0)return this;if(A.pipesCount===1)return U&&U!==A.pipes||(U||(U=A.pipes),A.pipes=null,A.pipesCount=0,A.flowing=!1,U&&U.emit("unpipe",this,H)),this;if(!U){var z=A.pipes,K=A.pipesCount;A.pipes=null,A.pipesCount=0,A.flowing=!1;for(var j=0;j<K;j++)z[j].emit("unpipe",this,{hasUnpiped:!1});return this}var J=T(A.pipes,U);return J===-1||(A.pipes.splice(J,1),A.pipesCount-=1,A.pipesCount===1&&(A.pipes=A.pipes[0]),U.emit("unpipe",this,H)),this},L.prototype.on=function(U,A){var H=d.prototype.on.call(this,U,A);if(U==="data")this._readableState.flowing!==!1&&this.resume();else if(U==="readable"){var z=this._readableState;z.endEmitted||z.readableListening||(z.readableListening=z.needReadable=!0,z.emittedReadable=!1,z.reading?z.length&&q(this):o.nextTick(O,this))}return H},L.prototype.addListener=L.prototype.on,L.prototype.resume=function(){var U=this._readableState;return U.flowing||(p("resume"),U.flowing=!0,function(A,H){H.resumeScheduled||(H.resumeScheduled=!0,o.nextTick(E,A,H))}(this,U)),this},L.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},L.prototype.wrap=function(U){var A=this,H=this._readableState,z=!1;for(var K in U.on("end",function(){if(p("wrapped end"),H.decoder&&!H.ended){var J=H.decoder.end();J&&J.length&&A.push(J)}A.push(null)}),U.on("data",function(J){p("wrapped data"),H.decoder&&(J=H.decoder.write(J)),H.objectMode&&J==null||(H.objectMode||J&&J.length)&&(A.push(J)||(z=!0,U.pause()))}),U)this[K]===void 0&&typeof U[K]=="function"&&(this[K]=function(J){return function(){return U[J].apply(U,arguments)}}(K));for(var j=0;j<k.length;j++)U.on(k[j],this.emit.bind(this,k[j]));return this._read=function(J){p("wrapped _read",J),z&&(z=!1,U.resume())},this},Object.defineProperty(L.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),L._fromList=w}).call(this)}).call(this,e("_process"),typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(e,n,s){n.exports=l;var a=e("./_stream_duplex"),i=Object.create(e("core-util-is"));function o(d,h){var f=this._transformState;f.transforming=!1;var g=f.writecb;if(!g)return this.emit("error",new Error("write callback called multiple times"));f.writechunk=null,f.writecb=null,h!=null&&this.push(h),g(d);var m=this._readableState;m.reading=!1,(m.needReadable||m.length<m.highWaterMark)&&this._read(m.highWaterMark)}function l(d){if(!(this instanceof l))return new l(d);a.call(this,d),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,d&&(typeof d.transform=="function"&&(this._transform=d.transform),typeof d.flush=="function"&&(this._flush=d.flush)),this.on("prefinish",c)}function c(){var d=this;typeof this._flush=="function"?this._flush(function(h,f){u(d,h,f)}):u(this,null,null)}function u(d,h,f){if(h)return d.emit("error",h);if(f!=null&&d.push(f),d._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(d._transformState.transforming)throw new Error("Calling transform done when still transforming");return d.push(null)}i.inherits=e("inherits"),i.inherits(l,a),l.prototype.push=function(d,h){return this._transformState.needTransform=!1,a.prototype.push.call(this,d,h)},l.prototype._transform=function(d,h,f){throw new Error("_transform() is not implemented")},l.prototype._write=function(d,h,f){var g=this._transformState;if(g.writecb=f,g.writechunk=d,g.writeencoding=h,!g.transforming){var m=this._readableState;(g.needTransform||m.needReadable||m.length<m.highWaterMark)&&this._read(m.highWaterMark)}},l.prototype._read=function(d){var h=this._transformState;h.writechunk!==null&&h.writecb&&!h.transforming?(h.transforming=!0,this._transform(h.writechunk,h.writeencoding,h.afterTransform)):h.needTransform=!0},l.prototype._destroy=function(d,h){var f=this;a.prototype._destroy.call(this,d,function(g){h(g),f.emit("close")})}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(e,n,s){(function(a,i,o){(function(){var l=e("process-nextick-args");function c(I){var C=this;this.next=null,this.entry=null,this.finish=function(){(function(O,E,x){var w=O.entry;for(O.entry=null;w;){var _=w.callback;E.pendingcb--,_(x),w=w.next}E.corkedRequestsFree.next=O})(C,I)}}n.exports=N;var u,d=!a.browser&&["v0.10","v0.9."].indexOf(a.version.slice(0,5))>-1?o:l.nextTick;N.WritableState=k;var h=Object.create(e("core-util-is"));h.inherits=e("inherits");var f={deprecate:e("util-deprecate")},g=e("./internal/streams/stream"),m=e("safe-buffer").Buffer,p=(i!==void 0?i:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},v,b=e("./internal/streams/destroy");function y(){}function k(I,C){u=u||e("./_stream_duplex"),I=I||{};var O=C instanceof u;this.objectMode=!!I.objectMode,O&&(this.objectMode=this.objectMode||!!I.writableObjectMode);var E=I.highWaterMark,x=I.writableHighWaterMark,w=this.objectMode?16:16384;this.highWaterMark=E||E===0?E:O&&(x||x===0)?x:w,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var _=I.decodeStrings===!1;this.decodeStrings=!_,this.defaultEncoding=I.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(S){(function(T,U){var A=T._writableState,H=A.sync,z=A.writecb;if(function(j){j.writing=!1,j.writecb=null,j.length-=j.writelen,j.writelen=0}(A),U)(function(j,J,P,D,G){--J.pendingcb,P?(l.nextTick(G,D),l.nextTick(V,j,J),j._writableState.errorEmitted=!0,j.emit("error",D)):(G(D),j._writableState.errorEmitted=!0,j.emit("error",D),V(j,J))})(T,A,H,U,z);else{var K=B(A);K||A.corked||A.bufferProcessing||!A.bufferedRequest||R(T,A),H?d(F,T,A,K,z):F(T,A,K,z)}})(C,S)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new c(this)}function N(I){if(u=u||e("./_stream_duplex"),!(v.call(N,this)||this instanceof u))return new N(I);this._writableState=new k(I,this),this.writable=!0,I&&(typeof I.write=="function"&&(this._write=I.write),typeof I.writev=="function"&&(this._writev=I.writev),typeof I.destroy=="function"&&(this._destroy=I.destroy),typeof I.final=="function"&&(this._final=I.final)),g.call(this)}function L(I,C,O,E,x,w,_){C.writelen=E,C.writecb=_,C.writing=!0,C.sync=!0,O?I._writev(x,C.onwrite):I._write(x,w,C.onwrite),C.sync=!1}function F(I,C,O,E){O||function(x,w){w.length===0&&w.needDrain&&(w.needDrain=!1,x.emit("drain"))}(I,C),C.pendingcb--,E(),V(I,C)}function R(I,C){C.bufferProcessing=!0;var O=C.bufferedRequest;if(I._writev&&O&&O.next){var E=C.bufferedRequestCount,x=new Array(E),w=C.corkedRequestsFree;w.entry=O;for(var _=0,S=!0;O;)x[_]=O,O.isBuf||(S=!1),O=O.next,_+=1;x.allBuffers=S,L(I,C,!0,C.length,x,"",w.finish),C.pendingcb++,C.lastBufferedRequest=null,w.next?(C.corkedRequestsFree=w.next,w.next=null):C.corkedRequestsFree=new c(C),C.bufferedRequestCount=0}else{for(;O;){var T=O.chunk,U=O.encoding,A=O.callback;if(L(I,C,!1,C.objectMode?1:T.length,T,U,A),O=O.next,C.bufferedRequestCount--,C.writing)break}O===null&&(C.lastBufferedRequest=null)}C.bufferedRequest=O,C.bufferProcessing=!1}function B(I){return I.ending&&I.length===0&&I.bufferedRequest===null&&!I.finished&&!I.writing}function q(I,C){I._final(function(O){C.pendingcb--,O&&I.emit("error",O),C.prefinished=!0,I.emit("prefinish"),V(I,C)})}function V(I,C){var O=B(C);return O&&(function(E,x){x.prefinished||x.finalCalled||(typeof E._final=="function"?(x.pendingcb++,x.finalCalled=!0,l.nextTick(q,E,x)):(x.prefinished=!0,E.emit("prefinish")))}(I,C),C.pendingcb===0&&(C.finished=!0,I.emit("finish"))),O}h.inherits(N,g),k.prototype.getBuffer=function(){for(var I=this.bufferedRequest,C=[];I;)C.push(I),I=I.next;return C},function(){try{Object.defineProperty(k.prototype,"buffer",{get:f.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(v=Function.prototype[Symbol.hasInstance],Object.defineProperty(N,Symbol.hasInstance,{value:function(I){return!!v.call(this,I)||this===N&&I&&I._writableState instanceof k}})):v=function(I){return I instanceof this},N.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},N.prototype.write=function(I,C,O){var E,x=this._writableState,w=!1,_=!x.objectMode&&(E=I,m.isBuffer(E)||E instanceof p);return _&&!m.isBuffer(I)&&(I=function(S){return m.from(S)}(I)),typeof C=="function"&&(O=C,C=null),_?C="buffer":C||(C=x.defaultEncoding),typeof O!="function"&&(O=y),x.ended?function(S,T){var U=new Error("write after end");S.emit("error",U),l.nextTick(T,U)}(this,O):(_||function(S,T,U,A){var H=!0,z=!1;return U===null?z=new TypeError("May not write null values to stream"):typeof U=="string"||U===void 0||T.objectMode||(z=new TypeError("Invalid non-string/buffer chunk")),z&&(S.emit("error",z),l.nextTick(A,z),H=!1),H}(this,x,I,O))&&(x.pendingcb++,w=function(S,T,U,A,H,z){if(!U){var K=function(D,G,re){return D.objectMode||D.decodeStrings===!1||typeof G!="string"||(G=m.from(G,re)),G}(T,A,H);A!==K&&(U=!0,H="buffer",A=K)}var j=T.objectMode?1:A.length;T.length+=j;var J=T.length<T.highWaterMark;if(J||(T.needDrain=!0),T.writing||T.corked){var P=T.lastBufferedRequest;T.lastBufferedRequest={chunk:A,encoding:H,isBuf:U,callback:z,next:null},P?P.next=T.lastBufferedRequest:T.bufferedRequest=T.lastBufferedRequest,T.bufferedRequestCount+=1}else L(S,T,!1,j,A,H,z);return J}(this,x,_,I,C,O)),w},N.prototype.cork=function(){this._writableState.corked++},N.prototype.uncork=function(){var I=this._writableState;I.corked&&(I.corked--,I.writing||I.corked||I.bufferProcessing||!I.bufferedRequest||R(this,I))},N.prototype.setDefaultEncoding=function(I){if(typeof I=="string"&&(I=I.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((I+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+I);return this._writableState.defaultEncoding=I,this},Object.defineProperty(N.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),N.prototype._write=function(I,C,O){O(new Error("_write() is not implemented"))},N.prototype._writev=null,N.prototype.end=function(I,C,O){var E=this._writableState;typeof I=="function"?(O=I,I=null,C=null):typeof C=="function"&&(O=C,C=null),I!=null&&this.write(I,C),E.corked&&(E.corked=1,this.uncork()),E.ending||function(x,w,_){w.ending=!0,V(x,w),_&&(w.finished?l.nextTick(_):x.once("finish",_)),w.ended=!0,x.writable=!1}(this,E,O)},Object.defineProperty(N.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(I){this._writableState&&(this._writableState.destroyed=I)}}),N.prototype.destroy=b.destroy,N.prototype._undestroy=b.undestroy,N.prototype._destroy=function(I,C){this.end(),C(I)}}).call(this)}).call(this,e("_process"),typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{},e("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(e,n,s){var a=e("safe-buffer").Buffer,i=e("util");n.exports=function(){function o(){(function(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")})(this,o),this.head=null,this.tail=null,this.length=0}return o.prototype.push=function(l){var c={data:l,next:null};this.length>0?this.tail.next=c:this.head=c,this.tail=c,++this.length},o.prototype.unshift=function(l){var c={data:l,next:this.head};this.length===0&&(this.tail=c),this.head=c,++this.length},o.prototype.shift=function(){if(this.length!==0){var l=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,l}},o.prototype.clear=function(){this.head=this.tail=null,this.length=0},o.prototype.join=function(l){if(this.length===0)return"";for(var c=this.head,u=""+c.data;c=c.next;)u+=l+c.data;return u},o.prototype.concat=function(l){if(this.length===0)return a.alloc(0);for(var c,u,d,h=a.allocUnsafe(l>>>0),f=this.head,g=0;f;)c=f.data,u=h,d=g,c.copy(u,d),g+=f.data.length,f=f.next;return h},o}(),i&&i.inspect&&i.inspect.custom&&(n.exports.prototype[i.inspect.custom]=function(){var o=i.inspect({length:this.length});return this.constructor.name+" "+o})},{"safe-buffer":520,util:188}],514:[function(e,n,s){var a=e("process-nextick-args");function i(o,l){o.emit("error",l)}n.exports={destroy:function(o,l){var c=this,u=this._readableState&&this._readableState.destroyed,d=this._writableState&&this._writableState.destroyed;return u||d?(l?l(o):o&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,a.nextTick(i,this,o)):a.nextTick(i,this,o)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(o||null,function(h){!l&&h?c._writableState?c._writableState.errorEmitted||(c._writableState.errorEmitted=!0,a.nextTick(i,c,h)):a.nextTick(i,c,h):l&&l(h)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(e,n,s){arguments[4][490][0].apply(s,arguments)},{dup:490,events:422}],516:[function(e,n,s){n.exports=e("./readable").PassThrough},{"./readable":517}],517:[function(e,n,s){(s=n.exports=e("./lib/_stream_readable.js")).Stream=s,s.Readable=s,s.Writable=e("./lib/_stream_writable.js"),s.Duplex=e("./lib/_stream_duplex.js"),s.Transform=e("./lib/_stream_transform.js"),s.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(e,n,s){n.exports=e("./readable").Transform},{"./readable":517}],519:[function(e,n,s){n.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(e,n,s){arguments[4][217][0].apply(s,arguments)},{buffer:220,dup:217}],521:[function(e,n,s){arguments[4][218][0].apply(s,arguments)},{dup:218,"safe-buffer":520}],522:[function(e,n,s){arguments[4][218][0].apply(s,arguments)},{dup:218,"safe-buffer":494}],523:[function(e,n,s){(function(a,i){(function(){var o=e("process/browser.js").nextTick,l=Function.prototype.apply,c=Array.prototype.slice,u={},d=0;function h(f,g){this._id=f,this._clearFn=g}s.setTimeout=function(){return new h(l.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new h(l.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(f){f.close()},h.prototype.unref=h.prototype.ref=function(){},h.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(f,g){clearTimeout(f._idleTimeoutId),f._idleTimeout=g},s.unenroll=function(f){clearTimeout(f._idleTimeoutId),f._idleTimeout=-1},s._unrefActive=s.active=function(f){clearTimeout(f._idleTimeoutId);var g=f._idleTimeout;g>=0&&(f._idleTimeoutId=setTimeout(function(){f._onTimeout&&f._onTimeout()},g))},s.setImmediate=typeof a=="function"?a:function(f){var g=d++,m=!(arguments.length<2)&&c.call(arguments,1);return u[g]=!0,o(function(){u[g]&&(m?f.apply(null,m):f.call(null),s.clearImmediate(g))}),g},s.clearImmediate=typeof i=="function"?i:function(f){delete u[f]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(e,n,s){(function(a){(function(){function i(o){try{if(!a.localStorage)return!1}catch{return!1}var l=a.localStorage[o];return l!=null&&String(l).toLowerCase()==="true"}n.exports=function(o,l){if(i("noDeprecation"))return o;var c=!1;return function(){if(!c){if(i("throwDeprecation"))throw new Error(l);i("traceDeprecation")?console.trace(l):console.warn(l),c=!0}return o.apply(this,arguments)}}}).call(this)}).call(this,typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(e,n,s){typeof Object.create=="function"?n.exports=function(a,i){a.super_=i,a.prototype=Object.create(i.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(a,i){a.super_=i;var o=function(){};o.prototype=i.prototype,a.prototype=new o,a.prototype.constructor=a}},{}],526:[function(e,n,s){n.exports=function(a){return a&&typeof a=="object"&&typeof a.copy=="function"&&typeof a.fill=="function"&&typeof a.readUInt8=="function"}},{}],527:[function(e,n,s){(function(a,i){(function(){var o=/%[sdj%]/g;s.format=function(x){if(!k(x)){for(var w=[],_=0;_<arguments.length;_++)w.push(u(arguments[_]));return w.join(" ")}_=1;for(var S=arguments,T=S.length,U=String(x).replace(o,function(H){if(H==="%%")return"%";if(_>=T)return H;switch(H){case"%s":return String(S[_++]);case"%d":return Number(S[_++]);case"%j":try{return JSON.stringify(S[_++])}catch{return"[Circular]"}default:return H}}),A=S[_];_<T;A=S[++_])b(A)||!F(A)?U+=" "+A:U+=" "+u(A);return U},s.deprecate=function(x,w){if(N(i.process))return function(){return s.deprecate(x,w).apply(this,arguments)};if(a.noDeprecation===!0)return x;var _=!1;return function(){if(!_){if(a.throwDeprecation)throw new Error(w);a.traceDeprecation?console.trace(w):console.error(w),_=!0}return x.apply(this,arguments)}};var l,c={};function u(x,w){var _={seen:[],stylize:h};return arguments.length>=3&&(_.depth=arguments[2]),arguments.length>=4&&(_.colors=arguments[3]),v(w)?_.showHidden=w:w&&s._extend(_,w),N(_.showHidden)&&(_.showHidden=!1),N(_.depth)&&(_.depth=2),N(_.colors)&&(_.colors=!1),N(_.customInspect)&&(_.customInspect=!0),_.colors&&(_.stylize=d),f(_,x,_.depth)}function d(x,w){var _=u.styles[w];return _?"\x1B["+u.colors[_][0]+"m"+x+"\x1B["+u.colors[_][1]+"m":x}function h(x,w){return x}function f(x,w,_){if(x.customInspect&&w&&q(w.inspect)&&w.inspect!==s.inspect&&(!w.constructor||w.constructor.prototype!==w)){var S=w.inspect(_,x);return k(S)||(S=f(x,S,_)),S}var T=function(P,D){if(N(D))return P.stylize("undefined","undefined");if(k(D)){var G="'"+JSON.stringify(D).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return P.stylize(G,"string")}if(y(D))return P.stylize(""+D,"number");if(v(D))return P.stylize(""+D,"boolean");if(b(D))return P.stylize("null","null")}(x,w);if(T)return T;var U=Object.keys(w),A=function(P){var D={};return P.forEach(function(G,re){D[G]=!0}),D}(U);if(x.showHidden&&(U=Object.getOwnPropertyNames(w)),B(w)&&(U.indexOf("message")>=0||U.indexOf("description")>=0))return g(w);if(U.length===0){if(q(w)){var H=w.name?": "+w.name:"";return x.stylize("[Function"+H+"]","special")}if(L(w))return x.stylize(RegExp.prototype.toString.call(w),"regexp");if(R(w))return x.stylize(Date.prototype.toString.call(w),"date");if(B(w))return g(w)}var z,K="",j=!1,J=["{","}"];return p(w)&&(j=!0,J=["[","]"]),q(w)&&(K=" [Function"+(w.name?": "+w.name:"")+"]"),L(w)&&(K=" "+RegExp.prototype.toString.call(w)),R(w)&&(K=" "+Date.prototype.toUTCString.call(w)),B(w)&&(K=" "+g(w)),U.length!==0||j&&w.length!=0?_<0?L(w)?x.stylize(RegExp.prototype.toString.call(w),"regexp"):x.stylize("[Object]","special"):(x.seen.push(w),z=j?function(P,D,G,re,te){for(var ne=[],le=0,oe=D.length;le<oe;++le)E(D,String(le))?ne.push(m(P,D,G,re,String(le),!0)):ne.push("");return te.forEach(function(ee){ee.match(/^\d+$/)||ne.push(m(P,D,G,re,ee,!0))}),ne}(x,w,_,A,U):U.map(function(P){return m(x,w,_,A,P,j)}),x.seen.pop(),function(P,D,G){return P.reduce(function(re,te){return te.indexOf(`
`)>=0,re+te.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?G[0]+(D===""?"":D+`
 `)+" "+P.join(`,
  `)+" "+G[1]:G[0]+D+" "+P.join(", ")+" "+G[1]}(z,K,J)):J[0]+K+J[1]}function g(x){return"["+Error.prototype.toString.call(x)+"]"}function m(x,w,_,S,T,U){var A,H,z;if((z=Object.getOwnPropertyDescriptor(w,T)||{value:w[T]}).get?H=z.set?x.stylize("[Getter/Setter]","special"):x.stylize("[Getter]","special"):z.set&&(H=x.stylize("[Setter]","special")),E(S,T)||(A="["+T+"]"),H||(x.seen.indexOf(z.value)<0?(H=b(_)?f(x,z.value,null):f(x,z.value,_-1)).indexOf(`
`)>-1&&(H=U?H.split(`
`).map(function(K){return"  "+K}).join(`
`).substr(2):`
`+H.split(`
`).map(function(K){return"   "+K}).join(`
`)):H=x.stylize("[Circular]","special")),N(A)){if(U&&T.match(/^\d+$/))return H;(A=JSON.stringify(""+T)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(A=A.substr(1,A.length-2),A=x.stylize(A,"name")):(A=A.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),A=x.stylize(A,"string"))}return A+": "+H}function p(x){return Array.isArray(x)}function v(x){return typeof x=="boolean"}function b(x){return x===null}function y(x){return typeof x=="number"}function k(x){return typeof x=="string"}function N(x){return x===void 0}function L(x){return F(x)&&V(x)==="[object RegExp]"}function F(x){return typeof x=="object"&&x!==null}function R(x){return F(x)&&V(x)==="[object Date]"}function B(x){return F(x)&&(V(x)==="[object Error]"||x instanceof Error)}function q(x){return typeof x=="function"}function V(x){return Object.prototype.toString.call(x)}function I(x){return x<10?"0"+x.toString(10):x.toString(10)}s.debuglog=function(x){if(N(l)&&(l=a.env.NODE_DEBUG||""),x=x.toUpperCase(),!c[x])if(new RegExp("\\b"+x+"\\b","i").test(l)){var w=a.pid;c[x]=function(){var _=s.format.apply(s,arguments);console.error("%s %d: %s",x,w,_)}}else c[x]=function(){};return c[x]},s.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},s.isArray=p,s.isBoolean=v,s.isNull=b,s.isNullOrUndefined=function(x){return x==null},s.isNumber=y,s.isString=k,s.isSymbol=function(x){return typeof x=="symbol"},s.isUndefined=N,s.isRegExp=L,s.isObject=F,s.isDate=R,s.isError=B,s.isFunction=q,s.isPrimitive=function(x){return x===null||typeof x=="boolean"||typeof x=="number"||typeof x=="string"||typeof x=="symbol"||x===void 0},s.isBuffer=e("./support/isBuffer");var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(){var x=new Date,w=[I(x.getHours()),I(x.getMinutes()),I(x.getSeconds())].join(":");return[x.getDate(),C[x.getMonth()],w].join(" ")}function E(x,w){return Object.prototype.hasOwnProperty.call(x,w)}s.log=function(){console.log("%s - %s",O(),s.format.apply(s,arguments))},s.inherits=e("inherits"),s._extend=function(x,w){if(!w||!F(w))return x;for(var _=Object.keys(w),S=_.length;S--;)x[_[S]]=w[_[S]];return x}}).call(this)}).call(this,e("_process"),typeof rr<"u"?rr:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"v1",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(s,"v3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(s,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(s,"v5",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(s,"NIL",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(s,"version",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(s,"validate",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(s,"stringify",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(s,"parse",{enumerable:!0,get:function(){return f.default}});var a=g(e("./v1.js")),i=g(e("./v3.js")),o=g(e("./v4.js")),l=g(e("./v5.js")),c=g(e("./nil.js")),u=g(e("./version.js")),d=g(e("./validate.js")),h=g(e("./stringify.js")),f=g(e("./parse.js"));function g(m){return m&&m.__esModule?m:{default:m}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(e,n,s){function a(f){return 14+(f+64>>>9<<4)+1}function i(f,g){const m=(65535&f)+(65535&g);return(f>>16)+(g>>16)+(m>>16)<<16|65535&m}function o(f,g,m,p,v,b){return i((y=i(i(g,f),i(p,b)))<<(k=v)|y>>>32-k,m);var y,k}function l(f,g,m,p,v,b,y){return o(g&m|~g&p,f,g,v,b,y)}function c(f,g,m,p,v,b,y){return o(g&p|m&~p,f,g,v,b,y)}function u(f,g,m,p,v,b,y){return o(g^m^p,f,g,v,b,y)}function d(f,g,m,p,v,b,y){return o(m^(g|~p),f,g,v,b,y)}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var h=function(f){if(typeof f=="string"){const g=unescape(encodeURIComponent(f));f=new Uint8Array(g.length);for(let m=0;m<g.length;++m)f[m]=g.charCodeAt(m)}return function(g){const m=[],p=32*g.length;for(let v=0;v<p;v+=8){const b=g[v>>5]>>>v%32&255,y=parseInt("0123456789abcdef".charAt(b>>>4&15)+"0123456789abcdef".charAt(15&b),16);m.push(y)}return m}(function(g,m){g[m>>5]|=128<<m%32,g[a(m)-1]=m;let p=1732584193,v=-271733879,b=-1732584194,y=271733878;for(let k=0;k<g.length;k+=16){const N=p,L=v,F=b,R=y;p=l(p,v,b,y,g[k],7,-680876936),y=l(y,p,v,b,g[k+1],12,-389564586),b=l(b,y,p,v,g[k+2],17,606105819),v=l(v,b,y,p,g[k+3],22,-1044525330),p=l(p,v,b,y,g[k+4],7,-176418897),y=l(y,p,v,b,g[k+5],12,1200080426),b=l(b,y,p,v,g[k+6],17,-1473231341),v=l(v,b,y,p,g[k+7],22,-45705983),p=l(p,v,b,y,g[k+8],7,1770035416),y=l(y,p,v,b,g[k+9],12,-1958414417),b=l(b,y,p,v,g[k+10],17,-42063),v=l(v,b,y,p,g[k+11],22,-1990404162),p=l(p,v,b,y,g[k+12],7,1804603682),y=l(y,p,v,b,g[k+13],12,-40341101),b=l(b,y,p,v,g[k+14],17,-1502002290),v=l(v,b,y,p,g[k+15],22,1236535329),p=c(p,v,b,y,g[k+1],5,-165796510),y=c(y,p,v,b,g[k+6],9,-1069501632),b=c(b,y,p,v,g[k+11],14,643717713),v=c(v,b,y,p,g[k],20,-373897302),p=c(p,v,b,y,g[k+5],5,-701558691),y=c(y,p,v,b,g[k+10],9,38016083),b=c(b,y,p,v,g[k+15],14,-660478335),v=c(v,b,y,p,g[k+4],20,-405537848),p=c(p,v,b,y,g[k+9],5,568446438),y=c(y,p,v,b,g[k+14],9,-1019803690),b=c(b,y,p,v,g[k+3],14,-187363961),v=c(v,b,y,p,g[k+8],20,1163531501),p=c(p,v,b,y,g[k+13],5,-1444681467),y=c(y,p,v,b,g[k+2],9,-51403784),b=c(b,y,p,v,g[k+7],14,1735328473),v=c(v,b,y,p,g[k+12],20,-1926607734),p=u(p,v,b,y,g[k+5],4,-378558),y=u(y,p,v,b,g[k+8],11,-2022574463),b=u(b,y,p,v,g[k+11],16,1839030562),v=u(v,b,y,p,g[k+14],23,-35309556),p=u(p,v,b,y,g[k+1],4,-1530992060),y=u(y,p,v,b,g[k+4],11,1272893353),b=u(b,y,p,v,g[k+7],16,-155497632),v=u(v,b,y,p,g[k+10],23,-1094730640),p=u(p,v,b,y,g[k+13],4,681279174),y=u(y,p,v,b,g[k],11,-358537222),b=u(b,y,p,v,g[k+3],16,-722521979),v=u(v,b,y,p,g[k+6],23,76029189),p=u(p,v,b,y,g[k+9],4,-640364487),y=u(y,p,v,b,g[k+12],11,-421815835),b=u(b,y,p,v,g[k+15],16,530742520),v=u(v,b,y,p,g[k+2],23,-995338651),p=d(p,v,b,y,g[k],6,-198630844),y=d(y,p,v,b,g[k+7],10,1126891415),b=d(b,y,p,v,g[k+14],15,-1416354905),v=d(v,b,y,p,g[k+5],21,-57434055),p=d(p,v,b,y,g[k+12],6,1700485571),y=d(y,p,v,b,g[k+3],10,-1894986606),b=d(b,y,p,v,g[k+10],15,-1051523),v=d(v,b,y,p,g[k+1],21,-2054922799),p=d(p,v,b,y,g[k+8],6,1873313359),y=d(y,p,v,b,g[k+15],10,-30611744),b=d(b,y,p,v,g[k+6],15,-1560198380),v=d(v,b,y,p,g[k+13],21,1309151649),p=d(p,v,b,y,g[k+4],6,-145523070),y=d(y,p,v,b,g[k+11],10,-1120210379),b=d(b,y,p,v,g[k+2],15,718787259),v=d(v,b,y,p,g[k+9],21,-343485551),p=i(p,N),v=i(v,L),b=i(b,F),y=i(y,R)}return[p,v,b,y]}(function(g){if(g.length===0)return[];const m=8*g.length,p=new Uint32Array(a(m));for(let v=0;v<m;v+=8)p[v>>5]|=(255&g[v/8])<<v%32;return p}(f),8*f.length))};s.default=h},{}],530:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,s.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a,i=(a=e("./validate.js"))&&a.__esModule?a:{default:a},o=function(l){if(!(0,i.default)(l))throw TypeError("Invalid UUID");let c;const u=new Uint8Array(16);return u[0]=(c=parseInt(l.slice(0,8),16))>>>24,u[1]=c>>>16&255,u[2]=c>>>8&255,u[3]=255&c,u[4]=(c=parseInt(l.slice(9,13),16))>>>8,u[5]=255&c,u[6]=(c=parseInt(l.slice(14,18),16))>>>8,u[7]=255&c,u[8]=(c=parseInt(l.slice(19,23),16))>>>8,u[9]=255&c,u[10]=(c=parseInt(l.slice(24,36),16))/1099511627776&255,u[11]=c/4294967296&255,u[12]=c>>>24&255,u[13]=c>>>16&255,u[14]=c>>>8&255,u[15]=255&c,u};s.default=o},{"./validate.js":541}],532:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,s.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(e,n,s){let a;Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(){if(!a&&(a=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!a))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)};const i=new Uint8Array(16)},{}],534:[function(e,n,s){function a(l,c,u,d){switch(l){case 0:return c&u^~c&d;case 1:return c^u^d;case 2:return c&u^c&d^u&d;case 3:return c^u^d}}function i(l,c){return l<<c|l>>>32-c}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o=function(l){const c=[1518500249,1859775393,2400959708,3395469782],u=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof l=="string"){const g=unescape(encodeURIComponent(l));l=[];for(let m=0;m<g.length;++m)l.push(g.charCodeAt(m))}else Array.isArray(l)||(l=Array.prototype.slice.call(l));l.push(128);const d=l.length/4+2,h=Math.ceil(d/16),f=new Array(h);for(let g=0;g<h;++g){const m=new Uint32Array(16);for(let p=0;p<16;++p)m[p]=l[64*g+4*p]<<24|l[64*g+4*p+1]<<16|l[64*g+4*p+2]<<8|l[64*g+4*p+3];f[g]=m}f[h-1][14]=8*(l.length-1)/Math.pow(2,32),f[h-1][14]=Math.floor(f[h-1][14]),f[h-1][15]=8*(l.length-1)&4294967295;for(let g=0;g<h;++g){const m=new Uint32Array(80);for(let N=0;N<16;++N)m[N]=f[g][N];for(let N=16;N<80;++N)m[N]=i(m[N-3]^m[N-8]^m[N-14]^m[N-16],1);let p=u[0],v=u[1],b=u[2],y=u[3],k=u[4];for(let N=0;N<80;++N){const L=Math.floor(N/20),F=i(p,5)+a(L,v,b,y)+k+c[L]+m[N]>>>0;k=y,y=b,b=i(v,30)>>>0,v=p,p=F}u[0]=u[0]+p>>>0,u[1]=u[1]+v>>>0,u[2]=u[2]+b>>>0,u[3]=u[3]+y>>>0,u[4]=u[4]+k>>>0}return[u[0]>>24&255,u[0]>>16&255,u[0]>>8&255,255&u[0],u[1]>>24&255,u[1]>>16&255,u[1]>>8&255,255&u[1],u[2]>>24&255,u[2]>>16&255,u[2]>>8&255,255&u[2],u[3]>>24&255,u[3]>>16&255,u[3]>>8&255,255&u[3],u[4]>>24&255,u[4]>>16&255,u[4]>>8&255,255&u[4]]};s.default=o},{}],535:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a,i=(a=e("./validate.js"))&&a.__esModule?a:{default:a};const o=[];for(let c=0;c<256;++c)o.push((c+256).toString(16).substr(1));var l=function(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const d=(o[c[u+0]]+o[c[u+1]]+o[c[u+2]]+o[c[u+3]]+"-"+o[c[u+4]]+o[c[u+5]]+"-"+o[c[u+6]]+o[c[u+7]]+"-"+o[c[u+8]]+o[c[u+9]]+"-"+o[c[u+10]]+o[c[u+11]]+o[c[u+12]]+o[c[u+13]]+o[c[u+14]]+o[c[u+15]]).toLowerCase();if(!(0,i.default)(d))throw TypeError("Stringified UUID is invalid");return d};s.default=l},{"./validate.js":541}],536:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=o(e("./rng.js")),i=o(e("./stringify.js"));function o(f){return f&&f.__esModule?f:{default:f}}let l,c,u=0,d=0;var h=function(f,g,m){let p=g&&m||0;const v=g||new Array(16);let b=(f=f||{}).node||l,y=f.clockseq!==void 0?f.clockseq:c;if(b==null||y==null){const B=f.random||(f.rng||a.default)();b==null&&(b=l=[1|B[0],B[1],B[2],B[3],B[4],B[5]]),y==null&&(y=c=16383&(B[6]<<8|B[7]))}let k=f.msecs!==void 0?f.msecs:Date.now(),N=f.nsecs!==void 0?f.nsecs:d+1;const L=k-u+(N-d)/1e4;if(L<0&&f.clockseq===void 0&&(y=y+1&16383),(L<0||k>u)&&f.nsecs===void 0&&(N=0),N>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=k,d=N,c=y,k+=122192928e5;const F=(1e4*(268435455&k)+N)%4294967296;v[p++]=F>>>24&255,v[p++]=F>>>16&255,v[p++]=F>>>8&255,v[p++]=255&F;const R=k/4294967296*1e4&268435455;v[p++]=R>>>8&255,v[p++]=255&R,v[p++]=R>>>24&15|16,v[p++]=R>>>16&255,v[p++]=y>>>8|128,v[p++]=255&y;for(let B=0;B<6;++B)v[p+B]=b[B];return g||(0,i.default)(v)};s.default=h},{"./rng.js":533,"./stringify.js":535}],537:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=o(e("./v35.js")),i=o(e("./md5.js"));function o(c){return c&&c.__esModule?c:{default:c}}var l=(0,a.default)("v3",48,i.default);s.default=l},{"./md5.js":529,"./v35.js":538}],538:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(u,d,h){function f(g,m,p,v){if(typeof g=="string"&&(g=function(y){y=unescape(encodeURIComponent(y));const k=[];for(let N=0;N<y.length;++N)k.push(y.charCodeAt(N));return k}(g)),typeof m=="string"&&(m=(0,i.default)(m)),m.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let b=new Uint8Array(16+g.length);if(b.set(m),b.set(g,m.length),b=h(b),b[6]=15&b[6]|d,b[8]=63&b[8]|128,p){v=v||0;for(let y=0;y<16;++y)p[v+y]=b[y];return p}return(0,a.default)(b)}try{f.name=u}catch{}return f.DNS=l,f.URL=c,f},s.URL=s.DNS=void 0;var a=o(e("./stringify.js")),i=o(e("./parse.js"));function o(u){return u&&u.__esModule?u:{default:u}}const l="6ba7b810-9dad-11d1-80b4-00c04fd430c8";s.DNS=l;const c="6ba7b811-9dad-11d1-80b4-00c04fd430c8";s.URL=c},{"./parse.js":531,"./stringify.js":535}],539:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=o(e("./rng.js")),i=o(e("./stringify.js"));function o(c){return c&&c.__esModule?c:{default:c}}var l=function(c,u,d){const h=(c=c||{}).random||(c.rng||a.default)();if(h[6]=15&h[6]|64,h[8]=63&h[8]|128,u){d=d||0;for(let f=0;f<16;++f)u[d+f]=h[f];return u}return(0,i.default)(h)};s.default=l},{"./rng.js":533,"./stringify.js":535}],540:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=o(e("./v35.js")),i=o(e("./sha1.js"));function o(c){return c&&c.__esModule?c:{default:c}}var l=(0,a.default)("v5",80,i.default);s.default=l},{"./sha1.js":534,"./v35.js":538}],541:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a,i=(a=e("./regex.js"))&&a.__esModule?a:{default:a},o=function(l){return typeof l=="string"&&i.default.test(l)};s.default=o},{"./regex.js":532}],542:[function(e,n,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a,i=(a=e("./validate.js"))&&a.__esModule?a:{default:a},o=function(l){if(!(0,i.default)(l))throw TypeError("Invalid UUID");return parseInt(l.substr(14,1),16)};s.default=o},{"./validate.js":541}],543:[function(e,n,s){/**
* Character classes and associated utilities for the 5th edition of XML 1.0.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(s,"__esModule",{value:!0}),s.CHAR=`	
\r ---`,s.S=` 	\r
`,s.NAME_START_CHAR=":A-Z_a-z-----------",s.NAME_CHAR="-"+s.NAME_START_CHAR+".0-9--",s.CHAR_RE=new RegExp("^["+s.CHAR+"]$","u"),s.S_RE=new RegExp("^["+s.S+"]+$","u"),s.NAME_START_CHAR_RE=new RegExp("^["+s.NAME_START_CHAR+"]$","u"),s.NAME_CHAR_RE=new RegExp("^["+s.NAME_CHAR+"]$","u"),s.NAME_RE=new RegExp("^["+s.NAME_START_CHAR+"]["+s.NAME_CHAR+"]*$","u"),s.NMTOKEN_RE=new RegExp("^["+s.NAME_CHAR+"]+$","u");function a(i){return i>=65&&i<=90||i>=97&&i<=122||i===58||i===95||i===8204||i===8205||i>=192&&i<=214||i>=216&&i<=246||i>=248&&i<=767||i>=880&&i<=893||i>=895&&i<=8191||i>=8304&&i<=8591||i>=11264&&i<=12271||i>=12289&&i<=55295||i>=63744&&i<=64975||i>=65008&&i<=65533||i>=65536&&i<=983039}s.S_LIST=[32,10,13,9],s.isChar=function(i){return i>=32&&i<=55295||i===10||i===13||i===9||i>=57344&&i<=65533||i>=65536&&i<=1114111},s.isS=function(i){return i===32||i===10||i===13||i===9},s.isNameStartChar=a,s.isNameChar=function(i){return a(i)||i>=48&&i<=57||i===45||i===46||i===183||i>=768&&i<=879||i>=8255&&i<=8256}},{}],544:[function(e,n,s){/**
* Character classes and associated utilities for the 2nd edition of XML 1.1.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(s,"__esModule",{value:!0}),s.CHAR="---",s.RESTRICTED_CHAR="-\b\v\f---",s.S=` 	\r
`,s.NAME_START_CHAR=":A-Z_a-z-----------",s.NAME_CHAR="-"+s.NAME_START_CHAR+".0-9--",s.CHAR_RE=new RegExp("^["+s.CHAR+"]$","u"),s.RESTRICTED_CHAR_RE=new RegExp("^["+s.RESTRICTED_CHAR+"]$","u"),s.S_RE=new RegExp("^["+s.S+"]+$","u"),s.NAME_START_CHAR_RE=new RegExp("^["+s.NAME_START_CHAR+"]$","u"),s.NAME_CHAR_RE=new RegExp("^["+s.NAME_CHAR+"]$","u"),s.NAME_RE=new RegExp("^["+s.NAME_START_CHAR+"]["+s.NAME_CHAR+"]*$","u"),s.NMTOKEN_RE=new RegExp("^["+s.NAME_CHAR+"]+$","u");function a(i){return i>=65&&i<=90||i>=97&&i<=122||i===58||i===95||i===8204||i===8205||i>=192&&i<=214||i>=216&&i<=246||i>=248&&i<=767||i>=880&&i<=893||i>=895&&i<=8191||i>=8304&&i<=8591||i>=11264&&i<=12271||i>=12289&&i<=55295||i>=63744&&i<=64975||i>=65008&&i<=65533||i>=65536&&i<=983039}s.S_LIST=[32,10,13,9],s.isChar=function(i){return i>=1&&i<=55295||i>=57344&&i<=65533||i>=65536&&i<=1114111},s.isRestrictedChar=function(i){return i>=1&&i<=8||i===11||i===12||i>=14&&i<=31||i>=127&&i<=132||i>=134&&i<=159},s.isCharAndNotRestricted=function(i){return i===9||i===10||i===13||i>31&&i<127||i===133||i>159&&i<=55295||i>=57344&&i<=65533||i>=65536&&i<=1114111},s.isS=function(i){return i===32||i===10||i===13||i===9},s.isNameStartChar=a,s.isNameChar=function(i){return a(i)||i>=48&&i<=57||i===45||i===46||i===183||i>=768&&i<=879||i>=8255&&i<=8256}},{}],545:[function(e,n,s){/**
* Character class utilities for XML NS 1.0 edition 3.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/function a(i){return i>=65&&i<=90||i===95||i>=97&&i<=122||i>=192&&i<=214||i>=216&&i<=246||i>=248&&i<=767||i>=880&&i<=893||i>=895&&i<=8191||i>=8204&&i<=8205||i>=8304&&i<=8591||i>=11264&&i<=12271||i>=12289&&i<=55295||i>=63744&&i<=64975||i>=65008&&i<=65533||i>=65536&&i<=983039}Object.defineProperty(s,"__esModule",{value:!0}),s.NC_NAME_START_CHAR="A-Z_a-z------------",s.NC_NAME_CHAR="-"+s.NC_NAME_START_CHAR+".0-9--",s.NC_NAME_START_CHAR_RE=new RegExp("^["+s.NC_NAME_START_CHAR+"]$","u"),s.NC_NAME_CHAR_RE=new RegExp("^["+s.NC_NAME_CHAR+"]$","u"),s.NC_NAME_RE=new RegExp("^["+s.NC_NAME_START_CHAR+"]["+s.NC_NAME_CHAR+"]*$","u"),s.isNCNameStartChar=a,s.isNCNameChar=function(i){return a(i)||i===45||i===46||i>=48&&i<=57||i===183||i>=768&&i<=879||i>=8255&&i<=8256}},{}]},{},[15])(15)})})(fS);var wI=fS.exports;const Xb=gv(wI),Pn={USERDATA:"userdata",ABCD:"abcd"};class _I{constructor(){this.supabase=Lt,console.log(" CleanSupabaseService with separate page storage initialized")}async getUserDates(r,e=Pn.USERDATA){try{const n=this._getTableName(e),{data:s,error:a}=await this.supabase.from(n).select("dates").eq("user_id",r).single();if(a&&a.code!=="PGRST116")throw a;const i=(s==null?void 0:s.dates)||[];return console.log(` [${e.toUpperCase()}] Loaded ${i.length} dates for user ${r}`),i}catch(n){return console.error(` Error loading dates for ${e}:`,n),[]}}async saveUserDates(r,e,n=Pn.USERDATA){try{const s=this._getTableName(n),{data:a,error:i}=await this.supabase.from(s).upsert({user_id:r,dates:e,updated_at:new Date().toISOString()},{onConflict:"user_id"}).select().single();if(i)throw i;return console.log(` [${n.toUpperCase()}] Saved ${e.length} dates for user ${r}`),a}catch(s){throw console.error(` Error saving dates for ${n}:`,s),s}}async addUserDate(r,e,n=Pn.USERDATA){try{const s=await this.getUserDates(r,n);if(!s.includes(e)){const a=[...s,e].sort();await this.saveUserDates(r,a,n),console.log(` [${n.toUpperCase()}] Added date ${e} for user ${r}`)}}catch(s){throw console.error(` Error adding date for ${n}:`,s),s}}async removeUserDate(r,e,n=Pn.USERDATA){try{const a=(await this.getUserDates(r,n)).filter(i=>i!==e);await this.saveUserDates(r,a,n),n===Pn.ABCD&&(await this.deleteExcelData(r,e),await this.deleteHourEntry(r,e)),console.log(` [${n.toUpperCase()}] Removed date ${e} for user ${r}`)}catch(s){throw console.error(` Error removing date for ${n}:`,s),s}}_getTableName(r){switch(r){case Pn.USERDATA:return"user_dates_userdata";case Pn.ABCD:return"user_dates_abcd";default:return"user_dates"}}async hasExcelData(r,e){try{const{data:n,error:s}=await this.supabase.from("excel_data").select("id").eq("user_id",r).eq("date",e).single();return!s&&n}catch{return!1}}async getExcelData(r,e){try{const{data:n,error:s}=await this.supabase.from("excel_data").select("*").eq("user_id",r).eq("date",e).single();if(s)throw s;return n}catch(n){return console.error("Error getting Excel data:",n),null}}async saveExcelData(r,e,n){try{const{error:s}=await this.supabase.from("excel_data").upsert({user_id:r,date:e,file_name:n.fileName||"Unknown File",data:n,updated_at:new Date().toISOString()},{onConflict:"user_id,date"});if(s)throw s;console.log(" Excel data saved")}catch(s){throw console.error(" Error saving Excel data:",s),s}}async deleteExcelData(r,e){try{const{error:n}=await this.supabase.from("excel_data").delete().eq("user_id",r).eq("date",e);if(n)throw n;console.log(" Excel data deleted")}catch(n){throw console.error(" Error deleting Excel data:",n),n}}async hasHourEntry(r,e){try{const{data:n,error:s}=await this.supabase.from("hour_entries").select("id").eq("user_id",r).eq("date_key",e).single();return!s&&n}catch{return!1}}async getHourEntry(r,e){try{const{data:n,error:s}=await this.supabase.from("hour_entries").select("*").eq("user_id",r).eq("date_key",e).single();if(s)throw s;return n.hour_data}catch(n){return console.error("Error getting hour entry:",n),null}}async saveHourEntry(r,e,n){try{const{error:s}=await this.supabase.from("hour_entries").upsert({user_id:r,date_key:e,hour_data:{planetSelections:n},updated_at:new Date().toISOString()},{onConflict:"user_id,date_key"});if(s)throw s;console.log(" Hour entry saved")}catch(s){throw console.error(" Error saving hour entry:",s),s}}async deleteHourEntry(r,e){try{const{error:n}=await this.supabase.from("hour_entries").delete().eq("user_id",r).eq("date_key",e);if(n)throw n;console.log(" Hour entry deleted")}catch(n){throw console.error(" Error deleting hour entry:",n),n}}async getAllUsers(){try{const{data:r,error:e}=await this.supabase.from("users").select("*").order("username",{ascending:!0});if(e)throw e;return r}catch(r){return console.error(" Error getting users:",r),[]}}async createUser(r){try{const{data:e,error:n}=await this.supabase.from("users").insert(r).select().single();if(n)throw n;return console.log(" User created"),e}catch(e){throw console.error(" Error creating user:",e),e}}}const Gr=new _I,N5=Object.freeze(Object.defineProperty({__proto__:null,PAGE_CONTEXTS:Pn,default:Gr},Symbol.toStringTag,{value:"Module"}));function D5(){const t=mo(),{userId:r}=lm(),[e,n]=Se.useState(null),[s,a]=Se.useState(null),[i,o]=Se.useState(null),[l,c]=Se.useState(!1),[u,d]=Se.useState([]),[h,f]=Se.useState({}),[g,m]=Se.useState({}),[p,v]=Se.useState(null),[b,y]=Se.useState({Ar:0,Ta:0,Ge:0}),[k,N]=Se.useState({}),[L,F]=Se.useState(""),[R,B]=Se.useState({}),[q,V]=Se.useState({});Se.useEffect(()=>{async function oe(){try{a(null),o(null);const{data:ee,error:Z}=await Lt.from("users").select("id, username, hr").eq("id",r).single();if(Z)throw Z;n(ee),console.log(" Loading dates from user_dates_userdata table for user:",r);const se=await Gr.getUserDates(r,Pn.USERDATA);console.log(" Loaded dates from user_dates_userdata table:",se);const{data:ie,error:ue}=await Lt.from("hr_data").select("*").eq("user_id",r).order("date",{ascending:!0});if(ue)throw ue;const pe={};se&&se.length>0?se.sort((ye,Te)=>new Date(ye)-new Date(Te)).forEach((ye,Te)=>{pe[Te+1]=ye}):ie.forEach(fe=>{if(fe.topic.startsWith("DAY-")){const ye=parseInt(fe.topic.split("-")[1]);pe[ye]=fe.date}}),console.log(" Final dates mapping:",pe),d(ie||[]),f(pe),m(M2(ie,pe))}catch(ee){console.error(" Error fetching data:",ee),a("Error fetching data: "+ee.message)}}r&&oe()},[r]);const I=()=>crypto.randomUUID(),C=async oe=>{try{c(!0),a(null);const ee=Object.keys(h).map(Number).sort((ue,pe)=>ue-pe),Z=ee.length>0?Math.max(...ee)+1:1,se=[];for(let ue=1;ue<=((e==null?void 0:e.hr)||1);ue++)se.push({id:I(),user_id:r,topic:`DAY-${Z}`,date:oe,hr_number:`HR-${ue}`,planet_house:null}),zs.forEach(pe=>{se.push({id:I(),user_id:r,topic:pe,date:oe,hr_number:`HR-${ue}`,planet_house:null})});const{error:ie}=await Lt.from("hr_data").upsert(se,{onConflict:"id"});if(ie)throw ie;return console.log(" Adding date to user_dates_userdata table:",oe),await Gr.addUserDate(r,oe,Pn.USERDATA),console.log(" Date added to user_dates_userdata table successfully"),f(ue=>({...ue,[Z]:oe})),d(ue=>[...ue,...se]),o("New date added successfully!"),setTimeout(()=>o(null),3e3),!0}catch(ee){return console.error(" Error adding date:",ee),a("Error adding date: "+ee.message),!1}finally{c(!1)}},O=oe=>{const ee=Object.keys(h).map(Number).sort((ue,pe)=>ue-pe);if(ee.length<=1)return!1;const Z=parseInt(oe),se=ee[0],ie=ee[ee.length-1];return Z===se||Z===ie},E=async oe=>{try{c(!0),a(null);const ee=parseInt(oe),Z=h[oe];if(!O(oe)){a("Can only delete the oldest (first) or newest (last) date to maintain sequence integrity");return}const se=`Are you sure you want to delete Day-${oe} (${Z})?

This will permanently remove all data for this date.`;if(!window.confirm(se))return;const{error:ie}=await Lt.from("hr_data").delete().eq("user_id",r).eq("date",Z);if(ie)throw ie;const{error:ue}=await Lt.from("house").delete().eq("user_id",r).eq("date",Z);if(ue)throw ue;console.log(" Removing date from user_dates_userdata table:",Z),await Gr.removeUserDate(r,Z,Pn.USERDATA),console.log(" Date removed from user_dates_userdata table successfully");const pe={...h};delete pe[oe];const fe=u.filter(ye=>ye.date!==Z);f(pe),d(fe),o(`Date Day-${oe} (${Z}) deleted successfully!`),setTimeout(()=>o(null),3e3)}catch(ee){console.error(" Error deleting date:",ee),a("Error deleting date: "+ee.message)}finally{c(!1)}},x=async(oe,ee)=>{try{if(f(ue=>({...ue,[oe]:ee})),!ee)return;const Z=u.map(ue=>ue.topic===`DAY-${oe}`||ue.date===h[oe]&&zs.includes(ue.topic)?{...ue,date:ee}:ue);d(Z);const se={...h,[oe]:ee},ie=Object.values(se).filter(Boolean);ie.length>0&&(console.log(" Saving updated dates to user_dates_userdata table:",ie),await Gr.saveUserDates(r,ie,Pn.USERDATA),console.log(" Updated dates saved to user_dates_userdata table successfully"))}catch(Z){console.error(" Error updating date:",Z),a("Error updating date: "+Z.message)}},w=(oe,ee,Z)=>{try{console.log(` [UserData] Planet change: HR-${oe}, Day-${ee}, Selected: "${Z}"`);const se=[...u],ie=se.find(ue=>ue.hr_number===`HR-${oe}`&&ue.topic===`DAY-${ee}`);if(ie&&(ie.planet_house=Z,console.log(` [UserData] Updated main planet entry for DAY-${ee}`)),p&&Z){console.log(` [UserData] Processing Excel data for planet: "${Z}"`),console.log(" [UserData] Excel data structure:",{hasExcelData:!!p,planetKeys:Object.keys(p),requestedPlanet:Z,planetDataExists:!!p[Z]});const ue=p[Z];if(ue){console.log(` [UserData] Found planet data for "${Z}":`,ue),console.log(` [UserData] Available divisions for "${Z}":`,Object.keys(ue));let pe=0,fe=0;zs.forEach(ye=>{console.log(` [UserData] Processing division: ${ye}`),console.log(` [UserData] Looking for: HR-${oe}, Topic: ${ye}, Date: ${h[ee]}`);let Te=se.find(Pe=>Pe.hr_number===`HR-${oe}`&&Pe.topic===ye&&Pe.date===h[ee]);if(Te||(console.log(` [UserData] Division entry missing, creating: ${ye}`),Te={user_id:r,hr_number:`HR-${oe}`,topic:ye,date:h[ee],planet_house:null},se.push(Te),fe++),Te){const Pe=ue[ye];Te.planet_house=Pe||null,console.log(`   [UserData] ${ye}: "${Pe}"`),pe++}}),console.log(` [UserData] SUMMARY: Updated ${pe} divisions, Created ${fe} missing entries`)}else console.log(` [UserData] No planet data found for "${Z}" in Excel data`),console.log(" [UserData] Available planets:",Object.keys(p))}else p||console.log(" [UserData] No Excel data available"),Z||console.log(" [UserData] No planet value selected");d(se)}catch(se){console.error("Error in handlePlanetChange:",se),a("Failed to update planet selection")}},_=(oe,ee)=>{console.log(" [UserData] Received data from ExcelUpload component:",oe),console.log(" [UserData] Data structure analysis:"),console.log("  - Top level keys:",Object.keys(oe)),console.log("  - Sample planet data:",Object.entries(oe).slice(0,3)),oe.Ke?(console.log(" [UserData] Ketu (Ke) data found:",oe.Ke),console.log(" [UserData] Ketu divisions:",Object.keys(oe.Ke))):(console.log(" [UserData] Ketu (Ke) data NOT found in Excel upload"),console.log(" [UserData] Available planets:",Object.keys(oe))),window.excelData=oe,window.excelFileName=ee,console.log(" [UserData] Excel data now available in console as: window.excelData"),v(oe),setExcelFileName(ee),setExcelGroupCounts({}),F(new Date().toISOString().split("T")[0])},S=async oe=>{oe.preventDefault();try{c(!0),a(null);const ee=M2(u,h);m(ee);const Z=u.filter(fe=>fe.date).map(fe=>{const ye=Object.entries(h).find(([We,at])=>at===fe.date),Te=ye?ye[0]:null,Pe=fe.hr_number.split("-")[1],je=Pe&&fe.topic&&Te&&!fe.topic.startsWith("DAY-")?`${Pe}_${fe.topic}_${Te}`:null,qe=je&&ee[je]||null;return{...fe,id:fe.id||I(),house_number:qe}});if(Z.length>0){console.log("Saving hr_data:",Z.find(ye=>ye.house_number!==null));const{error:fe}=await Lt.from("hr_data").upsert(Z,{onConflict:"id"});if(fe)throw fe}const se=[];Array.from({length:e.hr},(fe,ye)=>ye+1).forEach(fe=>{Object.entries(h).forEach(([ye,Te])=>{const Pe={Ar:0,Ta:0,Ge:0};zs.forEach(je=>{var at;const qe=`${fe}_${je}_${ye}`,We=(at=u.find(Ye=>Ye.hr_number===`HR-${fe}`&&Ye.topic===je&&Ye.date===Te))==null?void 0:at.planet_house;We&&(["Ar","Cn","Li","Cp"].includes(We)?Pe.Ar++:["Ta","Le","Sc","Aq"].includes(We)?Pe.Ta++:["Ge","Vi","Sg","Pi"].includes(We)&&Pe.Ge++)}),se.push({user_id:r,hr_number:fe,day_number:parseInt(ye),group_ar:Pe.Ar,group_ta:Pe.Ta,group_ge:Pe.Ge,date:Te}),zs.forEach(je=>{const qe=u.find(We=>We.hr_number===`HR-${fe}`&&We.topic===je&&We.date===Te);qe&&se.push({user_id:r,hr_number:fe,day_number:parseInt(ye),date:Te,topic:je,planet_house:qe.planet_house||null,house_number:ee[`${fe}_${je}_${ye}`]||null})})})}),console.log("Saving house count data (to house table):",se.find(fe=>fe.house_number!==null));const ue=Object.values(h).filter(Boolean);if(ue.length>0){const{error:fe}=await Lt.from("house").delete().eq("user_id",r).in("date",ue);if(fe)throw fe}if(se.length>0){const{error:fe}=await Lt.from("house").upsert(se,{onConflict:"user_id,hr_number,day_number,date,topic"});if(fe&&fe.message.includes("no unique or exclusion constraint")){console.log(" Constraint not found, using delete+insert approach...");const ye=[...new Set(se.map(Pe=>Pe.date))];await Lt.from("house").delete().eq("user_id",r).in("date",ye);const{error:Te}=await Lt.from("house").insert(se);if(Te)throw console.error("Insert error into house table (fallback method):",Te),Te;console.log(" Successfully saved house data using delete+insert method")}else if(fe)throw console.error("Insert error into house table:",fe),fe}const pe=Object.values(h).filter(Boolean);pe.length>0&&(console.log(" Saving dates to user_dates_userdata table:",pe),await Gr.saveUserDates(r,pe,Pn.USERDATA),console.log(" Dates saved to user_dates_userdata table successfully")),o("All data saved successfully!")}catch(ee){console.error("Error saving data:",ee),a("Failed to save data: "+ee.message)}finally{c(!1)}},T=oe=>{const ee={Ar:0,Ta:0,Ge:0};oe.forEach(Z=>{["Ar","Cn","Li","Cp"].includes(Z.planet_house)&&ee.Ar++,["Ta","Ve","Sc","Pi"].includes(Z.planet_house)&&ee.Ta++,["Ge","Aq","Sa","Ca"].includes(Z.planet_house)&&ee.Ge++}),y(ee)};Se.useEffect(()=>{T(u)},[u]);const U=()=>{const oe={};ne.forEach(ee=>{oe[ee]={},Object.keys(h).forEach(Z=>{oe[ee][Z]={Ar:0,Ta:0,Ge:0}})}),u.forEach(ee=>{var ie;if(!ee.planet_house)return;const Z=ee.hr_number.split("-")[1],se=ee.topic.startsWith("DAY-")?ee.topic.split("-")[1]:(ie=Object.entries(h).find(([ue,pe])=>pe===ee.date))==null?void 0:ie[0];Z&&se&&(["Ar","Cn","Li","Cp"].includes(ee.planet_house)?oe[Z][se].Ar++:["Ta","Le","Sc","Aq"].includes(ee.planet_house)?oe[Z][se].Ta++:["Ge","Vi","Sg","Pi"].includes(ee.planet_house)&&oe[Z][se].Ge++)}),N(oe)};Se.useEffect(()=>{u.length>0&&Object.keys(h).length>0&&U()},[u,h]);const A=()=>{const oe={};ne.forEach(ee=>{oe[ee]={},Object.keys(h).forEach(Z=>{const se=parseInt(Z),ie=se-1;if(!h[ie]){oe[ee][Z]=0;return}let ue=0;zs.forEach(pe=>{const fe=`${ee}_${pe}_${se}`,ye=`${ee}_${pe}_${ie}`,Te=g[fe],Pe=g[ye];Te&&Te===Pe&&ue++}),oe[ee][Z]=ue})}),B(oe)};Se.useEffect(()=>{u.length>0&&Object.keys(h).length>0&&A()},[u,h,g]);const H=()=>{const oe={};ne.forEach(ee=>{oe[ee]={},Object.keys(h).forEach(Z=>{const se=parseInt(Z),ie=se-1;if(!h[ie]){oe[ee][Z]=0;return}let ue=0;zs.forEach(pe=>{const fe=u.find(je=>je.hr_number===`HR-${ee}`&&je.topic===pe&&je.date===h[se]),ye=u.find(je=>je.hr_number===`HR-${ee}`&&je.topic===pe&&je.date===h[ie]),Te=fe!=null&&fe.planet_house&&["Ar","Cn","Li","Cp"].includes(fe.planet_house)?"Ar":fe!=null&&fe.planet_house&&["Ta","Le","Sc","Aq"].includes(fe.planet_house)?"Ta":fe!=null&&fe.planet_house&&["Ge","Vi","Sg","Pi"].includes(fe.planet_house)?"Ge":null,Pe=ye!=null&&ye.planet_house&&["Ar","Cn","Li","Cp"].includes(ye.planet_house)?"Ar":ye!=null&&ye.planet_house&&["Ta","Le","Sc","Aq"].includes(ye.planet_house)?"Ta":ye!=null&&ye.planet_house&&["Ge","Vi","Sg","Pi"].includes(ye.planet_house)?"Ge":null;Te&&Pe&&Te===Pe&&ue++}),oe[ee][Z]=ue})}),V(oe)};Se.useEffect(()=>{u.length>0&&Object.keys(h).length>0&&(H(),window.hrData=u,window.dates=h,console.log(" [UserData] HR data now available in console as: window.hrData"),console.log(" [UserData] Dates now available in console as: window.dates"))},[u,h]);const z=async()=>{try{const oe=new Xb.Workbook,ee=oe.addWorksheet("User Data");ee.mergeCells("A1","D1"),ee.getCell("A1").value=`User: ${e.username}, Excel Upload Date: ${L}`,ee.getCell("A1").font={bold:!0};const Z=["Topic",...Object.keys(h).map(fe=>`Day-${fe}`)];ee.addRow(Z);const se=["Date",...Object.keys(h).map(fe=>h[fe]||"-")];ee.addRow(se),ne.forEach(fe=>{zs.forEach(ye=>{const Te=[`HR-${fe} ${ye}`];Object.entries(h).forEach(([Pe,je])=>{const qe=u.find(at=>at.hr_number===`HR-${fe}`&&at.topic===ye&&at.date===je),We=g[`${fe}_${ye}_${Pe}`];Te.push(`${(qe==null?void 0:qe.planet_house)||"-"} - (${We||"-"})`)}),ee.addRow(Te)}),ee.addRow([`HR-${fe} Group Ar`,...Object.keys(h).map(ye=>{var Te,Pe;return((Pe=(Te=k[fe])==null?void 0:Te[ye])==null?void 0:Pe.Ar)||0})]),ee.addRow([`HR-${fe} Group Ta`,...Object.keys(h).map(ye=>{var Te,Pe;return((Pe=(Te=k[fe])==null?void 0:Te[ye])==null?void 0:Pe.Ta)||0})]),ee.addRow([`HR-${fe} Group Ge`,...Object.keys(h).map(ye=>{var Te,Pe;return((Pe=(Te=k[fe])==null?void 0:Te[ye])==null?void 0:Pe.Ge)||0})]),ee.addRow([`HR-${fe} Same Numbers`,...Object.keys(h).map(ye=>{var Te;return((Te=R[fe])==null?void 0:Te[ye])||0})]),ee.addRow([`HR-${fe} Same Groups`,...Object.keys(h).map(ye=>{var Te;return((Te=q[fe])==null?void 0:Te[ye])||0})]),ee.addRow([])}),console.log("Debugging handleDownloadExcel:"),console.log("hrData:",u),console.log("groupCounts:",k),console.log("houseNumbers:",g),ee.eachRow((fe,ye)=>{fe.eachCell((Te,Pe)=>{var qe;const je=Te.value?Te.value.toString():"";if(console.log(`Row ${ye}, Column ${Pe}, Value: ${je}`),ye===1||ye===2)Te.font={bold:!0},Te.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCCCCC"}};else{const We=(qe=je.match(/[A-Za-z]{2}/))==null?void 0:qe[0],at=zl(We);at.includes("#DCEDC1")?Te.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDCEDC1"}}:at.includes("#FFD3B6")?Te.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFD3B6"}}:at.includes("#FFAAA5")?Te.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFAAA5"}}:Te.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFFFF"}}}})});const ie=await oe.xlsx.writeBuffer(),ue=new Blob([ie],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),pe=document.createElement("a");pe.href=URL.createObjectURL(ue),pe.download=`${(e==null?void 0:e.username)||"User"}_data.xlsx`,pe.click()}catch(oe){console.error("Error generating Excel file:",oe)}},[K,j]=Se.useState(""),[J,P]=Se.useState(null),[D,G]=Se.useState(!1),[re,te]=Se.useState(!1);if(!e)return X.jsx("div",{className:"p-4",children:"Loading..."});const ne=Array.from({length:e.hr},(oe,ee)=>ee+1),le=Object.entries(h).sort(([oe],[ee])=>Number(oe)-Number(ee)).reduce((oe,[ee,Z])=>(oe[ee]=Z,oe),{});return X.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-100",children:[X.jsx("div",{className:"sticky top-0 bg-white shadow-md z-10",children:X.jsxs("div",{className:"container mx-auto p-4 flex justify-between items-center",children:[X.jsxs("div",{className:"flex items-center space-x-4",children:[X.jsxs("h1",{className:"text-xl font-bold",children:[(e==null?void 0:e.username)||"User Not Found"," "]}),X.jsxs("span",{className:"text-sm text-gray-600",children:["HR: ",(e==null?void 0:e.hr)||"N/A"," "]})]}),X.jsxs("div",{className:"flex items-center space-x-2",children:[X.jsx(uS,{onDataUploaded:_,showIcon:!0,isUploaded:!!p,formatConfig:{rowRange:{start:3,end:20},expectedPlanets:10}}),X.jsx(yN,{onAddDate:C,existingDates:Object.values(h).filter(Boolean)}),X.jsx("button",{onClick:z,className:"bg-green-500 text-white px-3 py-1 text-xs rounded hover:bg-green-600",children:"Download Excel"}),X.jsx("button",{onClick:()=>t("/"),className:"bg-gray-500 text-white px-3 py-1 text-xs rounded hover:bg-gray-600",children:"Back"}),X.jsx(ti,{to:`/day-details/${r}?dates=${encodeURIComponent(JSON.stringify(h))}`,className:"bg-blue-500 text-white px-3 py-1 text-xs rounded hover:bg-blue-600",children:"Go to Day Details"}),X.jsx(ti,{to:`/abcd-number/${r}`,className:"bg-orange-500 text-white px-3 py-1 text-xs rounded hover:bg-orange-600",children:"ABCD Number"}),X.jsx(ti,{to:"/number-gen",className:"bg-purple-500 text-white px-3 py-1 text-xs rounded hover:bg-purple-600",children:"Number Gen"}),X.jsx("button",{type:"submit",form:"userDataForm",disabled:l,className:"bg-blue-500 text-white px-3 py-1 text-xs rounded hover:bg-blue-600 disabled:opacity-50",children:l?"Saving...":"Save All"})]})]})}),s&&X.jsx("div",{className:"p-2 m-2 bg-red-50 text-red-700 rounded",children:s}),i&&X.jsx("div",{className:"p-2 m-2 bg-green-50 text-green-700 rounded",children:i}),X.jsx("div",{className:"flex-1 overflow-auto",children:X.jsxs("form",{id:"userDataForm",onSubmit:S,children:["  ",ne.map(oe=>X.jsxs("div",{className:"mb-8",children:[X.jsx("div",{className:"sticky top-0 bg-gray-200 z-10",children:X.jsxs("h2",{className:"text-lg font-semibold px-4 py-2",children:[(e==null?void 0:e.username)||"User Not Found"," - HR-",oe," "]})}),X.jsxs("div",{className:"relative",children:[X.jsx("div",{className:"overflow-x-auto scrollbar-hidden absolute top-0 left-0 right-0 z-10",children:X.jsx("div",{className:"w-full",style:{height:"1px"}})}),X.jsx("div",{className:"overflow-x-auto",children:X.jsxs("table",{className:"w-full border-collapse bg-white",children:[X.jsx("thead",{children:X.jsxs("tr",{children:[X.jsx("th",{className:"w-24 p-2 text-left text-xs font-medium text-gray-500 bg-gray-50 border border-gray-200",children:"Topic"}),Object.entries(le).map(([ee,Z])=>{var se;return X.jsx("th",{className:"w-40 p-0 text-left text-xs font-medium text-gray-500 bg-gray-50 border border-gray-200",children:X.jsxs("div",{className:"flex flex-col",children:[X.jsxs("div",{className:"flex items-center justify-between p-2 space-x-2",children:[X.jsxs("span",{children:["HR-",oe]}),O(ee)&&X.jsx("button",{onClick:()=>E(ee),className:"text-red-500 hover:text-red-700 hover:bg-red-50 p-1 rounded text-xs",title:`Delete Day-${ee} (${Object.keys(h).length<=1?"Cannot delete - only one date":"Click to delete this date"})`,disabled:l,children:""})]}),X.jsxs("div",{className:"flex items-center justify-between p-2 space-x-2",children:[X.jsxs("span",{className:O(ee)?"text-red-600 font-medium":"",children:["Day-",ee,O(ee)&&X.jsx("span",{className:"text-xs text-red-500 block",children:parseInt(ee)===Math.min(...Object.keys(h).map(Number))?"(Oldest)":"(Newest)"})]}),X.jsx("input",{type:"date",value:Z||"",onChange:ie=>x(ee,ie.target.value),className:"text-xs border-0 p-0"})]}),X.jsxs("select",{name:`planet_hr${oe}_day${ee}`,value:((se=u.find(ie=>ie.hr_number===`HR-${oe}`&&ie.topic===`DAY-${ee}`))==null?void 0:se.planet_house)||"",onChange:ie=>w(oe,ee,ie.target.value),className:"w-full text-xs border-t border-gray-200 p-1",children:[X.jsx("option",{value:"",children:"PLN"}),mN.map(ie=>X.jsx("option",{value:ie,children:ie},ie))]})]})},ee)})]})}),X.jsxs("tbody",{children:[zs.map(ee=>X.jsxs("tr",{className:"border-b border-gray-200",children:[X.jsx("td",{className:"p-2 text-xs font-medium text-gray-900 bg-gray-50 border-r border-gray-200",children:ee}),Object.entries(le).map(([Z,se])=>{const ie=u.find(fe=>fe.hr_number===`HR-${oe}`&&fe.topic===ee&&fe.date===se),ue=`${oe}_${ee}_${Z}`,pe=g[ue];return X.jsx("td",{className:"p-0 border-r border-gray-200",children:X.jsxs("div",{className:"flex items-center",children:[X.jsx("div",{className:`w-full text-xs p-2 ${ie!=null&&ie.planet_house?zl(ie.planet_house):""}`,children:(ie==null?void 0:ie.planet_house)||"-"}),X.jsx("div",{className:"w-8 text-center",children:X.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded ${pe?"bg-blue-100 text-blue-800 font-medium":"text-gray-400"}`,children:pe||"-"})})]})},Z)})]},ee)),X.jsxs("tr",{className:"bg-[#DCEDC1]",children:[X.jsx("td",{className:"p-2 text-xs font-bold text-black",children:"Ar"}),Object.keys(le).map(ee=>{var Z,se;return X.jsx("td",{className:"p-2 text-xs font-bold text-black text-center",children:((se=(Z=k[oe])==null?void 0:Z[ee])==null?void 0:se.Ar)||0},`ar-${ee}`)})]}),X.jsxs("tr",{className:"bg-[#FFD3B6]",children:[X.jsx("td",{className:"p-2 text-xs font-bold text-black",children:"Ta"}),Object.keys(le).map(ee=>{var Z,se;return X.jsx("td",{className:"p-2 text-xs font-bold text-black text-center",children:((se=(Z=k[oe])==null?void 0:Z[ee])==null?void 0:se.Ta)||0},`ta-${ee}`)})]}),X.jsxs("tr",{className:"bg-[#FFAAA5]",children:[X.jsx("td",{className:"p-2 text-xs font-bold text-black",children:"Ge"}),Object.keys(le).map(ee=>{var Z,se;return X.jsx("td",{className:"p-2 text-xs font-bold text-black text-center",children:((se=(Z=k[oe])==null?void 0:Z[ee])==null?void 0:se.Ge)||0},`ge-${ee}`)})]}),X.jsxs("tr",{className:"bg-gray-200",children:[X.jsx("td",{className:"p-2 text-xs font-bold text-black text-[10px]",children:"Same Numbers"}),Object.keys(le).map(ee=>{var Z;return X.jsx("td",{className:"p-2 text-xs font-bold text-black text-center text-[10px]",children:((Z=R[oe])==null?void 0:Z[ee])||0},`same-${ee}`)})]}),X.jsxs("tr",{className:"bg-gray-300",children:[X.jsx("td",{className:"p-2 text-xs font-bold text-black text-[10px]",children:"Same Groups"}),Object.keys(le).map(ee=>{var Z;return X.jsx("td",{className:"p-2 text-xs font-bold text-black text-center text-[10px]",children:((Z=q[oe])==null?void 0:Z[ee])||0},`same-group-${ee}`)})]})]})]})})]})]},oe))]})})]})}function SI(){const t=mo(),[r,e]=Se.useState([]),[n,s]=Se.useState({username:"",hr:"",days:""});Se.useEffect(()=>{i()},[]);const a=()=>{localStorage.removeItem("house_count_session"),localStorage.removeItem("house_count_enabled"),localStorage.removeItem("user_email"),localStorage.removeItem("auth_type"),t("/auth")};Se.useEffect(()=>{(async()=>{try{const{data:u,error:d}=await Lt.from("users").select("count");d?(console.error("Supabase connection test failed:",d),alert(`Database connection error: ${d.message}`)):console.log("Supabase connection successful")}catch(u){console.error("Failed to test Supabase connection:",u),alert("Failed to connect to the database")}})()},[]);const i=async()=>{try{const{data:c,error:u}=await Lt.from("users").select("*");if(u){console.error("Error fetching users:",u),alert(`Could not fetch users: ${u.message}`);return}e(c||[])}catch(c){console.error("Unexpected error in fetchUsers:",c),alert("Failed to load user list. See console for details.")}},o=async c=>{c.preventDefault();const{data:u,error:d}=await Lt.from("users").insert([{username:n.username,hr:parseInt(n.hr),days:parseInt(n.days)}]).select();if(d){console.error("Error adding user:",d);return}s({username:"",hr:"",days:""}),i()},l=async c=>{if(confirm("Are you sure you want to delete this user and all associated data? This cannot be undone."))try{const{error:u}=await Lt.from("house").delete().eq("user_id",c);if(u){console.error("Error deleting related house data:",u),alert(`Failed to delete related house data: ${u.message}`);return}const{error:d}=await Lt.from("hr_data").delete().eq("user_id",c);if(d){console.error("Error deleting related hr_data:",d),alert(`Failed to delete related HR data: ${d.message}`);return}const{error:h}=await Lt.from("users").delete().eq("id",c);if(h){console.error("Error deleting user:",h),alert(`Failed to delete user: ${h.message}`);return}i(),alert("User and all associated data deleted successfully.")}catch(u){console.error("An unexpected error occurred during deletion:",u),alert("An unexpected error occurred. Please check the console.")}};return X.jsxs("div",{className:"min-h-screen bg-gray-50",children:[X.jsx("header",{className:"bg-white shadow-sm border-b",children:X.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:X.jsxs("div",{className:"flex justify-between items-center h-16",children:[X.jsxs("div",{className:"flex items-center space-x-8",children:[X.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"viboothi.in"}),X.jsxs("nav",{className:"flex space-x-6",children:[X.jsx(ti,{to:"/users",className:"text-indigo-600 hover:text-indigo-900 font-medium",children:"Users"}),X.jsx(ti,{to:"/number-gen",className:"text-gray-700 hover:text-gray-900",children:"Number Generator"}),X.jsx(ti,{to:"/test",className:"text-gray-700 hover:text-gray-900",children:"Test"})]})]}),X.jsxs("div",{className:"flex items-center space-x-4",children:[X.jsx("span",{className:"text-sm text-gray-500",children:"Welcome, gurukrpasharma"}),X.jsx("button",{onClick:a,className:"bg-red-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",children:"Logout"})]})]})})}),X.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:X.jsxs("div",{className:"px-4 py-6 sm:px-0",children:[X.jsx("h2",{className:"text-2xl font-bold mb-6",children:"User Management"}),X.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-8",children:[X.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New User"}),X.jsxs("form",{onSubmit:o,className:"space-y-4",children:[X.jsxs("div",{children:[X.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Username:"}),X.jsx("input",{type:"text",value:n.username,onChange:c=>s({...n,username:c.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:!0})]}),X.jsxs("div",{children:[X.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total HR:"}),X.jsx("input",{type:"number",value:n.hr,onChange:c=>s({...n,hr:c.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:!0})]}),X.jsxs("div",{children:[X.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Days:"}),X.jsx("input",{type:"number",value:n.days,onChange:c=>s({...n,days:c.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:!0})]}),X.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Add User"})]})]}),X.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:X.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[X.jsx("thead",{className:"bg-gray-50",children:X.jsxs("tr",{children:[X.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Username"}),X.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total HR"}),X.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Days"}),X.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),X.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(c=>X.jsxs("tr",{children:[X.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.username}),X.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.hr}),X.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.days}),X.jsxs("td",{className:"px-6 py-4 whitespace-nowrap space-x-2",children:[X.jsx(ti,{to:`/user-data/${c.id}`,className:"text-blue-600 hover:text-blue-900",children:"House Count"}),X.jsx(ti,{to:`/abcd-number/${c.id}`,className:"text-orange-600 hover:text-orange-900 ml-4",children:"ABCD Number"}),X.jsx(ti,{to:"/number-gen",className:"text-purple-600 hover:text-purple-900 ml-4",children:"Number Gen"}),X.jsx("button",{onClick:()=>l(c.id),className:"text-red-600 hover:text-red-900 ml-4",children:"Delete"})]})]},c.id))})]})})]})})]})}const W2=({progress:t=0,message:r="Loading...",showPercentage:e=!0,className:n="",color:s="blue"})=>{const a={blue:"bg-blue-600",purple:"bg-purple-600",green:"bg-green-600",orange:"bg-orange-600"},i=a[s]||a.blue;return X.jsxs("div",{className:`w-full ${n}`,children:[X.jsxs("div",{className:"flex items-center justify-between mb-2",children:[X.jsx("span",{className:"text-sm font-medium text-gray-700",children:r}),e&&X.jsxs("span",{className:"text-sm font-medium text-gray-500",children:[Math.round(t),"%"]})]}),X.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:X.jsx("div",{className:`${i} h-2.5 rounded-full transition-all duration-300 ease-out`,style:{width:`${Math.min(100,Math.max(0,t))}%`}})})]})};var hS={exports:{}},kI="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",EI=kI,AI=EI;function dS(){}function pS(){}pS.resetWarningCache=dS;var CI=function(){function t(n,s,a,i,o,l){if(l!==AI){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function r(){return t}var e={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:pS,resetWarningCache:dS};return e.PropTypes=e,e};hS.exports=CI();var TI=hS.exports;const R5=gv(TI);class Ho extends wv.Component{constructor(e){super(e);zy(this,"resetError",()=>{this.setState({hasError:!1,error:null}),this.props.onReset&&this.props.onReset()});this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Error Boundary caught:",e,n)}render(){return this.state.hasError?X.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg m-4",children:[X.jsx("h2",{className:"text-lg font-bold text-red-800",children:"Something went wrong"}),X.jsx("pre",{className:"text-red-600 text-sm mt-2 mb-4 overflow-auto",children:this.state.error.message}),X.jsx("button",{onClick:this.resetError,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded",children:"Try Again"})]}):this.props.children}}Ho.propTypes={children:R5.node,onReset:R5.func};const aa=["Su","Mo","Ma","Me","Ju","Ve","Sa","Ra","Ke"],P5={Ar:1,Ta:2,Ge:3,Cn:4,Le:5,Vi:6,Li:7,Sc:8,Sg:9,Cp:10,Aq:11,Pi:12},rg=t=>{if(!t)return null;const r=["Ar","Cn","Li","Cp"],e=["Ta","Le","Sc","Aq"],n=["Ge","Vi","Sg","Pi"];return r.includes(t)?"Ar":e.includes(t)?"Ta":n.includes(t)?"Ge":null},ng=(t,r)=>{if(!t||t==="-"||!r||r==="-")return null;const e=P5[t],n=P5[r];return e===void 0||n===void 0?null:(n-e+12)%12+1};function NI(){const t=mo(),{userId:r}=lm(),[e,n]=Se.useState(null),[s,a]=Se.useState([]),[i,o]=Se.useState(null),[l,c]=Se.useState({}),[u,d]=Se.useState(null),[h,f]=Se.useState([]),[g,m]=Se.useState([]),[p,v]=Se.useState({}),[b,y]=Se.useState({}),[k,N]=Se.useState(""),[L,F]=Se.useState({}),[R,B]=Se.useState({}),[q,V]=Se.useState({}),[I,C]=Se.useState({}),[O,E]=Se.useState(!1);Se.useEffect(()=>{async function H(){try{const{data:z,error:K}=await Lt.from("users").select("id, username, hr").eq("id",r).single();if(K)throw K;n(z);const{data:j,error:J}=await Lt.from("hr_data").select("*").eq("user_id",r).order("date",{ascending:!0});if(J)throw J;a(j);const P=[...new Set(j.filter(G=>G.date).map(G=>G.date))].sort((G,re)=>new Date(G)-new Date(re)),D={};j.forEach(G=>{if(G.topic&&G.topic.startsWith("DAY-")){const re=parseInt(G.topic.split("-")[1]);G.date&&(D[re]=G.date)}}),f(P),v(D),P.length>0?o(P[P.length-1]):o(null)}catch(z){console.error("Error fetching data:",z),n(null),a([]),f([]),o(null),v({})}}r&&H()},[r]),Se.useEffect(()=>{if(i?w():m([]),s.length>0&&Object.keys(p).length>0)try{const H=M2(s,p);y(H)}catch(H){console.error("Error calculating house differences:",H),y({})}else y({});if(i&&s.length>0&&(e!=null&&e.hr))try{const H=bN(s,i,e.hr);F(H)}catch(H){console.error("Error calculating group counts:",H),F({})}else F({})},[i,s,p,e]),Se.useEffect(()=>{if(u&&Object.keys(u).length>0){const H={};aa.forEach(z=>{H[z]={Ar:0,Ta:0,Ge:0},u[z]&&zs.forEach(K=>{const j=u[z][K],J=rg(j);J&&H[z][J]++})}),B(H)}else B({})},[u]);const x=()=>{if(!u||!i||!(e!=null&&e.hr)||!b){console.log("Calculation skipped: Missing excelData, selectedDate, user.hr, or houseDifferences");return}const H=T(i),z={},K={};for(let j=1;j<=e.hr;j++){const J={},P={};aa.forEach(D=>{J[D]=0,P[D]=0}),zs.forEach(D=>{var ne;const G=S(j,D),re=(ne=G==null?void 0:G.match(/^[A-Za-z]{2}/))==null?void 0:ne[0];let te=null;if(H!==null&&H>1){const le=`${j}_${D}_${H}`,oe=b[le];oe!=null&&!isNaN(oe)&&(te=parseInt(oe,10))}aa.forEach(le=>{var ue,pe;const oe=(ue=u==null?void 0:u[le])==null?void 0:ue[D],ee=(pe=oe==null?void 0:oe.match(/^[A-Za-z]{2}/))==null?void 0:pe[0];let Z=null;if(re&&ee){const fe=ng(re,ee);fe!==null&&!isNaN(fe)&&(Z=fe)}j===1&&le==="Su"&&["D-10","D-3","D-27"].includes(D)&&console.log(`DEBUG_CALC (HR-1, Su, ${D}): UserNum=${te} (Diff), PlanetNum=${Z} (Steps) (from UserHouse='${re}', PlanetHouse='${ee}')`),te!==null&&Z!==null&&te===Z&&(J[le]++,j===1&&le==="Su"&&["D-10","D-3","D-27"].includes(D)&&console.log(`   -> FOUND SAME NUMBER MATCH (Calc) for HR-1, Su at Division=${D}`));const se=re?rg(re):null,ie=ee?rg(ee):null;se&&ie&&se===ie&&P[le]++})}),z[j]=J,K[j]=P}V(z),C(K)};Se.useEffect(()=>{u&&s.length>0&&i&&(e!=null&&e.hr)?(E(!1),x()):(V({}),C({}),E(!1))},[u,s,i,e==null?void 0:e.hr]),Se.useEffect(()=>{const H=Object.keys(q).length>0,z=Object.keys(I).length>0;H&&z?(E(!0),console.log("Counts calculated and flag set to true.")):console.log("Count data not ready, flag remains false.")},[q,I]);const w=async()=>{if(!i){m([]);return}try{const{data:H,error:z}=await Lt.from("DayDetails").select("*").eq("user_id",r).eq("future_date",i);if(z)throw z;m(H||[])}catch(H){console.error("Error fetching DayDetails:",H),m([])}},_=(H,z)=>{console.log("Received data from ExcelUpload component:",H),d(H),console.log("Excel data state AFTER setExcelData:",H),N(z)},S=(H,z)=>{const K=s.find(j=>j.hr_number===`HR-${H}`&&j.topic===z&&j.date===i);return(K==null?void 0:K.planet_house)||"-"},T=H=>{if(!H)return null;for(const[z,K]of Object.entries(p))if(K===H)return parseInt(z);return null},U=(H,z)=>{const K=T(i);if(K===null||K<=1)return"";const j=`${H}_${z}_${K}`,J=b[j];return J!=null?`(${J})`:""},A=async()=>{var H;try{const z=new Xb.Workbook,K=z.addWorksheet("Day Details"),j=K.addRow(["Date:",i]);j.font={bold:!0},K.addRow([]);for(let re=1;re<=e.hr;re++){const te=K.addRow([`HR-${re}`]);te.font={bold:!0,size:14},te.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD3D3D3"}};let ne=0;const le=["Topic","House (Count)",...aa],oe=K.addRow(le);if(oe.font={bold:!0},oe.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCCCCC"}},ne=le.length,ne>0&&(K.mergeCells(te.getCell(1).address,te.getCell(ne).address),te.getCell(1).alignment={horizontal:"center"}),zs.forEach(ee=>{var pe;const Z=[],se=S(re,ee),ie=U(re,ee),ue=(pe=se==null?void 0:se.match(/^[A-Za-z]{2}/))==null?void 0:pe[0];Z.push(`HR-${re} ${ee}`),Z.push(`${se} ${ie}`.trim()),aa.forEach(fe=>{var je,qe;const ye=((je=u==null?void 0:u[fe])==null?void 0:je[ee])||"-",Te=(qe=ye==null?void 0:ye.match(/^[A-Za-z]{2}/))==null?void 0:qe[0],Pe=ng(ue,Te);Z.push(`${ye} ${Pe!==null?`(${Pe})`:""}`.trim())}),K.addRow(Z)}),O){["Ar","Ta","Ge"].forEach(ue=>{const pe=[`Group ${ue}`,"-"],fe=zl(ue);aa.forEach(Pe=>{var qe;const je=((qe=R[Pe])==null?void 0:qe[ue])||0;pe.push(je)});const ye=K.addRow(pe);ye.font={bold:!0};let Te="FFFFFFFF";fe.includes("#DCEDC1")?Te="FFDCEDC1":fe.includes("#FFD3B6")?Te="FFFFD3B6":fe.includes("#FFAAA5")&&(Te="FFFFAAA5"),ye.fill={type:"pattern",pattern:"solid",fgColor:{argb:Te}},ye.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:Te}}});const ee=["Same Numbers","-"];aa.forEach(ue=>{var fe;const pe=((fe=q[re])==null?void 0:fe[ue])||0;ee.push(pe)});const Z=K.addRow(ee);Z.font={bold:!0},Z.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0E0E0"}},Z.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0E0E0"}};const se=["Same Groups","-"];aa.forEach(ue=>{var fe;const pe=((fe=I[re])==null?void 0:fe[ue])||0;se.push(pe)});const ie=K.addRow(se);ie.font={bold:!0},ie.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0E0E0"}},ie.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0E0E0"}}}K.addRow([])}K.eachRow((re,te)=>{var le;(((le=re.getCell(1).value)==null?void 0:le.toString())||"").match(/^HR-\d+ D-\d+/)&&re.eachCell({includeEmpty:!0},(oe,ee)=>{var Z,se;if(ee>=2){const ue=(se=(((Z=oe.value)==null?void 0:Z.toString())||"").match(/^[A-Za-z]{2}/))==null?void 0:se[0];if(ue){const pe=zl(ue);let fe="FFFFFFFF";pe.includes("#DCEDC1")?fe="FFDCEDC1":pe.includes("#FFD3B6")?fe="FFFFD3B6":pe.includes("#FFAAA5")&&(fe="FFFFAAA5"),oe.fill={type:"pattern",pattern:"solid",fgColor:{argb:fe}}}}})}),K.columns.forEach(re=>{let te=0;re.eachCell({includeEmpty:!0},ne=>{let le=ne.value?ne.value.toString().length:0;le>te&&(te=le)}),re.width=te<10?10:te+2});const J=await z.xlsx.writeBuffer(),P=new Blob([J],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),D=document.createElement("a");D.href=URL.createObjectURL(P);const G=((H=k==null?void 0:k.match(/\d{1,2}-\d{1,2}-\d{2}/))==null?void 0:H[0])||i||"no_date";D.download=`${(e==null?void 0:e.username)||"User"}_DayDetails_${G}.xlsx`,D.click()}catch(z){console.error("Excel download failed:",z)}};return r?e?h.length===0?X.jsx("div",{className:"min-h-screen bg-gray-100 p-4",children:X.jsxs("div",{className:"max-w-full mx-auto",children:[X.jsxs("div",{className:"flex justify-between items-center mb-4",children:[X.jsx("h1",{className:"text-2xl font-bold",children:e.username}),X.jsx("button",{onClick:()=>t("/"),className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"Back"})]}),X.jsx("p",{className:"text-center text-gray-600 mt-10",children:"No date entries found for this user."})]})}):i?X.jsx("div",{className:"min-h-screen bg-gray-100 p-4",children:X.jsxs("div",{className:"max-w-full mx-auto overflow-x-auto",children:[X.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-4 gap-4",children:[X.jsxs("h1",{className:"text-2xl font-bold",children:[e.username," - Selected Date: ",i]}),X.jsxs("div",{className:"flex items-center gap-4",children:[X.jsx(uS,{onDataUploaded:(H,z)=>_(H,z),icon:""}),k?X.jsx("div",{className:"file-name-display",children:X.jsx("span",{children:k})}):null,X.jsxs("div",{className:"flex items-center gap-2",children:[X.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select Date:"}),X.jsx("select",{value:i,onChange:H=>o(H.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:h.map((H,z)=>X.jsx("option",{value:H,children:H},z))})]}),X.jsx("button",{onClick:A,className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 text-sm",children:"Download Excel"}),X.jsx("button",{onClick:()=>t(`/abcd-number/${r}`),className:"bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 text-sm",children:"ABCD Number"}),X.jsx("button",{onClick:()=>t("/number-gen"),className:"bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 text-sm",children:"Number Gen"}),X.jsx("button",{onClick:()=>t(`/user-data/${r}`),className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 text-sm",children:"Back"})]})]}),g.length>0&&X.jsxs("div",{className:"mb-8 bg-white p-4 rounded shadow",children:[X.jsxs("h2",{className:"text-lg font-bold mb-4",children:["Predictions for ",i]}),X.jsxs("table",{className:"w-full border-collapse bg-gray-100 text-sm",children:[X.jsx("thead",{children:X.jsxs("tr",{children:[X.jsx("th",{className:"p-2 text-left font-medium text-gray-700 bg-gray-200 border",children:"HR Number"}),X.jsx("th",{className:"p-2 text-left font-medium text-gray-700 bg-gray-200 border",children:"Division"}),X.jsx("th",{className:"p-2 text-left font-medium text-gray-700 bg-gray-200 border",children:"Predicted House"})]})}),X.jsx("tbody",{children:g.map((H,z)=>X.jsxs("tr",{children:[X.jsx("td",{className:"p-2 text-gray-800 border",children:H.hr_number}),X.jsx("td",{className:"p-2 text-gray-800 border",children:H.division}),X.jsx("td",{className:"p-2 text-gray-800 border",children:H.predicted_house})]},z))})]})]}),Array.from({length:e.hr},(H,z)=>z+1).map(H=>X.jsxs("div",{className:"mb-8 bg-white p-4 rounded shadow",children:[X.jsxs("h2",{className:"text-lg font-bold mb-4",children:["HR-",H]}),X.jsx("div",{className:"overflow-x-auto",children:X.jsxs("table",{className:"w-full border-collapse bg-gray-100 text-sm mb-4",children:[X.jsx("thead",{children:X.jsxs("tr",{children:[X.jsx("th",{className:"p-2 text-left font-medium text-gray-700 bg-gray-200 border sticky left-0 z-20",children:"Division"}),X.jsx("th",{className:"p-2 text-left font-medium text-gray-700 bg-gray-200 border",children:"House (Count)"}),aa.map(z=>X.jsx("th",{className:"p-2 text-center font-medium text-gray-700 bg-gray-200 border",children:z},z))]})}),X.jsxs("tbody",{children:[zs.map(z=>{const K=S(H,z),j=U(H,z);return X.jsxs("tr",{children:[X.jsx("td",{className:"p-2 text-gray-800 border sticky left-0 z-10 bg-white",children:z}),X.jsx("td",{className:`p-2 text-sm border ${zl(K)} ${Ew(K)}`,children:X.jsxs("div",{children:[K," ",j]})}),aa.map(J=>{var ne;const P=((ne=u==null?void 0:u[J])==null?void 0:ne[z])||"-",D=P!=="-"?zl(P):"",G=P!=="-"?Ew(P):"",re=ng(K,P),te=re!==null?`(${re})`:"";return X.jsxs("td",{className:`p-2 text-center border ${D} ${G}`,children:[P," ",te]},J)})]},z)}),O&&X.jsxs(X.Fragment,{children:[["Ar","Ta","Ge"].map(z=>{const K=zl(z);return X.jsxs("tr",{className:`${K} font-medium`,children:[X.jsxs("td",{className:`p-2 text-left border sticky left-0 z-10 ${K}`,children:["Group ",z]}),X.jsx("td",{className:"p-2 text-left border",children:"-"})," ",aa.map(j=>{var P;const J=((P=R[j])==null?void 0:P[z])||0;return X.jsx("td",{className:"p-2 text-center border",children:J},`${j}-${z}`)})]},z)}),X.jsxs("tr",{className:"bg-gray-200 font-medium",children:[X.jsx("td",{className:"p-2 text-left border sticky left-0 z-10 bg-gray-200",children:"Same Numbers"}),X.jsx("td",{className:"p-2 text-left border",children:"-"}),aa.map(z=>{var j;const K=((j=q[H])==null?void 0:j[z])||0;return X.jsx("td",{className:"p-2 text-center border",children:K},z)})]}),X.jsxs("tr",{className:"bg-gray-200 font-medium",children:[X.jsx("td",{className:"p-2 text-left border sticky left-0 z-10 bg-gray-200",children:"Same Groups"}),X.jsx("td",{className:"p-2 text-left border",children:"-"}),aa.map(z=>{var j;const K=((j=I[H])==null?void 0:j[z])||0;return X.jsx("td",{className:"p-2 text-center border",children:K},z)})]})]})]})]})})]},H))]})}):X.jsx("div",{className:"p-4 text-center text-yellow-600",children:"Please select a date."}):X.jsx("div",{className:"p-4",children:X.jsx("h2",{className:"text-xl font-bold",children:"Loading User Data..."})}):X.jsx("div",{className:"p-4 text-center text-red-500",children:"User ID not found in URL."})}function kr(t){"@babel/helpers - typeof";return kr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},kr(t)}function DI(t,r){if(kr(t)!="object"||!t)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var n=e.call(t,r);if(kr(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function mS(t){var r=DI(t,"string");return kr(r)=="symbol"?r:r+""}function Vf(t,r,e){return(r=mS(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function O5(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),e.push.apply(e,n)}return e}function Jt(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?O5(Object(e),!0).forEach(function(n){Vf(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):O5(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function RI(t){if(Array.isArray(t))return t}function PI(t,r){var e=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n,s,a,i,o=[],l=!0,c=!1;try{if(a=(e=e.call(t)).next,r===0){if(Object(e)!==e)return;l=!1}else for(;!(l=(n=a.call(e)).done)&&(o.push(n.value),o.length!==r);l=!0);}catch(u){c=!0,s=u}finally{try{if(!l&&e.return!=null&&(i=e.return(),Object(i)!==i))return}finally{if(c)throw s}}return o}}function G2(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function gS(t,r){if(t){if(typeof t=="string")return G2(t,r);var e={}.toString.call(t).slice(8,-1);return e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set"?Array.from(t):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?G2(t,r):void 0}}function OI(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function so(t,r){return RI(t)||PI(t,r)||gS(t,r)||OI()}function MI(t,r){if(t==null)return{};var e={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(r.indexOf(n)!==-1)continue;e[n]=t[n]}return e}function vo(t,r){if(t==null)return{};var e,n,s=MI(t,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)e=a[n],r.indexOf(e)===-1&&{}.propertyIsEnumerable.call(t,e)&&(s[e]=t[e])}return s}var FI=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function jI(t){var r=t.defaultInputValue,e=r===void 0?"":r,n=t.defaultMenuIsOpen,s=n===void 0?!1:n,a=t.defaultValue,i=a===void 0?null:a,o=t.inputValue,l=t.menuIsOpen,c=t.onChange,u=t.onInputChange,d=t.onMenuClose,h=t.onMenuOpen,f=t.value,g=vo(t,FI),m=Se.useState(o!==void 0?o:e),p=so(m,2),v=p[0],b=p[1],y=Se.useState(l!==void 0?l:s),k=so(y,2),N=k[0],L=k[1],F=Se.useState(f!==void 0?f:i),R=so(F,2),B=R[0],q=R[1],V=Se.useCallback(function(_,S){typeof c=="function"&&c(_,S),q(_)},[c]),I=Se.useCallback(function(_,S){var T;typeof u=="function"&&(T=u(_,S)),b(T!==void 0?T:_)},[u]),C=Se.useCallback(function(){typeof h=="function"&&h(),L(!0)},[h]),O=Se.useCallback(function(){typeof d=="function"&&d(),L(!1)},[d]),E=o!==void 0?o:v,x=l!==void 0?l:N,w=f!==void 0?f:B;return Jt(Jt({},g),{},{inputValue:E,menuIsOpen:x,onChange:V,onInputChange:I,onMenuClose:O,onMenuOpen:C,value:w})}function Qt(){return Qt=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)({}).hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Qt.apply(null,arguments)}function LI(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function M5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mS(n.key),n)}}function II(t,r,e){return r&&M5(t.prototype,r),e&&M5(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function X2(t,r){return X2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},X2(t,r)}function BI(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&X2(t,r)}function Op(t){return Op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Op(t)}function vS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vS=function(){return!!t})()}function $I(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function UI(t,r){if(r&&(kr(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $I(t)}function HI(t){var r=vS();return function(){var e,n=Op(t);if(r){var s=Op(this).constructor;e=Reflect.construct(n,arguments,s)}else e=n.apply(this,arguments);return UI(this,e)}}function zI(t){if(Array.isArray(t))return G2(t)}function VI(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qI(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kb(t){return zI(t)||VI(t)||gS(t)||qI()}function WI(t){if(t.sheet)return t.sheet;for(var r=0;r<document.styleSheets.length;r++)if(document.styleSheets[r].ownerNode===t)return document.styleSheets[r]}function GI(t){var r=document.createElement("style");return r.setAttribute("data-emotion",t.key),t.nonce!==void 0&&r.setAttribute("nonce",t.nonce),r.appendChild(document.createTextNode("")),r.setAttribute("data-s",""),r}var XI=function(){function t(e){var n=this;this._insertTag=function(s){var a;n.tags.length===0?n.insertionPoint?a=n.insertionPoint.nextSibling:n.prepend?a=n.container.firstChild:a=n.before:a=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(s,a),n.tags.push(s)},this.isSpeedy=e.speedy===void 0?!0:e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var r=t.prototype;return r.hydrate=function(n){n.forEach(this._insertTag)},r.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(GI(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var a=WI(s);try{a.insertRule(n,a.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(n));this.ctr++},r.flush=function(){this.tags.forEach(function(n){var s;return(s=n.parentNode)==null?void 0:s.removeChild(n)}),this.tags=[],this.ctr=0},t}(),fs="-ms-",Mp="-moz-",Nr="-webkit-",bS="comm",Yb="rule",Jb="decl",KI="@import",yS="@keyframes",YI="@layer",JI=Math.abs,xm=String.fromCharCode,ZI=Object.assign;function QI(t,r){return Jn(t,0)^45?(((r<<2^Jn(t,0))<<2^Jn(t,1))<<2^Jn(t,2))<<2^Jn(t,3):0}function xS(t){return t.trim()}function eB(t,r){return(t=r.exec(t))?t[0]:t}function Dr(t,r,e){return t.replace(r,e)}function K2(t,r){return t.indexOf(r)}function Jn(t,r){return t.charCodeAt(r)|0}function Vh(t,r,e){return t.slice(r,e)}function wi(t){return t.length}function Zb(t){return t.length}function x0(t,r){return r.push(t),t}function tB(t,r){return t.map(r).join("")}var wm=1,ju=1,wS=0,Js=0,An=0,Xu="";function _m(t,r,e,n,s,a,i){return{value:t,root:r,parent:e,type:n,props:s,children:a,line:wm,column:ju,length:i,return:""}}function Rf(t,r){return ZI(_m("",null,null,"",null,null,0),t,{length:-t.length},r)}function rB(){return An}function nB(){return An=Js>0?Jn(Xu,--Js):0,ju--,An===10&&(ju=1,wm--),An}function ha(){return An=Js<wS?Jn(Xu,Js++):0,ju++,An===10&&(ju=1,wm++),An}function Ci(){return Jn(Xu,Js)}function U0(){return Js}function od(t,r){return Vh(Xu,t,r)}function qh(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function _S(t){return wm=ju=1,wS=wi(Xu=t),Js=0,[]}function SS(t){return Xu="",t}function H0(t){return xS(od(Js-1,Y2(t===91?t+2:t===40?t+1:t)))}function sB(t){for(;(An=Ci())&&An<33;)ha();return qh(t)>2||qh(An)>3?"":" "}function aB(t,r){for(;--r&&ha()&&!(An<48||An>102||An>57&&An<65||An>70&&An<97););return od(t,U0()+(r<6&&Ci()==32&&ha()==32))}function Y2(t){for(;ha();)switch(An){case t:return Js;case 34:case 39:t!==34&&t!==39&&Y2(An);break;case 40:t===41&&Y2(t);break;case 92:ha();break}return Js}function iB(t,r){for(;ha()&&t+An!==57;)if(t+An===84&&Ci()===47)break;return"/*"+od(r,Js-1)+"*"+xm(t===47?t:ha())}function oB(t){for(;!qh(Ci());)ha();return od(t,Js)}function lB(t){return SS(z0("",null,null,null,[""],t=_S(t),0,[0],t))}function z0(t,r,e,n,s,a,i,o,l){for(var c=0,u=0,d=i,h=0,f=0,g=0,m=1,p=1,v=1,b=0,y="",k=s,N=a,L=n,F=y;p;)switch(g=b,b=ha()){case 40:if(g!=108&&Jn(F,d-1)==58){K2(F+=Dr(H0(b),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:F+=H0(b);break;case 9:case 10:case 13:case 32:F+=sB(g);break;case 92:F+=aB(U0()-1,7);continue;case 47:switch(Ci()){case 42:case 47:x0(cB(iB(ha(),U0()),r,e),l);break;default:F+="/"}break;case 123*m:o[c++]=wi(F)*v;case 125*m:case 59:case 0:switch(b){case 0:case 125:p=0;case 59+u:v==-1&&(F=Dr(F,/\f/g,"")),f>0&&wi(F)-d&&x0(f>32?j5(F+";",n,e,d-1):j5(Dr(F," ","")+";",n,e,d-2),l);break;case 59:F+=";";default:if(x0(L=F5(F,r,e,c,u,s,o,y,k=[],N=[],d),a),b===123)if(u===0)z0(F,r,L,L,k,a,d,o,N);else switch(h===99&&Jn(F,3)===110?100:h){case 100:case 108:case 109:case 115:z0(t,L,L,n&&x0(F5(t,L,L,0,0,s,o,y,s,k=[],d),N),s,N,d,o,n?k:N);break;default:z0(F,L,L,L,[""],N,0,o,N)}}c=u=f=0,m=v=1,y=F="",d=i;break;case 58:d=1+wi(F),f=g;default:if(m<1){if(b==123)--m;else if(b==125&&m++==0&&nB()==125)continue}switch(F+=xm(b),b*m){case 38:v=u>0?1:(F+="\f",-1);break;case 44:o[c++]=(wi(F)-1)*v,v=1;break;case 64:Ci()===45&&(F+=H0(ha())),h=Ci(),u=d=wi(y=F+=oB(U0())),b++;break;case 45:g===45&&wi(F)==2&&(m=0)}}return a}function F5(t,r,e,n,s,a,i,o,l,c,u){for(var d=s-1,h=s===0?a:[""],f=Zb(h),g=0,m=0,p=0;g<n;++g)for(var v=0,b=Vh(t,d+1,d=JI(m=i[g])),y=t;v<f;++v)(y=xS(m>0?h[v]+" "+b:Dr(b,/&\f/g,h[v])))&&(l[p++]=y);return _m(t,r,e,s===0?Yb:o,l,c,u)}function cB(t,r,e){return _m(t,r,e,bS,xm(rB()),Vh(t,2,-2),0)}function j5(t,r,e,n){return _m(t,r,e,Jb,Vh(t,0,n),Vh(t,n+1,-1),n)}function xu(t,r){for(var e="",n=Zb(t),s=0;s<n;s++)e+=r(t[s],s,t,r)||"";return e}function uB(t,r,e,n){switch(t.type){case YI:if(t.children.length)break;case KI:case Jb:return t.return=t.return||t.value;case bS:return"";case yS:return t.return=t.value+"{"+xu(t.children,n)+"}";case Yb:t.value=t.props.join(",")}return wi(e=xu(t.children,n))?t.return=t.value+"{"+e+"}":""}function fB(t){var r=Zb(t);return function(e,n,s,a){for(var i="",o=0;o<r;o++)i+=t[o](e,n,s,a)||"";return i}}function hB(t){return function(r){r.root||(r=r.return)&&t(r)}}function dB(t){var r=Object.create(null);return function(e){return r[e]===void 0&&(r[e]=t(e)),r[e]}}var pB=function(r,e,n){for(var s=0,a=0;s=a,a=Ci(),s===38&&a===12&&(e[n]=1),!qh(a);)ha();return od(r,Js)},mB=function(r,e){var n=-1,s=44;do switch(qh(s)){case 0:s===38&&Ci()===12&&(e[n]=1),r[n]+=pB(Js-1,e,n);break;case 2:r[n]+=H0(s);break;case 4:if(s===44){r[++n]=Ci()===58?"&\f":"",e[n]=r[n].length;break}default:r[n]+=xm(s)}while(s=ha());return r},gB=function(r,e){return SS(mB(_S(r),e))},L5=new WeakMap,vB=function(r){if(!(r.type!=="rule"||!r.parent||r.length<1)){for(var e=r.value,n=r.parent,s=r.column===n.column&&r.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(r.props.length===1&&e.charCodeAt(0)!==58&&!L5.get(n))&&!s){L5.set(r,!0);for(var a=[],i=gB(e,a),o=n.props,l=0,c=0;l<i.length;l++)for(var u=0;u<o.length;u++,c++)r.props[c]=a[l]?i[l].replace(/&\f/g,o[u]):o[u]+" "+i[l]}}},bB=function(r){if(r.type==="decl"){var e=r.value;e.charCodeAt(0)===108&&e.charCodeAt(2)===98&&(r.return="",r.value="")}};function kS(t,r){switch(QI(t,r)){case 5103:return Nr+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Nr+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Nr+t+Mp+t+fs+t+t;case 6828:case 4268:return Nr+t+fs+t+t;case 6165:return Nr+t+fs+"flex-"+t+t;case 5187:return Nr+t+Dr(t,/(\w+).+(:[^]+)/,Nr+"box-$1$2"+fs+"flex-$1$2")+t;case 5443:return Nr+t+fs+"flex-item-"+Dr(t,/flex-|-self/,"")+t;case 4675:return Nr+t+fs+"flex-line-pack"+Dr(t,/align-content|flex-|-self/,"")+t;case 5548:return Nr+t+fs+Dr(t,"shrink","negative")+t;case 5292:return Nr+t+fs+Dr(t,"basis","preferred-size")+t;case 6060:return Nr+"box-"+Dr(t,"-grow","")+Nr+t+fs+Dr(t,"grow","positive")+t;case 4554:return Nr+Dr(t,/([^-])(transform)/g,"$1"+Nr+"$2")+t;case 6187:return Dr(Dr(Dr(t,/(zoom-|grab)/,Nr+"$1"),/(image-set)/,Nr+"$1"),t,"")+t;case 5495:case 3959:return Dr(t,/(image-set\([^]*)/,Nr+"$1$`$1");case 4968:return Dr(Dr(t,/(.+:)(flex-)?(.*)/,Nr+"box-pack:$3"+fs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Nr+t+t;case 4095:case 3583:case 4068:case 2532:return Dr(t,/(.+)-inline(.+)/,Nr+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(wi(t)-1-r>6)switch(Jn(t,r+1)){case 109:if(Jn(t,r+4)!==45)break;case 102:return Dr(t,/(.+:)(.+)-([^]+)/,"$1"+Nr+"$2-$3$1"+Mp+(Jn(t,r+3)==108?"$3":"$2-$3"))+t;case 115:return~K2(t,"stretch")?kS(Dr(t,"stretch","fill-available"),r)+t:t}break;case 4949:if(Jn(t,r+1)!==115)break;case 6444:switch(Jn(t,wi(t)-3-(~K2(t,"!important")&&10))){case 107:return Dr(t,":",":"+Nr)+t;case 101:return Dr(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Nr+(Jn(t,14)===45?"inline-":"")+"box$3$1"+Nr+"$2$3$1"+fs+"$2box$3")+t}break;case 5936:switch(Jn(t,r+11)){case 114:return Nr+t+fs+Dr(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Nr+t+fs+Dr(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Nr+t+fs+Dr(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Nr+t+fs+t+t}return t}var yB=function(r,e,n,s){if(r.length>-1&&!r.return)switch(r.type){case Jb:r.return=kS(r.value,r.length);break;case yS:return xu([Rf(r,{value:Dr(r.value,"@","@"+Nr)})],s);case Yb:if(r.length)return tB(r.props,function(a){switch(eB(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return xu([Rf(r,{props:[Dr(a,/:(read-\w+)/,":"+Mp+"$1")]})],s);case"::placeholder":return xu([Rf(r,{props:[Dr(a,/:(plac\w+)/,":"+Nr+"input-$1")]}),Rf(r,{props:[Dr(a,/:(plac\w+)/,":"+Mp+"$1")]}),Rf(r,{props:[Dr(a,/:(plac\w+)/,fs+"input-$1")]})],s)}return""})}},xB=[yB],wB=function(r){var e=r.key;if(e==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(m){var p=m.getAttribute("data-emotion");p.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var s=r.stylisPlugins||xB,a={},i,o=[];i=r.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),function(m){for(var p=m.getAttribute("data-emotion").split(" "),v=1;v<p.length;v++)a[p[v]]=!0;o.push(m)});var l,c=[vB,bB];{var u,d=[uB,hB(function(m){u.insert(m)})],h=fB(c.concat(s,d)),f=function(p){return xu(lB(p),h)};l=function(p,v,b,y){u=b,f(p?p+"{"+v.styles+"}":v.styles),y&&(g.inserted[v.name]=!0)}}var g={key:e,sheet:new XI({key:e,container:i,nonce:r.nonce,speedy:r.speedy,prepend:r.prepend,insertionPoint:r.insertionPoint}),nonce:r.nonce,inserted:a,registered:{},insert:l};return g.sheet.hydrate(o),g},ES={exports:{}},Mr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qn=typeof Symbol=="function"&&Symbol.for,Qb=qn?Symbol.for("react.element"):60103,ey=qn?Symbol.for("react.portal"):60106,Sm=qn?Symbol.for("react.fragment"):60107,km=qn?Symbol.for("react.strict_mode"):60108,Em=qn?Symbol.for("react.profiler"):60114,Am=qn?Symbol.for("react.provider"):60109,Cm=qn?Symbol.for("react.context"):60110,ty=qn?Symbol.for("react.async_mode"):60111,Tm=qn?Symbol.for("react.concurrent_mode"):60111,Nm=qn?Symbol.for("react.forward_ref"):60112,Dm=qn?Symbol.for("react.suspense"):60113,_B=qn?Symbol.for("react.suspense_list"):60120,Rm=qn?Symbol.for("react.memo"):60115,Pm=qn?Symbol.for("react.lazy"):60116,SB=qn?Symbol.for("react.block"):60121,kB=qn?Symbol.for("react.fundamental"):60117,EB=qn?Symbol.for("react.responder"):60118,AB=qn?Symbol.for("react.scope"):60119;function va(t){if(typeof t=="object"&&t!==null){var r=t.$$typeof;switch(r){case Qb:switch(t=t.type,t){case ty:case Tm:case Sm:case Em:case km:case Dm:return t;default:switch(t=t&&t.$$typeof,t){case Cm:case Nm:case Pm:case Rm:case Am:return t;default:return r}}case ey:return r}}}function AS(t){return va(t)===Tm}Mr.AsyncMode=ty;Mr.ConcurrentMode=Tm;Mr.ContextConsumer=Cm;Mr.ContextProvider=Am;Mr.Element=Qb;Mr.ForwardRef=Nm;Mr.Fragment=Sm;Mr.Lazy=Pm;Mr.Memo=Rm;Mr.Portal=ey;Mr.Profiler=Em;Mr.StrictMode=km;Mr.Suspense=Dm;Mr.isAsyncMode=function(t){return AS(t)||va(t)===ty};Mr.isConcurrentMode=AS;Mr.isContextConsumer=function(t){return va(t)===Cm};Mr.isContextProvider=function(t){return va(t)===Am};Mr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Qb};Mr.isForwardRef=function(t){return va(t)===Nm};Mr.isFragment=function(t){return va(t)===Sm};Mr.isLazy=function(t){return va(t)===Pm};Mr.isMemo=function(t){return va(t)===Rm};Mr.isPortal=function(t){return va(t)===ey};Mr.isProfiler=function(t){return va(t)===Em};Mr.isStrictMode=function(t){return va(t)===km};Mr.isSuspense=function(t){return va(t)===Dm};Mr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Sm||t===Tm||t===Em||t===km||t===Dm||t===_B||typeof t=="object"&&t!==null&&(t.$$typeof===Pm||t.$$typeof===Rm||t.$$typeof===Am||t.$$typeof===Cm||t.$$typeof===Nm||t.$$typeof===kB||t.$$typeof===EB||t.$$typeof===AB||t.$$typeof===SB)};Mr.typeOf=va;ES.exports=Mr;var CB=ES.exports,CS=CB,TB={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},NB={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},TS={};TS[CS.ForwardRef]=TB;TS[CS.Memo]=NB;var DB=!0;function RB(t,r,e){var n="";return e.split(" ").forEach(function(s){t[s]!==void 0?r.push(t[s]+";"):s&&(n+=s+" ")}),n}var NS=function(r,e,n){var s=r.key+"-"+e.name;(n===!1||DB===!1)&&r.registered[s]===void 0&&(r.registered[s]=e.styles)},PB=function(r,e,n){NS(r,e,n);var s=r.key+"-"+e.name;if(r.inserted[e.name]===void 0){var a=e;do r.insert(e===a?"."+s:"",a,r.sheet,!0),a=a.next;while(a!==void 0)}};function OB(t){for(var r=0,e,n=0,s=t.length;s>=4;++n,s-=4)e=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,e=(e&65535)*1540483477+((e>>>16)*59797<<16),e^=e>>>24,r=(e&65535)*1540483477+((e>>>16)*59797<<16)^(r&65535)*1540483477+((r>>>16)*59797<<16);switch(s){case 3:r^=(t.charCodeAt(n+2)&255)<<16;case 2:r^=(t.charCodeAt(n+1)&255)<<8;case 1:r^=t.charCodeAt(n)&255,r=(r&65535)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,r=(r&65535)*1540483477+((r>>>16)*59797<<16),((r^r>>>15)>>>0).toString(36)}var MB={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},FB=/[A-Z]|^ms/g,jB=/_EMO_([^_]+?)_([^]*?)_EMO_/g,DS=function(r){return r.charCodeAt(1)===45},I5=function(r){return r!=null&&typeof r!="boolean"},sg=dB(function(t){return DS(t)?t:t.replace(FB,"-$&").toLowerCase()}),B5=function(r,e){switch(r){case"animation":case"animationName":if(typeof e=="string")return e.replace(jB,function(n,s,a){return _i={name:s,styles:a,next:_i},s})}return MB[r]!==1&&!DS(r)&&typeof e=="number"&&e!==0?e+"px":e};function Wh(t,r,e){if(e==null)return"";var n=e;if(n.__emotion_styles!==void 0)return n;switch(typeof e){case"boolean":return"";case"object":{var s=e;if(s.anim===1)return _i={name:s.name,styles:s.styles,next:_i},s.name;var a=e;if(a.styles!==void 0){var i=a.next;if(i!==void 0)for(;i!==void 0;)_i={name:i.name,styles:i.styles,next:_i},i=i.next;var o=a.styles+";";return o}return LB(t,r,e)}case"function":{if(t!==void 0){var l=_i,c=e(t);return _i=l,Wh(t,r,c)}break}}var u=e;return u}function LB(t,r,e){var n="";if(Array.isArray(e))for(var s=0;s<e.length;s++)n+=Wh(t,r,e[s])+";";else for(var a in e){var i=e[a];if(typeof i!="object"){var o=i;I5(o)&&(n+=sg(a)+":"+B5(a,o)+";")}else if(Array.isArray(i)&&typeof i[0]=="string"&&r==null)for(var l=0;l<i.length;l++)I5(i[l])&&(n+=sg(a)+":"+B5(a,i[l])+";");else{var c=Wh(t,r,i);switch(a){case"animation":case"animationName":{n+=sg(a)+":"+c+";";break}default:n+=a+"{"+c+"}"}}}return n}var $5=/label:\s*([^\s;{]+)\s*(;|$)/g,_i;function RS(t,r,e){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,s="";_i=void 0;var a=t[0];if(a==null||a.raw===void 0)n=!1,s+=Wh(e,r,a);else{var i=a;s+=i[0]}for(var o=1;o<t.length;o++)if(s+=Wh(e,r,t[o]),n){var l=a;s+=l[o]}$5.lastIndex=0;for(var c="",u;(u=$5.exec(s))!==null;)c+="-"+u[1];var d=OB(s)+c;return{name:d,styles:s,next:_i}}var IB=function(r){return r()},BB=Tg.useInsertionEffect?Tg.useInsertionEffect:!1,$B=BB||IB,PS=Se.createContext(typeof HTMLElement<"u"?wB({key:"css"}):null);PS.Provider;var UB=function(r){return Se.forwardRef(function(e,n){var s=Se.useContext(PS);return r(e,s,n)})},HB=Se.createContext({}),ry={}.hasOwnProperty,J2="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",zB=function(r,e){var n={};for(var s in e)ry.call(e,s)&&(n[s]=e[s]);return n[J2]=r,n},VB=function(r){var e=r.cache,n=r.serialized,s=r.isStringTag;return NS(e,n,s),$B(function(){return PB(e,n,s)}),null},qB=UB(function(t,r,e){var n=t.css;typeof n=="string"&&r.registered[n]!==void 0&&(n=r.registered[n]);var s=t[J2],a=[n],i="";typeof t.className=="string"?i=RB(r.registered,a,t.className):t.className!=null&&(i=t.className+" ");var o=RS(a,void 0,Se.useContext(HB));i+=r.key+"-"+o.name;var l={};for(var c in t)ry.call(t,c)&&c!=="css"&&c!==J2&&(l[c]=t[c]);return l.className=i,e&&(l.ref=e),Se.createElement(Se.Fragment,null,Se.createElement(VB,{cache:r,serialized:o,isStringTag:typeof s=="string"}),Se.createElement(s,l))}),WB=qB,Wt=function(r,e){var n=arguments;if(e==null||!ry.call(e,"css"))return Se.createElement.apply(void 0,n);var s=n.length,a=new Array(s);a[0]=WB,a[1]=zB(r,e);for(var i=2;i<s;i++)a[i]=n[i];return Se.createElement.apply(null,a)};(function(t){var r;r||(r=t.JSX||(t.JSX={}))})(Wt||(Wt={}));function ny(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return RS(r)}function GB(){var t=ny.apply(void 0,arguments),r="animation-"+t.name;return{name:r,styles:"@keyframes "+r+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function XB(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}const KB=Math.min,YB=Math.max,Fp=Math.round,w0=Math.floor,jp=t=>({x:t,y:t});function JB(t){const{x:r,y:e,width:n,height:s}=t;return{width:n,height:s,top:e,left:r,right:r+n,bottom:e+s,x:r,y:e}}function Om(){return typeof window<"u"}function OS(t){return FS(t)?(t.nodeName||"").toLowerCase():"#document"}function uo(t){var r;return(t==null||(r=t.ownerDocument)==null?void 0:r.defaultView)||window}function MS(t){var r;return(r=(FS(t)?t.ownerDocument:t.document)||window.document)==null?void 0:r.documentElement}function FS(t){return Om()?t instanceof Node||t instanceof uo(t).Node:!1}function ZB(t){return Om()?t instanceof Element||t instanceof uo(t).Element:!1}function sy(t){return Om()?t instanceof HTMLElement||t instanceof uo(t).HTMLElement:!1}function U5(t){return!Om()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof uo(t).ShadowRoot}function jS(t){const{overflow:r,overflowX:e,overflowY:n,display:s}=ay(t);return/auto|scroll|overlay|hidden|clip/.test(r+n+e)&&!["inline","contents"].includes(s)}function QB(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function e$(t){return["html","body","#document"].includes(OS(t))}function ay(t){return uo(t).getComputedStyle(t)}function t$(t){if(OS(t)==="html")return t;const r=t.assignedSlot||t.parentNode||U5(t)&&t.host||MS(t);return U5(r)?r.host:r}function LS(t){const r=t$(t);return e$(r)?t.ownerDocument?t.ownerDocument.body:t.body:sy(r)&&jS(r)?r:LS(r)}function Lp(t,r,e){var n;r===void 0&&(r=[]),e===void 0&&(e=!0);const s=LS(t),a=s===((n=t.ownerDocument)==null?void 0:n.body),i=uo(s);if(a){const o=Z2(i);return r.concat(i,i.visualViewport||[],jS(s)?s:[],o&&e?Lp(o):[])}return r.concat(s,Lp(s,[],e))}function Z2(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function r$(t){const r=ay(t);let e=parseFloat(r.width)||0,n=parseFloat(r.height)||0;const s=sy(t),a=s?t.offsetWidth:e,i=s?t.offsetHeight:n,o=Fp(e)!==a||Fp(n)!==i;return o&&(e=a,n=i),{width:e,height:n,$:o}}function iy(t){return ZB(t)?t:t.contextElement}function H5(t){const r=iy(t);if(!sy(r))return jp(1);const e=r.getBoundingClientRect(),{width:n,height:s,$:a}=r$(r);let i=(a?Fp(e.width):e.width)/n,o=(a?Fp(e.height):e.height)/s;return(!i||!Number.isFinite(i))&&(i=1),(!o||!Number.isFinite(o))&&(o=1),{x:i,y:o}}const n$=jp(0);function s$(t){const r=uo(t);return!QB()||!r.visualViewport?n$:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function a$(t,r,e){return!1}function z5(t,r,e,n){r===void 0&&(r=!1);const s=t.getBoundingClientRect(),a=iy(t);let i=jp(1);r&&(i=H5(t));const o=a$()?s$(a):jp(0);let l=(s.left+o.x)/i.x,c=(s.top+o.y)/i.y,u=s.width/i.x,d=s.height/i.y;if(a){const h=uo(a),f=n;let g=h,m=Z2(g);for(;m&&n&&f!==g;){const p=H5(m),v=m.getBoundingClientRect(),b=ay(m),y=v.left+(m.clientLeft+parseFloat(b.paddingLeft))*p.x,k=v.top+(m.clientTop+parseFloat(b.paddingTop))*p.y;l*=p.x,c*=p.y,u*=p.x,d*=p.y,l+=y,c+=k,g=uo(m),m=Z2(g)}}return JB({width:u,height:d,x:l,y:c})}function IS(t,r){return t.x===r.x&&t.y===r.y&&t.width===r.width&&t.height===r.height}function i$(t,r){let e=null,n;const s=MS(t);function a(){var o;clearTimeout(n),(o=e)==null||o.disconnect(),e=null}function i(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),a();const c=t.getBoundingClientRect(),{left:u,top:d,width:h,height:f}=c;if(o||r(),!h||!f)return;const g=w0(d),m=w0(s.clientWidth-(u+h)),p=w0(s.clientHeight-(d+f)),v=w0(u),y={rootMargin:-g+"px "+-m+"px "+-p+"px "+-v+"px",threshold:YB(0,KB(1,l))||1};let k=!0;function N(L){const F=L[0].intersectionRatio;if(F!==l){if(!k)return i();F?i(!1,F):n=setTimeout(()=>{i(!1,1e-7)},1e3)}F===1&&!IS(c,t.getBoundingClientRect())&&i(),k=!1}try{e=new IntersectionObserver(N,{...y,root:s.ownerDocument})}catch{e=new IntersectionObserver(N,y)}e.observe(t)}return i(!0),a}function o$(t,r,e,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=iy(t),u=s||a?[...c?Lp(c):[],...Lp(r)]:[];u.forEach(v=>{s&&v.addEventListener("scroll",e,{passive:!0}),a&&v.addEventListener("resize",e)});const d=c&&o?i$(c,e):null;let h=-1,f=null;i&&(f=new ResizeObserver(v=>{let[b]=v;b&&b.target===c&&f&&(f.unobserve(r),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var y;(y=f)==null||y.observe(r)})),e()}),c&&!l&&f.observe(c),f.observe(r));let g,m=l?z5(t):null;l&&p();function p(){const v=z5(t);m&&!IS(m,v)&&e(),m=v,g=requestAnimationFrame(p)}return e(),()=>{var v;u.forEach(b=>{s&&b.removeEventListener("scroll",e),a&&b.removeEventListener("resize",e)}),d==null||d(),(v=f)==null||v.disconnect(),f=null,l&&cancelAnimationFrame(g)}}var Q2=Se.useLayoutEffect,l$=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Ip=function(){};function c$(t,r){return r?r[0]==="-"?t+r:t+"__"+r:t}function u$(t,r){for(var e=arguments.length,n=new Array(e>2?e-2:0),s=2;s<e;s++)n[s-2]=arguments[s];var a=[].concat(n);if(r&&t)for(var i in r)r.hasOwnProperty(i)&&r[i]&&a.push("".concat(c$(t,i)));return a.filter(function(o){return o}).map(function(o){return String(o).trim()}).join(" ")}var V5=function(r){return y$(r)?r.filter(Boolean):kr(r)==="object"&&r!==null?[r]:[]},BS=function(r){r.className,r.clearValue,r.cx,r.getStyles,r.getClassNames,r.getValue,r.hasValue,r.isMulti,r.isRtl,r.options,r.selectOption,r.selectProps,r.setValue,r.theme;var e=vo(r,l$);return Jt({},e)},on=function(r,e,n){var s=r.cx,a=r.getStyles,i=r.getClassNames,o=r.className;return{css:a(e,r),className:s(n??{},i(e,r),o)}};function Mm(t){return[document.documentElement,document.body,window].indexOf(t)>-1}function f$(t){return Mm(t)?window.innerHeight:t.clientHeight}function $S(t){return Mm(t)?window.pageYOffset:t.scrollTop}function Bp(t,r){if(Mm(t)){window.scrollTo(0,r);return}t.scrollTop=r}function h$(t){var r=getComputedStyle(t),e=r.position==="absolute",n=/(auto|scroll)/;if(r.position==="fixed")return document.documentElement;for(var s=t;s=s.parentElement;)if(r=getComputedStyle(s),!(e&&r.position==="static")&&n.test(r.overflow+r.overflowY+r.overflowX))return s;return document.documentElement}function d$(t,r,e,n){return e*((t=t/n-1)*t*t+1)+r}function _0(t,r){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ip,s=$S(t),a=r-s,i=10,o=0;function l(){o+=i;var c=d$(o,s,a,e);Bp(t,c),o<e?window.requestAnimationFrame(l):n(t)}l()}function q5(t,r){var e=t.getBoundingClientRect(),n=r.getBoundingClientRect(),s=r.offsetHeight/3;n.bottom+s>e.bottom?Bp(t,Math.min(r.offsetTop+r.clientHeight-t.offsetHeight+s,t.scrollHeight)):n.top-s<e.top&&Bp(t,Math.max(r.offsetTop-s,0))}function p$(t){var r=t.getBoundingClientRect();return{bottom:r.bottom,height:r.height,left:r.left,right:r.right,top:r.top,width:r.width}}function W5(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function m$(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var US=!1,g$={get passive(){return US=!0}},S0=typeof window<"u"?window:{};S0.addEventListener&&S0.removeEventListener&&(S0.addEventListener("p",Ip,g$),S0.removeEventListener("p",Ip,!1));var v$=US;function b$(t){return t!=null}function y$(t){return Array.isArray(t)}function k0(t,r,e){return t?r:e}var x$=function(r){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];var a=Object.entries(r).filter(function(i){var o=so(i,1),l=o[0];return!n.includes(l)});return a.reduce(function(i,o){var l=so(o,2),c=l[0],u=l[1];return i[c]=u,i},{})},w$=["children","innerProps"],_$=["children","innerProps"];function S$(t){var r=t.maxHeight,e=t.menuEl,n=t.minHeight,s=t.placement,a=t.shouldScroll,i=t.isFixedPosition,o=t.controlHeight,l=h$(e),c={placement:"bottom",maxHeight:r};if(!e||!e.offsetParent)return c;var u=l.getBoundingClientRect(),d=u.height,h=e.getBoundingClientRect(),f=h.bottom,g=h.height,m=h.top,p=e.offsetParent.getBoundingClientRect(),v=p.top,b=i?window.innerHeight:f$(l),y=$S(l),k=parseInt(getComputedStyle(e).marginBottom,10),N=parseInt(getComputedStyle(e).marginTop,10),L=v-N,F=b-m,R=L+y,B=d-y-m,q=f-b+y+k,V=y+m-N,I=160;switch(s){case"auto":case"bottom":if(F>=g)return{placement:"bottom",maxHeight:r};if(B>=g&&!i)return a&&_0(l,q,I),{placement:"bottom",maxHeight:r};if(!i&&B>=n||i&&F>=n){a&&_0(l,q,I);var C=i?F-k:B-k;return{placement:"bottom",maxHeight:C}}if(s==="auto"||i){var O=r,E=i?L:R;return E>=n&&(O=Math.min(E-k-o,r)),{placement:"top",maxHeight:O}}if(s==="bottom")return a&&Bp(l,q),{placement:"bottom",maxHeight:r};break;case"top":if(L>=g)return{placement:"top",maxHeight:r};if(R>=g&&!i)return a&&_0(l,V,I),{placement:"top",maxHeight:r};if(!i&&R>=n||i&&L>=n){var x=r;return(!i&&R>=n||i&&L>=n)&&(x=i?L-N:R-N),a&&_0(l,V,I),{placement:"top",maxHeight:x}}return{placement:"bottom",maxHeight:r};default:throw new Error('Invalid placement provided "'.concat(s,'".'))}return c}function k$(t){var r={bottom:"top",top:"bottom"};return t?r[t]:"bottom"}var HS=function(r){return r==="auto"?"bottom":r},E$=function(r,e){var n,s=r.placement,a=r.theme,i=a.borderRadius,o=a.spacing,l=a.colors;return Jt((n={label:"menu"},Vf(n,k$(s),"100%"),Vf(n,"position","absolute"),Vf(n,"width","100%"),Vf(n,"zIndex",1),n),e?{}:{backgroundColor:l.neutral0,borderRadius:i,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:o.menuGutter,marginTop:o.menuGutter})},zS=Se.createContext(null),A$=function(r){var e=r.children,n=r.minMenuHeight,s=r.maxMenuHeight,a=r.menuPlacement,i=r.menuPosition,o=r.menuShouldScrollIntoView,l=r.theme,c=Se.useContext(zS)||{},u=c.setPortalPlacement,d=Se.useRef(null),h=Se.useState(s),f=so(h,2),g=f[0],m=f[1],p=Se.useState(null),v=so(p,2),b=v[0],y=v[1],k=l.spacing.controlHeight;return Q2(function(){var N=d.current;if(N){var L=i==="fixed",F=o&&!L,R=S$({maxHeight:s,menuEl:N,minHeight:n,placement:a,shouldScroll:F,isFixedPosition:L,controlHeight:k});m(R.maxHeight),y(R.placement),u==null||u(R.placement)}},[s,a,i,o,n,u,k]),e({ref:d,placerProps:Jt(Jt({},r),{},{placement:b||HS(a),maxHeight:g})})},C$=function(r){var e=r.children,n=r.innerRef,s=r.innerProps;return Wt("div",Qt({},on(r,"menu",{menu:!0}),{ref:n},s),e)},T$=C$,N$=function(r,e){var n=r.maxHeight,s=r.theme.spacing.baseUnit;return Jt({maxHeight:n,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},e?{}:{paddingBottom:s,paddingTop:s})},D$=function(r){var e=r.children,n=r.innerProps,s=r.innerRef,a=r.isMulti;return Wt("div",Qt({},on(r,"menuList",{"menu-list":!0,"menu-list--is-multi":a}),{ref:s},n),e)},VS=function(r,e){var n=r.theme,s=n.spacing.baseUnit,a=n.colors;return Jt({textAlign:"center"},e?{}:{color:a.neutral40,padding:"".concat(s*2,"px ").concat(s*3,"px")})},R$=VS,P$=VS,O$=function(r){var e=r.children,n=e===void 0?"No options":e,s=r.innerProps,a=vo(r,w$);return Wt("div",Qt({},on(Jt(Jt({},a),{},{children:n,innerProps:s}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),s),n)},M$=function(r){var e=r.children,n=e===void 0?"Loading...":e,s=r.innerProps,a=vo(r,_$);return Wt("div",Qt({},on(Jt(Jt({},a),{},{children:n,innerProps:s}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),s),n)},F$=function(r){var e=r.rect,n=r.offset,s=r.position;return{left:e.left,position:s,top:n,width:e.width,zIndex:1}},j$=function(r){var e=r.appendTo,n=r.children,s=r.controlElement,a=r.innerProps,i=r.menuPlacement,o=r.menuPosition,l=Se.useRef(null),c=Se.useRef(null),u=Se.useState(HS(i)),d=so(u,2),h=d[0],f=d[1],g=Se.useMemo(function(){return{setPortalPlacement:f}},[]),m=Se.useState(null),p=so(m,2),v=p[0],b=p[1],y=Se.useCallback(function(){if(s){var F=p$(s),R=o==="fixed"?0:window.pageYOffset,B=F[h]+R;(B!==(v==null?void 0:v.offset)||F.left!==(v==null?void 0:v.rect.left)||F.width!==(v==null?void 0:v.rect.width))&&b({offset:B,rect:F})}},[s,o,h,v==null?void 0:v.offset,v==null?void 0:v.rect.left,v==null?void 0:v.rect.width]);Q2(function(){y()},[y]);var k=Se.useCallback(function(){typeof c.current=="function"&&(c.current(),c.current=null),s&&l.current&&(c.current=o$(s,l.current,y,{elementResize:"ResizeObserver"in window}))},[s,y]);Q2(function(){k()},[k]);var N=Se.useCallback(function(F){l.current=F,k()},[k]);if(!e&&o!=="fixed"||!v)return null;var L=Wt("div",Qt({ref:N},on(Jt(Jt({},r),{},{offset:v.offset,position:o,rect:v.rect}),"menuPortal",{"menu-portal":!0}),a),n);return Wt(zS.Provider,{value:g},e?K6.createPortal(L,e):L)},L$=function(r){var e=r.isDisabled,n=r.isRtl;return{label:"container",direction:n?"rtl":void 0,pointerEvents:e?"none":void 0,position:"relative"}},I$=function(r){var e=r.children,n=r.innerProps,s=r.isDisabled,a=r.isRtl;return Wt("div",Qt({},on(r,"container",{"--is-disabled":s,"--is-rtl":a}),n),e)},B$=function(r,e){var n=r.theme.spacing,s=r.isMulti,a=r.hasValue,i=r.selectProps.controlShouldRenderValue;return Jt({alignItems:"center",display:s&&a&&i?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},e?{}:{padding:"".concat(n.baseUnit/2,"px ").concat(n.baseUnit*2,"px")})},$$=function(r){var e=r.children,n=r.innerProps,s=r.isMulti,a=r.hasValue;return Wt("div",Qt({},on(r,"valueContainer",{"value-container":!0,"value-container--is-multi":s,"value-container--has-value":a}),n),e)},U$=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},H$=function(r){var e=r.children,n=r.innerProps;return Wt("div",Qt({},on(r,"indicatorsContainer",{indicators:!0}),n),e)},G5,z$=["size"],V$=["innerProps","isRtl","size"],q$={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},qS=function(r){var e=r.size,n=vo(r,z$);return Wt("svg",Qt({height:e,width:e,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:q$},n))},oy=function(r){return Wt(qS,Qt({size:20},r),Wt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},WS=function(r){return Wt(qS,Qt({size:20},r),Wt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},GS=function(r,e){var n=r.isFocused,s=r.theme,a=s.spacing.baseUnit,i=s.colors;return Jt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},e?{}:{color:n?i.neutral60:i.neutral20,padding:a*2,":hover":{color:n?i.neutral80:i.neutral40}})},W$=GS,G$=function(r){var e=r.children,n=r.innerProps;return Wt("div",Qt({},on(r,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),n),e||Wt(WS,null))},X$=GS,K$=function(r){var e=r.children,n=r.innerProps;return Wt("div",Qt({},on(r,"clearIndicator",{indicator:!0,"clear-indicator":!0}),n),e||Wt(oy,null))},Y$=function(r,e){var n=r.isDisabled,s=r.theme,a=s.spacing.baseUnit,i=s.colors;return Jt({label:"indicatorSeparator",alignSelf:"stretch",width:1},e?{}:{backgroundColor:n?i.neutral10:i.neutral20,marginBottom:a*2,marginTop:a*2})},J$=function(r){var e=r.innerProps;return Wt("span",Qt({},e,on(r,"indicatorSeparator",{"indicator-separator":!0})))},Z$=GB(G5||(G5=XB([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),Q$=function(r,e){var n=r.isFocused,s=r.size,a=r.theme,i=a.colors,o=a.spacing.baseUnit;return Jt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:s,lineHeight:1,marginRight:s,textAlign:"center",verticalAlign:"middle"},e?{}:{color:n?i.neutral60:i.neutral20,padding:o*2})},ag=function(r){var e=r.delay,n=r.offset;return Wt("span",{css:ny({animation:"".concat(Z$," 1s ease-in-out ").concat(e,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},eU=function(r){var e=r.innerProps,n=r.isRtl,s=r.size,a=s===void 0?4:s,i=vo(r,V$);return Wt("div",Qt({},on(Jt(Jt({},i),{},{innerProps:e,isRtl:n,size:a}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),e),Wt(ag,{delay:0,offset:n}),Wt(ag,{delay:160,offset:!0}),Wt(ag,{delay:320,offset:!n}))},tU=function(r,e){var n=r.isDisabled,s=r.isFocused,a=r.theme,i=a.colors,o=a.borderRadius,l=a.spacing;return Jt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:l.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},e?{}:{backgroundColor:n?i.neutral5:i.neutral0,borderColor:n?i.neutral10:s?i.primary:i.neutral20,borderRadius:o,borderStyle:"solid",borderWidth:1,boxShadow:s?"0 0 0 1px ".concat(i.primary):void 0,"&:hover":{borderColor:s?i.primary:i.neutral30}})},rU=function(r){var e=r.children,n=r.isDisabled,s=r.isFocused,a=r.innerRef,i=r.innerProps,o=r.menuIsOpen;return Wt("div",Qt({ref:a},on(r,"control",{control:!0,"control--is-disabled":n,"control--is-focused":s,"control--menu-is-open":o}),i,{"aria-disabled":n||void 0}),e)},nU=rU,sU=["data"],aU=function(r,e){var n=r.theme.spacing;return e?{}:{paddingBottom:n.baseUnit*2,paddingTop:n.baseUnit*2}},iU=function(r){var e=r.children,n=r.cx,s=r.getStyles,a=r.getClassNames,i=r.Heading,o=r.headingProps,l=r.innerProps,c=r.label,u=r.theme,d=r.selectProps;return Wt("div",Qt({},on(r,"group",{group:!0}),l),Wt(i,Qt({},o,{selectProps:d,theme:u,getStyles:s,getClassNames:a,cx:n}),c),Wt("div",null,e))},oU=function(r,e){var n=r.theme,s=n.colors,a=n.spacing;return Jt({label:"group",cursor:"default",display:"block"},e?{}:{color:s.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:a.baseUnit*3,paddingRight:a.baseUnit*3,textTransform:"uppercase"})},lU=function(r){var e=BS(r);e.data;var n=vo(e,sU);return Wt("div",Qt({},on(r,"groupHeading",{"group-heading":!0}),n))},cU=iU,uU=["innerRef","isDisabled","isHidden","inputClassName"],fU=function(r,e){var n=r.isDisabled,s=r.value,a=r.theme,i=a.spacing,o=a.colors;return Jt(Jt({visibility:n?"hidden":"visible",transform:s?"translateZ(0)":""},hU),e?{}:{margin:i.baseUnit/2,paddingBottom:i.baseUnit/2,paddingTop:i.baseUnit/2,color:o.neutral80})},XS={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},hU={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Jt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},XS)},dU=function(r){return Jt({label:"input",color:"inherit",background:0,opacity:r?0:1,width:"100%"},XS)},pU=function(r){var e=r.cx,n=r.value,s=BS(r),a=s.innerRef,i=s.isDisabled,o=s.isHidden,l=s.inputClassName,c=vo(s,uU);return Wt("div",Qt({},on(r,"input",{"input-container":!0}),{"data-value":n||""}),Wt("input",Qt({className:e({input:!0},l),ref:a,style:dU(o),disabled:i},c)))},mU=pU,gU=function(r,e){var n=r.theme,s=n.spacing,a=n.borderRadius,i=n.colors;return Jt({label:"multiValue",display:"flex",minWidth:0},e?{}:{backgroundColor:i.neutral10,borderRadius:a/2,margin:s.baseUnit/2})},vU=function(r,e){var n=r.theme,s=n.borderRadius,a=n.colors,i=r.cropWithEllipsis;return Jt({overflow:"hidden",textOverflow:i||i===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},e?{}:{borderRadius:s/2,color:a.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},bU=function(r,e){var n=r.theme,s=n.spacing,a=n.borderRadius,i=n.colors,o=r.isFocused;return Jt({alignItems:"center",display:"flex"},e?{}:{borderRadius:a/2,backgroundColor:o?i.dangerLight:void 0,paddingLeft:s.baseUnit,paddingRight:s.baseUnit,":hover":{backgroundColor:i.dangerLight,color:i.danger}})},KS=function(r){var e=r.children,n=r.innerProps;return Wt("div",n,e)},yU=KS,xU=KS;function wU(t){var r=t.children,e=t.innerProps;return Wt("div",Qt({role:"button"},e),r||Wt(oy,{size:14}))}var _U=function(r){var e=r.children,n=r.components,s=r.data,a=r.innerProps,i=r.isDisabled,o=r.removeProps,l=r.selectProps,c=n.Container,u=n.Label,d=n.Remove;return Wt(c,{data:s,innerProps:Jt(Jt({},on(r,"multiValue",{"multi-value":!0,"multi-value--is-disabled":i})),a),selectProps:l},Wt(u,{data:s,innerProps:Jt({},on(r,"multiValueLabel",{"multi-value__label":!0})),selectProps:l},e),Wt(d,{data:s,innerProps:Jt(Jt({},on(r,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(e||"option")},o),selectProps:l}))},SU=_U,kU=function(r,e){var n=r.isDisabled,s=r.isFocused,a=r.isSelected,i=r.theme,o=i.spacing,l=i.colors;return Jt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},e?{}:{backgroundColor:a?l.primary:s?l.primary25:"transparent",color:n?l.neutral20:a?l.neutral0:"inherit",padding:"".concat(o.baseUnit*2,"px ").concat(o.baseUnit*3,"px"),":active":{backgroundColor:n?void 0:a?l.primary:l.primary50}})},EU=function(r){var e=r.children,n=r.isDisabled,s=r.isFocused,a=r.isSelected,i=r.innerRef,o=r.innerProps;return Wt("div",Qt({},on(r,"option",{option:!0,"option--is-disabled":n,"option--is-focused":s,"option--is-selected":a}),{ref:i,"aria-disabled":n},o),e)},AU=EU,CU=function(r,e){var n=r.theme,s=n.spacing,a=n.colors;return Jt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},e?{}:{color:a.neutral50,marginLeft:s.baseUnit/2,marginRight:s.baseUnit/2})},TU=function(r){var e=r.children,n=r.innerProps;return Wt("div",Qt({},on(r,"placeholder",{placeholder:!0}),n),e)},NU=TU,DU=function(r,e){var n=r.isDisabled,s=r.theme,a=s.spacing,i=s.colors;return Jt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e?{}:{color:n?i.neutral40:i.neutral80,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},RU=function(r){var e=r.children,n=r.isDisabled,s=r.innerProps;return Wt("div",Qt({},on(r,"singleValue",{"single-value":!0,"single-value--is-disabled":n}),s),e)},PU=RU,OU={ClearIndicator:K$,Control:nU,DropdownIndicator:G$,DownChevron:WS,CrossIcon:oy,Group:cU,GroupHeading:lU,IndicatorsContainer:H$,IndicatorSeparator:J$,Input:mU,LoadingIndicator:eU,Menu:T$,MenuList:D$,MenuPortal:j$,LoadingMessage:M$,NoOptionsMessage:O$,MultiValue:SU,MultiValueContainer:yU,MultiValueLabel:xU,MultiValueRemove:wU,Option:AU,Placeholder:NU,SelectContainer:I$,SingleValue:PU,ValueContainer:$$},MU=function(r){return Jt(Jt({},OU),r.components)},X5=Number.isNaN||function(r){return typeof r=="number"&&r!==r};function FU(t,r){return!!(t===r||X5(t)&&X5(r))}function jU(t,r){if(t.length!==r.length)return!1;for(var e=0;e<t.length;e++)if(!FU(t[e],r[e]))return!1;return!0}function LU(t,r){r===void 0&&(r=jU);var e=null;function n(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];if(e&&e.lastThis===this&&r(s,e.lastArgs))return e.lastResult;var i=t.apply(this,s);return e={lastResult:i,lastArgs:s,lastThis:this},i}return n.clear=function(){e=null},n}var IU={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},BU=function(r){return Wt("span",Qt({css:IU},r))},K5=BU,$U={guidance:function(r){var e=r.isSearchable,n=r.isMulti,s=r.tabSelectsValue,a=r.context,i=r.isInitialFocus;switch(a){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(s?", press Tab to select the option and exit the menu":"",".");case"input":return i?"".concat(r["aria-label"]||"Select"," is focused ").concat(e?",type to refine list":"",", press Down to open the menu, ").concat(n?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(r){var e=r.action,n=r.label,s=n===void 0?"":n,a=r.labels,i=r.isDisabled;switch(e){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(s,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(a.length>1?"s":""," ").concat(a.join(","),", selected.");case"select-option":return i?"option ".concat(s," is disabled. Select another option."):"option ".concat(s,", selected.");default:return""}},onFocus:function(r){var e=r.context,n=r.focused,s=r.options,a=r.label,i=a===void 0?"":a,o=r.selectValue,l=r.isDisabled,c=r.isSelected,u=r.isAppleDevice,d=function(m,p){return m&&m.length?"".concat(m.indexOf(p)+1," of ").concat(m.length):""};if(e==="value"&&o)return"value ".concat(i," focused, ").concat(d(o,n),".");if(e==="menu"&&u){var h=l?" disabled":"",f="".concat(c?" selected":"").concat(h);return"".concat(i).concat(f,", ").concat(d(s,n),".")}return""},onFilter:function(r){var e=r.inputValue,n=r.resultsMessage;return"".concat(n).concat(e?" for search term "+e:"",".")}},UU=function(r){var e=r.ariaSelection,n=r.focusedOption,s=r.focusedValue,a=r.focusableOptions,i=r.isFocused,o=r.selectValue,l=r.selectProps,c=r.id,u=r.isAppleDevice,d=l.ariaLiveMessages,h=l.getOptionLabel,f=l.inputValue,g=l.isMulti,m=l.isOptionDisabled,p=l.isSearchable,v=l.menuIsOpen,b=l.options,y=l.screenReaderStatus,k=l.tabSelectsValue,N=l.isLoading,L=l["aria-label"],F=l["aria-live"],R=Se.useMemo(function(){return Jt(Jt({},$U),d||{})},[d]),B=Se.useMemo(function(){var E="";if(e&&R.onChange){var x=e.option,w=e.options,_=e.removedValue,S=e.removedValues,T=e.value,U=function(P){return Array.isArray(P)?null:P},A=_||x||U(T),H=A?h(A):"",z=w||S||void 0,K=z?z.map(h):[],j=Jt({isDisabled:A&&m(A,o),label:H,labels:K},e);E=R.onChange(j)}return E},[e,R,m,o,h]),q=Se.useMemo(function(){var E="",x=n||s,w=!!(n&&o&&o.includes(n));if(x&&R.onFocus){var _={focused:x,label:h(x),isDisabled:m(x,o),isSelected:w,options:a,context:x===n?"menu":"value",selectValue:o,isAppleDevice:u};E=R.onFocus(_)}return E},[n,s,h,m,R,a,o,u]),V=Se.useMemo(function(){var E="";if(v&&b.length&&!N&&R.onFilter){var x=y({count:a.length});E=R.onFilter({inputValue:f,resultsMessage:x})}return E},[a,f,v,R,b,y,N]),I=(e==null?void 0:e.action)==="initial-input-focus",C=Se.useMemo(function(){var E="";if(R.guidance){var x=s?"value":v?"menu":"input";E=R.guidance({"aria-label":L,context:x,isDisabled:n&&m(n,o),isMulti:g,isSearchable:p,tabSelectsValue:k,isInitialFocus:I})}return E},[L,n,s,g,m,p,v,R,o,k,I]),O=Wt(Se.Fragment,null,Wt("span",{id:"aria-selection"},B),Wt("span",{id:"aria-focused"},q),Wt("span",{id:"aria-results"},V),Wt("span",{id:"aria-guidance"},C));return Wt(Se.Fragment,null,Wt(K5,{id:c},I&&O),Wt(K5,{"aria-live":F,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},i&&!I&&O))},HU=UU,ev=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],zU=new RegExp("["+ev.map(function(t){return t.letters}).join("")+"]","g"),YS={};for(var ig=0;ig<ev.length;ig++)for(var og=ev[ig],lg=0;lg<og.letters.length;lg++)YS[og.letters[lg]]=og.base;var JS=function(r){return r.replace(zU,function(e){return YS[e]})},VU=LU(JS),Y5=function(r){return r.replace(/^\s+|\s+$/g,"")},qU=function(r){return"".concat(r.label," ").concat(r.value)},WU=function(r){return function(e,n){if(e.data.__isNew__)return!0;var s=Jt({ignoreCase:!0,ignoreAccents:!0,stringify:qU,trim:!0,matchFrom:"any"},r),a=s.ignoreCase,i=s.ignoreAccents,o=s.stringify,l=s.trim,c=s.matchFrom,u=l?Y5(n):n,d=l?Y5(o(e)):o(e);return a&&(u=u.toLowerCase(),d=d.toLowerCase()),i&&(u=VU(u),d=JS(d)),c==="start"?d.substr(0,u.length)===u:d.indexOf(u)>-1}},GU=["innerRef"];function XU(t){var r=t.innerRef,e=vo(t,GU),n=x$(e,"onExited","in","enter","exit","appear");return Wt("input",Qt({ref:r},n,{css:ny({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var KU=function(r){r.cancelable&&r.preventDefault(),r.stopPropagation()};function YU(t){var r=t.isEnabled,e=t.onBottomArrive,n=t.onBottomLeave,s=t.onTopArrive,a=t.onTopLeave,i=Se.useRef(!1),o=Se.useRef(!1),l=Se.useRef(0),c=Se.useRef(null),u=Se.useCallback(function(p,v){if(c.current!==null){var b=c.current,y=b.scrollTop,k=b.scrollHeight,N=b.clientHeight,L=c.current,F=v>0,R=k-N-y,B=!1;R>v&&i.current&&(n&&n(p),i.current=!1),F&&o.current&&(a&&a(p),o.current=!1),F&&v>R?(e&&!i.current&&e(p),L.scrollTop=k,B=!0,i.current=!0):!F&&-v>y&&(s&&!o.current&&s(p),L.scrollTop=0,B=!0,o.current=!0),B&&KU(p)}},[e,n,s,a]),d=Se.useCallback(function(p){u(p,p.deltaY)},[u]),h=Se.useCallback(function(p){l.current=p.changedTouches[0].clientY},[]),f=Se.useCallback(function(p){var v=l.current-p.changedTouches[0].clientY;u(p,v)},[u]),g=Se.useCallback(function(p){if(p){var v=v$?{passive:!1}:!1;p.addEventListener("wheel",d,v),p.addEventListener("touchstart",h,v),p.addEventListener("touchmove",f,v)}},[f,h,d]),m=Se.useCallback(function(p){p&&(p.removeEventListener("wheel",d,!1),p.removeEventListener("touchstart",h,!1),p.removeEventListener("touchmove",f,!1))},[f,h,d]);return Se.useEffect(function(){if(r){var p=c.current;return g(p),function(){m(p)}}},[r,g,m]),function(p){c.current=p}}var J5=["boxSizing","height","overflow","paddingRight","position"],Z5={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function Q5(t){t.cancelable&&t.preventDefault()}function e3(t){t.stopPropagation()}function t3(){var t=this.scrollTop,r=this.scrollHeight,e=t+this.offsetHeight;t===0?this.scrollTop=1:e===r&&(this.scrollTop=t-1)}function r3(){return"ontouchstart"in window||navigator.maxTouchPoints}var n3=!!(typeof window<"u"&&window.document&&window.document.createElement),Pf=0,Vc={capture:!1,passive:!1};function JU(t){var r=t.isEnabled,e=t.accountForScrollbars,n=e===void 0?!0:e,s=Se.useRef({}),a=Se.useRef(null),i=Se.useCallback(function(l){if(n3){var c=document.body,u=c&&c.style;if(n&&J5.forEach(function(g){var m=u&&u[g];s.current[g]=m}),n&&Pf<1){var d=parseInt(s.current.paddingRight,10)||0,h=document.body?document.body.clientWidth:0,f=window.innerWidth-h+d||0;Object.keys(Z5).forEach(function(g){var m=Z5[g];u&&(u[g]=m)}),u&&(u.paddingRight="".concat(f,"px"))}c&&r3()&&(c.addEventListener("touchmove",Q5,Vc),l&&(l.addEventListener("touchstart",t3,Vc),l.addEventListener("touchmove",e3,Vc))),Pf+=1}},[n]),o=Se.useCallback(function(l){if(n3){var c=document.body,u=c&&c.style;Pf=Math.max(Pf-1,0),n&&Pf<1&&J5.forEach(function(d){var h=s.current[d];u&&(u[d]=h)}),c&&r3()&&(c.removeEventListener("touchmove",Q5,Vc),l&&(l.removeEventListener("touchstart",t3,Vc),l.removeEventListener("touchmove",e3,Vc)))}},[n]);return Se.useEffect(function(){if(r){var l=a.current;return i(l),function(){o(l)}}},[r,i,o]),function(l){a.current=l}}var ZU=function(r){var e=r.target;return e.ownerDocument.activeElement&&e.ownerDocument.activeElement.blur()},QU={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function eH(t){var r=t.children,e=t.lockEnabled,n=t.captureEnabled,s=n===void 0?!0:n,a=t.onBottomArrive,i=t.onBottomLeave,o=t.onTopArrive,l=t.onTopLeave,c=YU({isEnabled:s,onBottomArrive:a,onBottomLeave:i,onTopArrive:o,onTopLeave:l}),u=JU({isEnabled:e}),d=function(f){c(f),u(f)};return Wt(Se.Fragment,null,e&&Wt("div",{onClick:ZU,css:QU}),r(d))}var tH={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},rH=function(r){var e=r.name,n=r.onFocus;return Wt("input",{required:!0,name:e,tabIndex:-1,"aria-hidden":"true",onFocus:n,css:tH,value:"",onChange:function(){}})},nH=rH;function ly(t){var r;return typeof window<"u"&&window.navigator!=null?t.test(((r=window.navigator.userAgentData)===null||r===void 0?void 0:r.platform)||window.navigator.platform):!1}function sH(){return ly(/^iPhone/i)}function ZS(){return ly(/^Mac/i)}function aH(){return ly(/^iPad/i)||ZS()&&navigator.maxTouchPoints>1}function iH(){return sH()||aH()}function oH(){return ZS()||iH()}var lH=function(r){return r.label},cH=function(r){return r.label},uH=function(r){return r.value},fH=function(r){return!!r.isDisabled},hH={clearIndicator:X$,container:L$,control:tU,dropdownIndicator:W$,group:aU,groupHeading:oU,indicatorsContainer:U$,indicatorSeparator:Y$,input:fU,loadingIndicator:Q$,loadingMessage:P$,menu:E$,menuList:N$,menuPortal:F$,multiValue:gU,multiValueLabel:vU,multiValueRemove:bU,noOptionsMessage:R$,option:kU,placeholder:CU,singleValue:DU,valueContainer:B$},dH={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},pH=4,QS=4,mH=38,gH=QS*2,vH={baseUnit:QS,controlHeight:mH,menuGutter:gH},cg={borderRadius:pH,colors:dH,spacing:vH},bH={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:W5(),captureMenuScroll:!W5(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:WU(),formatGroupLabel:lH,getOptionLabel:cH,getOptionValue:uH,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:fH,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!m$(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(r){var e=r.count;return"".concat(e," result").concat(e!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function s3(t,r,e,n){var s=rk(t,r,e),a=nk(t,r,e),i=tk(t,r),o=$p(t,r);return{type:"option",data:r,isDisabled:s,isSelected:a,label:i,value:o,index:n}}function V0(t,r){return t.options.map(function(e,n){if("options"in e){var s=e.options.map(function(i,o){return s3(t,i,r,o)}).filter(function(i){return i3(t,i)});return s.length>0?{type:"group",data:e,options:s,index:n}:void 0}var a=s3(t,e,r,n);return i3(t,a)?a:void 0}).filter(b$)}function ek(t){return t.reduce(function(r,e){return e.type==="group"?r.push.apply(r,Kb(e.options.map(function(n){return n.data}))):r.push(e.data),r},[])}function a3(t,r){return t.reduce(function(e,n){return n.type==="group"?e.push.apply(e,Kb(n.options.map(function(s){return{data:s.data,id:"".concat(r,"-").concat(n.index,"-").concat(s.index)}}))):e.push({data:n.data,id:"".concat(r,"-").concat(n.index)}),e},[])}function yH(t,r){return ek(V0(t,r))}function i3(t,r){var e=t.inputValue,n=e===void 0?"":e,s=r.data,a=r.isSelected,i=r.label,o=r.value;return(!ak(t)||!a)&&sk(t,{label:i,value:o,data:s},n)}function xH(t,r){var e=t.focusedValue,n=t.selectValue,s=n.indexOf(e);if(s>-1){var a=r.indexOf(e);if(a>-1)return e;if(s<r.length)return r[s]}return null}function wH(t,r){var e=t.focusedOption;return e&&r.indexOf(e)>-1?e:r[0]}var ug=function(r,e){var n,s=(n=r.find(function(a){return a.data===e}))===null||n===void 0?void 0:n.id;return s||null},tk=function(r,e){return r.getOptionLabel(e)},$p=function(r,e){return r.getOptionValue(e)};function rk(t,r,e){return typeof t.isOptionDisabled=="function"?t.isOptionDisabled(r,e):!1}function nk(t,r,e){if(e.indexOf(r)>-1)return!0;if(typeof t.isOptionSelected=="function")return t.isOptionSelected(r,e);var n=$p(t,r);return e.some(function(s){return $p(t,s)===n})}function sk(t,r,e){return t.filterOption?t.filterOption(r,e):!0}var ak=function(r){var e=r.hideSelectedOptions,n=r.isMulti;return e===void 0?n:e},_H=1,ik=function(t){BI(e,t);var r=HI(e);function e(n){var s;if(LI(this,e),s=r.call(this,n),s.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},s.blockOptionHover=!1,s.isComposing=!1,s.commonProps=void 0,s.initialTouchX=0,s.initialTouchY=0,s.openAfterFocus=!1,s.scrollToFocusedOptionOnUpdate=!1,s.userIsDragging=void 0,s.isAppleDevice=oH(),s.controlRef=null,s.getControlRef=function(l){s.controlRef=l},s.focusedOptionRef=null,s.getFocusedOptionRef=function(l){s.focusedOptionRef=l},s.menuListRef=null,s.getMenuListRef=function(l){s.menuListRef=l},s.inputRef=null,s.getInputRef=function(l){s.inputRef=l},s.focus=s.focusInput,s.blur=s.blurInput,s.onChange=function(l,c){var u=s.props,d=u.onChange,h=u.name;c.name=h,s.ariaOnChange(l,c),d(l,c)},s.setValue=function(l,c,u){var d=s.props,h=d.closeMenuOnSelect,f=d.isMulti,g=d.inputValue;s.onInputChange("",{action:"set-value",prevInputValue:g}),h&&(s.setState({inputIsHiddenAfterUpdate:!f}),s.onMenuClose()),s.setState({clearFocusValueOnUpdate:!0}),s.onChange(l,{action:c,option:u})},s.selectOption=function(l){var c=s.props,u=c.blurInputOnSelect,d=c.isMulti,h=c.name,f=s.state.selectValue,g=d&&s.isOptionSelected(l,f),m=s.isOptionDisabled(l,f);if(g){var p=s.getOptionValue(l);s.setValue(f.filter(function(v){return s.getOptionValue(v)!==p}),"deselect-option",l)}else if(!m)d?s.setValue([].concat(Kb(f),[l]),"select-option",l):s.setValue(l,"select-option");else{s.ariaOnChange(l,{action:"select-option",option:l,name:h});return}u&&s.blurInput()},s.removeValue=function(l){var c=s.props.isMulti,u=s.state.selectValue,d=s.getOptionValue(l),h=u.filter(function(g){return s.getOptionValue(g)!==d}),f=k0(c,h,h[0]||null);s.onChange(f,{action:"remove-value",removedValue:l}),s.focusInput()},s.clearValue=function(){var l=s.state.selectValue;s.onChange(k0(s.props.isMulti,[],null),{action:"clear",removedValues:l})},s.popValue=function(){var l=s.props.isMulti,c=s.state.selectValue,u=c[c.length-1],d=c.slice(0,c.length-1),h=k0(l,d,d[0]||null);u&&s.onChange(h,{action:"pop-value",removedValue:u})},s.getFocusedOptionId=function(l){return ug(s.state.focusableOptionsWithIds,l)},s.getFocusableOptionsWithIds=function(){return a3(V0(s.props,s.state.selectValue),s.getElementId("option"))},s.getValue=function(){return s.state.selectValue},s.cx=function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return u$.apply(void 0,[s.props.classNamePrefix].concat(c))},s.getOptionLabel=function(l){return tk(s.props,l)},s.getOptionValue=function(l){return $p(s.props,l)},s.getStyles=function(l,c){var u=s.props.unstyled,d=hH[l](c,u);d.boxSizing="border-box";var h=s.props.styles[l];return h?h(d,c):d},s.getClassNames=function(l,c){var u,d;return(u=(d=s.props.classNames)[l])===null||u===void 0?void 0:u.call(d,c)},s.getElementId=function(l){return"".concat(s.state.instancePrefix,"-").concat(l)},s.getComponents=function(){return MU(s.props)},s.buildCategorizedOptions=function(){return V0(s.props,s.state.selectValue)},s.getCategorizedOptions=function(){return s.props.menuIsOpen?s.buildCategorizedOptions():[]},s.buildFocusableOptions=function(){return ek(s.buildCategorizedOptions())},s.getFocusableOptions=function(){return s.props.menuIsOpen?s.buildFocusableOptions():[]},s.ariaOnChange=function(l,c){s.setState({ariaSelection:Jt({value:l},c)})},s.onMenuMouseDown=function(l){l.button===0&&(l.stopPropagation(),l.preventDefault(),s.focusInput())},s.onMenuMouseMove=function(l){s.blockOptionHover=!1},s.onControlMouseDown=function(l){if(!l.defaultPrevented){var c=s.props.openMenuOnClick;s.state.isFocused?s.props.menuIsOpen?l.target.tagName!=="INPUT"&&l.target.tagName!=="TEXTAREA"&&s.onMenuClose():c&&s.openMenu("first"):(c&&(s.openAfterFocus=!0),s.focusInput()),l.target.tagName!=="INPUT"&&l.target.tagName!=="TEXTAREA"&&l.preventDefault()}},s.onDropdownIndicatorMouseDown=function(l){if(!(l&&l.type==="mousedown"&&l.button!==0)&&!s.props.isDisabled){var c=s.props,u=c.isMulti,d=c.menuIsOpen;s.focusInput(),d?(s.setState({inputIsHiddenAfterUpdate:!u}),s.onMenuClose()):s.openMenu("first"),l.preventDefault()}},s.onClearIndicatorMouseDown=function(l){l&&l.type==="mousedown"&&l.button!==0||(s.clearValue(),l.preventDefault(),s.openAfterFocus=!1,l.type==="touchend"?s.focusInput():setTimeout(function(){return s.focusInput()}))},s.onScroll=function(l){typeof s.props.closeMenuOnScroll=="boolean"?l.target instanceof HTMLElement&&Mm(l.target)&&s.props.onMenuClose():typeof s.props.closeMenuOnScroll=="function"&&s.props.closeMenuOnScroll(l)&&s.props.onMenuClose()},s.onCompositionStart=function(){s.isComposing=!0},s.onCompositionEnd=function(){s.isComposing=!1},s.onTouchStart=function(l){var c=l.touches,u=c&&c.item(0);u&&(s.initialTouchX=u.clientX,s.initialTouchY=u.clientY,s.userIsDragging=!1)},s.onTouchMove=function(l){var c=l.touches,u=c&&c.item(0);if(u){var d=Math.abs(u.clientX-s.initialTouchX),h=Math.abs(u.clientY-s.initialTouchY),f=5;s.userIsDragging=d>f||h>f}},s.onTouchEnd=function(l){s.userIsDragging||(s.controlRef&&!s.controlRef.contains(l.target)&&s.menuListRef&&!s.menuListRef.contains(l.target)&&s.blurInput(),s.initialTouchX=0,s.initialTouchY=0)},s.onControlTouchEnd=function(l){s.userIsDragging||s.onControlMouseDown(l)},s.onClearIndicatorTouchEnd=function(l){s.userIsDragging||s.onClearIndicatorMouseDown(l)},s.onDropdownIndicatorTouchEnd=function(l){s.userIsDragging||s.onDropdownIndicatorMouseDown(l)},s.handleInputChange=function(l){var c=s.props.inputValue,u=l.currentTarget.value;s.setState({inputIsHiddenAfterUpdate:!1}),s.onInputChange(u,{action:"input-change",prevInputValue:c}),s.props.menuIsOpen||s.onMenuOpen()},s.onInputFocus=function(l){s.props.onFocus&&s.props.onFocus(l),s.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(s.openAfterFocus||s.props.openMenuOnFocus)&&s.openMenu("first"),s.openAfterFocus=!1},s.onInputBlur=function(l){var c=s.props.inputValue;if(s.menuListRef&&s.menuListRef.contains(document.activeElement)){s.inputRef.focus();return}s.props.onBlur&&s.props.onBlur(l),s.onInputChange("",{action:"input-blur",prevInputValue:c}),s.onMenuClose(),s.setState({focusedValue:null,isFocused:!1})},s.onOptionHover=function(l){if(!(s.blockOptionHover||s.state.focusedOption===l)){var c=s.getFocusableOptions(),u=c.indexOf(l);s.setState({focusedOption:l,focusedOptionId:u>-1?s.getFocusedOptionId(l):null})}},s.shouldHideSelectedOptions=function(){return ak(s.props)},s.onValueInputFocus=function(l){l.preventDefault(),l.stopPropagation(),s.focus()},s.onKeyDown=function(l){var c=s.props,u=c.isMulti,d=c.backspaceRemovesValue,h=c.escapeClearsValue,f=c.inputValue,g=c.isClearable,m=c.isDisabled,p=c.menuIsOpen,v=c.onKeyDown,b=c.tabSelectsValue,y=c.openMenuOnFocus,k=s.state,N=k.focusedOption,L=k.focusedValue,F=k.selectValue;if(!m&&!(typeof v=="function"&&(v(l),l.defaultPrevented))){switch(s.blockOptionHover=!0,l.key){case"ArrowLeft":if(!u||f)return;s.focusValue("previous");break;case"ArrowRight":if(!u||f)return;s.focusValue("next");break;case"Delete":case"Backspace":if(f)return;if(L)s.removeValue(L);else{if(!d)return;u?s.popValue():g&&s.clearValue()}break;case"Tab":if(s.isComposing||l.shiftKey||!p||!b||!N||y&&s.isOptionSelected(N,F))return;s.selectOption(N);break;case"Enter":if(l.keyCode===229)break;if(p){if(!N||s.isComposing)return;s.selectOption(N);break}return;case"Escape":p?(s.setState({inputIsHiddenAfterUpdate:!1}),s.onInputChange("",{action:"menu-close",prevInputValue:f}),s.onMenuClose()):g&&h&&s.clearValue();break;case" ":if(f)return;if(!p){s.openMenu("first");break}if(!N)return;s.selectOption(N);break;case"ArrowUp":p?s.focusOption("up"):s.openMenu("last");break;case"ArrowDown":p?s.focusOption("down"):s.openMenu("first");break;case"PageUp":if(!p)return;s.focusOption("pageup");break;case"PageDown":if(!p)return;s.focusOption("pagedown");break;case"Home":if(!p)return;s.focusOption("first");break;case"End":if(!p)return;s.focusOption("last");break;default:return}l.preventDefault()}},s.state.instancePrefix="react-select-"+(s.props.instanceId||++_H),s.state.selectValue=V5(n.value),n.menuIsOpen&&s.state.selectValue.length){var a=s.getFocusableOptionsWithIds(),i=s.buildFocusableOptions(),o=i.indexOf(s.state.selectValue[0]);s.state.focusableOptionsWithIds=a,s.state.focusedOption=i[o],s.state.focusedOptionId=ug(a,i[o])}return s}return II(e,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&q5(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(s){var a=this.props,i=a.isDisabled,o=a.menuIsOpen,l=this.state.isFocused;(l&&!i&&s.isDisabled||l&&o&&!s.menuIsOpen)&&this.focusInput(),l&&i&&!s.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!l&&!i&&s.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(q5(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(s,a){this.props.onInputChange(s,a)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(s){var a=this,i=this.state,o=i.selectValue,l=i.isFocused,c=this.buildFocusableOptions(),u=s==="first"?0:c.length-1;if(!this.props.isMulti){var d=c.indexOf(o[0]);d>-1&&(u=d)}this.scrollToFocusedOptionOnUpdate=!(l&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:c[u],focusedOptionId:this.getFocusedOptionId(c[u])},function(){return a.onMenuOpen()})}},{key:"focusValue",value:function(s){var a=this.state,i=a.selectValue,o=a.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var l=i.indexOf(o);o||(l=-1);var c=i.length-1,u=-1;if(i.length){switch(s){case"previous":l===0?u=0:l===-1?u=c:u=l-1;break;case"next":l>-1&&l<c&&(u=l+1);break}this.setState({inputIsHidden:u!==-1,focusedValue:i[u]})}}}},{key:"focusOption",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",a=this.props.pageSize,i=this.state.focusedOption,o=this.getFocusableOptions();if(o.length){var l=0,c=o.indexOf(i);i||(c=-1),s==="up"?l=c>0?c-1:o.length-1:s==="down"?l=(c+1)%o.length:s==="pageup"?(l=c-a,l<0&&(l=0)):s==="pagedown"?(l=c+a,l>o.length-1&&(l=o.length-1)):s==="last"&&(l=o.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:o[l],focusedValue:null,focusedOptionId:this.getFocusedOptionId(o[l])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(cg):Jt(Jt({},cg),this.props.theme):cg}},{key:"getCommonProps",value:function(){var s=this.clearValue,a=this.cx,i=this.getStyles,o=this.getClassNames,l=this.getValue,c=this.selectOption,u=this.setValue,d=this.props,h=d.isMulti,f=d.isRtl,g=d.options,m=this.hasValue();return{clearValue:s,cx:a,getStyles:i,getClassNames:o,getValue:l,hasValue:m,isMulti:h,isRtl:f,options:g,selectOption:c,selectProps:d,setValue:u,theme:this.getTheme()}}},{key:"hasValue",value:function(){var s=this.state.selectValue;return s.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var s=this.props,a=s.isClearable,i=s.isMulti;return a===void 0?i:a}},{key:"isOptionDisabled",value:function(s,a){return rk(this.props,s,a)}},{key:"isOptionSelected",value:function(s,a){return nk(this.props,s,a)}},{key:"filterOption",value:function(s,a){return sk(this.props,s,a)}},{key:"formatOptionLabel",value:function(s,a){if(typeof this.props.formatOptionLabel=="function"){var i=this.props.inputValue,o=this.state.selectValue;return this.props.formatOptionLabel(s,{context:a,inputValue:i,selectValue:o})}else return this.getOptionLabel(s)}},{key:"formatGroupLabel",value:function(s){return this.props.formatGroupLabel(s)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var s=this.props,a=s.isDisabled,i=s.isSearchable,o=s.inputId,l=s.inputValue,c=s.tabIndex,u=s.form,d=s.menuIsOpen,h=s.required,f=this.getComponents(),g=f.Input,m=this.state,p=m.inputIsHidden,v=m.ariaSelection,b=this.commonProps,y=o||this.getElementId("input"),k=Jt(Jt(Jt({"aria-autocomplete":"list","aria-expanded":d,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":h,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},d&&{"aria-controls":this.getElementId("listbox")}),!i&&{"aria-readonly":!0}),this.hasValue()?(v==null?void 0:v.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return i?Se.createElement(g,Qt({},b,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:y,innerRef:this.getInputRef,isDisabled:a,isHidden:p,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:c,form:u,type:"text",value:l},k)):Se.createElement(XU,Qt({id:y,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Ip,onFocus:this.onInputFocus,disabled:a,tabIndex:c,inputMode:"none",form:u,value:""},k))}},{key:"renderPlaceholderOrValue",value:function(){var s=this,a=this.getComponents(),i=a.MultiValue,o=a.MultiValueContainer,l=a.MultiValueLabel,c=a.MultiValueRemove,u=a.SingleValue,d=a.Placeholder,h=this.commonProps,f=this.props,g=f.controlShouldRenderValue,m=f.isDisabled,p=f.isMulti,v=f.inputValue,b=f.placeholder,y=this.state,k=y.selectValue,N=y.focusedValue,L=y.isFocused;if(!this.hasValue()||!g)return v?null:Se.createElement(d,Qt({},h,{key:"placeholder",isDisabled:m,isFocused:L,innerProps:{id:this.getElementId("placeholder")}}),b);if(p)return k.map(function(R,B){var q=R===N,V="".concat(s.getOptionLabel(R),"-").concat(s.getOptionValue(R));return Se.createElement(i,Qt({},h,{components:{Container:o,Label:l,Remove:c},isFocused:q,isDisabled:m,key:V,index:B,removeProps:{onClick:function(){return s.removeValue(R)},onTouchEnd:function(){return s.removeValue(R)},onMouseDown:function(C){C.preventDefault()}},data:R}),s.formatOptionLabel(R,"value"))});if(v)return null;var F=k[0];return Se.createElement(u,Qt({},h,{data:F,isDisabled:m}),this.formatOptionLabel(F,"value"))}},{key:"renderClearIndicator",value:function(){var s=this.getComponents(),a=s.ClearIndicator,i=this.commonProps,o=this.props,l=o.isDisabled,c=o.isLoading,u=this.state.isFocused;if(!this.isClearable()||!a||l||!this.hasValue()||c)return null;var d={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return Se.createElement(a,Qt({},i,{innerProps:d,isFocused:u}))}},{key:"renderLoadingIndicator",value:function(){var s=this.getComponents(),a=s.LoadingIndicator,i=this.commonProps,o=this.props,l=o.isDisabled,c=o.isLoading,u=this.state.isFocused;if(!a||!c)return null;var d={"aria-hidden":"true"};return Se.createElement(a,Qt({},i,{innerProps:d,isDisabled:l,isFocused:u}))}},{key:"renderIndicatorSeparator",value:function(){var s=this.getComponents(),a=s.DropdownIndicator,i=s.IndicatorSeparator;if(!a||!i)return null;var o=this.commonProps,l=this.props.isDisabled,c=this.state.isFocused;return Se.createElement(i,Qt({},o,{isDisabled:l,isFocused:c}))}},{key:"renderDropdownIndicator",value:function(){var s=this.getComponents(),a=s.DropdownIndicator;if(!a)return null;var i=this.commonProps,o=this.props.isDisabled,l=this.state.isFocused,c={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return Se.createElement(a,Qt({},i,{innerProps:c,isDisabled:o,isFocused:l}))}},{key:"renderMenu",value:function(){var s=this,a=this.getComponents(),i=a.Group,o=a.GroupHeading,l=a.Menu,c=a.MenuList,u=a.MenuPortal,d=a.LoadingMessage,h=a.NoOptionsMessage,f=a.Option,g=this.commonProps,m=this.state.focusedOption,p=this.props,v=p.captureMenuScroll,b=p.inputValue,y=p.isLoading,k=p.loadingMessage,N=p.minMenuHeight,L=p.maxMenuHeight,F=p.menuIsOpen,R=p.menuPlacement,B=p.menuPosition,q=p.menuPortalTarget,V=p.menuShouldBlockScroll,I=p.menuShouldScrollIntoView,C=p.noOptionsMessage,O=p.onMenuScrollToTop,E=p.onMenuScrollToBottom;if(!F)return null;var x=function(H,z){var K=H.type,j=H.data,J=H.isDisabled,P=H.isSelected,D=H.label,G=H.value,re=m===j,te=J?void 0:function(){return s.onOptionHover(j)},ne=J?void 0:function(){return s.selectOption(j)},le="".concat(s.getElementId("option"),"-").concat(z),oe={id:le,onClick:ne,onMouseMove:te,onMouseOver:te,tabIndex:-1,role:"option","aria-selected":s.isAppleDevice?void 0:P};return Se.createElement(f,Qt({},g,{innerProps:oe,data:j,isDisabled:J,isSelected:P,key:le,label:D,type:K,value:G,isFocused:re,innerRef:re?s.getFocusedOptionRef:void 0}),s.formatOptionLabel(H.data,"menu"))},w;if(this.hasOptions())w=this.getCategorizedOptions().map(function(A){if(A.type==="group"){var H=A.data,z=A.options,K=A.index,j="".concat(s.getElementId("group"),"-").concat(K),J="".concat(j,"-heading");return Se.createElement(i,Qt({},g,{key:j,data:H,options:z,Heading:o,headingProps:{id:J,data:A.data},label:s.formatGroupLabel(A.data)}),A.options.map(function(P){return x(P,"".concat(K,"-").concat(P.index))}))}else if(A.type==="option")return x(A,"".concat(A.index))});else if(y){var _=k({inputValue:b});if(_===null)return null;w=Se.createElement(d,g,_)}else{var S=C({inputValue:b});if(S===null)return null;w=Se.createElement(h,g,S)}var T={minMenuHeight:N,maxMenuHeight:L,menuPlacement:R,menuPosition:B,menuShouldScrollIntoView:I},U=Se.createElement(A$,Qt({},g,T),function(A){var H=A.ref,z=A.placerProps,K=z.placement,j=z.maxHeight;return Se.createElement(l,Qt({},g,T,{innerRef:H,innerProps:{onMouseDown:s.onMenuMouseDown,onMouseMove:s.onMenuMouseMove},isLoading:y,placement:K}),Se.createElement(eH,{captureEnabled:v,onTopArrive:O,onBottomArrive:E,lockEnabled:V},function(J){return Se.createElement(c,Qt({},g,{innerRef:function(D){s.getMenuListRef(D),J(D)},innerProps:{role:"listbox","aria-multiselectable":g.isMulti,id:s.getElementId("listbox")},isLoading:y,maxHeight:j,focusedOption:m}),w)}))});return q||B==="fixed"?Se.createElement(u,Qt({},g,{appendTo:q,controlElement:this.controlRef,menuPlacement:R,menuPosition:B}),U):U}},{key:"renderFormField",value:function(){var s=this,a=this.props,i=a.delimiter,o=a.isDisabled,l=a.isMulti,c=a.name,u=a.required,d=this.state.selectValue;if(u&&!this.hasValue()&&!o)return Se.createElement(nH,{name:c,onFocus:this.onValueInputFocus});if(!(!c||o))if(l)if(i){var h=d.map(function(m){return s.getOptionValue(m)}).join(i);return Se.createElement("input",{name:c,type:"hidden",value:h})}else{var f=d.length>0?d.map(function(m,p){return Se.createElement("input",{key:"i-".concat(p),name:c,type:"hidden",value:s.getOptionValue(m)})}):Se.createElement("input",{name:c,type:"hidden",value:""});return Se.createElement("div",null,f)}else{var g=d[0]?this.getOptionValue(d[0]):"";return Se.createElement("input",{name:c,type:"hidden",value:g})}}},{key:"renderLiveRegion",value:function(){var s=this.commonProps,a=this.state,i=a.ariaSelection,o=a.focusedOption,l=a.focusedValue,c=a.isFocused,u=a.selectValue,d=this.getFocusableOptions();return Se.createElement(HU,Qt({},s,{id:this.getElementId("live-region"),ariaSelection:i,focusedOption:o,focusedValue:l,isFocused:c,selectValue:u,focusableOptions:d,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var s=this.getComponents(),a=s.Control,i=s.IndicatorsContainer,o=s.SelectContainer,l=s.ValueContainer,c=this.props,u=c.className,d=c.id,h=c.isDisabled,f=c.menuIsOpen,g=this.state.isFocused,m=this.commonProps=this.getCommonProps();return Se.createElement(o,Qt({},m,{className:u,innerProps:{id:d,onKeyDown:this.onKeyDown},isDisabled:h,isFocused:g}),this.renderLiveRegion(),Se.createElement(a,Qt({},m,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:h,isFocused:g,menuIsOpen:f}),Se.createElement(l,Qt({},m,{isDisabled:h}),this.renderPlaceholderOrValue(),this.renderInput()),Se.createElement(i,Qt({},m,{isDisabled:h}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(s,a){var i=a.prevProps,o=a.clearFocusValueOnUpdate,l=a.inputIsHiddenAfterUpdate,c=a.ariaSelection,u=a.isFocused,d=a.prevWasFocused,h=a.instancePrefix,f=s.options,g=s.value,m=s.menuIsOpen,p=s.inputValue,v=s.isMulti,b=V5(g),y={};if(i&&(g!==i.value||f!==i.options||m!==i.menuIsOpen||p!==i.inputValue)){var k=m?yH(s,b):[],N=m?a3(V0(s,b),"".concat(h,"-option")):[],L=o?xH(a,b):null,F=wH(a,k),R=ug(N,F);y={selectValue:b,focusedOption:F,focusedOptionId:R,focusableOptionsWithIds:N,focusedValue:L,clearFocusValueOnUpdate:!1}}var B=l!=null&&s!==i?{inputIsHidden:l,inputIsHiddenAfterUpdate:void 0}:{},q=c,V=u&&d;return u&&!V&&(q={value:k0(v,b,b[0]||null),options:b,action:"initial-input-focus"},V=!d),(c==null?void 0:c.action)==="initial-input-focus"&&(q=null),Jt(Jt(Jt({},y),B),{},{prevProps:s,ariaSelection:q,prevWasFocused:V})}}]),e}(Se.Component);ik.defaultProps=bH;var SH=Se.forwardRef(function(t,r){var e=jI(t);return Se.createElement(ik,Qt({ref:r},e))}),kH=SH,gs=Uint8Array,ua=Uint16Array,cy=Int32Array,Fm=new gs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),jm=new gs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),tv=new gs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ok=function(t,r){for(var e=new ua(31),n=0;n<31;++n)e[n]=r+=1<<t[n-1];for(var s=new cy(e[30]),n=1;n<30;++n)for(var a=e[n];a<e[n+1];++a)s[a]=a-e[n]<<5|n;return{b:e,r:s}},lk=ok(Fm,2),ck=lk.b,rv=lk.r;ck[28]=258,rv[258]=28;var uk=ok(jm,0),EH=uk.b,o3=uk.r,nv=new ua(32768);for(var qr=0;qr<32768;++qr){var Io=(qr&43690)>>1|(qr&21845)<<1;Io=(Io&52428)>>2|(Io&13107)<<2,Io=(Io&61680)>>4|(Io&3855)<<4,nv[qr]=((Io&65280)>>8|(Io&255)<<8)>>1}var Ti=function(t,r,e){for(var n=t.length,s=0,a=new ua(r);s<n;++s)t[s]&&++a[t[s]-1];var i=new ua(r);for(s=1;s<r;++s)i[s]=i[s-1]+a[s-1]<<1;var o;if(e){o=new ua(1<<r);var l=15-r;for(s=0;s<n;++s)if(t[s])for(var c=s<<4|t[s],u=r-t[s],d=i[t[s]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)o[nv[d]>>l]=c}else for(o=new ua(n),s=0;s<n;++s)t[s]&&(o[s]=nv[i[t[s]-1]++]>>15-t[s]);return o},bl=new gs(288);for(var qr=0;qr<144;++qr)bl[qr]=8;for(var qr=144;qr<256;++qr)bl[qr]=9;for(var qr=256;qr<280;++qr)bl[qr]=7;for(var qr=280;qr<288;++qr)bl[qr]=8;var Gh=new gs(32);for(var qr=0;qr<32;++qr)Gh[qr]=5;var AH=Ti(bl,9,0),CH=Ti(bl,9,1),TH=Ti(Gh,5,0),NH=Ti(Gh,5,1),fg=function(t){for(var r=t[0],e=1;e<t.length;++e)t[e]>r&&(r=t[e]);return r},Ga=function(t,r,e){var n=r/8|0;return(t[n]|t[n+1]<<8)>>(r&7)&e},hg=function(t,r){var e=r/8|0;return(t[e]|t[e+1]<<8|t[e+2]<<16)>>(r&7)},uy=function(t){return(t+7)/8|0},fk=function(t,r,e){return(e==null||e>t.length)&&(e=t.length),new gs(t.subarray(r,e))},DH=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ja=function(t,r,e){var n=new Error(r||DH[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Ja),!e)throw n;return n},RH=function(t,r,e,n){var s=t.length,a=0;if(!s||r.f&&!r.l)return e||new gs(0);var i=!e,o=i||r.i!=2,l=r.i;i&&(e=new gs(s*3));var c=function(re){var te=e.length;if(re>te){var ne=new gs(Math.max(te*2,re));ne.set(e),e=ne}},u=r.f||0,d=r.p||0,h=r.b||0,f=r.l,g=r.d,m=r.m,p=r.n,v=s*8;do{if(!f){u=Ga(t,d,1);var b=Ga(t,d+1,3);if(d+=3,b)if(b==1)f=CH,g=NH,m=9,p=5;else if(b==2){var L=Ga(t,d,31)+257,F=Ga(t,d+10,15)+4,R=L+Ga(t,d+5,31)+1;d+=14;for(var B=new gs(R),q=new gs(19),V=0;V<F;++V)q[tv[V]]=Ga(t,d+V*3,7);d+=F*3;for(var I=fg(q),C=(1<<I)-1,O=Ti(q,I,1),V=0;V<R;){var E=O[Ga(t,d,C)];d+=E&15;var y=E>>4;if(y<16)B[V++]=y;else{var x=0,w=0;for(y==16?(w=3+Ga(t,d,3),d+=2,x=B[V-1]):y==17?(w=3+Ga(t,d,7),d+=3):y==18&&(w=11+Ga(t,d,127),d+=7);w--;)B[V++]=x}}var _=B.subarray(0,L),S=B.subarray(L);m=fg(_),p=fg(S),f=Ti(_,m,1),g=Ti(S,p,1)}else Ja(1);else{var y=uy(d)+4,k=t[y-4]|t[y-3]<<8,N=y+k;if(N>s){l&&Ja(0);break}o&&c(h+k),e.set(t.subarray(y,N),h),r.b=h+=k,r.p=d=N*8,r.f=u;continue}if(d>v){l&&Ja(0);break}}o&&c(h+131072);for(var T=(1<<m)-1,U=(1<<p)-1,A=d;;A=d){var x=f[hg(t,d)&T],H=x>>4;if(d+=x&15,d>v){l&&Ja(0);break}if(x||Ja(2),H<256)e[h++]=H;else if(H==256){A=d,f=null;break}else{var z=H-254;if(H>264){var V=H-257,K=Fm[V];z=Ga(t,d,(1<<K)-1)+ck[V],d+=K}var j=g[hg(t,d)&U],J=j>>4;j||Ja(3),d+=j&15;var S=EH[J];if(J>3){var K=jm[J];S+=hg(t,d)&(1<<K)-1,d+=K}if(d>v){l&&Ja(0);break}o&&c(h+131072);var P=h+z;if(h<S){var D=a-S,G=Math.min(S,P);for(D+h<0&&Ja(3);h<G;++h)e[h]=n[D+h]}for(;h<P;++h)e[h]=e[h-S]}}r.l=f,r.p=A,r.b=h,r.f=u,f&&(u=1,r.m=m,r.d=g,r.n=p)}while(!u);return h!=e.length&&i?fk(e,0,h):e.subarray(0,h)},Wi=function(t,r,e){e<<=r&7;var n=r/8|0;t[n]|=e,t[n+1]|=e>>8},Of=function(t,r,e){e<<=r&7;var n=r/8|0;t[n]|=e,t[n+1]|=e>>8,t[n+2]|=e>>16},dg=function(t,r){for(var e=[],n=0;n<t.length;++n)t[n]&&e.push({s:n,f:t[n]});var s=e.length,a=e.slice();if(!s)return{t:dk,l:0};if(s==1){var i=new gs(e[0].s+1);return i[e[0].s]=1,{t:i,l:1}}e.sort(function(N,L){return N.f-L.f}),e.push({s:-1,f:25001});var o=e[0],l=e[1],c=0,u=1,d=2;for(e[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=s-1;)o=e[e[c].f<e[d].f?c++:d++],l=e[c!=u&&e[c].f<e[d].f?c++:d++],e[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var h=a[0].s,n=1;n<s;++n)a[n].s>h&&(h=a[n].s);var f=new ua(h+1),g=sv(e[u-1],f,0);if(g>r){var n=0,m=0,p=g-r,v=1<<p;for(a.sort(function(L,F){return f[F.s]-f[L.s]||L.f-F.f});n<s;++n){var b=a[n].s;if(f[b]>r)m+=v-(1<<g-f[b]),f[b]=r;else break}for(m>>=p;m>0;){var y=a[n].s;f[y]<r?m-=1<<r-f[y]++-1:++n}for(;n>=0&&m;--n){var k=a[n].s;f[k]==r&&(--f[k],++m)}g=r}return{t:new gs(f),l:g}},sv=function(t,r,e){return t.s==-1?Math.max(sv(t.l,r,e+1),sv(t.r,r,e+1)):r[t.s]=e},l3=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new ua(++r),n=0,s=t[0],a=1,i=function(l){e[n++]=l},o=1;o<=r;++o)if(t[o]==s&&o!=r)++a;else{if(!s&&a>2){for(;a>138;a-=138)i(32754);a>2&&(i(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(i(s),--a;a>6;a-=6)i(8304);a>2&&(i(a-3<<5|8208),a=0)}for(;a--;)i(s);a=1,s=t[o]}return{c:e.subarray(0,n),n:r}},Mf=function(t,r){for(var e=0,n=0;n<r.length;++n)e+=t[n]*r[n];return e},hk=function(t,r,e){var n=e.length,s=uy(r+2);t[s]=n&255,t[s+1]=n>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var a=0;a<n;++a)t[s+a+4]=e[a];return(s+4+n)*8},c3=function(t,r,e,n,s,a,i,o,l,c,u){Wi(r,u++,e),++s[256];for(var d=dg(s,15),h=d.t,f=d.l,g=dg(a,15),m=g.t,p=g.l,v=l3(h),b=v.c,y=v.n,k=l3(m),N=k.c,L=k.n,F=new ua(19),R=0;R<b.length;++R)++F[b[R]&31];for(var R=0;R<N.length;++R)++F[N[R]&31];for(var B=dg(F,7),q=B.t,V=B.l,I=19;I>4&&!q[tv[I-1]];--I);var C=c+5<<3,O=Mf(s,bl)+Mf(a,Gh)+i,E=Mf(s,h)+Mf(a,m)+i+14+3*I+Mf(F,q)+2*F[16]+3*F[17]+7*F[18];if(l>=0&&C<=O&&C<=E)return hk(r,u,t.subarray(l,l+c));var x,w,_,S;if(Wi(r,u,1+(E<O)),u+=2,E<O){x=Ti(h,f,0),w=h,_=Ti(m,p,0),S=m;var T=Ti(q,V,0);Wi(r,u,y-257),Wi(r,u+5,L-1),Wi(r,u+10,I-4),u+=14;for(var R=0;R<I;++R)Wi(r,u+3*R,q[tv[R]]);u+=3*I;for(var U=[b,N],A=0;A<2;++A)for(var H=U[A],R=0;R<H.length;++R){var z=H[R]&31;Wi(r,u,T[z]),u+=q[z],z>15&&(Wi(r,u,H[R]>>5&127),u+=H[R]>>12)}}else x=AH,w=bl,_=TH,S=Gh;for(var R=0;R<o;++R){var K=n[R];if(K>255){var z=K>>18&31;Of(r,u,x[z+257]),u+=w[z+257],z>7&&(Wi(r,u,K>>23&31),u+=Fm[z]);var j=K&31;Of(r,u,_[j]),u+=S[j],j>3&&(Of(r,u,K>>5&8191),u+=jm[j])}else Of(r,u,x[K]),u+=w[K]}return Of(r,u,x[256]),u+w[256]},PH=new cy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),dk=new gs(0),OH=function(t,r,e,n,s,a){var i=a.z||t.length,o=new gs(n+i+5*(1+Math.ceil(i/7e3))+s),l=o.subarray(n,o.length-s),c=a.l,u=(a.r||0)&7;if(r){u&&(l[0]=a.r>>3);for(var d=PH[r-1],h=d>>13,f=d&8191,g=(1<<e)-1,m=a.p||new ua(32768),p=a.h||new ua(g+1),v=Math.ceil(e/3),b=2*v,y=function(le){return(t[le]^t[le+1]<<v^t[le+2]<<b)&g},k=new cy(25e3),N=new ua(288),L=new ua(32),F=0,R=0,B=a.i||0,q=0,V=a.w||0,I=0;B+2<i;++B){var C=y(B),O=B&32767,E=p[C];if(m[O]=E,p[C]=O,V<=B){var x=i-B;if((F>7e3||q>24576)&&(x>423||!c)){u=c3(t,l,0,k,N,L,R,q,I,B-I,u),q=F=R=0,I=B;for(var w=0;w<286;++w)N[w]=0;for(var w=0;w<30;++w)L[w]=0}var _=2,S=0,T=f,U=O-E&32767;if(x>2&&C==y(B-U))for(var A=Math.min(h,x)-1,H=Math.min(32767,B),z=Math.min(258,x);U<=H&&--T&&O!=E;){if(t[B+_]==t[B+_-U]){for(var K=0;K<z&&t[B+K]==t[B+K-U];++K);if(K>_){if(_=K,S=U,K>A)break;for(var j=Math.min(U,K-2),J=0,w=0;w<j;++w){var P=B-U+w&32767,D=m[P],G=P-D&32767;G>J&&(J=G,E=P)}}}O=E,E=m[O],U+=O-E&32767}if(S){k[q++]=268435456|rv[_]<<18|o3[S];var re=rv[_]&31,te=o3[S]&31;R+=Fm[re]+jm[te],++N[257+re],++L[te],V=B+_,++F}else k[q++]=t[B],++N[t[B]]}}for(B=Math.max(B,V);B<i;++B)k[q++]=t[B],++N[t[B]];u=c3(t,l,c,k,N,L,R,q,I,B-I,u),c||(a.r=u&7|l[u/8|0]<<3,u-=7,a.h=p,a.p=m,a.i=B,a.w=V)}else{for(var B=a.w||0;B<i+c;B+=65535){var ne=B+65535;ne>=i&&(l[u/8|0]=c,ne=i),u=hk(l,u+1,t.subarray(B,ne))}a.i=i}return fk(o,0,n+uy(u)+s)},pk=function(){var t=1,r=0;return{p:function(e){for(var n=t,s=r,a=e.length|0,i=0;i!=a;){for(var o=Math.min(i+2655,a);i<o;++i)s+=n+=e[i];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}t=n,r=s},d:function(){return t%=65521,r%=65521,(t&255)<<24|(t&65280)<<8|(r&255)<<8|r>>8}}},MH=function(t,r,e,n,s){if(!s&&(s={l:1},r.dictionary)){var a=r.dictionary.subarray(-32768),i=new gs(a.length+t.length);i.set(a),i.set(t,a.length),t=i,s.w=a.length}return OH(t,r.level==null?6:r.level,r.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+r.mem,e,n,s)},mk=function(t,r,e){for(;e;++r)t[r]=e,e>>>=8},FH=function(t,r){var e=r.level,n=e==0?0:e<6?1:e==9?3:2;if(t[0]=120,t[1]=n<<6|(r.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,r.dictionary){var s=pk();s.p(r.dictionary),mk(t,2,s.d())}},jH=function(t,r){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Ja(6,"invalid zlib data"),(t[1]>>5&1)==1&&Ja(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function av(t,r){r||(r={});var e=pk();e.p(t);var n=MH(t,r,r.dictionary?6:2,4);return FH(n,r),mk(n,n.length-4,e.d()),n}function LH(t,r){return RH(t.subarray(jH(t),-4),{i:2},r,r)}var IH=typeof TextDecoder<"u"&&new TextDecoder,BH=0;try{IH.decode(dk,{stream:!0}),BH=1}catch{}var er=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function pg(){er.console&&typeof er.console.log=="function"&&er.console.log.apply(er.console,arguments)}var Ir={log:pg,warn:function(t){er.console&&(typeof er.console.warn=="function"?er.console.warn.apply(er.console,arguments):pg.call(null,arguments))},error:function(t){er.console&&(typeof er.console.error=="function"?er.console.error.apply(er.console,arguments):pg(t))}};function mg(t,r,e){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Ul(n.response,r,e)},n.onerror=function(){Ir.error("could not download file")},n.send()}function u3(t){var r=new XMLHttpRequest;r.open("HEAD",t,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function E0(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(r)}}var dh,iv,Ul=er.saveAs||((typeof window>"u"?"undefined":kr(window))!=="object"||window!==er?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,r,e){var n=er.URL||er.webkitURL,s=document.createElement("a");r=r||t.name||"download",s.download=r,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?u3(s.href)?mg(t,r,e):E0(s,s.target="_blank"):E0(s)):(s.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){E0(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,r,e){if(r=r||t.name||"download",typeof t=="string")if(u3(t))mg(t,r,e);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){E0(n)})}else navigator.msSaveOrOpenBlob(function(s,a){return a===void 0?a={autoBom:!1}:kr(a)!=="object"&&(Ir.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(t,e),r)}:function(t,r,e,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return mg(t,r,e);var s=t.type==="application/octet-stream",a=/constructor/i.test(er.HTMLElement)||er.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||s&&a)&&(typeof FileReader>"u"?"undefined":kr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=i?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(t)}else{var l=er.URL||er.webkitURL,c=l.createObjectURL(t);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function gk(t){var r;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<e.length;n++){var s=e[n].re,a=e[n].process,i=s.exec(t);i&&(r=a(i),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function gg(t,r){var e=t[0],n=t[1],s=t[2],a=t[3];e=os(e,n,s,a,r[0],7,-680876936),a=os(a,e,n,s,r[1],12,-389564586),s=os(s,a,e,n,r[2],17,606105819),n=os(n,s,a,e,r[3],22,-1044525330),e=os(e,n,s,a,r[4],7,-176418897),a=os(a,e,n,s,r[5],12,1200080426),s=os(s,a,e,n,r[6],17,-1473231341),n=os(n,s,a,e,r[7],22,-45705983),e=os(e,n,s,a,r[8],7,1770035416),a=os(a,e,n,s,r[9],12,-1958414417),s=os(s,a,e,n,r[10],17,-42063),n=os(n,s,a,e,r[11],22,-1990404162),e=os(e,n,s,a,r[12],7,1804603682),a=os(a,e,n,s,r[13],12,-40341101),s=os(s,a,e,n,r[14],17,-1502002290),e=ls(e,n=os(n,s,a,e,r[15],22,1236535329),s,a,r[1],5,-165796510),a=ls(a,e,n,s,r[6],9,-1069501632),s=ls(s,a,e,n,r[11],14,643717713),n=ls(n,s,a,e,r[0],20,-373897302),e=ls(e,n,s,a,r[5],5,-701558691),a=ls(a,e,n,s,r[10],9,38016083),s=ls(s,a,e,n,r[15],14,-660478335),n=ls(n,s,a,e,r[4],20,-405537848),e=ls(e,n,s,a,r[9],5,568446438),a=ls(a,e,n,s,r[14],9,-1019803690),s=ls(s,a,e,n,r[3],14,-187363961),n=ls(n,s,a,e,r[8],20,1163531501),e=ls(e,n,s,a,r[13],5,-1444681467),a=ls(a,e,n,s,r[2],9,-51403784),s=ls(s,a,e,n,r[7],14,1735328473),e=cs(e,n=ls(n,s,a,e,r[12],20,-1926607734),s,a,r[5],4,-378558),a=cs(a,e,n,s,r[8],11,-2022574463),s=cs(s,a,e,n,r[11],16,1839030562),n=cs(n,s,a,e,r[14],23,-35309556),e=cs(e,n,s,a,r[1],4,-1530992060),a=cs(a,e,n,s,r[4],11,1272893353),s=cs(s,a,e,n,r[7],16,-155497632),n=cs(n,s,a,e,r[10],23,-1094730640),e=cs(e,n,s,a,r[13],4,681279174),a=cs(a,e,n,s,r[0],11,-358537222),s=cs(s,a,e,n,r[3],16,-722521979),n=cs(n,s,a,e,r[6],23,76029189),e=cs(e,n,s,a,r[9],4,-640364487),a=cs(a,e,n,s,r[12],11,-421815835),s=cs(s,a,e,n,r[15],16,530742520),e=us(e,n=cs(n,s,a,e,r[2],23,-995338651),s,a,r[0],6,-198630844),a=us(a,e,n,s,r[7],10,1126891415),s=us(s,a,e,n,r[14],15,-1416354905),n=us(n,s,a,e,r[5],21,-57434055),e=us(e,n,s,a,r[12],6,1700485571),a=us(a,e,n,s,r[3],10,-1894986606),s=us(s,a,e,n,r[10],15,-1051523),n=us(n,s,a,e,r[1],21,-2054922799),e=us(e,n,s,a,r[8],6,1873313359),a=us(a,e,n,s,r[15],10,-30611744),s=us(s,a,e,n,r[6],15,-1560198380),n=us(n,s,a,e,r[13],21,1309151649),e=us(e,n,s,a,r[4],6,-145523070),a=us(a,e,n,s,r[11],10,-1120210379),s=us(s,a,e,n,r[2],15,718787259),n=us(n,s,a,e,r[9],21,-343485551),t[0]=nl(e,t[0]),t[1]=nl(n,t[1]),t[2]=nl(s,t[2]),t[3]=nl(a,t[3])}function Lm(t,r,e,n,s,a){return r=nl(nl(r,t),nl(n,a)),nl(r<<s|r>>>32-s,e)}function os(t,r,e,n,s,a,i){return Lm(r&e|~r&n,t,r,s,a,i)}function ls(t,r,e,n,s,a,i){return Lm(r&n|e&~n,t,r,s,a,i)}function cs(t,r,e,n,s,a,i){return Lm(r^e^n,t,r,s,a,i)}function us(t,r,e,n,s,a,i){return Lm(e^(r|~n),t,r,s,a,i)}function vk(t){var r,e=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=t.length;r+=64)gg(n,$H(t.substring(r-64,r)));t=t.substring(r-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<t.length;r++)s[r>>2]|=t.charCodeAt(r)<<(r%4<<3);if(s[r>>2]|=128<<(r%4<<3),r>55)for(gg(n,s),r=0;r<16;r++)s[r]=0;return s[14]=8*e,gg(n,s),n}function $H(t){var r,e=[];for(r=0;r<64;r+=4)e[r>>2]=t.charCodeAt(r)+(t.charCodeAt(r+1)<<8)+(t.charCodeAt(r+2)<<16)+(t.charCodeAt(r+3)<<24);return e}dh=er.atob.bind(er),iv=er.btoa.bind(er);var f3="0123456789abcdef".split("");function UH(t){for(var r="",e=0;e<4;e++)r+=f3[t>>8*e+4&15]+f3[t>>8*e&15];return r}function HH(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function ov(t){return vk(t).map(HH).join("")}var zH=function(t){for(var r=0;r<t.length;r++)t[r]=UH(t[r]);return t.join("")}(vk("hello"))!="5d41402abc4b2a76b9719d911017c592";function nl(t,r){if(zH){var e=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(e>>16)<<16|65535&e}return t+r&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function lv(t,r){var e,n,s,a;if(t!==e){for(var i=(s=t,a=1+(256/t.length>>0),new Array(a+1).join(s)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+i.charCodeAt(l))%256,o[l]=o[c],o[c]=u}e=t,n=o}else o=n;var d=r.length,h=0,f=0,g="";for(l=0;l<d;l++)f=(f+(u=o[h=(h+1)%256]))%256,o[h]=o[f],o[f]=u,i=o[(o[h]+o[f])%256],g+=String.fromCharCode(r.charCodeAt(l)^i);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var h3={print:4,modify:8,copy:16,"annot-forms":32};function Kc(t,r,e,n){this.v=1,this.r=2;var s=192;t.forEach(function(o){if(h3.perm!==void 0)throw new Error("Invalid permission: "+o);s+=h3[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(r+this.padding).substr(0,32),i=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,i),this.P=-(1+(255^s)),this.encryptionKey=ov(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=lv(this.encryptionKey,this.padding)}function Yc(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var r="",e=t.length,n=0;n<e;n++){var s=t.charCodeAt(n);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?r+="#"+("0"+s.toString(16)).slice(-2):r+=t[n]}return r}function d3(t){if(kr(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(e,n,s){if(s=s||!1,typeof e!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(e)||(r[e]={});var a=Math.random().toString(35);return r[e][a]=[n,!!s],a},this.unsubscribe=function(e){for(var n in r)if(r[n][e])return delete r[n][e],Object.keys(r[n]).length===0&&delete r[n],!0;return!1},this.publish=function(e){if(r.hasOwnProperty(e)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var a in r[e]){var i=r[e][a];try{i[0].apply(t,n)}catch(o){er.console&&Ir.error("jsPDF PubSub Error",o.message,o)}i[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function Up(t){if(!(this instanceof Up))return new Up(t);var r="opacity,stroke-opacity".split(",");for(var e in t)t.hasOwnProperty(e)&&r.indexOf(e)>=0&&(this[e]=t[e]);this.id="",this.objectNumber=-1}function bk(t,r){this.gState=t,this.matrix=r,this.id="",this.objectNumber=-1}function ql(t,r,e,n,s){if(!(this instanceof ql))return new ql(t,r,e,n,s);this.type=t==="axial"?2:3,this.coords=r,this.colors=e,bk.call(this,n,s)}function uu(t,r,e,n,s){if(!(this instanceof uu))return new uu(t,r,e,n,s);this.boundingBox=t,this.xStep=r,this.yStep=e,this.stream="",this.cloneIndex=0,bk.call(this,n,s)}function Zt(t){var r,e=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],a=arguments[3],i=[],o=1,l=16,c="S",u=null;kr(t=t||{})==="object"&&(e=t.orientation,n=t.unit||n,s=t.format||s,a=t.compress||t.compressPdf||a,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(r=t.precision),t.floatPrecision!==void 0&&(l=t.floatPrecision),c=t.defaultPathOperation||"S"),i=t.filters||(a===!0?["FlateEncode"]:i),n=n||"mm",e=(""+(e||"P")).toLowerCase();var d=t.putOnlyUsedFonts||!1,h={},f={internal:{},__private__:{}};f.__private__.PubSub=d3;var g="1.3",m=f.__private__.getPdfVersion=function(){return g};f.__private__.setPdfVersion=function(Y){g=Y};var p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return p};var v=f.__private__.getPageFormat=function(Y){return p[Y]};s=s||"a4";var b={COMPAT:"compat",ADVANCED:"advanced"},y=b.COMPAT;function k(){this.saveGraphicsState(),ee(new yt(rt,0,0,-rt,0,ko()*rt).toString()+" cm"),this.setFontSize(this.getFontSize()/rt),c="n",y=b.ADVANCED}function N(){this.restoreGraphicsState(),c="S",y=b.COMPAT}var L=f.__private__.combineFontStyleAndFontWeight=function(Y,de){if(Y=="bold"&&de=="normal"||Y=="bold"&&de==400||Y=="normal"&&de=="italic"||Y=="bold"&&de=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return de&&(Y=de==400||de==="normal"?Y==="italic"?"italic":"normal":de!=700&&de!=="bold"||Y!=="normal"?(de==700?"bold":de)+""+Y:"bold"),Y};f.advancedAPI=function(Y){var de=y===b.COMPAT;return de&&k.call(this),typeof Y!="function"||(Y(this),de&&N.call(this)),this},f.compatAPI=function(Y){var de=y===b.ADVANCED;return de&&N.call(this),typeof Y!="function"||(Y(this),de&&k.call(this)),this},f.isAdvancedAPI=function(){return y===b.ADVANCED};var F,R=function(Y){if(y!==b.ADVANCED)throw new Error(Y+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=f.roundToPrecision=f.__private__.roundToPrecision=function(Y,de){var Re=r||de;if(isNaN(Y)||isNaN(Re))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return Y.toFixed(Re).replace(/0+$/,"")};F=f.hpf=f.__private__.hpf=typeof l=="number"?function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.hpf");return B(Y,l)}:l==="smart"?function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.hpf");return B(Y,Y>-1&&Y<1?16:5)}:function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.hpf");return B(Y,16)};var q=f.f2=f.__private__.f2=function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.f2");return B(Y,2)},V=f.__private__.f3=function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.f3");return B(Y,3)},I=f.scale=f.__private__.scale=function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.scale");return y===b.COMPAT?Y*rt:y===b.ADVANCED?Y:void 0},C=function(Y){return y===b.COMPAT?ko()-Y:y===b.ADVANCED?Y:void 0},O=function(Y){return I(C(Y))};f.__private__.setPrecision=f.setPrecision=function(Y){typeof parseInt(Y,10)=="number"&&(r=parseInt(Y,10))};var E,x="00000000000000000000000000000000",w=f.__private__.getFileId=function(){return x},_=f.__private__.setFileId=function(Y){return x=Y!==void 0&&/^[a-fA-F0-9]{32}$/.test(Y)?Y.toUpperCase():x.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(yn=new Kc(u.userPermissions,u.userPassword,u.ownerPassword,x)),x};f.setFileId=function(Y){return _(Y),this},f.getFileId=function(){return w()};var S=f.__private__.convertDateToPDFDate=function(Y){var de=Y.getTimezoneOffset(),Re=de<0?"+":"-",$e=Math.floor(Math.abs(de/60)),st=Math.abs(de%60),vt=[Re,z($e),"'",z(st),"'"].join("");return["D:",Y.getFullYear(),z(Y.getMonth()+1),z(Y.getDate()),z(Y.getHours()),z(Y.getMinutes()),z(Y.getSeconds()),vt].join("")},T=f.__private__.convertPDFDateToDate=function(Y){var de=parseInt(Y.substr(2,4),10),Re=parseInt(Y.substr(6,2),10)-1,$e=parseInt(Y.substr(8,2),10),st=parseInt(Y.substr(10,2),10),vt=parseInt(Y.substr(12,2),10),Tt=parseInt(Y.substr(14,2),10);return new Date(de,Re,$e,st,vt,Tt,0)},U=f.__private__.setCreationDate=function(Y){var de;if(Y===void 0&&(Y=new Date),Y instanceof Date)de=S(Y);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(Y))throw new Error("Invalid argument passed to jsPDF.setCreationDate");de=Y}return E=de},A=f.__private__.getCreationDate=function(Y){var de=E;return Y==="jsDate"&&(de=T(E)),de};f.setCreationDate=function(Y){return U(Y),this},f.getCreationDate=function(Y){return A(Y)};var H,z=f.__private__.padd2=function(Y){return("0"+parseInt(Y)).slice(-2)},K=f.__private__.padd2Hex=function(Y){return("00"+(Y=Y.toString())).substr(Y.length)},j=0,J=[],P=[],D=0,G=[],re=[],te=!1,ne=P,le=function(){j=0,D=0,P=[],J=[],G=[],me=tt(),xe=tt()};f.__private__.setCustomOutputDestination=function(Y){te=!0,ne=Y};var oe=function(Y){te||(ne=Y)};f.__private__.resetCustomOutputDestination=function(){te=!1,ne=P};var ee=f.__private__.out=function(Y){return Y=Y.toString(),D+=Y.length+1,ne.push(Y),ne},Z=f.__private__.write=function(Y){return ee(arguments.length===1?Y.toString():Array.prototype.join.call(arguments," "))},se=f.__private__.getArrayBuffer=function(Y){for(var de=Y.length,Re=new ArrayBuffer(de),$e=new Uint8Array(Re);de--;)$e[de]=Y.charCodeAt(de);return Re},ie=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return ie};var ue=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(Y){return ue=y===b.ADVANCED?Y/rt:Y,this};var pe,fe=f.__private__.getFontSize=f.getFontSize=function(){return y===b.COMPAT?ue:ue*rt},ye=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(Y){return ye=Y,this},f.__private__.getR2L=f.getR2L=function(){return ye};var Te,Pe=f.__private__.setZoomMode=function(Y){var de=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(Y))pe=Y;else if(isNaN(Y)){if(de.indexOf(Y)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+Y+'" is not recognized.');pe=Y}else pe=parseInt(Y,10)};f.__private__.getZoomMode=function(){return pe};var je,qe=f.__private__.setPageMode=function(Y){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(Y)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+Y+'" is not recognized.');Te=Y};f.__private__.getPageMode=function(){return Te};var We=f.__private__.setLayoutMode=function(Y){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(Y)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+Y+'" is not recognized.');je=Y};f.__private__.getLayoutMode=function(){return je},f.__private__.setDisplayMode=f.setDisplayMode=function(Y,de,Re){return Pe(Y),We(de),qe(Re),this};var at={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(Y){if(Object.keys(at).indexOf(Y)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return at[Y]},f.__private__.getDocumentProperties=function(){return at},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(Y){for(var de in at)at.hasOwnProperty(de)&&Y[de]&&(at[de]=Y[de]);return this},f.__private__.setDocumentProperty=function(Y,de){if(Object.keys(at).indexOf(Y)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return at[Y]=de};var Ye,rt,ht,Ce,Ie,Ve={},De={},Oe=[],Xe={},nt={},Je={},wt={},gt=null,dt=0,ct=[],ut=new d3(f),ft=t.hotfixes||[],Et={},jt={},Ot=[],yt=function Y(de,Re,$e,st,vt,Tt){if(!(this instanceof Y))return new Y(de,Re,$e,st,vt,Tt);isNaN(de)&&(de=1),isNaN(Re)&&(Re=0),isNaN($e)&&($e=0),isNaN(st)&&(st=1),isNaN(vt)&&(vt=0),isNaN(Tt)&&(Tt=0),this._matrix=[de,Re,$e,st,vt,Tt]};Object.defineProperty(yt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(Y){this._matrix[0]=Y}}),Object.defineProperty(yt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(Y){this._matrix[1]=Y}}),Object.defineProperty(yt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(Y){this._matrix[2]=Y}}),Object.defineProperty(yt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(Y){this._matrix[3]=Y}}),Object.defineProperty(yt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(Y){this._matrix[4]=Y}}),Object.defineProperty(yt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(Y){this._matrix[5]=Y}}),Object.defineProperty(yt.prototype,"a",{get:function(){return this._matrix[0]},set:function(Y){this._matrix[0]=Y}}),Object.defineProperty(yt.prototype,"b",{get:function(){return this._matrix[1]},set:function(Y){this._matrix[1]=Y}}),Object.defineProperty(yt.prototype,"c",{get:function(){return this._matrix[2]},set:function(Y){this._matrix[2]=Y}}),Object.defineProperty(yt.prototype,"d",{get:function(){return this._matrix[3]},set:function(Y){this._matrix[3]=Y}}),Object.defineProperty(yt.prototype,"e",{get:function(){return this._matrix[4]},set:function(Y){this._matrix[4]=Y}}),Object.defineProperty(yt.prototype,"f",{get:function(){return this._matrix[5]},set:function(Y){this._matrix[5]=Y}}),Object.defineProperty(yt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(yt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(yt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(yt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),yt.prototype.join=function(Y){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(F).join(Y)},yt.prototype.multiply=function(Y){var de=Y.sx*this.sx+Y.shy*this.shx,Re=Y.sx*this.shy+Y.shy*this.sy,$e=Y.shx*this.sx+Y.sy*this.shx,st=Y.shx*this.shy+Y.sy*this.sy,vt=Y.tx*this.sx+Y.ty*this.shx+this.tx,Tt=Y.tx*this.shy+Y.ty*this.sy+this.ty;return new yt(de,Re,$e,st,vt,Tt)},yt.prototype.decompose=function(){var Y=this.sx,de=this.shy,Re=this.shx,$e=this.sy,st=this.tx,vt=this.ty,Tt=Math.sqrt(Y*Y+de*de),It=(Y/=Tt)*Re+(de/=Tt)*$e;Re-=Y*It,$e-=de*It;var qt=Math.sqrt(Re*Re+$e*$e);return It/=qt,Y*($e/=qt)<de*(Re/=qt)&&(Y=-Y,de=-de,It=-It,Tt=-Tt),{scale:new yt(Tt,0,0,qt,0,0),translate:new yt(1,0,0,1,st,vt),rotate:new yt(Y,de,-de,Y,0,0),skew:new yt(1,0,It,1,0,0)}},yt.prototype.toString=function(Y){return this.join(" ")},yt.prototype.inversed=function(){var Y=this.sx,de=this.shy,Re=this.shx,$e=this.sy,st=this.tx,vt=this.ty,Tt=1/(Y*$e-de*Re),It=$e*Tt,qt=-de*Tt,ur=-Re*Tt,ir=Y*Tt;return new yt(It,qt,ur,ir,-It*st-ur*vt,-qt*st-ir*vt)},yt.prototype.applyToPoint=function(Y){var de=Y.x*this.sx+Y.y*this.shx+this.tx,Re=Y.x*this.shy+Y.y*this.sy+this.ty;return new _c(de,Re)},yt.prototype.applyToRectangle=function(Y){var de=this.applyToPoint(Y),Re=this.applyToPoint(new _c(Y.x+Y.w,Y.y+Y.h));return new tf(de.x,de.y,Re.x-de.x,Re.y-de.y)},yt.prototype.clone=function(){var Y=this.sx,de=this.shy,Re=this.shx,$e=this.sy,st=this.tx,vt=this.ty;return new yt(Y,de,Re,$e,st,vt)},f.Matrix=yt;var Vt=f.matrixMult=function(Y,de){return de.multiply(Y)},$t=new yt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=$t;var Fe=function(Y,de){if(!nt[Y]){var Re=(de instanceof ql?"Sh":"P")+(Object.keys(Xe).length+1).toString(10);de.id=Re,nt[Y]=Re,Xe[Re]=de,ut.publish("addPattern",de)}};f.ShadingPattern=ql,f.TilingPattern=uu,f.addShadingPattern=function(Y,de){return R("addShadingPattern()"),Fe(Y,de),this},f.beginTilingPattern=function(Y){R("beginTilingPattern()"),md(Y.boundingBox[0],Y.boundingBox[1],Y.boundingBox[2]-Y.boundingBox[0],Y.boundingBox[3]-Y.boundingBox[1],Y.matrix)},f.endTilingPattern=function(Y,de){R("endTilingPattern()"),de.stream=re[H].join(`
`),Fe(Y,de),ut.publish("endTilingPattern",de),Ot.pop().restore()};var Be=f.__private__.newObject=function(){var Y=tt();return ce(Y,!0),Y},tt=f.__private__.newObjectDeferred=function(){return j++,J[j]=function(){return D},j},ce=function(Y,de){return de=typeof de=="boolean"&&de,J[Y]=D,de&&ee(Y+" 0 obj"),Y},ke=f.__private__.newAdditionalObject=function(){var Y={objId:tt(),content:""};return G.push(Y),Y},me=tt(),xe=tt(),_e=f.__private__.decodeColorString=function(Y){var de=Y.split(" ");if(de.length!==2||de[1]!=="g"&&de[1]!=="G")de.length===5&&(de[4]==="k"||de[4]==="K")&&(de=[(1-de[0])*(1-de[3]),(1-de[1])*(1-de[3]),(1-de[2])*(1-de[3]),"r"]);else{var Re=parseFloat(de[0]);de=[Re,Re,Re,"r"]}for(var $e="#",st=0;st<3;st++)$e+=("0"+Math.floor(255*parseFloat(de[st])).toString(16)).slice(-2);return $e},Ee=f.__private__.encodeColorString=function(Y){var de;typeof Y=="string"&&(Y={ch1:Y});var Re=Y.ch1,$e=Y.ch2,st=Y.ch3,vt=Y.ch4,Tt=Y.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Re=="string"&&Re.charAt(0)!=="#"){var It=new gk(Re);if(It.ok)Re=It.toHex();else if(!/^\d*\.?\d*$/.test(Re))throw new Error('Invalid color "'+Re+'" passed to jsPDF.encodeColorString.')}if(typeof Re=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Re)&&(Re="#"+Re[1]+Re[1]+Re[2]+Re[2]+Re[3]+Re[3]),typeof Re=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Re)){var qt=parseInt(Re.substr(1),16);Re=qt>>16&255,$e=qt>>8&255,st=255&qt}if($e===void 0||vt===void 0&&Re===$e&&$e===st)if(typeof Re=="string")de=Re+" "+Tt[0];else switch(Y.precision){case 2:de=q(Re/255)+" "+Tt[0];break;case 3:default:de=V(Re/255)+" "+Tt[0]}else if(vt===void 0||kr(vt)==="object"){if(vt&&!isNaN(vt.a)&&vt.a===0)return de=["1.","1.","1.",Tt[1]].join(" ");if(typeof Re=="string")de=[Re,$e,st,Tt[1]].join(" ");else switch(Y.precision){case 2:de=[q(Re/255),q($e/255),q(st/255),Tt[1]].join(" ");break;default:case 3:de=[V(Re/255),V($e/255),V(st/255),Tt[1]].join(" ")}}else if(typeof Re=="string")de=[Re,$e,st,vt,Tt[2]].join(" ");else switch(Y.precision){case 2:de=[q(Re),q($e),q(st),q(vt),Tt[2]].join(" ");break;case 3:default:de=[V(Re),V($e),V(st),V(vt),Tt[2]].join(" ")}return de},Le=f.__private__.getFilters=function(){return i},Ke=f.__private__.putStream=function(Y){var de=(Y=Y||{}).data||"",Re=Y.filters||Le(),$e=Y.alreadyAppliedFilters||[],st=Y.addLength1||!1,vt=de.length,Tt=Y.objectId,It=function(ns){return ns};if(u!==null&&Tt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(It=yn.encryptor(Tt,0));var qt={};Re===!0&&(Re=["FlateEncode"]);var ur=Y.additionalKeyValues||[],ir=(qt=Zt.API.processDataByFilters!==void 0?Zt.API.processDataByFilters(de,Re):{data:de,reverseChain:[]}).reverseChain+(Array.isArray($e)?$e.join(" "):$e.toString());if(qt.data.length!==0&&(ur.push({key:"Length",value:qt.data.length}),st===!0&&ur.push({key:"Length1",value:vt})),ir.length!=0)if(ir.split("/").length-1==1)ur.push({key:"Filter",value:ir});else{ur.push({key:"Filter",value:"["+ir+"]"});for(var wr=0;wr<ur.length;wr+=1)if(ur[wr].key==="DecodeParms"){for(var Jr=[],tn=0;tn<qt.reverseChain.split("/").length-1;tn+=1)Jr.push("null");Jr.push(ur[wr].value),ur[wr].value="["+Jr.join(" ")+"]"}}ee("<<");for(var xn=0;xn<ur.length;xn++)ee("/"+ur[xn].key+" "+ur[xn].value);ee(">>"),qt.data.length!==0&&(ee("stream"),ee(It(qt.data)),ee("endstream"))},Ue=f.__private__.putPage=function(Y){var de=Y.number,Re=Y.data,$e=Y.objId,st=Y.contentsObjId;ce($e,!0),ee("<</Type /Page"),ee("/Parent "+Y.rootDictionaryObjId+" 0 R"),ee("/Resources "+Y.resourceDictionaryObjId+" 0 R"),ee("/MediaBox ["+parseFloat(F(Y.mediaBox.bottomLeftX))+" "+parseFloat(F(Y.mediaBox.bottomLeftY))+" "+F(Y.mediaBox.topRightX)+" "+F(Y.mediaBox.topRightY)+"]"),Y.cropBox!==null&&ee("/CropBox ["+F(Y.cropBox.bottomLeftX)+" "+F(Y.cropBox.bottomLeftY)+" "+F(Y.cropBox.topRightX)+" "+F(Y.cropBox.topRightY)+"]"),Y.bleedBox!==null&&ee("/BleedBox ["+F(Y.bleedBox.bottomLeftX)+" "+F(Y.bleedBox.bottomLeftY)+" "+F(Y.bleedBox.topRightX)+" "+F(Y.bleedBox.topRightY)+"]"),Y.trimBox!==null&&ee("/TrimBox ["+F(Y.trimBox.bottomLeftX)+" "+F(Y.trimBox.bottomLeftY)+" "+F(Y.trimBox.topRightX)+" "+F(Y.trimBox.topRightY)+"]"),Y.artBox!==null&&ee("/ArtBox ["+F(Y.artBox.bottomLeftX)+" "+F(Y.artBox.bottomLeftY)+" "+F(Y.artBox.topRightX)+" "+F(Y.artBox.topRightY)+"]"),typeof Y.userUnit=="number"&&Y.userUnit!==1&&ee("/UserUnit "+Y.userUnit),ut.publish("putPage",{objId:$e,pageContext:ct[de],pageNumber:de,page:Re}),ee("/Contents "+st+" 0 R"),ee(">>"),ee("endobj");var vt=Re.join(`
`);return y===b.ADVANCED&&(vt+=`
Q`),ce(st,!0),Ke({data:vt,filters:Le(),objectId:st}),ee("endobj"),$e},Qe=f.__private__.putPages=function(){var Y,de,Re=[];for(Y=1;Y<=dt;Y++)ct[Y].objId=tt(),ct[Y].contentsObjId=tt();for(Y=1;Y<=dt;Y++)Re.push(Ue({number:Y,data:re[Y],objId:ct[Y].objId,contentsObjId:ct[Y].contentsObjId,mediaBox:ct[Y].mediaBox,cropBox:ct[Y].cropBox,bleedBox:ct[Y].bleedBox,trimBox:ct[Y].trimBox,artBox:ct[Y].artBox,userUnit:ct[Y].userUnit,rootDictionaryObjId:me,resourceDictionaryObjId:xe}));ce(me,!0),ee("<</Type /Pages");var $e="/Kids [";for(de=0;de<dt;de++)$e+=Re[de]+" 0 R ";ee($e+"]"),ee("/Count "+dt),ee(">>"),ee("endobj"),ut.publish("postPutPages")},et=function(Y){ut.publish("putFont",{font:Y,out:ee,newObject:Be,putStream:Ke}),Y.isAlreadyPutted!==!0&&(Y.objectNumber=Be(),ee("<<"),ee("/Type /Font"),ee("/BaseFont /"+Yc(Y.postScriptName)),ee("/Subtype /Type1"),typeof Y.encoding=="string"&&ee("/Encoding /"+Y.encoding),ee("/FirstChar 32"),ee("/LastChar 255"),ee(">>"),ee("endobj"))},bt=function(){for(var Y in Ve)Ve.hasOwnProperty(Y)&&(d===!1||d===!0&&h.hasOwnProperty(Y))&&et(Ve[Y])},Ct=function(Y){Y.objectNumber=Be();var de=[];de.push({key:"Type",value:"/XObject"}),de.push({key:"Subtype",value:"/Form"}),de.push({key:"BBox",value:"["+[F(Y.x),F(Y.y),F(Y.x+Y.width),F(Y.y+Y.height)].join(" ")+"]"}),de.push({key:"Matrix",value:"["+Y.matrix.toString()+"]"});var Re=Y.pages[1].join(`
`);Ke({data:Re,additionalKeyValues:de,objectId:Y.objectNumber}),ee("endobj")},Pt=function(){for(var Y in Et)Et.hasOwnProperty(Y)&&Ct(Et[Y])},be=function(Y,de){var Re,$e=[],st=1/(de-1);for(Re=0;Re<1;Re+=st)$e.push(Re);if($e.push(1),Y[0].offset!=0){var vt={offset:0,color:Y[0].color};Y.unshift(vt)}if(Y[Y.length-1].offset!=1){var Tt={offset:1,color:Y[Y.length-1].color};Y.push(Tt)}for(var It="",qt=0,ur=0;ur<$e.length;ur++){for(Re=$e[ur];Re>Y[qt+1].offset;)qt++;var ir=Y[qt].offset,wr=(Re-ir)/(Y[qt+1].offset-ir),Jr=Y[qt].color,tn=Y[qt+1].color;It+=K(Math.round((1-wr)*Jr[0]+wr*tn[0]).toString(16))+K(Math.round((1-wr)*Jr[1]+wr*tn[1]).toString(16))+K(Math.round((1-wr)*Jr[2]+wr*tn[2]).toString(16))}return It.trim()},Me=function(Y,de){de||(de=21);var Re=Be(),$e=be(Y.colors,de),st=[];st.push({key:"FunctionType",value:"0"}),st.push({key:"Domain",value:"[0.0 1.0]"}),st.push({key:"Size",value:"["+de+"]"}),st.push({key:"BitsPerSample",value:"8"}),st.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),st.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ke({data:$e,additionalKeyValues:st,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Re}),ee("endobj"),Y.objectNumber=Be(),ee("<< /ShadingType "+Y.type),ee("/ColorSpace /DeviceRGB");var vt="/Coords ["+F(parseFloat(Y.coords[0]))+" "+F(parseFloat(Y.coords[1]))+" ";Y.type===2?vt+=F(parseFloat(Y.coords[2]))+" "+F(parseFloat(Y.coords[3])):vt+=F(parseFloat(Y.coords[2]))+" "+F(parseFloat(Y.coords[3]))+" "+F(parseFloat(Y.coords[4]))+" "+F(parseFloat(Y.coords[5])),ee(vt+="]"),Y.matrix&&ee("/Matrix ["+Y.matrix.toString()+"]"),ee("/Function "+Re+" 0 R"),ee("/Extend [true true]"),ee(">>"),ee("endobj")},it=function(Y,de){var Re=tt(),$e=Be();de.push({resourcesOid:Re,objectOid:$e}),Y.objectNumber=$e;var st=[];st.push({key:"Type",value:"/Pattern"}),st.push({key:"PatternType",value:"1"}),st.push({key:"PaintType",value:"1"}),st.push({key:"TilingType",value:"1"}),st.push({key:"BBox",value:"["+Y.boundingBox.map(F).join(" ")+"]"}),st.push({key:"XStep",value:F(Y.xStep)}),st.push({key:"YStep",value:F(Y.yStep)}),st.push({key:"Resources",value:Re+" 0 R"}),Y.matrix&&st.push({key:"Matrix",value:"["+Y.matrix.toString()+"]"}),Ke({data:Y.stream,additionalKeyValues:st,objectId:Y.objectNumber}),ee("endobj")},mt=function(Y){var de;for(de in Xe)Xe.hasOwnProperty(de)&&(Xe[de]instanceof ql?Me(Xe[de]):Xe[de]instanceof uu&&it(Xe[de],Y))},Rt=function(Y){for(var de in Y.objectNumber=Be(),ee("<<"),Y)switch(de){case"opacity":ee("/ca "+q(Y[de]));break;case"stroke-opacity":ee("/CA "+q(Y[de]))}ee(">>"),ee("endobj")},kt=function(){var Y;for(Y in Je)Je.hasOwnProperty(Y)&&Rt(Je[Y])},Nt=function(){for(var Y in ee("/XObject <<"),Et)Et.hasOwnProperty(Y)&&Et[Y].objectNumber>=0&&ee("/"+Y+" "+Et[Y].objectNumber+" 0 R");ut.publish("putXobjectDict"),ee(">>")},sr=function(){yn.oid=Be(),ee("<<"),ee("/Filter /Standard"),ee("/V "+yn.v),ee("/R "+yn.r),ee("/U <"+yn.toHexString(yn.U)+">"),ee("/O <"+yn.toHexString(yn.O)+">"),ee("/P "+yn.P),ee(">>"),ee("endobj")},Gt=function(){for(var Y in ee("/Font <<"),Ve)Ve.hasOwnProperty(Y)&&(d===!1||d===!0&&h.hasOwnProperty(Y))&&ee("/"+Y+" "+Ve[Y].objectNumber+" 0 R");ee(">>")},Xt=function(){if(Object.keys(Xe).length>0){for(var Y in ee("/Shading <<"),Xe)Xe.hasOwnProperty(Y)&&Xe[Y]instanceof ql&&Xe[Y].objectNumber>=0&&ee("/"+Y+" "+Xe[Y].objectNumber+" 0 R");ut.publish("putShadingPatternDict"),ee(">>")}},Ht=function(Y){if(Object.keys(Xe).length>0){for(var de in ee("/Pattern <<"),Xe)Xe.hasOwnProperty(de)&&Xe[de]instanceof f.TilingPattern&&Xe[de].objectNumber>=0&&Xe[de].objectNumber<Y&&ee("/"+de+" "+Xe[de].objectNumber+" 0 R");ut.publish("putTilingPatternDict"),ee(">>")}},ar=function(){if(Object.keys(Je).length>0){var Y;for(Y in ee("/ExtGState <<"),Je)Je.hasOwnProperty(Y)&&Je[Y].objectNumber>=0&&ee("/"+Y+" "+Je[Y].objectNumber+" 0 R");ut.publish("putGStateDict"),ee(">>")}},Kt=function(Y){ce(Y.resourcesOid,!0),ee("<<"),ee("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Gt(),Xt(),Ht(Y.objectOid),ar(),Nt(),ee(">>"),ee("endobj")},xr=function(){var Y=[];bt(),kt(),Pt(),mt(Y),ut.publish("putResources"),Y.forEach(Kt),Kt({resourcesOid:xe,objectOid:Number.MAX_SAFE_INTEGER}),ut.publish("postPutResources")},Fr=function(){ut.publish("putAdditionalObjects");for(var Y=0;Y<G.length;Y++){var de=G[Y];ce(de.objId,!0),ee(de.content),ee("endobj")}ut.publish("postPutAdditionalObjects")},Yr=function(Y){De[Y.fontName]=De[Y.fontName]||{},De[Y.fontName][Y.fontStyle]=Y.id},cn=function(Y,de,Re,$e,st){var vt={id:"F"+(Object.keys(Ve).length+1).toString(10),postScriptName:Y,fontName:de,fontStyle:Re,encoding:$e,isStandardFont:st||!1,metadata:{}};return ut.publish("addFont",{font:vt,instance:this}),Ve[vt.id]=vt,Yr(vt),vt.id},_s=function(Y){for(var de=0,Re=ie.length;de<Re;de++){var $e=cn.call(this,Y[de][0],Y[de][1],Y[de][2],ie[de][3],!0);d===!1&&(h[$e]=!0);var st=Y[de][0].split("-");Yr({id:$e,fontName:st[0],fontStyle:st[1]||""})}ut.publish("addFonts",{fonts:Ve,dictionary:De})},Tn=function(Y){return Y.foo=function(){try{return Y.apply(this,arguments)}catch($e){var de=$e.stack||"";~de.indexOf(" at ")&&(de=de.split(" at ")[1]);var Re="Error in function "+de.split(`
`)[0].split("<")[0]+": "+$e.message;if(!er.console)throw new Error(Re);er.console.error(Re,$e),er.alert&&alert(Re)}},Y.foo.bar=Y,Y.foo},Qs=function(Y,de){var Re,$e,st,vt,Tt,It,qt,ur,ir;if(st=(de=de||{}).sourceEncoding||"Unicode",Tt=de.outputEncoding,(de.autoencode||Tt)&&Ve[Ye].metadata&&Ve[Ye].metadata[st]&&Ve[Ye].metadata[st].encoding&&(vt=Ve[Ye].metadata[st].encoding,!Tt&&Ve[Ye].encoding&&(Tt=Ve[Ye].encoding),!Tt&&vt.codePages&&(Tt=vt.codePages[0]),typeof Tt=="string"&&(Tt=vt[Tt]),Tt)){for(qt=!1,It=[],Re=0,$e=Y.length;Re<$e;Re++)(ur=Tt[Y.charCodeAt(Re)])?It.push(String.fromCharCode(ur)):It.push(Y[Re]),It[Re].charCodeAt(0)>>8&&(qt=!0);Y=It.join("")}for(Re=Y.length;qt===void 0&&Re!==0;)Y.charCodeAt(Re-1)>>8&&(qt=!0),Re--;if(!qt)return Y;for(It=de.noBOM?[]:[254,255],Re=0,$e=Y.length;Re<$e;Re++){if((ir=(ur=Y.charCodeAt(Re))>>8)>>8)throw new Error("Character at position "+Re+" of string '"+Y+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");It.push(ir),It.push(ur-(ir<<8))}return String.fromCharCode.apply(void 0,It)},un=f.__private__.pdfEscape=f.pdfEscape=function(Y,de){return Qs(Y,de).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ba=f.__private__.beginPage=function(Y){re[++dt]=[],ct[dt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(Y[0]),topRightY:Number(Y[1])}},ea(dt),oe(re[H])},br=function(Y,de){var Re,$e,st;switch(e=de||e,typeof Y=="string"&&(Re=v(Y.toLowerCase()),Array.isArray(Re)&&($e=Re[0],st=Re[1])),Array.isArray(Y)&&($e=Y[0]*rt,st=Y[1]*rt),isNaN($e)&&($e=s[0],st=s[1]),($e>14400||st>14400)&&(Ir.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),$e=Math.min(14400,$e),st=Math.min(14400,st)),s=[$e,st],e.substr(0,1)){case"l":st>$e&&(s=[st,$e]);break;case"p":$e>st&&(s=[st,$e])}ba(s),ud(Ju),ee($a),Qu!==0&&ee(Qu+" J"),ef!==0&&ee(ef+" j"),ut.publish("addPage",{pageNumber:dt})},pr=function(Y){Y>0&&Y<=dt&&(re.splice(Y,1),ct.splice(Y,1),dt--,H>dt&&(H=dt),this.setPage(H))},ea=function(Y){Y>0&&Y<=dt&&(H=Y)},Ba=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return re.length-1},Oi=function(Y,de,Re){var $e,st=void 0;return Re=Re||{},Y=Y!==void 0?Y:Ve[Ye].fontName,de=de!==void 0?de:Ve[Ye].fontStyle,$e=Y.toLowerCase(),De[$e]!==void 0&&De[$e][de]!==void 0?st=De[$e][de]:De[Y]!==void 0&&De[Y][de]!==void 0?st=De[Y][de]:Re.disableWarning===!1&&Ir.warn("Unable to look up font label for font '"+Y+"', '"+de+"'. Refer to getFontList() for available fonts."),st||Re.noFallback||(st=De.times[de])==null&&(st=De.times.normal),st},Wn=f.__private__.putInfo=function(){var Y=Be(),de=function($e){return $e};for(var Re in u!==null&&(de=yn.encryptor(Y,0)),ee("<<"),ee("/Producer ("+un(de("jsPDF "+Zt.version))+")"),at)at.hasOwnProperty(Re)&&at[Re]&&ee("/"+Re.substr(0,1).toUpperCase()+Re.substr(1)+" ("+un(de(at[Re]))+")");ee("/CreationDate ("+un(de(E))+")"),ee(">>"),ee("endobj")},Ss=f.__private__.putCatalog=function(Y){var de=(Y=Y||{}).rootDictionaryObjId||me;switch(Be(),ee("<<"),ee("/Type /Catalog"),ee("/Pages "+de+" 0 R"),pe||(pe="fullwidth"),pe){case"fullwidth":ee("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ee("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ee("/OpenAction [3 0 R /Fit]");break;case"original":ee("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Re=""+pe;Re.substr(Re.length-1)==="%"&&(pe=parseInt(pe)/100),typeof pe=="number"&&ee("/OpenAction [3 0 R /XYZ null null "+q(pe)+"]")}switch(je||(je="continuous"),je){case"continuous":ee("/PageLayout /OneColumn");break;case"single":ee("/PageLayout /SinglePage");break;case"two":case"twoleft":ee("/PageLayout /TwoColumnLeft");break;case"tworight":ee("/PageLayout /TwoColumnRight")}Te&&ee("/PageMode /"+Te),ut.publish("putCatalog"),ee(">>"),ee("endobj")},ya=f.__private__.putTrailer=function(){ee("trailer"),ee("<<"),ee("/Size "+(j+1)),ee("/Root "+j+" 0 R"),ee("/Info "+(j-1)+" 0 R"),u!==null&&ee("/Encrypt "+yn.oid+" 0 R"),ee("/ID [ <"+x+"> <"+x+"> ]"),ee(">>")},Mi=f.__private__.putHeader=function(){ee("%PDF-"+g),ee("%")},bo=f.__private__.putXRef=function(){var Y="0000000000";ee("xref"),ee("0 "+(j+1)),ee("0000000000 65535 f ");for(var de=1;de<=j;de++)typeof J[de]=="function"?ee((Y+J[de]()).slice(-10)+" 00000 n "):J[de]!==void 0?ee((Y+J[de]).slice(-10)+" 00000 n "):ee("0000000000 00000 n ")},rs=f.__private__.buildDocument=function(){le(),oe(P),ut.publish("buildDocument"),Mi(),Qe(),Fr(),xr(),u!==null&&sr(),Wn(),Ss();var Y=D;return bo(),ya(),ee("startxref"),ee(""+Y),ee("%%EOF"),oe(re[H]),P.join(`
`)},ks=f.__private__.getBlob=function(Y){return new Blob([se(Y)],{type:"application/pdf"})},Fi=f.output=f.__private__.output=Tn(function(Y,de){switch(typeof(de=de||{})=="string"?de={filename:de}:de.filename=de.filename||"generated.pdf",Y){case void 0:return rs();case"save":f.save(de.filename);break;case"arraybuffer":return se(rs());case"blob":return ks(rs());case"bloburi":case"bloburl":if(er.URL!==void 0&&typeof er.URL.createObjectURL=="function")return er.URL&&er.URL.createObjectURL(ks(rs()))||void 0;Ir.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Re="",$e=rs();try{Re=iv($e)}catch{Re=iv(unescape(encodeURIComponent($e)))}return"data:application/pdf;filename="+de.filename+";base64,"+Re;case"pdfobjectnewwindow":if(Object.prototype.toString.call(er)==="[object Window]"){var st="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",vt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';de.pdfObjectUrl&&(st=de.pdfObjectUrl,vt="");var Tt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+st+'"'+vt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(de)+");<\/script></body></html>",It=er.open();return It!==null&&It.document.write(Tt),It}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(er)==="[object Window]"){var qt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(de.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+de.filename+'" width="500px" height="400px" /></body></html>',ur=er.open();if(ur!==null){ur.document.write(qt);var ir=this;ur.document.documentElement.querySelector("#pdfViewer").onload=function(){ur.document.title=de.filename,ur.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ir.output("bloburl"))}}return ur}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(er)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var wr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",de)+'"></iframe></body></html>',Jr=er.open();if(Jr!==null&&(Jr.document.write(wr),Jr.document.title=de.filename),Jr||typeof safari>"u")return Jr;break;case"datauri":case"dataurl":return er.document.location.href=this.output("datauristring",de);default:return null}}),ji=function(Y){return Array.isArray(ft)===!0&&ft.indexOf(Y)>-1};switch(n){case"pt":rt=1;break;case"mm":rt=72/25.4;break;case"cm":rt=72/2.54;break;case"in":rt=72;break;case"px":rt=ji("px_scaling")==1?.75:96/72;break;case"pc":case"em":rt=12;break;case"ex":rt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);rt=n}var yn=null;U(),_();var yo=function(Y){return u!==null?yn.encryptor(Y,0):function(de){return de}},Li=f.__private__.getPageInfo=f.getPageInfo=function(Y){if(isNaN(Y)||Y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ct[Y].objId,pageNumber:Y,pageContext:ct[Y]}},tr=f.__private__.getPageInfoByObjId=function(Y){if(isNaN(Y)||Y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var de in ct)if(ct[de].objId===Y)break;return Li(de)},xo=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:ct[H].objId,pageNumber:H,pageContext:ct[H]}};f.addPage=function(){return br.apply(this,arguments),this},f.setPage=function(){return ea.apply(this,arguments),oe.call(this,re[H]),this},f.insertPage=function(Y){return this.addPage(),this.movePage(H,Y),this},f.movePage=function(Y,de){var Re,$e;if(Y>de){Re=re[Y],$e=ct[Y];for(var st=Y;st>de;st--)re[st]=re[st-1],ct[st]=ct[st-1];re[de]=Re,ct[de]=$e,this.setPage(de)}else if(Y<de){Re=re[Y],$e=ct[Y];for(var vt=Y;vt<de;vt++)re[vt]=re[vt+1],ct[vt]=ct[vt+1];re[de]=Re,ct[de]=$e,this.setPage(de)}return this},f.deletePage=function(){return pr.apply(this,arguments),this},f.__private__.text=f.text=function(Y,de,Re,$e,st){var vt,Tt,It,qt,ur,ir,wr,Jr,tn,xn=($e=$e||{}).scope||this;if(typeof Y=="number"&&typeof de=="number"&&(typeof Re=="string"||Array.isArray(Re))){var ns=Re;Re=de,de=Y,Y=ns}if(arguments[3]instanceof yt?(R("The transform parameter of text() with a Matrix value"),tn=st):(It=arguments[4],qt=arguments[5],kr(wr=arguments[3])==="object"&&wr!==null||(typeof It=="string"&&(qt=It,It=null),typeof wr=="string"&&(qt=wr,wr=null),typeof wr=="number"&&(It=wr,wr=null),$e={flags:wr,angle:It,align:qt})),isNaN(de)||isNaN(Re)||Y==null)throw new Error("Invalid arguments passed to jsPDF.text");if(Y.length===0)return xn;var jn="",Ua=!1,ta=typeof $e.lineHeightFactor=="number"?$e.lineHeightFactor:Cl,di=xn.internal.scaleFactor;function gd(Br){return Br=Br.split("	").join(Array($e.TabLen||9).join(" ")),un(Br,wr)}function af(Br){for(var $r,hn=Br.concat(),Nn=[],Hi=hn.length;Hi--;)typeof($r=hn.shift())=="string"?Nn.push($r):Array.isArray(Br)&&($r.length===1||$r[1]===void 0&&$r[2]===void 0)?Nn.push($r[0]):Nn.push([$r[0],$r[1],$r[2]]);return Nn}function of(Br,$r){var hn;if(typeof Br=="string")hn=$r(Br)[0];else if(Array.isArray(Br)){for(var Nn,Hi,mf=Br.concat(),Oc=[],wd=mf.length;wd--;)typeof(Nn=mf.shift())=="string"?Oc.push($r(Nn)[0]):Array.isArray(Nn)&&typeof Nn[0]=="string"&&(Hi=$r(Nn[0],Nn[1],Nn[2]),Oc.push([Hi[0],Hi[1],Hi[2]]));hn=Oc}return hn}var kc=!1,lf=!0;if(typeof Y=="string")kc=!0;else if(Array.isArray(Y)){var cf=Y.concat();Tt=[];for(var Ec,Gn=cf.length;Gn--;)(typeof(Ec=cf.shift())!="string"||Array.isArray(Ec)&&typeof Ec[0]!="string")&&(lf=!1);kc=lf}if(kc===!1)throw new Error('Type of text must be string or Array. "'+Y+'" is not recognized.');typeof Y=="string"&&(Y=Y.match(/[\r?\n]/)?Y.split(/\r\n|\r|\n/g):[Y]);var Ac=ue/xn.internal.scaleFactor,Cc=Ac*(ta-1);switch($e.baseline){case"bottom":Re-=Cc;break;case"top":Re+=Ac-Cc;break;case"hanging":Re+=Ac-2*Cc;break;case"middle":Re+=Ac/2-Cc}if((ir=$e.maxWidth||0)>0&&(typeof Y=="string"?Y=xn.splitTextToSize(Y,ir):Object.prototype.toString.call(Y)==="[object Array]"&&(Y=Y.reduce(function(Br,$r){return Br.concat(xn.splitTextToSize($r,ir))},[]))),vt={text:Y,x:de,y:Re,options:$e,mutex:{pdfEscape:un,activeFontKey:Ye,fonts:Ve,activeFontSize:ue}},ut.publish("preProcessText",vt),Y=vt.text,It=($e=vt.options).angle,!(tn instanceof yt)&&It&&typeof It=="number"){It*=Math.PI/180,$e.rotationDirection===0&&(It=-It),y===b.ADVANCED&&(It=-It);var Tc=Math.cos(It),uf=Math.sin(It);tn=new yt(Tc,uf,-uf,Tc,0,0)}else It&&It instanceof yt&&(tn=It);y!==b.ADVANCED||tn||(tn=$t),(ur=$e.charSpace||wc)!==void 0&&(jn+=F(I(ur))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Jr=$e.horizontalScale)!==void 0&&(jn+=F(100*Jr)+` Tz
`),$e.lang;var Ls=-1,Xm=$e.renderingMode!==void 0?$e.renderingMode:$e.stroke,ff=xn.internal.getCurrentPageInfo().pageContext;switch(Xm){case 0:case!1:case"fill":Ls=0;break;case 1:case!0:case"stroke":Ls=1;break;case 2:case"fillThenStroke":Ls=2;break;case 3:case"invisible":Ls=3;break;case 4:case"fillAndAddForClipping":Ls=4;break;case 5:case"strokeAndAddPathForClipping":Ls=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ls=6;break;case 7:case"addToPathForClipping":Ls=7}var vd=ff.usedRenderingMode!==void 0?ff.usedRenderingMode:-1;Ls!==-1?jn+=Ls+` Tr
`:vd!==-1&&(jn+=`0 Tr
`),Ls!==-1&&(ff.usedRenderingMode=Ls),qt=$e.align||"left";var xa,Nc=ue*ta,bd=xn.internal.pageSize.getWidth(),yd=Ve[Ye];ur=$e.charSpace||wc,ir=$e.maxWidth||0,wr=Object.assign({autoencode:!0,noBOM:!0},$e.flags);var Eo=[],Dl=function(Br){return xn.getStringUnitWidth(Br,{font:yd,charSpace:ur,fontSize:ue,doKerning:!1})*ue/di};if(Object.prototype.toString.call(Y)==="[object Array]"){var Is;Tt=af(Y),qt!=="left"&&(xa=Tt.map(Dl));var Es,Ao=0;if(qt==="right"){de-=xa[0],Y=[],Gn=Tt.length;for(var Bi=0;Bi<Gn;Bi++)Bi===0?(Es=hi(de),Is=Ii(Re)):(Es=I(Ao-xa[Bi]),Is=-Nc),Y.push([Tt[Bi],Es,Is]),Ao=xa[Bi]}else if(qt==="center"){de-=xa[0]/2,Y=[],Gn=Tt.length;for(var $i=0;$i<Gn;$i++)$i===0?(Es=hi(de),Is=Ii(Re)):(Es=I((Ao-xa[$i])/2),Is=-Nc),Y.push([Tt[$i],Es,Is]),Ao=xa[$i]}else if(qt==="left"){Y=[],Gn=Tt.length;for(var Dc=0;Dc<Gn;Dc++)Y.push(Tt[Dc])}else if(qt==="justify"&&yd.encoding==="Identity-H"){Y=[],Gn=Tt.length,ir=ir!==0?ir:bd;for(var Ui=0,fn=0;fn<Gn;fn++)if(Is=fn===0?Ii(Re):-Nc,Es=fn===0?hi(de):Ui,fn<Gn-1){var hf=I((ir-xa[fn])/(Tt[fn].split(" ").length-1)),As=Tt[fn].split(" ");Y.push([As[0]+" ",Es,Is]),Ui=0;for(var wa=1;wa<As.length;wa++){var Rc=(Dl(As[wa-1]+" "+As[wa])-Dl(As[wa]))*di+hf;wa==As.length-1?Y.push([As[wa],Rc,0]):Y.push([As[wa]+" ",Rc,0]),Ui-=Rc}}else Y.push([Tt[fn],Es,Is]);Y.push(["",Ui,0])}else{if(qt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(Y=[],Gn=Tt.length,ir=ir!==0?ir:bd,fn=0;fn<Gn;fn++)Is=fn===0?Ii(Re):-Nc,Es=fn===0?hi(de):0,fn<Gn-1?Eo.push(F(I((ir-xa[fn])/(Tt[fn].split(" ").length-1)))):Eo.push(0),Y.push([Tt[fn],Es,Is])}}var xd=typeof $e.R2L=="boolean"?$e.R2L:ye;xd===!0&&(Y=of(Y,function(Br,$r,hn){return[Br.split("").reverse().join(""),$r,hn]})),vt={text:Y,x:de,y:Re,options:$e,mutex:{pdfEscape:un,activeFontKey:Ye,fonts:Ve,activeFontSize:ue}},ut.publish("postProcessText",vt),Y=vt.text,Ua=vt.mutex.isHex||!1;var df=Ve[Ye].encoding;df!=="WinAnsiEncoding"&&df!=="StandardEncoding"||(Y=of(Y,function(Br,$r,hn){return[gd(Br),$r,hn]})),Tt=af(Y),Y=[];for(var Rl,Pl,Co,Ol=0,Pc=1,Ml=Array.isArray(Tt[0])?Pc:Ol,To="",pf=function(Br,$r,hn){var Nn="";return hn instanceof yt?(hn=typeof $e.angle=="number"?Vt(hn,new yt(1,0,0,1,Br,$r)):Vt(new yt(1,0,0,1,Br,$r),hn),y===b.ADVANCED&&(hn=Vt(new yt(1,0,0,-1,0,0),hn)),Nn=hn.join(" ")+` Tm
`):Nn=F(Br)+" "+F($r)+` Td
`,Nn},_a=0;_a<Tt.length;_a++){switch(To="",Ml){case Pc:Co=(Ua?"<":"(")+Tt[_a][0]+(Ua?">":")"),Rl=parseFloat(Tt[_a][1]),Pl=parseFloat(Tt[_a][2]);break;case Ol:Co=(Ua?"<":"(")+Tt[_a]+(Ua?">":")"),Rl=hi(de),Pl=Ii(Re)}Eo!==void 0&&Eo[_a]!==void 0&&(To=Eo[_a]+` Tw
`),_a===0?Y.push(To+pf(Rl,Pl,tn)+Co):Ml===Ol?Y.push(To+Co):Ml===Pc&&Y.push(To+pf(Rl,Pl,tn)+Co)}Y=Ml===Ol?Y.join(` Tj
T* `):Y.join(` Tj
`),Y+=` Tj
`;var Sa=`BT
/`;return Sa+=Ye+" "+ue+` Tf
`,Sa+=F(ue*ta)+` TL
`,Sa+=Tl+`
`,Sa+=jn,Sa+=Y,ee(Sa+="ET"),h[Ye]=!0,xn};var wo=f.__private__.clip=f.clip=function(Y){return ee(Y==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return wo("evenodd")},f.__private__.discardPath=f.discardPath=function(){return ee("n"),this};var fi=f.__private__.isValidStyle=function(Y){var de=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(Y)!==-1&&(de=!0),de};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(Y){return fi(Y)&&(c=Y),this};var ld=f.__private__.getStyle=f.getStyle=function(Y){var de=c;switch(Y){case"D":case"S":de="S";break;case"F":de="f";break;case"FD":case"DF":de="B";break;case"f":case"f*":case"B":case"B*":de=Y}return de},cd=f.close=function(){return ee("h"),this};f.stroke=function(){return ee("S"),this},f.fill=function(Y){return yc("f",Y),this},f.fillEvenOdd=function(Y){return yc("f*",Y),this},f.fillStroke=function(Y){return yc("B",Y),this},f.fillStrokeEvenOdd=function(Y){return yc("B*",Y),this};var yc=function(Y,de){kr(de)==="object"?Um(de,Y):ee(Y)},Ku=function(Y){Y===null||y===b.ADVANCED&&Y===void 0||(Y=ld(Y),ee(Y))};function $m(Y,de,Re,$e,st){var vt=new uu(de||this.boundingBox,Re||this.xStep,$e||this.yStep,this.gState,st||this.matrix);vt.stream=this.stream;var Tt=Y+"$$"+this.cloneIndex+++"$$";return Fe(Tt,vt),vt}var Um=function(Y,de){var Re=nt[Y.key],$e=Xe[Re];if($e instanceof ql)ee("q"),ee(Hm(de)),$e.gState&&f.setGState($e.gState),ee(Y.matrix.toString()+" cm"),ee("/"+Re+" sh"),ee("Q");else if($e instanceof uu){var st=new yt(1,0,0,-1,0,ko());Y.matrix&&(st=st.multiply(Y.matrix||$t),Re=$m.call($e,Y.key,Y.boundingBox,Y.xStep,Y.yStep,st).id),ee("q"),ee("/Pattern cs"),ee("/"+Re+" scn"),$e.gState&&f.setGState($e.gState),ee(de),ee("Q")}},Hm=function(Y){switch(Y){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Yu=f.moveTo=function(Y,de){return ee(F(I(Y))+" "+F(O(de))+" m"),this},Al=f.lineTo=function(Y,de){return ee(F(I(Y))+" "+F(O(de))+" l"),this},_o=f.curveTo=function(Y,de,Re,$e,st,vt){return ee([F(I(Y)),F(O(de)),F(I(Re)),F(O($e)),F(I(st)),F(O(vt)),"c"].join(" ")),this};f.__private__.line=f.line=function(Y,de,Re,$e,st){if(isNaN(Y)||isNaN(de)||isNaN(Re)||isNaN($e)||!fi(st))throw new Error("Invalid arguments passed to jsPDF.line");return y===b.COMPAT?this.lines([[Re-Y,$e-de]],Y,de,[1,1],st||"S"):this.lines([[Re-Y,$e-de]],Y,de,[1,1]).stroke()},f.__private__.lines=f.lines=function(Y,de,Re,$e,st,vt){var Tt,It,qt,ur,ir,wr,Jr,tn,xn,ns,jn,Ua;if(typeof Y=="number"&&(Ua=Re,Re=de,de=Y,Y=Ua),$e=$e||[1,1],vt=vt||!1,isNaN(de)||isNaN(Re)||!Array.isArray(Y)||!Array.isArray($e)||!fi(st)||typeof vt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Yu(de,Re),Tt=$e[0],It=$e[1],ur=Y.length,ns=de,jn=Re,qt=0;qt<ur;qt++)(ir=Y[qt]).length===2?(ns=ir[0]*Tt+ns,jn=ir[1]*It+jn,Al(ns,jn)):(wr=ir[0]*Tt+ns,Jr=ir[1]*It+jn,tn=ir[2]*Tt+ns,xn=ir[3]*It+jn,ns=ir[4]*Tt+ns,jn=ir[5]*It+jn,_o(wr,Jr,tn,xn,ns,jn));return vt&&cd(),Ku(st),this},f.path=function(Y){for(var de=0;de<Y.length;de++){var Re=Y[de],$e=Re.c;switch(Re.op){case"m":Yu($e[0],$e[1]);break;case"l":Al($e[0],$e[1]);break;case"c":_o.apply(this,$e);break;case"h":cd()}}return this},f.__private__.rect=f.rect=function(Y,de,Re,$e,st){if(isNaN(Y)||isNaN(de)||isNaN(Re)||isNaN($e)||!fi(st))throw new Error("Invalid arguments passed to jsPDF.rect");return y===b.COMPAT&&($e=-$e),ee([F(I(Y)),F(O(de)),F(I(Re)),F(I($e)),"re"].join(" ")),Ku(st),this},f.__private__.triangle=f.triangle=function(Y,de,Re,$e,st,vt,Tt){if(isNaN(Y)||isNaN(de)||isNaN(Re)||isNaN($e)||isNaN(st)||isNaN(vt)||!fi(Tt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Re-Y,$e-de],[st-Re,vt-$e],[Y-st,de-vt]],Y,de,[1,1],Tt,!0),this},f.__private__.roundedRect=f.roundedRect=function(Y,de,Re,$e,st,vt,Tt){if(isNaN(Y)||isNaN(de)||isNaN(Re)||isNaN($e)||isNaN(st)||isNaN(vt)||!fi(Tt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var It=4/3*(Math.SQRT2-1);return st=Math.min(st,.5*Re),vt=Math.min(vt,.5*$e),this.lines([[Re-2*st,0],[st*It,0,st,vt-vt*It,st,vt],[0,$e-2*vt],[0,vt*It,-st*It,vt,-st,vt],[2*st-Re,0],[-st*It,0,-st,-vt*It,-st,-vt],[0,2*vt-$e],[0,-vt*It,st*It,-vt,st,-vt]],Y+st,de,[1,1],Tt,!0),this},f.__private__.ellipse=f.ellipse=function(Y,de,Re,$e,st){if(isNaN(Y)||isNaN(de)||isNaN(Re)||isNaN($e)||!fi(st))throw new Error("Invalid arguments passed to jsPDF.ellipse");var vt=4/3*(Math.SQRT2-1)*Re,Tt=4/3*(Math.SQRT2-1)*$e;return Yu(Y+Re,de),_o(Y+Re,de-Tt,Y+vt,de-$e,Y,de-$e),_o(Y-vt,de-$e,Y-Re,de-Tt,Y-Re,de),_o(Y-Re,de+Tt,Y-vt,de+$e,Y,de+$e),_o(Y+vt,de+$e,Y+Re,de+Tt,Y+Re,de),Ku(st),this},f.__private__.circle=f.circle=function(Y,de,Re,$e){if(isNaN(Y)||isNaN(de)||isNaN(Re)||!fi($e))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(Y,de,Re,Re,$e)},f.setFont=function(Y,de,Re){return Re&&(de=L(de,Re)),Ye=Oi(Y,de,{disableWarning:!1}),this};var zm=f.__private__.getFont=f.getFont=function(){return Ve[Oi.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var Y,de,Re={};for(Y in De)if(De.hasOwnProperty(Y))for(de in Re[Y]=[],De[Y])De[Y].hasOwnProperty(de)&&Re[Y].push(de);return Re},f.addFont=function(Y,de,Re,$e,st){var vt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&vt.indexOf(arguments[3])!==-1?st=arguments[3]:arguments[3]&&vt.indexOf(arguments[3])==-1&&(Re=L(Re,$e)),st=st||"Identity-H",cn.call(this,Y,de,Re,st)};var Cl,Ju=t.lineWidth||.200025,xc=f.__private__.getLineWidth=f.getLineWidth=function(){return Ju},ud=f.__private__.setLineWidth=f.setLineWidth=function(Y){return Ju=Y,ee(F(I(Y))+" w"),this};f.__private__.setLineDash=Zt.API.setLineDash=Zt.API.setLineDashPattern=function(Y,de){if(Y=Y||[],de=de||0,isNaN(de)||!Array.isArray(Y))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return Y=Y.map(function(Re){return F(I(Re))}).join(" "),de=F(I(de)),ee("["+Y+"] "+de+" d"),this};var fd=f.__private__.getLineHeight=f.getLineHeight=function(){return ue*Cl};f.__private__.getLineHeight=f.getLineHeight=function(){return ue*Cl};var hd=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(Y){return typeof(Y=Y||1.15)=="number"&&(Cl=Y),this},dd=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Cl};hd(t.lineHeight);var hi=f.__private__.getHorizontalCoordinate=function(Y){return I(Y)},Ii=f.__private__.getVerticalCoordinate=function(Y){return y===b.ADVANCED?Y:ct[H].mediaBox.topRightY-ct[H].mediaBox.bottomLeftY-I(Y)},Vm=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(Y){return F(hi(Y))},So=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(Y){return F(Ii(Y))},$a=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return _e($a)},f.__private__.setStrokeColor=f.setDrawColor=function(Y,de,Re,$e){return $a=Ee({ch1:Y,ch2:de,ch3:Re,ch4:$e,pdfColorType:"draw",precision:2}),ee($a),this};var Zu=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return _e(Zu)},f.__private__.setFillColor=f.setFillColor=function(Y,de,Re,$e){return Zu=Ee({ch1:Y,ch2:de,ch3:Re,ch4:$e,pdfColorType:"fill",precision:2}),ee(Zu),this};var Tl=t.textColor||"0 g",qm=f.__private__.getTextColor=f.getTextColor=function(){return _e(Tl)};f.__private__.setTextColor=f.setTextColor=function(Y,de,Re,$e){return Tl=Ee({ch1:Y,ch2:de,ch3:Re,ch4:$e,pdfColorType:"text",precision:3}),this};var wc=t.charSpace,Wm=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(wc||0)};f.__private__.setCharSpace=f.setCharSpace=function(Y){if(isNaN(Y))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return wc=Y,this};var Qu=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(Y){var de=f.CapJoinStyles[Y];if(de===void 0)throw new Error("Line cap style of '"+Y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qu=de,ee(de+" J"),this};var ef=0;f.__private__.setLineJoin=f.setLineJoin=function(Y){var de=f.CapJoinStyles[Y];if(de===void 0)throw new Error("Line join style of '"+Y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ef=de,ee(de+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(Y){if(Y=Y||0,isNaN(Y))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ee(F(I(Y))+" M"),this},f.GState=Up,f.setGState=function(Y){(Y=typeof Y=="string"?Je[wt[Y]]:pd(null,Y)).equals(gt)||(ee("/"+Y.id+" gs"),gt=Y)};var pd=function(Y,de){if(!Y||!wt[Y]){var Re=!1;for(var $e in Je)if(Je.hasOwnProperty($e)&&Je[$e].equals(de)){Re=!0;break}if(Re)de=Je[$e];else{var st="GS"+(Object.keys(Je).length+1).toString(10);Je[st]=de,de.id=st}return Y&&(wt[Y]=de.id),ut.publish("addGState",de),de}};f.addGState=function(Y,de){return pd(Y,de),this},f.saveGraphicsState=function(){return ee("q"),Oe.push({key:Ye,size:ue,color:Tl}),this},f.restoreGraphicsState=function(){ee("Q");var Y=Oe.pop();return Ye=Y.key,ue=Y.size,Tl=Y.color,gt=null,this},f.setCurrentTransformationMatrix=function(Y){return ee(Y.toString()+" cm"),this},f.comment=function(Y){return ee("#"+Y),this};var _c=function(Y,de){var Re=Y||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Re},set:function(vt){isNaN(vt)||(Re=parseFloat(vt))}});var $e=de||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return $e},set:function(vt){isNaN(vt)||($e=parseFloat(vt))}});var st="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return st},set:function(vt){st=vt.toString()}}),this},tf=function(Y,de,Re,$e){_c.call(this,Y,de),this.type="rect";var st=Re||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return st},set:function(Tt){isNaN(Tt)||(st=parseFloat(Tt))}});var vt=$e||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return vt},set:function(Tt){isNaN(Tt)||(vt=parseFloat(Tt))}}),this},rf=function(){this.page=dt,this.currentPage=H,this.pages=re.slice(0),this.pagesContext=ct.slice(0),this.x=ht,this.y=Ce,this.matrix=Ie,this.width=Nl(H),this.height=ko(H),this.outputDestination=ne,this.id="",this.objectNumber=-1};rf.prototype.restore=function(){dt=this.page,H=this.currentPage,ct=this.pagesContext,re=this.pages,ht=this.x,Ce=this.y,Ie=this.matrix,nf(H,this.width),sf(H,this.height),ne=this.outputDestination};var md=function(Y,de,Re,$e,st){Ot.push(new rf),dt=H=0,re=[],ht=Y,Ce=de,Ie=st,ba([Re,$e])},Gm=function(Y){if(jt[Y])Ot.pop().restore();else{var de=new rf,Re="Xo"+(Object.keys(Et).length+1).toString(10);de.id=Re,jt[Y]=Re,Et[Re]=de,ut.publish("addFormObject",de),Ot.pop().restore()}};for(var Sc in f.beginFormObject=function(Y,de,Re,$e,st){return md(Y,de,Re,$e,st),this},f.endFormObject=function(Y){return Gm(Y),this},f.doFormObject=function(Y,de){var Re=Et[jt[Y]];return ee("q"),ee(de.toString()+" cm"),ee("/"+Re.id+" Do"),ee("Q"),this},f.getFormObject=function(Y){var de=Et[jt[Y]];return{x:de.x,y:de.y,width:de.width,height:de.height,matrix:de.matrix}},f.save=function(Y,de){return Y=Y||"generated.pdf",(de=de||{}).returnPromise=de.returnPromise||!1,de.returnPromise===!1?(Ul(ks(rs()),Y),typeof Ul.unload=="function"&&er.setTimeout&&setTimeout(Ul.unload,911),this):new Promise(function(Re,$e){try{var st=Ul(ks(rs()),Y);typeof Ul.unload=="function"&&er.setTimeout&&setTimeout(Ul.unload,911),Re(st)}catch(vt){$e(vt.message)}})},Zt.API)Zt.API.hasOwnProperty(Sc)&&(Sc==="events"&&Zt.API.events.length?function(Y,de){var Re,$e,st;for(st=de.length-1;st!==-1;st--)Re=de[st][0],$e=de[st][1],Y.subscribe.apply(Y,[Re].concat(typeof $e=="function"?[$e]:$e))}(ut,Zt.API.events):f[Sc]=Zt.API[Sc]);var Nl=f.getPageWidth=function(Y){return(ct[Y=Y||H].mediaBox.topRightX-ct[Y].mediaBox.bottomLeftX)/rt},nf=f.setPageWidth=function(Y,de){ct[Y].mediaBox.topRightX=de*rt+ct[Y].mediaBox.bottomLeftX},ko=f.getPageHeight=function(Y){return(ct[Y=Y||H].mediaBox.topRightY-ct[Y].mediaBox.bottomLeftY)/rt},sf=f.setPageHeight=function(Y,de){ct[Y].mediaBox.topRightY=de*rt+ct[Y].mediaBox.bottomLeftY};return f.internal={pdfEscape:un,getStyle:ld,getFont:zm,getFontSize:fe,getCharSpace:Wm,getTextColor:qm,getLineHeight:fd,getLineHeightFactor:dd,getLineWidth:xc,write:Z,getHorizontalCoordinate:hi,getVerticalCoordinate:Ii,getCoordinateString:Vm,getVerticalCoordinateString:So,collections:{},newObject:Be,newAdditionalObject:ke,newObjectDeferred:tt,newObjectDeferredBegin:ce,getFilters:Le,putStream:Ke,events:ut,scaleFactor:rt,pageSize:{getWidth:function(){return Nl(H)},setWidth:function(Y){nf(H,Y)},getHeight:function(){return ko(H)},setHeight:function(Y){sf(H,Y)}},encryptionOptions:u,encryption:yn,getEncryptor:yo,output:Fi,getNumberOfPages:Ba,pages:re,out:ee,f2:q,f3:V,getPageInfo:Li,getPageInfoByObjId:tr,getCurrentPageInfo:xo,getPDFVersion:m,Point:_c,Rectangle:tf,Matrix:yt,hasHotfix:ji},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return Nl(H)},set:function(Y){nf(H,Y)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return ko(H)},set:function(Y){sf(H,Y)},enumerable:!0,configurable:!0}),_s.call(f,ie),Ye="F1",br(s,e),ut.publish("initialized"),f}Kc.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},Kc.prototype.toHexString=function(t){return t.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Kc.prototype.hexToBytes=function(t){for(var r=[],e=0;e<t.length;e+=2)r.push(String.fromCharCode(parseInt(t.substr(e,2),16)));return r.join("")},Kc.prototype.processOwnerPassword=function(t,r){return lv(ov(r).substr(0,5),t)},Kc.prototype.encryptor=function(t,r){var e=ov(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&r,r>>8&255)).substr(0,10);return function(n){return lv(e,n)}},Up.prototype.equals=function(t){var r,e="id,objectNumber,equals";if(!t||kr(t)!==kr(this))return!1;var n=0;for(r in this)if(!(e.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!t.hasOwnProperty(r)||this[r]!==t[r])return!1;n++}for(r in t)t.hasOwnProperty(r)&&e.indexOf(r)<0&&n--;return n===0},Zt.API={events:[]},Zt.version="3.0.1";var nn=Zt.API,fy=1,bc=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},qc=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},or=function(t){return t.toFixed(2)},Bo=function(t){return t.toFixed(5)};nn.__acroform__={};var Zs=function(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t},p3=function(t){return t*fy},bi=function(t){var r=new xk,e=zt.internal.getHeight(t)||0,n=zt.internal.getWidth(t)||0;return r.BBox=[0,0,Number(or(n)),Number(or(e))],r},VH=nn.__acroform__.setBit=function(t,r){if(t=t||0,r=r||0,isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<r},qH=nn.__acroform__.clearBit=function(t,r){if(t=t||0,r=r||0,isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<r)},WH=nn.__acroform__.getBit=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<r?1:0},mn=nn.__acroform__.getBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return WH(t,r-1)},gn=nn.__acroform__.setBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return VH(t,r-1)},vn=nn.__acroform__.clearBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return qH(t,r-1)},GH=nn.__acroform__.calculateCoordinates=function(t,r){var e=r.internal.getHorizontalCoordinate,n=r.internal.getVerticalCoordinate,s=t[0],a=t[1],i=t[2],o=t[3],l={};return l.lowerLeft_X=e(s)||0,l.lowerLeft_Y=n(a+o)||0,l.upperRight_X=e(s+i)||0,l.upperRight_Y=n(a)||0,[Number(or(l.lowerLeft_X)),Number(or(l.lowerLeft_Y)),Number(or(l.upperRight_X)),Number(or(l.upperRight_Y))]},XH=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var r=[],e=t._V||t.DV,n=cv(t,e),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(t.scope.__private__.encodeColorString(t.color)),r.push("/"+s+" "+or(n.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(n.text),r.push("ET"),r.push("Q"),r.push("EMC");var a=bi(t);return a.scope=t.scope,a.stream=r.join(`
`),a}},cv=function(t,r){var e=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},s=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");s=t.multiline?s.map(function(V){return V.split(`
`)}):s.map(function(V){return[V]});var a=e,i=zt.internal.getHeight(t)||0;i=i<0?-i:i;var o=zt.internal.getWidth(t)||0;o=o<0?-o:o;var l=function(V,I,C){if(V+1<s.length){var O=I+" "+s[V+1][0];return A0(O,t,C).width<=o-4}return!1};a++;e:for(;a>0;){r="",a--;var c,u,d=A0("3",t,a).height,h=t.multiline?i-a:(i-d)/2,f=h+=2,g=0,m=0,p=0;if(a<=0){r=`(...) Tj
`,r+="% Width of Text: "+A0(r,t,a=12).width+", FieldWidth:"+o+`
`;break}for(var v="",b=0,y=0;y<s.length;y++)if(s.hasOwnProperty(y)){var k=!1;if(s[y].length!==1&&p!==s[y].length-1){if((d+2)*(b+2)+2>i)continue e;v+=s[y][p],k=!0,m=y,y--}else{v=(v+=s[y][p]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var N=parseInt(y),L=l(N,v,a),F=y>=s.length-1;if(L&&!F){v+=" ",p=0;continue}if(L||F){if(F)m=N;else if(t.multiline&&(d+2)*(b+2)+2>i)continue e}else{if(!t.multiline||(d+2)*(b+2)+2>i)continue e;m=N}}for(var R="",B=g;B<=m;B++){var q=s[B];if(t.multiline){if(B===m){R+=q[p]+" ",p=(p+1)%q.length;continue}if(B===g){R+=q[q.length-1]+" ";continue}}R+=q[0]+" "}switch(R=R.substr(R.length-1)==" "?R.substr(0,R.length-1):R,u=A0(R,t,a).width,t.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;case"left":default:c=2}r+=or(c)+" "+or(f)+` Td
`,r+="("+bc(R)+`) Tj
`,r+=-or(c)+` 0 Td
`,f=-(a+2),u=0,g=k?m:m+1,b++,v=""}break}return n.text=r,n.fontSize=a,n},A0=function(t,r,e){var n=r.scope.internal.getFont(r.fontName,r.fontStyle),s=r.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:r.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:s}},KH={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},YH=function(t,r){var e={type:"reference",object:t};r.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===e.type&&n.object===e.object})===void 0&&r.internal.getPageInfo(t.page).pageContext.annotations.push(e)},JH=function(t,r){for(var e in t)if(t.hasOwnProperty(e)){var n=e,s=t[e];r.internal.newObjectDeferredBegin(s.objId,!0),kr(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete t[n]}},ZH=function(t,r){if(r.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(ci.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(KH)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");fy=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new wk,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];a.objId=void 0,a.hasAnnotation&&YH(a,e)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(e){(function(n,s){var a=!n;for(var i in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(i)){var o=n[i],l=[],c=o.Rect;if(o.Rect&&(o.Rect=GH(o.Rect,s)),s.internal.newObjectDeferredBegin(o.objId,!0),o.DA=zt.createDefaultAppearanceStream(o),kr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=XH(o);l.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var d="";for(var h in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(h)){var f=o.appearanceStreamContent[h];if(d+="/"+h+" ",d+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var i in f)if(f.hasOwnProperty(i)){var g=f[i];typeof g=="function"&&(g=g.call(s,o)),d+="/"+i+" "+g+" ",s.internal.acroformPlugin.xForms.indexOf(g)>=0||s.internal.acroformPlugin.xForms.push(g)}}else typeof(g=f)=="function"&&(g=g.call(s,o)),d+="/"+i+" "+g,s.internal.acroformPlugin.xForms.indexOf(g)>=0||s.internal.acroformPlugin.xForms.push(g);d+=">>"}l.push({key:"AP",value:`<<
`+d+">>"})}s.internal.putStream({additionalKeyValues:l,objectId:o.objId}),s.internal.out("endobj")}a&&JH(s.internal.acroformPlugin.xForms,s)})(e,t)}),t.internal.acroformPlugin.isInitialized=!0}},yk=nn.__acroform__.arrayToPdfArray=function(t,r,e){var n=function(i){return i};if(Array.isArray(t)){for(var s="[",a=0;a<t.length;a++)switch(a!==0&&(s+=" "),kr(t[a])){case"boolean":case"number":case"object":s+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(r!==void 0&&e&&(n=e.internal.getEncryptor(r)),s+="("+bc(n(t[a].toString()))+")"):s+=t[a].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},vg=function(t,r,e){var n=function(s){return s};return r!==void 0&&e&&(n=e.internal.getEncryptor(r)),(t=t||"").toString(),t="("+bc(n(t))+")"},ki=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ki.prototype.toString=function(){return this.objId+" 0 R"},ki.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},ki.prototype.getKeyValueListForStream=function(){var t=[],r=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var e in r)if(Object.getOwnPropertyDescriptor(this,r[e]).configurable===!1){var n=r[e],s=this[n];s&&(Array.isArray(s)?t.push({key:n,value:yk(s,this.objId,this.scope)}):s instanceof ki?(s.scope=this.scope,t.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:n,value:s}))}return t};var xk=function(){ki.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){t=e.trim()},get:function(){return t||null}})};Zs(xk,ki);var wk=function(){ki.call(this);var t,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var e=function(n){return n};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+bc(e(t))+")"}},set:function(e){t=e}})};Zs(wk,ki);var ci=function t(){ki.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');r=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!mn(r,3)},set:function(v){v?this.F=gn(r,3):this.F=vn(r,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');e=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof Hp)return;a="FieldObject"+t.FieldNum++}var v=function(b){return b};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+bc(v(a))+")"},set:function(v){a=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(v){a=v}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(v){i=v}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/fy:c},set:function(v){c=v}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(v){u=v}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof Hp||this instanceof ec))return vg(d,this.objId,this.scope)},set:function(v){v=v.toString(),d=v}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Hn?h:vg(h,this.objId,this.scope)},set:function(v){v=v.toString(),h=this instanceof Hn?v:v.substr(0,1)==="("?qc(v.substr(1,v.length-2)):qc(v)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Hn?qc(h.substr(1,h.length-1)):h},set:function(v){v=v.toString(),h=this instanceof Hn?"/"+v:v}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Hn?f:vg(f,this.objId,this.scope)},set:function(v){v=v.toString(),f=this instanceof Hn?v:v.substr(0,1)==="("?qc(v.substr(1,v.length-2)):qc(v)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Hn?qc(f.substr(1,f.length-1)):f},set:function(v){v=v.toString(),f=this instanceof Hn?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(v){v=!!v,m=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(v){g=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,1)},set:function(v){v?this.Ff=gn(this.Ff,1):this.Ff=vn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,2)},set:function(v){v?this.Ff=gn(this.Ff,2):this.Ff=vn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,3)},set:function(v){v?this.Ff=gn(this.Ff,3):this.Ff=vn(this.Ff,3)}});var p=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(p!==null)return p},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');p=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(p){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:p=2;break;case"center":case 1:p=1;break;case"left":case 0:default:p=0}}})};Zs(ci,ki);var wu=function(){ci.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){t=e}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return yk(r,this.objId,this.scope)},set:function(e){var n,s;s=[],typeof(n=e)=="string"&&(s=function(a,i,o){o||(o=1);for(var l,c=[];l=i.exec(a);)c.push(l[o]);return c}(n,/\((.*?)\)/g)),r=s}}),this.getOptions=function(){return r},this.setOptions=function(e){r=e,this.sort&&r.sort()},this.addOption=function(e){e=(e=e||"").toString(),r.push(e),this.sort&&r.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();r.indexOf(e)!==-1&&(r.splice(r.indexOf(e),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,18)},set:function(e){e?this.Ff=gn(this.Ff,18):this.Ff=vn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=gn(this.Ff,19):this.Ff=vn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,20)},set:function(e){e?(this.Ff=gn(this.Ff,20),r.sort()):this.Ff=vn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,22)},set:function(e){e?this.Ff=gn(this.Ff,22):this.Ff=vn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,23)},set:function(e){e?this.Ff=gn(this.Ff,23):this.Ff=vn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,27)},set:function(e){e?this.Ff=gn(this.Ff,27):this.Ff=vn(this.Ff,27)}}),this.hasAppearanceStream=!1};Zs(wu,ci);var _u=function(){wu.call(this),this.fontName="helvetica",this.combo=!1};Zs(_u,wu);var Su=function(){_u.call(this),this.combo=!0};Zs(Su,_u);var q0=function(){Su.call(this),this.edit=!0};Zs(q0,Su);var Hn=function(){ci.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,15)},set:function(e){e?this.Ff=gn(this.Ff,15):this.Ff=vn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,16)},set:function(e){e?this.Ff=gn(this.Ff,16):this.Ff=vn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,17)},set:function(e){e?this.Ff=gn(this.Ff,17):this.Ff=vn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,26)},set:function(e){e?this.Ff=gn(this.Ff,26):this.Ff=vn(this.Ff,26)}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(a){return a};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var n,s=[];for(n in s.push("<<"),r)s.push("/"+n+" ("+bc(e(r[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(e){kr(e)==="object"&&(r=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(e){typeof e=="string"&&(r.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(e){t="/"+e}})};Zs(Hn,ci);var W0=function(){Hn.call(this),this.pushButton=!0};Zs(W0,Hn);var ku=function(){Hn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r!==void 0?r:[]}})};Zs(ku,Hn);var Hp=function(){var t,r;ci.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(s){r=s}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(o){return o};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var a,i=[];for(a in i.push("<<"),n)i.push("/"+a+" ("+bc(s(n[a]))+")");return i.push(">>"),i.join(`
`)},set:function(s){kr(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(s){e="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=zt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Zs(Hp,ci),ku.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var e=this.Kids[r];e.appearanceStreamContent=t.createAppearanceStream(e.optionName),e.caption=t.getCA()}},ku.prototype.createOption=function(t){var r=new Hp;return r.Parent=this,r.optionName=t,this.Kids.push(r),QH.call(this.scope,r),r};var G0=function(){Hn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=zt.CheckBox.createAppearanceStream()};Zs(G0,Hn);var ec=function(){ci.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,13)},set:function(r){r?this.Ff=gn(this.Ff,13):this.Ff=vn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,21)},set:function(r){r?this.Ff=gn(this.Ff,21):this.Ff=vn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,23)},set:function(r){r?this.Ff=gn(this.Ff,23):this.Ff=vn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,24)},set:function(r){r?this.Ff=gn(this.Ff,24):this.Ff=vn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,25)},set:function(r){r?this.Ff=gn(this.Ff,25):this.Ff=vn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,26)},set:function(r){r?this.Ff=gn(this.Ff,26):this.Ff=vn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){Number.isInteger(r)&&(t=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Zs(ec,ci);var X0=function(){ec.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!mn(this.Ff,14)},set:function(t){t?this.Ff=gn(this.Ff,14):this.Ff=vn(this.Ff,14)}}),this.password=!0};Zs(X0,ec);var zt={CheckBox:{createAppearanceStream:function(){return{N:{On:zt.CheckBox.YesNormal},D:{On:zt.CheckBox.YesPushDown,Off:zt.CheckBox.OffPushDown}}},YesPushDown:function(t){var r=bi(t);r.scope=t.scope;var e=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),a=cv(t,t.caption);return e.push("0.749023 g"),e.push("0 0 "+or(zt.internal.getWidth(t))+" "+or(zt.internal.getHeight(t))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+n+" "+or(a.fontSize)+" Tf "+s),e.push("BT"),e.push(a.text),e.push("ET"),e.push("Q"),e.push("EMC"),r.stream=e.join(`
`),r},YesNormal:function(t){var r=bi(t);r.scope=t.scope;var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=[],a=zt.internal.getHeight(t),i=zt.internal.getWidth(t),o=cv(t,t.caption);return s.push("1 g"),s.push("0 0 "+or(i)+" "+or(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+or(i-1)+" "+or(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+e+" "+or(o.fontSize)+" Tf "+n),s.push(o.text),s.push("ET"),s.push("Q"),r.stream=s.join(`
`),r},OffPushDown:function(t){var r=bi(t);r.scope=t.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+or(zt.internal.getWidth(t))+" "+or(zt.internal.getHeight(t))+" re"),e.push("f"),r.stream=e.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(t){var r={D:{Off:zt.RadioButton.Circle.OffPushDown},N:{}};return r.N[t]=zt.RadioButton.Circle.YesNormal,r.D[t]=zt.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(t){var r=bi(t);r.scope=t.scope;var e=[],n=zt.internal.getWidth(t)<=zt.internal.getHeight(t)?zt.internal.getWidth(t)/4:zt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=zt.internal.Bezier_C,a=Number((n*s).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+Bo(zt.internal.getWidth(t)/2)+" "+Bo(zt.internal.getHeight(t)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),e.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),e.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),e.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),e.push("f"),e.push("Q"),r.stream=e.join(`
`),r},YesPushDown:function(t){var r=bi(t);r.scope=t.scope;var e=[],n=zt.internal.getWidth(t)<=zt.internal.getHeight(t)?zt.internal.getWidth(t)/4:zt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*zt.internal.Bezier_C).toFixed(5)),i=Number((n*zt.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Bo(zt.internal.getWidth(t)/2)+" "+Bo(zt.internal.getHeight(t)/2)+" cm"),e.push(s+" 0 m"),e.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),e.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),e.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),e.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+Bo(zt.internal.getWidth(t)/2)+" "+Bo(zt.internal.getHeight(t)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),e.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),e.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),e.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),e.push("f"),e.push("Q"),r.stream=e.join(`
`),r},OffPushDown:function(t){var r=bi(t);r.scope=t.scope;var e=[],n=zt.internal.getWidth(t)<=zt.internal.getHeight(t)?zt.internal.getWidth(t)/4:zt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*zt.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Bo(zt.internal.getWidth(t)/2)+" "+Bo(zt.internal.getHeight(t)/2)+" cm"),e.push(s+" 0 m"),e.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),e.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),e.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),e.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),e.push("f"),e.push("Q"),r.stream=e.join(`
`),r}},Cross:{createAppearanceStream:function(t){var r={D:{Off:zt.RadioButton.Cross.OffPushDown},N:{}};return r.N[t]=zt.RadioButton.Cross.YesNormal,r.D[t]=zt.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(t){var r=bi(t);r.scope=t.scope;var e=[],n=zt.internal.calculateCross(t);return e.push("q"),e.push("1 1 "+or(zt.internal.getWidth(t)-2)+" "+or(zt.internal.getHeight(t)-2)+" re"),e.push("W"),e.push("n"),e.push(or(n.x1.x)+" "+or(n.x1.y)+" m"),e.push(or(n.x2.x)+" "+or(n.x2.y)+" l"),e.push(or(n.x4.x)+" "+or(n.x4.y)+" m"),e.push(or(n.x3.x)+" "+or(n.x3.y)+" l"),e.push("s"),e.push("Q"),r.stream=e.join(`
`),r},YesPushDown:function(t){var r=bi(t);r.scope=t.scope;var e=zt.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+or(zt.internal.getWidth(t))+" "+or(zt.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+or(zt.internal.getWidth(t)-2)+" "+or(zt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(or(e.x1.x)+" "+or(e.x1.y)+" m"),n.push(or(e.x2.x)+" "+or(e.x2.y)+" l"),n.push(or(e.x4.x)+" "+or(e.x4.y)+" m"),n.push(or(e.x3.x)+" "+or(e.x3.y)+" l"),n.push("s"),n.push("Q"),r.stream=n.join(`
`),r},OffPushDown:function(t){var r=bi(t);r.scope=t.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+or(zt.internal.getWidth(t))+" "+or(zt.internal.getHeight(t))+" re"),e.push("f"),r.stream=e.join(`
`),r}}},createDefaultAppearanceStream:function(t){var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,e=t.scope.__private__.encodeColorString(t.color);return"/"+r+" "+t.fontSize+" Tf "+e}};zt.internal={Bezier_C:.551915024494,calculateCross:function(t){var r=zt.internal.getWidth(t),e=zt.internal.getHeight(t),n=Math.min(r,e);return{x1:{x:(r-n)/2,y:(e-n)/2+n},x2:{x:(r-n)/2+n,y:(e-n)/2},x3:{x:(r-n)/2,y:(e-n)/2},x4:{x:(r-n)/2+n,y:(e-n)/2+n}}}},zt.internal.getWidth=function(t){var r=0;return kr(t)==="object"&&(r=p3(t.Rect[2])),r},zt.internal.getHeight=function(t){var r=0;return kr(t)==="object"&&(r=p3(t.Rect[3])),r};var QH=nn.addField=function(t){if(ZH(this,t),!(t instanceof ci))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=t).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};nn.AcroFormChoiceField=wu,nn.AcroFormListBox=_u,nn.AcroFormComboBox=Su,nn.AcroFormEditBox=q0,nn.AcroFormButton=Hn,nn.AcroFormPushButton=W0,nn.AcroFormRadioButton=ku,nn.AcroFormCheckBox=G0,nn.AcroFormTextField=ec,nn.AcroFormPasswordField=X0,nn.AcroFormAppearance=zt,nn.AcroForm={ChoiceField:wu,ListBox:_u,ComboBox:Su,EditBox:q0,Button:Hn,PushButton:W0,RadioButton:ku,CheckBox:G0,TextField:ec,PasswordField:X0,Appearance:zt},Zt.AcroForm={ChoiceField:wu,ListBox:_u,ComboBox:Su,EditBox:q0,Button:Hn,PushButton:W0,RadioButton:ku,CheckBox:G0,TextField:ec,PasswordField:X0,Appearance:zt};Zt.AcroForm;function _k(t){return t.reduce(function(r,e,n){return r[e]=n,r},{})}(function(t){t.__addimage__={};var r="UNKNOWN",e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(V,I){var C,O,E,x,w,_=r;if((I=I||r)==="RGBA"||V.data!==void 0&&V.data instanceof Uint8ClampedArray&&"height"in V&&"width"in V)return"RGBA";if(L(V))for(w in e)for(E=e[w],C=0;C<E.length;C+=1){for(x=!0,O=0;O<E[C].length;O+=1)if(E[C][O]!==void 0&&E[C][O]!==V[O]){x=!1;break}if(x===!0){_=w;break}}else for(w in e)for(E=e[w],C=0;C<E.length;C+=1){for(x=!0,O=0;O<E[C].length;O+=1)if(E[C][O]!==void 0&&E[C][O]!==V.charCodeAt(O)){x=!1;break}if(x===!0){_=w;break}}return _===r&&I!==r&&(_=I),_},s=function V(I){for(var C=this.internal.write,O=this.internal.putStream,E=(0,this.internal.getFilters)();E.indexOf("FlateEncode")!==-1;)E.splice(E.indexOf("FlateEncode"),1);I.objectId=this.internal.newObject();var x=[];if(x.push({key:"Type",value:"/XObject"}),x.push({key:"Subtype",value:"/Image"}),x.push({key:"Width",value:I.width}),x.push({key:"Height",value:I.height}),I.colorSpace===p.INDEXED?x.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(I.palette.length/3-1)+" "+("sMask"in I&&I.sMask!==void 0?I.objectId+2:I.objectId+1)+" 0 R]"}):(x.push({key:"ColorSpace",value:"/"+I.colorSpace}),I.colorSpace===p.DEVICE_CMYK&&x.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),x.push({key:"BitsPerComponent",value:I.bitsPerComponent}),"decodeParameters"in I&&I.decodeParameters!==void 0&&x.push({key:"DecodeParms",value:"<<"+I.decodeParameters+">>"}),"transparency"in I&&Array.isArray(I.transparency)){for(var w="",_=0,S=I.transparency.length;_<S;_++)w+=I.transparency[_]+" "+I.transparency[_]+" ";x.push({key:"Mask",value:"["+w+"]"})}I.sMask!==void 0&&x.push({key:"SMask",value:I.objectId+1+" 0 R"});var T=I.filter!==void 0?["/"+I.filter]:void 0;if(O({data:I.data,additionalKeyValues:x,alreadyAppliedFilters:T,objectId:I.objectId}),C("endobj"),"sMask"in I&&I.sMask!==void 0){var U="/Predictor "+I.predictor+" /Colors 1 /BitsPerComponent "+I.bitsPerComponent+" /Columns "+I.width,A={width:I.width,height:I.height,colorSpace:"DeviceGray",bitsPerComponent:I.bitsPerComponent,decodeParameters:U,data:I.sMask};"filter"in I&&(A.filter=I.filter),V.call(this,A)}if(I.colorSpace===p.INDEXED){var H=this.internal.newObject();O({data:R(new Uint8Array(I.palette)),objectId:H}),C("endobj")}},a=function(){var V=this.internal.collections.addImage_images;for(var I in V)s.call(this,V[I])},i=function(){var V,I=this.internal.collections.addImage_images,C=this.internal.write;for(var O in I)C("/I"+(V=I[O]).index,V.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",i))},l=function(){var V=this.internal.collections.addImage_images;return o.call(this),V},c=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(V){return typeof t["process"+V.toUpperCase()]=="function"},d=function(V){return kr(V)==="object"&&V.nodeType===1},h=function(V,I){if(V.nodeName==="IMG"&&V.hasAttribute("src")){var C=""+V.getAttribute("src");if(C.indexOf("data:image/")===0)return dh(unescape(C).split("base64,").pop());var O=t.loadFile(C,!0);if(O!==void 0)return O}if(V.nodeName==="CANVAS"){if(V.width===0||V.height===0)throw new Error("Given canvas must have data. Canvas width: "+V.width+", height: "+V.height);var E;switch(I){case"PNG":E="image/png";break;case"WEBP":E="image/webp";break;case"JPEG":case"JPG":default:E="image/jpeg"}return dh(V.toDataURL(E,1).split("base64,").pop())}},f=function(V){var I=this.internal.collections.addImage_images;if(I){for(var C in I)if(V===I[C].alias)return I[C]}},g=function(V,I,C){return V||I||(V=-96,I=-96),V<0&&(V=-1*C.width*72/V/this.internal.scaleFactor),I<0&&(I=-1*C.height*72/I/this.internal.scaleFactor),V===0&&(V=I*C.width/C.height),I===0&&(I=V*C.height/C.width),[V,I]},m=function(V,I,C,O,E,x){var w=g.call(this,C,O,E),_=this.internal.getCoordinateString,S=this.internal.getVerticalCoordinateString,T=l.call(this);if(C=w[0],O=w[1],T[E.index]=E,x){x*=Math.PI/180;var U=Math.cos(x),A=Math.sin(x),H=function(K){return K.toFixed(4)},z=[H(U),H(A),H(-1*A),H(U),0,0,"cm"]}this.internal.write("q"),x?(this.internal.write([1,"0","0",1,_(V),S(I+O),"cm"].join(" ")),this.internal.write(z.join(" ")),this.internal.write([_(C),"0","0",_(O),"0","0","cm"].join(" "))):this.internal.write([_(C),"0","0",_(O),_(V),S(I+O),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+E.index+" Do"),this.internal.write("Q")},p=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(V){var I,C,O=0;if(typeof V=="string")for(C=V.length,I=0;I<C;I++)O=(O<<5)-O+V.charCodeAt(I),O|=0;else if(L(V))for(C=V.byteLength/2,I=0;I<C;I++)O=(O<<5)-O+V[I],O|=0;return O},y=t.__addimage__.validateStringAsBase64=function(V){(V=V||"").toString().trim();var I=!0;return V.length===0&&(I=!1),V.length%4!=0&&(I=!1),/^[A-Za-z0-9+/]+$/.test(V.substr(0,V.length-2))===!1&&(I=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(V.substr(-2))===!1&&(I=!1),I},k=t.__addimage__.extractImageFromDataUrl=function(V){if(V==null||!(V=V.trim()).startsWith("data:"))return null;var I=V.indexOf(",");return I<0?null:V.substring(0,I).trim().endsWith("base64")?V.substring(I+1):null},N=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(V){return N()&&V instanceof ArrayBuffer};var L=t.__addimage__.isArrayBufferView=function(V){return N()&&typeof Uint32Array<"u"&&(V instanceof Int8Array||V instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&V instanceof Uint8ClampedArray||V instanceof Int16Array||V instanceof Uint16Array||V instanceof Int32Array||V instanceof Uint32Array||V instanceof Float32Array||V instanceof Float64Array)},F=t.__addimage__.binaryStringToUint8Array=function(V){for(var I=V.length,C=new Uint8Array(I),O=0;O<I;O++)C[O]=V.charCodeAt(O);return C},R=t.__addimage__.arrayBufferToBinaryString=function(V){for(var I="",C=L(V)?V:new Uint8Array(V),O=0;O<C.length;O+=8192)I+=String.fromCharCode.apply(null,C.subarray(O,O+8192));return I};t.addImage=function(){var V,I,C,O,E,x,w,_,S;if(typeof arguments[1]=="number"?(I=r,C=arguments[1],O=arguments[2],E=arguments[3],x=arguments[4],w=arguments[5],_=arguments[6],S=arguments[7]):(I=arguments[1],C=arguments[2],O=arguments[3],E=arguments[4],x=arguments[5],w=arguments[6],_=arguments[7],S=arguments[8]),kr(V=arguments[0])==="object"&&!d(V)&&"imageData"in V){var T=V;V=T.imageData,I=T.format||I||r,C=T.x||C||0,O=T.y||O||0,E=T.w||T.width||E,x=T.h||T.height||x,w=T.alias||w,_=T.compression||_,S=T.rotation||T.angle||S}var U=this.internal.getFilters();if(_===void 0&&U.indexOf("FlateEncode")!==-1&&(_="SLOW"),isNaN(C)||isNaN(O))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var A=B.call(this,V,I,w,_);return m.call(this,C,O,E,x,A,S),this};var B=function(V,I,C,O){var E,x,w;if(typeof V=="string"&&n(V)===r){V=unescape(V);var _=q(V,!1);(_!==""||(_=t.loadFile(V,!0))!==void 0)&&(V=_)}if(d(V)&&(V=h(V,I)),I=n(V,I),!u(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(((w=C)==null||w.length===0)&&(C=function(S){return typeof S=="string"||L(S)?b(S):L(S.data)?b(S.data):null}(V)),(E=f.call(this,C))||(N()&&(V instanceof Uint8Array||I==="RGBA"||(x=V,V=F(V))),E=this["process"+I.toUpperCase()](V,c.call(this),C,function(S){return S&&typeof S=="string"&&(S=S.toUpperCase()),S in t.image_compression?S:v.NONE}(O),x)),!E)throw new Error("An unknown error occurred whilst processing the image.");return E},q=t.__addimage__.convertBase64ToBinaryString=function(V,I){I=typeof I!="boolean"||I;var C,O="";if(typeof V=="string"){var E;C=(E=k(V))!==null&&E!==void 0?E:V;try{O=dh(C)}catch(x){if(I)throw y(C)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+x.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return O};t.getImageProperties=function(V){var I,C,O="";if(d(V)&&(V=h(V)),typeof V=="string"&&n(V)===r&&((O=q(V,!1))===""&&(O=t.loadFile(V)||""),V=O),C=n(V),!u(C))throw new Error("addImage does not support files of type '"+C+"', please ensure that a plugin for '"+C+"' support is added.");if(!N()||V instanceof Uint8Array||(V=F(V)),!(I=this["process"+C.toUpperCase()](V)))throw new Error("An unknown error occurred whilst processing the image");return I.fileType=C,I}})(Zt.API),function(t){var r=function(e){if(e!==void 0&&e!="")return!0};Zt.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(e){for(var n,s,a,i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(e.objId),c=e.pageContext.annotations,u=!1,d=0;d<c.length&&!u;d++)switch((n=c[d]).type){case"link":(r(n.options.url)||r(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var h=0;h<c.length;h++){n=c[h];var f=this.internal.pdfEscape,g=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),p=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(m.objId),b=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(s="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+f(v(n.contents))+")",a+=" /Popup "+p.objId+" 0 R",a+=" /P "+l.objId+" 0 R",a+=" /T ("+f(v(b))+") >>",m.content=a;var y=m.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+i(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+y,n.open&&(a+=" /Open true"),a+=" >>",p.content=a,this.internal.write(m.objId,"0 R",p.objId,"0 R");break;case"freetext":s="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var k=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+f(g(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+k+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var N=this.annotations._nameMap[n.options.name];n.options.pageNumber=N.page,n.options.top=N.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+f(g(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var L=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+L+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(e){var n=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":n.pageContext.annotations.push(e)}},t.link=function(e,n,s,a,i){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(e),y:c(n),w:l(e+s),h:c(n+a)},options:i,type:"link"})},t.textWithLink=function(e,n,s,a){var i,o,l=this.getTextWidth(e),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var u=this.splitTextToSize(e,o).length;i=Math.ceil(c*u)}else o=l,i=c;return this.text(e,n,s,a),s+=.2*c,a.align==="center"&&(n-=l/2),a.align==="right"&&(n-=l),this.link(n,s-c,o,i,a),l},t.getTextWidth=function(e){var n=this.internal.getFontSize();return this.getStringUnitWidth(e)*n/this.internal.scaleFactor}}(Zt.API),function(t){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(m){return r[m.charCodeAt(0)]!==void 0},i=t.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},o=t.__arabicParser__.isArabicEndLetter=function(m){return i(m)&&a(m)&&r[m.charCodeAt(0)].length<=2},l=t.__arabicParser__.isArabicAlfLetter=function(m){return i(m)&&s.indexOf(m.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return i(m)&&a(m)&&r[m.charCodeAt(0)].length>=1};var c=t.__arabicParser__.arabicLetterHasFinalForm=function(m){return i(m)&&a(m)&&r[m.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(m){return i(m)&&a(m)&&r[m.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(m){return i(m)&&a(m)&&r[m.charCodeAt(0)].length==4},d=t.__arabicParser__.resolveLigatures=function(m){var p=0,v=e,b="",y=0;for(p=0;p<m.length;p+=1)v[m.charCodeAt(p)]!==void 0?(y++,typeof(v=v[m.charCodeAt(p)])=="number"&&(b+=String.fromCharCode(v),v=e,y=0),p===m.length-1&&(v=e,b+=m.charAt(p-(y-1)),p-=y-1,y=0)):(v=e,b+=m.charAt(p-y),p-=y,y=0);return b};t.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&n[m.charCodeAt(0)]!==void 0};var h=t.__arabicParser__.getCorrectForm=function(m,p,v){return i(m)?a(m)===!1?-1:!c(m)||!i(p)&&!i(v)||!i(v)&&o(p)||o(m)&&!i(p)||o(m)&&l(p)||o(m)&&o(p)?0:u(m)&&i(p)&&!o(p)&&i(v)&&c(v)?3:o(m)||!i(v)?1:2:-1},f=function(m){var p=0,v=0,b=0,y="",k="",N="",L=(m=m||"").split("\\s+"),F=[];for(p=0;p<L.length;p+=1){for(F.push(""),v=0;v<L[p].length;v+=1)y=L[p][v],k=L[p][v-1],N=L[p][v+1],i(y)?(b=h(y,k,N),F[p]+=b!==-1?String.fromCharCode(r[y.charCodeAt(0)][b]):y):F[p]+=y;F[p]=d(F[p])}return F.join(" ")},g=t.__arabicParser__.processArabic=t.processArabic=function(){var m,p=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(p)){var b=0;for(v=[],b=0;b<p.length;b+=1)Array.isArray(p[b])?v.push([f(p[b][0]),p[b][1],p[b][2]]):v.push([f(p[b])]);m=v}else m=f(p);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};t.events.push(["preProcessText",g])}(Zt.API),Zt.API.autoPrint=function(t){var r;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})}return this},function(t){var r=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(o){e=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(o){s=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(o){i=o}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(e,n){var s;if((e=e||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])}(Zt.API),function(t){var r={left:0,top:0,bottom:0,right:0},e=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(m){l=m}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(m){g=m}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},t.getTextDimensions=function(l,c){n.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),d=c.font||this.getFont(),h=c.scaleFactor||this.internal.scaleFactor,f=0,g=0,m=0,p=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var v=c.maxWidth;v>0?typeof l=="string"?l=this.splitTextToSize(l,v):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(y,k){return y.concat(p.splitTextToSize(k,v))},[])):l=Array.isArray(l)?l:[l];for(var b=0;b<l.length;b++)f<(m=this.getStringUnitWidth(l[b],{font:d})*u)&&(f=m);return f!==0&&(g=l.length),{w:f/=h,h:Math.max((g*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/h,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new a(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=t.cell=function(){var l;l=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,d=this.internal.__cell__.margins||r,h=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=d.top,f&&h&&(this.printHeaderRow(l.lineNumber,!0),l.y+=h[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,e===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};t.table=function(l,c,u,d,h){if(n.call(this),!u)throw new Error("No data for PDF table.");var f,g,m,p,v=[],b=[],y=[],k={},N={},L=[],F=[],R=(h=h||{}).autoSize||!1,B=h.printHeaders!==!1,q=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,V=h.margins||Object.assign({width:this.getPageWidth()},r),I=typeof h.padding=="number"?h.padding:3,C=h.headerBackgroundColor||"#c8c8c8",O=h.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=B,this.internal.__cell__.margins=V,this.internal.__cell__.table_font_size=q,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=C,this.internal.__cell__.headerTextColor=O,this.setFontSize(q),d==null)b=v=Object.keys(u[0]),y=v.map(function(){return"left"});else if(Array.isArray(d)&&kr(d[0])==="object")for(v=d.map(function(T){return T.name}),b=d.map(function(T){return T.prompt||T.name||""}),y=d.map(function(T){return T.align||"left"}),f=0;f<d.length;f+=1)N[d[f].name]=d[f].width*(19.049976/25.4);else Array.isArray(d)&&typeof d[0]=="string"&&(b=v=d,y=v.map(function(){return"left"}));if(R||Array.isArray(d)&&typeof d[0]=="string")for(f=0;f<v.length;f+=1){for(k[p=v[f]]=u.map(function(T){return T[p]}),this.setFont(void 0,"bold"),L.push(this.getTextDimensions(b[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=k[p],this.setFont(void 0,"normal"),m=0;m<g.length;m+=1)L.push(this.getTextDimensions(g[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);N[p]=Math.max.apply(null,L)+I+I,L=[]}if(B){var E={};for(f=0;f<v.length;f+=1)E[v[f]]={},E[v[f]].text=b[f],E[v[f]].align=y[f];var x=o.call(this,E,N);F=v.map(function(T){return new a(l,c,N[T],x,E[T].text,void 0,E[T].align)}),this.setTableHeaderRow(F),this.printHeaderRow(1,!1)}var w=d.reduce(function(T,U){return T[U.name]=U.align,T},{});for(f=0;f<u.length;f+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:f,data:u[f]},this);var _=o.call(this,u[f],N);for(m=0;m<v.length;m+=1){var S=u[f][v[m]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:f,col:m,data:S},this),i.call(this,new a(l,c,N[v[m]],_,S,f+2,w[v[m]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(l).map(function(f){var g=l[f];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,c[f]-u-u)},this).map(function(f){return this.getLineHeightFactor()*f.length*d/h+u+u},this).reduce(function(f,g){return Math.max(f,g)},0)};t.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},t.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){u=this.internal.__cell__.tableHeaderRow[f].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,h.push(u)),u.lineNumber=l;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,u),this.setTextColor(g)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),e=!1}}(Zt.API);var Sk={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},kk=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],uv=_k(kk),Ek=[100,200,300,400,500,600,700,800,900],ez=_k(Ek);function fv(t){var r=t.family.replace(/"|'/g,"").toLowerCase(),e=function(a){return Sk[a=a||"normal"]?a:"normal"}(t.style),n=function(a){if(!a)return 400;if(typeof a=="number")return a>=100&&a<=900&&a%100==0?a:400;if(/^\d00$/.test(a))return parseInt(a);switch(a){case"bold":return 700;case"normal":default:return 400}}(t.weight),s=function(a){return typeof uv[a=a||"normal"]=="number"?a:"normal"}(t.stretch);return{family:r,style:e,weight:n,stretch:s,src:t.src||[],ref:t.ref||{name:r,style:[s,e,n].join(" ")}}}function m3(t,r,e,n){var s;for(s=e;s>=0&&s<r.length;s+=n)if(t[r[s]])return t[r[s]];for(s=e;s>=0&&s<r.length;s-=n)if(t[r[s]])return t[r[s]]}var tz={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},g3={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function v3(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function rz(t,r,e){for(var n=(e=e||{}).defaultFontFamily||"times",s=Object.assign({},tz,e.genericFontFamilies||{}),a=null,i=null,o=0;o<r.length;++o)if(s[(a=fv(r[o])).family]&&(a.family=s[a.family]),t.hasOwnProperty(a.family)){i=t[a.family];break}if(!(i=i||t[n]))throw new Error("Could not find a font-family for the rule '"+v3(a)+"' and default family '"+n+"'.");if(i=function(l,c){if(c[l])return c[l];var u=uv[l],d=u<=uv.normal?-1:1,h=m3(c,kk,u,d);if(!h)throw new Error("Could not find a matching font-stretch value for "+l);return h}(a.stretch,i),i=function(l,c){if(c[l])return c[l];for(var u=Sk[l],d=0;d<u.length;++d)if(c[u[d]])return c[u[d]];throw new Error("Could not find a matching font-style for "+l)}(a.style,i),!(i=function(l,c){if(c[l])return c[l];if(l===400&&c[500])return c[500];if(l===500&&c[400])return c[400];var u=ez[l],d=m3(c,Ek,u,l<400?-1:1);if(!d)throw new Error("Could not find a matching font-weight for value "+l);return d}(a.weight,i)))throw new Error("Failed to resolve a font for the rule '"+v3(a)+"'.");return i}function b3(t){return t.trimLeft()}function nz(t,r){for(var e=0;e<t.length;){if(t.charAt(e)===r)return[t.substring(0,e),t.substring(e+1)];e+=1}return null}function sz(t){var r=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],t.substring(r[0].length)]}var C0,y3,x3,bg=["times"];(function(t){var r,e,n,s,a,i,o,l,c,u=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new l,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new i,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new i,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new d(this),r=this.internal.f2,e=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,i=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var d=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=A;Object.defineProperty(this,"pdf",{get:function(){return H}});var z=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return z},set:function(oe){z=!!oe}});var K=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return K},set:function(oe){K=!!oe}});var j=0;Object.defineProperty(this,"posX",{get:function(){return j},set:function(oe){isNaN(oe)||(j=oe)}});var J=0;Object.defineProperty(this,"posY",{get:function(){return J},set:function(oe){isNaN(oe)||(J=oe)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(oe){var ee;typeof oe=="number"?ee=[oe,oe,oe,oe]:((ee=new Array(4))[0]=oe[0],ee[1]=oe.length>=2?oe[1]:ee[0],ee[2]=oe.length>=3?oe[2]:ee[0],ee[3]=oe.length>=4?oe[3]:ee[1]),c.margin=ee}});var P=!1;Object.defineProperty(this,"autoPaging",{get:function(){return P},set:function(oe){P=oe}});var D=0;Object.defineProperty(this,"lastBreak",{get:function(){return D},set:function(oe){D=oe}});var G=[];Object.defineProperty(this,"pageBreaks",{get:function(){return G},set:function(oe){G=oe}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(oe){oe instanceof u&&(c=oe)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(oe){c.path=oe}});var re=[];Object.defineProperty(this,"ctxStack",{get:function(){return re},set:function(oe){re=oe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(oe){var ee;ee=h(oe),this.ctx.fillStyle=ee.style,this.ctx.isFillTransparent=ee.a===0,this.ctx.fillOpacity=ee.a,this.pdf.setFillColor(ee.r,ee.g,ee.b,{a:ee.a}),this.pdf.setTextColor(ee.r,ee.g,ee.b,{a:ee.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(oe){var ee=h(oe);this.ctx.strokeStyle=ee.style,this.ctx.isStrokeTransparent=ee.a===0,this.ctx.strokeOpacity=ee.a,ee.a===0?this.pdf.setDrawColor(255,255,255):(ee.a,this.pdf.setDrawColor(ee.r,ee.g,ee.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(oe){["butt","round","square"].indexOf(oe)!==-1&&(this.ctx.lineCap=oe,this.pdf.setLineCap(oe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(oe){isNaN(oe)||(this.ctx.lineWidth=oe,this.pdf.setLineWidth(oe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(oe){["bevel","round","miter"].indexOf(oe)!==-1&&(this.ctx.lineJoin=oe,this.pdf.setLineJoin(oe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(oe){isNaN(oe)||(this.ctx.miterLimit=oe,this.pdf.setMiterLimit(oe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(oe){this.ctx.textBaseline=oe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(oe){["right","end","center","left","start"].indexOf(oe)!==-1&&(this.ctx.textAlign=oe)}});var te=null;function ne(oe,ee){if(te===null){var Z=function(se){var ie=[];return Object.keys(se).forEach(function(ue){se[ue].forEach(function(pe){var fe=null;switch(pe){case"bold":fe={family:ue,weight:"bold"};break;case"italic":fe={family:ue,style:"italic"};break;case"bolditalic":fe={family:ue,weight:"bold",style:"italic"};break;case"":case"normal":fe={family:ue}}fe!==null&&(fe.ref={name:ue,style:pe},ie.push(fe))})}),ie}(oe.getFontList());te=function(se){for(var ie={},ue=0;ue<se.length;++ue){var pe=fv(se[ue]),fe=pe.family,ye=pe.stretch,Te=pe.style,Pe=pe.weight;ie[fe]=ie[fe]||{},ie[fe][ye]=ie[fe][ye]||{},ie[fe][ye][Te]=ie[fe][ye][Te]||{},ie[fe][ye][Te][Pe]=pe}return ie}(Z.concat(ee))}return te}var le=null;Object.defineProperty(this,"fontFaces",{get:function(){return le},set:function(oe){te=null,le=oe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(oe){var ee;if(this.ctx.font=oe,(ee=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(oe))!==null){var Z=ee[1];ee[2];var se=ee[3],ie=ee[4];ee[5];var ue=ee[6],pe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ie)[2];ie=Math.floor(pe==="px"?parseFloat(ie)*this.pdf.internal.scaleFactor:pe==="em"?parseFloat(ie)*this.pdf.getFontSize():parseFloat(ie)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ie);var fe=function(at){var Ye,rt,ht=[],Ce=at.trim();if(Ce==="")return bg;if(Ce in g3)return[g3[Ce]];for(;Ce!=="";){switch(rt=null,Ye=(Ce=b3(Ce)).charAt(0)){case'"':case"'":rt=nz(Ce.substring(1),Ye);break;default:rt=sz(Ce)}if(rt===null||(ht.push(rt[0]),(Ce=b3(rt[1]))!==""&&Ce.charAt(0)!==","))return bg;Ce=Ce.replace(/^,/,"")}return ht}(ue);if(this.fontFaces){var ye=rz(ne(this.pdf,this.fontFaces),fe.map(function(at){return{family:at,stretch:"normal",weight:se,style:Z}}));this.pdf.setFont(ye.ref.name,ye.ref.style)}else{var Te="";(se==="bold"||parseInt(se,10)>=700||Z==="bold")&&(Te="bold"),Z==="italic"&&(Te+="italic"),Te.length===0&&(Te="normal");for(var Pe="",je={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},qe=0;qe<fe.length;qe++){if(this.pdf.internal.getFont(fe[qe],Te,{noFallback:!0,disableWarning:!0})!==void 0){Pe=fe[qe];break}if(Te==="bolditalic"&&this.pdf.internal.getFont(fe[qe],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Pe=fe[qe],Te="bold";else if(this.pdf.internal.getFont(fe[qe],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Pe=fe[qe],Te="normal";break}}if(Pe===""){for(var We=0;We<fe.length;We++)if(je[fe[We]]){Pe=je[fe[We]];break}}Pe=Pe===""?"Times":Pe,this.pdf.setFont(Pe,Te)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(oe){this.ctx.globalCompositeOperation=oe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(oe){this.ctx.globalAlpha=oe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(oe){this.ctx.lineDashOffset=oe,U.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(oe){this.ctx.lineDash=oe,U.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(oe){this.ctx.ignoreClearRect=!!oe}})};d.prototype.setLineDash=function(A){this.lineDash=A},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){k.call(this,"fill",!1)},d.prototype.stroke=function(){k.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(A,H){if(isNaN(A)||isNaN(H))throw Ir.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var z=this.ctx.transform.applyToPoint(new i(A,H));this.path.push({type:"mt",x:z.x,y:z.y}),this.ctx.lastPoint=new i(A,H)},d.prototype.closePath=function(){var A=new i(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&kr(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){A=new i(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(A.x,A.y)},d.prototype.lineTo=function(A,H){if(isNaN(A)||isNaN(H))throw Ir.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var z=this.ctx.transform.applyToPoint(new i(A,H));this.path.push({type:"lt",x:z.x,y:z.y}),this.ctx.lastPoint=new i(z.x,z.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),k.call(this,null,!0)},d.prototype.quadraticCurveTo=function(A,H,z,K){if(isNaN(z)||isNaN(K)||isNaN(A)||isNaN(H))throw Ir.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var j=this.ctx.transform.applyToPoint(new i(z,K)),J=this.ctx.transform.applyToPoint(new i(A,H));this.path.push({type:"qct",x1:J.x,y1:J.y,x:j.x,y:j.y}),this.ctx.lastPoint=new i(j.x,j.y)},d.prototype.bezierCurveTo=function(A,H,z,K,j,J){if(isNaN(j)||isNaN(J)||isNaN(A)||isNaN(H)||isNaN(z)||isNaN(K))throw Ir.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var P=this.ctx.transform.applyToPoint(new i(j,J)),D=this.ctx.transform.applyToPoint(new i(A,H)),G=this.ctx.transform.applyToPoint(new i(z,K));this.path.push({type:"bct",x1:D.x,y1:D.y,x2:G.x,y2:G.y,x:P.x,y:P.y}),this.ctx.lastPoint=new i(P.x,P.y)},d.prototype.arc=function(A,H,z,K,j,J){if(isNaN(A)||isNaN(H)||isNaN(z)||isNaN(K)||isNaN(j))throw Ir.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(J=!!J,!this.ctx.transform.isIdentity){var P=this.ctx.transform.applyToPoint(new i(A,H));A=P.x,H=P.y;var D=this.ctx.transform.applyToPoint(new i(0,z)),G=this.ctx.transform.applyToPoint(new i(0,0));z=Math.sqrt(Math.pow(D.x-G.x,2)+Math.pow(D.y-G.y,2))}Math.abs(j-K)>=2*Math.PI&&(K=0,j=2*Math.PI),this.path.push({type:"arc",x:A,y:H,radius:z,startAngle:K,endAngle:j,counterclockwise:J})},d.prototype.arcTo=function(A,H,z,K,j){throw new Error("arcTo not implemented.")},d.prototype.rect=function(A,H,z,K){if(isNaN(A)||isNaN(H)||isNaN(z)||isNaN(K))throw Ir.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,H),this.lineTo(A+z,H),this.lineTo(A+z,H+K),this.lineTo(A,H+K),this.lineTo(A,H),this.lineTo(A+z,H),this.lineTo(A,H)},d.prototype.fillRect=function(A,H,z,K){if(isNaN(A)||isNaN(H)||isNaN(z)||isNaN(K))throw Ir.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var j={};this.lineCap!=="butt"&&(j.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(j.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,H,z,K),this.fill(),j.hasOwnProperty("lineCap")&&(this.lineCap=j.lineCap),j.hasOwnProperty("lineJoin")&&(this.lineJoin=j.lineJoin)}},d.prototype.strokeRect=function(A,H,z,K){if(isNaN(A)||isNaN(H)||isNaN(z)||isNaN(K))throw Ir.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(A,H,z,K),this.stroke())},d.prototype.clearRect=function(A,H,z,K){if(isNaN(A)||isNaN(H)||isNaN(z)||isNaN(K))throw Ir.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,H,z,K))},d.prototype.save=function(A){A=typeof A!="boolean"||A;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var K=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=K}},d.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("Q");this.pdf.setPage(H),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(A){var H,z,K,j;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))H=0,z=0,K=0,j=0;else{var J=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(J!==null)H=parseInt(J[1]),z=parseInt(J[2]),K=parseInt(J[3]),j=1;else if((J=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)H=parseInt(J[1]),z=parseInt(J[2]),K=parseInt(J[3]),j=parseFloat(J[4]);else{if(j=1,typeof A=="string"&&A.charAt(0)!=="#"){var P=new gk(A);A=P.ok?P.toHex():"#000000"}A.length===4?(H=A.substring(1,2),H+=H,z=A.substring(2,3),z+=z,K=A.substring(3,4),K+=K):(H=A.substring(1,3),z=A.substring(3,5),K=A.substring(5,7)),H=parseInt(H,16),z=parseInt(z,16),K=parseInt(K,16)}}return{r:H,g:z,b:K,a:j,style:A}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(A,H,z,K){if(isNaN(H)||isNaN(z)||typeof A!="string")throw Ir.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(K=isNaN(K)?void 0:K,!f.call(this)){var j=_(this.ctx.transform.rotation),J=this.ctx.transform.scaleX;I.call(this,{text:A,x:H,y:z,scale:J,angle:j,align:this.textAlign,maxWidth:K})}},d.prototype.strokeText=function(A,H,z,K){if(isNaN(H)||isNaN(z)||typeof A!="string")throw Ir.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){K=isNaN(K)?void 0:K;var j=_(this.ctx.transform.rotation),J=this.ctx.transform.scaleX;I.call(this,{text:A,x:H,y:z,scale:J,renderingMode:"stroke",angle:j,align:this.textAlign,maxWidth:K})}},d.prototype.measureText=function(A){if(typeof A!="string")throw Ir.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,z=this.pdf.internal.scaleFactor,K=H.internal.getFontSize(),j=H.getStringUnitWidth(A)*K/H.internal.scaleFactor,J=function(P){var D=(P=P||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return D}}),this};return new J({width:j*=Math.round(96*z/72*1e4)/1e4})},d.prototype.scale=function(A,H){if(isNaN(A)||isNaN(H))throw Ir.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var z=new l(A,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(z)},d.prototype.rotate=function(A){if(isNaN(A))throw Ir.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new l(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},d.prototype.translate=function(A,H){if(isNaN(A)||isNaN(H))throw Ir.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var z=new l(1,0,0,1,A,H);this.ctx.transform=this.ctx.transform.multiply(z)},d.prototype.transform=function(A,H,z,K,j,J){if(isNaN(A)||isNaN(H)||isNaN(z)||isNaN(K)||isNaN(j)||isNaN(J))throw Ir.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var P=new l(A,H,z,K,j,J);this.ctx.transform=this.ctx.transform.multiply(P)},d.prototype.setTransform=function(A,H,z,K,j,J){A=isNaN(A)?1:A,H=isNaN(H)?0:H,z=isNaN(z)?0:z,K=isNaN(K)?1:K,j=isNaN(j)?0:j,J=isNaN(J)?0:J,this.ctx.transform=new l(A,H,z,K,j,J)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(A,H,z,K,j,J,P,D,G){var re=this.pdf.getImageProperties(A),te=1,ne=1,le=1,oe=1;K!==void 0&&D!==void 0&&(le=D/K,oe=G/j,te=re.width/K*D/K,ne=re.height/j*G/j),J===void 0&&(J=H,P=z,H=0,z=0),K!==void 0&&D===void 0&&(D=K,G=j),K===void 0&&D===void 0&&(D=re.width,G=re.height);for(var ee,Z=this.ctx.transform.decompose(),se=_(Z.rotate.shx),ie=new l,ue=(ie=(ie=(ie=ie.multiply(Z.translate)).multiply(Z.skew)).multiply(Z.scale)).applyToRectangle(new o(J-H*le,P-z*oe,K*te,j*ne)),pe=p.call(this,ue),fe=[],ye=0;ye<pe.length;ye+=1)fe.indexOf(pe[ye])===-1&&fe.push(pe[ye]);if(y(fe),this.autoPaging)for(var Te=fe[0],Pe=fe[fe.length-1],je=Te;je<Pe+1;je++){this.pdf.setPage(je);var qe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],We=je===1?this.posY+this.margin[0]:this.margin[0],at=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ye=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],rt=je===1?0:at+(je-2)*Ye;if(this.ctx.clip_path.length!==0){var ht=this.path;ee=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(ee,this.posX+this.margin[3],-rt+We+this.ctx.prevPageLastElemOffset),N.call(this,"fill",!0),this.path=ht}var Ce=JSON.parse(JSON.stringify(ue));Ce=b([Ce],this.posX+this.margin[3],-rt+We+this.ctx.prevPageLastElemOffset)[0];var Ie=(je>Te||je<Pe)&&m.call(this);Ie&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],qe,Ye,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",Ce.x,Ce.y,Ce.w,Ce.h,null,null,se),Ie&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(A,"JPEG",ue.x,ue.y,ue.w,ue.h,null,null,se)};var p=function(A,H,z){var K=[];H=H||this.pdf.internal.pageSize.width,z=z||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var j=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":K.push(Math.floor((A.y+j)/z)+1);break;case"arc":K.push(Math.floor((A.y+j-A.radius)/z)+1),K.push(Math.floor((A.y+j+A.radius)/z)+1);break;case"qct":var J=S(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);K.push(Math.floor((J.y+j)/z)+1),K.push(Math.floor((J.y+J.h+j)/z)+1);break;case"bct":var P=T(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);K.push(Math.floor((P.y+j)/z)+1),K.push(Math.floor((P.y+P.h+j)/z)+1);break;case"rect":K.push(Math.floor((A.y+j)/z)+1),K.push(Math.floor((A.y+A.h+j)/z)+1)}for(var D=0;D<K.length;D+=1)for(;this.pdf.internal.getNumberOfPages()<K[D];)v.call(this);return K},v=function(){var A=this.fillStyle,H=this.strokeStyle,z=this.font,K=this.lineCap,j=this.lineWidth,J=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=H,this.font=z,this.lineCap=K,this.lineWidth=j,this.lineJoin=J},b=function(A,H,z){for(var K=0;K<A.length;K++)switch(A[K].type){case"bct":A[K].x2+=H,A[K].y2+=z;case"qct":A[K].x1+=H,A[K].y1+=z;case"mt":case"lt":case"arc":default:A[K].x+=H,A[K].y+=z}return A},y=function(A){return A.sort(function(H,z){return H-z})},k=function(A,H){for(var z,K,j=this.fillStyle,J=this.strokeStyle,P=this.lineCap,D=this.lineWidth,G=Math.abs(D*this.ctx.transform.scaleX),re=this.lineJoin,te=JSON.parse(JSON.stringify(this.path)),ne=JSON.parse(JSON.stringify(this.path)),le=[],oe=0;oe<ne.length;oe++)if(ne[oe].x!==void 0)for(var ee=p.call(this,ne[oe]),Z=0;Z<ee.length;Z+=1)le.indexOf(ee[Z])===-1&&le.push(ee[Z]);for(var se=0;se<le.length;se++)for(;this.pdf.internal.getNumberOfPages()<le[se];)v.call(this);if(y(le),this.autoPaging)for(var ie=le[0],ue=le[le.length-1],pe=ie;pe<ue+1;pe++){this.pdf.setPage(pe),this.fillStyle=j,this.strokeStyle=J,this.lineCap=P,this.lineWidth=G,this.lineJoin=re;var fe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ye=pe===1?this.posY+this.margin[0]:this.margin[0],Te=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],je=pe===1?0:Te+(pe-2)*Pe;if(this.ctx.clip_path.length!==0){var qe=this.path;z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(z,this.posX+this.margin[3],-je+ye+this.ctx.prevPageLastElemOffset),N.call(this,A,!0),this.path=qe}if(K=JSON.parse(JSON.stringify(te)),this.path=b(K,this.posX+this.margin[3],-je+ye+this.ctx.prevPageLastElemOffset),H===!1||pe===0){var We=(pe>ie||pe<ue)&&m.call(this);We&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],fe,Pe,null).clip().discardPath()),N.call(this,A,H),We&&this.pdf.restoreGraphicsState()}this.lineWidth=D}else this.lineWidth=G,N.call(this,A,H),this.lineWidth=D;this.path=te},N=function(A,H){if((A!=="stroke"||H||!g.call(this))&&(A==="stroke"||H||!f.call(this))){for(var z,K,j=[],J=this.path,P=0;P<J.length;P++){var D=J[P];switch(D.type){case"begin":j.push({begin:!0});break;case"close":j.push({close:!0});break;case"mt":j.push({start:D,deltas:[],abs:[]});break;case"lt":var G=j.length;if(J[P-1]&&!isNaN(J[P-1].x)&&(z=[D.x-J[P-1].x,D.y-J[P-1].y],G>0)){for(;G>=0;G--)if(j[G-1].close!==!0&&j[G-1].begin!==!0){j[G-1].deltas.push(z),j[G-1].abs.push(D);break}}break;case"bct":z=[D.x1-J[P-1].x,D.y1-J[P-1].y,D.x2-J[P-1].x,D.y2-J[P-1].y,D.x-J[P-1].x,D.y-J[P-1].y],j[j.length-1].deltas.push(z);break;case"qct":var re=J[P-1].x+2/3*(D.x1-J[P-1].x),te=J[P-1].y+2/3*(D.y1-J[P-1].y),ne=D.x+2/3*(D.x1-D.x),le=D.y+2/3*(D.y1-D.y),oe=D.x,ee=D.y;z=[re-J[P-1].x,te-J[P-1].y,ne-J[P-1].x,le-J[P-1].y,oe-J[P-1].x,ee-J[P-1].y],j[j.length-1].deltas.push(z);break;case"arc":j.push({deltas:[],abs:[],arc:!0}),Array.isArray(j[j.length-1].abs)&&j[j.length-1].abs.push(D)}}K=H?null:A==="stroke"?"stroke":"fill";for(var Z=!1,se=0;se<j.length;se++)if(j[se].arc)for(var ie=j[se].abs,ue=0;ue<ie.length;ue++){var pe=ie[ue];pe.type==="arc"?R.call(this,pe.x,pe.y,pe.radius,pe.startAngle,pe.endAngle,pe.counterclockwise,void 0,H,!Z):C.call(this,pe.x,pe.y),Z=!0}else if(j[se].close===!0)this.pdf.internal.out("h"),Z=!1;else if(j[se].begin!==!0){var fe=j[se].start.x,ye=j[se].start.y;O.call(this,j[se].deltas,fe,ye),Z=!0}K&&B.call(this,K),H&&q.call(this)}},L=function(A){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,z=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-z;case"top":return A+H-z;case"hanging":return A+H-2*z;case"middle":return A+H/2-z;case"ideographic":return A;case"alphabetic":default:return A}},F=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function(H,z){this.colorStops.push([H,z])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var R=function(A,H,z,K,j,J,P,D,G){for(var re=x.call(this,z,K,j,J),te=0;te<re.length;te++){var ne=re[te];te===0&&(G?V.call(this,ne.x1+A,ne.y1+H):C.call(this,ne.x1+A,ne.y1+H)),E.call(this,A,H,ne.x2,ne.y2,ne.x3,ne.y3,ne.x4,ne.y4)}D?q.call(this):B.call(this,P)},B=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},q=function(){this.pdf.clip(),this.pdf.discardPath()},V=function(A,H){this.pdf.internal.out(e(A)+" "+n(H)+" m")},I=function(A){var H;switch(A.align){case"right":case"end":H="right";break;case"center":H="center";break;case"left":case"start":default:H="left"}var z=this.pdf.getTextDimensions(A.text),K=L.call(this,A.y),j=F.call(this,K)-z.h,J=this.ctx.transform.applyToPoint(new i(A.x,K)),P=this.ctx.transform.decompose(),D=new l;D=(D=(D=D.multiply(P.translate)).multiply(P.skew)).multiply(P.scale);for(var G,re,te,ne=this.ctx.transform.applyToRectangle(new o(A.x,K,z.w,z.h)),le=D.applyToRectangle(new o(A.x,j,z.w,z.h)),oe=p.call(this,le),ee=[],Z=0;Z<oe.length;Z+=1)ee.indexOf(oe[Z])===-1&&ee.push(oe[Z]);if(y(ee),this.autoPaging)for(var se=ee[0],ie=ee[ee.length-1],ue=se;ue<ie+1;ue++){this.pdf.setPage(ue);var pe=ue===1?this.posY+this.margin[0]:this.margin[0],fe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ye=this.pdf.internal.pageSize.height-this.margin[2],Te=ye-this.margin[0],Pe=this.pdf.internal.pageSize.width-this.margin[1],je=Pe-this.margin[3],qe=ue===1?0:fe+(ue-2)*Te;if(this.ctx.clip_path.length!==0){var We=this.path;G=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(G,this.posX+this.margin[3],-1*qe+pe),N.call(this,"fill",!0),this.path=We}var at=b([JSON.parse(JSON.stringify(le))],this.posX+this.margin[3],-qe+pe+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(re=this.pdf.internal.getFontSize(),this.pdf.setFontSize(re*A.scale),te=this.lineWidth,this.lineWidth=te*A.scale);var Ye=this.autoPaging!=="text";if(Ye||at.y+at.h<=ye){if(Ye||at.y>=pe&&at.x<=Pe){var rt=Ye?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||Pe-at.x)[0],ht=b([JSON.parse(JSON.stringify(ne))],this.posX+this.margin[3],-qe+pe+this.ctx.prevPageLastElemOffset)[0],Ce=Ye&&(ue>se||ue<ie)&&m.call(this);Ce&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],je,Te,null).clip().discardPath()),this.pdf.text(rt,ht.x,ht.y,{angle:A.angle,align:H,renderingMode:A.renderingMode}),Ce&&this.pdf.restoreGraphicsState()}}else at.y<ye&&(this.ctx.prevPageLastElemOffset+=ye-at.y);A.scale>=.01&&(this.pdf.setFontSize(re),this.lineWidth=te)}else A.scale>=.01&&(re=this.pdf.internal.getFontSize(),this.pdf.setFontSize(re*A.scale),te=this.lineWidth,this.lineWidth=te*A.scale),this.pdf.text(A.text,J.x+this.posX,J.y+this.posY,{angle:A.angle,align:H,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(re),this.lineWidth=te)},C=function(A,H,z,K){z=z||0,K=K||0,this.pdf.internal.out(e(A+z)+" "+n(H+K)+" l")},O=function(A,H,z){return this.pdf.lines(A,H,z,null,null)},E=function(A,H,z,K,j,J,P,D){this.pdf.internal.out([r(s(z+A)),r(a(K+H)),r(s(j+A)),r(a(J+H)),r(s(P+A)),r(a(D+H)),"c"].join(" "))},x=function(A,H,z,K){for(var j=2*Math.PI,J=Math.PI/2;H>z;)H-=j;var P=Math.abs(z-H);P<j&&K&&(P=j-P);for(var D=[],G=K?-1:1,re=H;P>1e-5;){var te=re+G*Math.min(P,J);D.push(w.call(this,A,re,te)),P-=Math.abs(te-re),re=te}return D},w=function(A,H,z){var K=(z-H)/2,j=A*Math.cos(K),J=A*Math.sin(K),P=j,D=-J,G=P*P+D*D,re=G+P*j+D*J,te=4/3*(Math.sqrt(2*G*re)-re)/(P*J-D*j),ne=P-te*D,le=D+te*P,oe=ne,ee=-le,Z=K+H,se=Math.cos(Z),ie=Math.sin(Z);return{x1:A*Math.cos(H),y1:A*Math.sin(H),x2:ne*se-le*ie,y2:ne*ie+le*se,x3:oe*se-ee*ie,y3:oe*ie+ee*se,x4:A*Math.cos(z),y4:A*Math.sin(z)}},_=function(A){return 180*A/Math.PI},S=function(A,H,z,K,j,J){var P=A+.5*(z-A),D=H+.5*(K-H),G=j+.5*(z-j),re=J+.5*(K-J),te=Math.min(A,j,P,G),ne=Math.max(A,j,P,G),le=Math.min(H,J,D,re),oe=Math.max(H,J,D,re);return new o(te,le,ne-te,oe-le)},T=function(A,H,z,K,j,J,P,D){var G,re,te,ne,le,oe,ee,Z,se,ie,ue,pe,fe,ye,Te=z-A,Pe=K-H,je=j-z,qe=J-K,We=P-j,at=D-J;for(re=0;re<41;re++)se=(ee=(te=A+(G=re/40)*Te)+G*((le=z+G*je)-te))+G*(le+G*(j+G*We-le)-ee),ie=(Z=(ne=H+G*Pe)+G*((oe=K+G*qe)-ne))+G*(oe+G*(J+G*at-oe)-Z),re==0?(ue=se,pe=ie,fe=se,ye=ie):(ue=Math.min(ue,se),pe=Math.min(pe,ie),fe=Math.max(fe,se),ye=Math.max(ye,ie));return new o(Math.round(ue),Math.round(pe),Math.round(fe-ue),Math.round(ye-pe))},U=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,H,z=(A=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:H}));this.prevLineDash!==z&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=z)}}})(Zt.API),function(t){var r=function(a){var i,o,l,c,u,d,h,f,g,m;for(o=[],l=0,c=(a+=i="\0\0\0\0".slice(a.length%4||4)).length;c>l;l+=4)(u=(a.charCodeAt(l)<<24)+(a.charCodeAt(l+1)<<16)+(a.charCodeAt(l+2)<<8)+a.charCodeAt(l+3))!==0?(d=(u=((u=((u=((u=(u-(m=u%85))/85)-(g=u%85))/85)-(f=u%85))/85)-(h=u%85))/85)%85,o.push(d+33,h+33,f+33,g+33,m+33)):o.push(122);return function(p,v){for(var b=v;b>0;b--)p.pop()}(o,i.length),String.fromCharCode.apply(String,o)+"~>"},e=function(a){var i,o,l,c,u,d=String,h="length",f=255,g="charCodeAt",m="slice",p="replace";for(a[m](-2),a=a[m](0,-2)[p](/\s/g,"")[p]("z","!!!!!"),l=[],c=0,u=(a+=i="uuuuu"[m](a[h]%5||5))[h];u>c;c+=5)o=52200625*(a[g](c)-33)+614125*(a[g](c+1)-33)+7225*(a[g](c+2)-33)+85*(a[g](c+3)-33)+(a[g](c+4)-33),l.push(f&o>>24,f&o>>16,f&o>>8,f&o);return function(v,b){for(var y=b;y>0;y--)v.pop()}(l,i[h]),d.fromCharCode.apply(d,l)},n=function(a){var i=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),i.test(a)===!1)return"";for(var o="",l=0;l<a.length;l+=2)o+=String.fromCharCode("0x"+(a[l]+a[l+1]));return o},s=function(a){for(var i=new Uint8Array(a.length),o=a.length;o--;)i[o]=a.charCodeAt(o);return a=(i=av(i)).reduce(function(l,c){return l+String.fromCharCode(c)},"")};t.processDataByFilters=function(a,i){var o=0,l=a||"",c=[];for(typeof(i=i||[])=="string"&&(i=[i]),o=0;o<i.length;o+=1)switch(i[o]){case"ASCII85Decode":case"/ASCII85Decode":l=e(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=r(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=s(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(Zt.API),function(t){t.loadFile=function(r,e,n){return function(s,a,i){a=a!==!1,i=typeof i=="function"?i:function(){};var o=void 0;try{o=function(l,c,u){var d=new XMLHttpRequest,h=0,f=function(g){var m=g.length,p=[],v=String.fromCharCode;for(h=0;h<m;h+=1)p.push(v(255&g.charCodeAt(h)));return p.join("")};if(d.open("GET",l,!c),d.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(d.onload=function(){d.status===200?u(f(this.responseText)):u(void 0)}),d.send(null),c&&d.status===200)return f(d.responseText)}(s,a,i)}catch{}return o}(r,e,n)},t.loadImageFile=t.loadFile}(Zt.API),function(t){function r(){return(er.html2canvas?Promise.resolve(er.html2canvas):Ma(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load html2canvas: "+i))}).then(function(i){return i.default?i.default:i})}function e(){return(er.DOMPurify?Promise.resolve(er.DOMPurify):Ma(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load dompurify: "+i))}).then(function(i){return i.default?i.default:i})}var n=function(i){var o=kr(i);return o==="undefined"?"undefined":o==="string"||i instanceof String?"string":o==="number"||i instanceof Number?"number":o==="function"||i instanceof Function?"function":i&&i.constructor===Array?"array":i&&i.nodeType===1?"element":o==="object"?"object":"unknown"},s=function(i,o){var l=document.createElement(i);for(var c in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[c]=o.style[c];return l},a=function i(o){var l=Object.assign(i.convert(Promise.resolve()),JSON.parse(JSON.stringify(i.template))),c=i.convert(Promise.resolve(),l);return c=(c=c.setProgress(1,i,1,[i])).set(o)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(i,o){return i.__proto__=o||a.prototype,i},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(i,o){return this.then(function(){switch(o=o||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(i)){case"string":return this.then(e).then(function(l){return this.set({src:s("div",{innerHTML:i,dompurify:l})})});case"element":return this.set({src:i});case"canvas":return this.set({canvas:i});case"img":return this.set({img:i});default:return this.error("Unknown source type.")}})},a.prototype.to=function(i){switch(i){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var i={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),h=c.firstChild;h;h=h.nextSibling)u!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||d.appendChild(l(h,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(i.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:i}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(r).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(r).then(function(o){var l=this.opt.jsPDF,c=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=c,c)for(var h=0;h<c.length;++h){var f=c[h],g=f.src.find(function(m){return m.format==="truetype"});g&&l.addFont(g.url,f.ref.name,f.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,l.context2d.save(!0),o(this.prop.container,d)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var i=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=i})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(i,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(i,o):this.outputPdf(i,o)},a.prototype.outputPdf=function(i,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(i,o)})},a.prototype.outputImg=function(i){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(i){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+i+'" is not supported.'}})},a.prototype.save=function(i){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(i?{filename:i}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(i){if(n(i)!=="object")return this;var o=Object.keys(i||{}).map(function(l){if(l in a.template.prop)return function(){this.prop[l]=i[l]};switch(l){case"margin":return this.setMargin.bind(this,i.margin);case"jsPDF":return function(){return this.opt.jsPDF=i.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,i.pageSize);default:return function(){this.opt[l]=i[l]}}},this);return this.then(function(){return this.thenList(o)})},a.prototype.get=function(i,o){return this.then(function(){var l=i in a.template.prop?this.prop[i]:this.opt[i];return o?o(l):l})},a.prototype.setMargin=function(i){return this.then(function(){switch(n(i)){case"number":i=[i,i,i,i];case"array":if(i.length===2&&(i=[i[0],i[1],i[0],i[1]]),i.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=i}).then(this.setPageSize)},a.prototype.setPageSize=function(i){function o(l,c){return Math.floor(l*c/72*96)}return this.then(function(){(i=i||Zt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(i.inner={width:i.width-this.opt.margin[1]-this.opt.margin[3],height:i.height-this.opt.margin[0]-this.opt.margin[2]},i.inner.px={width:o(i.inner.width,i.k),height:o(i.inner.height,i.k)},i.inner.ratio=i.inner.height/i.inner.width),this.prop.pageSize=i})},a.prototype.setProgress=function(i,o,l,c){return i!=null&&(this.progress.val=i),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(i,o,l,c){return this.setProgress(i?this.progress.val+i:null,o||null,l?this.progress.n+l:null,c?this.progress.stack.concat(c):null)},a.prototype.then=function(i,o){var l=this;return this.thenCore(i,o,function(c,u){return l.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(d){return l.updateProgress(null,c),d}).then(c,u).then(function(d){return l.updateProgress(1),d})})},a.prototype.thenCore=function(i,o,l){l=l||Promise.prototype.then,i&&(i=i.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:a.convert(Object.assign({},this),Promise.prototype),u=l.call(c,i,o);return a.convert(u,this.__proto__)},a.prototype.thenExternal=function(i,o){return Promise.prototype.then.call(this,i,o)},a.prototype.thenList=function(i){var o=this;return i.forEach(function(l){o=o.thenCore(l)}),o},a.prototype.catch=function(i){i&&(i=i.bind(this));var o=Promise.prototype.catch.call(this,i);return a.convert(o,this)},a.prototype.catchExternal=function(i){return Promise.prototype.catch.call(this,i)},a.prototype.error=function(i){return this.then(function(){throw new Error(i)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,Zt.getPageSize=function(i,o,l){if(kr(i)==="object"){var c=i;i=c.orientation,o=c.unit||o,l=c.format||l}o=o||"mm",l=l||"a4",i=(""+(i||"P")).toLowerCase();var u,d=(""+l).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+o}var f,g=0,m=0;if(h.hasOwnProperty(d))g=h[d][1]/u,m=h[d][0]/u;else try{g=l[1],m=l[0]}catch{throw new Error("Invalid format: "+l)}if(i==="p"||i==="portrait")i="p",m>g&&(f=m,m=g,g=f);else{if(i!=="l"&&i!=="landscape")throw"Invalid orientation: "+i;i="l",g>m&&(f=m,m=g,g=f)}return{width:m,height:g,unit:o,k:u,orientation:i}},t.html=function(i,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(fv):null;var l=new a(o);return o.worker?l:l.from(i).doCallback()}}(Zt.API),Zt.API.addJS=function(t){return x3=t,this.internal.events.subscribe("postPutResources",function(){C0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(C0+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),y3=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+x3+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){C0!==void 0&&y3!==void 0&&this.internal.out("/Names <</JavaScript "+C0+" 0 R>>")}),this},function(t){var r;t.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=e.outline.render().split(/\r\n/),a=0;a<s.length;a++){var i=s[a],o=n.exec(i);if(o!=null){var l=o[1];e.internal.newObjectDeferredBegin(l,!1)}e.internal.write(i)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(a=0;a<c;a++){var d=e.internal.newObject();u.push(d);var h=e.internal.getPageInfo(a+1);e.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var f=e.internal.newObject();for(e.internal.write("<< /Names [ "),a=0;a<u.length;a++)e.internal.write("(page_"+(a+1)+")"+u[a]+" 0 R");e.internal.write(" ] >>","endobj"),r=e.internal.newObject(),e.internal.write("<< /Dests "+f+" 0 R"),e.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+r+" 0 R"))}]),t.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(n,s,a){var i={title:s,options:a,children:[]};return n==null&&(n=this.root),n.children.push(i),i},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(n){n.id=e.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},e.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},e.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var i=n.children[a];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var o=this.count=this.count_r({count:0},i);if(o>0&&this.line("/Count "+o),i.options&&i.options.pageNumber){var l=e.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},e.outline.line=function(n){this.ctx.val+=n+`\r
`},e.outline.makeRef=function(n){return n.id+" 0 R"},e.outline.makeString=function(n){return"("+e.internal.pdfEscape(n)+")"},e.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(n,s){for(var a=0;a<s.children.length;a++)n.count++,this.count_r(n,s.children[a]);return n.count}}])}(Zt.API),function(t){var r=[192,193,194,195,196,197,198,199];t.processJPEG=function(e,n,s,a,i,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=i||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(l=function(d){for(var h,f=256*d.charCodeAt(4)+d.charCodeAt(5),g=d.length,m={width:0,height:0,numcomponents:1},p=4;p<g;p+=2){if(p+=f,r.indexOf(d.charCodeAt(p+1))!==-1){h=256*d.charCodeAt(p+5)+d.charCodeAt(p+6),m={width:256*d.charCodeAt(p+7)+d.charCodeAt(p+8),height:h,numcomponents:d.charCodeAt(p+9)};break}f=256*d.charCodeAt(p+2)+d.charCodeAt(p+3)}return m}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:e,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:s}}return u}}(Zt.API);var Wc,T0,w3,_3,S3,az=function(){var t,r,e;function n(a){var i,o,l,c,u,d,h,f,g,m,p,v,b,y;for(this.data=a,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},d=null;;){switch(i=this.readUInt32(),g=(function(){var k,N;for(N=[],k=0;k<4;++k)N.push(String.fromCharCode(this.data[this.pos++]));return N}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(i);break;case"fcTL":d&&this.animation.frames.push(d),this.pos+=4,d={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),c=this.readUInt16()||100,d.delay=1e3*u/c,d.disposeOp=this.data[this.pos++],d.blendOp=this.data[this.pos++],d.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,i-=4),a=(d!=null?d.data:void 0)||this.imgData,v=0;0<=i?v<i:v>i;0<=i?++v:--v)a.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(i),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((m=l-this.transparency.indexed.length)>0)for(b=0;0<=m?b<m:b>m;0<=m?++b:--b)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(i)[0];break;case 2:this.transparency.rgb=this.read(i)}break;case"tEXt":h=(p=this.read(i)).indexOf(0),f=String.fromCharCode.apply(String,p.slice(0,h)),this.text[f]=String.fromCharCode.apply(String,p.slice(h+1));break;case"IEND":return d&&this.animation.frames.push(d),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(y=this.colorType)===4||y===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=i}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(a){var i,o;for(o=[],i=0;0<=a?i<a:i>a;0<=a?++i:--i)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(a){var i=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*i),l=0,c=this;if(a==null&&(a=this.imgData),a.length===0)return new Uint8Array(0);function u(d,h,f,g){var m,p,v,b,y,k,N,L,F,R,B,q,V,I,C,O,E,x,w,_,S,T=Math.ceil((c.width-d)/f),U=Math.ceil((c.height-h)/g),A=c.width==T&&c.height==U;for(I=i*T,q=A?o:new Uint8Array(I*U),k=a.length,V=0,p=0;V<U&&l<k;){switch(a[l++]){case 0:for(b=E=0;E<I;b=E+=1)q[p++]=a[l++];break;case 1:for(b=x=0;x<I;b=x+=1)m=a[l++],y=b<i?0:q[p-i],q[p++]=(m+y)%256;break;case 2:for(b=w=0;w<I;b=w+=1)m=a[l++],v=(b-b%i)/i,C=V&&q[(V-1)*I+v*i+b%i],q[p++]=(C+m)%256;break;case 3:for(b=_=0;_<I;b=_+=1)m=a[l++],v=(b-b%i)/i,y=b<i?0:q[p-i],C=V&&q[(V-1)*I+v*i+b%i],q[p++]=(m+Math.floor((y+C)/2))%256;break;case 4:for(b=S=0;S<I;b=S+=1)m=a[l++],v=(b-b%i)/i,y=b<i?0:q[p-i],V===0?C=O=0:(C=q[(V-1)*I+v*i+b%i],O=v&&q[(V-1)*I+(v-1)*i+b%i]),N=y+C-O,L=Math.abs(N-y),R=Math.abs(N-C),B=Math.abs(N-O),F=L<=R&&L<=B?y:R<=B?C:O,q[p++]=(m+F)%256;break;default:throw new Error("Invalid filter algorithm: "+a[l-1])}if(!A){var H=((h+V*g)*c.width+d)*i,z=V*I;for(b=0;b<T;b+=1){for(var K=0;K<i;K+=1)o[H++]=q[z++];H+=(f-1)*i}}V++}}return a=LH(a),c.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),o},n.prototype.decodePalette=function(){var a,i,o,l,c,u,d,h,f;for(o=this.palette,u=this.transparency.indexed||[],c=new Uint8Array((u.length||0)+o.length),l=0,a=0,i=d=0,h=o.length;d<h;i=d+=3)c[l++]=o[i],c[l++]=o[i+1],c[l++]=o[i+2],c[l++]=(f=u[a++])!=null?f:255;return c},n.prototype.copyToImageData=function(a,i){var o,l,c,u,d,h,f,g,m,p,v;if(l=this.colors,m=null,o=this.hasAlphaChannel,this.palette.length&&(m=(v=this._decodedPalette)!=null?v:this._decodedPalette=this.decodePalette(),l=4,o=!0),g=(c=a.data||a).length,d=m||i,u=h=0,l===1)for(;u<g;)f=m?4*i[u/4]:h,p=d[f++],c[u++]=p,c[u++]=p,c[u++]=p,c[u++]=o?d[f++]:255,h=f;else for(;u<g;)f=m?4*i[u/4]:h,c[u++]=d[f++],c[u++]=d[f++],c[u++]=d[f++],c[u++]=o?d[f++]:255,h=f},n.prototype.decode=function(){var a;return a=new Uint8Array(this.width*this.height*4),this.copyToImageData(a,this.decodePixels()),a};var s=function(){if(Object.prototype.toString.call(er)==="[object Window]"){try{r=er.document.createElement("canvas"),e=r.getContext("2d")}catch{return!1}return!0}return!1};return s(),t=function(a){var i;if(s()===!0)return e.width=a.width,e.height=a.height,e.clearRect(0,0,a.width,a.height),e.putImageData(a,0,0),(i=new Image).src=r.toDataURL(),i;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(a){var i,o,l,c,u,d,h,f;if(this.animation){for(f=[],o=u=0,d=(h=this.animation.frames).length;u<d;o=++u)i=h[o],l=a.createImageData(i.width,i.height),c=this.decodePixels(new Uint8Array(i.data)),this.copyToImageData(l,c),i.imageData=l,f.push(i.image=t(l));return f}},n.prototype.renderFrame=function(a,i){var o,l,c;return o=(l=this.animation.frames)[i],c=l[i-1],i===0&&a.clearRect(0,0,this.width,this.height),(c!=null?c.disposeOp:void 0)===1?a.clearRect(c.xOffset,c.yOffset,c.width,c.height):(c!=null?c.disposeOp:void 0)===2&&a.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&a.clearRect(o.xOffset,o.yOffset,o.width,o.height),a.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(a){var i,o,l,c,u,d,h=this;return o=0,d=this.animation,c=d.numFrames,l=d.frames,u=d.numPlays,(i=function(){var f,g;if(f=o++%c,g=l[f],h.renderFrame(a,f),c>1&&o/c<u)return h.animation._timeout=setTimeout(i,g.delay)})()},n.prototype.stopAnimation=function(){var a;return clearTimeout((a=this.animation)!=null?a._timeout:void 0)},n.prototype.render=function(a){var i,o;return a._png&&a._png.stopAnimation(),a._png=this,a.width=this.width,a.height=this.height,i=a.getContext("2d"),this.animation?(this.decodeFrames(i),this.animate(i)):(o=i.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),i.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function iz(t){var r=0;if(t[r++]!==71||t[r++]!==73||t[r++]!==70||t[r++]!==56||(t[r++]+1&253)!=56||t[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=t[r++]|t[r++]<<8,n=t[r++]|t[r++]<<8,s=t[r++],a=s>>7,i=1<<(7&s)+1;t[r++],t[r++];var o=null,l=null;a&&(o=r,l=i,r+=3*i);var c=!0,u=[],d=0,h=null,f=0,g=null;for(this.width=e,this.height=n;c&&r<t.length;)switch(t[r++]){case 33:switch(t[r++]){case 255:if(t[r]!==11||t[r+1]==78&&t[r+2]==69&&t[r+3]==84&&t[r+4]==83&&t[r+5]==67&&t[r+6]==65&&t[r+7]==80&&t[r+8]==69&&t[r+9]==50&&t[r+10]==46&&t[r+11]==48&&t[r+12]==3&&t[r+13]==1&&t[r+16]==0)r+=14,g=t[r++]|t[r++]<<8,r++;else for(r+=12;;){if(!((V=t[r++])>=0))throw Error("Invalid block size");if(V===0)break;r+=V}break;case 249:if(t[r++]!==4||t[r+4]!==0)throw new Error("Invalid graphics extension block.");var m=t[r++];d=t[r++]|t[r++]<<8,h=t[r++],!(1&m)&&(h=null),f=m>>2&7,r++;break;case 254:for(;;){if(!((V=t[r++])>=0))throw Error("Invalid block size");if(V===0)break;r+=V}break;default:throw new Error("Unknown graphic control label: 0x"+t[r-1].toString(16))}break;case 44:var p=t[r++]|t[r++]<<8,v=t[r++]|t[r++]<<8,b=t[r++]|t[r++]<<8,y=t[r++]|t[r++]<<8,k=t[r++],N=k>>6&1,L=1<<(7&k)+1,F=o,R=l,B=!1;k>>7&&(B=!0,F=r,R=L,r+=3*L);var q=r;for(r++;;){var V;if(!((V=t[r++])>=0))throw Error("Invalid block size");if(V===0)break;r+=V}u.push({x:p,y:v,width:b,height:y,has_local_palette:B,palette_offset:F,palette_size:R,data_offset:q,data_length:r-q,transparent_index:h,interlaced:!!N,delay:d,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+t[r-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return g},this.frameInfo=function(I){if(I<0||I>=u.length)throw new Error("Frame index out of range.");return u[I]},this.decodeAndBlitFrameBGRA=function(I,C){var O=this.frameInfo(I),E=O.width*O.height,x=new Uint8Array(E);k3(t,O.data_offset,x,E);var w=O.palette_offset,_=O.transparent_index;_===null&&(_=256);var S=O.width,T=e-S,U=S,A=4*(O.y*e+O.x),H=4*((O.y+O.height)*e+O.x),z=A,K=4*T;O.interlaced===!0&&(K+=4*e*7);for(var j=8,J=0,P=x.length;J<P;++J){var D=x[J];if(U===0&&(U=S,(z+=K)>=H&&(K=4*T+4*e*(j-1),z=A+(S+T)*(j<<1),j>>=1)),D===_)z+=4;else{var G=t[w+3*D],re=t[w+3*D+1],te=t[w+3*D+2];C[z++]=te,C[z++]=re,C[z++]=G,C[z++]=255}--U}},this.decodeAndBlitFrameRGBA=function(I,C){var O=this.frameInfo(I),E=O.width*O.height,x=new Uint8Array(E);k3(t,O.data_offset,x,E);var w=O.palette_offset,_=O.transparent_index;_===null&&(_=256);var S=O.width,T=e-S,U=S,A=4*(O.y*e+O.x),H=4*((O.y+O.height)*e+O.x),z=A,K=4*T;O.interlaced===!0&&(K+=4*e*7);for(var j=8,J=0,P=x.length;J<P;++J){var D=x[J];if(U===0&&(U=S,(z+=K)>=H&&(K=4*T+4*e*(j-1),z=A+(S+T)*(j<<1),j>>=1)),D===_)z+=4;else{var G=t[w+3*D],re=t[w+3*D+1],te=t[w+3*D+2];C[z++]=G,C[z++]=re,C[z++]=te,C[z++]=255}--U}}}function k3(t,r,e,n){for(var s=t[r++],a=1<<s,i=a+1,o=i+1,l=s+1,c=(1<<l)-1,u=0,d=0,h=0,f=t[r++],g=new Int32Array(4096),m=null;;){for(;u<16&&f!==0;)d|=t[r++]<<u,u+=8,f===1?f=t[r++]:--f;if(u<l)break;var p=d&c;if(d>>=l,u-=l,p!==a){if(p===i)break;for(var v=p<o?p:m,b=0,y=v;y>a;)y=g[y]>>8,++b;var k=y;if(h+b+(v!==p?1:0)>n)return void Ir.log("Warning, gif stream longer than expected.");e[h++]=k;var N=h+=b;for(v!==p&&(e[h++]=k),y=v;b--;)y=g[y],e[--N]=255&y,y>>=8;m!==null&&o<4096&&(g[o++]=m<<8|k,o>=c+1&&l<12&&(++l,c=c<<1|1)),m=p}else o=i+1,c=(1<<(l=s+1))-1,m=null}return h!==n&&Ir.log("Warning, gif stream shorter than expected."),e}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function yg(t){var r,e,n,s,a,i=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(65535),h=new Array(65535),f=new Array(64),g=new Array(64),m=[],p=0,v=7,b=new Array(64),y=new Array(64),k=new Array(64),N=new Array(256),L=new Array(2048),F=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],R=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],V=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],O=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],E=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function x(A,H){for(var z=0,K=0,j=new Array,J=1;J<=16;J++){for(var P=1;P<=A[J];P++)j[H[K]]=[],j[H[K]][0]=z,j[H[K]][1]=J,K++,z++;z*=2}return j}function w(A){for(var H=A[0],z=A[1]-1;z>=0;)H&1<<z&&(p|=1<<v),z--,--v<0&&(p==255?(_(255),_(0)):_(p),v=7,p=0)}function _(A){m.push(A)}function S(A){_(A>>8&255),_(255&A)}function T(A,H,z,K,j){for(var J,P=j[0],D=j[240],G=function(ie,ue){var pe,fe,ye,Te,Pe,je,qe,We,at,Ye,rt=0;for(at=0;at<8;++at){pe=ie[rt],fe=ie[rt+1],ye=ie[rt+2],Te=ie[rt+3],Pe=ie[rt+4],je=ie[rt+5],qe=ie[rt+6];var ht=pe+(We=ie[rt+7]),Ce=pe-We,Ie=fe+qe,Ve=fe-qe,De=ye+je,Oe=ye-je,Xe=Te+Pe,nt=Te-Pe,Je=ht+Xe,wt=ht-Xe,gt=Ie+De,dt=Ie-De;ie[rt]=Je+gt,ie[rt+4]=Je-gt;var ct=.707106781*(dt+wt);ie[rt+2]=wt+ct,ie[rt+6]=wt-ct;var ut=.382683433*((Je=nt+Oe)-(dt=Ve+Ce)),ft=.5411961*Je+ut,Et=1.306562965*dt+ut,jt=.707106781*(gt=Oe+Ve),Ot=Ce+jt,yt=Ce-jt;ie[rt+5]=yt+ft,ie[rt+3]=yt-ft,ie[rt+1]=Ot+Et,ie[rt+7]=Ot-Et,rt+=8}for(rt=0,at=0;at<8;++at){pe=ie[rt],fe=ie[rt+8],ye=ie[rt+16],Te=ie[rt+24],Pe=ie[rt+32],je=ie[rt+40],qe=ie[rt+48];var Vt=pe+(We=ie[rt+56]),$t=pe-We,Fe=fe+qe,Be=fe-qe,tt=ye+je,ce=ye-je,ke=Te+Pe,me=Te-Pe,xe=Vt+ke,_e=Vt-ke,Ee=Fe+tt,Le=Fe-tt;ie[rt]=xe+Ee,ie[rt+32]=xe-Ee;var Ke=.707106781*(Le+_e);ie[rt+16]=_e+Ke,ie[rt+48]=_e-Ke;var Ue=.382683433*((xe=me+ce)-(Le=Be+$t)),Qe=.5411961*xe+Ue,et=1.306562965*Le+Ue,bt=.707106781*(Ee=ce+Be),Ct=$t+bt,Pt=$t-bt;ie[rt+40]=Pt+Qe,ie[rt+24]=Pt-Qe,ie[rt+8]=Ct+et,ie[rt+56]=Ct-et,rt++}for(at=0;at<64;++at)Ye=ie[at]*ue[at],f[at]=Ye>0?Ye+.5|0:Ye-.5|0;return f}(A,H),re=0;re<64;++re)g[F[re]]=G[re];var te=g[0]-z;z=g[0],te==0?w(K[0]):(w(K[h[J=32767+te]]),w(d[J]));for(var ne=63;ne>0&&g[ne]==0;)ne--;if(ne==0)return w(P),z;for(var le,oe=1;oe<=ne;){for(var ee=oe;g[oe]==0&&oe<=ne;)++oe;var Z=oe-ee;if(Z>=16){le=Z>>4;for(var se=1;se<=le;++se)w(D);Z&=15}J=32767+g[oe],w(j[(Z<<4)+h[J]]),w(d[J]),oe++}return ne!=63&&w(P),z}function U(A){A=Math.min(Math.max(A,1),100),a!=A&&(function(H){for(var z=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],K=0;K<64;K++){var j=i((z[K]*H+50)/100);j=Math.min(Math.max(j,1),255),o[F[K]]=j}for(var J=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],P=0;P<64;P++){var D=i((J[P]*H+50)/100);D=Math.min(Math.max(D,1),255),l[F[P]]=D}for(var G=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],re=0,te=0;te<8;te++)for(var ne=0;ne<8;ne++)c[re]=1/(o[F[re]]*G[te]*G[ne]*8),u[re]=1/(l[F[re]]*G[te]*G[ne]*8),re++}(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),a=A)}this.encode=function(A,H){H&&U(H),m=new Array,p=0,v=7,S(65496),S(65504),S(16),_(74),_(70),_(73),_(70),_(0),_(1),_(1),_(0),S(1),S(1),_(0),_(0),function(){S(65499),S(132),_(0);for(var fe=0;fe<64;fe++)_(o[fe]);_(1);for(var ye=0;ye<64;ye++)_(l[ye])}(),function(fe,ye){S(65472),S(17),_(8),S(ye),S(fe),_(3),_(1),_(17),_(0),_(2),_(17),_(1),_(3),_(17),_(1)}(A.width,A.height),function(){S(65476),S(418),_(0);for(var fe=0;fe<16;fe++)_(R[fe+1]);for(var ye=0;ye<=11;ye++)_(B[ye]);_(16);for(var Te=0;Te<16;Te++)_(q[Te+1]);for(var Pe=0;Pe<=161;Pe++)_(V[Pe]);_(1);for(var je=0;je<16;je++)_(I[je+1]);for(var qe=0;qe<=11;qe++)_(C[qe]);_(17);for(var We=0;We<16;We++)_(O[We+1]);for(var at=0;at<=161;at++)_(E[at])}(),S(65498),S(12),_(3),_(1),_(0),_(2),_(17),_(3),_(17),_(0),_(63),_(0);var z=0,K=0,j=0;p=0,v=7,this.encode.displayName="_encode_";for(var J,P,D,G,re,te,ne,le,oe,ee=A.data,Z=A.width,se=A.height,ie=4*Z,ue=0;ue<se;){for(J=0;J<ie;){for(re=ie*ue+J,ne=-1,le=0,oe=0;oe<64;oe++)te=re+(le=oe>>3)*ie+(ne=4*(7&oe)),ue+le>=se&&(te-=ie*(ue+1+le-se)),J+ne>=ie&&(te-=J+ne-ie+4),P=ee[te++],D=ee[te++],G=ee[te++],b[oe]=(L[P]+L[D+256>>0]+L[G+512>>0]>>16)-128,y[oe]=(L[P+768>>0]+L[D+1024>>0]+L[G+1280>>0]>>16)-128,k[oe]=(L[P+1280>>0]+L[D+1536>>0]+L[G+1792>>0]>>16)-128;z=T(b,c,z,r,n),K=T(y,u,K,e,s),j=T(k,u,j,e,s),J+=32}ue+=8}if(v>=0){var pe=[];pe[1]=v+1,pe[0]=(1<<v+1)-1,w(pe)}return S(65497),new Uint8Array(m)},t=t||50,function(){for(var A=String.fromCharCode,H=0;H<256;H++)N[H]=A(H)}(),r=x(R,B),e=x(I,C),n=x(q,V),s=x(O,E),function(){for(var A=1,H=2,z=1;z<=15;z++){for(var K=A;K<H;K++)h[32767+K]=z,d[32767+K]=[],d[32767+K][1]=z,d[32767+K][0]=K;for(var j=-(H-1);j<=-A;j++)h[32767+j]=z,d[32767+j]=[],d[32767+j][1]=z,d[32767+j][0]=H-1+j;A<<=1,H<<=1}}(),function(){for(var A=0;A<256;A++)L[A]=19595*A,L[A+256>>0]=38470*A,L[A+512>>0]=7471*A+32768,L[A+768>>0]=-11059*A,L[A+1024>>0]=-21709*A,L[A+1280>>0]=32768*A+8421375,L[A+1536>>0]=-27439*A,L[A+1792>>0]=-5329*A}(),U(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Xa(t,r){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function E3(t){function r(R){if(!R)throw Error("assert :P")}function e(R,B,q){for(var V=0;4>V;V++)if(R[B+V]!=q.charCodeAt(V))return!0;return!1}function n(R,B,q,V,I){for(var C=0;C<I;C++)R[B+C]=q[V+C]}function s(R,B,q,V){for(var I=0;I<V;I++)R[B+I]=q}function a(R){return new Int32Array(R)}function i(R,B){for(var q=[],V=0;V<R;V++)q.push(new B);return q}function o(R,B){var q=[];return function V(I,C,O){for(var E=O[C],x=0;x<E&&(I.push(O.length>C+1?[]:new B),!(O.length<C+1));x++)V(I[x],C+1,O)}(q,0,R),q}var l=function(){var R=this;function B(M,W){for(var Q=1<<W-1>>>0;M&Q;)Q>>>=1;return Q?(M&Q-1)+Q:M}function q(M,W,Q,ae,he){r(!(ae%Q));do M[W+(ae-=Q)]=he;while(0<ae)}function V(M,W,Q,ae,he){if(r(2328>=he),512>=he)var ge=a(512);else if((ge=a(he))==null)return 0;return function(ve,we,Ae,Ne,He,ot){var lt,Ze,St=we,pt=1<<Ae,ze=a(16),Ge=a(16);for(r(He!=0),r(Ne!=null),r(ve!=null),r(0<Ae),Ze=0;Ze<He;++Ze){if(15<Ne[Ze])return 0;++ze[Ne[Ze]]}if(ze[0]==He)return 0;for(Ge[1]=0,lt=1;15>lt;++lt){if(ze[lt]>1<<lt)return 0;Ge[lt+1]=Ge[lt]+ze[lt]}for(Ze=0;Ze<He;++Ze)lt=Ne[Ze],0<Ne[Ze]&&(ot[Ge[lt]++]=Ze);if(Ge[15]==1)return(Ne=new I).g=0,Ne.value=ot[0],q(ve,St,1,pt,Ne),pt;var xt,At=-1,_t=pt-1,Bt=0,Mt=1,Yt=1,Ft=1<<Ae;for(Ze=0,lt=1,He=2;lt<=Ae;++lt,He<<=1){if(Mt+=Yt<<=1,0>(Yt-=ze[lt]))return 0;for(;0<ze[lt];--ze[lt])(Ne=new I).g=lt,Ne.value=ot[Ze++],q(ve,St+Bt,He,Ft,Ne),Bt=B(Bt,lt)}for(lt=Ae+1,He=2;15>=lt;++lt,He<<=1){if(Mt+=Yt<<=1,0>(Yt-=ze[lt]))return 0;for(;0<ze[lt];--ze[lt]){if(Ne=new I,(Bt&_t)!=At){for(St+=Ft,xt=1<<(At=lt)-Ae;15>At&&!(0>=(xt-=ze[At]));)++At,xt<<=1;pt+=Ft=1<<(xt=At-Ae),ve[we+(At=Bt&_t)].g=xt+Ae,ve[we+At].value=St-we-At}Ne.g=lt-Ae,Ne.value=ot[Ze++],q(ve,St+(Bt>>Ae),He,Ft,Ne),Bt=B(Bt,lt)}}return Mt!=2*Ge[15]-1?0:pt}(M,W,Q,ae,he,ge)}function I(){this.value=this.g=0}function C(){this.value=this.g=0}function O(){this.G=i(5,I),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Gn,C)}function E(M,W,Q,ae){r(M!=null),r(W!=null),r(2147483648>ae),M.Ca=254,M.I=0,M.b=-8,M.Ka=0,M.oa=W,M.pa=Q,M.Jd=W,M.Yc=Q+ae,M.Zc=4<=ae?Q+ae-4+1:Q,J(M)}function x(M,W){for(var Q=0;0<W--;)Q|=D(M,128)<<W;return Q}function w(M,W){var Q=x(M,W);return P(M)?-Q:Q}function _(M,W,Q,ae){var he,ge=0;for(r(M!=null),r(W!=null),r(4294967288>ae),M.Sb=ae,M.Ra=0,M.u=0,M.h=0,4<ae&&(ae=4),he=0;he<ae;++he)ge+=W[Q+he]<<8*he;M.Ra=ge,M.bb=ae,M.oa=W,M.pa=Q}function S(M){for(;8<=M.u&&M.bb<M.Sb;)M.Ra>>>=8,M.Ra+=M.oa[M.pa+M.bb]<<Tc-8>>>0,++M.bb,M.u-=8;z(M)&&(M.h=1,M.u=0)}function T(M,W){if(r(0<=W),!M.h&&W<=Cc){var Q=H(M)&Ac[W];return M.u+=W,S(M),Q}return M.h=1,M.u=0}function U(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function A(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function H(M){return M.Ra>>>(M.u&Tc-1)>>>0}function z(M){return r(M.bb<=M.Sb),M.h||M.bb==M.Sb&&M.u>Tc}function K(M,W){M.u=W,M.h=z(M)}function j(M){M.u>=uf&&(r(M.u>=uf),S(M))}function J(M){r(M!=null&&M.oa!=null),M.pa<M.Zc?(M.I=(M.oa[M.pa++]|M.I<<8)>>>0,M.b+=8):(r(M!=null&&M.oa!=null),M.pa<M.Yc?(M.b+=8,M.I=M.oa[M.pa++]|M.I<<8):M.Ka?M.b=0:(M.I<<=8,M.b+=8,M.Ka=1))}function P(M){return x(M,1)}function D(M,W){var Q=M.Ca;0>M.b&&J(M);var ae=M.b,he=Q*W>>>8,ge=(M.I>>>ae>he)+0;for(ge?(Q-=he,M.I-=he+1<<ae>>>0):Q=he+1,ae=Q,he=0;256<=ae;)he+=8,ae>>=8;return ae=7^he+Ls[ae],M.b-=ae,M.Ca=(Q<<ae)-1,ge}function G(M,W,Q){M[W+0]=Q>>24&255,M[W+1]=Q>>16&255,M[W+2]=Q>>8&255,M[W+3]=Q>>0&255}function re(M,W){return M[W+0]<<0|M[W+1]<<8}function te(M,W){return re(M,W)|M[W+2]<<16}function ne(M,W){return re(M,W)|re(M,W+2)<<16}function le(M,W){var Q=1<<W;return r(M!=null),r(0<W),M.X=a(Q),M.X==null?0:(M.Mb=32-W,M.Xa=W,1)}function oe(M,W){r(M!=null),r(W!=null),r(M.Xa==W.Xa),n(W.X,0,M.X,0,1<<W.Xa)}function ee(){this.X=[],this.Xa=this.Mb=0}function Z(M,W,Q,ae){r(Q!=null),r(ae!=null);var he=Q[0],ge=ae[0];return he==0&&(he=(M*ge+W/2)/W),ge==0&&(ge=(W*he+M/2)/M),0>=he||0>=ge?0:(Q[0]=he,ae[0]=ge,1)}function se(M,W){return M+(1<<W)-1>>>W}function ie(M,W){return((4278255360&M)+(4278255360&W)>>>0&4278255360)+((16711935&M)+(16711935&W)>>>0&16711935)>>>0}function ue(M,W){R[W]=function(Q,ae,he,ge,ve,we,Ae){var Ne;for(Ne=0;Ne<ve;++Ne){var He=R[M](we[Ae+Ne-1],he,ge+Ne);we[Ae+Ne]=ie(Q[ae+Ne],He)}}}function pe(){this.ud=this.hd=this.jd=0}function fe(M,W){return((4278124286&(M^W))>>>1)+(M&W)>>>0}function ye(M){return 0<=M&&256>M?M:0>M?0:255<M?255:void 0}function Te(M,W){return ye(M+(M-W+.5>>1))}function Pe(M,W,Q){return Math.abs(W-Q)-Math.abs(M-Q)}function je(M,W,Q,ae,he,ge,ve){for(ae=ge[ve-1],Q=0;Q<he;++Q)ge[ve+Q]=ae=ie(M[W+Q],ae)}function qe(M,W,Q,ae,he){var ge;for(ge=0;ge<Q;++ge){var ve=M[W+ge],we=ve>>8&255,Ae=16711935&(Ae=(Ae=16711935&ve)+((we<<16)+we));ae[he+ge]=(4278255360&ve)+Ae>>>0}}function We(M,W){W.jd=M>>0&255,W.hd=M>>8&255,W.ud=M>>16&255}function at(M,W,Q,ae,he,ge){var ve;for(ve=0;ve<ae;++ve){var we=W[Q+ve],Ae=we>>>8,Ne=we,He=255&(He=(He=we>>>16)+((M.jd<<24>>24)*(Ae<<24>>24)>>>5));Ne=255&(Ne=(Ne=Ne+((M.hd<<24>>24)*(Ae<<24>>24)>>>5))+((M.ud<<24>>24)*(He<<24>>24)>>>5)),he[ge+ve]=(4278255360&we)+(He<<16)+Ne}}function Ye(M,W,Q,ae,he){R[W]=function(ge,ve,we,Ae,Ne,He,ot,lt,Ze){for(Ae=ot;Ae<lt;++Ae)for(ot=0;ot<Ze;++ot)Ne[He++]=he(we[ae(ge[ve++])])},R[M]=function(ge,ve,we,Ae,Ne,He,ot){var lt=8>>ge.b,Ze=ge.Ea,St=ge.K[0],pt=ge.w;if(8>lt)for(ge=(1<<ge.b)-1,pt=(1<<lt)-1;ve<we;++ve){var ze,Ge=0;for(ze=0;ze<Ze;++ze)ze&ge||(Ge=ae(Ae[Ne++])),He[ot++]=he(St[Ge&pt]),Ge>>=lt}else R["VP8LMapColor"+Q](Ae,Ne,St,pt,He,ot,ve,we,Ze)}}function rt(M,W,Q,ae,he){for(Q=W+Q;W<Q;){var ge=M[W++];ae[he++]=ge>>16&255,ae[he++]=ge>>8&255,ae[he++]=ge>>0&255}}function ht(M,W,Q,ae,he){for(Q=W+Q;W<Q;){var ge=M[W++];ae[he++]=ge>>16&255,ae[he++]=ge>>8&255,ae[he++]=ge>>0&255,ae[he++]=ge>>24&255}}function Ce(M,W,Q,ae,he){for(Q=W+Q;W<Q;){var ge=(ve=M[W++])>>16&240|ve>>12&15,ve=ve>>0&240|ve>>28&15;ae[he++]=ge,ae[he++]=ve}}function Ie(M,W,Q,ae,he){for(Q=W+Q;W<Q;){var ge=(ve=M[W++])>>16&248|ve>>13&7,ve=ve>>5&224|ve>>3&31;ae[he++]=ge,ae[he++]=ve}}function Ve(M,W,Q,ae,he){for(Q=W+Q;W<Q;){var ge=M[W++];ae[he++]=ge>>0&255,ae[he++]=ge>>8&255,ae[he++]=ge>>16&255}}function De(M,W,Q,ae,he,ge){if(ge==0)for(Q=W+Q;W<Q;)G(ae,((ge=M[W++])[0]>>24|ge[1]>>8&65280|ge[2]<<8&16711680|ge[3]<<24)>>>0),he+=32;else n(ae,he,M,W,Q)}function Oe(M,W){R[W][0]=R[M+"0"],R[W][1]=R[M+"1"],R[W][2]=R[M+"2"],R[W][3]=R[M+"3"],R[W][4]=R[M+"4"],R[W][5]=R[M+"5"],R[W][6]=R[M+"6"],R[W][7]=R[M+"7"],R[W][8]=R[M+"8"],R[W][9]=R[M+"9"],R[W][10]=R[M+"10"],R[W][11]=R[M+"11"],R[W][12]=R[M+"12"],R[W][13]=R[M+"13"],R[W][14]=R[M+"0"],R[W][15]=R[M+"0"]}function Xe(M){return M==Jm||M==Zm||M==Cd||M==Qm}function nt(){this.eb=[],this.size=this.A=this.fb=0}function Je(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function wt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new nt,this.f.kb=new Je,this.sd=null}function gt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function dt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ct(M){return alert("todo:WebPSamplerProcessPlane"),M.T}function ut(M,W){var Q=M.T,ae=W.ba.f.RGBA,he=ae.eb,ge=ae.fb+M.ka*ae.A,ve=Ea[W.ba.S],we=M.y,Ae=M.O,Ne=M.f,He=M.N,ot=M.ea,lt=M.W,Ze=W.cc,St=W.dc,pt=W.Mc,ze=W.Nc,Ge=M.ka,xt=M.ka+M.T,At=M.U,_t=At+1>>1;for(Ge==0?ve(we,Ae,null,null,Ne,He,ot,lt,Ne,He,ot,lt,he,ge,null,null,At):(ve(W.ec,W.fc,we,Ae,Ze,St,pt,ze,Ne,He,ot,lt,he,ge-ae.A,he,ge,At),++Q);Ge+2<xt;Ge+=2)Ze=Ne,St=He,pt=ot,ze=lt,He+=M.Rc,lt+=M.Rc,ge+=2*ae.A,ve(we,(Ae+=2*M.fa)-M.fa,we,Ae,Ze,St,pt,ze,Ne,He,ot,lt,he,ge-ae.A,he,ge,At);return Ae+=M.fa,M.j+xt<M.o?(n(W.ec,W.fc,we,Ae,At),n(W.cc,W.dc,Ne,He,_t),n(W.Mc,W.Nc,ot,lt,_t),Q--):1&xt||ve(we,Ae,null,null,Ne,He,ot,lt,Ne,He,ot,lt,he,ge+ae.A,null,null,At),Q}function ft(M,W,Q){var ae=M.F,he=[M.J];if(ae!=null){var ge=M.U,ve=W.ba.S,we=ve==Ad||ve==Cd;W=W.ba.f.RGBA;var Ae=[0],Ne=M.ka;Ae[0]=M.T,M.Kb&&(Ne==0?--Ae[0]:(--Ne,he[0]-=M.width),M.j+M.ka+M.T==M.o&&(Ae[0]=M.o-M.j-Ne));var He=W.eb;Ne=W.fb+Ne*W.A,M=$r(ae,he[0],M.width,ge,Ae,He,Ne+(we?0:3),W.A),r(Q==Ae),M&&Xe(ve)&&Sa(He,Ne,we,ge,Ae,W.A)}return 0}function Et(M){var W=M.ma,Q=W.ba.S,ae=11>Q,he=Q==kd||Q==Ed||Q==Ad||Q==Ym||Q==12||Xe(Q);if(W.memory=null,W.Ib=null,W.Jb=null,W.Nd=null,!lf(W.Oa,M,he?11:12))return 0;if(he&&Xe(Q)&&Tt(),M.da)alert("todo:use_scaling");else{if(ae){if(W.Ib=ct,M.Kb){if(Q=M.U+1>>1,W.memory=a(M.U+2*Q),W.memory==null)return 0;W.ec=W.memory,W.fc=0,W.cc=W.ec,W.dc=W.fc+M.U,W.Mc=W.cc,W.Nc=W.dc+Q,W.Ib=ut,Tt()}}else alert("todo:EmitYUV");he&&(W.Jb=ft,ae&&st())}if(ae&&!Ey){for(M=0;256>M;++M)s7[M]=89858*(M-128)+Nd>>Td,o7[M]=-22014*(M-128)+Nd,i7[M]=-45773*(M-128),a7[M]=113618*(M-128)+Nd>>Td;for(M=vf;M<r1;++M)W=76283*(M-16)+Nd>>Td,l7[M-vf]=ta(W,255),c7[M-vf]=ta(W+8>>4,15);Ey=1}return 1}function jt(M){var W=M.ma,Q=M.U,ae=M.T;return r(!(1&M.ka)),0>=Q||0>=ae?0:(Q=W.Ib(M,W),W.Jb!=null&&W.Jb(M,W,Q),W.Dc+=Q,1)}function Ot(M){M.ma.memory=null}function yt(M,W,Q,ae){return T(M,8)!=47?0:(W[0]=T(M,14)+1,Q[0]=T(M,14)+1,ae[0]=T(M,1),T(M,3)!=0?0:!M.h)}function Vt(M,W){if(4>M)return M+1;var Q=M-2>>1;return(2+(1&M)<<Q)+T(W,Q)+1}function $t(M,W){return 120<W?W-120:1<=(Q=((Q=Vk[W-1])>>4)*M+(8-(15&Q)))?Q:1;var Q}function Fe(M,W,Q){var ae=H(Q),he=M[W+=255&ae].g-8;return 0<he&&(K(Q,Q.u+8),ae=H(Q),W+=M[W].value,W+=ae&(1<<he)-1),K(Q,Q.u+M[W].g),M[W].value}function Be(M,W,Q){return Q.g+=M.g,Q.value+=M.value<<W>>>0,r(8>=Q.g),M.g}function tt(M,W,Q){var ae=M.xc;return r((W=ae==0?0:M.vc[M.md*(Q>>ae)+(W>>ae)])<M.Wb),M.Ya[W]}function ce(M,W,Q,ae){var he=M.ab,ge=M.c*W,ve=M.C;W=ve+W;var we=Q,Ae=ae;for(ae=M.Ta,Q=M.Ua;0<he--;){var Ne=M.gc[he],He=ve,ot=W,lt=we,Ze=Ae,St=(Ae=ae,we=Q,Ne.Ea);switch(r(He<ot),r(ot<=Ne.nc),Ne.hc){case 2:vd(lt,Ze,(ot-He)*St,Ae,we);break;case 0:var pt=He,ze=ot,Ge=Ae,xt=we,At=(Ft=Ne).Ea;pt==0&&(Xm(lt,Ze,null,null,1,Ge,xt),je(lt,Ze+1,0,0,At-1,Ge,xt+1),Ze+=At,xt+=At,++pt);for(var _t=1<<Ft.b,Bt=_t-1,Mt=se(At,Ft.b),Yt=Ft.K,Ft=Ft.w+(pt>>Ft.b)*Mt;pt<ze;){var Tr=Yt,Rr=Ft,Er=1;for(ff(lt,Ze,Ge,xt-At,1,Ge,xt);Er<At;){var vr=(Er&~Bt)+_t;vr>At&&(vr=At),(0,Eo[Tr[Rr++]>>8&15])(lt,Ze+ +Er,Ge,xt+Er-At,vr-Er,Ge,xt+Er),Er=vr}Ze+=At,xt+=At,++pt&Bt||(Ft+=Mt)}ot!=Ne.nc&&n(Ae,we-St,Ae,we+(ot-He-1)*St,St);break;case 1:for(St=lt,ze=Ze,At=(lt=Ne.Ea)-(xt=lt&~(Ge=(Ze=1<<Ne.b)-1)),pt=se(lt,Ne.b),_t=Ne.K,Ne=Ne.w+(He>>Ne.b)*pt;He<ot;){for(Bt=_t,Mt=Ne,Yt=new pe,Ft=ze+xt,Tr=ze+lt;ze<Ft;)We(Bt[Mt++],Yt),Dl(Yt,St,ze,Ze,Ae,we),ze+=Ze,we+=Ze;ze<Tr&&(We(Bt[Mt++],Yt),Dl(Yt,St,ze,At,Ae,we),ze+=At,we+=At),++He&Ge||(Ne+=pt)}break;case 3:if(lt==Ae&&Ze==we&&0<Ne.b){for(ze=Ae,lt=St=we+(ot-He)*St-(xt=(ot-He)*se(Ne.Ea,Ne.b)),Ze=Ae,Ge=we,pt=[],xt=(At=xt)-1;0<=xt;--xt)pt[xt]=Ze[Ge+xt];for(xt=At-1;0<=xt;--xt)ze[lt+xt]=pt[xt];xa(Ne,He,ot,Ae,St,Ae,we)}else xa(Ne,He,ot,lt,Ze,Ae,we)}we=ae,Ae=Q}Ae!=Q&&n(ae,Q,we,Ae,ge)}function ke(M,W){var Q=M.V,ae=M.Ba+M.c*M.C,he=W-M.C;if(r(W<=M.l.o),r(16>=he),0<he){var ge=M.l,ve=M.Ta,we=M.Ua,Ae=ge.width;if(ce(M,he,Q,ae),he=we=[we],r((Q=M.C)<(ae=W)),r(ge.v<ge.va),ae>ge.o&&(ae=ge.o),Q<ge.j){var Ne=ge.j-Q;Q=ge.j,he[0]+=Ne*Ae}if(Q>=ae?Q=0:(he[0]+=4*ge.v,ge.ka=Q-ge.j,ge.U=ge.va-ge.v,ge.T=ae-Q,Q=1),Q){if(we=we[0],11>(Q=M.ca).S){var He=Q.f.RGBA,ot=(ae=Q.S,he=ge.U,ge=ge.T,Ne=He.eb,He.A),lt=ge;for(He=He.fb+M.Ma*He.A;0<lt--;){var Ze=ve,St=we,pt=he,ze=Ne,Ge=He;switch(ae){case Sd:Is(Ze,St,pt,ze,Ge);break;case kd:Es(Ze,St,pt,ze,Ge);break;case Jm:Es(Ze,St,pt,ze,Ge),Sa(ze,Ge,0,pt,1,0);break;case gy:$i(Ze,St,pt,ze,Ge);break;case Ed:De(Ze,St,pt,ze,Ge,1);break;case Zm:De(Ze,St,pt,ze,Ge,1),Sa(ze,Ge,0,pt,1,0);break;case Ad:De(Ze,St,pt,ze,Ge,0);break;case Cd:De(Ze,St,pt,ze,Ge,0),Sa(ze,Ge,1,pt,1,0);break;case Ym:Ao(Ze,St,pt,ze,Ge);break;case Qm:Ao(Ze,St,pt,ze,Ge),Br(ze,Ge,pt,1,0);break;case vy:Bi(Ze,St,pt,ze,Ge);break;default:r(0)}we+=Ae,He+=ot}M.Ma+=ge}else alert("todo:EmitRescaledRowsYUVA");r(M.Ma<=Q.height)}}M.C=W,r(M.C<=M.i)}function me(M){var W;if(0<M.ua)return 0;for(W=0;W<M.Wb;++W){var Q=M.Ya[W].G,ae=M.Ya[W].H;if(0<Q[1][ae[1]+0].g||0<Q[2][ae[2]+0].g||0<Q[3][ae[3]+0].g)return 0}return 1}function xe(M,W,Q,ae,he,ge){if(M.Z!=0){var ve=M.qd,we=M.rd;for(r(Do[M.Z]!=null);W<Q;++W)Do[M.Z](ve,we,ae,he,ae,he,ge),ve=ae,we=he,he+=ge;M.qd=ve,M.rd=we}}function _e(M,W){var Q=M.l.ma,ae=Q.Z==0||Q.Z==1?M.l.j:M.C;if(ae=M.C<ae?ae:M.C,r(W<=M.l.o),W>ae){var he=M.l.width,ge=Q.ca,ve=Q.tb+he*ae,we=M.V,Ae=M.Ba+M.c*ae,Ne=M.gc;r(M.ab==1),r(Ne[0].hc==3),bd(Ne[0],ae,W,we,Ae,ge,ve),xe(Q,ae,W,ge,ve,he)}M.C=M.Ma=W}function Ee(M,W,Q,ae,he,ge,ve){var we=M.$/ae,Ae=M.$%ae,Ne=M.m,He=M.s,ot=Q+M.$,lt=ot;he=Q+ae*he;var Ze=Q+ae*ge,St=280+He.ua,pt=M.Pb?we:16777216,ze=0<He.ua?He.Wa:null,Ge=He.wc,xt=ot<Ze?tt(He,Ae,we):null;r(M.C<ge),r(Ze<=he);var At=!1;e:for(;;){for(;At||ot<Ze;){var _t=0;if(we>=pt){var Bt=ot-Q;r((pt=M).Pb),pt.wd=pt.m,pt.xd=Bt,0<pt.s.ua&&oe(pt.s.Wa,pt.s.vb),pt=we+Wk}if(Ae&Ge||(xt=tt(He,Ae,we)),r(xt!=null),xt.Qb&&(W[ot]=xt.qb,At=!0),!At)if(j(Ne),xt.jc){_t=Ne,Bt=W;var Mt=ot,Yt=xt.pd[H(_t)&Gn-1];r(xt.jc),256>Yt.g?(K(_t,_t.u+Yt.g),Bt[Mt]=Yt.value,_t=0):(K(_t,_t.u+Yt.g-256),r(256<=Yt.value),_t=Yt.value),_t==0&&(At=!0)}else _t=Fe(xt.G[0],xt.H[0],Ne);if(Ne.h)break;if(At||256>_t){if(!At)if(xt.nd)W[ot]=(xt.qb|_t<<8)>>>0;else{if(j(Ne),At=Fe(xt.G[1],xt.H[1],Ne),j(Ne),Bt=Fe(xt.G[2],xt.H[2],Ne),Mt=Fe(xt.G[3],xt.H[3],Ne),Ne.h)break;W[ot]=(Mt<<24|At<<16|_t<<8|Bt)>>>0}if(At=!1,++ot,++Ae>=ae&&(Ae=0,++we,ve!=null&&we<=ge&&!(we%16)&&ve(M,we),ze!=null))for(;lt<ot;)_t=W[lt++],ze.X[(506832829*_t&4294967295)>>>ze.Mb]=_t}else if(280>_t){if(_t=Vt(_t-256,Ne),Bt=Fe(xt.G[4],xt.H[4],Ne),j(Ne),Bt=$t(ae,Bt=Vt(Bt,Ne)),Ne.h)break;if(ot-Q<Bt||he-ot<_t)break e;for(Mt=0;Mt<_t;++Mt)W[ot+Mt]=W[ot+Mt-Bt];for(ot+=_t,Ae+=_t;Ae>=ae;)Ae-=ae,++we,ve!=null&&we<=ge&&!(we%16)&&ve(M,we);if(r(ot<=he),Ae&Ge&&(xt=tt(He,Ae,we)),ze!=null)for(;lt<ot;)_t=W[lt++],ze.X[(506832829*_t&4294967295)>>>ze.Mb]=_t}else{if(!(_t<St))break e;for(At=_t-280,r(ze!=null);lt<ot;)_t=W[lt++],ze.X[(506832829*_t&4294967295)>>>ze.Mb]=_t;_t=ot,r(!(At>>>(Bt=ze).Xa)),W[_t]=Bt.X[At],At=!0}At||r(Ne.h==z(Ne))}if(M.Pb&&Ne.h&&ot<he)r(M.m.h),M.a=5,M.m=M.wd,M.$=M.xd,0<M.s.ua&&oe(M.s.vb,M.s.Wa);else{if(Ne.h)break e;ve!=null&&ve(M,we>ge?ge:we),M.a=0,M.$=ot-Q}return 1}return M.a=3,0}function Le(M){r(M!=null),M.vc=null,M.yc=null,M.Ya=null;var W=M.Wa;W!=null&&(W.X=null),M.vb=null,r(M!=null)}function Ke(){var M=new Gm;return M==null?null:(M.a=0,M.xb=xy,Oe("Predictor","VP8LPredictors"),Oe("Predictor","VP8LPredictors_C"),Oe("PredictorAdd","VP8LPredictorsAdd"),Oe("PredictorAdd","VP8LPredictorsAdd_C"),vd=qe,Dl=at,Is=rt,Es=ht,Ao=Ce,Bi=Ie,$i=Ve,R.VP8LMapColor32b=Nc,R.VP8LMapColor8b=yd,M)}function Ue(M,W,Q,ae,he){var ge=1,ve=[M],we=[W],Ae=ae.m,Ne=ae.s,He=null,ot=0;e:for(;;){if(Q)for(;ge&&T(Ae,1);){var lt=ve,Ze=we,St=ae,pt=1,ze=St.m,Ge=St.gc[St.ab],xt=T(ze,2);if(St.Oc&1<<xt)ge=0;else{switch(St.Oc|=1<<xt,Ge.hc=xt,Ge.Ea=lt[0],Ge.nc=Ze[0],Ge.K=[null],++St.ab,r(4>=St.ab),xt){case 0:case 1:Ge.b=T(ze,3)+2,pt=Ue(se(Ge.Ea,Ge.b),se(Ge.nc,Ge.b),0,St,Ge.K),Ge.K=Ge.K[0];break;case 3:var At,_t=T(ze,8)+1,Bt=16<_t?0:4<_t?1:2<_t?2:3;if(lt[0]=se(Ge.Ea,Bt),Ge.b=Bt,At=pt=Ue(_t,1,0,St,Ge.K)){var Mt,Yt=_t,Ft=Ge,Tr=1<<(8>>Ft.b),Rr=a(Tr);if(Rr==null)At=0;else{var Er=Ft.K[0],vr=Ft.w;for(Rr[0]=Ft.K[0][0],Mt=1;Mt<1*Yt;++Mt)Rr[Mt]=ie(Er[vr+Mt],Rr[Mt-1]);for(;Mt<4*Tr;++Mt)Rr[Mt]=0;Ft.K[0]=null,Ft.K[0]=Rr,At=1}}pt=At;break;case 2:break;default:r(0)}ge=pt}}if(ve=ve[0],we=we[0],ge&&T(Ae,1)&&!(ge=1<=(ot=T(Ae,4))&&11>=ot)){ae.a=3;break e}var Lr;if(Lr=ge)t:{var jr,fr,wn,Bs=ae,_n=ve,$s=we,Pr=ot,na=Q,sa=Bs.m,Ln=Bs.s,Xn=[null],Cs=1,Aa=0,pi=qk[Pr];r:for(;;){if(na&&T(sa,1)){var In=T(sa,3)+2,Vi=se(_n,In),Fl=se($s,In),Mc=Vi*Fl;if(!Ue(Vi,Fl,0,Bs,Xn))break r;for(Xn=Xn[0],Ln.xc=In,jr=0;jr<Mc;++jr){var Ro=Xn[jr]>>8&65535;Xn[jr]=Ro,Ro>=Cs&&(Cs=Ro+1)}}if(sa.h)break r;for(fr=0;5>fr;++fr){var rn=by[fr];!fr&&0<Pr&&(rn+=1<<Pr),Aa<rn&&(Aa=rn)}var n1=i(Cs*pi,I),Ty=Cs,Ny=i(Ty,O);if(Ny==null)var Rd=null;else r(65536>=Ty),Rd=Ny;var bf=a(Aa);if(Rd==null||bf==null||n1==null){Bs.a=1;break r}var Pd=n1;for(jr=wn=0;jr<Cs;++jr){var za=Rd[jr],Fc=za.G,jc=za.H,Dy=0,Od=1,Ry=0;for(fr=0;5>fr;++fr){rn=by[fr],Fc[fr]=Pd,jc[fr]=wn,!fr&&0<Pr&&(rn+=1<<Pr);s:{var Md,s1=rn,Fd=Bs,yf=bf,h7=Pd,d7=wn,a1=0,Po=Fd.m,p7=T(Po,1);if(s(yf,0,0,s1),p7){var m7=T(Po,1)+1,g7=T(Po,1),Py=T(Po,g7==0?1:8);yf[Py]=1,m7==2&&(yf[Py=T(Po,8)]=1);var jd=1}else{var Oy=a(19),My=T(Po,4)+4;if(19<My){Fd.a=3;var Ld=0;break s}for(Md=0;Md<My;++Md)Oy[zk[Md]]=T(Po,3);var i1=void 0,xf=void 0,Fy=Fd,v7=Oy,Id=s1,jy=yf,o1=0,Oo=Fy.m,Ly=8,Iy=i(128,I);n:for(;V(Iy,0,7,v7,19);){if(T(Oo,1)){var b7=2+2*T(Oo,3);if((i1=2+T(Oo,b7))>Id)break n}else i1=Id;for(xf=0;xf<Id&&i1--;){j(Oo);var By=Iy[0+(127&H(Oo))];K(Oo,Oo.u+By.g);var Lc=By.value;if(16>Lc)jy[xf++]=Lc,Lc!=0&&(Ly=Lc);else{var y7=Lc==16,$y=Lc-16,x7=Uk[$y],Uy=T(Oo,$k[$y])+x7;if(xf+Uy>Id)break n;for(var w7=y7?Ly:0;0<Uy--;)jy[xf++]=w7}}o1=1;break n}o1||(Fy.a=3),jd=o1}(jd=jd&&!Po.h)&&(a1=V(h7,d7,8,yf,s1)),jd&&a1!=0?Ld=a1:(Fd.a=3,Ld=0)}if(Ld==0)break r;if(Od&&Hk[fr]==1&&(Od=Pd[wn].g==0),Dy+=Pd[wn].g,wn+=Ld,3>=fr){var wf,l1=bf[0];for(wf=1;wf<rn;++wf)bf[wf]>l1&&(l1=bf[wf]);Ry+=l1}}if(za.nd=Od,za.Qb=0,Od&&(za.qb=(Fc[3][jc[3]+0].value<<24|Fc[1][jc[1]+0].value<<16|Fc[2][jc[2]+0].value)>>>0,Dy==0&&256>Fc[0][jc[0]+0].value&&(za.Qb=1,za.qb+=Fc[0][jc[0]+0].value<<8)),za.jc=!za.Qb&&6>Ry,za.jc){var Bd,qi=za;for(Bd=0;Bd<Gn;++Bd){var Mo=Bd,Fo=qi.pd[Mo],$d=qi.G[0][qi.H[0]+Mo];256<=$d.value?(Fo.g=$d.g+256,Fo.value=$d.value):(Fo.g=0,Fo.value=0,Mo>>=Be($d,8,Fo),Mo>>=Be(qi.G[1][qi.H[1]+Mo],16,Fo),Mo>>=Be(qi.G[2][qi.H[2]+Mo],0,Fo),Be(qi.G[3][qi.H[3]+Mo],24,Fo))}}}Ln.vc=Xn,Ln.Wb=Cs,Ln.Ya=Rd,Ln.yc=n1,Lr=1;break t}Lr=0}if(!(ge=Lr)){ae.a=3;break e}if(0<ot){if(Ne.ua=1<<ot,!le(Ne.Wa,ot)){ae.a=1,ge=0;break e}}else Ne.ua=0;var c1=ae,Hy=ve,_7=we,u1=c1.s,f1=u1.xc;if(c1.c=Hy,c1.i=_7,u1.md=se(Hy,f1),u1.wc=f1==0?-1:(1<<f1)-1,Q){ae.xb=Qk;break e}if((He=a(ve*we))==null){ae.a=1,ge=0;break e}ge=(ge=Ee(ae,He,0,ve,we,we,null))&&!Ae.h;break e}return ge?(he!=null?he[0]=He:(r(He==null),r(Q)),ae.$=0,Q||Le(Ne)):Le(Ne),ge}function Qe(M,W){var Q=M.c*M.i,ae=Q+W+16*W;return r(M.c<=W),M.V=a(ae),M.V==null?(M.Ta=null,M.Ua=0,M.a=1,0):(M.Ta=M.V,M.Ua=M.Ba+Q+W,1)}function et(M,W){var Q=M.C,ae=W-Q,he=M.V,ge=M.Ba+M.c*Q;for(r(W<=M.l.o);0<ae;){var ve=16<ae?16:ae,we=M.l.ma,Ae=M.l.width,Ne=Ae*ve,He=we.ca,ot=we.tb+Ae*Q,lt=M.Ta,Ze=M.Ua;ce(M,ve,he,ge),hn(lt,Ze,He,ot,Ne),xe(we,Q,Q+ve,He,ot,Ae),ae-=ve,he+=ve*M.c,Q+=ve}r(Q==W),M.C=M.Ma=W}function bt(){this.ub=this.yd=this.td=this.Rb=0}function Ct(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Pt(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function be(){this.Yb=function(){var M=[];return function W(Q,ae,he){for(var ge=he[ae],ve=0;ve<ge&&(Q.push(he.length>ae+1?[]:0),!(he.length<ae+1));ve++)W(Q[ve],ae+1,he)}(M,0,[3,11]),M}()}function Me(){this.jb=a(3),this.Wc=o([4,8],be),this.Xc=o([4,17],be)}function it(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function mt(){this.ld=this.La=this.dd=this.tc=0}function Rt(){this.Na=this.la=0}function kt(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Nt(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function sr(){this.uc=this.M=this.Nb=0,this.wa=Array(new mt),this.Y=0,this.ya=Array(new Nt),this.aa=0,this.l=new Ht}function Gt(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Xt(){this.cb=this.a=0,this.sc="",this.m=new U,this.Od=new bt,this.Kc=new Ct,this.ed=new it,this.Qa=new Pt,this.Ic=this.$c=this.Aa=0,this.D=new sr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,U),this.ia=0,this.pb=i(4,kt),this.Pa=new Me,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Gt),this.Hd=0,this.rb=Array(new Rt),this.sb=0,this.wa=Array(new mt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Nt),this.L=this.aa=0,this.gd=o([4,2],mt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ht(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ar(){var M=new Xt;return M!=null&&(M.a=0,M.sc="OK",M.cb=0,M.Xb=0,gf||(gf=Yr)),M}function Kt(M,W,Q){return M.a==0&&(M.a=W,M.sc=Q,M.cb=0),0}function xr(M,W,Q){return 3<=Q&&M[W+0]==157&&M[W+1]==1&&M[W+2]==42}function Fr(M,W){if(M==null)return 0;if(M.a=0,M.sc="OK",W==null)return Kt(M,2,"null VP8Io passed to VP8GetHeaders()");var Q=W.data,ae=W.w,he=W.ha;if(4>he)return Kt(M,7,"Truncated header.");var ge=Q[ae+0]|Q[ae+1]<<8|Q[ae+2]<<16,ve=M.Od;if(ve.Rb=!(1&ge),ve.td=ge>>1&7,ve.yd=ge>>4&1,ve.ub=ge>>5,3<ve.td)return Kt(M,3,"Incorrect keyframe parameters.");if(!ve.yd)return Kt(M,4,"Frame not displayable.");ae+=3,he-=3;var we=M.Kc;if(ve.Rb){if(7>he)return Kt(M,7,"cannot parse picture header");if(!xr(Q,ae,he))return Kt(M,3,"Bad code word");we.c=16383&(Q[ae+4]<<8|Q[ae+3]),we.Td=Q[ae+4]>>6,we.i=16383&(Q[ae+6]<<8|Q[ae+5]),we.Ud=Q[ae+6]>>6,ae+=7,he-=7,M.za=we.c+15>>4,M.Ub=we.i+15>>4,W.width=we.c,W.height=we.i,W.Da=0,W.j=0,W.v=0,W.va=W.width,W.o=W.height,W.da=0,W.ib=W.width,W.hb=W.height,W.U=W.width,W.T=W.height,s((ge=M.Pa).jb,0,255,ge.jb.length),r((ge=M.Qa)!=null),ge.Cb=0,ge.Bb=0,ge.Fb=1,s(ge.Zb,0,0,ge.Zb.length),s(ge.Lb,0,0,ge.Lb)}if(ve.ub>he)return Kt(M,7,"bad partition length");E(ge=M.m,Q,ae,ve.ub),ae+=ve.ub,he-=ve.ub,ve.Rb&&(we.Ld=P(ge),we.Kd=P(ge)),we=M.Qa;var Ae,Ne=M.Pa;if(r(ge!=null),r(we!=null),we.Cb=P(ge),we.Cb){if(we.Bb=P(ge),P(ge)){for(we.Fb=P(ge),Ae=0;4>Ae;++Ae)we.Zb[Ae]=P(ge)?w(ge,7):0;for(Ae=0;4>Ae;++Ae)we.Lb[Ae]=P(ge)?w(ge,6):0}if(we.Bb)for(Ae=0;3>Ae;++Ae)Ne.jb[Ae]=P(ge)?x(ge,8):255}else we.Bb=0;if(ge.Ka)return Kt(M,3,"cannot parse segment header");if((we=M.ed).zd=P(ge),we.Tb=x(ge,6),we.wb=x(ge,3),we.Pc=P(ge),we.Pc&&P(ge)){for(Ne=0;4>Ne;++Ne)P(ge)&&(we.vd[Ne]=w(ge,6));for(Ne=0;4>Ne;++Ne)P(ge)&&(we.od[Ne]=w(ge,6))}if(M.L=we.Tb==0?0:we.zd?1:2,ge.Ka)return Kt(M,3,"cannot parse filter header");var He=he;if(he=Ae=ae,ae=Ae+He,we=He,M.Xb=(1<<x(M.m,2))-1,He<3*(Ne=M.Xb))Q=7;else{for(Ae+=3*Ne,we-=3*Ne,He=0;He<Ne;++He){var ot=Q[he+0]|Q[he+1]<<8|Q[he+2]<<16;ot>we&&(ot=we),E(M.Jc[+He],Q,Ae,ot),Ae+=ot,we-=ot,he+=3}E(M.Jc[+Ne],Q,Ae,we),Q=Ae<ae?0:5}if(Q!=0)return Kt(M,Q,"cannot parse partitions");for(Q=x(Ae=M.m,7),he=P(Ae)?w(Ae,4):0,ae=P(Ae)?w(Ae,4):0,we=P(Ae)?w(Ae,4):0,Ne=P(Ae)?w(Ae,4):0,Ae=P(Ae)?w(Ae,4):0,He=M.Qa,ot=0;4>ot;++ot){if(He.Cb){var lt=He.Zb[ot];He.Fb||(lt+=Q)}else{if(0<ot){M.pb[ot]=M.pb[0];continue}lt=Q}var Ze=M.pb[ot];Ze.Sc[0]=e1[ta(lt+he,127)],Ze.Sc[1]=t1[ta(lt+0,127)],Ze.Eb[0]=2*e1[ta(lt+ae,127)],Ze.Eb[1]=101581*t1[ta(lt+we,127)]>>16,8>Ze.Eb[1]&&(Ze.Eb[1]=8),Ze.Qc[0]=e1[ta(lt+Ne,117)],Ze.Qc[1]=t1[ta(lt+Ae,127)],Ze.lc=lt+Ae}if(!ve.Rb)return Kt(M,4,"Not a key frame.");for(P(ge),ve=M.Pa,Q=0;4>Q;++Q){for(he=0;8>he;++he)for(ae=0;3>ae;++ae)for(we=0;11>we;++we)Ne=D(ge,Jk[Q][he][ae][we])?x(ge,8):Kk[Q][he][ae][we],ve.Wc[Q][he].Yb[ae][we]=Ne;for(he=0;17>he;++he)ve.Xc[Q][he]=ve.Wc[Q][Zk[he]]}return M.kc=P(ge),M.kc&&(M.Bd=x(ge,8)),M.cb=1}function Yr(M,W,Q,ae,he,ge,ve){var we=W[he].Yb[Q];for(Q=0;16>he;++he){if(!D(M,we[Q+0]))return he;for(;!D(M,we[Q+1]);)if(we=W[++he].Yb[0],Q=0,he==16)return 16;var Ae=W[he+1].Yb;if(D(M,we[Q+2])){var Ne=M,He=0;if(D(Ne,(lt=we)[(ot=Q)+3]))if(D(Ne,lt[ot+6])){for(we=0,ot=2*(He=D(Ne,lt[ot+8]))+(lt=D(Ne,lt[ot+9+He])),He=0,lt=Gk[ot];lt[we];++we)He+=He+D(Ne,lt[we]);He+=3+(8<<ot)}else D(Ne,lt[ot+7])?(He=7+2*D(Ne,165),He+=D(Ne,145)):He=5+D(Ne,159);else He=D(Ne,lt[ot+4])?3+D(Ne,lt[ot+5]):2;we=Ae[2]}else He=1,we=Ae[1];Ae=ve+Xk[he],0>(Ne=M).b&&J(Ne);var ot,lt=Ne.b,Ze=(ot=Ne.Ca>>1)-(Ne.I>>lt)>>31;--Ne.b,Ne.Ca+=Ze,Ne.Ca|=1,Ne.I-=(ot+1&Ze)<<lt,ge[Ae]=((He^Ze)-Ze)*ae[(0<he)+0]}return 16}function cn(M){var W=M.rb[M.sb-1];W.la=0,W.Na=0,s(M.zc,0,0,M.zc.length),M.ja=0}function _s(M,W){if(M==null)return 0;if(W==null)return Kt(M,2,"NULL VP8Io parameter in VP8Decode().");if(!M.cb&&!Fr(M,W))return 0;if(r(M.cb),W.ac==null||W.ac(W)){W.ob&&(M.L=0);var Q=Dd[M.L];if(M.L==2?(M.yb=0,M.zb=0):(M.yb=W.v-Q>>4,M.zb=W.j-Q>>4,0>M.yb&&(M.yb=0),0>M.zb&&(M.zb=0)),M.Va=W.o+15+Q>>4,M.Hb=W.va+15+Q>>4,M.Hb>M.za&&(M.Hb=M.za),M.Va>M.Ub&&(M.Va=M.Ub),0<M.L){var ae=M.ed;for(Q=0;4>Q;++Q){var he;if(M.Qa.Cb){var ge=M.Qa.Lb[Q];M.Qa.Fb||(ge+=ae.Tb)}else ge=ae.Tb;for(he=0;1>=he;++he){var ve=M.gd[Q][he],we=ge;if(ae.Pc&&(we+=ae.vd[0],he&&(we+=ae.od[0])),0<(we=0>we?0:63<we?63:we)){var Ae=we;0<ae.wb&&(Ae=4<ae.wb?Ae>>2:Ae>>1)>9-ae.wb&&(Ae=9-ae.wb),1>Ae&&(Ae=1),ve.dd=Ae,ve.tc=2*we+Ae,ve.ld=40<=we?2:15<=we?1:0}else ve.tc=0;ve.La=he}}}Q=0}else Kt(M,6,"Frame setup failed"),Q=M.a;if(Q=Q==0){if(Q){M.$c=0,0<M.Aa||(M.Ic=f7);e:{Q=M.Ic,ae=4*(Ae=M.za);var Ne=32*Ae,He=Ae+1,ot=0<M.L?Ae*(0<M.Aa?2:1):0,lt=(M.Aa==2?2:1)*Ae;if((ve=ae+832+(he=3*(16*Q+Dd[M.L])/2*Ne)+(ge=M.Fa!=null&&0<M.Fa.length?M.Kc.c*M.Kc.i:0))!=ve)Q=0;else{if(ve>M.Vb){if(M.Vb=0,M.Ec=a(ve),M.Fc=0,M.Ec==null){Q=Kt(M,1,"no memory during frame initialization.");break e}M.Vb=ve}ve=M.Ec,we=M.Fc,M.Ac=ve,M.Bc=we,we+=ae,M.Gd=i(Ne,Gt),M.Hd=0,M.rb=i(He+1,Rt),M.sb=1,M.wa=ot?i(ot,mt):null,M.Y=0,M.D.Nb=0,M.D.wa=M.wa,M.D.Y=M.Y,0<M.Aa&&(M.D.Y+=Ae),r(!0),M.oc=ve,M.pc=we,we+=832,M.ya=i(lt,Nt),M.aa=0,M.D.ya=M.ya,M.D.aa=M.aa,M.Aa==2&&(M.D.aa+=Ae),M.R=16*Ae,M.B=8*Ae,Ae=(Ne=Dd[M.L])*M.R,Ne=Ne/2*M.B,M.sa=ve,M.ta=we+Ae,M.qa=M.sa,M.ra=M.ta+16*Q*M.R+Ne,M.Ha=M.qa,M.Ia=M.ra+8*Q*M.B+Ne,M.$c=0,we+=he,M.mb=ge?ve:null,M.nb=ge?we:null,r(we+ge<=M.Fc+M.Vb),cn(M),s(M.Ac,M.Bc,0,ae),Q=1}}if(Q){if(W.ka=0,W.y=M.sa,W.O=M.ta,W.f=M.qa,W.N=M.ra,W.ea=M.Ha,W.Vd=M.Ia,W.fa=M.R,W.Rc=M.B,W.F=null,W.J=0,!wd){for(Q=-255;255>=Q;++Q)Nn[255+Q]=0>Q?-Q:Q;for(Q=-1020;1020>=Q;++Q)Hi[1020+Q]=-128>Q?-128:127<Q?127:Q;for(Q=-112;112>=Q;++Q)mf[112+Q]=-16>Q?-16:15<Q?15:Q;for(Q=-255;510>=Q;++Q)Oc[255+Q]=0>Q?0:255<Q?255:Q;wd=1}Dc=Wn,Ui=pr,hf=ea,As=Ba,wa=Oi,fn=br,Rc=Zu,xd=Tl,df=Wm,Rl=Qu,Pl=qm,Co=wc,Ol=ef,Pc=pd,Ml=dd,To=hi,pf=Ii,_a=Vm,Ha[0]=fi,Ha[1]=ya,Ha[2]=xo,Ha[3]=wo,Ha[4]=ld,Ha[5]=yc,Ha[6]=cd,Ha[7]=Ku,Ha[8]=Um,Ha[9]=$m,No[0]=ji,No[1]=bo,No[2]=rs,No[3]=ks,No[4]=yn,No[5]=yo,No[6]=Li,zi[0]=_o,zi[1]=Mi,zi[2]=Hm,zi[3]=Yu,zi[4]=Cl,zi[5]=zm,zi[6]=Ju,Q=1}else Q=0}Q&&(Q=function(Ze,St){for(Ze.M=0;Ze.M<Ze.Va;++Ze.M){var pt,ze=Ze.Jc[Ze.M&Ze.Xb],Ge=Ze.m,xt=Ze;for(pt=0;pt<xt.za;++pt){var At=Ge,_t=xt,Bt=_t.Ac,Mt=_t.Bc+4*pt,Yt=_t.zc,Ft=_t.ya[_t.aa+pt];if(_t.Qa.Bb?Ft.$b=D(At,_t.Pa.jb[0])?2+D(At,_t.Pa.jb[2]):D(At,_t.Pa.jb[1]):Ft.$b=0,_t.kc&&(Ft.Ad=D(At,_t.Bd)),Ft.Za=!D(At,145)+0,Ft.Za){var Tr=Ft.Ob,Rr=0;for(_t=0;4>_t;++_t){var Er,vr=Yt[0+_t];for(Er=0;4>Er;++Er){vr=Yk[Bt[Mt+Er]][vr];for(var Lr=yy[D(At,vr[0])];0<Lr;)Lr=yy[2*Lr+D(At,vr[Lr])];vr=-Lr,Bt[Mt+Er]=vr}n(Tr,Rr,Bt,Mt,4),Rr+=4,Yt[0+_t]=vr}}else vr=D(At,156)?D(At,128)?1:3:D(At,163)?2:0,Ft.Ob[0]=vr,s(Bt,Mt,vr,4),s(Yt,0,vr,4);Ft.Dd=D(At,142)?D(At,114)?D(At,183)?1:3:2:0}if(xt.m.Ka)return Kt(Ze,7,"Premature end-of-partition0 encountered.");for(;Ze.ja<Ze.za;++Ze.ja){if(xt=ze,At=(Ge=Ze).rb[Ge.sb-1],Bt=Ge.rb[Ge.sb+Ge.ja],pt=Ge.ya[Ge.aa+Ge.ja],Mt=Ge.kc?pt.Ad:0)At.la=Bt.la=0,pt.Za||(At.Na=Bt.Na=0),pt.Hc=0,pt.Gc=0,pt.ia=0;else{var jr,fr;if(At=Bt,Bt=xt,Mt=Ge.Pa.Xc,Yt=Ge.ya[Ge.aa+Ge.ja],Ft=Ge.pb[Yt.$b],_t=Yt.ad,Tr=0,Rr=Ge.rb[Ge.sb-1],vr=Er=0,s(_t,Tr,0,384),Yt.Za)var wn=0,Bs=Mt[3];else{Lr=a(16);var _n=At.Na+Rr.Na;if(_n=gf(Bt,Mt[1],_n,Ft.Eb,0,Lr,0),At.Na=Rr.Na=(0<_n)+0,1<_n)Dc(Lr,0,_t,Tr);else{var $s=Lr[0]+3>>3;for(Lr=0;256>Lr;Lr+=16)_t[Tr+Lr]=$s}wn=1,Bs=Mt[0]}var Pr=15&At.la,na=15&Rr.la;for(Lr=0;4>Lr;++Lr){var sa=1&na;for($s=fr=0;4>$s;++$s)Pr=Pr>>1|(sa=(_n=gf(Bt,Bs,_n=sa+(1&Pr),Ft.Sc,wn,_t,Tr))>wn)<<7,fr=fr<<2|(3<_n?3:1<_n?2:_t[Tr+0]!=0),Tr+=16;Pr>>=4,na=na>>1|sa<<7,Er=(Er<<8|fr)>>>0}for(Bs=Pr,wn=na>>4,jr=0;4>jr;jr+=2){for(fr=0,Pr=At.la>>4+jr,na=Rr.la>>4+jr,Lr=0;2>Lr;++Lr){for(sa=1&na,$s=0;2>$s;++$s)_n=sa+(1&Pr),Pr=Pr>>1|(sa=0<(_n=gf(Bt,Mt[2],_n,Ft.Qc,0,_t,Tr)))<<3,fr=fr<<2|(3<_n?3:1<_n?2:_t[Tr+0]!=0),Tr+=16;Pr>>=2,na=na>>1|sa<<5}vr|=fr<<4*jr,Bs|=Pr<<4<<jr,wn|=(240&na)<<jr}At.la=Bs,Rr.la=wn,Yt.Hc=Er,Yt.Gc=vr,Yt.ia=43690&vr?0:Ft.ia,Mt=!(Er|vr)}if(0<Ge.L&&(Ge.wa[Ge.Y+Ge.ja]=Ge.gd[pt.$b][pt.Za],Ge.wa[Ge.Y+Ge.ja].La|=!Mt),xt.Ka)return Kt(Ze,7,"Premature end-of-file encountered.")}if(cn(Ze),Ge=St,xt=1,pt=(ze=Ze).D,At=0<ze.L&&ze.M>=ze.zb&&ze.M<=ze.Va,ze.Aa==0)e:{if(pt.M=ze.M,pt.uc=At,of(ze,pt),xt=1,pt=(fr=ze.D).Nb,At=(vr=Dd[ze.L])*ze.R,Bt=vr/2*ze.B,Lr=16*pt*ze.R,$s=8*pt*ze.B,Mt=ze.sa,Yt=ze.ta-At+Lr,Ft=ze.qa,_t=ze.ra-Bt+$s,Tr=ze.Ha,Rr=ze.Ia-Bt+$s,na=(Pr=fr.M)==0,Er=Pr>=ze.Va-1,ze.Aa==2&&of(ze,fr),fr.uc)for(sa=(_n=ze).D.M,r(_n.D.uc),fr=_n.yb;fr<_n.Hb;++fr){wn=fr,Bs=sa;var Ln=(Xn=(rn=_n).D).Nb;jr=rn.R;var Xn=Xn.wa[Xn.Y+wn],Cs=rn.sa,Aa=rn.ta+16*Ln*jr+16*wn,pi=Xn.dd,In=Xn.tc;if(In!=0)if(r(3<=In),rn.L==1)0<wn&&To(Cs,Aa,jr,In+4),Xn.La&&_a(Cs,Aa,jr,In),0<Bs&&Ml(Cs,Aa,jr,In+4),Xn.La&&pf(Cs,Aa,jr,In);else{var Vi=rn.B,Fl=rn.qa,Mc=rn.ra+8*Ln*Vi+8*wn,Ro=rn.Ha,rn=rn.Ia+8*Ln*Vi+8*wn;Ln=Xn.ld,0<wn&&(xd(Cs,Aa,jr,In+4,pi,Ln),Rl(Fl,Mc,Ro,rn,Vi,In+4,pi,Ln)),Xn.La&&(Co(Cs,Aa,jr,In,pi,Ln),Pc(Fl,Mc,Ro,rn,Vi,In,pi,Ln)),0<Bs&&(Rc(Cs,Aa,jr,In+4,pi,Ln),df(Fl,Mc,Ro,rn,Vi,In+4,pi,Ln)),Xn.La&&(Pl(Cs,Aa,jr,In,pi,Ln),Ol(Fl,Mc,Ro,rn,Vi,In,pi,Ln))}}if(ze.ia&&alert("todo:DitherRow"),Ge.put!=null){if(fr=16*Pr,Pr=16*(Pr+1),na?(Ge.y=ze.sa,Ge.O=ze.ta+Lr,Ge.f=ze.qa,Ge.N=ze.ra+$s,Ge.ea=ze.Ha,Ge.W=ze.Ia+$s):(fr-=vr,Ge.y=Mt,Ge.O=Yt,Ge.f=Ft,Ge.N=_t,Ge.ea=Tr,Ge.W=Rr),Er||(Pr-=vr),Pr>Ge.o&&(Pr=Ge.o),Ge.F=null,Ge.J=null,ze.Fa!=null&&0<ze.Fa.length&&fr<Pr&&(Ge.J=sf(ze,Ge,fr,Pr-fr),Ge.F=ze.mb,Ge.F==null&&Ge.F.length==0)){xt=Kt(ze,3,"Could not decode alpha data.");break e}fr<Ge.j&&(vr=Ge.j-fr,fr=Ge.j,r(!(1&vr)),Ge.O+=ze.R*vr,Ge.N+=ze.B*(vr>>1),Ge.W+=ze.B*(vr>>1),Ge.F!=null&&(Ge.J+=Ge.width*vr)),fr<Pr&&(Ge.O+=Ge.v,Ge.N+=Ge.v>>1,Ge.W+=Ge.v>>1,Ge.F!=null&&(Ge.J+=Ge.v),Ge.ka=fr-Ge.j,Ge.U=Ge.va-Ge.v,Ge.T=Pr-fr,xt=Ge.put(Ge))}pt+1!=ze.Ic||Er||(n(ze.sa,ze.ta-At,Mt,Yt+16*ze.R,At),n(ze.qa,ze.ra-Bt,Ft,_t+8*ze.B,Bt),n(ze.Ha,ze.Ia-Bt,Tr,Rr+8*ze.B,Bt))}if(!xt)return Kt(Ze,6,"Output aborted.")}return 1}(M,W)),W.bc!=null&&W.bc(W),Q&=1}return Q?(M.cb=0,Q):0}function Tn(M,W,Q,ae,he){he=M[W+Q+32*ae]+(he>>3),M[W+Q+32*ae]=-256&he?0>he?0:255:he}function Qs(M,W,Q,ae,he,ge){Tn(M,W,0,Q,ae+he),Tn(M,W,1,Q,ae+ge),Tn(M,W,2,Q,ae-ge),Tn(M,W,3,Q,ae-he)}function un(M){return(20091*M>>16)+M}function ba(M,W,Q,ae){var he,ge=0,ve=a(16);for(he=0;4>he;++he){var we=M[W+0]+M[W+8],Ae=M[W+0]-M[W+8],Ne=(35468*M[W+4]>>16)-un(M[W+12]),He=un(M[W+4])+(35468*M[W+12]>>16);ve[ge+0]=we+He,ve[ge+1]=Ae+Ne,ve[ge+2]=Ae-Ne,ve[ge+3]=we-He,ge+=4,W++}for(he=ge=0;4>he;++he)we=(M=ve[ge+0]+4)+ve[ge+8],Ae=M-ve[ge+8],Ne=(35468*ve[ge+4]>>16)-un(ve[ge+12]),Tn(Q,ae,0,0,we+(He=un(ve[ge+4])+(35468*ve[ge+12]>>16))),Tn(Q,ae,1,0,Ae+Ne),Tn(Q,ae,2,0,Ae-Ne),Tn(Q,ae,3,0,we-He),ge++,ae+=32}function br(M,W,Q,ae){var he=M[W+0]+4,ge=35468*M[W+4]>>16,ve=un(M[W+4]),we=35468*M[W+1]>>16;Qs(Q,ae,0,he+ve,M=un(M[W+1]),we),Qs(Q,ae,1,he+ge,M,we),Qs(Q,ae,2,he-ge,M,we),Qs(Q,ae,3,he-ve,M,we)}function pr(M,W,Q,ae,he){ba(M,W,Q,ae),he&&ba(M,W+16,Q,ae+4)}function ea(M,W,Q,ae){Ui(M,W+0,Q,ae,1),Ui(M,W+32,Q,ae+128,1)}function Ba(M,W,Q,ae){var he;for(M=M[W+0]+4,he=0;4>he;++he)for(W=0;4>W;++W)Tn(Q,ae,W,he,M)}function Oi(M,W,Q,ae){M[W+0]&&As(M,W+0,Q,ae),M[W+16]&&As(M,W+16,Q,ae+4),M[W+32]&&As(M,W+32,Q,ae+128),M[W+48]&&As(M,W+48,Q,ae+128+4)}function Wn(M,W,Q,ae){var he,ge=a(16);for(he=0;4>he;++he){var ve=M[W+0+he]+M[W+12+he],we=M[W+4+he]+M[W+8+he],Ae=M[W+4+he]-M[W+8+he],Ne=M[W+0+he]-M[W+12+he];ge[0+he]=ve+we,ge[8+he]=ve-we,ge[4+he]=Ne+Ae,ge[12+he]=Ne-Ae}for(he=0;4>he;++he)ve=(M=ge[0+4*he]+3)+ge[3+4*he],we=ge[1+4*he]+ge[2+4*he],Ae=ge[1+4*he]-ge[2+4*he],Ne=M-ge[3+4*he],Q[ae+0]=ve+we>>3,Q[ae+16]=Ne+Ae>>3,Q[ae+32]=ve-we>>3,Q[ae+48]=Ne-Ae>>3,ae+=64}function Ss(M,W,Q){var ae,he=W-32,ge=ra,ve=255-M[he-1];for(ae=0;ae<Q;++ae){var we,Ae=ge,Ne=ve+M[W-1];for(we=0;we<Q;++we)M[W+we]=Ae[Ne+M[he+we]];W+=32}}function ya(M,W){Ss(M,W,4)}function Mi(M,W){Ss(M,W,8)}function bo(M,W){Ss(M,W,16)}function rs(M,W){var Q;for(Q=0;16>Q;++Q)n(M,W+32*Q,M,W-32,16)}function ks(M,W){var Q;for(Q=16;0<Q;--Q)s(M,W,M[W-1],16),W+=32}function Fi(M,W,Q){var ae;for(ae=0;16>ae;++ae)s(W,Q+32*ae,M,16)}function ji(M,W){var Q,ae=16;for(Q=0;16>Q;++Q)ae+=M[W-1+32*Q]+M[W+Q-32];Fi(ae>>5,M,W)}function yn(M,W){var Q,ae=8;for(Q=0;16>Q;++Q)ae+=M[W-1+32*Q];Fi(ae>>4,M,W)}function yo(M,W){var Q,ae=8;for(Q=0;16>Q;++Q)ae+=M[W+Q-32];Fi(ae>>4,M,W)}function Li(M,W){Fi(128,M,W)}function tr(M,W,Q){return M+2*W+Q+2>>2}function xo(M,W){var Q,ae=W-32;for(ae=new Uint8Array([tr(M[ae-1],M[ae+0],M[ae+1]),tr(M[ae+0],M[ae+1],M[ae+2]),tr(M[ae+1],M[ae+2],M[ae+3]),tr(M[ae+2],M[ae+3],M[ae+4])]),Q=0;4>Q;++Q)n(M,W+32*Q,ae,0,ae.length)}function wo(M,W){var Q=M[W-1],ae=M[W-1+32],he=M[W-1+64],ge=M[W-1+96];G(M,W+0,16843009*tr(M[W-1-32],Q,ae)),G(M,W+32,16843009*tr(Q,ae,he)),G(M,W+64,16843009*tr(ae,he,ge)),G(M,W+96,16843009*tr(he,ge,ge))}function fi(M,W){var Q,ae=4;for(Q=0;4>Q;++Q)ae+=M[W+Q-32]+M[W-1+32*Q];for(ae>>=3,Q=0;4>Q;++Q)s(M,W+32*Q,ae,4)}function ld(M,W){var Q=M[W-1+0],ae=M[W-1+32],he=M[W-1+64],ge=M[W-1-32],ve=M[W+0-32],we=M[W+1-32],Ae=M[W+2-32],Ne=M[W+3-32];M[W+0+96]=tr(ae,he,M[W-1+96]),M[W+1+96]=M[W+0+64]=tr(Q,ae,he),M[W+2+96]=M[W+1+64]=M[W+0+32]=tr(ge,Q,ae),M[W+3+96]=M[W+2+64]=M[W+1+32]=M[W+0+0]=tr(ve,ge,Q),M[W+3+64]=M[W+2+32]=M[W+1+0]=tr(we,ve,ge),M[W+3+32]=M[W+2+0]=tr(Ae,we,ve),M[W+3+0]=tr(Ne,Ae,we)}function cd(M,W){var Q=M[W+1-32],ae=M[W+2-32],he=M[W+3-32],ge=M[W+4-32],ve=M[W+5-32],we=M[W+6-32],Ae=M[W+7-32];M[W+0+0]=tr(M[W+0-32],Q,ae),M[W+1+0]=M[W+0+32]=tr(Q,ae,he),M[W+2+0]=M[W+1+32]=M[W+0+64]=tr(ae,he,ge),M[W+3+0]=M[W+2+32]=M[W+1+64]=M[W+0+96]=tr(he,ge,ve),M[W+3+32]=M[W+2+64]=M[W+1+96]=tr(ge,ve,we),M[W+3+64]=M[W+2+96]=tr(ve,we,Ae),M[W+3+96]=tr(we,Ae,Ae)}function yc(M,W){var Q=M[W-1+0],ae=M[W-1+32],he=M[W-1+64],ge=M[W-1-32],ve=M[W+0-32],we=M[W+1-32],Ae=M[W+2-32],Ne=M[W+3-32];M[W+0+0]=M[W+1+64]=ge+ve+1>>1,M[W+1+0]=M[W+2+64]=ve+we+1>>1,M[W+2+0]=M[W+3+64]=we+Ae+1>>1,M[W+3+0]=Ae+Ne+1>>1,M[W+0+96]=tr(he,ae,Q),M[W+0+64]=tr(ae,Q,ge),M[W+0+32]=M[W+1+96]=tr(Q,ge,ve),M[W+1+32]=M[W+2+96]=tr(ge,ve,we),M[W+2+32]=M[W+3+96]=tr(ve,we,Ae),M[W+3+32]=tr(we,Ae,Ne)}function Ku(M,W){var Q=M[W+0-32],ae=M[W+1-32],he=M[W+2-32],ge=M[W+3-32],ve=M[W+4-32],we=M[W+5-32],Ae=M[W+6-32],Ne=M[W+7-32];M[W+0+0]=Q+ae+1>>1,M[W+1+0]=M[W+0+64]=ae+he+1>>1,M[W+2+0]=M[W+1+64]=he+ge+1>>1,M[W+3+0]=M[W+2+64]=ge+ve+1>>1,M[W+0+32]=tr(Q,ae,he),M[W+1+32]=M[W+0+96]=tr(ae,he,ge),M[W+2+32]=M[W+1+96]=tr(he,ge,ve),M[W+3+32]=M[W+2+96]=tr(ge,ve,we),M[W+3+64]=tr(ve,we,Ae),M[W+3+96]=tr(we,Ae,Ne)}function $m(M,W){var Q=M[W-1+0],ae=M[W-1+32],he=M[W-1+64],ge=M[W-1+96];M[W+0+0]=Q+ae+1>>1,M[W+2+0]=M[W+0+32]=ae+he+1>>1,M[W+2+32]=M[W+0+64]=he+ge+1>>1,M[W+1+0]=tr(Q,ae,he),M[W+3+0]=M[W+1+32]=tr(ae,he,ge),M[W+3+32]=M[W+1+64]=tr(he,ge,ge),M[W+3+64]=M[W+2+64]=M[W+0+96]=M[W+1+96]=M[W+2+96]=M[W+3+96]=ge}function Um(M,W){var Q=M[W-1+0],ae=M[W-1+32],he=M[W-1+64],ge=M[W-1+96],ve=M[W-1-32],we=M[W+0-32],Ae=M[W+1-32],Ne=M[W+2-32];M[W+0+0]=M[W+2+32]=Q+ve+1>>1,M[W+0+32]=M[W+2+64]=ae+Q+1>>1,M[W+0+64]=M[W+2+96]=he+ae+1>>1,M[W+0+96]=ge+he+1>>1,M[W+3+0]=tr(we,Ae,Ne),M[W+2+0]=tr(ve,we,Ae),M[W+1+0]=M[W+3+32]=tr(Q,ve,we),M[W+1+32]=M[W+3+64]=tr(ae,Q,ve),M[W+1+64]=M[W+3+96]=tr(he,ae,Q),M[W+1+96]=tr(ge,he,ae)}function Hm(M,W){var Q;for(Q=0;8>Q;++Q)n(M,W+32*Q,M,W-32,8)}function Yu(M,W){var Q;for(Q=0;8>Q;++Q)s(M,W,M[W-1],8),W+=32}function Al(M,W,Q){var ae;for(ae=0;8>ae;++ae)s(W,Q+32*ae,M,8)}function _o(M,W){var Q,ae=8;for(Q=0;8>Q;++Q)ae+=M[W+Q-32]+M[W-1+32*Q];Al(ae>>4,M,W)}function zm(M,W){var Q,ae=4;for(Q=0;8>Q;++Q)ae+=M[W+Q-32];Al(ae>>3,M,W)}function Cl(M,W){var Q,ae=4;for(Q=0;8>Q;++Q)ae+=M[W-1+32*Q];Al(ae>>3,M,W)}function Ju(M,W){Al(128,M,W)}function xc(M,W,Q){var ae=M[W-Q],he=M[W+0],ge=3*(he-ae)+Km[1020+M[W-2*Q]-M[W+Q]],ve=_d[112+(ge+4>>3)];M[W-Q]=ra[255+ae+_d[112+(ge+3>>3)]],M[W+0]=ra[255+he-ve]}function ud(M,W,Q,ae){var he=M[W+0],ge=M[W+Q];return ka[255+M[W-2*Q]-M[W-Q]]>ae||ka[255+ge-he]>ae}function fd(M,W,Q,ae){return 4*ka[255+M[W-Q]-M[W+0]]+ka[255+M[W-2*Q]-M[W+Q]]<=ae}function hd(M,W,Q,ae,he){var ge=M[W-3*Q],ve=M[W-2*Q],we=M[W-Q],Ae=M[W+0],Ne=M[W+Q],He=M[W+2*Q],ot=M[W+3*Q];return 4*ka[255+we-Ae]+ka[255+ve-Ne]>ae?0:ka[255+M[W-4*Q]-ge]<=he&&ka[255+ge-ve]<=he&&ka[255+ve-we]<=he&&ka[255+ot-He]<=he&&ka[255+He-Ne]<=he&&ka[255+Ne-Ae]<=he}function dd(M,W,Q,ae){var he=2*ae+1;for(ae=0;16>ae;++ae)fd(M,W+ae,Q,he)&&xc(M,W+ae,Q)}function hi(M,W,Q,ae){var he=2*ae+1;for(ae=0;16>ae;++ae)fd(M,W+ae*Q,1,he)&&xc(M,W+ae*Q,1)}function Ii(M,W,Q,ae){var he;for(he=3;0<he;--he)dd(M,W+=4*Q,Q,ae)}function Vm(M,W,Q,ae){var he;for(he=3;0<he;--he)hi(M,W+=4,Q,ae)}function So(M,W,Q,ae,he,ge,ve,we){for(ge=2*ge+1;0<he--;){if(hd(M,W,Q,ge,ve))if(ud(M,W,Q,we))xc(M,W,Q);else{var Ae=M,Ne=W,He=Q,ot=Ae[Ne-2*He],lt=Ae[Ne-He],Ze=Ae[Ne+0],St=Ae[Ne+He],pt=Ae[Ne+2*He],ze=27*(xt=Km[1020+3*(Ze-lt)+Km[1020+ot-St]])+63>>7,Ge=18*xt+63>>7,xt=9*xt+63>>7;Ae[Ne-3*He]=ra[255+Ae[Ne-3*He]+xt],Ae[Ne-2*He]=ra[255+ot+Ge],Ae[Ne-He]=ra[255+lt+ze],Ae[Ne+0]=ra[255+Ze-ze],Ae[Ne+He]=ra[255+St-Ge],Ae[Ne+2*He]=ra[255+pt-xt]}W+=ae}}function $a(M,W,Q,ae,he,ge,ve,we){for(ge=2*ge+1;0<he--;){if(hd(M,W,Q,ge,ve))if(ud(M,W,Q,we))xc(M,W,Q);else{var Ae=M,Ne=W,He=Q,ot=Ae[Ne-He],lt=Ae[Ne+0],Ze=Ae[Ne+He],St=_d[112+((pt=3*(lt-ot))+4>>3)],pt=_d[112+(pt+3>>3)],ze=St+1>>1;Ae[Ne-2*He]=ra[255+Ae[Ne-2*He]+ze],Ae[Ne-He]=ra[255+ot+pt],Ae[Ne+0]=ra[255+lt-St],Ae[Ne+He]=ra[255+Ze-ze]}W+=ae}}function Zu(M,W,Q,ae,he,ge){So(M,W,Q,1,16,ae,he,ge)}function Tl(M,W,Q,ae,he,ge){So(M,W,1,Q,16,ae,he,ge)}function qm(M,W,Q,ae,he,ge){var ve;for(ve=3;0<ve;--ve)$a(M,W+=4*Q,Q,1,16,ae,he,ge)}function wc(M,W,Q,ae,he,ge){var ve;for(ve=3;0<ve;--ve)$a(M,W+=4,1,Q,16,ae,he,ge)}function Wm(M,W,Q,ae,he,ge,ve,we){So(M,W,he,1,8,ge,ve,we),So(Q,ae,he,1,8,ge,ve,we)}function Qu(M,W,Q,ae,he,ge,ve,we){So(M,W,1,he,8,ge,ve,we),So(Q,ae,1,he,8,ge,ve,we)}function ef(M,W,Q,ae,he,ge,ve,we){$a(M,W+4*he,he,1,8,ge,ve,we),$a(Q,ae+4*he,he,1,8,ge,ve,we)}function pd(M,W,Q,ae,he,ge,ve,we){$a(M,W+4,1,he,8,ge,ve,we),$a(Q,ae+4,1,he,8,ge,ve,we)}function _c(){this.ba=new wt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new dt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function tf(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function rf(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function md(){this.ua=0,this.Wa=new ee,this.vb=new ee,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new O,this.yc=new I}function Gm(){this.xb=this.a=0,this.l=new Ht,this.ca=new wt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new A,this.Pb=0,this.wd=new A,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new md,this.ab=0,this.gc=i(4,rf),this.Oc=0}function Sc(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ht,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Nl(M,W,Q,ae,he,ge,ve){for(M=M==null?0:M[W+0],W=0;W<ve;++W)he[ge+W]=M+Q[ae+W]&255,M=he[ge+W]}function nf(M,W,Q,ae,he,ge,ve){var we;if(M==null)Nl(null,null,Q,ae,he,ge,ve);else for(we=0;we<ve;++we)he[ge+we]=M[W+we]+Q[ae+we]&255}function ko(M,W,Q,ae,he,ge,ve){if(M==null)Nl(null,null,Q,ae,he,ge,ve);else{var we,Ae=M[W+0],Ne=Ae,He=Ae;for(we=0;we<ve;++we)Ne=He+(Ae=M[W+we])-Ne,He=Q[ae+we]+(-256&Ne?0>Ne?0:255:Ne)&255,Ne=Ae,he[ge+we]=He}}function sf(M,W,Q,ae){var he=W.width,ge=W.o;if(r(M!=null&&W!=null),0>Q||0>=ae||Q+ae>ge)return null;if(!M.Cc){if(M.ga==null){var ve;if(M.ga=new Sc,(ve=M.ga==null)||(ve=W.width*W.o,r(M.Gb.length==0),M.Gb=a(ve),M.Uc=0,M.Gb==null?ve=0:(M.mb=M.Gb,M.nb=M.Uc,M.rc=null,ve=1),ve=!ve),!ve){ve=M.ga;var we=M.Fa,Ae=M.P,Ne=M.qc,He=M.mb,ot=M.nb,lt=Ae+1,Ze=Ne-1,St=ve.l;if(r(we!=null&&He!=null&&W!=null),Do[0]=null,Do[1]=Nl,Do[2]=nf,Do[3]=ko,ve.ca=He,ve.tb=ot,ve.c=W.width,ve.i=W.height,r(0<ve.c&&0<ve.i),1>=Ne)W=0;else if(ve.$a=we[Ae+0]>>0&3,ve.Z=we[Ae+0]>>2&3,ve.Lc=we[Ae+0]>>4&3,Ae=we[Ae+0]>>6&3,0>ve.$a||1<ve.$a||4<=ve.Z||1<ve.Lc||Ae)W=0;else if(St.put=jt,St.ac=Et,St.bc=Ot,St.ma=ve,St.width=W.width,St.height=W.height,St.Da=W.Da,St.v=W.v,St.va=W.va,St.j=W.j,St.o=W.o,ve.$a)e:{r(ve.$a==1),W=Ke();t:for(;;){if(W==null){W=0;break e}if(r(ve!=null),ve.mc=W,W.c=ve.c,W.i=ve.i,W.l=ve.l,W.l.ma=ve,W.l.width=ve.c,W.l.height=ve.i,W.a=0,_(W.m,we,lt,Ze),!Ue(ve.c,ve.i,1,W,null)||(W.ab==1&&W.gc[0].hc==3&&me(W.s)?(ve.ic=1,we=W.c*W.i,W.Ta=null,W.Ua=0,W.V=a(we),W.Ba=0,W.V==null?(W.a=1,W=0):W=1):(ve.ic=0,W=Qe(W,ve.c)),!W))break t;W=1;break e}ve.mc=null,W=0}else W=Ze>=ve.c*ve.i;ve=!W}if(ve)return null;M.ga.Lc!=1?M.Ga=0:ae=ge-Q}r(M.ga!=null),r(Q+ae<=ge);e:{if(W=(we=M.ga).c,ge=we.l.o,we.$a==0){if(lt=M.rc,Ze=M.Vc,St=M.Fa,Ae=M.P+1+Q*W,Ne=M.mb,He=M.nb+Q*W,r(Ae<=M.P+M.qc),we.Z!=0)for(r(Do[we.Z]!=null),ve=0;ve<ae;++ve)Do[we.Z](lt,Ze,St,Ae,Ne,He,W),lt=Ne,Ze=He,He+=W,Ae+=W;else for(ve=0;ve<ae;++ve)n(Ne,He,St,Ae,W),lt=Ne,Ze=He,He+=W,Ae+=W;M.rc=lt,M.Vc=Ze}else{if(r(we.mc!=null),W=Q+ae,r((ve=we.mc)!=null),r(W<=ve.i),ve.C>=W)W=1;else if(we.ic||st(),we.ic){we=ve.V,lt=ve.Ba,Ze=ve.c;var pt=ve.i,ze=(St=1,Ae=ve.$/Ze,Ne=ve.$%Ze,He=ve.m,ot=ve.s,ve.$),Ge=Ze*pt,xt=Ze*W,At=ot.wc,_t=ze<xt?tt(ot,Ne,Ae):null;r(ze<=Ge),r(W<=pt),r(me(ot));t:for(;;){for(;!He.h&&ze<xt;){if(Ne&At||(_t=tt(ot,Ne,Ae)),r(_t!=null),j(He),256>(pt=Fe(_t.G[0],_t.H[0],He)))we[lt+ze]=pt,++ze,++Ne>=Ze&&(Ne=0,++Ae<=W&&!(Ae%16)&&_e(ve,Ae));else{if(!(280>pt)){St=0;break t}pt=Vt(pt-256,He);var Bt,Mt=Fe(_t.G[4],_t.H[4],He);if(j(He),!(ze>=(Mt=$t(Ze,Mt=Vt(Mt,He)))&&Ge-ze>=pt)){St=0;break t}for(Bt=0;Bt<pt;++Bt)we[lt+ze+Bt]=we[lt+ze+Bt-Mt];for(ze+=pt,Ne+=pt;Ne>=Ze;)Ne-=Ze,++Ae<=W&&!(Ae%16)&&_e(ve,Ae);ze<xt&&Ne&At&&(_t=tt(ot,Ne,Ae))}r(He.h==z(He))}_e(ve,Ae>W?W:Ae);break t}!St||He.h&&ze<Ge?(St=0,ve.a=He.h?5:3):ve.$=ze,W=St}else W=Ee(ve,ve.V,ve.Ba,ve.c,ve.i,W,et);if(!W){ae=0;break e}}Q+ae>=ge&&(M.Cc=1),ae=1}if(!ae)return null;if(M.Cc&&((ae=M.ga)!=null&&(ae.mc=null),M.ga=null,0<M.Ga))return alert("todo:WebPDequantizeLevels"),null}return M.nb+Q*he}function Y(M,W,Q,ae,he,ge){for(;0<he--;){var ve,we=M,Ae=W+(Q?1:0),Ne=M,He=W+(Q?0:3);for(ve=0;ve<ae;++ve){var ot=Ne[He+4*ve];ot!=255&&(ot*=32897,we[Ae+4*ve+0]=we[Ae+4*ve+0]*ot>>23,we[Ae+4*ve+1]=we[Ae+4*ve+1]*ot>>23,we[Ae+4*ve+2]=we[Ae+4*ve+2]*ot>>23)}W+=ge}}function de(M,W,Q,ae,he){for(;0<ae--;){var ge;for(ge=0;ge<Q;++ge){var ve=M[W+2*ge+0],we=15&(Ne=M[W+2*ge+1]),Ae=4369*we,Ne=(240&Ne|Ne>>4)*Ae>>16;M[W+2*ge+0]=(240&ve|ve>>4)*Ae>>16&240|(15&ve|ve<<4)*Ae>>16>>4&15,M[W+2*ge+1]=240&Ne|we}W+=he}}function Re(M,W,Q,ae,he,ge,ve,we){var Ae,Ne,He=255;for(Ne=0;Ne<he;++Ne){for(Ae=0;Ae<ae;++Ae){var ot=M[W+Ae];ge[ve+4*Ae]=ot,He&=ot}W+=Q,ve+=we}return He!=255}function $e(M,W,Q,ae,he){var ge;for(ge=0;ge<he;++ge)Q[ae+ge]=M[W+ge]>>8}function st(){Sa=Y,Br=de,$r=Re,hn=$e}function vt(M,W,Q){R[M]=function(ae,he,ge,ve,we,Ae,Ne,He,ot,lt,Ze,St,pt,ze,Ge,xt,At){var _t,Bt=At-1>>1,Mt=we[Ae+0]|Ne[He+0]<<16,Yt=ot[lt+0]|Ze[St+0]<<16;r(ae!=null);var Ft=3*Mt+Yt+131074>>2;for(W(ae[he+0],255&Ft,Ft>>16,pt,ze),ge!=null&&(Ft=3*Yt+Mt+131074>>2,W(ge[ve+0],255&Ft,Ft>>16,Ge,xt)),_t=1;_t<=Bt;++_t){var Tr=we[Ae+_t]|Ne[He+_t]<<16,Rr=ot[lt+_t]|Ze[St+_t]<<16,Er=Mt+Tr+Yt+Rr+524296,vr=Er+2*(Tr+Yt)>>3;Ft=vr+Mt>>1,Mt=(Er=Er+2*(Mt+Rr)>>3)+Tr>>1,W(ae[he+2*_t-1],255&Ft,Ft>>16,pt,ze+(2*_t-1)*Q),W(ae[he+2*_t-0],255&Mt,Mt>>16,pt,ze+(2*_t-0)*Q),ge!=null&&(Ft=Er+Yt>>1,Mt=vr+Rr>>1,W(ge[ve+2*_t-1],255&Ft,Ft>>16,Ge,xt+(2*_t-1)*Q),W(ge[ve+2*_t+0],255&Mt,Mt>>16,Ge,xt+(2*_t+0)*Q)),Mt=Tr,Yt=Rr}1&At||(Ft=3*Mt+Yt+131074>>2,W(ae[he+At-1],255&Ft,Ft>>16,pt,ze+(At-1)*Q),ge!=null&&(Ft=3*Yt+Mt+131074>>2,W(ge[ve+At-1],255&Ft,Ft>>16,Ge,xt+(At-1)*Q)))}}function Tt(){Ea[Sd]=e7,Ea[kd]=wy,Ea[gy]=t7,Ea[Ed]=_y,Ea[Ad]=Sy,Ea[Ym]=ky,Ea[vy]=r7,Ea[Jm]=wy,Ea[Zm]=_y,Ea[Cd]=Sy,Ea[Qm]=ky}function It(M){return M&-16384?0>M?0:255:M>>n7}function qt(M,W){return It((19077*M>>8)+(26149*W>>8)-14234)}function ur(M,W,Q){return It((19077*M>>8)-(6419*W>>8)-(13320*Q>>8)+8708)}function ir(M,W){return It((19077*M>>8)+(33050*W>>8)-17685)}function wr(M,W,Q,ae,he){ae[he+0]=qt(M,Q),ae[he+1]=ur(M,W,Q),ae[he+2]=ir(M,W)}function Jr(M,W,Q,ae,he){ae[he+0]=ir(M,W),ae[he+1]=ur(M,W,Q),ae[he+2]=qt(M,Q)}function tn(M,W,Q,ae,he){var ge=ur(M,W,Q);W=ge<<3&224|ir(M,W)>>3,ae[he+0]=248&qt(M,Q)|ge>>5,ae[he+1]=W}function xn(M,W,Q,ae,he){var ge=240&ir(M,W)|15;ae[he+0]=240&qt(M,Q)|ur(M,W,Q)>>4,ae[he+1]=ge}function ns(M,W,Q,ae,he){ae[he+0]=255,wr(M,W,Q,ae,he+1)}function jn(M,W,Q,ae,he){Jr(M,W,Q,ae,he),ae[he+3]=255}function Ua(M,W,Q,ae,he){wr(M,W,Q,ae,he),ae[he+3]=255}function ta(M,W){return 0>M?0:M>W?W:M}function di(M,W,Q){R[M]=function(ae,he,ge,ve,we,Ae,Ne,He,ot){for(var lt=He+(-2&ot)*Q;He!=lt;)W(ae[he+0],ge[ve+0],we[Ae+0],Ne,He),W(ae[he+1],ge[ve+0],we[Ae+0],Ne,He+Q),he+=2,++ve,++Ae,He+=2*Q;1&ot&&W(ae[he+0],ge[ve+0],we[Ae+0],Ne,He)}}function gd(M,W,Q){return Q==0?M==0?W==0?6:5:W==0?4:0:Q}function af(M,W,Q,ae,he){switch(M>>>30){case 3:Ui(W,Q,ae,he,0);break;case 2:fn(W,Q,ae,he);break;case 1:As(W,Q,ae,he)}}function of(M,W){var Q,ae,he=W.M,ge=W.Nb,ve=M.oc,we=M.pc+40,Ae=M.oc,Ne=M.pc+584,He=M.oc,ot=M.pc+600;for(Q=0;16>Q;++Q)ve[we+32*Q-1]=129;for(Q=0;8>Q;++Q)Ae[Ne+32*Q-1]=129,He[ot+32*Q-1]=129;for(0<he?ve[we-1-32]=Ae[Ne-1-32]=He[ot-1-32]=129:(s(ve,we-32-1,127,21),s(Ae,Ne-32-1,127,9),s(He,ot-32-1,127,9)),ae=0;ae<M.za;++ae){var lt=W.ya[W.aa+ae];if(0<ae){for(Q=-1;16>Q;++Q)n(ve,we+32*Q-4,ve,we+32*Q+12,4);for(Q=-1;8>Q;++Q)n(Ae,Ne+32*Q-4,Ae,Ne+32*Q+4,4),n(He,ot+32*Q-4,He,ot+32*Q+4,4)}var Ze=M.Gd,St=M.Hd+ae,pt=lt.ad,ze=lt.Hc;if(0<he&&(n(ve,we-32,Ze[St].y,0,16),n(Ae,Ne-32,Ze[St].f,0,8),n(He,ot-32,Ze[St].ea,0,8)),lt.Za){var Ge=ve,xt=we-32+16;for(0<he&&(ae>=M.za-1?s(Ge,xt,Ze[St].y[15],4):n(Ge,xt,Ze[St+1].y,0,4)),Q=0;4>Q;Q++)Ge[xt+128+Q]=Ge[xt+256+Q]=Ge[xt+384+Q]=Ge[xt+0+Q];for(Q=0;16>Q;++Q,ze<<=2)Ge=ve,xt=we+Ay[Q],Ha[lt.Ob[Q]](Ge,xt),af(ze,pt,16*+Q,Ge,xt)}else if(Ge=gd(ae,he,lt.Ob[0]),No[Ge](ve,we),ze!=0)for(Q=0;16>Q;++Q,ze<<=2)af(ze,pt,16*+Q,ve,we+Ay[Q]);for(Q=lt.Gc,Ge=gd(ae,he,lt.Dd),zi[Ge](Ae,Ne),zi[Ge](He,ot),ze=pt,Ge=Ae,xt=Ne,255&(lt=Q>>0)&&(170&lt?hf(ze,256,Ge,xt):wa(ze,256,Ge,xt)),lt=He,ze=ot,255&(Q>>=8)&&(170&Q?hf(pt,320,lt,ze):wa(pt,320,lt,ze)),he<M.Ub-1&&(n(Ze[St].y,0,ve,we+480,16),n(Ze[St].f,0,Ae,Ne+224,8),n(Ze[St].ea,0,He,ot+224,8)),Q=8*ge*M.B,Ze=M.sa,St=M.ta+16*ae+16*ge*M.R,pt=M.qa,lt=M.ra+8*ae+Q,ze=M.Ha,Ge=M.Ia+8*ae+Q,Q=0;16>Q;++Q)n(Ze,St+Q*M.R,ve,we+32*Q,16);for(Q=0;8>Q;++Q)n(pt,lt+Q*M.B,Ae,Ne+32*Q,8),n(ze,Ge+Q*M.B,He,ot+32*Q,8)}}function kc(M,W,Q,ae,he,ge,ve,we,Ae){var Ne=[0],He=[0],ot=0,lt=Ae!=null?Ae.kd:0,Ze=Ae??new tf;if(M==null||12>Q)return 7;Ze.data=M,Ze.w=W,Ze.ha=Q,W=[W],Q=[Q],Ze.gb=[Ze.gb];e:{var St=W,pt=Q,ze=Ze.gb;if(r(M!=null),r(pt!=null),r(ze!=null),ze[0]=0,12<=pt[0]&&!e(M,St[0],"RIFF")){if(e(M,St[0]+8,"WEBP")){ze=3;break e}var Ge=ne(M,St[0]+4);if(12>Ge||4294967286<Ge){ze=3;break e}if(lt&&Ge>pt[0]-8){ze=7;break e}ze[0]=Ge,St[0]+=12,pt[0]-=12}ze=0}if(ze!=0)return ze;for(Ge=0<Ze.gb[0],Q=Q[0];;){e:{var xt=M;pt=W,ze=Q;var At=Ne,_t=He,Bt=St=[0];if((Ft=ot=[ot])[0]=0,8>ze[0])ze=7;else{if(!e(xt,pt[0],"VP8X")){if(ne(xt,pt[0]+4)!=10){ze=3;break e}if(18>ze[0]){ze=7;break e}var Mt=ne(xt,pt[0]+8),Yt=1+te(xt,pt[0]+12);if(2147483648<=Yt*(xt=1+te(xt,pt[0]+15))){ze=3;break e}Bt!=null&&(Bt[0]=Mt),At!=null&&(At[0]=Yt),_t!=null&&(_t[0]=xt),pt[0]+=18,ze[0]-=18,Ft[0]=1}ze=0}}if(ot=ot[0],St=St[0],ze!=0)return ze;if(pt=!!(2&St),!Ge&&ot)return 3;if(ge!=null&&(ge[0]=!!(16&St)),ve!=null&&(ve[0]=pt),we!=null&&(we[0]=0),ve=Ne[0],St=He[0],ot&&pt&&Ae==null){ze=0;break}if(4>Q){ze=7;break}if(Ge&&ot||!Ge&&!ot&&!e(M,W[0],"ALPH")){Q=[Q],Ze.na=[Ze.na],Ze.P=[Ze.P],Ze.Sa=[Ze.Sa];e:{Mt=M,ze=W,Ge=Q;var Ft=Ze.gb;At=Ze.na,_t=Ze.P,Bt=Ze.Sa,Yt=22,r(Mt!=null),r(Ge!=null),xt=ze[0];var Tr=Ge[0];for(r(At!=null),r(Bt!=null),At[0]=null,_t[0]=null,Bt[0]=0;;){if(ze[0]=xt,Ge[0]=Tr,8>Tr){ze=7;break e}var Rr=ne(Mt,xt+4);if(4294967286<Rr){ze=3;break e}var Er=8+Rr+1&-2;if(Yt+=Er,0<Ft&&Yt>Ft){ze=3;break e}if(!e(Mt,xt,"VP8 ")||!e(Mt,xt,"VP8L")){ze=0;break e}if(Tr[0]<Er){ze=7;break e}e(Mt,xt,"ALPH")||(At[0]=Mt,_t[0]=xt+8,Bt[0]=Rr),xt+=Er,Tr-=Er}}if(Q=Q[0],Ze.na=Ze.na[0],Ze.P=Ze.P[0],Ze.Sa=Ze.Sa[0],ze!=0)break}Q=[Q],Ze.Ja=[Ze.Ja],Ze.xa=[Ze.xa];e:if(Ft=M,ze=W,Ge=Q,At=Ze.gb[0],_t=Ze.Ja,Bt=Ze.xa,Mt=ze[0],xt=!e(Ft,Mt,"VP8 "),Yt=!e(Ft,Mt,"VP8L"),r(Ft!=null),r(Ge!=null),r(_t!=null),r(Bt!=null),8>Ge[0])ze=7;else{if(xt||Yt){if(Ft=ne(Ft,Mt+4),12<=At&&Ft>At-12){ze=3;break e}if(lt&&Ft>Ge[0]-8){ze=7;break e}_t[0]=Ft,ze[0]+=8,Ge[0]-=8,Bt[0]=Yt}else Bt[0]=5<=Ge[0]&&Ft[Mt+0]==47&&!(Ft[Mt+4]>>5),_t[0]=Ge[0];ze=0}if(Q=Q[0],Ze.Ja=Ze.Ja[0],Ze.xa=Ze.xa[0],W=W[0],ze!=0)break;if(4294967286<Ze.Ja)return 3;if(we==null||pt||(we[0]=Ze.xa?2:1),ve=[ve],St=[St],Ze.xa){if(5>Q){ze=7;break}we=ve,lt=St,pt=ge,M==null||5>Q?M=0:5<=Q&&M[W+0]==47&&!(M[W+4]>>5)?(Ge=[0],Ft=[0],At=[0],_(_t=new A,M,W,Q),yt(_t,Ge,Ft,At)?(we!=null&&(we[0]=Ge[0]),lt!=null&&(lt[0]=Ft[0]),pt!=null&&(pt[0]=At[0]),M=1):M=0):M=0}else{if(10>Q){ze=7;break}we=St,M==null||10>Q||!xr(M,W+3,Q-3)?M=0:(lt=M[W+0]|M[W+1]<<8|M[W+2]<<16,pt=16383&(M[W+7]<<8|M[W+6]),M=16383&(M[W+9]<<8|M[W+8]),1&lt||3<(lt>>1&7)||!(lt>>4&1)||lt>>5>=Ze.Ja||!pt||!M?M=0:(ve&&(ve[0]=pt),we&&(we[0]=M),M=1))}if(!M||(ve=ve[0],St=St[0],ot&&(Ne[0]!=ve||He[0]!=St)))return 3;Ae!=null&&(Ae[0]=Ze,Ae.offset=W-Ae.w,r(4294967286>W-Ae.w),r(Ae.offset==Ae.ha-Q));break}return ze==0||ze==7&&ot&&Ae==null?(ge!=null&&(ge[0]|=Ze.na!=null&&0<Ze.na.length),ae!=null&&(ae[0]=ve),he!=null&&(he[0]=St),0):ze}function lf(M,W,Q){var ae=W.width,he=W.height,ge=0,ve=0,we=ae,Ae=he;if(W.Da=M!=null&&0<M.Da,W.Da&&(we=M.cd,Ae=M.bd,ge=M.v,ve=M.j,11>Q||(ge&=-2,ve&=-2),0>ge||0>ve||0>=we||0>=Ae||ge+we>ae||ve+Ae>he))return 0;if(W.v=ge,W.j=ve,W.va=ge+we,W.o=ve+Ae,W.U=we,W.T=Ae,W.da=M!=null&&0<M.da,W.da){if(!Z(we,Ae,Q=[M.ib],ge=[M.hb]))return 0;W.ib=Q[0],W.hb=ge[0]}return W.ob=M!=null&&M.ob,W.Kb=M==null||!M.Sd,W.da&&(W.ob=W.ib<3*ae/4&&W.hb<3*he/4,W.Kb=0),1}function cf(M){if(M==null)return 2;if(11>M.S){var W=M.f.RGBA;W.fb+=(M.height-1)*W.A,W.A=-W.A}else W=M.f.kb,M=M.height,W.O+=(M-1)*W.fa,W.fa=-W.fa,W.N+=(M-1>>1)*W.Ab,W.Ab=-W.Ab,W.W+=(M-1>>1)*W.Db,W.Db=-W.Db,W.F!=null&&(W.J+=(M-1)*W.lb,W.lb=-W.lb);return 0}function Ec(M,W,Q,ae){if(ae==null||0>=M||0>=W)return 2;if(Q!=null){if(Q.Da){var he=Q.cd,ge=Q.bd,ve=-2&Q.v,we=-2&Q.j;if(0>ve||0>we||0>=he||0>=ge||ve+he>M||we+ge>W)return 2;M=he,W=ge}if(Q.da){if(!Z(M,W,he=[Q.ib],ge=[Q.hb]))return 2;M=he[0],W=ge[0]}}ae.width=M,ae.height=W;e:{var Ae=ae.width,Ne=ae.height;if(M=ae.S,0>=Ae||0>=Ne||!(M>=Sd&&13>M))M=2;else{if(0>=ae.Rd&&ae.sd==null){ve=ge=he=W=0;var He=(we=Ae*Cy[M])*Ne;if(11>M||(ge=(Ne+1)/2*(W=(Ae+1)/2),M==12&&(ve=(he=Ae)*Ne)),(Ne=a(He+2*ge+ve))==null){M=1;break e}ae.sd=Ne,11>M?((Ae=ae.f.RGBA).eb=Ne,Ae.fb=0,Ae.A=we,Ae.size=He):((Ae=ae.f.kb).y=Ne,Ae.O=0,Ae.fa=we,Ae.Fd=He,Ae.f=Ne,Ae.N=0+He,Ae.Ab=W,Ae.Cd=ge,Ae.ea=Ne,Ae.W=0+He+ge,Ae.Db=W,Ae.Ed=ge,M==12&&(Ae.F=Ne,Ae.J=0+He+2*ge),Ae.Tc=ve,Ae.lb=he)}if(W=1,he=ae.S,ge=ae.width,ve=ae.height,he>=Sd&&13>he)if(11>he)M=ae.f.RGBA,W&=(we=Math.abs(M.A))*(ve-1)+ge<=M.size,W&=we>=ge*Cy[he],W&=M.eb!=null;else{M=ae.f.kb,we=(ge+1)/2,He=(ve+1)/2,Ae=Math.abs(M.fa),Ne=Math.abs(M.Ab);var ot=Math.abs(M.Db),lt=Math.abs(M.lb),Ze=lt*(ve-1)+ge;W&=Ae*(ve-1)+ge<=M.Fd,W&=Ne*(He-1)+we<=M.Cd,W=(W&=ot*(He-1)+we<=M.Ed)&Ae>=ge&Ne>=we&ot>=we,W&=M.y!=null,W&=M.f!=null,W&=M.ea!=null,he==12&&(W&=lt>=ge,W&=Ze<=M.Tc,W&=M.F!=null)}else W=0;M=W?0:2}}return M!=0||Q!=null&&Q.fd&&(M=cf(ae)),M}var Gn=64,Ac=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Cc=24,Tc=32,uf=8,Ls=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ue("Predictor0","PredictorAdd0"),R.Predictor0=function(){return 4278190080},R.Predictor1=function(M){return M},R.Predictor2=function(M,W,Q){return W[Q+0]},R.Predictor3=function(M,W,Q){return W[Q+1]},R.Predictor4=function(M,W,Q){return W[Q-1]},R.Predictor5=function(M,W,Q){return fe(fe(M,W[Q+1]),W[Q+0])},R.Predictor6=function(M,W,Q){return fe(M,W[Q-1])},R.Predictor7=function(M,W,Q){return fe(M,W[Q+0])},R.Predictor8=function(M,W,Q){return fe(W[Q-1],W[Q+0])},R.Predictor9=function(M,W,Q){return fe(W[Q+0],W[Q+1])},R.Predictor10=function(M,W,Q){return fe(fe(M,W[Q-1]),fe(W[Q+0],W[Q+1]))},R.Predictor11=function(M,W,Q){var ae=W[Q+0];return 0>=Pe(ae>>24&255,M>>24&255,(W=W[Q-1])>>24&255)+Pe(ae>>16&255,M>>16&255,W>>16&255)+Pe(ae>>8&255,M>>8&255,W>>8&255)+Pe(255&ae,255&M,255&W)?ae:M},R.Predictor12=function(M,W,Q){var ae=W[Q+0];return(ye((M>>24&255)+(ae>>24&255)-((W=W[Q-1])>>24&255))<<24|ye((M>>16&255)+(ae>>16&255)-(W>>16&255))<<16|ye((M>>8&255)+(ae>>8&255)-(W>>8&255))<<8|ye((255&M)+(255&ae)-(255&W)))>>>0},R.Predictor13=function(M,W,Q){var ae=W[Q-1];return(Te((M=fe(M,W[Q+0]))>>24&255,ae>>24&255)<<24|Te(M>>16&255,ae>>16&255)<<16|Te(M>>8&255,ae>>8&255)<<8|Te(M>>0&255,ae>>0&255))>>>0};var Xm=R.PredictorAdd0;R.PredictorAdd1=je,ue("Predictor2","PredictorAdd2"),ue("Predictor3","PredictorAdd3"),ue("Predictor4","PredictorAdd4"),ue("Predictor5","PredictorAdd5"),ue("Predictor6","PredictorAdd6"),ue("Predictor7","PredictorAdd7"),ue("Predictor8","PredictorAdd8"),ue("Predictor9","PredictorAdd9"),ue("Predictor10","PredictorAdd10"),ue("Predictor11","PredictorAdd11"),ue("Predictor12","PredictorAdd12"),ue("Predictor13","PredictorAdd13");var ff=R.PredictorAdd2;Ye("ColorIndexInverseTransform","MapARGB","32b",function(M){return M>>8&255},function(M){return M}),Ye("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(M){return M},function(M){return M>>8&255});var vd,xa=R.ColorIndexInverseTransform,Nc=R.MapARGB,bd=R.VP8LColorIndexInverseTransformAlpha,yd=R.MapAlpha,Eo=R.VP8LPredictorsAdd=[];Eo.length=16,(R.VP8LPredictors=[]).length=16,(R.VP8LPredictorsAdd_C=[]).length=16,(R.VP8LPredictors_C=[]).length=16;var Dl,Is,Es,Ao,Bi,$i,Dc,Ui,fn,hf,As,wa,Rc,xd,df,Rl,Pl,Co,Ol,Pc,Ml,To,pf,_a,Sa,Br,$r,hn,Nn=a(511),Hi=a(2041),mf=a(225),Oc=a(767),wd=0,Km=Hi,_d=mf,ra=Oc,ka=Nn,Sd=0,kd=1,gy=2,Ed=3,Ad=4,Ym=5,vy=6,Jm=7,Zm=8,Cd=9,Qm=10,$k=[2,3,7],Uk=[3,3,11],by=[280,256,256,256,40],Hk=[0,1,1,1,0],zk=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Vk=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],qk=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Wk=8,e1=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],t1=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],gf=null,Gk=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Xk=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],yy=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Kk=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Yk=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Jk=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Zk=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],No=[],Ha=[],zi=[],Qk=1,xy=2,Do=[],Ea=[];vt("UpsampleRgbLinePair",wr,3),vt("UpsampleBgrLinePair",Jr,3),vt("UpsampleRgbaLinePair",Ua,4),vt("UpsampleBgraLinePair",jn,4),vt("UpsampleArgbLinePair",ns,4),vt("UpsampleRgba4444LinePair",xn,2),vt("UpsampleRgb565LinePair",tn,2);var e7=R.UpsampleRgbLinePair,t7=R.UpsampleBgrLinePair,wy=R.UpsampleRgbaLinePair,_y=R.UpsampleBgraLinePair,Sy=R.UpsampleArgbLinePair,ky=R.UpsampleRgba4444LinePair,r7=R.UpsampleRgb565LinePair,Td=16,Nd=1<<Td-1,vf=-227,r1=482,n7=6,Ey=0,s7=a(256),a7=a(256),i7=a(256),o7=a(256),l7=a(r1-vf),c7=a(r1-vf);di("YuvToRgbRow",wr,3),di("YuvToBgrRow",Jr,3),di("YuvToRgbaRow",Ua,4),di("YuvToBgraRow",jn,4),di("YuvToArgbRow",ns,4),di("YuvToRgba4444Row",xn,2),di("YuvToRgb565Row",tn,2);var Ay=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Dd=[0,2,8],u7=[8,7,6,4,4,2,2,2,1,1,1,1],f7=1;this.WebPDecodeRGBA=function(M,W,Q,ae,he){var ge=kd,ve=new _c,we=new wt;ve.ba=we,we.S=ge,we.width=[we.width],we.height=[we.height];var Ae=we.width,Ne=we.height,He=new gt;if(He==null||M==null)var ot=2;else r(He!=null),ot=kc(M,W,Q,He.width,He.height,He.Pd,He.Qd,He.format,null);if(ot!=0?Ae=0:(Ae!=null&&(Ae[0]=He.width[0]),Ne!=null&&(Ne[0]=He.height[0]),Ae=1),Ae){we.width=we.width[0],we.height=we.height[0],ae!=null&&(ae[0]=we.width),he!=null&&(he[0]=we.height);e:{if(ae=new Ht,(he=new tf).data=M,he.w=W,he.ha=Q,he.kd=1,W=[0],r(he!=null),((M=kc(he.data,he.w,he.ha,null,null,null,W,null,he))==0||M==7)&&W[0]&&(M=4),(W=M)==0){if(r(ve!=null),ae.data=he.data,ae.w=he.w+he.offset,ae.ha=he.ha-he.offset,ae.put=jt,ae.ac=Et,ae.bc=Ot,ae.ma=ve,he.xa){if((M=Ke())==null){ve=1;break e}if(function(lt,Ze){var St=[0],pt=[0],ze=[0];t:for(;;){if(lt==null)return 0;if(Ze==null)return lt.a=2,0;if(lt.l=Ze,lt.a=0,_(lt.m,Ze.data,Ze.w,Ze.ha),!yt(lt.m,St,pt,ze)){lt.a=3;break t}if(lt.xb=xy,Ze.width=St[0],Ze.height=pt[0],!Ue(St[0],pt[0],1,lt,null))break t;return 1}return r(lt.a!=0),0}(M,ae)){if(ae=(W=Ec(ae.width,ae.height,ve.Oa,ve.ba))==0){t:{ae=M;r:for(;;){if(ae==null){ae=0;break t}if(r(ae.s.yc!=null),r(ae.s.Ya!=null),r(0<ae.s.Wb),r((Q=ae.l)!=null),r((he=Q.ma)!=null),ae.xb!=0){if(ae.ca=he.ba,ae.tb=he.tb,r(ae.ca!=null),!lf(he.Oa,Q,Ed)){ae.a=2;break r}if(!Qe(ae,Q.width)||Q.da)break r;if((Q.da||Xe(ae.ca.S))&&st(),11>ae.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ae.ca.f.kb.F!=null&&st()),ae.Pb&&0<ae.s.ua&&ae.s.vb.X==null&&!le(ae.s.vb,ae.s.Wa.Xa)){ae.a=1;break r}ae.xb=0}if(!Ee(ae,ae.V,ae.Ba,ae.c,ae.i,Q.o,ke))break r;he.Dc=ae.Ma,ae=1;break t}r(ae.a!=0),ae=0}ae=!ae}ae&&(W=M.a)}else W=M.a}else{if((M=new ar)==null){ve=1;break e}if(M.Fa=he.na,M.P=he.P,M.qc=he.Sa,Fr(M,ae)){if((W=Ec(ae.width,ae.height,ve.Oa,ve.ba))==0){if(M.Aa=0,Q=ve.Oa,r((he=M)!=null),Q!=null){if(0<(Ae=0>(Ae=Q.Md)?0:100<Ae?255:255*Ae/100)){for(Ne=He=0;4>Ne;++Ne)12>(ot=he.pb[Ne]).lc&&(ot.ia=Ae*u7[0>ot.lc?0:ot.lc]>>3),He|=ot.ia;He&&(alert("todo:VP8InitRandom"),he.ia=1)}he.Ga=Q.Id,100<he.Ga?he.Ga=100:0>he.Ga&&(he.Ga=0)}_s(M,ae)||(W=M.a)}}else W=M.a}W==0&&ve.Oa!=null&&ve.Oa.fd&&(W=cf(ve.ba))}ve=W}ge=ve!=0?null:11>ge?we.f.RGBA.eb:we.f.kb.y}else ge=null;return ge};var Cy=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(R,B){for(var q="",V=0;V<4;V++)q+=String.fromCharCode(R[B++]);return q}function u(R,B){return(R[B+0]<<0|R[B+1]<<8|R[B+2]<<16)>>>0}function d(R,B){return(R[B+0]<<0|R[B+1]<<8|R[B+2]<<16|R[B+3]<<24)>>>0}new l;var h=[0],f=[0],g=[],m=new l,p=t,v=function(R,B){var q={},V=0,I=!1,C=0,O=0;if(q.frames=[],!function(H,z,K,j){for(var J=0;J<j;J++)if(H[z+J]!=K.charCodeAt(J))return!0;return!1}(R,B,"RIFF",4)){for(d(R,B+=4),B+=8;B<R.length;){var E=c(R,B),x=d(R,B+=4);B+=4;var w=x+(1&x);switch(E){case"VP8 ":case"VP8L":q.frames[V]===void 0&&(q.frames[V]={}),(T=q.frames[V]).src_off=I?O:B-8,T.src_size=C+x+8,V++,I&&(I=!1,C=0,O=0);break;case"VP8X":(T=q.header={}).feature_flags=R[B];var _=B+4;T.canvas_width=1+u(R,_),_+=3,T.canvas_height=1+u(R,_),_+=3;break;case"ALPH":I=!0,C=w+8,O=B-8;break;case"ANIM":(T=q.header).bgcolor=d(R,B),_=B+4,T.loop_count=(U=R)[(A=_)+0]<<0|U[A+1]<<8,_+=2;break;case"ANMF":var S,T;(T=q.frames[V]={}).offset_x=2*u(R,B),B+=3,T.offset_y=2*u(R,B),B+=3,T.width=1+u(R,B),B+=3,T.height=1+u(R,B),B+=3,T.duration=u(R,B),B+=3,S=R[B++],T.dispose=1&S,T.blend=S>>1&1}E!="ANMF"&&(B+=w)}var U,A;return q}}(p,0);v.response=p,v.rgbaoutput=!0,v.dataurl=!1;var b=v.header?v.header:null,y=v.frames?v.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],f=[b.canvas_width];for(var k=0;k<y.length&&y[k].blend!=0;k++);}var N=y[0],L=m.WebPDecodeRGBA(p,N.src_off,N.src_size,f,h);N.rgba=L,N.imgwidth=f[0],N.imgheight=h[0];for(var F=0;F<f[0]*h[0]*4;F++)g[F]=L[F];return this.width=f,this.height=h,this.data=g,this}(function(t){var r=function(){return typeof av=="function"},e=function(h,f,g,m){var p=4,v=i;switch(m){case t.image_compression.FAST:p=1,v=a;break;case t.image_compression.MEDIUM:p=6,v=o;break;case t.image_compression.SLOW:p=9,v=l}h=n(h,f,g,v);var b=av(h,{level:p});return t.__addimage__.arrayBufferToBinaryString(b)},n=function(h,f,g,m){for(var p,v,b,y=h.length/f,k=new Uint8Array(h.length+y),N=u(),L=0;L<y;L+=1){if(b=L*f,p=h.subarray(b,b+f),m)k.set(m(p,g,v),b+L);else{for(var F,R=N.length,B=[];F<R;F+=1)B[F]=N[F](p,g,v);var q=d(B.concat());k.set(B[q],b+L)}v=p}return k},s=function(h){var f=Array.apply([],h);return f.unshift(0),f},a=function(h,f){var g,m=[],p=h.length;m[0]=1;for(var v=0;v<p;v+=1)g=h[v-f]||0,m[v+1]=h[v]-g+256&255;return m},i=function(h,f,g){var m,p=[],v=h.length;p[0]=2;for(var b=0;b<v;b+=1)m=g&&g[b]||0,p[b+1]=h[b]-m+256&255;return p},o=function(h,f,g){var m,p,v=[],b=h.length;v[0]=3;for(var y=0;y<b;y+=1)m=h[y-f]||0,p=g&&g[y]||0,v[y+1]=h[y]+256-(m+p>>>1)&255;return v},l=function(h,f,g){var m,p,v,b,y=[],k=h.length;y[0]=4;for(var N=0;N<k;N+=1)m=h[N-f]||0,p=g&&g[N]||0,v=g&&g[N-f]||0,b=c(m,p,v),y[N+1]=h[N]-b+256&255;return y},c=function(h,f,g){if(h===f&&f===g)return h;var m=Math.abs(f-g),p=Math.abs(h-g),v=Math.abs(h+f-g-g);return m<=p&&m<=v?h:p<=v?f:g},u=function(){return[s,a,i,o,l]},d=function(h){var f=h.map(function(g){return g.reduce(function(m,p){return m+Math.abs(p)},0)});return f.indexOf(Math.min.apply(null,f))};t.processPNG=function(h,f,g,m){var p,v,b,y,k,N,L,F,R,B,q,V,I,C,O,E=this.decode.FLATE_DECODE,x="";if(this.__addimage__.isArrayBuffer(h)&&(h=new Uint8Array(h)),this.__addimage__.isArrayBufferView(h)){if(h=(b=new az(h)).imgData,v=b.bits,p=b.colorSpace,k=b.colors,[4,6].indexOf(b.colorType)!==-1){if(b.bits===8){R=(F=b.pixelBitlength==32?new Uint32Array(b.decodePixels().buffer):b.pixelBitlength==16?new Uint16Array(b.decodePixels().buffer):new Uint8Array(b.decodePixels().buffer)).length,q=new Uint8Array(R*b.colors),B=new Uint8Array(R);var w,_=b.pixelBitlength-b.bits;for(C=0,O=0;C<R;C++){for(I=F[C],w=0;w<_;)q[O++]=I>>>w&255,w+=b.bits;B[C]=I>>>w&255}}if(b.bits===16){R=(F=new Uint32Array(b.decodePixels().buffer)).length,q=new Uint8Array(R*(32/b.pixelBitlength)*b.colors),B=new Uint8Array(R*(32/b.pixelBitlength)),V=b.colors>1,C=0,O=0;for(var S=0;C<R;)I=F[C++],q[O++]=I>>>0&255,V&&(q[O++]=I>>>16&255,I=F[C++],q[O++]=I>>>0&255),B[S++]=I>>>16&255;v=8}m!==t.image_compression.NONE&&r()?(h=e(q,b.width*b.colors,b.colors,m),L=e(B,b.width,1,m)):(h=q,L=B,E=void 0)}if(b.colorType===3&&(p=this.color_spaces.INDEXED,N=b.palette,b.transparency.indexed)){var T=b.transparency.indexed,U=0;for(C=0,R=T.length;C<R;++C)U+=T[C];if((U/=255)===R-1&&T.indexOf(0)!==-1)y=[T.indexOf(0)];else if(U!==R){for(F=b.decodePixels(),B=new Uint8Array(F.length),C=0,R=F.length;C<R;C++)B[C]=T[F[C]];L=e(B,b.width,1)}}var A=function(H){var z;switch(H){case t.image_compression.FAST:z=11;break;case t.image_compression.MEDIUM:z=13;break;case t.image_compression.SLOW:z=14;break;default:z=12}return z}(m);return E===this.decode.FLATE_DECODE&&(x="/Predictor "+A+" "),x+="/Colors "+k+" /BitsPerComponent "+v+" /Columns "+b.width,(this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),(L&&this.__addimage__.isArrayBuffer(L)||this.__addimage__.isArrayBufferView(L))&&(L=this.__addimage__.arrayBufferToBinaryString(L)),{alias:g,data:h,index:f,filter:E,decodeParameters:x,transparency:y,palette:N,sMask:L,predictor:A,width:b.width,height:b.height,bitsPerComponent:v,colorSpace:p}}}})(Zt.API),function(t){t.processGIF89A=function(r,e,n,s){var a=new iz(r),i=a.width,o=a.height,l=[];a.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:i,height:o},u=new yg(100).encode(c,100);return t.processJPEG.call(this,u,e,n,s)},t.processGIF87A=t.processGIF89A}(Zt.API),Xa.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var r=0;r<t;r++){var e=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:s,green:n,blue:e,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Xa.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[t]()}catch(e){Ir.log("bit decode error:"+e)}},Xa.prototype.bit1=function(){var t,r=Math.ceil(this.width/8),e=r%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<r;s++)for(var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*s*4,o=0;o<8&&8*s+o<this.width;o++){var l=this.palette[a>>7-o&1];this.data[i+4*o]=l.blue,this.data[i+4*o+1]=l.green,this.data[i+4*o+2]=l.red,this.data[i+4*o+3]=255}e!==0&&(this.pos+=4-e)}},Xa.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),r=t%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++){var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*s*4,o=a>>4,l=15&a,c=this.palette[o];if(this.data[i]=c.blue,this.data[i+1]=c.green,this.data[i+2]=c.red,this.data[i+3]=255,2*s+1>=this.width)break;c=this.palette[l],this.data[i+4]=c.blue,this.data[i+4+1]=c.green,this.data[i+4+2]=c.red,this.data[i+4+3]=255}r!==0&&(this.pos+=4-r)}},Xa.prototype.bit8=function(){for(var t=this.width%4,r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*n;if(s<this.palette.length){var i=this.palette[s];this.data[a]=i.red,this.data[a+1]=i.green,this.data[a+2]=i.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},Xa.prototype.bit15=function(){for(var t=this.width%3,r=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(a&r)/r*255|0,o=(a>>5&r)/r*255|0,l=(a>>10&r)/r*255|0,c=a>>15?255:0,u=n*this.width*4+4*s;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=i,this.data[u+3]=c}this.pos+=t}},Xa.prototype.bit16=function(){for(var t=this.width%3,r=parseInt("11111",2),e=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&r)/r*255|0,l=(i>>5&e)/e*255|0,c=(i>>11)/r*255|0,u=s*this.width*4+4*a;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=t}},Xa.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*e;this.data[i]=a,this.data[i+1]=s,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},Xa.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var r=this.bottom_up?t:this.height-1-t,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*e;this.data[o]=a,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=i}},Xa.prototype.getData=function(){return this.data},function(t){t.processBMP=function(r,e,n,s){var a=new Xa(r,!1),i=a.width,o=a.height,l={data:a.getData(),width:i,height:o},c=new yg(100).encode(l,100);return t.processJPEG.call(this,c,e,n,s)}}(Zt.API),E3.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(r,e,n,s){var a=new E3(r),i=a.width,o=a.height,l={data:a.getData(),width:i,height:o},c=new yg(100).encode(l,100);return t.processJPEG.call(this,c,e,n,s)}}(Zt.API),Zt.API.processRGBA=function(t,r,e){for(var n=t.data,s=n.length,a=new Uint8Array(s/4*3),i=new Uint8Array(s/4),o=0,l=0,c=0;c<s;c+=4){var u=n[c],d=n[c+1],h=n[c+2],f=n[c+3];a[o++]=u,a[o++]=d,a[o++]=h,i[l++]=f}var g=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:g,index:r,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Zt.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Wc=Zt.API,T0=Wc.getCharWidthsArray=function(t,r){var e,n,s=(r=r||{}).font||this.internal.getFont(),a=r.fontSize||this.internal.getFontSize(),i=r.charSpace||this.internal.getCharSpace(),o=r.widths?r.widths:s.metadata.Unicode.widths,l=o.fof?o.fof:1,c=r.kerning?r.kerning:s.metadata.Unicode.kerning,u=c.fof?c.fof:1,d=r.doKerning!==!1,h=0,f=t.length,g=0,m=o[0]||l,p=[];for(e=0;e<f;e++)n=t.charCodeAt(e),typeof s.metadata.widthOfString=="function"?p.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+i*(1e3/a)||0)/1e3):(h=d&&kr(c[n])==="object"&&!isNaN(parseInt(c[n][g],10))?c[n][g]/u:0,p.push((o[n]||m)/l+h)),g=n;return p},w3=Wc.getStringUnitWidth=function(t,r){var e=(r=r||{}).fontSize||this.internal.getFontSize(),n=r.font||this.internal.getFont(),s=r.charSpace||this.internal.getCharSpace();return Wc.processArabic&&(t=Wc.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,e,s)/e:T0.apply(this,arguments).reduce(function(a,i){return a+i},0)},_3=function(t,r,e,n){for(var s=[],a=0,i=t.length,o=0;a!==i&&o+r[a]<e;)o+=r[a],a++;s.push(t.slice(0,a));var l=a;for(o=0;a!==i;)o+r[a]>n&&(s.push(t.slice(l,a)),o=0,l=a),o+=r[a],a++;return l!==a&&s.push(t.slice(l,a)),s},S3=function(t,r,e){e||(e={});var n,s,a,i,o,l,c,u=[],d=[u],h=e.textIndent||0,f=0,g=0,m=t.split(" "),p=T0.apply(this,[" ",e])[0];if(l=e.lineIndent===-1?m[0].length+2:e.lineIndent||0){var v=Array(l).join(" "),b=[];m.map(function(k){(k=k.split(/\s*\n/)).length>1?b=b.concat(k.map(function(N,L){return(L&&N.length?`
`:"")+N})):b.push(k[0])}),m=b,l=w3.apply(this,[v,e])}for(a=0,i=m.length;a<i;a++){var y=0;if(n=m[a],l&&n[0]==`
`&&(n=n.substr(1),y=1),h+f+(g=(s=T0.apply(this,[n,e])).reduce(function(k,N){return k+N},0))>r||y){if(g>r){for(o=_3.apply(this,[n,s,r-(h+f),r]),u.push(o.shift()),u=[o.pop()];o.length;)d.push([o.shift()]);g=s.slice(n.length-(u[0]?u[0].length:0)).reduce(function(k,N){return k+N},0)}else u=[n];d.push(u),h=g+l,f=p}else u.push(n),h+=f+g,f=p}return c=l?function(k,N){return(N?v:"")+k.join(" ")}:function(k){return k.join(" ")},d.map(c)},Wc.splitTextToSize=function(t,r,e){var n,s=(e=e||{}).fontSize||this.internal.getFontSize(),a=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var d=this.internal.getFont(u.fontName,u.fontStyle);return d.metadata.Unicode?{widths:d.metadata.Unicode.widths||{0:1},kerning:d.metadata.Unicode.kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var i=1*this.internal.scaleFactor*r/s;a.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/s:0,a.lineIndent=e.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(S3.apply(this,[n[o],i,a]));return c},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var r="klmnopqrstuvwxyz",e={},n={},s=0;s<r.length;s++)e[r[s]]="0123456789abcdef"[s],n["0123456789abcdef"[s]]=r[s];var a=function(d){return"0x"+parseInt(d,10).toString(16)},i=t.__fontmetrics__.compress=function(d){var h,f,g,m,p=["{"];for(var v in d){if(h=d[v],isNaN(parseInt(v,10))?f="'"+v+"'":(v=parseInt(v,10),f=(f=a(v).slice(2)).slice(0,-1)+n[f.slice(-1)]),typeof h=="number")h<0?(g=a(h).slice(3),m="-"):(g=a(h).slice(2),m=""),g=m+g.slice(0,-1)+n[g.slice(-1)];else{if(kr(h)!=="object")throw new Error("Don't know what to do with value type "+kr(h)+".");g=i(h)}p.push(f+g)}return p.push("}"),p.join("")},o=t.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,f,g,m,p={},v=1,b=p,y=[],k="",N="",L=d.length-1,F=1;F<L;F+=1)(m=d[F])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(m):m=="{"?(y.push([b,g]),b={},g=void 0):m=="}"?((f=y.pop())[0][f[1]]=b,g=void 0,b=f[0]):m=="-"?v=-1:g===void 0?e.hasOwnProperty(m)?(k+=e[m],g=parseInt(k,16)*v,v=1,k=""):k+=m:e.hasOwnProperty(m)?(N+=e[m],b[g]=parseInt(N,16)*v,v=1,g=void 0,N=""):N+=m;return p},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(d){var h=d.font,f=u.Unicode[h.postScriptName];f&&(h.metadata.Unicode={},h.metadata.Unicode.widths=f.widths,h.metadata.Unicode.kerning=f.kerning);var g=c.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])}(Zt.API),function(t){var r=function(e){for(var n=e.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=e.charCodeAt(a);return s};t.API.events.push(["addFont",function(e){var n=void 0,s=e.font,a=e.instance;if(!s.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=a.existsFileInVFS(s.postScriptName)===!1?a.loadFile(s.postScriptName):a.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(i,o){o=/^\x00\x01\x00\x00/.test(o)?r(o):r(dh(o)),i.metadata=t.API.TTFFont.open(o),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(s,n)}}])}(Zt),function(t){function r(){return(er.canvg?Promise.resolve(er.canvg):Ma(()=>import("./index.es-Cz2nrpPa.js"),[])).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}Zt.API.addSvgAsImage=function(e,n,s,a,i,o,l,c){if(isNaN(n)||isNaN(s))throw Ir.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(i))throw Ir.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=a,u.height=i;var d=u.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,u.width,u.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return r().then(function(g){return g.fromString(d,e,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(h)}).then(function(){f.addImage(u.toDataURL("image/jpeg",1),n,s,a,i,l,c)})}}(),Zt.API.putTotalPages=function(t){var r,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(t,"g"),e=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(r,e);return this},Zt.API.viewerPreferences=function(t,r){var e;t=t||{},r=r||!1;var n,s,a,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(i),l=[],c=0,u=0,d=0;function h(g,m){var p,v=!1;for(p=0;p<g.length;p+=1)g[p]===m&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,t==="reset"||r===!0){var f=o.length;for(d=0;d<f;d+=1)e[o[d]].value=e[o[d]].defaultValue,e[o[d]].explicitSet=!1}if(kr(t)==="object"){for(s in t)if(a=t[s],h(o,s)&&a!==void 0){if(e[s].type==="boolean"&&typeof a=="boolean")e[s].value=a;else if(e[s].type==="name"&&h(e[s].valueSet,a))e[s].value=a;else if(e[s].type==="integer"&&Number.isInteger(a))e[s].value=a;else if(e[s].type==="array"){for(c=0;c<a.length;c+=1)if(n=!0,a[c].length===1&&typeof a[c][0]=="number")l.push(String(a[c]-1));else if(a[c].length>1){for(u=0;u<a[c].length;u+=1)typeof a[c][u]!="number"&&(n=!1);n===!0&&l.push([a[c][0]-1,a[c][1]-1].join(" "))}e[s].value="["+l.join(" ")+"]"}else e[s].value=e[s].defaultValue;e[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,m=[];for(g in e)e[g].explicitSet===!0&&(e[g].type==="name"?m.push("/"+g+" /"+e[g].value):m.push("/"+g+" "+e[g].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},function(t){var r=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=a.length+i.length+o.length+s.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(s+a+i+o+l),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",r)),this}}(Zt.API),function(t){var r=t.API,e=r.pdfEscape16=function(a,i){for(var o,l=i.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],d=0,h=a.length;d<h;++d){if(o=i.metadata.characterToGlyph(a.charCodeAt(d)),i.metadata.glyIdsUsed.push(o),i.metadata.toUnicode[o]=a.charCodeAt(d),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(i.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},n=function(a){var i,o,l,c,u,d,h;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],d=0,h=(o=Object.keys(a).sort(function(f,g){return f-g})).length;d<h;d++)i=o[d],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),a[i]!==void 0&&a[i]!==null&&typeof a[i].toString=="function"&&(c=("0000"+a[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),l.push("<"+i+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(a){(function(i){var o=i.font,l=i.out,c=i.newObject,u=i.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,h=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),f="",g=0;g<h.length;g++)f+=String.fromCharCode(h[g]);var m=c();u({data:f,addLength1:!0,objectId:m}),l("endobj");var p=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:p}),l("endobj");var v=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Yc(o.fontName)),l("/FontFile2 "+m+" 0 R"),l("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var b=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+Yc(o.fontName)),l("/FontDescriptor "+v+" 0 R"),l("/W "+t.API.PDFObject.convert(d)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+p+" 0 R"),l("/BaseFont /"+Yc(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+b+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]),r.events.push(["putFont",function(a){(function(i){var o=i.font,l=i.out,c=i.newObject,u=i.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,h="",f=0;f<d.length;f++)h+=String.fromCharCode(d[f]);var g=c();u({data:h,addLength1:!0,objectId:g}),l("endobj");var m=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:m}),l("endobj");var p=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+g+" 0 R"),l("/Flags 96"),l("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Yc(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var v=0;v<o.metadata.hmtx.widths.length;v++)o.metadata.hmtx.widths[v]=parseInt(o.metadata.hmtx.widths[v]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+Yc(o.fontName)+"/FontDescriptor "+p+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]);var s=function(a){var i,o=a.text||"",l=a.x,c=a.y,u=a.options||{},d=a.mutex||{},h=d.pdfEscape,f=d.activeFontKey,g=d.fonts,m=f,p="",v=0,b="",y=g[m].encoding;if(g[m].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:d};for(b=o,m=f,Array.isArray(o)&&(b=o[0]),v=0;v<b.length;v+=1)g[m].metadata.hasOwnProperty("cmap")&&(i=g[m].metadata.cmap.unicode.codeMap[b[v].charCodeAt(0)]),i||b[v].charCodeAt(0)<256&&g[m].metadata.hasOwnProperty("Unicode")?p+=b[v]:p+="";var k="";return parseInt(m.slice(1))<14||y==="WinAnsiEncoding"?k=h(p,m).split("").map(function(N){return N.charCodeAt(0).toString(16)}).join(""):y==="Identity-H"&&(k=e(p,g[m])),d.isHex=!0,{text:k,x:l,y:c,options:u,mutex:d}};r.events.push(["postProcessText",function(a){var i=a.text||"",o=[],l={text:i,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(i)){var c=0;for(c=0;c<i.length;c+=1)Array.isArray(i[c])&&i[c].length===3?o.push([s(Object.assign({},l,{text:i[c][0]})).text,i[c][1],i[c][2]]):o.push(s(Object.assign({},l,{text:i[c]})).text);a.text=o}else a.text=s(Object.assign({},l,{text:i})).text}])}(Zt),function(t){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(e){return r.call(this),this.internal.vFS[e]!==void 0},t.addFileToVFS=function(e,n){return r.call(this),this.internal.vFS[e]=n,this},t.getFileFromVFS=function(e){return r.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}}(Zt.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var s,a,i,o,l,c,u,d=r,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},p=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,y=0;this.__bidiEngine__={};var k=function(V){var I=V.charCodeAt(),C=I>>8,O=m[C];return O!==void 0?d[256*O+(255&I)]:C===252||C===253?"AL":v.test(C)?"L":C===8?"R":"N"},N=function(V){for(var I,C=0;C<V.length;C++){if((I=k(V.charAt(C)))==="L")return!1;if(I==="R")return!0}return!1},L=function(V,I,C,O){var E,x,w,_,S=I[O];switch(S){case"L":case"R":b=!1;break;case"N":case"AN":break;case"EN":b&&(S="AN");break;case"AL":b=!0,S="R";break;case"WS":S="N";break;case"CS":O<1||O+1>=I.length||(E=C[O-1])!=="EN"&&E!=="AN"||(x=I[O+1])!=="EN"&&x!=="AN"?S="N":b&&(x="AN"),S=x===E?x:"N";break;case"ES":S=(E=O>0?C[O-1]:"B")==="EN"&&O+1<I.length&&I[O+1]==="EN"?"EN":"N";break;case"ET":if(O>0&&C[O-1]==="EN"){S="EN";break}if(b){S="N";break}for(w=O+1,_=I.length;w<_&&I[w]==="ET";)w++;S=w<_&&I[w]==="EN"?"EN":"N";break;case"NSM":if(i&&!o){for(_=I.length,w=O+1;w<_&&I[w]==="NSM";)w++;if(w<_){var T=V[O],U=T>=1425&&T<=2303||T===64286;if(E=I[w],U&&(E==="R"||E==="AL")){S="R";break}}}S=O<1||(E=I[O-1])==="B"?"N":C[O-1];break;case"B":b=!1,s=!0,S=y;break;case"S":a=!0,S="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"BN":S="N"}return S},F=function(V,I,C){var O=V.split("");return C&&R(O,C,{hiLevel:y}),O.reverse(),I&&I.reverse(),O.join("")},R=function(V,I,C){var O,E,x,w,_,S=-1,T=V.length,U=0,A=[],H=y?f:h,z=[];for(b=!1,s=!1,a=!1,E=0;E<T;E++)z[E]=k(V[E]);for(x=0;x<T;x++){if(_=U,A[x]=L(V,z,A,x),O=240&(U=H[_][g[A[x]]]),U&=15,I[x]=w=H[U][5],O>0)if(O===16){for(E=S;E<x;E++)I[E]=1;S=-1}else S=-1;if(H[U][6])S===-1&&(S=x);else if(S>-1){for(E=S;E<x;E++)I[E]=w;S=-1}z[x]==="B"&&(I[x]=0),C.hiLevel|=w}a&&function(K,j,J){for(var P=0;P<J;P++)if(K[P]==="S"){j[P]=y;for(var D=P-1;D>=0&&K[D]==="WS";D--)j[D]=y}}(z,I,T)},B=function(V,I,C,O,E){if(!(E.hiLevel<V)){if(V===1&&y===1&&!s)return I.reverse(),void(C&&C.reverse());for(var x,w,_,S,T=I.length,U=0;U<T;){if(O[U]>=V){for(_=U+1;_<T&&O[_]>=V;)_++;for(S=U,w=_-1;S<w;S++,w--)x=I[S],I[S]=I[w],I[w]=x,C&&(x=C[S],C[S]=C[w],C[w]=x);U=_}U++}}},q=function(V,I,C){var O=V.split(""),E={hiLevel:y};return C||(C=[]),R(O,C,E),function(x,w,_){if(_.hiLevel!==0&&u)for(var S,T=0;T<x.length;T++)w[T]===1&&(S=p.indexOf(x[T]))>=0&&(x[T]=p[S+1])}(O,C,E),B(2,O,I,C,E),B(1,O,I,C,E),O.join("")};return this.__bidiEngine__.doBidiReorder=function(V,I,C){if(function(E,x){if(x)for(var w=0;w<E.length;w++)x[w]=w;o===void 0&&(o=N(E)),c===void 0&&(c=N(E))}(V,I),i||!l||c)if(i&&l&&o^c)y=o?1:0,V=F(V,I,C);else if(!i&&l&&c)y=o?1:0,V=q(V,I,C),V=F(V,I);else if(!i||o||l||c){if(i&&!l&&o^c)V=F(V,I),o?(y=0,V=q(V,I,C)):(y=1,V=q(V,I,C),V=F(V,I));else if(i&&o&&!l&&c)y=1,V=q(V,I,C),V=F(V,I);else if(!i&&!l&&o^c){var O=u;o?(y=1,V=q(V,I,C),y=0,u=!1,V=q(V,I,C),u=O):(y=0,V=q(V,I,C),V=F(V,I),y=1,u=!1,V=q(V,I,C),u=O,V=F(V,I))}}else y=0,V=q(V,I,C);else y=o?1:0,V=q(V,I,C);return V},this.__bidiEngine__.setOptions=function(V){V&&(i=V.isInputVisual,l=V.isOutputVisual,o=V.isInputRtl,c=V.isOutputRtl,u=V.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var i=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,e.setOptions(a),Object.prototype.toString.call(s)==="[object Array]"){var o=0;for(i=[],o=0;o<s.length;o+=1)Object.prototype.toString.call(s[o])==="[object Array]"?i.push([e.doBidiReorder(s[o][0]),s[o][1],s[o][2]]):i.push([e.doBidiReorder(s[o])]);n.text=i}else n.text=e.doBidiReorder(s);e.setOptions({isInputVisual:!0})}])}(Zt),Zt.API.TTFFont=function(){function t(r){var e;if(this.rawData=r,e=this.contents=new yl(r),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new wz(this),this.registerTTF()}return t.open=function(r){return new t(r)},t.prototype.parse=function(){return this.directory=new oz(this.contents),this.head=new cz(this),this.name=new pz(this),this.cmap=new Ak(this),this.toUnicode={},this.hhea=new uz(this),this.maxp=new mz(this),this.hmtx=new gz(this),this.post=new hz(this),this.os2=new fz(this),this.loca=new xz(this),this.glyf=new vz(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var r,e,n,s,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var i,o,l,c;for(c=[],i=0,o=(l=this.bbox).length;i<o;i++)r=l[i],c.push(Math.round(r*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(e=s>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(r){var e;return((e=this.cmap.unicode)!=null?e.codeMap[r]:void 0)||0},t.prototype.widthOfGlyph=function(r){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*e},t.prototype.widthOfString=function(r,e,n){var s,a,i,o;for(i=0,a=0,o=(r=""+r).length;0<=o?a<o:a>o;a=0<=o?++a:--a)s=r.charCodeAt(a),i+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/e)||0;return i*(e/1e3)},t.prototype.lineHeight=function(r,e){var n;return e==null&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*r},t}();var ui,yl=function(){function t(r){this.data=r??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(r){return this.data[this.pos++]=r},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},t.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},t.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},t.prototype.readString=function(r){var e,n;for(n=[],e=0;0<=r?e<r:e>r;e=0<=r?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(r){var e,n,s;for(s=[],e=0,n=r.length;0<=n?e<n:e>n;e=0<=n?++e:--e)s.push(this.writeByte(r.charCodeAt(e)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(r){return this.writeInt16(r)},t.prototype.readLongLong=function(){var r,e,n,s,a,i,o,l;return r=this.readByte(),e=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^a)+65536*(255^i)+256*(255^o)+(255^l)+1):72057594037927940*r+281474976710656*e+1099511627776*n+4294967296*s+16777216*a+65536*i+256*o+l},t.prototype.writeLongLong=function(r){var e,n;return e=Math.floor(r/4294967296),n=4294967295&r,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(r){return this.writeInt32(r)},t.prototype.read=function(r){var e,n;for(e=[],n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)e.push(this.readByte());return e},t.prototype.write=function(r){var e,n,s,a;for(a=[],n=0,s=r.length;n<s;n++)e=r[n],a.push(this.writeByte(e));return a},t}(),oz=function(){var t;function r(e){var n,s,a;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},s=0,a=this.tableCount;0<=a?s<a:s>a;s=0<=a?++s:--s)n={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[n.tag]=n}return r.prototype.encode=function(e){var n,s,a,i,o,l,c,u,d,h,f,g,m;for(m in f=Object.keys(e).length,l=Math.log(2),d=16*Math.floor(Math.log(f)/l),i=Math.floor(d/l),u=16*f-d,(s=new yl).writeInt(this.scalarType),s.writeShort(f),s.writeShort(d),s.writeShort(i),s.writeShort(u),a=16*f,c=s.pos+a,o=null,g=[],e)for(h=e[m],s.writeString(m),s.writeInt(t(h)),s.writeInt(c),s.writeInt(h.length),g=g.concat(h),m==="head"&&(o=c),c+=h.length;c%4;)g.push(0),c++;return s.write(g),n=2981146554-t(s.data),s.pos=o+8,s.writeUInt32(n),s.data},t=function(e){var n,s,a,i;for(e=Ck.call(e);e.length%4;)e.push(0);for(a=new yl(e),s=0,n=0,i=e.length;n<i;n=n+=4)s+=a.readUInt32();return 4294967295&s},r}(),lz={}.hasOwnProperty,Pi=function(t,r){for(var e in r)lz.call(r,e)&&(t[e]=r[e]);function n(){this.constructor=t}return n.prototype=r.prototype,t.prototype=new n,t.__super__=r.prototype,t};ui=function(){function t(r){var e;this.file=r,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var cz=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return Pi(r,ui),r.prototype.tag="head",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},r.prototype.encode=function(e){var n;return(n=new yl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},r}(),A3=function(){function t(r,e){var n,s,a,i,o,l,c,u,d,h,f,g,m,p,v,b,y;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=e+r.readInt(),d=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=r.readByte();break;case 4:for(f=r.readUInt16(),h=f/2,r.pos+=6,a=function(){var k,N;for(N=[],l=k=0;0<=h?k<h:k>h;l=0<=h?++k:--k)N.push(r.readUInt16());return N}(),r.pos+=2,m=function(){var k,N;for(N=[],l=k=0;0<=h?k<h:k>h;l=0<=h?++k:--k)N.push(r.readUInt16());return N}(),c=function(){var k,N;for(N=[],l=k=0;0<=h?k<h:k>h;l=0<=h?++k:--k)N.push(r.readUInt16());return N}(),u=function(){var k,N;for(N=[],l=k=0;0<=h?k<h:k>h;l=0<=h?++k:--k)N.push(r.readUInt16());return N}(),s=(this.length-r.pos+this.offset)/2,o=function(){var k,N;for(N=[],l=k=0;0<=s?k<s:k>s;l=0<=s?++k:--k)N.push(r.readUInt16());return N}(),l=v=0,y=a.length;v<y;l=++v)for(p=a[l],n=b=g=m[l];g<=p?b<=p:b>=p;n=g<=p?++b:--b)u[l]===0?i=n+c[l]:(i=o[u[l]/2+(n-g)-(h-l)]||0)!==0&&(i+=c[l]),this.codeMap[n]=65535&i}r.pos=d}return t.encode=function(r,e){var n,s,a,i,o,l,c,u,d,h,f,g,m,p,v,b,y,k,N,L,F,R,B,q,V,I,C,O,E,x,w,_,S,T,U,A,H,z,K,j,J,P,D,G,re,te;switch(O=new yl,i=Object.keys(r).sort(function(ne,le){return ne-le}),e){case"macroman":for(m=0,p=function(){var ne=[];for(g=0;g<256;++g)ne.push(0);return ne}(),b={0:0},a={},E=0,S=i.length;E<S;E++)b[D=r[s=i[E]]]==null&&(b[D]=++m),a[s]={old:r[s],new:b[r[s]]},p[s]=b[r[s]];return O.writeUInt16(1),O.writeUInt16(0),O.writeUInt32(12),O.writeUInt16(0),O.writeUInt16(262),O.writeUInt16(0),O.write(p),{charMap:a,subtable:O.data,maxGlyphID:m+1};case"unicode":for(I=[],d=[],y=0,b={},n={},v=c=null,x=0,T=i.length;x<T;x++)b[N=r[s=i[x]]]==null&&(b[N]=++y),n[s]={old:N,new:b[N]},o=b[N]-s,v!=null&&o===c||(v&&d.push(v),I.push(s),c=o),v=s;for(v&&d.push(v),d.push(65535),I.push(65535),q=2*(B=I.length),R=2*Math.pow(Math.log(B)/Math.LN2,2),h=Math.log(R/2)/Math.LN2,F=2*B-R,l=[],L=[],f=[],g=w=0,U=I.length;w<U;g=++w){if(V=I[g],u=d[g],V===65535){l.push(0),L.push(0);break}if(V-(C=n[V].new)>=32768)for(l.push(0),L.push(2*(f.length+B-g)),s=_=V;V<=u?_<=u:_>=u;s=V<=u?++_:--_)f.push(n[s].new);else l.push(C-V),L.push(0)}for(O.writeUInt16(3),O.writeUInt16(1),O.writeUInt32(12),O.writeUInt16(4),O.writeUInt16(16+8*B+2*f.length),O.writeUInt16(0),O.writeUInt16(q),O.writeUInt16(R),O.writeUInt16(h),O.writeUInt16(F),J=0,A=d.length;J<A;J++)s=d[J],O.writeUInt16(s);for(O.writeUInt16(0),P=0,H=I.length;P<H;P++)s=I[P],O.writeUInt16(s);for(G=0,z=l.length;G<z;G++)o=l[G],O.writeUInt16(o);for(re=0,K=L.length;re<K;re++)k=L[re],O.writeUInt16(k);for(te=0,j=f.length;te<j;te++)m=f[te],O.writeUInt16(m);return{charMap:n,subtable:O.data,maxGlyphID:y+1}}},t}(),Ak=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return Pi(r,ui),r.prototype.tag="cmap",r.prototype.parse=function(e){var n,s,a;for(e.pos=this.offset,this.version=e.readUInt16(),a=e.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)n=new A3(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},r.encode=function(e,n){var s,a;return n==null&&(n="macroman"),s=A3.encode(e,n),(a=new yl).writeUInt16(0),a.writeUInt16(1),s.table=a.data.concat(s.subtable),s},r}(),uz=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return Pi(r,ui),r.prototype.tag="hhea",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},r}(),fz=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return Pi(r,ui),r.prototype.tag="OS/2",r.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,s;for(s=[],n=0;n<10;++n)s.push(e.readByte());return s}(),this.charRange=function(){var n,s;for(s=[],n=0;n<4;++n)s.push(e.readInt());return s}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,s;for(s=[],n=0;n<2;n=++n)s.push(e.readInt());return s}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},r}(),hz=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return Pi(r,ui),r.prototype.tag="post",r.prototype.parse=function(e){var n,s,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:break;case 131072:var i;for(s=e.readUInt16(),this.glyphNameIndex=[],i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],a=[];e.pos<this.offset+this.length;)n=e.readByte(),a.push(this.names.push(e.readString(n)));return a;case 151552:return s=e.readUInt16(),this.offsets=e.read(s);case 196608:break;case 262144:return this.map=(function(){var o,l,c;for(c=[],i=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;i=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},r}(),dz=function(t,r){this.raw=t,this.length=t.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},pz=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return Pi(r,ui),r.prototype.tag="name",r.prototype.parse=function(e){var n,s,a,i,o,l,c,u,d,h,f;for(e.pos=this.offset,e.readShort(),n=e.readShort(),l=e.readShort(),s=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)s.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},i=d=0,h=s.length;d<h;i=++d)a=s[i],e.pos=a.offset,u=e.readString(a.length),o=new dz(u,a),c[f=a.nameID]==null&&(c[f]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},r}(),mz=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return Pi(r,ui),r.prototype.tag="maxp",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},r}(),gz=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return Pi(r,ui),r.prototype.tag="hmtx",r.prototype.parse=function(e){var n,s,a,i,o,l,c;for(e.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],n=u=0;0<=a?u<a:u>a;n=0<=a?++u:--u)d.push(e.readInt16());return d}(),this.widths=(function(){var u,d,h,f;for(f=[],u=0,d=(h=this.metrics).length;u<d;u++)i=h[u],f.push(i.advance);return f}).call(this),s=this.widths[this.widths.length-1],c=[],n=o=0;0<=a?o<a:o>a;n=0<=a?++o:--o)c.push(this.widths.push(s));return c},r.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},r}(),Ck=[].slice,vz=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return Pi(r,ui),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(e){var n,s,a,i,o,l,c,u,d,h;return e in this.cache?this.cache[e]:(i=this.file.loca,n=this.file.contents,s=i.indexOf(e),(a=i.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+s,o=(l=new yl(n.read(a))).readShort(),u=l.readShort(),h=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[e]=o===-1?new yz(l,u,h,c,d):new bz(l,o,u,h,c,d),this.cache[e]))},r.prototype.encode=function(e,n,s){var a,i,o,l,c;for(o=[],i=[],l=0,c=n.length;l<c;l++)a=e[n[l]],i.push(o.length),a&&(o=o.concat(a.encode(s)));return i.push(o.length),{table:o,offsets:i}},r}(),bz=function(){function t(r,e,n,s,a,i){this.raw=r,this.numberOfContours=e,this.xMin=n,this.yMin=s,this.xMax=a,this.yMax=i,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),yz=function(){function t(r,e,n,s,a){var i,o;for(this.raw=r,this.xMin=e,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;o=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&o;)i.pos+=1&o?4:2,128&o?i.pos+=8:64&o?i.pos+=4:8&o&&(i.pos+=2)}return t.prototype.encode=function(){var r,e,n;for(e=new yl(Ck.call(this.raw.data)),r=0,n=this.glyphIDs.length;r<n;++r)e.pos=this.glyphOffsets[r];return e.data},t}(),xz=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return Pi(r,ui),r.prototype.tag="loca",r.prototype.parse=function(e){var n,s;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var a,i;for(i=[],s=0,a=this.length;s<a;s+=2)i.push(2*e.readUInt16());return i}).call(this):(function(){var a,i;for(i=[],s=0,a=this.length;s<a;s+=4)i.push(e.readUInt32());return i}).call(this)},r.prototype.indexOf=function(e){return this.offsets[e]},r.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},r.prototype.encode=function(e,n){for(var s=new Uint32Array(this.offsets.length),a=0,i=0,o=0;o<s.length;++o)if(s[o]=a,i<n.length&&n[i]==o){++i,s[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var u=new Array(4*s.length),d=0;d<s.length;++d)u[4*d+3]=255&s[d],u[4*d+2]=(65280&s[d])>>8,u[4*d+1]=(16711680&s[d])>>16,u[4*d]=(4278190080&s[d])>>24;return u},r}(),wz=function(){function t(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var r,e,n,s,a;for(e in s=this.font.cmap.tables[0].codeMap,r={},a=this.subset)n=a[e],r[e]=s[n];return r},t.prototype.glyphsFor=function(r){var e,n,s,a,i,o,l;for(s={},i=0,o=r.length;i<o;i++)s[a=r[i]]=this.font.glyf.glyphFor(a);for(a in e=[],s)(n=s[a])!=null&&n.compound&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(a in l=this.glyphsFor(e))n=l[a],s[a]=n;return s},t.prototype.encode=function(r,e){var n,s,a,i,o,l,c,u,d,h,f,g,m,p,v;for(s in n=Ak.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(r),f={0:0},v=n.charMap)f[(l=v[s]).old]=l.new;for(g in h=n.maxGlyphID,i)g in f||(f[g]=h++);return u=function(b){var y,k;for(y in k={},b)k[b[y]]=y;return k}(f),d=Object.keys(u).sort(function(b,y){return b-y}),m=function(){var b,y,k;for(k=[],b=0,y=d.length;b<y;b++)o=d[b],k.push(u[o]);return k}(),a=this.font.glyf.encode(i,m,f),c=this.font.loca.encode(a.offsets,m),p={cmap:this.font.cmap.raw(),glyf:a.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(p["OS/2"]=this.font.os2.raw()),this.font.directory.encode(p)},t}();Zt.API.PDFObject=function(){var t;function r(){}return t=function(e,n){return(Array(n+1).join("0")+e).slice(-n)},r.convert=function(e){var n,s,a,i;if(Array.isArray(e))return"["+function(){var o,l,c;for(c=[],o=0,l=e.length;o<l;o++)n=e[o],c.push(r.convert(n));return c}().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e!=null&&e.isString)return"("+e+")";if(e instanceof Date)return"(D:"+t(e.getUTCFullYear(),4)+t(e.getUTCMonth(),2)+t(e.getUTCDate(),2)+t(e.getUTCHours(),2)+t(e.getUTCMinutes(),2)+t(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(s in a=["<<"],e)i=e[s],a.push("/"+s+" "+r.convert(i));return a.push(">>"),a.join(`
`)}return""+e},r}();function Tk(t,r,e,n,s){n=n||{};var a=1.15,i=s.internal.scaleFactor,o=s.internal.getFontSize()/i,l=s.getLineHeightFactor?s.getLineHeightFactor():a,c=o*l,u=/\r\n|\r|\n/g,d="",h=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(d=typeof t=="string"?t.split(u):t,h=d.length||1),e+=o*(2-a),n.valign==="middle"?e-=h/2*c:n.valign==="bottom"&&(e-=h*c),n.halign==="center"||n.halign==="right"){var f=o;if(n.halign==="center"&&(f*=.5),d&&h>=1){for(var g=0;g<d.length;g++)s.text(d[g],r-s.getStringUnitWidth(d[g])*f,e),e+=c;return s}r-=s.getStringUnitWidth(t)*f}return n.halign==="justify"?s.text(t,r,e,{maxWidth:n.maxWidth||100,align:"justify"}):s.text(t,r,e),s}var C3={},Eu=function(){function t(r){this.jsPDFDocument=r,this.userStyles={textColor:r.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:r.internal.getFontSize(),fontStyle:r.internal.getFont().fontStyle,font:r.internal.getFont().fontName,lineWidth:r.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:r.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(r,e){e===void 0&&(e=null),e?e.__autoTableDocumentDefaults=r:C3=r},t.unifyColor=function(r){return Array.isArray(r)?r:typeof r=="number"?[r,r,r]:typeof r=="string"?[r]:null},t.prototype.applyStyles=function(r,e){var n,s,a;e===void 0&&(e=!1),r.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(r.fontStyle);var i=this.jsPDFDocument.internal.getFont(),o=i.fontStyle,l=i.fontName;if(r.font&&(l=r.font),r.fontStyle){o=r.fontStyle;var c=this.getFontList()[l];c&&c.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),o=c[0])}if(this.jsPDFDocument.setFont(l,o),r.fontSize&&this.jsPDFDocument.setFontSize(r.fontSize),!e){var u=t.unifyColor(r.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=t.unifyColor(r.textColor),u&&(s=this.jsPDFDocument).setTextColor.apply(s,u),u=t.unifyColor(r.lineColor),u&&(a=this.jsPDFDocument).setDrawColor.apply(a,u),typeof r.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(r.lineWidth)}},t.prototype.splitTextToSize=function(r,e,n){return this.jsPDFDocument.splitTextToSize(r,e,n)},t.prototype.rect=function(r,e,n,s,a){return this.jsPDFDocument.rect(r,e,n,s,a)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(r){return this.jsPDFDocument.getTextWidth(r)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(r){this.jsPDFDocument.setPage(r)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return C3||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var r=this.jsPDFDocument.internal.pageSize;return r.width==null&&(r={width:r.getWidth(),height:r.getHeight()}),r},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var r=this.jsPDFDocument;return r.getLineHeightFactor?r.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(r){return r/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var r=this.jsPDFDocument.internal.getCurrentPageInfo();return r?r.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),hv=function(t,r){return hv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])},hv(t,r)};function Nk(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");hv(t,r);function e(){this.constructor=t}t.prototype=r===null?Object.create(r):(e.prototype=r.prototype,new e)}var Dk=function(t){Nk(r,t);function r(e){var n=t.call(this)||this;return n._element=e,n}return r}(Array);function _z(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Sz(t){var r={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return r[t]}function zp(t,r,e){e.applyStyles(r,!0);var n=Array.isArray(t)?t:[t],s=n.map(function(a){return e.getTextWidth(a)}).reduce(function(a,i){return Math.max(a,i)},0);return s}function Rk(t,r,e,n){var s=r.settings.tableLineWidth,a=r.settings.tableLineColor;t.applyStyles({lineWidth:s,lineColor:a});var i=Pk(s,!1);i&&t.rect(e.x,e.y,r.getWidth(t.pageSize().width),n.y-e.y,i)}function Pk(t,r){var e=t>0,n=r||r===0;return e&&n?"DF":e?"S":n?"F":null}function Im(t,r){var e,n,s,a;if(t=t||r,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=r}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(e=t.left)!==null&&e!==void 0?e:r,top:(n=t.top)!==null&&n!==void 0?n:r,right:(s=t.right)!==null&&s!==void 0?s:r,bottom:(a=t.bottom)!==null&&a!==void 0?a:r}):(typeof t!="number"&&(t=r),{top:t,right:t,bottom:t,left:t})}function Ok(t,r){var e=Im(r.settings.margin,0);return t.pageSize().width-(e.left+e.right)}function kz(t,r,e,n,s){var a={},i=1.3333333333333333,o=xg(r,function(y){return s.getComputedStyle(y).backgroundColor});o!=null&&(a.fillColor=o);var l=xg(r,function(y){return s.getComputedStyle(y).color});l!=null&&(a.textColor=l);var c=Az(n,e);c&&(a.cellPadding=c);var u="borderTopColor",d=i*e,h=n.borderTopWidth;if(n.borderBottomWidth===h&&n.borderRightWidth===h&&n.borderLeftWidth===h){var f=(parseFloat(h)||0)/d;f&&(a.lineWidth=f)}else a.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/d,right:(parseFloat(n.borderRightWidth)||0)/d,bottom:(parseFloat(n.borderBottomWidth)||0)/d,left:(parseFloat(n.borderLeftWidth)||0)/d},a.lineWidth.top||(a.lineWidth.right?u="borderRightColor":a.lineWidth.bottom?u="borderBottomColor":a.lineWidth.left&&(u="borderLeftColor"));var g=xg(r,function(y){return s.getComputedStyle(y)[u]});g!=null&&(a.lineColor=g);var m=["left","right","center","justify"];m.indexOf(n.textAlign)!==-1&&(a.halign=n.textAlign),m=["middle","bottom","top"],m.indexOf(n.verticalAlign)!==-1&&(a.valign=n.verticalAlign);var p=parseInt(n.fontSize||"");isNaN(p)||(a.fontSize=p/i);var v=Ez(n);v&&(a.fontStyle=v);var b=(n.fontFamily||"").toLowerCase();return t.indexOf(b)!==-1&&(a.font=b),a}function Ez(t){var r="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(r="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(r+="italic"),r}function xg(t,r){var e=Mk(t,r);if(!e)return null;var n=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var s=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],a=parseInt(n[4]);return a===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function Mk(t,r){var e=r(t);return e==="rgba(0, 0, 0, 0)"||e==="transparent"||e==="initial"||e==="inherit"?t.parentElement==null?null:Mk(t.parentElement,r):e}function Az(t,r){var e=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/r),s=(parseInt(t.lineHeight)-parseInt(t.fontSize))/r/2,a=e.map(function(o){return parseInt(o||"0")/n}),i=Im(a,0);return s>i.top&&(i.top=s),s>i.bottom&&(i.bottom=s),i}function Fk(t,r,e,n,s){var a,i;n===void 0&&(n=!1),s===void 0&&(s=!1);var o;typeof r=="string"?o=e.document.querySelector(r):o=r;var l=Object.keys(t.getFontList()),c=t.scaleFactor(),u=[],d=[],h=[];if(!o)return console.error("Html table could not be found with input: ",r),{head:u,body:d,foot:h};for(var f=0;f<o.rows.length;f++){var g=o.rows[f],m=(i=(a=g==null?void 0:g.parentElement)===null||a===void 0?void 0:a.tagName)===null||i===void 0?void 0:i.toLowerCase(),p=Cz(l,c,e,g,n,s);p&&(m==="thead"?u.push(p):m==="tfoot"?h.push(p):d.push(p))}return{head:u,body:d,foot:h}}function Cz(t,r,e,n,s,a){for(var i=new Dk(n),o=0;o<n.cells.length;o++){var l=n.cells[o],c=e.getComputedStyle(l);if(s||c.display!=="none"){var u=void 0;a&&(u=kz(t,l,r,c,e)),i.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:u,_element:l,content:Tz(l)})}}var d=e.getComputedStyle(n);if(i.length>0&&(s||d.display!=="none"))return i}function Tz(t){var r=t.cloneNode(!0);return r.innerHTML=r.innerHTML.replace(/\n/g,"").replace(/ +/g," "),r.innerHTML=r.innerHTML.split(/<br.*?>/).map(function(e){return e.trim()}).join(`
`),r.innerText||r.textContent||""}function Nz(t,r,e){for(var n=0,s=[t,r,e];n<s.length;n++){var a=s[n];a&&typeof a!="object"&&console.error("The options parameter should be of type object, is: "+typeof a),a.startY&&typeof a.startY!="number"&&(console.error("Invalid value for startY option",a.startY),delete a.startY)}}function eo(t,r,e,n,s){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(t),i=1;i<arguments.length;i++){var o=arguments[i];if(o!=null)for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])}return a}function Dz(t,r){var e=new Eu(t),n=e.getDocumentOptions(),s=e.getGlobalOptions();Nz(s,n,r);var a=eo({},s,n,r),i;typeof window<"u"&&(i=window);var o=Rz(s,n,r),l=Pz(s,n,r),c=Oz(e,a),u=Fz(e,a,i);return{id:r.tableId,content:u,hooks:l,styles:o,settings:c}}function Rz(t,r,e){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(l){if(l==="columnStyles"){var c=t[l],u=r[l],d=e[l];n.columnStyles=eo({},c,u,d)}else{var h=[t,r,e],f=h.map(function(g){return g[l]||{}});n[l]=eo({},f[0],f[1],f[2])}},a=0,i=Object.keys(n);a<i.length;a++){var o=i[a];s(o)}return n}function Pz(t,r,e){for(var n=[t,r,e],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,i=n;a<i.length;a++){var o=i[a];o.didParseCell&&s.didParseCell.push(o.didParseCell),o.willDrawCell&&s.willDrawCell.push(o.willDrawCell),o.didDrawCell&&s.didDrawCell.push(o.didDrawCell),o.willDrawPage&&s.willDrawPage.push(o.willDrawPage),o.didDrawPage&&s.didDrawPage.push(o.didDrawPage)}return s}function Oz(t,r){var e,n,s,a,i,o,l,c,u,d,h,f,g=Im(r.margin,40/t.scaleFactor()),m=(e=Mz(t,r.startY))!==null&&e!==void 0?e:g.top,p;r.showFoot===!0?p="everyPage":r.showFoot===!1?p="never":p=(n=r.showFoot)!==null&&n!==void 0?n:"everyPage";var v;r.showHead===!0?v="everyPage":r.showHead===!1?v="never":v=(s=r.showHead)!==null&&s!==void 0?s:"everyPage";var b=(a=r.useCss)!==null&&a!==void 0?a:!1,y=r.theme||(b?"plain":"striped"),k=!!r.horizontalPageBreak,N=(i=r.horizontalPageBreakRepeat)!==null&&i!==void 0?i:null;return{includeHiddenHtml:(o=r.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:b,theme:y,startY:m,margin:g,pageBreak:(l=r.pageBreak)!==null&&l!==void 0?l:"auto",rowPageBreak:(c=r.rowPageBreak)!==null&&c!==void 0?c:"auto",tableWidth:(u=r.tableWidth)!==null&&u!==void 0?u:"auto",showHead:v,showFoot:p,tableLineWidth:(d=r.tableLineWidth)!==null&&d!==void 0?d:0,tableLineColor:(h=r.tableLineColor)!==null&&h!==void 0?h:200,horizontalPageBreak:k,horizontalPageBreakRepeat:N,horizontalPageBreakBehaviour:(f=r.horizontalPageBreakBehaviour)!==null&&f!==void 0?f:"afterAllRows"}}function Mz(t,r){var e=t.getLastAutoTable(),n=t.scaleFactor(),s=t.pageNumber(),a=!1;if(e&&e.startPageNumber){var i=e.startPageNumber+e.pageNumber-1;a=i===s}return typeof r=="number"?r:(r==null||r===!1)&&a&&(e==null?void 0:e.finalY)!=null?e.finalY+20/n:null}function Fz(t,r,e){var n=r.head||[],s=r.body||[],a=r.foot||[];if(r.html){var i=r.includeHiddenHtml;if(e){var o=Fk(t,r.html,e,i,r.useCss)||{};n=o.head||n,s=o.body||n,a=o.foot||n}else console.error("Cannot parse html in non browser environment")}var l=r.columns||jz(n,s,a);return{columns:l,head:n,body:s,foot:a}}function jz(t,r,e){var n=t[0]||r[0]||e[0]||[],s=[];return Object.keys(n).filter(function(a){return a!=="_element"}).forEach(function(a){var i=1,o;Array.isArray(n)?o=n[parseInt(a)]:o=n[a],typeof o=="object"&&!Array.isArray(o)&&(i=(o==null?void 0:o.colSpan)||1);for(var l=0;l<i;l++){var c=void 0;Array.isArray(n)?c=s.length:c=a+(l>0?"_".concat(l):"");var u={dataKey:c};s.push(u)}}),s}var dv=function(){function t(r,e,n){this.table=e,this.pageNumber=e.pageNumber,this.settings=e.settings,this.cursor=n,this.doc=r.getDocument()}return t}(),Lz=function(t){Nk(r,t);function r(e,n,s,a,i,o){var l=t.call(this,e,n,o)||this;return l.cell=s,l.row=a,l.column=i,l.section=a.section,l}return r}(dv),Iz=function(){function t(r,e){this.pageNumber=1,this.id=r.id,this.settings=r.settings,this.styles=r.styles,this.hooks=r.hooks,this.columns=e.columns,this.head=e.head,this.body=e.body,this.foot=e.foot}return t.prototype.getHeadHeight=function(r){return this.head.reduce(function(e,n){return e+n.getMaxCellHeight(r)},0)},t.prototype.getFootHeight=function(r){return this.foot.reduce(function(e,n){return e+n.getMaxCellHeight(r)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(r,e,n,s,a,i){for(var o=0,l=e;o<l.length;o++){var c=l[o],u=new Lz(r,this,n,s,a,i),d=c(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],d)return!1}return!0},t.prototype.callEndPageHooks=function(r,e){r.applyStyles(r.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var a=s[n];a(new dv(r,this,e))}},t.prototype.callWillDrawPageHooks=function(r,e){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var a=s[n];a(new dv(r,this,e))}},t.prototype.getWidth=function(r){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var e=this.columns.reduce(function(s,a){return s+a.wrappedWidth},0);return e}else{var n=this.settings.margin;return r-n.left-n.right}},t}(),jk=function(){function t(r,e,n,s,a){a===void 0&&(a=!1),this.height=0,this.raw=r,r instanceof Dk&&(this.raw=r._element,this.element=r._element),this.index=e,this.section=n,this.cells=s,this.spansMultiplePages=a}return t.prototype.getMaxCellHeight=function(r){var e=this;return r.reduce(function(n,s){var a;return Math.max(n,((a=e.cells[s.index])===null||a===void 0?void 0:a.height)||0)},0)},t.prototype.hasRowSpan=function(r){var e=this;return r.filter(function(n){var s=e.cells[n.index];return s?s.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(r,e){return this.getMaxCellHeight(e)<=r},t.prototype.getMinimumRowHeight=function(r,e){var n=this;return r.reduce(function(s,a){var i=n.cells[a.index];if(!i)return 0;var o=e.getLineHeight(i.styles.fontSize),l=i.padding("vertical"),c=l+o;return c>s?c:s},0)},t}(),Lk=function(){function t(r,e,n){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=e,this.section=n,this.raw=r;var a=r;r!=null&&typeof r=="object"&&!Array.isArray(r)?(this.rowSpan=r.rowSpan||1,this.colSpan=r.colSpan||1,a=(s=r.content)!==null&&s!==void 0?s:r,r._element&&(this.raw=r._element)):(this.rowSpan=1,this.colSpan=1);var i=a!=null?""+a:"",o=/\r\n|\r|\n/g;this.text=i.split(o)}return t.prototype.getTextPos=function(){var r;if(this.styles.valign==="top")r=this.y+this.padding("top");else if(this.styles.valign==="bottom")r=this.y+this.height-this.padding("bottom");else{var e=this.height-this.padding("vertical");r=this.y+e/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:r}},t.prototype.getContentHeight=function(r,e){e===void 0&&(e=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/r*e,a=n*s+this.padding("vertical");return Math.max(a,this.styles.minCellHeight)},t.prototype.padding=function(r){var e=Im(this.styles.cellPadding,0);return r==="vertical"?e.top+e.bottom:r==="horizontal"?e.left+e.right:e[r]},t}(),Bz=function(){function t(r,e,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=r,this.raw=e,this.index=n}return t.prototype.getMaxCustomCellWidth=function(r){for(var e=0,n=0,s=r.allRows();n<s.length;n++){var a=s[n],i=a.cells[this.index];i&&typeof i.styles.cellWidth=="number"&&(e=Math.max(e,i.styles.cellWidth))}return e},t}();function $z(t,r){Uz(t,r);var e=[],n=0;r.columns.forEach(function(a){var i=a.getMaxCustomCellWidth(r);i?a.width=i:(a.width=a.wrappedWidth,e.push(a)),n+=a.width});var s=r.getWidth(t.pageSize().width)-n;s&&(s=pv(e,s,function(a){return Math.max(a.minReadableWidth,a.minWidth)})),s&&(s=pv(e,s,function(a){return a.minWidth})),s=Math.abs(s),!r.settings.horizontalPageBreak&&s>.1/t.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),zz(r),Vz(r,t),Hz(r)}function Uz(t,r){var e=t.scaleFactor(),n=r.settings.horizontalPageBreak,s=Ok(t,r);r.allRows().forEach(function(a){for(var i=0,o=r.columns;i<o.length;i++){var l=o[i],c=a.cells[l.index];if(c){var u=r.hooks.didParseCell;r.callCellHooks(t,u,c,a,l,null);var d=c.padding("horizontal");c.contentWidth=zp(c.text,c.styles,t)+d;var h=zp(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,t);if(c.minReadableWidth=h+c.padding("horizontal"),typeof c.styles.cellWidth=="number")c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if(c.styles.cellWidth==="wrap"||n===!0)c.contentWidth>s?(c.minWidth=s,c.wrappedWidth=s):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var f=10/e;c.minWidth=c.styles.minCellWidth||f,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}}),r.allRows().forEach(function(a){for(var i=0,o=r.columns;i<o.length;i++){var l=o[i],c=a.cells[l.index];if(c&&c.colSpan===1)l.wrappedWidth=Math.max(l.wrappedWidth,c.wrappedWidth),l.minWidth=Math.max(l.minWidth,c.minWidth),l.minReadableWidth=Math.max(l.minReadableWidth,c.minReadableWidth);else{var u=r.styles.columnStyles[l.dataKey]||r.styles.columnStyles[l.index]||{},d=u.cellWidth||u.minCellWidth;d&&typeof d=="number"&&(l.minWidth=d,l.wrappedWidth=d)}c&&(c.colSpan>1&&!l.minWidth&&(l.minWidth=c.minWidth),c.colSpan>1&&!l.wrappedWidth&&(l.wrappedWidth=c.minWidth))}})}function pv(t,r,e){for(var n=r,s=t.reduce(function(f,g){return f+g.wrappedWidth},0),a=0;a<t.length;a++){var i=t[a],o=i.wrappedWidth/s,l=n*o,c=i.width+l,u=e(i),d=c<u?u:c;r-=d-i.width,i.width=d}if(r=Math.round(r*1e10)/1e10,r){var h=t.filter(function(f){return r<0?f.width>e(f):!0});h.length&&(r=pv(h,r,e))}return r}function Hz(t){for(var r={},e=1,n=t.allRows(),s=0;s<n.length;s++)for(var a=n[s],i=0,o=t.columns;i<o.length;i++){var l=o[i],c=r[l.index];if(e>1)e--,delete a.cells[l.index];else if(c)c.cell.height+=a.height,e=c.cell.colSpan,delete a.cells[l.index],c.left--,c.left<=1&&delete r[l.index];else{var u=a.cells[l.index];if(!u)continue;if(u.height=a.height,u.rowSpan>1){var d=n.length-s,h=u.rowSpan>d?d:u.rowSpan;r[l.index]={cell:u,left:h,row:a}}}}}function zz(t){for(var r=t.allRows(),e=0;e<r.length;e++)for(var n=r[e],s=null,a=0,i=0,o=0;o<t.columns.length;o++){var l=t.columns[o];if(i-=1,i>1&&t.columns[o+1])a+=l.width,delete n.cells[l.index];else if(s){var c=s;delete n.cells[l.index],s=null,c.width=l.width+a}else{var c=n.cells[l.index];if(!c)continue;if(i=c.colSpan,a=0,c.colSpan>1){s=c,a+=l.width;continue}c.width=l.width+a}}}function Vz(t,r){for(var e={count:0,height:0},n=0,s=t.allRows();n<s.length;n++){for(var a=s[n],i=0,o=t.columns;i<o.length;i++){var l=o[i],c=a.cells[l.index];if(c){r.applyStyles(c.styles,!0);var u=c.width-c.padding("horizontal");if(c.styles.overflow==="linebreak")c.text=r.splitTextToSize(c.text,u+1/r.scaleFactor(),{fontSize:c.styles.fontSize});else if(c.styles.overflow==="ellipsize")c.text=T3(c.text,u,c.styles,r,"...");else if(c.styles.overflow==="hidden")c.text=T3(c.text,u,c.styles,r,"");else if(typeof c.styles.overflow=="function"){var d=c.styles.overflow(c.text,u);typeof d=="string"?c.text=[d]:c.text=d}c.contentHeight=c.getContentHeight(r.scaleFactor(),r.getLineHeightFactor());var h=c.contentHeight/c.rowSpan;c.rowSpan>1&&e.count*e.height<h*c.rowSpan?e={height:h,count:c.rowSpan}:e&&e.count>0&&e.height>h&&(h=e.height),h>a.height&&(a.height=h)}}e.count--}}function T3(t,r,e,n,s){return t.map(function(a){return qz(a,r,e,n,s)})}function qz(t,r,e,n,s){var a=1e4*n.scaleFactor();if(r=Math.ceil(r*a)/a,r>=zp(t,e,n))return t;for(;r<zp(t+s,e,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+s}function Wz(t,r){var e=new Eu(t),n=Gz(r,e.scaleFactor()),s=new Iz(r,n);return $z(e,s),e.applyStyles(e.userStyles),s}function Gz(t,r){var e=t.content,n=Kz(e.columns);if(e.head.length===0){var s=N3(n,"head");s&&e.head.push(s)}if(e.foot.length===0){var s=N3(n,"foot");s&&e.foot.push(s)}var a=t.settings.theme,i=t.styles;return{columns:n,head:wg("head",e.head,n,i,a,r),body:wg("body",e.body,n,i,a,r),foot:wg("foot",e.foot,n,i,a,r)}}function wg(t,r,e,n,s,a){var i={},o=r.map(function(l,c){for(var u=0,d={},h=0,f=0,g=0,m=e;g<m.length;g++){var p=m[g];if(i[p.index]==null||i[p.index].left===0)if(f===0){var v=void 0;Array.isArray(l)?v=l[p.index-h-u]:v=l[p.dataKey];var b={};typeof v=="object"&&!Array.isArray(v)&&(b=(v==null?void 0:v.styles)||{});var y=Yz(t,p,c,s,n,a,b),k=new Lk(v,y,t);d[p.dataKey]=k,d[p.index]=k,f=k.colSpan-1,i[p.index]={left:k.rowSpan-1,times:f}}else f--,h++;else i[p.index].left--,f=i[p.index].times,u++}return new jk(l,c,t,d)});return o}function N3(t,r){var e={};return t.forEach(function(n){if(n.raw!=null){var s=Xz(r,n.raw);s!=null&&(e[n.dataKey]=s)}}),Object.keys(e).length>0?e:null}function Xz(t,r){if(t==="head"){if(typeof r=="object")return r.header||null;if(typeof r=="string"||typeof r=="number")return r}else if(t==="foot"&&typeof r=="object")return r.footer;return null}function Kz(t){return t.map(function(r,e){var n,s;return typeof r=="object"?s=(n=r.dataKey)!==null&&n!==void 0?n:e:s=e,new Bz(s,r,e)})}function Yz(t,r,e,n,s,a,i){var o=Sz(n),l;t==="head"?l=s.headStyles:t==="body"?l=s.bodyStyles:t==="foot"&&(l=s.footStyles);var c=eo({},o.table,o[t],s.styles,l),u=s.columnStyles[r.dataKey]||s.columnStyles[r.index]||{},d=t==="body"?u:{},h=t==="body"&&e%2===0?eo({},o.alternateRow,s.alternateRowStyles):{},f=_z(a),g=eo({},f,c,h,d);return eo(g,i)}function Jz(t,r,e){var n;e===void 0&&(e={});var s=Ok(t,r),a=new Map,i=[],o=[],l=[];Array.isArray(r.settings.horizontalPageBreakRepeat)?l=r.settings.horizontalPageBreakRepeat:(typeof r.settings.horizontalPageBreakRepeat=="string"||typeof r.settings.horizontalPageBreakRepeat=="number")&&(l=[r.settings.horizontalPageBreakRepeat]),l.forEach(function(h){var f=r.columns.find(function(g){return g.dataKey===h||g.index===h});f&&!a.has(f.index)&&(a.set(f.index,!0),i.push(f.index),o.push(r.columns[f.index]),s-=f.wrappedWidth)});for(var c=!0,u=(n=e==null?void 0:e.start)!==null&&n!==void 0?n:0;u<r.columns.length;){if(a.has(u)){u++;continue}var d=r.columns[u].wrappedWidth;if(c||s>=d)c=!1,i.push(u),o.push(r.columns[u]),s-=d;else break;u++}return{colIndexes:i,columns:o,lastIndex:u-1}}function Zz(t,r){for(var e=[],n=0;n<r.columns.length;n++){var s=Jz(t,r,{start:n});s.columns.length&&(e.push(s),n=s.lastIndex)}return e}function Qz(t,r){var e=r.settings,n=e.startY,s=e.margin,a={x:s.left,y:n},i=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns),o=n+s.bottom+i;if(e.pageBreak==="avoid"){var l=r.body,c=l.reduce(function(h,f){return h+f.height},0);o+=c}var u=new Eu(t);(e.pageBreak==="always"||e.startY!=null&&o>u.pageSize().height)&&(Bk(u),a.y=s.top),r.callWillDrawPageHooks(u,a);var d=eo({},a);r.startPageNumber=u.pageNumber(),e.horizontalPageBreak?eV(u,r,d,a):(u.applyStyles(u.userStyles),(e.showHead==="firstPage"||e.showHead==="everyPage")&&r.head.forEach(function(h){return fo(u,r,h,a,r.columns)}),u.applyStyles(u.userStyles),r.body.forEach(function(h,f){var g=f===r.body.length-1;Vp(u,r,h,g,d,a,r.columns)}),u.applyStyles(u.userStyles),(e.showFoot==="lastPage"||e.showFoot==="everyPage")&&r.foot.forEach(function(h){return fo(u,r,h,a,r.columns)})),Rk(u,r,d,a),r.callEndPageHooks(u,a),r.finalY=a.y,t.lastAutoTable=r,u.applyStyles(u.userStyles)}function eV(t,r,e,n){var s=Zz(t,r),a=r.settings;if(a.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(c,u){t.applyStyles(t.userStyles),u>0?ph(t,r,e,n,c.columns,!0):D3(t,r,n,c.columns),tV(t,r,e,n,c.columns),_g(t,r,n,c.columns)});else for(var i=-1,o=s[0],l=function(){var c=i;if(o){t.applyStyles(t.userStyles);var u=o.columns;i>=0?ph(t,r,e,n,u,!0):D3(t,r,n,u),c=R3(t,r,i+1,n,u),_g(t,r,n,u)}var d=c-i;s.slice(1).forEach(function(h){t.applyStyles(t.userStyles),ph(t,r,e,n,h.columns,!0),R3(t,r,i+1,n,h.columns,d),_g(t,r,n,h.columns)}),i=c};i<r.body.length-1;)l()}function D3(t,r,e,n){var s=r.settings;t.applyStyles(t.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&r.head.forEach(function(a){return fo(t,r,a,e,n)})}function tV(t,r,e,n,s){t.applyStyles(t.userStyles),r.body.forEach(function(a,i){var o=i===r.body.length-1;Vp(t,r,a,o,e,n,s)})}function R3(t,r,e,n,s,a){t.applyStyles(t.userStyles),a=a??r.body.length;var i=Math.min(e+a,r.body.length),o=-1;return r.body.slice(e,i).forEach(function(l,c){var u=e+c===r.body.length-1,d=Ik(t,r,u,n);l.canEntireRowFit(d,s)&&(fo(t,r,l,n,s),o=e+c)}),o}function _g(t,r,e,n){var s=r.settings;t.applyStyles(t.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&r.foot.forEach(function(a){return fo(t,r,a,e,n)})}function rV(t,r,e){var n=e.getLineHeight(t.styles.fontSize),s=t.padding("vertical"),a=Math.floor((r-s)/n);return Math.max(0,a)}function nV(t,r,e,n){var s={};t.spansMultiplePages=!0,t.height=0;for(var a=0,i=0,o=e.columns;i<o.length;i++){var l=o[i],c=t.cells[l.index];if(c){Array.isArray(c.text)||(c.text=[c.text]);var u=new Lk(c.raw,c.styles,c.section);u=eo(u,c),u.text=[];var d=rV(c,r,n);c.text.length>d&&(u.text=c.text.splice(d,c.text.length));var h=n.scaleFactor(),f=n.getLineHeightFactor();c.contentHeight=c.getContentHeight(h,f),c.contentHeight>=r&&(c.contentHeight=r,u.styles.minCellHeight-=r),c.contentHeight>t.height&&(t.height=c.contentHeight),u.contentHeight=u.getContentHeight(h,f),u.contentHeight>a&&(a=u.contentHeight),s[l.index]=u}}var g=new jk(t.raw,-1,t.section,s,!0);g.height=a;for(var m=0,p=e.columns;m<p.length;m++){var l=p[m],u=g.cells[l.index];u&&(u.height=g.height);var c=t.cells[l.index];c&&(c.height=t.height)}return g}function sV(t,r,e,n){var s=t.pageSize().height,a=n.settings.margin,i=a.top+a.bottom,o=s-i;r.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var l=r.getMinimumRowHeight(n.columns,t),c=l<e;if(l>o)return console.error("Will not be able to print row ".concat(r.index," correctly since it's minimum height is larger than page height")),!0;if(!c)return!1;var u=r.hasRowSpan(n.columns),d=r.getMaxCellHeight(n.columns)>o;return d?(u&&console.error("The content of row ".concat(r.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function Vp(t,r,e,n,s,a,i){var o=Ik(t,r,n,a);if(e.canEntireRowFit(o,i))fo(t,r,e,a,i);else if(sV(t,e,o,r)){var l=nV(e,o,r,t);fo(t,r,e,a,i),ph(t,r,s,a,i),Vp(t,r,l,n,s,a,i)}else ph(t,r,s,a,i),Vp(t,r,e,n,s,a,i)}function fo(t,r,e,n,s){n.x=r.settings.margin.left;for(var a=0,i=s;a<i.length;a++){var o=i[a],l=e.cells[o.index];if(!l){n.x+=o.width;continue}t.applyStyles(l.styles),l.x=n.x,l.y=n.y;var c=r.callCellHooks(t,r.hooks.willDrawCell,l,e,o,n);if(c===!1){n.x+=o.width;continue}aV(t,l,n);var u=l.getTextPos();Tk(l.text,u.x,u.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},t.getDocument()),r.callCellHooks(t,r.hooks.didDrawCell,l,e,o,n),n.x+=o.width}n.y+=e.height}function aV(t,r,e){var n=r.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var s=Pk(n.lineWidth,n.fillColor);s&&t.rect(r.x,e.y,r.width,r.height,s)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(r.x,e.y,r.width,r.height,"F"),iV(t,r,e,n.lineWidth))}function iV(t,r,e,n){var s,a,i,o;n.top&&(s=e.x,a=e.y,i=e.x+r.width,o=e.y,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),l(n.top,s,a,i,o)),n.bottom&&(s=e.x,a=e.y+r.height,i=e.x+r.width,o=e.y+r.height,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),l(n.bottom,s,a,i,o)),n.left&&(s=e.x,a=e.y,i=e.x,o=e.y+r.height,n.top&&(a-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.left,s,a,i,o)),n.right&&(s=e.x+r.width,a=e.y,i=e.x+r.width,o=e.y+r.height,n.top&&(a-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.right,s,a,i,o));function l(c,u,d,h,f){t.getDocument().setLineWidth(c),t.getDocument().line(u,d,h,f,"S")}}function Ik(t,r,e,n){var s=r.settings.margin.bottom,a=r.settings.showFoot;return(a==="everyPage"||a==="lastPage"&&e)&&(s+=r.getFootHeight(r.columns)),t.pageSize().height-n.y-s}function ph(t,r,e,n,s,a){s===void 0&&(s=[]),a===void 0&&(a=!1),t.applyStyles(t.userStyles),r.settings.showFoot==="everyPage"&&!a&&r.foot.forEach(function(o){return fo(t,r,o,n,s)}),r.callEndPageHooks(t,n);var i=r.settings.margin;Rk(t,r,e,n),Bk(t),r.pageNumber++,n.x=i.left,n.y=i.top,e.y=i.top,r.callWillDrawPageHooks(t,n),r.settings.showHead==="everyPage"&&(r.head.forEach(function(o){return fo(t,r,o,n,s)}),t.applyStyles(t.userStyles))}function Bk(t){var r=t.pageNumber();t.setPage(r+1);var e=t.pageNumber();return e===r?(t.addPage(),!0):!1}function oV(t){t.API.autoTable=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var n=r[0],s=Dz(this,n),a=Wz(this,s);return Qz(this,a),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(r,e,n,s){Tk(r,e,n,s,this)},t.API.autoTableSetDefaults=function(r){return Eu.setDefaults(r,this),this},t.autoTableSetDefaults=function(r,e){Eu.setDefaults(r,e)},t.API.autoTableHtmlToJson=function(r,e){var n;if(e===void 0&&(e=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new Eu(this),a=Fk(s,r,window,e,!1),i=a.head,o=a.body,l=((n=i[0])===null||n===void 0?void 0:n.map(function(c){return c.content}))||[];return{columns:l,rows:o,data:o}}}var Sg;try{if(typeof window<"u"&&window){var P3=window,O3=P3.jsPDF||((Sg=P3.jspdf)===null||Sg===void 0?void 0:Sg.jsPDF);O3&&oV(O3)}}catch(t){console.error("Could not apply autoTable plugin",t)}const hy=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"2-digit"}),kg=()=>new Date().toISOString().split("T")[0],dy=t=>{if(!t||t.trim()==="")return kg();try{const r=new Date(t);return isNaN(r.getTime())?kg():r.toISOString().split("T")[0]}catch{return kg()}},lV=t=>{const r=Math.floor(t/50),e=t%50+1;return`${String.fromCharCode(65+r)}${e}`},py=t=>{if(!t||t.length===0)return[];const r=t[0].planets||[];return t.map((e,n)=>{const s={Label:lV(n)};return r.forEach((a,i)=>{s[a]=e.numbers[i]}),s})},cV=(t,r="planet-combinations",e="")=>{try{const n=py(t);if(n.length===0){alert("No data to export");return}const s=e.trim()!==""?e:hy(),a=dy(e),i=new Xb.Workbook,o=i.addWorksheet(`Total Lines: ${n.length} - ${s}`),l=Object.keys(n[0]);o.addRow(l).eachCell(u=>{u.font={bold:!0,color:{argb:"FFFFFF"}},u.fill={type:"pattern",pattern:"solid",fgColor:{argb:"4472C4"}},u.alignment={horizontal:"center"},u.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),n.forEach((u,d)=>{const h=o.addRow(Object.values(u)),f=d%2===0;h.eachCell(g=>{g.alignment={horizontal:"center"},g.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},f||(g.fill={type:"pattern",pattern:"solid",fgColor:{argb:"E3F2FD"}})})}),o.columns.forEach(u=>{let d=0;u.eachCell({includeEmpty:!0},h=>{const f=h.value?h.value.toString().length:0;f>d&&(d=f)}),u.width=Math.max(d+2,10)}),i.xlsx.writeBuffer().then(u=>{const d=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),h=window.URL.createObjectURL(d),f=document.createElement("a");f.href=h,f.download=`${r}-${a}.xlsx`,document.body.appendChild(f),f.click(),document.body.removeChild(f),window.URL.revokeObjectURL(h)})}catch(n){console.error("Error exporting to Excel:",n),alert("Error exporting to Excel. Please try again.")}},Eg=(t,r="planet-combinations",e="")=>{try{console.log("Starting simple PDF export...");const n=py(t);if(n.length===0){alert("No data to export");return}const s=e.trim()!==""?e:hy(),a=dy(e),i=new Zt({orientation:"portrait",unit:"mm",format:"a4"});console.log("Simple PDF document created"),i.setFontSize(16),i.setFont("helvetica","bold"),i.text(`Total Lines: ${n.length} - ${s}`,10,15);const o=Object.keys(n[0]);let l=25;i.setFontSize(12),i.setFont("helvetica","bold");let c=10;const u=Math.min(20,180/o.length);o.forEach(d=>{i.text(d,c,l),c+=u}),l+=8,i.setFontSize(10),i.setFont("helvetica","bold"),n.forEach((d,h)=>{h%2===0||(i.setFillColor(227,242,253),i.rect(5,l-5,190,7,"F")),c=10,Object.values(d).forEach((g,m)=>{i.text(String(g),c,l),c+=u}),l+=7,l>280&&(i.addPage(),l=15)}),i.save(`${r}-${a}.pdf`),console.log("Simple PDF exported successfully")}catch(n){throw console.error("Simple PDF export error:",n),n}},uV=(t,r="planet-combinations",e="")=>{try{console.log("Starting PDF export...",{combinations:t==null?void 0:t.length,filename:r});const n=py(t);if(console.log("Prepared data for PDF:",{dataLength:n.length,firstRow:n[0]}),n.length===0){alert("No data to export");return}const s=e.trim()!==""?e:hy(),a=dy(e);console.log("Creating jsPDF document...");const i=new Zt({orientation:"portrait",unit:"mm",format:"a4"});console.log("jsPDF document created successfully"),i.setFontSize(16),i.setFont("helvetica","bold"),i.text(`Total Lines: ${n.length} - ${s}`,20,20);const o=Object.keys(n[0]),l=n.map(c=>Object.values(c));console.log("Table data prepared:",{headers:o,rowCount:l.length});try{if(console.log("Checking for autoTable function..."),typeof i.autoTable=="function")console.log("Using autoTable for PDF generation..."),i.autoTable({head:[o],body:l,startY:25,theme:"grid",headStyles:{fillColor:[68,114,196],textColor:[255,255,255],fontStyle:"bold",halign:"center",fontSize:12,cellPadding:3},bodyStyles:{halign:"center",valign:"middle",fontSize:10,fontStyle:"bold",cellPadding:2},alternateRowStyles:{fillColor:[227,242,253]},tableLineColor:[0,0,0],tableLineWidth:.1,margin:{top:25,right:10,bottom:10,left:10},columnStyles:{0:{cellWidth:"auto",minCellWidth:15},1:{cellWidth:"auto",minCellWidth:20},2:{cellWidth:"auto",minCellWidth:20},3:{cellWidth:"auto",minCellWidth:20},4:{cellWidth:"auto",minCellWidth:20},5:{cellWidth:"auto",minCellWidth:20},6:{cellWidth:"auto",minCellWidth:20},7:{cellWidth:"auto",minCellWidth:20},8:{cellWidth:"auto",minCellWidth:20},9:{cellWidth:"auto",minCellWidth:20}},styles:{overflow:"linebreak",cellWidth:"wrap",minCellHeight:6,lineColor:[0,0,0],lineWidth:.1}}),console.log("AutoTable PDF created successfully");else return console.log("AutoTable not available, using simple PDF"),Eg(t,r)}catch(c){return console.log("AutoTable failed, falling back to simple PDF:",c),Eg(t,r)}console.log("Saving PDF..."),i.save(`${r}-${a}.pdf`),console.log("PDF saved successfully")}catch(n){console.error("Detailed PDF export error:",n),console.error("Error message:",n.message),console.error("Error stack:",n.stack);try{return console.log("Attempting simple PDF fallback..."),Eg(t,r)}catch(s){console.error("Fallback PDF also failed:",s),alert(`PDF export failed completely. Error: ${n.message}`)}}},fV=({combinations:t,onDeleteCombination:r,onClearAll:e})=>{const n=()=>new Date().toISOString().split("T")[0],[s,a]=Se.useState(n());t.length>0&&t[0].numbers.length;const i=t.length>0?t[0].planets:[],o=c=>{const u=Math.floor(c/50),d=c%50+1;return`${String.fromCharCode(65+u)}${d}`},l=(c,u)=>{if(s.trim()===""){alert("Please select a date before exporting");return}if(!t||t.length===0){alert("No combinations to export. Please generate combinations first.");return}c(t,u,s)};return X.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[X.jsxs("div",{className:"p-4 bg-gray-50 border-b",children:[X.jsx("div",{className:"flex justify-between items-center mb-3",children:X.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Total Lines: ",t?t.length:0]})}),X.jsxs("div",{className:"flex justify-between items-center",children:[X.jsxs("div",{className:"flex items-center gap-2",children:[X.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Export Date:"}),X.jsx("input",{type:"date",value:s,onChange:c=>a(c.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm w-48 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),X.jsxs("div",{className:"flex gap-2 items-center",children:[X.jsxs("button",{onClick:()=>l(cV,"planet-combinations"),className:"px-3 py-1 bg-green-500 hover:bg-green-600 text-white text-sm rounded-md transition-colors flex items-center gap-1",title:"Download Excel file with Label and Planet columns",children:[X.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:X.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Excel"]}),X.jsxs("button",{onClick:()=>l(uV,"planet-combinations"),className:"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-md transition-colors flex items-center gap-1",title:"Download PDF file with Label and Planet columns",children:[X.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:X.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"PDF"]}),t&&t.length>0&&X.jsx("button",{onClick:e,className:"px-3 py-1 bg-red-500 hover:bg-red-600 text-white text-sm rounded-md transition-colors",children:"Clear All"})]})]})]}),t&&t.length>0?X.jsxs(X.Fragment,{children:[X.jsx("div",{className:"overflow-x-auto",children:X.jsxs("table",{className:"w-full",children:[X.jsx("thead",{className:"bg-gray-100",children:X.jsxs("tr",{children:[X.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Label"}),i.map((c,u)=>X.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c},u)),X.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sum"}),X.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Planets"}),X.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),X.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map((c,u)=>X.jsxs("tr",{className:"hover:bg-gray-50",children:[X.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:o(u)}),c.numbers.map((d,h)=>X.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:d},h)),X.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:c.numbers.reduce((d,h)=>d+h,0)}),X.jsx("td",{className:"px-4 py-4 text-sm text-gray-900",children:X.jsx("div",{className:"flex flex-wrap gap-1",children:c.planets.map((d,h)=>X.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:d},h))})}),X.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:X.jsx("button",{onClick:()=>r(u),className:"text-red-600 hover:text-red-900 transition-colors",title:"Delete combination",children:X.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:X.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},u))})]})}),t.length>10&&X.jsxs("div",{className:"p-4 bg-gray-50 border-t text-center text-sm text-gray-600",children:["Showing ",t.length," combinations"]})]}):X.jsxs("div",{className:"p-8 text-center text-gray-500",children:[X.jsx("p",{className:"text-lg font-medium mb-2",children:"No combinations generated yet"}),X.jsx("p",{className:"text-sm",children:"Generate planet combinations to see the results table and enable export functionality."})]})]})},$o=window.electron,M3=()=>{if(window.electron&&window.electron.platform)return window.electron.platform.isMac;const t=window.navigator.userAgent.toLowerCase();return/macintosh|mac os x|iphone|ipad|ipod/.test(t)},Ag=()=>Array.from({length:10},(t,r)=>{const e=r*10+1,n=(r+1)*10;return{id:`range-${e}-${n}`,min:e,max:n,active:!1,inputValue:0,matchCount:0}}),hV=()=>{console.log("Loading NumberGen component - "+new Date().toISOString());const t={Sun:[1,10,19,28,37,46,55,64,73,82,91,100],Moon:[2,11,20,29,38,47,56,65,74,83,92],Mars:[9,18,27,36,45,54,63,72,81,90,99],Mercury:[5,14,23,32,41,50,59,68,77,86,95],Jupiter:[3,12,21,30,39,48,57,66,75,84,93],Venus:[6,15,24,33,42,51,60,69,78,87,96],Saturn:[8,17,26,35,44,53,62,71,80,89,98],Rahu:[4,13,22,31,40,49,58,67,76,85,94],Kethu:[7,16,25,34,43,52,61,70,79,88,97]},[r,e]=Se.useState(""),[n,s]=Se.useState([]),[a,i]=Se.useState([]),o=500,[l,c]=Se.useState(""),[u,d]=Se.useState(""),[h,f]=Se.useState(""),[g,m]=Se.useState(Ag()),[p,v]=Se.useState([]),[b,y]=Se.useState(!1),k=Object.keys(t).map(w=>({value:w,label:w}));Se.useEffect(()=>{s([]),Object.entries(t).forEach(([w,_])=>{console.log(`${w} has ${_.length} numbers:`,_)}),$o&&($o.receive("number-settings-updated",w=>{console.log("Settings update result:",w)}),$o.receive("number-settings-loaded",w=>{w.success&&w.settings&&(console.log("Loaded saved settings:",w.settings),w.settings.valueRange&&c(Number(w.settings.valueRange)),w.settings.minSum&&d(Number(w.settings.minSum)),w.settings.maxSum&&f(Number(w.settings.maxMax)),w.settings.planetCount&&e(Number(w.settings.planetCount)),w.settings.rangeFilters&&(m(w.settings.rangeFilters),y(w.settings.rangeFilters.some(_=>_.active))))}),$o.send("get-number-settings"))},[]),Se.useEffect(()=>{if(r===""){s([]);return}const w=Number(r);if(n.length!==w){const _=[...n];if(_.length<w)for(;_.length<w;)_.push([]);else _.length>w&&_.splice(w);s(_),i([])}},[r,n.length]),Se.useEffect(()=>{$o&&n.length>0&&$o.send("update-number-settings",{valueRange:l,minSum:u,maxSum:h,planetCount:r,selectedPlanets:n,rangeFilters:g})},[l,u,h,r,g]),Se.useEffect(()=>{if(M3()){document.querySelectorAll('input[type="number"]').forEach(S=>{S.classList.add("apple-input"),S.addEventListener("focus",()=>{setTimeout(()=>S.select(),10)})});const _=document.createElement("style");return _.innerHTML=`
        .apple-input::-webkit-inner-spin-button,
        .apple-input::-webkit-outer-spin-button {
          -webkit-appearance: none;
          margin: 0;
        }
        
        .apple-input {
          -webkit-appearance: none;
          appearance: textfield;
        }
      `,document.head.appendChild(_),()=>{document.head.removeChild(_)}}},[]);const N=w=>{const _="px-6 py-3 text-lg font-semibold rounded-full shadow-md",S=M3();return w==="generate"?S?`${_} bg-blue-500 text-white hover:bg-blue-600`:`${_} bg-green-500 text-white hover:bg-green-600`:w==="reset"?S?`${_} bg-gray-200 text-gray-800 hover:bg-gray-300`:`${_} bg-red-100 text-red-800 hover:bg-red-200`:_},L=(w,_)=>{console.log(`Planet Change for index ${w}:`,_);const S=[...n];S[w]=_?_.map(T=>T.value):[],console.log("New planet selection state:",S),s(S)},F=()=>{console.log("=== GENERATE TABLE NUMBERS STARTED ==="),console.log("Planet count:",r),console.log("Value range:",l),console.log("Min sum:",u,"Max sum:",h),console.log("selectedPlanetsByPosition length:",n.length),console.log("selectedPlanetsByPosition:",n),console.log("Generating combinations from selected planets"),console.log("Selected planets:",n),console.log("Value range:",l),console.log("Sum range filter:",`${u} to ${h}`);const w=u===""?1:Number(u),_=h===""?150:Number(h);if(isNaN(w)||isNaN(_)){alert("Error: Sum range values must be valid numbers");return}if(l===""){console.log("VALIDATION FAILED: Empty value range"),alert("Please enter a Value Range before generating combinations");return}if(r===""){console.log("VALIDATION FAILED: Empty planet count"),alert("Please enter the Number of Planets before generating combinations");return}console.log("Checking for empty positions...");const S=n.map((U,A)=>({position:A+1,planets:U})).filter(U=>!U.planets||U.planets.length===0);if(console.log("Empty positions found:",S),S.length>0){const U=S.map(A=>A.position).join(", ");console.log("VALIDATION FAILED: Empty positions at:",U),alert(`Please select at least one planet for position(s): ${U}`);return}if(console.log("VALIDATION PASSED: All positions have planets selected"),w>_){alert("Error: Minimum sum cannot be greater than maximum sum");return}d(w),f(_),n.length>5&&alert("Selecting more than 5 planets may cause performance issues. Consider reducing the number of planets.");const T=n.reduce((U,A)=>U*A.length,1);if(!(T>500&&!window.confirm(`Your selection would generate approximately ${T} combinations, which might slow down your browser. Do you want to continue?`)))try{const U=x();if(console.log("Generated planet permutations:",U.length),U.length===0){console.error("No planet permutations generated"),alert("No combinations possible. Please ensure all planet positions have at least one planet selected.");return}if(U.length>100&&(console.warn(`Large number of permutations (${U.length}). This may take time to process.`),!confirm(`There are ${U.length} possible planet combinations. This may take a while to process. Continue?`)))return;let A=[];for(const z of U){const K=z.map(J=>({planet:J,numbers:t[J]}));console.log("Processing permutation:",z);const j=R(K,z);if(A=[...A,...j],A.length>=o){console.warn(`Reached maximum combinations limit (${o}). Stopping processing.`);break}}A.sort((z,K)=>{for(let j=0;j<z.numbers.length;j++)if(z.numbers[j]!==K.numbers[j])return z.numbers[j]-K.numbers[j];return 0}),A=A.slice(0,o),console.log("Generated results:",A.length,"combinations"),console.log("=== LEFT-TO-RIGHT ASCENDING ORDERING TEST ==="),A.length>0&&(console.log("First few combinations (should show LEFT-TO-RIGHT ascending ordering):"),A.slice(0,5).forEach((z,K)=>{console.log(`  ${K+1}: [${z.numbers.join(", ")}] - planets: [${z.planets.join(", ")}]`)})),A.length===0&&(console.log("No valid combinations found. This may be because:"),console.log("1. The selected planets don't have numbers in the specified range"),console.log("2. The sum constraints (min/max) are too restrictive"),console.log("3. There's an issue with the combination algorithm")),i(A);const H=q(A);v(H)}catch(U){console.error("Error in generateTableNumbers:",U),alert("There was an error generating combinations. Please try with different planets.")}},R=(w,_)=>{const S=[],T=u===""?1:Number(u)||1,U=h===""?150:Number(h)||150;console.log("Finding combinations using position-based planet order with LEFT-TO-RIGHT ascending numbers"),console.log("Number of planets:",w.length),console.log("Source planets (in POSITION-BASED order):",_),console.log("Using sum range for calculations:",`${T} to ${U}`),console.log("Value range limit:",l),console.log("NOTE: Planets maintain their position order, Numbers will increase from LEFT to RIGHT");const A=w.map(K=>({planet:K.planet,numbers:K.numbers.filter(j=>j<=l).sort((j,J)=>j-J)}));console.log("Filtered planets (maintaining position order):"),A.forEach((K,j)=>{console.log(`Position ${j+1} (${K.planet}): ${K.numbers.length} numbers (${K.numbers.slice(0,5).join(", ")}${K.numbers.length>5?"...":""})`)});const H=A.find(K=>K.numbers.length===0);if(H)return console.error(`Planet ${H.planet} has no numbers within range 1-${l}`),alert(`Unable to generate combinations: ${H.planet} has no valid numbers within range 1-${l}.`),[];const z=(K,j,J=0)=>{if(K===A.length){const re=j.reduce((te,ne)=>te+ne,0);re>=T&&re<=U&&S.push({numbers:[...j],planets:_});return}const P=A[K],D=K>0?j[K-1]:-1/0;let G=0;for(let re=K;re<A.length;re++)A[re].numbers.length>0&&(G+=A[re].numbers[0]);for(const re of P.numbers)if(re>D){const te=J+re;if(te+G-P.numbers[0]<=U&&(j[K]=re,z(K+1,j,te),S.length>=o))return}};return z(0,Array(A.length).fill(0),0),S.sort((K,j)=>{for(let J=0;J<K.numbers.length;J++)if(K.numbers[J]!==j.numbers[J])return K.numbers[J]-j.numbers[J];return 0}),console.log("Sorted results based on LEFT-TO-RIGHT position hierarchy (POSITION-BASED ORDER):",S),console.log("Sample combinations (POSITION-BASED planets, LEFT-TO-RIGHT ascending numbers):"),S.length>0&&S.slice(0,5).forEach((K,j)=>{console.log(`  ${j+1}: [${K.numbers.join(", ")}] - planets: [${K.planets.join(", ")}]`)}),S.slice(0,o)},B=()=>{i([]),v([]),c(""),d(""),f(""),e(""),m(Ag()),y(!1),$o&&$o.send("update-number-settings",{valueRange:"",minSum:"",maxSum:"",planetCount:"",rangeFilters:Ag()})},q=w=>{const _=g.some(T=>T.active);if(y(_),!_)return w;const S=g.map(T=>{let U=0;for(const A of w){const H=A.numbers.filter(z=>z>=T.min&&z<=T.max).length;(T.active&&H>=T.inputValue||!T.active&&H>0)&&U++}return{...T,matchCount:U}});return m(S),w.filter(T=>g.every(U=>U.active?T.numbers.filter(H=>H>=U.min&&H<=U.max).length<U.inputValue:!0))},V=w=>{const _=g.map(S=>S.id===w?{...S,active:!S.active}:S);if(m(_),a.length>0){const S=q(a);v(S)}},I=(w,_)=>{const S=Math.min(6,Math.max(0,parseInt(_)||0)),T=g.map(U=>U.id===w?{...U,inputValue:S}:U);if(m(T),a.length>0){const U=q(a);v(U)}},C=()=>{const w=g.map(_=>({..._,active:!1}));m(w),y(!1),v(a)},O=w=>{const _=Math.min(6,Math.max(0,parseInt(w)||0)),S=g.map(T=>({...T,inputValue:_}));if(m(S),a.length>0){const T=q(a);v(T)}},E=w=>{if(w.length===0)return[[]];if(w.some(T=>!T||T.length===0))return console.warn("Cartesian product: One or more arrays are empty, returning empty result"),[];const _=E(w.slice(1)),S=[];for(const T of w[0])for(const U of _)S.push([T,...U]);return S},x=()=>{if(n.length===0)return console.warn("No planet positions defined"),[];console.log("Selected planets by position:"),n.forEach((T,U)=>{console.log(`Position ${U+1}:`,T)});const w=n.map((T,U)=>({index:U,planets:T})).filter(T=>!T.planets||T.planets.length===0);if(w.length>0)return console.warn("Empty planet selections found at positions:",w.map(T=>T.index+1)),[];const _=n.reduce((T,U)=>T*(U.length||1),1);console.log(`Total possible planet permutations: ${_}`);const S=E(n);return console.log("Generated permutations (maintaining position-based order):"),S.forEach((T,U)=>{U<5&&console.log(`  Permutation ${U+1}: [${T.join(", ")}] (Position 1: ${T[0]}, Position 2: ${T[1]}, etc.)`)}),console.log(`Generated ${S.length} planet permutations (POSITION-BASED ORDER)`),console.log("NOTE: Each position maintains its selected planet (no alphabetical sorting)"),S};return X.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[X.jsxs("div",{className:"flex items-center justify-between mb-6",children:[X.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Number Generator"}),X.jsx("div",{className:"flex gap-2",children:X.jsx(ti,{to:"/users",className:"px-4 py-2 bg-gray-100 text-gray-800 rounded hover:bg-gray-200",children:"Back to Users"})})]}),X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[X.jsxs("div",{className:"flex flex-col md:flex-row border-2 border-blue-500 rounded-md p-4 mb-4",children:[X.jsxs("div",{className:"w-full md:w-1/2 p-2",children:[X.jsx("h3",{className:"font-bold text-lg mb-2",children:"Number of Planets (1-9)"}),X.jsx("input",{type:"number",min:"1",max:"9",className:"w-full border-2 border-green-500 rounded p-2",value:r,onChange:w=>{if(w.target.value===""){e("");return}e(Number(w.target.value))}})]}),X.jsxs("div",{className:"w-full md:w-1/2 p-2",children:[X.jsx("h3",{className:"font-bold text-lg mb-2",children:"Value Range (1-100)"}),X.jsx("input",{type:"number",min:"1",max:"100",className:"w-full border-2 border-green-500 rounded p-2",value:l,onChange:w=>{if(w.target.value===""){c("");return}const _=Number(w.target.value);c(Math.max(1,Math.min(100,_)))}})]})]}),X.jsxs("div",{className:"flex flex-col md:flex-row border-2 border-blue-500 rounded-md p-4 mb-4",children:[X.jsxs("div",{className:"w-full md:w-1/2 p-2",children:[X.jsx("h3",{className:"font-bold text-lg mb-2",children:"Minimum Sum"}),X.jsx("input",{type:"number",min:"0",max:"500",className:"w-full border-2 border-green-500 rounded p-2",value:u,onChange:w=>{if(w.target.value===""){d("");return}const _=Number(w.target.value),S=isNaN(_)?0:_;d(Math.min(500,Math.max(0,S)))},onBlur:()=>{isNaN(Number(u))&&u!==""&&d("")}})]}),X.jsxs("div",{className:"w-full md:w-1/2 p-2",children:[X.jsx("h3",{className:"font-bold text-lg mb-2",children:"Maximum Sum"}),X.jsx("input",{type:"number",min:"0",max:"500",className:"w-full border-2 border-green-500 rounded p-2",value:h,onChange:w=>{if(w.target.value===""){f("");return}const _=Number(w.target.value),S=isNaN(_)?0:_;f(Math.min(500,Math.max(0,S)))},onBlur:()=>{isNaN(Number(h))&&h!==""&&f("")}})]})]}),X.jsx("div",{className:"border-2 border-blue-500 rounded-md overflow-hidden mb-4",children:X.jsx("div",{className:"flex flex-wrap",children:Number(r)>0?Array.from({length:Number(r)}).map((w,_)=>{var S;return X.jsxs("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-auto border-b border-r border-blue-300 last:border-r-0",children:[X.jsxs("div",{className:"bg-blue-100 p-2 text-center font-semibold border-b border-blue-300",children:["Planet ",_+1]}),X.jsx("div",{className:"p-2 bg-teal-100",children:X.jsx(kH,{isMulti:!0,className:"planet-select",placeholder:"Select planets...",options:k,value:((S=n[_])==null?void 0:S.map(T=>k.find(U=>U.value===T)))||[],onChange:T=>L(_,T),styles:{control:T=>({...T,borderColor:"#4ade80","&:hover":{borderColor:"#16a34a"}}),multiValue:T=>({...T,backgroundColor:"#d1fae5"}),multiValueLabel:T=>({...T,color:"#065f46",fontWeight:500})}})})]},_)}):null})}),X.jsxs("div",{className:"border-2 border-blue-500 rounded-md p-4 mb-4",children:[X.jsxs("div",{className:"flex flex-row justify-between items-center mb-4",children:[X.jsx("h3",{className:"font-bold text-lg",children:"Number Range Filters"}),X.jsxs("div",{className:"flex gap-2",children:[X.jsx("button",{onClick:C,className:"px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm",children:"Disable All"}),X.jsxs("div",{className:"flex items-center gap-2",children:[X.jsx("span",{className:"text-sm",children:"Set All To:"}),X.jsx("select",{className:"border rounded px-2 py-1",onChange:w=>O(w.target.value),children:[0,1,2,3,4,5,6].map(w=>X.jsx("option",{value:w,children:w},w))})]})]})]}),X.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 lg:grid-cols-5 gap-3",children:g.map(w=>X.jsxs("div",{className:`border p-3 rounded-md ${w.active?"bg-blue-50 border-blue-400":"bg-gray-50 border-gray-300"}`,children:[X.jsxs("div",{className:"flex justify-between items-center mb-2",children:[X.jsxs("label",{className:"font-medium text-sm",children:[w.min,"-",w.max]}),X.jsx("button",{onClick:()=>V(w.id),className:`w-8 h-5 rounded-full flex items-center transition-all duration-300 ${w.active?"bg-blue-500 justify-end":"bg-gray-300 justify-start"}`,children:X.jsx("span",{className:"block w-4 h-4 bg-white rounded-full shadow mx-0.5"})})]}),X.jsxs("div",{className:"flex items-center gap-2",children:[X.jsx("input",{type:"number",min:"0",max:"6",className:`w-full border rounded p-1 text-center ${!w.active&&"opacity-50"}`,value:w.inputValue,onChange:_=>I(w.id,_.target.value),disabled:!w.active,title:`Exclude combinations with this many or more numbers in ${w.min}-${w.max} range`}),X.jsx("span",{className:"text-xs text-gray-500",children:a.length>0?`${w.matchCount}/${a.length}`:"0/0"})]})]},w.id))}),b&&a.length>0&&X.jsxs("div",{className:"mt-3 p-2 bg-blue-50 border border-blue-200 rounded-md text-sm",children:[X.jsxs("p",{className:"font-medium",children:["Showing ",p.length," of ",a.length," combinations after range filtering"]}),X.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Each number represents the count of numbers to exclude combinations from that range"})]})]}),X.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center gap-4 mb-6",children:[X.jsx("button",{className:N("generate"),onClick:()=>{console.log("Generate button clicked"),F()},children:"Generate Combinations"}),X.jsx("button",{className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600",onClick:()=>{console.log("=== DEBUG STATE ==="),console.log("Planet Count:",r),console.log("Value Range:",l),console.log("Min Sum:",u),console.log("Max Sum:",h),console.log("Selected Planets by Position:",n),console.log("selectedPlanetsByPosition.length:",n.length);const w=n.map((_,S)=>({position:S+1,planets:_})).filter(_=>!_.planets||_.planets.length===0);console.log("Empty positions (debug check):",w),console.log("Table Results Length:",a.length),console.log("=== END DEBUG ==="),alert(`Debug info logged to console. Empty positions: ${w.length>0?w.map(_=>_.position).join(", "):"None"}`)},children:"Debug State"}),X.jsx("button",{className:N("reset"),onClick:B,children:"Reset All Filters"})]}),X.jsx(fV,{combinations:a&&a.length>0?b?p:a:[],onDeleteCombination:()=>{},onClearAll:()=>i([])}),a&&a.length===0&&r&&l&&X.jsx("div",{className:"text-center py-8",children:X.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[X.jsx("h3",{className:"text-lg font-medium text-yellow-800 mb-2",children:"No Combinations Generated"}),X.jsx("p",{className:"text-yellow-700 mb-4",children:"No valid combinations were found with the current settings."}),X.jsxs("div",{className:"text-sm text-yellow-600",children:[X.jsx("p",{children:"Possible reasons:"}),X.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[X.jsx("li",{children:"Not all planet positions have planets selected"}),X.jsx("li",{children:"The value range is too restrictive"}),X.jsx("li",{children:"The sum constraints (min/max) are too narrow"}),X.jsx("li",{children:"Selected planets don't have numbers that meet the criteria"})]}),X.jsx("p",{className:"mt-3 font-medium",children:"Try:"}),X.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[X.jsx("li",{children:"Selecting planets for all positions"}),X.jsx("li",{children:"Increasing the value range"}),X.jsx("li",{children:"Adjusting the sum range"}),X.jsx("li",{children:"Using the Debug State button to check your selections"})]})]})]})})]})]})},zo={EXPECTED_TOPICS:30,EXPECTED_ELEMENTS_PER_TOPIC:9,EXPECTED_PLANETS_PER_ELEMENT:9,EXACT_REQUIRED_DATA_CELLS:2430,TOLERANCE_CELLS:50,REQUIRED_ELEMENTS:["as","mo","hl","gl","vig","var","sl","pp","in"],VALID_ASTRO_PATTERNS:[/^[a-z]+-\d+/i,/^[a-z]+-\d+-[^-]*/i,/^[a-z]+-\d+[a-z]{2}\d+/i,/^\d+[a-z]{2}\d+/i],SET_HEADER_PATTERN:/^D-\d+(\s+\([^)]+\))?\s+Set-\d+\s+Matrix$/i,PLANET_HEADERS:["x","sun","moon","mars","mercury","jupiter","venus","saturn","rahu","ketu"],INVALID_VALUES:["","-","","N/A","NA","null","NULL","#N/A","0"]};function dV(t,r){console.log(` STRICT ABCD VALIDATION: Analyzing ${r}`),console.log(` Data structure: ${t.length} rows`);const e=[],n=[],s=[],{EXPECTED_TOPICS:a,EXPECTED_ELEMENTS_PER_TOPIC:i,EXPECTED_PLANETS_PER_ELEMENT:o,EXACT_REQUIRED_DATA_CELLS:l,TOLERANCE_CELLS:c,REQUIRED_ELEMENTS:u,VALID_ASTRO_PATTERNS:d,SET_HEADER_PATTERN:h,PLANET_HEADERS:f,INVALID_VALUES:g}=zo;let m=0,p=-1,v=0,b=0,y=0,k=[],N=[],L=[];console.log(` Analyzing ${t.length} rows for ABCD structure...`);for(let C=0;C<t.length;C++){const O=t[C]?t[C][0]:null,E=O?String(O).trim():"";if(E){if(h.test(E)){if(p>=0){const x={topicNumber:m,row:p+1,elementsFound:v,expectedElements:i,isComplete:v===i};L.push(x),v!==i&&e.push(`Topic ${m} (row ${p+1}): Incomplete - found ${v}/${i} elements`)}m++,p=C,v=0;continue}if(!(p>=0&&(E.toLowerCase()==="x"||f.some(x=>E.toLowerCase().includes(x))))&&p>=0&&E.length<=3&&E.match(/^[a-z]+$/i)){const x=E.toLowerCase();if(!u.includes(x)){e.push(`Row ${C+1}: Invalid element code "${x}". Expected one of: ${u.join(", ")}`);continue}const w=u[v];x!==w&&n.push(`Row ${C+1}: Element "${x}" out of order. Expected "${w}" at position ${v+1}`),v++;let _=0;for(let S=1;S<=o;S++){const T=t[C]?t[C][S]:null,U=String.fromCharCode(65+S);if(T&&T!==null&&T!==void 0&&String(T).trim()!==""){const A=String(T).trim();_++,b++,d.some(z=>z.test(A))?y++:(g.includes(A)||A.length<2?e.push(`Row ${C+1}, Column ${U}: Missing planet data for "${x}"`):n.push(`Row ${C+1}, Column ${U}: Unusual format for "${x}": "${A}". Expected astrological data like "as-7-/su-(...)" or "7sc12"`),N.push({row:C+1,col:U,element:x,value:A}))}else k.push({row:C+1,col:U,element:x,expectedPosition:`Planet ${S} data for ${x}`})}_<o&&e.push(`Row ${C+1}: Element "${x}" missing ${o-_} planet data cells (found ${_}/${o})`)}}}m<a?s.push(`CRITICAL: Insufficient topics. Required: ${a}, Found: ${m}`):m>a&&n.push(`Extra topics found. Expected: ${a}, Found: ${m}`);const F=l-c;y<F?s.push(`CRITICAL: Insufficient valid data cells. Required: ~${l}, Found: ${y} (Missing: ${F-y})`):y<l*.95&&n.push(`Low data cell count. Expected: ~${l}, Found: ${y}`);const R=k.length/l*100;R>5&&s.push(`CRITICAL: Too many missing cells: ${k.length} (${R.toFixed(1)}% of expected data)`);const B=b>0?y/b*100:0;B<90&&n.push(`Data quality below optimal: ${B.toFixed(1)}% valid data`);const q=[...s,...e],V=q.length===0,I=n.length>0;return console.log(" VALIDATION COMPLETE:"),console.log(`   Topics Found: ${m}/${a} ${m===a?"":""}`),console.log(`   Valid Data Cells: ${y}/${l} ${y>=F?"":""}`),console.log(`   Data Quality: ${B.toFixed(1)}%`),console.log(`   Result: ${V?I?"PASSED_WITH_WARNINGS":"PASSED":"FAILED"}`),{isValid:V,errors:q,warnings:n,criticalErrors:s,topicsFound:m,totalDataCells:b,validDataCells:y,missingCells:k,invalidDataCells:N,topicCompleteness:L,dataQualityScore:B,missingCellPercentage:R,summary:`Found ${m}/${a} topics with ${y}/${l} valid data cells. Data quality: ${B.toFixed(1)}%. ${k.length} cells missing.`,validationLevel:V?I?"PASSED_WITH_WARNINGS":"PASSED":"FAILED",setHeaders:[]}}function pV(t,r){let e=` ABCD EXCEL VALIDATION REPORT
`;return e+=`File: ${r}
`,e+=`Status: ${t.isValid?" PASSED":" FAILED"}
`,e+=`Validation Level: ${t.validationLevel||"UNKNOWN"}

`,e+=` VALIDATION SUMMARY:
`,e+=`   Topics Found: ${t.topicsFound||0}/${zo.EXPECTED_TOPICS}
`,e+=`   Valid Data Cells: ${t.validDataCells||0}/${zo.EXACT_REQUIRED_DATA_CELLS}
`,e+=`   Data Quality: ${t.dataQualityScore?t.dataQualityScore.toFixed(1):"0.0"}%
`,e+=`   Missing Cells: ${t.missingCells?t.missingCells.length:0}
`,e+=`   Invalid Data Cells: ${t.invalidDataCells?t.invalidDataCells.length:0}

`,t.criticalErrors&&t.criticalErrors.length>0&&(e+=` CRITICAL ERRORS (${t.criticalErrors.length}) - Must be fixed:
`,t.criticalErrors.forEach((n,s)=>{e+=`${s+1}. ${n}
`}),e+=`
`),t.errors&&t.errors.length>0&&(e+=` ERRORS (${t.errors.length}):
`,t.errors.slice(0,10).forEach((n,s)=>{e+=`${s+1}. ${n}
`}),t.errors.length>10&&(e+=`... and ${t.errors.length-10} more errors
`),e+=`
`),t.warnings&&t.warnings.length>0&&(e+=` WARNINGS (${t.warnings.length}):
`,t.warnings.slice(0,5).forEach((n,s)=>{e+=`${s+1}. ${n}
`}),t.warnings.length>5&&(e+=`... and ${t.warnings.length-5} more warnings
`),e+=`
`),t.missingCells&&t.missingCells.length>0&&(e+=` MISSING DATA LOCATIONS (${Math.min(t.missingCells.length,10)} shown):
`,t.missingCells.slice(0,10).forEach((n,s)=>{e+=`${s+1}. Row ${n.row}, Column ${n.col}: ${n.expectedPosition}
`}),t.missingCells.length>10&&(e+=`... and ${t.missingCells.length-10} more missing cells
`),e+=`
`),e+=` TEMPLATE REQUIREMENTS:
`,e+=` Must have exactly ${zo.EXPECTED_TOPICS} topics with headers like "D-1 Set-1 Matrix"
`,e+=` Each topic must have ${zo.EXPECTED_ELEMENTS_PER_TOPIC} elements: ${zo.REQUIRED_ELEMENTS.join(", ")}
`,e+=` Each element must have ${zo.EXPECTED_PLANETS_PER_ELEMENT} planet data cells in columns B-J
`,e+=` Planet data must be in valid astrological format (e.g., "as-7-/su-(...)", "7sc12")
`,e+=` Total expected data cells: ${zo.EXACT_REQUIRED_DATA_CELLS}
`,e}class mV{constructor(){this.supabase=Lt,console.log(" CleanSupabaseService initialized - Supabase only, no localStorage")}async createUser(r){try{const{data:e,error:n}=await this.supabase.from("users").insert({username:r.username,email:r.email,hr_count:r.hr||1}).select().single();if(n)throw n;return console.log(" User created:",e.id),e}catch(e){throw console.error(" Error creating user:",e),e}}async getUser(r){try{const{data:e,error:n}=await this.supabase.from("users").select("*").eq("id",r).single();if(n)throw n;return e}catch(e){throw console.error(" Error getting user:",e),e}}async getAllUsers(){try{const{data:r,error:e}=await this.supabase.from("users").select("*").order("username");if(e)throw e;return r||[]}catch(r){throw console.error(" Error getting users:",r),r}}async saveExcelData(r,e,n){var s,a;try{console.log(` Saving Excel data for ${r} on ${e}`),console.log(" Excel data structure:",{hasDirectSets:!!n.sets,hasDataProperty:!!n.data,hasDataSets:!!((s=n.data)!=null&&s.sets),structure:Object.keys(n)});const i=n.sets||((a=n.data)==null?void 0:a.sets);if(!i||Object.keys(i).length===0)throw new Error("Excel data must contain sets/topics");const{data:o,error:l}=await this.supabase.from("excel_data").upsert({user_id:r,date:e,file_name:n.fileName||"Unknown",data:{sets:i}},{onConflict:"user_id,date"}).select().single();if(l)throw l;return console.log(` Excel data saved: ${Object.keys(i).length} sets`),o}catch(i){throw console.error(" Error saving Excel data:",i),i}}async getExcelData(r,e){var n,s;try{console.log(` Getting Excel data for ${r} on ${e}`);const{data:a,error:i}=await this.supabase.from("excel_data").select("*").eq("user_id",r).eq("date",e).single();if(i){if(i.code==="PGRST116")return console.log(` No Excel data found for ${r} on ${e}`),null;throw i}return console.log(` Excel data loaded: ${Object.keys(((n=a.data)==null?void 0:n.sets)||{}).length} sets`),{fileName:a.file_name,sets:((s=a.data)==null?void 0:s.sets)||{},dataSource:"Supabase",date:a.date}}catch(a){throw console.error(" Error getting Excel data:",a),a}}async deleteExcelData(r,e){try{const{error:n}=await this.supabase.from("excel_data").delete().eq("user_id",r).eq("date",e);if(n)throw n;console.log(` Excel data deleted for ${r} on ${e}`)}catch(n){throw console.error(" Error deleting Excel data:",n),n}}async hasExcelData(r,e){try{console.log(` [DEBUG] Checking Excel data for user ${r} on ${e}`);const{count:n,error:s}=await this.supabase.from("excel_data").select("*",{count:"exact",head:!0}).eq("user_id",r).eq("date",e);if(console.log(" [DEBUG] Excel data query result:",{count:n,error:s==null?void 0:s.message}),s)return console.error(" [DEBUG] Excel data query error:",s),!1;const a=n>0;return console.log(`${a?"":""} [DEBUG] Excel data ${a?"EXISTS":"NOT FOUND"} for ${e}`),a}catch(n){return console.error(" [DEBUG] Exception in hasExcelData:",n),!1}}async saveHourEntry(r,e,n){try{console.log(` Saving hour entry for ${r} on ${e}`);const{data:s,error:a}=await this.supabase.from("hour_entries").upsert({user_id:r,date_key:e,hour_data:{planetSelections:n,date:e,userId:r,savedAt:new Date().toISOString()}},{onConflict:"user_id,date_key"}).select().single();if(a)throw a;return console.log(` Hour entry saved: ${Object.keys(n).length} HR selections`),s}catch(s){throw console.error(" Error saving hour entry:",s),s}}async getHourEntry(r,e){var n,s,a;try{console.log(` Getting hour entry for ${r} on ${e}`);const{data:i,error:o}=await this.supabase.from("hour_entries").select("*").eq("user_id",r).eq("date_key",e).single();if(o){if(o.code==="PGRST116")return console.log(` No hour entry found for ${r} on ${e} (this is normal for new dates)`),null;throw console.error(` Hour entry query failed for ${r} on ${e}:`,{code:o.code,message:o.message,details:o.details,hint:o.hint,statusCode:o.statusCode}),new Error(`Database query failed: ${o.message||"Unknown error"}`)}return console.log(` Hour entry loaded: ${Object.keys(((n=i.hour_data)==null?void 0:n.planetSelections)||{}).length} HR selections`),{planetSelections:((s=i.hour_data)==null?void 0:s.planetSelections)||{},dataSource:"Supabase",date:i.date_key}}catch(i){throw(a=i.message)!=null&&a.includes("Database query failed")?i:(console.error(" Unexpected error getting hour entry:",i),new Error(`Unexpected error: ${i.message||"Unknown error"}`))}}async deleteHourEntry(r,e){try{const{error:n}=await this.supabase.from("hour_entries").delete().eq("user_id",r).eq("date_key",e);if(n)throw n;console.log(` Hour entry deleted for ${r} on ${e}`)}catch(n){throw console.error(" Error deleting hour entry:",n),n}}async hasHourEntry(r,e){try{console.log(` [DEBUG] Checking Hour Entry for user ${r} on ${e}`);const{count:n,error:s}=await this.supabase.from("hour_entries").select("*",{count:"exact",head:!0}).eq("user_id",r).eq("date_key",e);if(console.log(" [DEBUG] Hour Entry query result:",{count:n,error:s==null?void 0:s.message}),s)return console.error(" [DEBUG] Hour Entry query error:",s),!1;const a=n>0;return console.log(`${a?"":""} [DEBUG] Hour Entry ${a?"EXISTS":"NOT FOUND"} for ${e}`),a}catch(n){return console.error(" [DEBUG] Exception in hasHourEntry:",n),!1}}async getUserDates(r){try{const{data:e,error:n}=await this.supabase.from("user_dates").select("dates").eq("user_id",r).single();if(n){if(n.code==="PGRST116")return[];throw n}return e.dates||[]}catch(e){throw console.error(" Error getting user dates:",e),e}}async saveUserDates(r,e){try{const{data:n,error:s}=await this.supabase.from("user_dates").upsert({user_id:r,dates:e},{onConflict:"user_id"}).select().single();if(s)throw s;return console.log(` User dates saved: ${e.length} dates`),n}catch(n){throw console.error(" Error saving user dates:",n),n}}async addUserDate(r,e){try{const n=await this.getUserDates(r);if(!n.includes(e)){const s=[...n,e].sort();await this.saveUserDates(r,s)}}catch(n){throw console.error(" Error adding user date:",n),n}}async removeUserDate(r,e){try{const s=(await this.getUserDates(r)).filter(a=>a!==e);await this.saveUserDates(r,s),await this.deleteExcelData(r,e),await this.deleteHourEntry(r,e)}catch(n){throw console.error(" Error removing user date:",n),n}}async extractNumbersFromSet(r,e,n,s){try{const[a,i]=await Promise.all([this.getExcelData(r,e),this.getHourEntry(r,e)]);if(!a||!i)return console.log(` Missing data for extraction: Excel=${!!a}, Hour=${!!i}`),[];const o=a.sets||{},l=i.planetSelections||{},c=o[n],u=l[s];if(!c||!u)return console.log(` Missing set data or planet selection for ${n}/HR${s}`),[];const d=new Set;Object.entries(c).forEach(([f,g])=>{const m=g[u];if(m){const p=m.match(/^[a-z]+-(\d+)[\/\-]/);p&&d.add(Number(p[1]))}});const h=Array.from(d).sort((f,g)=>f-g);return console.log(` Extracted ${h.length} numbers from ${n} HR${s}: [${h.join(", ")}]`),h}catch(a){return console.error(" Error extracting numbers:",a),[]}}async performABCDAnalysis(r,e,n,s){try{if(e.length<4)return console.log(` Need 4 dates for ABCD analysis, got ${e.length}`),{abcdNumbers:[],bcdNumbers:[]};const[a,i,o,l]=e,[c,u,d,h]=await Promise.all([this.extractNumbersFromSet(r,a,n,s),this.extractNumbersFromSet(r,i,n,s),this.extractNumbersFromSet(r,o,n,s),this.extractNumbersFromSet(r,l,n,s)]);if(h.length===0)return console.log(" No D-day numbers for analysis"),{abcdNumbers:[],bcdNumbers:[]};const f=h.filter(v=>{let b=0;return c.includes(v)&&b++,u.includes(v)&&b++,d.includes(v)&&b++,b>=2}),g=h.filter(v=>{const b=c.includes(v),y=u.includes(v),k=d.includes(v);return y&&!b&&!k||k&&!b&&!y}),m=f,p=g.filter(v=>!f.includes(v));return console.log(` ABCD/BCD Analysis for ${n}:`,{abcdNumbers:m,bcdNumbers:p,extractedCounts:{A:c.length,B:u.length,C:d.length,D:h.length}}),{abcdNumbers:m,bcdNumbers:p}}catch(a){return console.error(" Error in ABCD analysis:",a),{abcdNumbers:[],bcdNumbers:[]}}}async getDataSummary(r){try{const[e,n,s]=await Promise.all([this.supabase.from("excel_data").select("*",{count:"exact",head:!0}).eq("user_id",r),this.supabase.from("hour_entries").select("*",{count:"exact",head:!0}).eq("user_id",r),this.getUserDates(r)]);return{excelDataCount:e.count||0,hourEntryCount:n.count||0,userDatesCount:s.length,userDates:s}}catch(e){return console.error(" Error getting data summary:",e),{excelDataCount:0,hourEntryCount:0,userDatesCount:0,userDates:[]}}}async checkConnection(){try{const{data:r,error:e}=await this.supabase.from("users").select("count(*)").limit(1);if(e)throw e;return console.log(" Supabase connection healthy"),!0}catch(r){return console.error(" Supabase connection failed:",r),!1}}}const lr=new mV;let my=class{constructor(){this.useLocalStorageFallback=!0,this.enableDebugLogging=!0}log(r,e=null){this.enableDebugLogging&&console.log(`[DataService] ${r}`,e||"")}async getDates(r){this.log(" getDates called for user:",r);try{const{data:e,error:n}=await Lt.from("user_dates").select("dates").eq("user_id",r).single();return!n&&e&&e.dates&&Array.isArray(e.dates)?(this.log(" Dates fetched from user_dates table",e.dates),e.dates.sort((s,a)=>new Date(a)-new Date(s))):n&&n.code==="PGRST116"?(this.log(" No user_dates record found - returning empty array"),[]):e&&(!e.dates||e.dates.length===0)?(this.log(" User dates array is empty - returning empty array"),[]):(this.log(" No valid dates found"),[])}catch(e){return this.log(" Error fetching dates from user_dates table",e.message),[]}}async saveDates(r,e){this.log(" Saving dates to Supabase:",{userId:r,dates:e});try{const{data:n,error:s}=await Lt.from("user_dates").upsert([{user_id:r,dates:e,updated_at:new Date().toISOString()}],{onConflict:"user_id",ignoreDuplicates:!1});return s?(this.log(" Error saving to Supabase, falling back to localStorage",s.message),this.saveLocalStorageDates(r,e),null):(this.log(" Dates saved to Supabase successfully",e),this.saveLocalStorageDates(r,e),n)}catch(n){return this.log(" Exception saving dates, using localStorage fallback",n.message),this.saveLocalStorageDates(r,e),null}}getLocalStorageDates(r){try{const e=localStorage.getItem(`abcd_dates_${r}`);if(e){const n=JSON.parse(e);if(Array.isArray(n))return n.sort((s,a)=>new Date(a)-new Date(s))}}catch(e){this.log(" Error reading localStorage dates",e.message)}return[]}saveLocalStorageDates(r,e){try{localStorage.setItem(`abcd_dates_${r}`,JSON.stringify(e))}catch(n){this.log(" Error saving localStorage dates",n.message)}}async getExcelData(r,e){try{const{data:n,error:s}=await Lt.from("excel_data").select("*").eq("user_id",r).eq("date",e).single();if(!s&&n)return this.log(" Excel data fetched from Supabase",{date:e,fileName:n.file_name}),{date:n.date,fileName:n.file_name,data:n.data,uploadedAt:n.uploaded_at};if(this.useLocalStorageFallback){const a=this.getLocalStorageExcelData(r,e);return a&&this.log(" Excel data fetched from localStorage",{date:e,fileName:a.fileName}),a}return null}catch(n){if(this.log(" Error fetching Excel data, using localStorage fallback",n.message),this.useLocalStorageFallback)return this.getLocalStorageExcelData(r,e);throw n}}async saveExcelData(r,e,n){try{const s={user_id:r,date:e,file_name:n.fileName,data:n.data},{error:a}=await Lt.from("excel_data").upsert(s,{onConflict:"user_id,date"});if(!a){this.log(" Excel data saved to Supabase",{date:e,fileName:n.fileName}),this.saveLocalStorageExcelData(r,e,n);return}this.saveLocalStorageExcelData(r,e,n),this.log(" Excel data saved to localStorage (Supabase failed)",{date:e,fileName:n.fileName})}catch(s){this.log(" Error saving Excel data, using localStorage",s.message),this.saveLocalStorageExcelData(r,e,n)}}getLocalStorageExcelData(r,e){try{const n=`abcd_excel_${r}_${e}`,s=localStorage.getItem(n);if(s)return JSON.parse(s)}catch(n){this.log(" Error reading localStorage Excel data",n.message)}return null}saveLocalStorageExcelData(r,e,n){try{const s=`abcd_excel_${r}_${e}`,a={date:e,fileName:n.fileName,data:n.data,uploadedAt:n.uploadedAt||new Date().toISOString()};localStorage.setItem(s,JSON.stringify(a))}catch(s){this.log(" Error saving localStorage Excel data",s.message)}}async hasExcelData(r,e){try{const{count:n,error:s}=await Lt.from("excel_data").select("*",{count:"exact",head:!0}).eq("user_id",r).eq("date",e);if(s)return this.log(" Supabase Excel check error:",s.message),!1;const a=n>0;return this.log(` Excel data check: ${a?"EXISTS":"NOT FOUND"}`,{userId:r,date:e,count:n}),a}catch(n){return this.log(" Excel data check failed:",n.message),!1}}async getHourEntry(r,e){var n,s;try{const{data:a,error:i}=await Lt.from("hour_entries").select("*").eq("user_id",r).eq("date_key",e).single();if(!i&&a)return this.log(" Hour entry fetched from Supabase",{date:e}),{userId:a.user_id,date:a.date_key,planetSelections:((n=a.hour_data)==null?void 0:n.planetSelections)||{},savedAt:((s=a.hour_data)==null?void 0:s.savedAt)||a.created_at};if(this.useLocalStorageFallback){const o=this.getLocalStorageHourEntry(r,e);return o&&this.log(" Hour entry fetched from localStorage",{date:e}),o}return null}catch(a){if(this.log(" Error fetching hour entry, using localStorage fallback",a.message),this.useLocalStorageFallback)return this.getLocalStorageHourEntry(r,e);throw a}}async saveHourEntry(r,e,n){try{const s={user_id:r,date_key:e,hour_data:{planetSelections:n.planetSelections,userId:r,date:e,savedAt:n.savedAt||new Date().toISOString()}},{error:a}=await Lt.from("hour_entries").upsert(s,{onConflict:"user_id,date_key"});if(!a){this.log(" Hour entry saved to Supabase",{date:e}),this.saveLocalStorageHourEntry(r,e,n);return}this.saveLocalStorageHourEntry(r,e,n),this.log(" Hour entry saved to localStorage (Supabase failed)",{date:e})}catch(s){this.log(" Error saving hour entry, using localStorage",s.message),this.saveLocalStorageHourEntry(r,e,n)}}getLocalStorageHourEntry(r,e){try{const n=`abcd_hourEntry_${r}_${e}`,s=localStorage.getItem(n);if(s)return JSON.parse(s)}catch(n){this.log(" Error reading localStorage hour entry",n.message)}return null}saveLocalStorageHourEntry(r,e,n){try{const s=`abcd_hourEntry_${r}_${e}`,a={userId:r,date:e,planetSelections:n.planetSelections,savedAt:n.savedAt||new Date().toISOString()};localStorage.setItem(s,JSON.stringify(a))}catch(s){this.log(" Error saving localStorage hour entry",s.message)}}async hasHourEntry(r,e){try{const{count:n,error:s}=await Lt.from("hour_entries").select("*",{count:"exact",head:!0}).eq("user_id",r).eq("date_key",e);if(s)return this.log(" Supabase Hour Entry check error:",s.message),!1;const a=n>0;return this.log(` Hour Entry check: ${a?"EXISTS":"NOT FOUND"}`,{userId:r,date:e,count:n}),a}catch(n){return this.log(" Hour Entry check failed:",n.message),!1}}async deleteDataForDate(r,e){this.log(" [COMPREHENSIVE] Deleting all data for date from ALL storage locations:",{userId:r,date:e});try{const n=[Lt.from("excel_data").delete().eq("user_id",r).eq("date",e),Lt.from("hour_entries").delete().eq("user_id",r).eq("date_key",e),Lt.from("hour_entries").delete().eq("user_id",r).eq("date_key",e),Lt.from("hr_data").delete().eq("user_id",r).eq("date",e),Lt.from("house").delete().eq("user_id",r).eq("date",e),Lt.from("processed_data").delete().eq("user_id",r).eq("date",e),Lt.from("abcd_sequences").delete().eq("user_id",r).eq("trigger_date",e),Lt.from("abcd_sequences").delete().eq("user_id",r).eq("a_date",e),Lt.from("abcd_sequences").delete().eq("user_id",r).eq("b_date",e),Lt.from("abcd_sequences").delete().eq("user_id",r).eq("c_date",e),Lt.from("abcd_sequences").delete().eq("user_id",r).eq("d_date",e),Lt.from("rule2_results").delete().eq("user_id",r).eq("date",e),Lt.from("analysis_results").delete().eq("user_id",r).eq("date",e),Lt.from("calculation_cache").delete().eq("user_id",r).eq("date",e),Lt.from("page_cache").delete().eq("user_id",r).eq("date",e),Lt.from("user_cache").delete().eq("user_id",r).eq("date",e),Lt.from("session_cache").delete().eq("user_id",r).eq("date",e)];this.log(" Executing comprehensive deletion from 17 tables...",{tableCount:n.length});const s=await Promise.allSettled(n),a=["excel_data","hour_entry","hour_entries","hr_data","house","processed_data","abcd_sequences(trigger)","abcd_sequences(a_date)","abcd_sequences(b_date)","abcd_sequences(c_date)","abcd_sequences(d_date)","rule2_results","analysis_results","calculation_cache","page_cache","user_cache","session_cache"];let i=0,o=0;s.forEach((c,u)=>{var h,f;const d=a[u];c.status==="fulfilled"?(this.log(` Deleted from ${d}`,{date:e,affected:((h=c.value)==null?void 0:h.count)||"unknown"}),i++):(this.log(` Could not delete from ${d}:`,((f=c.reason)==null?void 0:f.message)||"Unknown error"),o++)}),this.deleteLocalStorageDataForDate(r,e),[`abcd_analysis_${r}_${e}`,`abcd_cached_${r}_${e}`,`abcd_processed_${r}_${e}`,`rule1_data_${r}_${e}`,`rule2_data_${r}_${e}`,`index_data_${r}_${e}`,`rule2_results_${r}_${e}`,`page_cache_${r}_${e}`,`matrix_data_${r}_${e}`,`abcd_sequences_${r}_${e}`,`planets_analysis_${r}_${e}`,`hr_selections_${r}_${e}`,`topic_analysis_${r}_${e}`,`comprehensive_${r}_${e}`,`validation_${r}_${e}`].forEach(c=>{try{localStorage.removeItem(c),this.log(` Cleared additional localStorage: ${c}`)}catch{this.log(` Could not clear localStorage key: ${c}`)}}),this.log(" Updating user_dates table to remove deleted date from JSONB array...");try{const{data:c,error:u}=await Lt.from("user_dates").select("dates").eq("user_id",r).single();if(!u&&c&&c.dates){const d=c.dates.filter(f=>f!==e),{error:h}=await Lt.from("user_dates").update({dates:d,updated_at:new Date().toISOString()}).eq("user_id",r);h?this.log(" Error updating user_dates table:",h.message):this.log(" Successfully removed date from user_dates JSONB array",{date:e,remainingDates:d.length})}else this.log(" No user_dates record found or no dates array - deletion still successful")}catch(c){this.log(" Error updating user_dates table (deletion from other tables still successful):",c.message)}this.log(" [COMPREHENSIVE] Complete data deletion finished",{date:e,successfulTables:i,failedTables:o,totalTablesChecked:a.length})}catch(n){throw this.log(" [COMPREHENSIVE] Error during complete deletion",n.message),n}}deleteLocalStorageDataForDate(r,e){try{localStorage.removeItem(`abcd_excel_${r}_${e}`),localStorage.removeItem(`abcd_hourEntry_${r}_${e}`),localStorage.removeItem(`abcd_indexData_${r}_${e}`),this.log(" Local storage data deleted",{date:e})}catch(n){this.log(" Error deleting localStorage data",n.message)}}async migrateUserData(r){this.log(" Starting migration for user",r);try{const e=this.getLocalStorageDates(r);e.length>0&&(await this.saveDates(r,e),this.log(" Migrated dates",e));for(const n of e){const s=this.getLocalStorageExcelData(r,n);s&&(await this.saveExcelData(r,n,s),this.log(" Migrated Excel data",{date:n}));const a=this.getLocalStorageHourEntry(r,n);a&&(await this.saveHourEntry(r,n,a),this.log(" Migrated hour entry",{date:n}))}return this.log(" Migration completed for user",r),{success:!0,migratedDates:e.length}}catch(e){return this.log(" Migration failed",e.message),{success:!1,error:e.message}}}async exportUserData(r){const e=await this.getDates(r),n={userId:r,exportedAt:new Date().toISOString(),dates:e,excelData:{},hourEntries:{}};for(const s of e){const a=await this.getExcelData(r,s),i=await this.getHourEntry(r,s);a&&(n.excelData[s]=a),i&&(n.hourEntries[s]=i)}return n}async createSampleData(r){this.log(" Creating sample data for user",r);const e=localStorage.getItem(`abcd_user_deleted_all_${r}`);if(this.log(" CREATING SAMPLE DATA - deletion flag check:",{userId:r,flag:e}),e==="true"){this.log(" CRITICAL: Trying to create sample data but deletion flag is set! Aborting.");return}const n=new Date,s=[];for(let h=3;h>=0;h--){const f=new Date(n);f.setDate(f.getDate()-h),s.push(f.toISOString().split("T")[0])}const a=["D-1 Set-1 Matrix","D-1 Set-2 Matrix","D-3 Set-1 Matrix","D-3 Set-2 Matrix","D-4 Set-1 Matrix","D-4 Set-2 Matrix","D-5 Set-1 Matrix","D-5 Set-2 Matrix","D-7 Set-1 Matrix","D-7 Set-2 Matrix","D-9 Set-1 Matrix","D-9 Set-2 Matrix","D-10 Set-1 Matrix","D-10 Set-2 Matrix","D-11 Set-1 Matrix","D-11 Set-2 Matrix","D-12 Set-1 Matrix","D-12 Set-2 Matrix","D-27 Set-1 Matrix","D-27 Set-2 Matrix","D-30 Set-1 Matrix","D-30 Set-2 Matrix","D-60 Set-1 Matrix","D-60 Set-2 Matrix","D-81 Set-1 Matrix","D-81 Set-2 Matrix","D-108 Set-1 Matrix","D-108 Set-2 Matrix","D-144 Set-1 Matrix","D-144 Set-2 Matrix"],i=["Lagna","Moon","Hora Lagna","Ghati Lagna","Vighati Lagna","Varnada Lagna","Sree Lagna","Pranapada Lagna","Indu Lagna"],o=["as","mo","hl","gl","vig","var","sl","pp","in"],l=["Su","Mo","Ma","Me","Ju","Ve","Sa","Ra","Ke"],c={};a.forEach((h,f)=>{const g={};i.forEach((m,p)=>{const v=o[p],b={};l.forEach((y,k)=>{const N=f*3+p*5+k*2+1,L=(N+f+p)%12+1,F=(N*2+k)%30+1;b[y]=`${v}-${N}/${y.toLowerCase()}-(${L} Sc ${F})`}),g[m]=b}),c[h]=g});const u={fileName:"sample_30_topics.xlsx",data:{sets:c}},d={planetSelections:{1:"Su",2:"Mo",3:"Ma",4:"Me",5:"Ju",6:"Ve",7:"Sa",8:"Ra",9:"Ke",10:"Su",11:"Mo",12:"Ma",13:"Me",14:"Ju",15:"Ve",16:"Sa",17:"Ra",18:"Ke",19:"Su",20:"Mo",21:"Ma",22:"Me",23:"Ju",24:"Ve"}};for(const h of s){const f=s.indexOf(h),g={...u,data:{sets:{}}};Object.entries(u.data.sets).forEach(([m,p])=>{g.data.sets[m]={},Object.entries(p).forEach(([v,b])=>{g.data.sets[m][v]={},Object.entries(b).forEach(([y,k])=>{const N=k.replace(/(\d+)/g,L=>{const F=parseInt(L)+f;return String(F>50?F-50:F)});g.data.sets[m][v][y]=N})})}),await this.saveExcelData(r,h,g),await this.saveHourEntry(r,h,d)}await this.saveDates(r,s),this.log(" Sample data created successfully",{userId:r,dates:s})}};const gV=Object.freeze(Object.defineProperty({__proto__:null,DataService:my},Symbol.toStringTag,{value:"Module"}));class vV{constructor(){this.primaryService=lr,this.fallbackService=new my,this.serviceName="UnifiedDataService"}getServiceInfo(){return{name:this.serviceName,primary:this.primaryService.constructor.name,fallback:this.fallbackService.constructor.name,timestamp:new Date().toISOString()}}async getDates(r){try{console.log(` [UnifiedDataService] Fetching dates for ${r}`);const e=await this.primaryService.getUserDates(r);if(e&&Array.isArray(e))return console.log(` [UnifiedDataService] Primary service returned ${e.length} dates`),e;console.log(" [UnifiedDataService] Primary failed, trying fallback service");const n=await this.fallbackService.getDates(r);return n&&Array.isArray(n)?(console.log(` [UnifiedDataService] Fallback service returned ${n.length} dates`),n):(console.log(" [UnifiedDataService] No dates found in any service"),[])}catch(e){return console.error(" [UnifiedDataService] Error fetching dates:",e),[]}}async getExcelData(r,e){try{console.log(` [UnifiedDataService] Fetching Excel data for ${r} on ${e}`);const n=await this.primaryService.getExcelData(r,e);if(n&&n.sets)return console.log(" [UnifiedDataService] Primary service returned data"),n;console.log(" [UnifiedDataService] Primary failed, trying fallback service");const s=await this.fallbackService.getExcelData(r,e);return s?(console.log(" [UnifiedDataService] Fallback service returned data"),s):(console.log(" [UnifiedDataService] No data found in any service"),null)}catch(n){return console.error(" [UnifiedDataService] Error fetching Excel data:",n),null}}async getHourEntry(r,e){try{console.log(` [UnifiedDataService] Fetching Hour Entry for ${r} on ${e}`);let n=null;try{if(n=await this.primaryService.getHourEntry(r,e),n&&n.planetSelections)return console.log(` [UnifiedDataService] Primary service returned hour data with ${Object.keys(n.planetSelections).length} HR selections`),n;n===null&&console.log(" [UnifiedDataService] Primary service found no data (this is normal for new dates)")}catch(a){console.warn(" [UnifiedDataService] Primary service error (will try fallback):",a.message)}console.log(" [UnifiedDataService] Trying fallback service...");let s=null;try{if(s=await this.fallbackService.getHourEntry(r,e),s&&s.planetSelections)return console.log(` [UnifiedDataService] Fallback service returned hour data with ${Object.keys(s.planetSelections).length} HR selections`),s;s===null&&console.log(" [UnifiedDataService] Fallback service also found no data")}catch(a){console.warn(" [UnifiedDataService] Fallback service error:",a.message)}return console.log(` [UnifiedDataService] No hour data found for ${r} on ${e} (this is normal for new dates - upload Excel and create hour entries)`),null}catch(n){return console.error(" [UnifiedDataService] Unexpected error fetching Hour Entry:",n),null}}async saveExcelData(r,e,n){try{return await this.primaryService.saveExcelData(r,e,n)}catch(s){return console.error(" [UnifiedDataService] Error saving Excel data:",s),await this.fallbackService.saveExcelData(r,e,n)}}async saveHourEntry(r,e,n){try{return await this.primaryService.saveHourEntry(r,e,n)}catch(s){return console.error(" [UnifiedDataService] Error saving Hour Entry:",s),await this.fallbackService.saveHourEntry(r,e,n)}}}const mv=new vV;class bV extends my{constructor(){super(),this.serviceName="DataService_New",this.cache=new Map,this.cacheTimeout=5*60*1e3}getServiceInfo(){return{name:this.serviceName,cacheSize:this.cache.size,timestamp:new Date().toISOString()}}_getCacheKey(r,e,n){return`${r}_${e}_${n}`}_isValidCacheEntry(r){return r&&Date.now()-r.timestamp<this.cacheTimeout}async getExcelData(r,e){const n=this._getCacheKey("excel",r,e),s=this.cache.get(n);if(this._isValidCacheEntry(s))return console.log(` [DataService_New] Cache hit for Excel data ${r}/${e}`),s.data;try{const a=await super.getExcelData(r,e);return a&&this.cache.set(n,{data:a,timestamp:Date.now()}),a}catch(a){throw console.error(" [DataService_New] Error fetching Excel data:",a),a}}async getHourEntry(r,e){const n=this._getCacheKey("hour",r,e),s=this.cache.get(n);if(this._isValidCacheEntry(s))return console.log(` [DataService_New] Cache hit for Hour Entry ${r}/${e}`),s.data;try{const a=await super.getHourEntry(r,e);return a&&this.cache.set(n,{data:a,timestamp:Date.now()}),a}catch(a){throw console.error(" [DataService_New] Error fetching Hour Entry:",a),a}}clearCache(){this.cache.clear(),console.log(" [DataService_New] Cache cleared")}getCacheStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys()),lastAccess:new Date().toISOString()}}}class yV{constructor(){this.cache=new Map,this.serviceName="MockRedisClient",this.stats={hits:0,misses:0,sets:0,deletes:0}}async get(r){if(this.cache.has(r)){this.stats.hits++;const e=this.cache.get(r);return console.log(` [MockRedis] Cache hit for key: ${r}`),JSON.stringify(e.data)}return this.stats.misses++,console.log(` [MockRedis] Cache miss for key: ${r}`),null}async set(r,e,n=3600){this.cache.set(r,{data:JSON.parse(e),timestamp:Date.now(),ttl:n*1e3}),this.stats.sets++,console.log(` [MockRedis] Cache set for key: ${r} (TTL: ${n}s)`)}async del(r){const e=this.cache.delete(r);return e&&(this.stats.deletes++,console.log(` [MockRedis] Cache deleted for key: ${r}`)),e?1:0}async exists(r){return this.cache.has(r)?1:0}async flushall(){this.cache.clear(),console.log(" [MockRedis] Cache cleared completely")}getStats(){return{...this.stats,cacheSize:this.cache.size,serviceName:this.serviceName}}cleanExpired(){const r=Date.now();let e=0;for(const[n,s]of this.cache.entries())r-s.timestamp>s.ttl&&(this.cache.delete(n),e++);return e>0&&console.log(` [MockRedis] Cleaned ${e} expired entries`),e}}const xi=new yV;setInterval(()=>{xi.cleanExpired()},5*60*1e3);function xV(t){const[r,e]=Se.useState({hits:0,misses:0,lastUpdate:null}),n=Se.useCallback(()=>{const l=xi.getStats();e({hits:l.hits,misses:l.misses,lastUpdate:new Date().toISOString()})},[]),s=Se.useCallback(async(l,c)=>{const u=`excel_${l}_${c}`;try{const d=await xi.get(u);if(d)return n(),JSON.parse(d);const h=await mv.getExcelData(l,c);return h&&await xi.set(u,JSON.stringify(h),3600),n(),h}catch(d){return console.error("Error in getExcelData:",d),null}},[n]),a=Se.useCallback(async(l,c)=>{const u=`hour_${l}_${c}`;try{const d=await xi.get(u);if(d)return n(),JSON.parse(d);const h=await mv.getHourEntry(l,c);return h&&await xi.set(u,JSON.stringify(h),3600),n(),h}catch(d){return console.error("Error in getHourEntry:",d),null}},[n]),i=Se.useCallback(async(l,c)=>{try{await xi.set(`analysis_${l}`,JSON.stringify(c),7200),n()}catch(u){console.error("Error caching analysis:",u)}},[n]),o=Se.useCallback(async l=>{try{const c=await xi.get(`analysis_${l}`);return n(),c?JSON.parse(c):null}catch(c){return console.error("Error getting cached analysis:",c),null}},[n]);return Se.useEffect(()=>{n()},[n]),{cacheStats:r,getExcelData:s,getHourEntry:a,cacheAnalysis:i,getCachedAnalysis:o}}function wV(t,r){const[e,n]=Se.useState(null),[s,a]=Se.useState(!1),i=Se.useCallback(async(l,c)=>{const u=`${r}_${t}_${l}_${c}`;try{const d=await xi.get(u);if(d){const h=JSON.parse(d);return n(h),a(!0),console.log(` [AnalysisCache] Cache hit for ${u}`),h}return a(!1),console.log(` [AnalysisCache] Cache miss for ${u}`),null}catch(d){return console.error("Error checking analysis cache:",d),a(!1),null}},[t,r]),o=Se.useCallback(async(l,c,u)=>{const d=`${r}_${t}_${l}_${c}`;try{await xi.set(d,JSON.stringify(u),3600),n(u),console.log(` [AnalysisCache] Saved result to cache: ${d}`)}catch(h){console.error("Error saving to analysis cache:",h)}},[t,r]);return{cachedResult:e,cacheHit:s,checkCache:i,saveToCache:o}}class _V{static async saveResults(r,e,n=[],s=[]){try{console.log(` [Rule2Results] Saving results for user ${r}, date ${e}:`,{abcdNumbers:n,bcdNumbers:s});const{data:a,error:i}=await Lt.from("rule2_results").upsert({user_id:r,date:e,abcd_numbers:n,bcd_numbers:s},{onConflict:["user_id","date"],returning:"minimal"});return i?(console.error(" [Rule2Results] Error saving results:",i),{success:!1,error:i.message}):(console.log(` [Rule2Results] Successfully saved results for ${r}/${e}`),{success:!0,data:a})}catch(a){return console.error(" [Rule2Results] Exception saving results:",a),{success:!1,error:a.message}}}static async getResults(r,e){try{console.log(` [Rule2Results] Fetching results for user ${r}, date ${e}`);const{data:n,error:s}=await Lt.from("rule2_results").select("abcd_numbers, bcd_numbers, created_at, updated_at").eq("user_id",r).eq("date",e).single();return s?s.code==="PGRST116"?(console.log(` [Rule2Results] No results found for ${r}/${e}`),{success:!0,data:null}):(console.error(" [Rule2Results] Error fetching results:",s),{success:!1,error:s.message}):(console.log(` [Rule2Results] Found results for ${r}/${e}:`,n),{success:!0,data:n})}catch(n){return console.error(" [Rule2Results] Exception fetching results:",n),{success:!1,error:n.message}}}static async getMultipleResults(r,e){try{console.log(` [Rule2Results] Fetching multiple results for user ${r}, dates:`,e);const{data:n,error:s}=await Lt.from("rule2_results").select("date, abcd_numbers, bcd_numbers, created_at, updated_at").eq("user_id",r).in("date",e);if(s)return console.error(" [Rule2Results] Error fetching multiple results:",s),{success:!1,error:s.message};const a=new Map;return n&&n.forEach(i=>{a.set(i.date,{abcd_numbers:i.abcd_numbers||[],bcd_numbers:i.bcd_numbers||[],created_at:i.created_at,updated_at:i.updated_at})}),console.log(` [Rule2Results] Found ${a.size} results for ${e.length} dates`),{success:!0,data:a}}catch(n){return console.error(" [Rule2Results] Exception fetching multiple results:",n),{success:!1,error:n.message}}}static async deleteResults(r,e){try{console.log(` [Rule2Results] Deleting results for user ${r}, date ${e}`);const{error:n}=await Lt.from("rule2_results").delete().eq("user_id",r).eq("date",e);return n?(console.error(" [Rule2Results] Error deleting results:",n),{success:!1,error:n.message}):(console.log(` [Rule2Results] Successfully deleted results for ${r}/${e}`),{success:!0})}catch(n){return console.error(" [Rule2Results] Exception deleting results:",n),{success:!1,error:n.message}}}static async getResultDates(r){try{console.log(` [Rule2Results] Fetching all result dates for user ${r}`);const{data:e,error:n}=await Lt.from("rule2_results").select("date").eq("user_id",r).order("date",{ascending:!0});if(n)return console.error(" [Rule2Results] Error fetching result dates:",n),{success:!1,error:n.message};const s=e?e.map(a=>a.date):[];return console.log(` [Rule2Results] Found ${s.length} dates with results`),{success:!0,data:s}}catch(e){return console.error(" [Rule2Results] Exception fetching result dates:",e),{success:!1,error:e.message}}}}const Bm=(t,r,e,n,s={})=>{const{includeDetailedAnalysis:a=!1,logResults:i=!1,setName:o="Unknown"}=s;if(!Array.isArray(n)||n.length===0)return{abcdNumbers:[],bcdNumbers:[],detailedAnalysis:a?{}:void 0,error:"No D-day numbers provided"};const l=[],c=[],u=a?{}:null,d=(f,g)=>Array.isArray(f)&&f.includes(g);for(const f of n){const g=d(t,f),m=d(r,f),p=d(e,f),v=[g,m,p].filter(Boolean).length,b=[];if(g&&b.push("A"),m&&b.push("B"),p&&b.push("C"),u&&(u[f]={inA:g,inB:m,inC:p,abcCount:v,occurrences:[...b],qualified:!1,type:null,reason:""}),v>=2){l.push(f),u&&(u[f].qualified=!0,u[f].type="ABCD",u[f].reason=`Appears in ${v}/3 ABC days: ${b.join(", ")}`);continue}const y=m&&!p;y||p&&!m?(c.push(f),u&&(u[f].qualified=!0,u[f].type="BCD",u[f].reason=y?"B-D pair only":"C-D pair only")):u&&(v===1?u[f].reason=`Only in ${b.join(", ")} (need 2 for ABCD)`:m&&p?u[f].reason="In both B and C (violates BCD exclusivity)":u[f].reason="Not in any ABC days")}l.sort((f,g)=>f-g),c.sort((f,g)=>f-g),i&&(console.log(` Enhanced ABCD/BCD Analysis for ${o}:`),console.log(` D-day numbers: [${n.join(", ")}]`),console.log(` A-day numbers: [${t.join(", ")}]`),console.log(` B-day numbers: [${r.join(", ")}]`),console.log(` C-day numbers: [${e.join(", ")}]`),console.log(` ABCD results: [${l.join(", ")}] (${l.length} numbers)`),console.log(` BCD results: [${c.join(", ")}] (${c.length} numbers)`));const h={abcdNumbers:l,bcdNumbers:c,summary:{dDayCount:n.length,abcdCount:l.length,bcdCount:c.length,totalQualified:l.length+c.length,qualificationRate:((l.length+c.length)/n.length*100).toFixed(1)}};return a&&(h.detailedAnalysis=u),h};class SV{constructor(){this.dataService={hasExcelData:(r,e)=>lr.hasExcelData(r,e),getExcelData:(r,e)=>lr.getExcelData(r,e),hasHourEntry:(r,e)=>lr.hasHourEntry(r,e),getHourEntry:(r,e)=>lr.getHourEntry(r,e)},this.dateDataCache=new Map}extractElementNumber(r){if(typeof r!="string")return null;const e=r.match(/^[a-z]+-(\d+)[\/\-]/);return e?Number(e[1]):null}async preloadDateData(r,e){const n=e.map(async s=>{var a,i;try{const[o,l]=await Promise.all([this.dataService.getExcelData(r,s),this.dataService.getHourEntry(r,s)]);return console.log(` [Rule2Analysis] Data received for ${s}:`,{excelData:o?{hasDirectSets:!!o.sets,hasNestedSets:!!((a=o.data)!=null&&a.sets),directSetsCount:Object.keys(o.sets||{}).length,nestedSetsCount:Object.keys(((i=o.data)==null?void 0:i.sets)||{}).length}:null,hourData:l?{hasPlanetSelections:!!l.planetSelections,planetSelectionsCount:Object.keys(l.planetSelections||{}).length}:null}),this.dateDataCache.set(s,{excelData:o,hourData:l,sets:(o==null?void 0:o.sets)||{},planetSelections:(l==null?void 0:l.planetSelections)||{}}),{date:s,success:!0}}catch(o){return console.error(`Error preloading ${s}:`,o),this.dateDataCache.set(s,{excelData:null,hourData:null,sets:{},planetSelections:{}}),{date:s,success:!1}}});return Promise.all(n)}extractFromDateAndSet(r,e,n){const s=this.dateDataCache.get(r);if(console.log(` [Rule2Analysis] extractFromDateAndSet for ${r}, set ${e}:`,{cachedData:!!s,hasExcelData:!!(s!=null&&s.excelData),hasHourData:!!(s!=null&&s.hourData),selectedHR:n}),!s||!s.excelData||!s.hourData)return console.log(` Missing data for ${r}:`,{cachedData:!!s,excelData:!!(s!=null&&s.excelData),hourData:!!(s!=null&&s.hourData)}),[];const{sets:a,planetSelections:i}=s;console.log(` Data structure for ${r}:`,{availableSets:Object.keys(a),planetSelections:i,selectedHR:n,selectedPlanet:i[n]});const o=new Set,l=a[e];if(l){console.log(` Found set ${e}:`,Object.keys(l));const u=i[n];u?(console.log(` Using planet: ${u}`),Object.entries(l).forEach(([d,h])=>{const f=h[u];if(console.log(` Element ${d}:`,{planetData:Object.keys(h),selectedPlanet:u,rawString:f}),f){const g=this.extractElementNumber(f);console.log(` Extracted from "${f}": ${g}`),g!==null&&o.add(g)}})):console.log(` No planet selected for HR ${n}`)}else console.log(` Set ${e} not found. Available sets:`,Object.keys(a));const c=Array.from(o).sort((u,d)=>u-d);return console.log(` Final numbers for ${r}, set ${e}:`,c),c}processSetAnalysis(r,e,n,s,a,i){const o=this.extractFromDateAndSet(a,r,i),l=this.extractFromDateAndSet(s,r,i),c=this.extractFromDateAndSet(n,r,i),u=this.extractFromDateAndSet(e,r,i);if(o.length===0)return{setName:r,abcdNumbers:[],bcdNumbers:[],dDayCount:0,summary:{dDayCount:0,abcdCount:0,bcdCount:0,totalQualified:0,qualificationRate:"0.0"},error:"No D-day numbers found"};const d=Bm(u,c,l,o,{includeDetailedAnalysis:!1,logResults:!0,setName:r});return{setName:r,abcdNumbers:d.abcdNumbers,bcdNumbers:d.bcdNumbers,dDayCount:o.length,summary:d.summary,error:d.error||null}}createTopicMatcher(r,e){const n=new Map;return r.forEach(s=>{const a=s.match(/D-(\d+)\s+Set-(\d+)/);if(a){const[,i,o]=a,l=e.find(c=>{const u=c.match(/D-(\d+)(?:\s*\([^)]*\))?\s+Set-(\d+)/);if(u){const[,d,h]=u;return i===d&&o===h}return!1});l&&n.set(s,l)}}),n}getAllAvailableSets(r){const e=this.dateDataCache.get(r);if(console.log(` getAllAvailableSets for ${r}:`,{hasCache:!!e,hasExcelData:!!(e!=null&&e.excelData),setsKeys:Object.keys((e==null?void 0:e.sets)||{})}),!e||!e.excelData)return console.log(` No cached data or Excel data for ${r}`),[];const{sets:n}=e,s=Object.keys(n);console.log(" Available set names in data:",s);const a=["D-1 Set-1 Matrix","D-1 Set-2 Matrix","D-3 Set-1 Matrix","D-3 Set-2 Matrix","D-4 Set-1 Matrix","D-4 Set-2 Matrix","D-5 Set-1 Matrix","D-5 Set-2 Matrix","D-7 Set-1 Matrix","D-7 Set-2 Matrix","D-9 Set-1 Matrix","D-9 Set-2 Matrix","D-10 Set-1 Matrix","D-10 Set-2 Matrix","D-11 Set-1 Matrix","D-11 Set-2 Matrix","D-12 Set-1 Matrix","D-12 Set-2 Matrix","D-27 Set-1 Matrix","D-27 Set-2 Matrix","D-30 Set-1 Matrix","D-30 Set-2 Matrix","D-60 Set-1 Matrix","D-60 Set-2 Matrix","D-81 Set-1 Matrix","D-81 Set-2 Matrix","D-108 Set-1 Matrix","D-108 Set-2 Matrix","D-144 Set-1 Matrix","D-144 Set-2 Matrix"],i=this.createTopicMatcher(a,s),o=a.filter(l=>i.has(l)).map(l=>i.get(l));return console.log(" Filtered available sets (FIXED with Smart Matching):",{filteredSetsCount:o.length,filteredSets:o.slice(0,5),topicMappings:Array.from(i.entries()).slice(0,3),expectedTotal:30,actualFound:o.length,missingCount:30-o.length}),o}getAvailableHRs(r){const e=this.dateDataCache.get(r);if(!e||!e.hourData)return[];const{planetSelections:n}=e;return Object.keys(n).map(s=>parseInt(s)).sort((s,a)=>s-a)}calculateAbcdSequence(r,e){const n=[...e].sort((c,u)=>new Date(c)-new Date(u)),s=n.findIndex(c=>c===r);if(s<3)throw new Error(`Analysis requires the trigger date to have at least 3 preceding dates (A, B, C). Current position: ${s+1}, need position 4+`);const a=n[s],i=n[s-1],o=n[s-2],l=n[s-3];return console.log(" ABCD SEQUENCE CALCULATION:"),console.log(`  A-day: sortedDates[${s-3}] = ${l}`),console.log(`  B-day: sortedDates[${s-2}] = ${o}`),console.log(`  C-day: sortedDates[${s-1}] = ${i}`),console.log(`  D-day: sortedDates[${s}] = ${a}  ANALYSIS SOURCE`),{aDay:l,bDay:o,cDay:i,dDay:a}}async performRule2Analysis(r,e,n,s=1){try{console.log(` [Rule2Analysis] Starting analysis for ${e}, HR: ${s}`);const{aDay:a,bDay:i,cDay:o,dDay:l}=this.calculateAbcdSequence(e,n),c=[a,i,o,l];await this.preloadDateData(r,c);const u=this.getAllAvailableSets(l);if(console.log(" Available sets:",u),u.length===0)throw new Error("No available sets found for analysis");const d=u.map(R=>{const B=this.processSetAnalysis(R,a,i,o,l,s);return console.log(` ${R}: ABCD(${B.abcdNumbers.length}) BCD(${B.bcdNumbers.length}) D-day(${B.dDayCount})`),B}),h=new Set,f=new Set,g=new Set,m=new Set;u.forEach(R=>{const B=this.extractFromDateAndSet(l,R,s),q=this.extractFromDateAndSet(a,R,s),V=this.extractFromDateAndSet(i,R,s),I=this.extractFromDateAndSet(o,R,s);B.forEach(C=>h.add(C)),q.forEach(C=>f.add(C)),V.forEach(C=>g.add(C)),I.forEach(C=>m.add(C))});const p=Array.from(h),v=Array.from(f),b=Array.from(g),y=Array.from(m);console.log(" Combined numbers from all topics:"),console.log(` Total unique D-day numbers: ${p.length}`),console.log(` Total unique A-day numbers: ${v.length}`),console.log(` Total unique B-day numbers: ${b.length}`),console.log(` Total unique C-day numbers: ${y.length}`);const k=p.filter(R=>{let B=0;return v.includes(R)&&B++,b.includes(R)&&B++,y.includes(R)&&B++,B>=2&&console.log(` ABCD candidate ${R}: appears in ${B}/3 ABC days`),B>=2}),N=p.filter(R=>{const B=b.includes(R),q=y.includes(R),V=B&&!q,C=V||q&&!B;return C&&console.log(` BCD candidate ${R}: ${V?"B-D pair only":"C-D pair only"}`),C}),L=k.sort((R,B)=>R-B),F=N.filter(R=>{const B=k.includes(R);return B&&console.log(` Number ${R} excluded from BCD (already in ABCD)`),!B}).sort((R,B)=>R-B);return console.log(" Rule2Analysis Final Overall Results:"),console.log(" Overall ABCD Numbers:",L),console.log(" Overall BCD Numbers:",F),{success:!0,analysisDate:l,triggerDate:e,abcdNumbers:L,bcdNumbers:F,setResults:d,summary:{aDay:a,bDay:i,cDay:o,dDay:l,totalSets:u.length,selectedHR:s,availableHRs:this.getAvailableHRs(l)}}}catch(a){return console.error(" [Rule2Analysis] Error in analysis:",a),{success:!1,error:a.message,triggerDate:e}}}clearCache(){this.dateDataCache.clear()}}const kV=new SV;function EV({date:t,analysisDate:r,selectedUser:e,datesList:n,onBack:s,users:a}){const[i,o]=Se.useState(!0),[l,c]=Se.useState(""),[u,d]=Se.useState(null),[h,f]=Se.useState(null),[g,m]=Se.useState({}),[p,v]=Se.useState(""),[b,y]=Se.useState({}),[k,N]=Se.useState([]),[L,F]=Se.useState(new Set),[R,B]=Se.useState([]),[q,V]=Se.useState(!0),[I,C]=Se.useState({}),{getExcelData:O,getHourEntry:E,cacheAnalysis:x,getCachedAnalysis:w}=xV(),{cacheHit:_}=wV(e,"rule1");new bV,console.log(" Rule1Page using unified data service:",mv.getServiceInfo());const S=(ne,le)=>{const oe=new Map;return ne.forEach(ee=>{const Z=ee.match(/D-(\d+)\s+Set-(\d+)/);if(Z){const[,se,ie]=Z,ue=le.find(pe=>{const fe=pe.match(/D-(\d+)(?:\s*\([^)]*\))?\s+Set-(\d+)/);if(fe){const[,ye,Te]=fe;return se===ye&&ie===Te}return!1});ue&&oe.set(ee,ue)}}),oe},T=["D-1 Set-1 Matrix","D-1 Set-2 Matrix","D-3 Set-1 Matrix","D-3 Set-2 Matrix","D-4 Set-1 Matrix","D-4 Set-2 Matrix","D-5 Set-1 Matrix","D-5 Set-2 Matrix","D-7 Set-1 Matrix","D-7 Set-2 Matrix","D-9 Set-1 Matrix","D-9 Set-2 Matrix","D-10 Set-1 Matrix","D-10 Set-2 Matrix","D-11 Set-1 Matrix","D-11 Set-2 Matrix","D-12 Set-1 Matrix","D-12 Set-2 Matrix","D-27 Set-1 Matrix","D-27 Set-2 Matrix","D-30 Set-1 Matrix","D-30 Set-2 Matrix","D-60 Set-1 Matrix","D-60 Set-2 Matrix","D-81 Set-1 Matrix","D-81 Set-2 Matrix","D-108 Set-1 Matrix","D-108 Set-2 Matrix","D-144 Set-1 Matrix","D-144 Set-2 Matrix"],U=ne=>{if(typeof ne!="string")return null;const le=ne.match(/^[a-z]+-(\d+)[\/\-]/);return le?Number(le[1]):null},A=ne=>{if(typeof ne!="string")return ne;const le=ne.match(/^([a-z]+-\d+)-\/[a-z]+-\(\d+\s+([A-Za-z]+)/);if(le){const[,ee,Z]=le,se=Z.toLowerCase().slice(0,2);return`${ee}-${se}`}if(ne.match(/^[a-z]+-\d+-[a-z]{2}$/))return ne;const oe=ne.match(/^([a-z]+-\d+)/);return oe?oe[1]:ne},H=ne=>{const le=new Set(L);L.has(ne)?le.delete(ne):le.add(ne),F(le)},z=()=>{F(new Set(R))},K=()=>{F(new Set)},j=ne=>ne.replace(/\s+Matrix$/i,""),J=()=>L.size===0?R:R.filter(ne=>L.has(ne)),P=async()=>{var ne;try{o(!0),console.log(` [Rule-1 Enhanced] Loading data for user ${e}, display date: ${t}, analysis date: ${r||t}`);const le=`rule1_data_${e}_${t}`,oe=await w(le);if(oe&&_){console.log(" [Rule-1 Enhanced] Using cached data"),m(oe.allDaysData),B(oe.availableTopics),f(oe.activeHR),o(!1);return}const ee=[...n].sort((qe,We)=>new Date(qe)-new Date(We)),Z=r||t,se=ee.indexOf(Z);console.log(" [Rule-1 Enhanced] FIXED Past Days Logic:",{displayDate:t,analysisDate:Z,targetIndex:se,message:r?`Display: ${t}, Analyze: ${r} (rule2page logic)`:`Standard mode: ${t}`});let ie=ee;if(ie.length<4){c(`Rule-1 requires at least 4 total dates. Only ${ie.length} dates available.`),o(!1);return}const ue=ee.indexOf(t);if(ue>=3)v(`Complete Historical View (showing ${ie.length} dates including ${ue+1}th date)`);else{v("Insufficient Data"),c(`Rule-1 requires at least 4 total dates. Current date ${t} is the ${ue+1}th date.`),o(!1);return}const pe={};for(let qe=0;qe<ie.length;qe++){const We=ie[qe],at=We;console.log(` [Rule-1 Enhanced] Loading date ${qe+1}/${ie.length} (${We})...`);try{const Ye=await O(e,We),rt=await E(e,We);if(Ye&&rt){const ht=rt.planetSelections||{},Ce={};Object.entries(ht).forEach(([Ie,Ve])=>{var Xe;const De={selectedPlanet:Ve,sets:{}},Oe=((Xe=Ye.data)==null?void 0:Xe.sets)||Ye.sets||{};Object.entries(Oe).forEach(([nt,Je])=>{const wt={};Object.entries(Je).forEach(([gt,dt])=>{const ct=dt[Ve];wt[gt]={rawData:ct||null,selectedPlanet:Ve,hasData:!!ct}}),De.sets[nt]=wt}),Ce[Ie]=De}),pe[at]={date:We,hrData:Ce,success:Object.keys(Ce).length>0,index:qe,dateKey:at}}else pe[at]={date:We,hrData:{},success:!1,error:Ye?"No Hour Entry data":"No Excel data",index:qe,dateKey:at}}catch(Ye){pe[at]={date:We,hrData:{},success:!1,error:Ye.message||"Unknown error",index:qe,dateKey:at}}}m(pe);let fe=null;for(const qe of Object.keys(pe))if((ne=pe[qe])!=null&&ne.success){const We=Object.keys(pe[qe].hrData||{});if(We.length){fe=We[0];break}}fe&&f(fe);const ye=new Set;Object.values(pe).forEach(qe=>{qe.success&&qe.hrData&&Object.values(qe.hrData).forEach(We=>{Object.keys(We.sets||{}).forEach(at=>{ye.add(at)})})});const Te=Array.from(ye),Pe=S(T,Te),je=T.filter(qe=>Pe.has(qe)).map(qe=>Pe.get(qe));console.log(" [Rule1Page] Topic Discovery (FIXED with Smart Matching):",{discoveredSetsRaw:Te,discoveredSetsCount:ye.size,orderedTopicsCount:je.length,orderedTopics:je.slice(0,5),topicMappings:Array.from(Pe.entries()).slice(0,3),expectedTotal:30,actualFound:je.length,missingCount:30-je.length}),B(je),F(new Set(je)),await x(le,{allDaysData:pe,availableTopics:je,activeHR:fe}),o(!1)}catch(le){console.error(" [Rule-1 Enhanced] Error building all days data:",le),c(`Error loading data: ${le.message||"Unknown error occurred"}`),o(!1)}},D=async()=>{try{console.log(" [Rule1Page] Loading Rule-2 ABCD/BCD analysis results using real-time analysis...");const ne=Object.keys(g).sort((oe,ee)=>new Date(oe)-new Date(ee));if(ne.length===0){console.log(" [Rule1Page] No dates available for Rule-2 analysis");return}console.log(" [Rule1Page] Implementing (N-1) day pattern for Past Days...");const le={};for(let oe=0;oe<ne.length;oe++){const ee=ne[oe];if(oe>0){const Z=ne[oe-1];console.log(` [Rule1Page] Processing Past Days: "${ee}" shows ABCD/BCD from "${Z}"`),console.log(` [Rule1Page] Available dates for analysis: [${ne.slice(0,oe+1).join(", ")}]`);try{const se=ne.slice(0,oe+1);console.log(" [Rule1Page] Calling rule2AnalysisService.performRule2Analysis with:"),console.log(`   - User: ${e}`),console.log(`   - Trigger Date: ${Z}`),console.log(`   - Dates List: [${se.join(", ")}]`),console.log(`   - HR: ${h||1}`);const ie=await kV.performRule2Analysis(e,Z,se,h||1);if(ie.success){console.log(` [Rule1Page] Real-time analysis SUCCESS for "${Z}" (shown in "${ee}"):`),console.log(`    ABCD Numbers: [${ie.abcdNumbers.join(", ")}] (${ie.abcdNumbers.length} total)`),console.log(`    BCD Numbers: [${ie.bcdNumbers.join(", ")}] (${ie.bcdNumbers.length} total)`),console.log(`    Analysis Date: ${ie.analysisDate}`),console.log("    Summary:",ie.summary),console.log(" [Rule1Page] Expected specific numbers - ABCD: [7, 10], BCD: [3, 6, 8] (from D-1 Set-1 Matrix)"),console.log(` [Rule1Page] Received overall numbers - ABCD: [${ie.abcdNumbers.join(", ")}], BCD: [${ie.bcdNumbers.join(", ")}]`),console.log(" [Rule1Page] Getting individual topic analyses instead of overall analysis...");const ue=ie.setResults||[];console.log(` [Rule1Page] Found ${ue.length} topic-specific results`),ue.forEach(pe=>{const fe=pe.setName;le[fe]||(le[fe]={}),console.log(` [Rule1Page] Topic "${fe}" individual analysis:`,{abcdCount:pe.abcdNumbers.length,bcdCount:pe.bcdNumbers.length,abcdNumbers:pe.abcdNumbers,bcdNumbers:pe.bcdNumbers}),le[fe][ee]={abcdNumbers:pe.abcdNumbers||[],bcdNumbers:pe.bcdNumbers||[],source:"rule2_topic_specific",date:ee,analysisDate:Z,pattern:"N-1",topicName:fe}}),console.log(` [Rule1Page] Successfully stored topic-specific ABCD/BCD data for ${ue.length} topics on date "${ee}"`)}else console.error(` [Rule1Page] Real-time analysis FAILED for "${Z}":`,ie.error),console.log(" [Rule1Page] Analysis details:",ie)}catch(se){console.error(` [Rule1Page] Error in real-time analysis for "${Z}":`,se)}}else console.log(` [Rule1Page] Skipping first date "${ee}" - no previous date for N-1 pattern`)}if(Object.keys(le).length>0){console.log(` [Rule1Page] Setting real-time ABCD/BCD analysis data for ${Object.keys(le).length} topics`),console.log(" [Rule1Page] Past Days dates processed:",Object.keys(le[R[0]]||{}));const oe=R[0];oe&&le[oe]&&console.log(` [Rule1Page] Sample analysis data for topic "${oe}":`,le[oe]),y(le),console.log(" [Rule1Page] abcdBcdAnalysis state updated successfully")}else console.log(" [Rule1Page] No real-time ABCD/BCD numbers generated for any dates"),console.log(" [Rule1Page] This could mean:"),console.log("   - No dates had sufficient data for Rule2 analysis"),console.log("   - All Rule2 analyses failed"),console.log("   - Not enough dates available (need at least 4 dates for Rule2)")}catch(ne){console.error(" [Rule1Page] Error loading real-time Rule-2 analysis results:",ne)}};Se.useEffect(()=>{e&&n&&t&&P()},[e,n,t]),Se.useEffect(()=>{Object.keys(g).length>0&&R.length>0&&e&&D()},[g,R,e]);const G=(ne,le,oe)=>{if(ne===""||ne==="(No Data)")return ne;const ee=U(ne);if(ee===null)return ne;const Z=b[le];if(!Z||!Z[oe])return ne;const se=Z[oe],ie=se.abcdNumbers||[],ue=se.bcdNumbers||[];return(ie.includes(ee)||ue.includes(ee))&&console.log(` [Rule1Page] MATCH FOUND! Element ${ee} in "${le}" on "${oe}":`,{displayValue:ne,elementNumber:ee,abcdNumbers:ie,bcdNumbers:ue,isInAbcd:ie.includes(ee),isInBcd:ue.includes(ee)}),ie.includes(ee)?(console.log(` [Rule1Page] Rendering ABCD tag for number ${ee} (expected: 7, 10)`),X.jsxs("div",{className:"flex items-center justify-center gap-1",children:[X.jsx("span",{className:"text-data-value",children:ne}),X.jsx("span",{className:"bg-green-200 text-green-800 text-xs font-medium px-1 py-0.5 rounded",children:"ABCD"})]})):ue.includes(ee)?(console.log(` [Rule1Page] Rendering BCD tag for number ${ee} (expected: 3, 6, 8)`),X.jsxs("div",{className:"flex items-center justify-center gap-1",children:[X.jsx("span",{className:"text-data-value",children:ne}),X.jsx("span",{className:"bg-blue-200 text-blue-800 text-xs font-medium px-1 py-0.5 rounded",children:"BCD"})]})):ne};if(i)return X.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center",children:X.jsxs("div",{className:"text-center",children:[X.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),X.jsx("p",{className:"text-gray-600",children:"Loading enhanced Rule-1 analysis..."})]})});if(l)return X.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-6",children:X.jsx("div",{className:"container mx-auto",children:X.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:X.jsxs("div",{className:"text-center",children:[X.jsx("div",{className:"text-red-400 text-6xl mb-4",children:""}),X.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error Loading Rule-1 Data"}),X.jsx("p",{className:"text-red-600 mb-6",children:l}),X.jsx("button",{onClick:s,className:"bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg",children:" Go Back"})]})})})});const re=Object.keys(g).sort((ne,le)=>new Date(ne)-new Date(le)),te=J();return X.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 w-full",children:X.jsxs("div",{className:"w-full px-6 py-6",children:[X.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 mb-6 border-t-4 border-purple-600",children:[X.jsxs("div",{className:"flex items-center justify-between",children:[X.jsxs("div",{children:[X.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Past Days"}),X.jsxs("div",{className:"text-sm text-purple-800 mt-1",children:[X.jsxs("p",{children:[" User ID: ",e]}),X.jsxs("p",{children:[" Target Date: ",t]}),r&&r!==t&&X.jsxs("p",{children:[" Analysis Source: ",r," (rule2page logic)"]}),X.jsx("p",{children:" ABCD/BCD Pattern: (N-1) Past Days - Real-time Topic-Specific Rule2 Analysis"}),X.jsxs("p",{children:[" ",p]})]})]}),X.jsx("div",{className:"flex gap-2",children:X.jsx("button",{onClick:s,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:" Back to Main"})})]}),"        "]}),h&&X.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6 p-4",children:X.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{const ne=new Set;return re.forEach(le=>{var oe;(oe=g[le])!=null&&oe.success&&Object.keys(g[le].hrData||{}).forEach(ee=>ne.add(ee))}),Array.from(ne).sort((le,oe)=>parseInt(le)-parseInt(oe))})().map(ne=>X.jsxs("button",{onClick:()=>f(ne),className:`px-3 py-1 rounded text-sm transition-colors ${h===ne?"bg-purple-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:["HR ",ne]},ne))})}),q&&X.jsxs("div",{className:"bg-white rounded-lg shadow-md mb-6 p-4",children:[X.jsxs("div",{className:"flex items-center justify-between mb-4",children:[X.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:" Topic Selection"}),X.jsxs("div",{className:"flex gap-2",children:[X.jsx("button",{onClick:z,className:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm",children:"Select All"}),X.jsx("button",{onClick:K,className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm",children:"Clear All"}),X.jsx("button",{onClick:()=>V(!1),className:"bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm",children:"Hide"})]})]}),X.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2",children:R.map(ne=>X.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[X.jsx("input",{type:"checkbox",checked:L.has(ne),onChange:()=>H(ne),className:"rounded border-gray-300"}),X.jsx("span",{className:"truncate",children:j(ne)})]},ne))}),X.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Selected: ",L.size," / ",R.length," topics"]})]}),!q&&X.jsx("div",{className:"mb-4",children:X.jsxs("button",{onClick:()=>V(!0),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm",children:[" Show Topic Selection (",L.size," selected)"]})}),X.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full",children:[X.jsxs("div",{className:"p-4 bg-gray-50 border-b sticky top-0 z-10",children:[X.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:[" Rule-1 Matrix Analysis",h&&` - HR ${h}`]}),X.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Showing ",te.length," topics across ",re.length," dates"]})]}),X.jsx("div",{className:"p-4 space-y-6",children:te.length>0?te.map(ne=>X.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[X.jsxs("div",{className:"bg-blue-100 p-3 font-bold text-lg rounded-t-lg border-b border-gray-200 sticky top-[88px] z-[5]",children:[" ",j(ne)]}),X.jsx("div",{className:"overflow-x-auto",children:X.jsxs("table",{className:"w-full border-collapse min-w-max",children:[X.jsx("thead",{className:"bg-gray-100",children:X.jsxs("tr",{children:[X.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left font-medium text-gray-700 min-w-[120px]",children:"Element"}),re.map(le=>{const oe=new Date(le),ee=oe.getDate(),Z=oe.getMonth()+1,se=oe.getFullYear().toString().slice(-2),ie=`${ee}-${Z}-${se}`,ue=(()=>{const Pe=g[le];return Pe!=null&&Pe.success&&Pe.hrData[h]&&Pe.hrData[h].selectedPlanet||""})(),pe=()=>{const Pe=b[ne];if(!Pe||!Pe[le])return{abcdNumbers:[],bcdNumbers:[]};const je=Pe[le];return{abcdNumbers:je.abcdNumbers||[],bcdNumbers:je.bcdNumbers||[]}},{abcdNumbers:fe,bcdNumbers:ye}=pe(),Te=fe.length>0||ye.length>0;return X.jsxs("th",{className:`border border-gray-300 px-3 py-2 text-center font-medium text-sm min-w-[140px] ${le===t?"bg-blue-500 text-white":"text-gray-700"}`,children:[X.jsxs("div",{className:"text-base font-semibold",children:[ie," ",ue]}),le===t&&X.jsx("div",{className:"text-xs font-bold",children:"TARGET"}),Te&&X.jsxs("div",{className:"mt-1 text-xs",children:[fe.length>0&&X.jsxs("div",{className:`${le===t?"text-green-200":"text-green-600"} font-medium`,children:["ABCD: [",fe.join(", "),"]"]}),ye.length>0&&X.jsxs("div",{className:`${le===t?"text-blue-200":"text-blue-600"} font-medium`,children:["BCD: [",ye.join(", "),"]"]})]}),Te&&le!==t&&X.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"(N-1 Pattern)"})]},le)})]})}),X.jsx("tbody",{children:["Lagna","Moon","Hora Lagna","Ghati Lagna","Vighati Lagna","Varnada Lagna","Sree Lagna","Pranapada Lagna","Indu Lagna"].map(oe=>X.jsxs("tr",{className:"hover:bg-gray-50",children:[X.jsx("td",{className:"border border-gray-300 px-4 py-2 font-medium bg-blue-200 min-w-[120px]",children:oe}),re.map(ee=>{var fe;const Z=g[ee];let se="",ie=!1;if(Z!=null&&Z.success&&((fe=Z.hrData[h])!=null&&fe.sets[ne])&&Z.hrData[h].sets[ne][oe]){const ye=Z.hrData[h].sets[ne][oe];ie=ye.hasData;const Te=ye.rawData||"";se=Te===""?Te:A(Te)}const ue="border border-gray-300 px-3 py-2 text-center font-mono text-sm min-w-[140px]",pe=ee===t;return X.jsx("td",{className:`${ue} ${pe?"ring-2 ring-blue-400 bg-blue-50":ie?"bg-green-50 text-gray-800":"bg-red-50 text-gray-400"}`,children:G(se,ne,ee)},ee)})]},oe))})]})})]},ne)):X.jsxs("div",{className:"text-center py-12 text-gray-500",children:[X.jsx("div",{className:"text-6xl mb-4",children:""}),X.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Topics Selected"}),X.jsx("p",{children:"Please select topics to view the analysis matrix."})]})})]})]})})}class AV{static async saveAnalysisResults(r,e,n,s,a=[],i=[],o=[],l={}){try{console.log(` [Rule2AnalysisResults] Saving analysis results for ${r} on ${e}`),console.log(` [Rule2AnalysisResults] Overall numbers - ABCD: [${a.join(", ")}], BCD: [${i.join(", ")}]`),console.log(` [Rule2AnalysisResults] Topic results: ${o.length} topics`);const c={};o.forEach(m=>{c[m.setName]={abcd:m.abcdNumbers||[],bcd:m.bcdNumbers||[]}}),Object.keys(c).slice(0,3).forEach(m=>{const p=c[m];console.log(` [Rule2AnalysisResults] ${m}: ABCD[${p.abcd.join(",")}] BCD[${p.bcd.join(",")}]`)});const d={user_id:r,analysis_date:e,trigger_date:n,selected_hr:s,overall_abcd_numbers:a,overall_bcd_numbers:i,topic_numbers:c,total_topics:o.length,a_day:l.aDay,b_day:l.bDay,c_day:l.cDay,d_day:l.dDay,updated_at:new Date().toISOString()},{data:h,error:f}=await Lt.from("rule2_analysis_results").select("id").eq("user_id",r).eq("analysis_date",e).single();let g;if(h&&!f){console.log(` [Rule2AnalysisResults] Updating existing record for ${e}`);const{data:m,error:p}=await Lt.from("rule2_analysis_results").update(d).eq("id",h.id).select().single();g={data:m,error:p}}else{console.log(` [Rule2AnalysisResults] Creating new record for ${e}`);const{data:m,error:p}=await Lt.from("rule2_analysis_results").insert(d).select().single();g={data:m,error:p}}return g.error?(console.error(" [Rule2AnalysisResults] Database error:",g.error),{success:!1,error:g.error.message}):(console.log(` [Rule2AnalysisResults] Successfully saved analysis results for ${e}`),{success:!0,data:g.data})}catch(c){return console.error(" [Rule2AnalysisResults] Exception saving results:",c),{success:!1,error:c.message}}}static async getLatestAnalysisResults(r,e=1){var n,s;try{console.log(` [Rule2AnalysisResults] Fetching latest analysis results for ${r}`);const{data:a,error:i}=await Lt.from("rule2_analysis_results").select("*").eq("user_id",r).order("analysis_date",{ascending:!1}).limit(e);if(i)return console.error(" [Rule2AnalysisResults] Database error:",i),{success:!1,error:i.message};if(!a||a.length===0)return console.log(` [Rule2AnalysisResults] No analysis results found for ${r}`),{success:!0,data:null};const o=a[0];return console.log(` [Rule2AnalysisResults] Found analysis result for ${o.analysis_date}`),console.log(` [Rule2AnalysisResults] Overall - ABCD: ${((n=o.overall_abcd_numbers)==null?void 0:n.length)||0}, BCD: ${((s=o.overall_bcd_numbers)==null?void 0:s.length)||0}`),console.log(` [Rule2AnalysisResults] Topics: ${Object.keys(o.topic_numbers||{}).length}`),{success:!0,data:o}}catch(a){return console.error(" [Rule2AnalysisResults] Exception fetching results:",a),{success:!1,error:a.message}}}static async getAnalysisResultsByDate(r,e){try{console.log(` [Rule2AnalysisResults] Fetching analysis results for ${r} on ${e}`);const{data:n,error:s}=await Lt.from("rule2_analysis_results").select("*").eq("user_id",r).eq("analysis_date",e).single();return s?s.code==="PGRST116"?(console.log(` [Rule2AnalysisResults] No analysis results found for ${e}`),{success:!0,data:null}):(console.error(" [Rule2AnalysisResults] Database error:",s),{success:!1,error:s.message}):(console.log(` [Rule2AnalysisResults] Found analysis result for ${e}`),{success:!0,data:n})}catch(n){return console.error(" [Rule2AnalysisResults] Exception fetching results:",n),{success:!1,error:n.message}}}static async getTopicNumbers(r,e){var n,s,a;try{const i=await this.getLatestAnalysisResults(r);if(!i.success||!i.data)return{success:!1,error:"No analysis results found"};const o=(n=i.data.topic_numbers)==null?void 0:n[e];return o?(console.log(` [Rule2AnalysisResults] ${e}: ABCD[${((s=o.abcd)==null?void 0:s.join(","))||""}] BCD[${((a=o.bcd)==null?void 0:a.join(","))||""}]`),{success:!0,data:{abcd:o.abcd||[],bcd:o.bcd||[]}}):(console.log(` [Rule2AnalysisResults] Topic '${e}' not found in analysis results`),{success:!0,data:{abcd:[],bcd:[]}})}catch(i){return console.error(" [Rule2AnalysisResults] Exception getting topic numbers:",i),{success:!1,error:i.message}}}static async hasAnalysisResults(r,e){try{const n=await this.getAnalysisResultsByDate(r,e);return n.success&&n.data!==null}catch(n){return console.error(" [Rule2AnalysisResults] Exception checking if results exist:",n),!1}}static async deleteAnalysisResults(r,e){try{console.log(` [Rule2AnalysisResults] Deleting analysis results for ${r} on ${e}`);const{error:n}=await Lt.from("rule2_analysis_results").delete().eq("user_id",r).eq("analysis_date",e);return n?(console.error(" [Rule2AnalysisResults] Database error:",n),{success:!1,error:n.message}):(console.log(` [Rule2AnalysisResults] Successfully deleted analysis results for ${e}`),{success:!0})}catch(n){return console.error(" [Rule2AnalysisResults] Exception deleting results:",n),{success:!1,error:n.message}}}}const CV=({date:t,selectedUser:r,selectedUserData:e,datesList:n,onBack:s,activeHR:a})=>{const i=mo(),o=r,[l,c]=Se.useState([]),[u,d]=Se.useState(!0),[h,f]=Se.useState(0),[g,m]=Se.useState("Initializing..."),[p,v]=Se.useState(""),[b,y]=Se.useState({}),[k,N]=Se.useState(a||1),[L,F]=Se.useState([]),[R,B]=Se.useState(null),q={hasExcelData:(P,D)=>lr.hasExcelData(P,D),getExcelData:(P,D)=>lr.getExcelData(P,D),hasHourEntry:(P,D)=>lr.hasHourEntry(P,D),getHourEntry:(P,D)=>lr.getHourEntry(P,D)},V=P=>{N(P),R&&clearTimeout(R);const D=setTimeout(()=>{P!==k&&(console.log(" HR changed, triggering re-analysis..."),performAnalysis())},500);B(D)};Se.useEffect(()=>()=>{R&&clearTimeout(R)},[R]);const I=P=>{if(typeof P!="string")return null;const D=P.match(/^[a-z]+-(\d+)[\/\-]/);return D?Number(D[1]):null},C=new Map,O=async P=>{const D=P.map(async G=>{var re,te;try{const[ne,le]=await Promise.all([q.getExcelData(o,G),q.getHourEntry(o,G)]);return console.log(` [DEBUG] Data received for ${G}:`,{excelData:ne?{hasDirectSets:!!ne.sets,hasNestedSets:!!((re=ne.data)!=null&&re.sets),directSetsCount:Object.keys(ne.sets||{}).length,nestedSetsCount:Object.keys(((te=ne.data)==null?void 0:te.sets)||{}).length,structure:Object.keys(ne)}:null,hourData:le?{hasPlanetSelections:!!le.planetSelections,planetSelectionsCount:Object.keys(le.planetSelections||{}).length,structure:Object.keys(le)}:null}),C.set(G,{excelData:ne,hourData:le,sets:(ne==null?void 0:ne.sets)||{},planetSelections:(le==null?void 0:le.planetSelections)||{}}),{date:G,success:!0}}catch(ne){return console.error(`Error preloading ${G}:`,ne),C.set(G,{excelData:null,hourData:null,sets:{},planetSelections:{}}),{date:G,success:!1}}});return Promise.all(D)},E=(P,D)=>{const G=C.get(P);if(console.log(` Debug extractFromDateAndSet for ${P}, set ${D}:`,{cachedData:!!G,hasExcelData:!!(G!=null&&G.excelData),hasHourData:!!(G!=null&&G.hourData),selectedHR:k}),!G||!G.excelData||!G.hourData)return console.log(` Missing data for ${P}:`,{cachedData:!!G,excelData:!!(G!=null&&G.excelData),hourData:!!(G!=null&&G.hourData)}),[];const{sets:re,planetSelections:te}=G;console.log(` Data structure for ${P}:`,{availableSets:Object.keys(re),planetSelections:te,selectedHR:k,selectedPlanet:te[k]});const ne=new Set,le=re[D];if(le){console.log(` Found set ${D}:`,Object.keys(le));const ee=te[k];ee?(console.log(` Using planet: ${ee}`),Object.entries(le).forEach(([Z,se])=>{const ie=se[ee];if(console.log(` Element ${Z}:`,{planetData:Object.keys(se),selectedPlanet:ee,rawString:ie}),ie){const ue=I(ie);console.log(` Extracted from "${ie}": ${ue}`),ue!==null&&ne.add(ue)}})):console.log(` No planet selected for HR ${k}`)}else console.log(` Set ${D} not found. Available sets:`,Object.keys(re));const oe=Array.from(ne).sort((ee,Z)=>ee-Z);return console.log(` Final numbers for ${P}, set ${D}:`,oe),oe},x=(P,D,G,re,te)=>{const ne=E(te,P),le=E(re,P),oe=E(G,P),ee=E(D,P);if(ne.length===0)return{setName:P,abcdNumbers:[],bcdNumbers:[],dDayCount:0,summary:{dDayCount:0,abcdCount:0,bcdCount:0,totalQualified:0,qualificationRate:"0.0"},error:"No D-day numbers found"};const Z=Bm(ee,oe,le,ne,{includeDetailedAnalysis:!1,logResults:!0,setName:P});return{setName:P,abcdNumbers:Z.abcdNumbers,bcdNumbers:Z.bcdNumbers,dDayCount:ne.length,summary:Z.summary,error:Z.error||null}},w=(P,D)=>{const G=new Map;return P.forEach(re=>{const te=re.match(/D-(\d+)\s+Set-(\d+)/);if(te){const[,ne,le]=te,oe=D.find(ee=>{const Z=ee.match(/D-(\d+)(?:\s*\([^)]*\))?\s+Set-(\d+)/);if(Z){const[,se,ie]=Z;return ne===se&&le===ie}return!1});oe&&G.set(re,oe)}}),G},_=["D-1 Set-1 Matrix","D-1 Set-2 Matrix","D-3 Set-1 Matrix","D-3 Set-2 Matrix","D-4 Set-1 Matrix","D-4 Set-2 Matrix","D-5 Set-1 Matrix","D-5 Set-2 Matrix","D-7 Set-1 Matrix","D-7 Set-2 Matrix","D-9 Set-1 Matrix","D-9 Set-2 Matrix","D-10 Set-1 Matrix","D-10 Set-2 Matrix","D-11 Set-1 Matrix","D-11 Set-2 Matrix","D-12 Set-1 Matrix","D-12 Set-2 Matrix","D-27 Set-1 Matrix","D-27 Set-2 Matrix","D-30 Set-1 Matrix","D-30 Set-2 Matrix","D-60 Set-1 Matrix","D-60 Set-2 Matrix","D-81 Set-1 Matrix","D-81 Set-2 Matrix","D-108 Set-1 Matrix","D-108 Set-2 Matrix","D-144 Set-1 Matrix","D-144 Set-2 Matrix"],S=P=>{const D=C.get(P);if(console.log(` getAllAvailableSets for ${P}:`,{hasCache:!!D,hasExcelData:!!(D!=null&&D.excelData),setsKeys:Object.keys((D==null?void 0:D.sets)||{})}),!D||!D.excelData)return console.log(` No cached data or Excel data for ${P}`),[];const{sets:G}=D,re=Object.keys(G);console.log(" Available set names in data:",re),console.log(" TOPIC_ORDER filter:",_);const te=w(_,re),ne=_.filter(le=>te.has(le)).map(le=>te.get(le));return console.log(" Filtered available sets (FIXED with Smart Matching):",{filteredSetsCount:ne.length,filteredSets:ne.slice(0,5),topicMappings:Array.from(te.entries()).slice(0,3)}),ne},T=P=>{const D=C.get(P);if(!D||!D.hourData)return[];const{planetSelections:G}=D;return Object.keys(G).map(re=>parseInt(re)).sort((re,te)=>re-te)};if(Se.useEffect(()=>{(async()=>{if(f(0),m("Initializing analysis..."),!(n!=null&&n.length)){v("Date list is empty or invalid."),d(!1);return}if(n.length<4){v("Need at least 4 dates to perform ABCD-BCD number extraction"),d(!1);return}try{f(10),m("Sorting dates...");const D=[...n].sort((ht,Ce)=>new Date(ht)-new Date(Ce));console.log(" === RULE2COMPACT DATE SEQUENCE DEBUG ==="),console.log(" Received date (clicked):",t,typeof t),console.log(" Received datesList:",n),console.log(" Sorted dates:",D);const G=D.findIndex(ht=>ht===t);if(console.log(` Clicked date "${t}" found at index ${G} (position ${G+1})`),G===-1&&(console.log(" CRITICAL: Clicked date not found in sorted dates!"),console.log(" Attempting string comparison:"),D.forEach((ht,Ce)=>{console.log(`  ${Ce}: "${ht}" === "${t}"  ${ht===t}`),console.log(`  ${Ce}: Date objects: ${new Date(ht).getTime()} === ${new Date(t).getTime()}  ${new Date(ht).getTime()===new Date(t).getTime()}`)})),G<3){v(`Rule-2 requires the clicked date to have at least 3 preceding dates (A, B, C). Current position: ${G+1}, need position 4+`),d(!1);return}f(20),m("Determining ABCD sequence...");const re=D[G],te=D[G-1],ne=D[G-2],le=D[G-3];console.log(" ABCD SEQUENCE CALCULATION (FIXED):"),console.log(`  A-day: sortedDates[${G-3}] = ${le}`),console.log(`  B-day: sortedDates[${G-2}] = ${ne}`),console.log(`  C-day: sortedDates[${G-1}] = ${te}`),console.log(`  D-day: sortedDates[${G}] = ${re}  ANALYSIS SOURCE (CLICKED DATE)`),console.log(`   User clicked "${t}" and will see data from "${re}"`),console.log("========================================"),f(30),m(" Pre-loading all date data...");const oe=[le,ne,te,re];await O(oe),console.log(" === DATA PIPELINE DEBUG ==="),console.log(" Dates to process:",{aDay:le,bDay:ne,cDay:te,dDay:re}),console.log(" User ID:",o),console.log(" Selected HR:",k),oe.forEach(ht=>{const Ce=C.get(ht);console.log(` ${ht} data:`,{hasCache:!!Ce,hasExcelData:!!(Ce!=null&&Ce.excelData),hasHourData:!!(Ce!=null&&Ce.hourData),setsCount:Object.keys((Ce==null?void 0:Ce.sets)||{}).length,planetSelectionsCount:Object.keys((Ce==null?void 0:Ce.planetSelections)||{}).length,sets:Object.keys((Ce==null?void 0:Ce.sets)||{}),planetSelections:Ce==null?void 0:Ce.planetSelections})}),f(40),m("Getting available HRs...");const ee=T(re);F(ee),ee.length>0&&!ee.includes(k)&&N(ee[0]),f(50),m("Getting available sets..."),console.log(" Rule2CompactPage - Processing all sets:"),console.log("Clicked date (Rule-2 trigger):",t),console.log("A-day (oldest in sequence):",le),console.log("B-day:",ne),console.log("C-day:",te),console.log("D-day (analysis day):",re),console.log(" Available HRs:",ee,"Selected HR:",k);const Z=S(re);console.log(" Available sets:",Z),f(60),m(` Analyzing ${Z.length} sets in parallel...`);const se=[],ie=10;for(let ht=0;ht<Z.length;ht+=ie){const Ce=Z.slice(ht,ht+ie),Ie=60+Math.floor((ht+Ce.length)/Z.length*30);f(Ie),m(`Processing batch ${Math.floor(ht/ie)+1}/${Math.ceil(Z.length/ie)}: ${Ce.length} sets`);const Ve=Ce.map(De=>{const Oe=x(De,le,ne,te,re);if(console.log(` ${De}: ABCD(${Oe.abcdNumbers.length}) BCD(${Oe.bcdNumbers.length}) D-day(${Oe.dDayCount})`),De==="D-1 Set-1 Matrix"){console.log(` [D-1 Set-1 HR Debug] Current HR ${k} Results:`,{abcd:Oe.abcdNumbers,bcd:Oe.bcdNumbers,dDayCount:Oe.dDayCount}),console.log(" [D-1 Set-1 HR Comparison] Testing all HRs for D-1 Set-1 Matrix:");for(let Xe=1;Xe<=6;Xe++)try{const nt=C.get(re);if(nt&&nt.hourData&&nt.hourData.planetSelections[Xe]){const Je=nt.hourData.planetSelections[Xe],wt=[];if(nt.excelData&&nt.excelData.sets&&nt.excelData.sets[De]){const gt=nt.excelData.sets[De];Object.entries(gt).forEach(([dt,ct])=>{const ut=ct[Je];if(ut){const ft=I(ut);ft!==null&&wt.push(ft)}})}console.log(`   HR ${Xe} (Planet ${Je}): D-day numbers [${wt.sort((gt,dt)=>gt-dt).join(", ")}]`)}else console.log(`   HR ${Xe}: No data available`)}catch(nt){console.log(`   HR ${Xe}: Error - ${nt.message}`)}}return Oe});se.push(...Ve),ht+ie<Z.length&&await new Promise(De=>setTimeout(De,10))}f(90),m("Calculating overall ABCD/BCD results...");const ue=new Set,pe=new Set,fe=new Set,ye=new Set;Z.forEach(ht=>{const Ce=E(re,ht),Ie=E(le,ht),Ve=E(ne,ht),De=E(te,ht);Ce.forEach(Oe=>ue.add(Oe)),Ie.forEach(Oe=>pe.add(Oe)),Ve.forEach(Oe=>fe.add(Oe)),De.forEach(Oe=>ye.add(Oe))});const Te=Array.from(ue),Pe=Array.from(pe),je=Array.from(fe),qe=Array.from(ye);console.log(" Combined numbers from all topics:"),console.log(` Total unique D-day numbers: ${Te.length}`),console.log(` Total unique A-day numbers: ${Pe.length}`),console.log(` Total unique B-day numbers: ${je.length}`),console.log(` Total unique C-day numbers: ${qe.length}`);const We=Te.filter(ht=>{let Ce=0;return Pe.includes(ht)&&Ce++,je.includes(ht)&&Ce++,qe.includes(ht)&&Ce++,Ce>=2&&console.log(` ABCD candidate ${ht}: appears in ${Ce}/3 ABC days`),Ce>=2}),at=Te.filter(ht=>{const Ce=je.includes(ht),Ie=qe.includes(ht),Ve=Ce&&!Ie,Oe=Ve||Ie&&!Ce;return Oe&&console.log(` BCD candidate ${ht}: ${Ve?"B-D pair only":"C-D pair only"}`),Oe}),Ye=We.sort((ht,Ce)=>ht-Ce),rt=at.filter(ht=>{const Ce=We.includes(ht);return Ce&&console.log(` Number ${ht} excluded from BCD (already in ABCD)`),!Ce}).sort((ht,Ce)=>ht-Ce);console.log(" Rule2CompactPage Final Overall Results:"),console.log(" Overall ABCD Numbers:",Ye),console.log(" Overall BCD Numbers:",rt),console.log(" Filtering Summary:"),console.log(`    Total D-day numbers from all topics: ${Te.length}`),console.log(`    ABCD candidates (2 in A,B,C): ${We.length}`),console.log(`    BCD candidates (exclusive B-D or C-D): ${at.length}`),console.log(`    Final ABCD (after priority): ${Ye.length}`),console.log(`    Final BCD (after exclusion): ${rt.length}`),f(95),m("Saving results to database...");try{const ht=await _V.saveResults(o,t,Ye,rt);ht.success?console.log(` [Rule2Compact] Successfully saved overall ABCD/BCD results to rule2_results for ${t}`):console.error(" [Rule2Compact] Failed to save to rule2_results:",ht.error);const Ce=await AV.saveAnalysisResults(o,t,t,k,Ye,rt,se,{aDay:le,bDay:ne,cDay:te,dDay:re});Ce.success?(console.log(` [Rule2Compact] Successfully saved topic-specific ABCD/BCD results to rule2_analysis_results for ${t}`),m("Analysis complete & saved to both databases!")):(console.error(" [Rule2Compact] Failed to save to rule2_analysis_results:",Ce.error),m("Analysis complete (enhanced save failed)"))}catch(ht){console.error(" [Rule2Compact] Exception saving results to databases:",ht),m("Analysis complete (save error)")}c(se),y({aDay:le,bDay:ne,cDay:te,dDay:re,triggerDate:t,totalSets:Z.length,selectedHR:k,availableHRs:ee,overallAbcdNumbers:Ye,overallBcdNumbers:rt}),f(100),m("Analysis complete!"),setTimeout(()=>{d(!1)},500)}catch(D){console.error("Error in Rule2CompactPage analysis:",D),v("Error performing ABCD-BCD analysis: "+D.message),d(!1)}})()},[o,t,n,k]),u)return X.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:X.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 w-full max-w-md",children:[X.jsxs("div",{className:"text-center mb-6",children:[X.jsx("div",{className:"animate-spin h-10 w-10 border-4 border-purple-600 border-t-transparent rounded-full mx-auto mb-3"}),X.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:" Processing 30-Topic Analysis (Optimized)"}),X.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Fast parallel processing with data caching..."})]}),X.jsx(W2,{progress:h,message:g,color:"purple",className:"mb-4"}),h>80&&X.jsx("div",{className:"text-center",children:X.jsx("p",{className:"text-xs text-gray-500",children:" Optimized performance with data caching and parallel processing"})})]})});if(p)return X.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-6",children:X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:[X.jsx("div",{className:"text-red-600 text-xl mb-2",children:" Analysis Error"}),X.jsx("p",{className:"mb-4 text-gray-700",children:p}),X.jsx("button",{onClick:s,className:"bg-purple-600 hover:bg-purple-700 text-white px-5 py-2 rounded-lg",children:" Go Back"})]})});const{aDay:U,bDay:A,cDay:H,dDay:z,totalSets:K,selectedHR:j,availableHRs:J}=b;return X.jsx("div",{className:"min-h-screen bg-gray-50",children:X.jsxs("div",{className:"container mx-auto px-4 py-6",children:[X.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6 border-t-4 border-purple-600",children:X.jsxs("div",{className:"flex justify-between items-center",children:[X.jsxs("div",{children:[X.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:" Rule-2 Compact Analysis (30-Topic Format)"}),X.jsxs("div",{className:"mt-2 text-sm text-purple-800",children:[X.jsxs("p",{children:[" User: ",(e==null?void 0:e.username)||o]}),X.jsxs("p",{children:[" Trigger Date (5th): ",new Date(t).toLocaleDateString()]}),X.jsxs("p",{children:[" Total Topics Processed: ",K]}),X.jsxs("p",{children:[" Selected HR: ",k]}),X.jsxs("p",{children:[" ABCD Sequence: A(",new Date(U).toLocaleDateString(),")  B(",new Date(A).toLocaleDateString(),")  C(",new Date(H).toLocaleDateString(),")  D(",new Date(z).toLocaleDateString(),")"]})]})]}),X.jsx("button",{onClick:s,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:" Back"})]})}),L&&L.length>1&&X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:[X.jsxs("div",{className:"flex items-center gap-4",children:[X.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Select HR Period:"}),L.map(P=>X.jsxs("button",{onClick:()=>V(P),className:`px-3 py-1 rounded-lg text-sm font-medium transition-all ${k===P?"bg-purple-500 text-white":"bg-gray-100 text-gray-700 hover:bg-purple-100"}`,children:["HR ",P]},P))]}),X.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Analysis uses planet selections from the chosen HR period for all 4 dates (A, B, C, D)"})]}),X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[X.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:" ABCD/BCD Numbers below for Next Day"}),X.jsx("div",{className:"space-y-2 font-mono text-sm",children:l.map((P,D)=>{const G=P.abcdNumbers.length>0?P.abcdNumbers.join(","):"None",re=P.bcdNumbers.length>0?P.bcdNumbers.join(","):"None";return X.jsxs("div",{className:`p-3 rounded border-l-4 ${P.abcdNumbers.length>0||P.bcdNumbers.length>0?"border-green-500 bg-green-50":"border-gray-300 bg-gray-50"}`,children:[X.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[X.jsxs("span",{className:"font-semibold text-blue-700",children:[String(D+1).padStart(2,"0"),"."]}),X.jsx("span",{className:"font-bold text-gray-800",children:P.setName}),X.jsx("span",{className:"text-green-700",children:"-ABCD Numbers-"}),X.jsx("span",{className:"font-semibold bg-green-100 px-2 py-1 rounded",children:G}),X.jsx("span",{className:"text-blue-700",children:"/ BCD Numbers-"}),X.jsx("span",{className:"font-semibold bg-blue-100 px-2 py-1 rounded",children:re}),X.jsxs("span",{className:"text-xs text-gray-500 ml-auto",children:["(D-day: ",P.dDayCount," numbers)"]})]}),P.error&&X.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["Error: ",P.error]}),P.dDayCount===0&&!P.error&&X.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"No source numbers found in D-day data for this set"})]},P.setName)})}),X.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[X.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:" Summary Statistics"}),b.overallAbcdNumbers&&X.jsxs("div",{className:"mb-4 p-3 bg-white rounded border",children:[X.jsx("h4",{className:"font-semibold text-green-700 mb-2",children:" Overall ABCD/BCD Results (Saved to Database)"}),X.jsxs("div",{className:"space-y-2",children:[X.jsxs("div",{className:"flex items-center gap-2",children:[X.jsx("span",{className:"text-sm font-medium",children:"ABCD Numbers:"}),b.overallAbcdNumbers.length>0?X.jsx("div",{className:"flex gap-1",children:b.overallAbcdNumbers.map(P=>X.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-sm font-mono",children:P},P))}):X.jsx("span",{className:"text-gray-500 text-sm",children:"None"})]}),X.jsxs("div",{className:"flex items-center gap-2",children:[X.jsx("span",{className:"text-sm font-medium",children:"BCD Numbers:"}),b.overallBcdNumbers.length>0?X.jsx("div",{className:"flex gap-1",children:b.overallBcdNumbers.map(P=>X.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm font-mono",children:P},P))}):X.jsx("span",{className:"text-gray-500 text-sm",children:"None"})]})]})]}),X.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[X.jsxs("p",{children:[" HR Period used: ",X.jsxs("strong",{children:["HR ",k]})]}),X.jsxs("p",{children:[" Total topics analyzed: ",X.jsx("strong",{children:l.length})]}),X.jsxs("p",{children:[" Topics with ABCD numbers: ",X.jsx("strong",{children:l.filter(P=>P.abcdNumbers.length>0).length})]}),X.jsxs("p",{children:[" Topics with BCD numbers: ",X.jsx("strong",{children:l.filter(P=>P.bcdNumbers.length>0).length})]}),X.jsxs("p",{children:[" Topics with any results: ",X.jsx("strong",{children:l.filter(P=>P.abcdNumbers.length>0||P.bcdNumbers.length>0).length})]}),X.jsxs("p",{children:[" Total ABCD numbers found: ",X.jsx("strong",{children:l.reduce((P,D)=>P+D.abcdNumbers.length,0)})]}),X.jsxs("p",{children:[" Total BCD numbers found: ",X.jsx("strong",{children:l.reduce((P,D)=>P+D.bcdNumbers.length,0)})]})]})]}),X.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[X.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Analysis Criteria"}),X.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[X.jsxs("p",{children:[X.jsx("strong",{children:"ABCD Numbers:"})," D-day numbers that appear in at least 2 out of 3 preceding days (A, B, C)"]}),X.jsxs("p",{children:[X.jsx("strong",{children:"BCD Numbers:"})," D-day numbers that form exclusive B-D pairs OR exclusive C-D pairs (NOT both B and C)"]}),X.jsxs("p",{children:[X.jsx("strong",{children:"Mutual Exclusivity:"})," Numbers cannot appear in both ABCD and BCD categories - ABCD takes priority"]}),X.jsxs("p",{children:[X.jsx("strong",{children:"Source:"})," All numbers extracted from Set matrices using the selected planet for HR ",k]}),X.jsxs("p",{children:[X.jsx("strong",{children:"HR Selection:"})," Uses the same HR period's planet selection across all 4 dates for consistent analysis"]})]})]}),l.length>0&&X.jsx("div",{className:"mt-6 p-4 bg-teal-50 border border-teal-200 rounded-lg",children:X.jsxs("div",{className:"flex items-center justify-between",children:[X.jsxs("div",{children:[X.jsx("h4",{className:"font-semibold text-teal-800 mb-1",children:" View ABCD/BCD Numbers on Planets Data"}),X.jsx("p",{className:"text-sm text-teal-700",children:"Display these ABCD/BCD numbers overlaid on Excel planets data for visual analysis"})]}),X.jsxs("button",{onClick:()=>{console.log(" [Rule2Planets] Raw topicResults:",l),console.log(" [Rule2Planets] Analysis info:",b);const P={success:!0,data:{source:"rule2",analysisDate:t,totalTopics:l.length,selectedHR:k,overallNumbers:{abcd:(b==null?void 0:b.overallAbcdNumbers)||[],bcd:(b==null?void 0:b.overallBcdNumbers)||[]},setResults:l.map(ne=>({setName:ne.setName,abcdNumbers:ne.abcdNumbers,bcdNumbers:ne.bcdNumbers})),topicNumbers:l.reduce((ne,le)=>(ne[le.setName]={abcd:le.abcdNumbers,bcd:le.bcdNumbers},ne),{})}};console.log(" [Rule2Planets] Prepared analysisData:",P),console.log(" [Rule2Planets] Topic Numbers mapping:",P.data.topicNumbers);const D="D-1 Set-1 Matrix",G=P.data.topicNumbers[D];console.log(` [Rule2Planets D-1 Set-1] Key: "${D}"`),console.log(" [Rule2Planets D-1 Set-1] Data:",G),G?(console.log(` [Rule2Planets D-1 Set-1] ABCD: [${G.abcd.join(", ")}]`),console.log(` [Rule2Planets D-1 Set-1] BCD: [${G.bcd.join(", ")}]`)):(console.error(" [Rule2Planets D-1 Set-1] NOT FOUND in topicNumbers!"),console.error(" [Rule2Planets D-1 Set-1] Available keys:",Object.keys(P.data.topicNumbers)));const re=l.find(ne=>ne.setName===D);console.log(" [Rule2Planets D-1 Set-1] Original topicResult:",re),re&&(console.log(` [Rule2Planets D-1 Set-1] Original ABCD: [${re.abcdNumbers.join(", ")}]`),console.log(` [Rule2Planets D-1 Set-1] Original BCD: [${re.bcdNumbers.join(", ")}]`));const te=JSON.stringify(P);console.log(" [Rule2Planets] Navigating with navigation state"),console.log(" [Rule2Planets] Analysis data size:",te.length,"characters");try{const ne=P.data.topicNumbers["D-1 Set-1 Matrix"];console.log(" [Rule2Planets] Pre-navigation D-1 Set-1 test:",ne),ne&&(console.log(" [Rule2Planets] Pre-navigation ABCD:",ne.abcd),console.log(" [Rule2Planets] Pre-navigation BCD:",ne.bcd))}catch(ne){console.error(" [Rule2Planets] Pre-navigation test failed:",ne)}i(`/planets-analysis/${o}`,{state:{analysisData:P}})},className:"bg-teal-600 hover:bg-teal-700 text-white px-6 py-2 rounded-lg font-medium flex items-center gap-2",children:[" Planets Analysis",X.jsxs("span",{className:"text-sm opacity-80",children:["(",l.length," topics)"]})]})]})})]})]})})};class TV{constructor(){this.analysisHistory=[],this.currentAnalysis=null}extractNumber(r){if(!r||typeof r!="string")return null;const e=r.match(/^[a-z]+-(\d+)-\//);return e?parseInt(e[1]):null}extractDayNumbers(r){return!r||typeof r!="object"?[]:Object.values(r).map(e=>this.extractNumber(e)).filter(e=>e!==null)}prepareDataStructure(r){const{A:e,B:n,C:s,D:a}=r;return{aDayNumbers:this.extractDayNumbers(e),bDayNumbers:this.extractDayNumbers(n),cDayNumbers:this.extractDayNumbers(s),dDayNumbers:this.extractDayNumbers(a),rawData:r}}analyze(r,e={}){const{includeSummary:n=!0,includeElementWise:s=!0,includeDetailed:a=!0,setName:i="Analysis",saveToHistory:o=!0}=e;let l;if(r.A&&r.B&&r.C&&r.D)l=this.prepareDataStructure(r);else if(r.aDayNumbers&&r.bDayNumbers&&r.cDayNumbers&&r.dDayNumbers)l=r;else throw new Error("Invalid data format. Expected either {A, B, C, D} or {aDayNumbers, bDayNumbers, cDayNumbers, dDayNumbers}");const{aDayNumbers:c,bDayNumbers:u,cDayNumbers:d,dDayNumbers:h,rawData:f}=l,g=Bm(c,u,d,h,{includeDetailedAnalysis:a,logResults:!1,setName:i}),m={timestamp:new Date().toISOString(),setName:i,extractedNumbers:{aDayNumbers:c,bDayNumbers:u,cDayNumbers:d,dDayNumbers:h},results:{abcdNumbers:g.abcdNumbers,bcdNumbers:g.bcdNumbers,unqualifiedNumbers:h.filter(p=>!g.abcdNumbers.includes(p)&&!g.bcdNumbers.includes(p))},summary:n?g.summary:null,detailedAnalysis:a?g.detailedAnalysis:null,elementWiseBreakdown:s&&f?this.getElementWiseBreakdown(f,c,u,d,h):null};return o&&(this.analysisHistory.push(m),this.currentAnalysis=m),m}getElementWiseBreakdown(r,e,n,s,a){const i=[];return Object.keys(r.A).forEach(l=>{const c=this.extractNumber(r.A[l]),u=this.extractNumber(r.B[l]),d=this.extractNumber(r.C[l]),h=this.extractNumber(r.D[l]),f=e.includes(h),g=n.includes(h),m=s.includes(h),p=[f,g,m].filter(Boolean).length;let v="None",b="",y=[];p>=2?(v="ABCD",f&&y.push("A"),g&&y.push("B"),m&&y.push("C"),b=`appears in ${y.join(", ")} days`):g&&!m?(v="BCD",b="B-D pair only",y=["B"]):m&&!g&&(v="BCD",b="C-D pair only",y=["C"]),i.push({element:l,numbers:{A:c,B:u,C:d,D:h},qualification:v,details:b,occurrences:y,abcCount:p})}),i}getFormattedSummary(r=null){const e=r||this.currentAnalysis;if(!e)return"No analysis available";const{results:n,summary:s}=e;return{abcdNumbers:n.abcdNumbers,bcdNumbers:n.bcdNumbers,unqualifiedNumbers:n.unqualifiedNumbers,stats:{totalDDay:s.dDayCount,totalABCD:s.abcdCount,totalBCD:s.bcdCount,totalQualified:s.totalQualified,qualificationRate:s.qualificationRate}}}generateReport(r=null,e={}){const n=r||this.currentAnalysis;if(!n)return"No analysis available";const{includeElementWise:s=!0,includeDetailed:a=!0,colorOutput:i=!0}=e;let o="";if(o+=` ABCD/BCD Analysis Report - ${n.setName}
`,o+=`${"=".repeat(50)}

`,o+=` Extracted Numbers:
`,o+=`A-day: [${n.extractedNumbers.aDayNumbers.join(", ")}]
`,o+=`B-day: [${n.extractedNumbers.bDayNumbers.join(", ")}]
`,o+=`C-day: [${n.extractedNumbers.cDayNumbers.join(", ")}]
`,o+=`D-day: [${n.extractedNumbers.dDayNumbers.join(", ")}]

`,o+=` ANALYSIS RESULTS:
`,o+=` ABCD Numbers: [${n.results.abcdNumbers.join(", ")}] (${n.results.abcdNumbers.length} total)
`,o+=` BCD Numbers: [${n.results.bcdNumbers.join(", ")}] (${n.results.bcdNumbers.length} total)
`,o+=` Unqualified: [${n.results.unqualifiedNumbers.join(", ")}] (${n.results.unqualifiedNumbers.length} total)

`,n.summary&&(o+=` Summary Statistics:
`,o+=`    D-day count: ${n.summary.dDayCount}
`,o+=`    ABCD count: ${n.summary.abcdCount}
`,o+=`    BCD count: ${n.summary.bcdCount}
`,o+=`    Total qualified: ${n.summary.totalQualified}
`,o+=`    Qualification rate: ${n.summary.qualificationRate}%

`),a&&n.detailedAnalysis){o+=` DETAILED BREAKDOWN BY NUMBER:
`;for(const[l,c]of Object.entries(n.detailedAnalysis)){const u=c.qualified?"":"",d=c.type?`[${c.type}]`:"";o+=`${u} Number ${l} ${d}: ${c.reason}
`}o+=`
`}return s&&n.elementWiseBreakdown&&(o+=` ELEMENT-WISE BREAKDOWN:
`,o+=`${"=".repeat(50)}
`,n.elementWiseBreakdown.forEach(l=>{const{element:c,numbers:u,qualification:d,details:h}=l;o+=`${c.padEnd(16)}: A=${u.A}, B=${u.B}, C=${u.C}, D=${u.D}  ${d}`,h&&(o+=` (${h})`),o+=`
`})),o}getHistory(){return this.analysisHistory}clearHistory(){this.analysisHistory=[],this.currentAnalysis=null}exportForComponent(r=null){const e=r||this.currentAnalysis;return e?{abcdNumbers:e.results.abcdNumbers,bcdNumbers:e.results.bcdNumbers,unqualifiedNumbers:e.results.unqualifiedNumbers,summary:e.summary,elementWiseBreakdown:e.elementWiseBreakdown,timestamp:e.timestamp}:null}}function NV(){return new TV}const DV=({date:t,selectedUser:r,selectedUserData:e,datesList:n,onBack:s,onExtractNumbers:a})=>{var ht,Ce,Ie,Ve;mo();const[i,o]=Se.useState(null),[l,c]=Se.useState({}),[u,d]=Se.useState(!0),[h,f]=Se.useState(0),[g,m]=Se.useState("Initializing..."),[p,v]=Se.useState(""),[b,y]=Se.useState({}),[k,N]=Se.useState(0),[L,F]=Se.useState(""),[R,B]=Se.useState("Initializing..."),[q,V]=Se.useState(null),[I,C]=Se.useState(null),[O,E]=Se.useState({}),[x,w]=Se.useState(new Set),[_,S]=Se.useState(!0),[T,U]=Se.useState([]),A=lr;Se.useEffect(()=>{const De=NV();V(De),console.log(" ABCD/BCD Analyzer initialized")},[]);const H=(De,Oe)=>{const Xe=new Map;return De.forEach(nt=>{const Je=nt.match(/D-(\d+)\s+Set-(\d+)/);if(Je){const[,wt,gt]=Je,dt=Oe.find(ct=>{const ut=ct.match(/D-(\d+)(?:\s*\([^)]*\))?\s+Set-(\d+)/);if(ut){const[,ft,Et]=ut;return wt===ft&&gt===Et}return!1});dt&&Xe.set(nt,dt)}}),Xe},z=["D-1 Set-1 Matrix","D-1 Set-2 Matrix","D-3 Set-1 Matrix","D-3 Set-2 Matrix","D-4 Set-1 Matrix","D-4 Set-2 Matrix","D-5 Set-1 Matrix","D-5 Set-2 Matrix","D-7 Set-1 Matrix","D-7 Set-2 Matrix","D-9 Set-1 Matrix","D-9 Set-2 Matrix","D-10 Set-1 Matrix","D-10 Set-2 Matrix","D-11 Set-1 Matrix","D-11 Set-2 Matrix","D-12 Set-1 Matrix","D-12 Set-2 Matrix","D-27 Set-1 Matrix","D-27 Set-2 Matrix","D-30 Set-1 Matrix","D-30 Set-2 Matrix","D-60 Set-1 Matrix","D-60 Set-2 Matrix","D-81 Set-1 Matrix","D-81 Set-2 Matrix","D-108 Set-1 Matrix","D-108 Set-2 Matrix","D-144 Set-1 Matrix","D-144 Set-2 Matrix"],K={as:"Lagna",mo:"Moon",hl:"Hora Lagna",gl:"Ghati Lagna",vig:"Vighati Lagna",var:"Varnada Lagna",sl:"Sree Lagna",pp:"Pranapada Lagna",in:"Indu Lagna"},j=De=>{if(typeof De!="string")return null;const Oe=De.match(/^[a-z]+-(\d+)[\/\-]/);return Oe?Number(Oe[1]):null},J=async(De,Oe,Xe)=>{try{console.log(` [ABCD-DEBUG] Extracting from date=${De}, set=${Oe}, HR=${Xe}`),console.log(` [ABCD-DEBUG] Using CleanSupabaseService for ${De}`);const nt=await A.getExcelData(r,De),Je=await A.getHourEntry(r,De);if(console.log(` [ABCD-DEBUG] Data for ${De}:`,{hasExcel:!!nt,hasHour:!!Je,excelSets:nt!=null&&nt.sets?Object.keys(nt.sets):[],hourPlanets:Je!=null&&Je.planetSelections?Object.keys(Je.planetSelections):[],storageType:"CleanSupabaseService"}),!nt||!Je)return console.log(` [ABCD-DEBUG] Missing data for ${De} - Excel: ${!!nt}, Hour: ${!!Je}`),[];const wt=nt.sets||{},gt=Je.planetSelections||{};console.log(` [ABCD-DEBUG] Data structure for ${De}:`,{hasDirectSets:!!(nt!=null&&nt.sets),usingFormat:"CleanSupabaseService",setCount:Object.keys(wt).length,planetSelectionCount:Object.keys(gt).length});const dt=new Set,ct=wt[Oe];if(ct){const ft=gt[Xe];console.log(` [ABCD-DEBUG] Selected planet for HR${Xe}: ${ft}`),ft?Object.entries(ct).forEach(([Et,jt])=>{const Ot=jt[ft];if(Ot){const yt=j(Ot);console.log(` [ABCD-DEBUG] ${Et} -> "${Ot}" -> ${yt}`),yt!==null&&dt.add(yt)}else console.log(` [ABCD-DEBUG] No data for ${Et} with planet ${ft}`)}):console.log(` [ABCD-DEBUG] No planet selected for HR${Xe}`)}else console.log(` [ABCD-DEBUG] No set data found for "${Oe}" in sets:`,Object.keys(wt));const ut=Array.from(dt).sort((ft,Et)=>ft-Et);return console.log(` [ABCD-DEBUG] Extracted ${ut.length} numbers for ${De}/${Oe}/HR${Xe}:`,ut),ut.length===0&&(console.log(" [ABCD-DEBUG] ZERO NUMBERS EXTRACTED! This is likely the main issue."),console.log(" [ABCD-DEBUG] Debug info:",{setExists:!!ct,planetSelected:!!gt[Xe],selectedPlanet:gt[Xe],availableElements:ct?Object.keys(ct):[],sampleElementData:ct?Object.values(ct)[0]:null})),ut}catch(nt){return console.error("Error extracting from date and set:",nt),[]}},P=async(De,Oe,Xe,nt,Je,wt)=>{try{console.log(` Enhanced Analyzer - Performing ABCD-BCD analysis for ${De} with days A=${Oe}, B=${Xe}, C=${nt}, D=${Je}, HR=${wt}`);const gt=Je?await J(Je,De,wt):[],dt=nt?await J(nt,De,wt):[],ct=Xe?await J(Xe,De,wt):[],ut=Oe?await J(Oe,De,wt):[];if(console.log(" Numbers extracted for enhanced analysis:",{A:ut,B:ct,C:dt,D:gt}),gt.length===0)return console.log(` No D-day numbers for ${De}, skipping analysis`),{abcdNumbers:[],bcdNumbers:[]};if(E(ft=>({...ft,[De]:{aDayNumbers:ut,bDayNumbers:ct,cDayNumbers:dt,dDayNumbers:gt,hrNumber:wt,timestamp:new Date().toISOString()}})),q){const ft={aDayNumbers:ut,bDayNumbers:ct,cDayNumbers:dt,dDayNumbers:gt},Et=q.analyze(ft,{setName:`IndexPage-${De}`,includeSummary:!0,includeElementWise:!1,includeDetailed:!1,saveToHistory:!0});return console.log(` Enhanced analyzer results for ${De}:`,{availableDays:[ut,ct,dt].filter(jt=>jt.length>0).length,summary:Et.summary,abcdNumbers:Et.results.abcdNumbers,bcdNumbers:Et.results.bcdNumbers,unqualifiedNumbers:Et.results.unqualifiedNumbers}),C(jt=>({...jt,[De]:Et})),{abcdNumbers:Et.results.abcdNumbers,bcdNumbers:Et.results.bcdNumbers,unqualifiedNumbers:Et.results.unqualifiedNumbers,summary:Et.summary}}else{console.log(" Analyzer not ready, using fallback utility");const ft=Bm(ut,ct,dt,gt,{includeDetailedAnalysis:!1,logResults:!0,setName:De});return{abcdNumbers:ft.abcdNumbers,bcdNumbers:ft.bcdNumbers}}}catch(gt){return console.error("Error performing enhanced ABCD-BCD analysis:",gt),{abcdNumbers:[],bcdNumbers:[]}}},D=De=>{const Oe=new Set(x);x.has(De)?Oe.delete(De):Oe.add(De),w(Oe)},G=()=>{w(new Set(T))},re=()=>{w(new Set)},te=De=>De.replace(/\s+Matrix$/i,""),ne=()=>x.size===0?T:T.filter(De=>x.has(De)),le=()=>{const De=new Set;return T.forEach(Oe=>{const Xe=Oe.match(/^(D-\d+)/);Xe&&De.add(Xe[1])}),Array.from(De).sort((Oe,Xe)=>{const nt=parseInt(Oe.split("-")[1]),Je=parseInt(Xe.split("-")[1]);return nt-Je})},oe=De=>T.filter(Oe=>Oe.startsWith(De+" ")),ee=De=>{const Oe=oe(De);return Oe.length>0&&Oe.every(Xe=>x.has(Xe))},Z=De=>{const Oe=oe(De),Xe=Oe.filter(nt=>x.has(nt)).length;return Xe>0&&Xe<Oe.length},se=De=>{const Oe=oe(De),Xe=new Set(x);ee(De)?Oe.forEach(nt=>Xe.delete(nt)):Oe.forEach(nt=>Xe.add(nt)),w(Xe)};Se.useEffect(()=>{if(l&&Object.keys(l).length>0){const De=new Set;["A","B","C","D"].forEach(Je=>{var wt;(wt=l[Je])!=null&&wt.success&&l[Je].hrData&&Object.values(l[Je].hrData).forEach(gt=>{Object.keys(gt.sets||{}).forEach(dt=>{De.add(dt)})})});const Oe=Array.from(De),Xe=H(z,Oe),nt=z.filter(Je=>Xe.has(Je)).map(Je=>Xe.get(Je));console.log(" [IndexPage] Topic Discovery (FIXED with Smart Matching):",{allDaysDataKeys:Object.keys(l),discoveredSetsRaw:Oe,discoveredSetsCount:De.size,orderedTopicsCount:nt.length,orderedTopics:nt,topicMappings:Array.from(Xe.entries()).slice(0,5),missingFromOrder:Oe.filter(Je=>!Array.from(Xe.values()).includes(Je)),notInData:z.filter(Je=>!Xe.has(Je))}),U(nt),x.size===0&&w(new Set(nt))}},[l]);const ie=(De,Oe,Xe)=>{if(console.log(" renderColorCodedDayNumber called:",{cellValue:De,setName:Oe,dayLabel:Xe,hasAnalysis:!!b[Oe],analysisKeys:Object.keys(b),analysisForSet:b[Oe]}),Xe!=="D"||!De||De===""||!b[Oe])return console.log(` Early return: dayLabel=${Xe}, cellValue=${De}, hasAnalysis=${!!b[Oe]}`),De;const nt=j(De);if(console.log(` Extracted element number: ${nt} from ${De}`),nt===null||isNaN(nt))return console.log(" Invalid element number extracted"),De;const{abcdNumbers:Je=[],bcdNumbers:wt=[]}=b[Oe];return console.log(" Checking against analysis:",{abcdNumbers:Je,bcdNumbers:wt,elementNumber:nt,abcdCount:Je.length,bcdCount:wt.length,setName:Oe,allAnalysisKeys:Object.keys(b)}),Je.includes(nt)?(console.log(` ABCD match for ${nt}`),X.jsxs("span",{className:"inline-flex items-center",children:[X.jsx("span",{className:"bg-green-200 text-green-800 px-2 py-1 rounded text-xs font-bold mr-2",children:"ABCD"}),X.jsx("span",{className:"font-mono",children:De})]})):wt.includes(nt)?(console.log(` BCD match for ${nt}`),X.jsxs("span",{className:"inline-flex items-center",children:[X.jsx("span",{className:"bg-blue-200 text-blue-800 px-2 py-1 rounded text-xs font-bold mr-2",children:"BCD"}),X.jsx("span",{className:"font-mono",children:De})]})):(console.log(` No match for ${nt}`),X.jsx("span",{className:"font-mono",children:De}))},ue=async()=>{var De,Oe;try{d(!0),f(0),m("Preparing date window..."),v("");const Xe=[...n].sort((ut,ft)=>new Date(ut)-new Date(ft)),nt=Xe.indexOf(t);let Je;if(nt===-1){const ut=Math.min(4,Xe.length);Je=Xe.slice(-ut),console.log(` Target date "${t}" not found in datesList. Using ${Je.length} available dates.`)}else{const ut=nt+1,ft=Math.max(0,ut-4);Je=Xe.slice(ft,ut),console.log(` Target date "${t}" found at index ${nt}. Using ${Je.length} dates in window.`)}Je.length===1&&console.log(` Single date mode: Displaying data for "${Je[0]}"`),console.log(" Date Window Analysis:",{clickedDate:t,allDates:Xe,targetIndex:nt,windowDates:Je,labelsToUse:Je.map((ut,ft)=>`${["A","B","C","D"][ft]}: ${ut}`)}),f(10),m(`Loading data for ${Je.length} dates...`);const wt=["A","B","C","D"],gt={};for(let ut=0;ut<Je.length;ut++){const ft=Je[ut],Et=wt[ut],jt=70/Je.length,Ot=10+ut*jt;f(Ot),m(`Loading ${Et}-day data (${ft})...`);try{const yt=await A.getExcelData(r,ft);f(Ot+jt*.5);const Vt=await A.getHourEntry(r,ft);if(f(Ot+jt),console.log(` Raw data for ${ft} (${Et}):`,{excelData:yt?{hasSets:!!yt.sets,setNames:yt.sets?Object.keys(yt.sets):[],setCount:yt.sets?Object.keys(yt.sets).length:0,dataSource:yt.dataSource||"CleanSupabaseService",fileName:yt.fileName||"unknown"}:null,hourData:Vt?{hasPlanetSelections:!!Vt.planetSelections,hrNumbers:Vt.planetSelections?Object.keys(Vt.planetSelections):[],hrCount:Vt.planetSelections?Object.keys(Vt.planetSelections).length:0,dataSource:Vt.dataSource||"CleanSupabaseService"}:null}),yt&&Vt){const $t=Vt.planetSelections||{};console.log(` [DATA DEBUG] Processing ${Et}-day (${ft}):`,{excelSets:yt!=null&&yt.sets?Object.keys(yt.sets).length:"none",planetSelections:Object.keys($t).length});const Fe={};Object.entries($t).forEach(([Be,tt])=>{const ce={selectedPlanet:tt,sets:{}},ke=yt.sets||{};console.log(` [DATA DEBUG] HR${Be} processing:`,{selectedPlanet:tt,setsDataKeys:Object.keys(ke).length,firstFewSets:Object.keys(ke).slice(0,3)}),Object.entries(ke).forEach(([me,xe])=>{const _e={};console.log(` [SETS DEBUG] Processing set "${me}":`,{elementCount:Object.keys(xe).length,elements:Object.keys(xe).slice(0,3),selectedPlanet:tt}),Object.entries(xe).forEach(([Ee,Le])=>{const Ke=Le[tt];_e[Ee]={rawData:Ke||null,selectedPlanet:tt,hasData:!!Ke}}),Object.values(K).forEach(Ee=>{_e[Ee]||(_e[Ee]={rawData:null,selectedPlanet:tt,hasData:!1})}),ce.sets[me]=_e}),Fe[Be]=ce}),gt[Et]={date:ft,hrData:Fe,success:Object.keys(Fe).length>0,dayLabel:Et}}else gt[Et]={date:ft,hrData:{},success:!1,error:yt?"No Hour Entry data":"No Excel data",dayLabel:Et}}catch(yt){gt[Et]={date:ft,hrData:{},success:!1,error:`Error loading data: ${yt.message}`,dayLabel:Et}}}f(80),m("Processing loaded data...");const dt=pe(gt);if(c(dt),console.log(" FINAL DATA ASSEMBLY SUMMARY:"),console.log(`   Total days processed: ${Object.keys(gt).length}`),console.log(`   Date window: ${Je.join("  ")}`),console.log(`   Labels mapped: ${Je.map((ut,ft)=>`${wt[ft]}: ${ut}`).join(", ")}`),Object.entries(gt).forEach(([ut,ft])=>{console.log(`   ${ut}-day (${ft.date}):`,{success:ft.success,error:ft.error,hrCount:Object.keys(ft.hrData||{}).length,hrNumbers:Object.keys(ft.hrData||{}),setsPerHR:Object.fromEntries(Object.entries(ft.hrData||{}).map(([Et,jt])=>[Et,{setCount:Object.keys(jt.sets||{}).length,setNames:Object.keys(jt.sets||{}),selectedPlanet:jt.selectedPlanet,sampleSetElements:Object.keys(jt.sets||{})[0]?Object.keys(jt.sets[Object.keys(jt.sets)[0]]||{}):[],elementDataTypes:Object.keys(jt.sets||{})[0]?Object.entries(jt.sets[Object.keys(jt.sets)[0]]||{}).slice(0,2).map(([Ot,yt])=>`${Ot}: ${typeof yt} (keys: ${Object.keys(yt||{}).join(",")})`):[]}]))})}),(De=gt.D)!=null&&De.success){const ut=Object.keys(gt.D.hrData||{})[0];if(ut){const ft=gt.D.hrData[ut],Et=Object.keys(ft.sets||{});console.log(` D-day detailed structure check (HR${ut}):`,{totalSets:Et.length,firstSetName:Et[0],firstSetStructure:Et[0]?ft.sets[Et[0]]:null})}}f(90),m("Setting up interface...");let ct=null;for(let ut of["A","B","C","D"])if((Oe=dt[ut])!=null&&Oe.success){const ft=Object.keys(dt[ut].hrData||{});if(ft.length){ct=ft[0],console.log(` Auto-selected HR${ct} from ${ut}-day`);break}}ct?(o(ct),console.log(` Successfully set activeHR to: ${ct}`)):console.warn(" No HR data found in any day. User needs to complete Hour Entries."),f(100),m("Complete!"),setTimeout(()=>{d(!1)},300)}catch(Xe){console.error(Xe),v("Error building index data."),d(!1)}};Se.useEffect(()=>{(async()=>{var ft,Et,jt,Ot,yt,Vt,$t,Fe;if(console.log(" [ABCD-DEBUG] Starting ABCD-BCD analysis...",{activeHR:i,hasA:!!l.A,hasB:!!l.B,hasC:!!l.C,hasD:!!l.D,allDaysDataKeys:Object.keys(l),aSuccess:(ft=l.A)==null?void 0:ft.success,bSuccess:(Et=l.B)==null?void 0:Et.success,cSuccess:(jt=l.C)==null?void 0:jt.success,dSuccess:(Ot=l.D)==null?void 0:Ot.success}),B("Starting analysis..."),N(0),F(""),!i){console.log(" [ABCD-DEBUG] No activeHR, clearing analysis state"),B("No HR selected"),y({});return}const Oe=["A","B","C","D"].filter(Be=>{var tt;return(tt=l[Be])==null?void 0:tt.success});if(console.log(" Available labels for analysis:",Oe),Oe.length<1){console.log(` No days available for analysis (${Oe.length}), clearing analysis`),y({});return}Oe.length<4&&console.log(` Partial analysis mode: Using ${Oe.length} days instead of full 4-day window`);const Xe=Oe.filter(Be=>l[Be].hrData&&l[Be].hrData[i]);if(console.log(` Days with HR${i}:`,Xe),Xe.length===0){console.log(` HR${i} not available in any days`),y({});return}Oe.length<4&&(console.log(` Partial data analysis: only ${Oe.length}/4 days available`),F(`Partial analysis with ${Oe.length} days...`)),N(10),F("Scanning available sets...");const nt={},Je=new Set;Oe.forEach(Be=>{l[Be].hrData[i]&&Object.keys(l[Be].hrData[i].sets).forEach(tt=>{Je.add(tt)})});const wt=Array.from(Je),gt=H(z,wt),dt=z.filter(Be=>gt.has(Be)).map(Be=>gt.get(Be));if(console.log(" [ABCD-DEBUG] Sets to analyze (FIXED with Smart Matching):",{orderedSetsCount:dt.length,orderedSets:dt.slice(0,5),topicMappings:Array.from(gt.entries()).slice(0,3)}),dt.length===0){console.log(" [ABCD-DEBUG] No sets found for analysis"),B("No sets found for analysis"),y({});return}B(`Analyzing ${dt.length} sets...`),N(20),F(`Analyzing ${dt.length} sets...`);const ct=dt;for(let Be=0;Be<ct.length;Be++){const tt=ct[Be],ce=70/ct.length,ke=20+Be*ce;N(ke),F(`Analyzing ${tt} (${Be+1}/${ct.length})...`);const me=((yt=l.A)==null?void 0:yt.date)||null,xe=((Vt=l.B)==null?void 0:Vt.date)||null,_e=(($t=l.C)==null?void 0:$t.date)||null,Ee=((Fe=l.D)==null?void 0:Fe.date)||null;console.log(` Analyzing set "${tt}" for available dates:`,{aDay:me||"missing",bDay:xe||"missing",cDay:_e||"missing",dDay:Ee||"missing"});try{const Le=await P(tt,me,xe,_e,Ee,i);nt[tt]={abcdNumbers:Array.isArray(Le.abcdNumbers)?Le.abcdNumbers:[],bcdNumbers:Array.isArray(Le.bcdNumbers)?Le.bcdNumbers:[]},console.log(` Analysis result for "${tt}":`,nt[tt]),N(ke+ce)}catch(Le){console.error(` Error analyzing set ${tt}:`,Le),nt[tt]={abcdNumbers:[],bcdNumbers:[]}}}N(90),F("Finalizing analysis..."),console.log(" Final analysis result:",nt),y(nt);const ut=Object.values(nt).reduce((Be,tt)=>Be+tt.abcdNumbers.length+tt.bcdNumbers.length,0);B(ut>0?` Found ${ut} ABCD/BCD numbers`:" No ABCD/BCD numbers found"),N(100),F("Analysis complete!"),setTimeout(()=>{N(0),F("")},1e3)})()},[i,Object.keys(l).join(","),(ht=l.A)==null?void 0:ht.success,(Ce=l.B)==null?void 0:Ce.success,(Ie=l.C)==null?void 0:Ie.success,(Ve=l.D)==null?void 0:Ve.success]),Se.useEffect(()=>{console.log(" abcdBcdAnalysis state updated:",b),console.log(" Analysis keys:",Object.keys(b)),Object.entries(b).forEach(([De,Oe])=>{console.log(` Set "${De}":`,Oe)})},[b]),Se.useEffect(()=>{(async()=>{r&&Array.isArray(n)&&n.length>0?await ue():(v("Missing required user or dates data."),d(!1))})()},[r,n,t]);const pe=De=>De,fe=De=>{const Oe=O[De],Xe=I==null?void 0:I[De];return Oe&&Xe?(console.log(` Providing enhanced analysis data for ${De} to Rule2Page`),{extractedNumbers:Oe,analysisResults:Xe,enhancedAnalyzer:q,timestamp:Oe.timestamp}):(console.log(` No enhanced analysis data available for ${De}`),null)},ye=(De,Oe,Xe=null)=>{console.log(` Enhanced navigation to Rule2Page - Date: ${De}, HR: ${Oe}, Set: ${Xe}`);const nt={date:De,hrNumber:Oe,setName:Xe,analysisData:Xe?fe(Xe):null,allAnalysisResults:I,allExtractedNumbers:O,enhancedAnalyzer:q};a&&a(De,Oe,nt)};if(u)return X.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:X.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 w-full max-w-md",children:[X.jsxs("div",{className:"text-center mb-6",children:[X.jsx("div",{className:"animate-spin h-10 w-10 border-4 border-purple-600 border-t-transparent rounded-full mx-auto mb-3"}),X.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Loading Index Data"}),X.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Fetching data automatically with cloud sync and local backup..."})]}),X.jsx(W2,{progress:h,message:g,color:"purple",className:"mb-4"}),h>80&&X.jsx("div",{className:"text-center",children:X.jsx("p",{className:"text-xs text-gray-500",children:" Using automatic storage selection for optimal performance and reliability"})})]})});if(p)return X.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-6",children:X.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6 text-center",children:[X.jsx("div",{className:"text-red-600 text-xl mb-2",children:" Error"}),X.jsx("p",{className:"mb-4 text-gray-700",children:p}),X.jsx("button",{onClick:s,className:"bg-purple-600 hover:bg-purple-700 text-white px-5 py-2 rounded-lg",children:" Go Back"})]})});const je=[...n].sort((De,Oe)=>new Date(De)-new Date(Oe)).indexOf(t)>=4&&i!==null,qe=De=>{if(!De.success||!i||!De.hrData[i])return`${De.date}-(${De.dayLabel})`;const Oe=De.hrData[i].selectedPlanet;return`${De.date}-${Oe}(${De.dayLabel})`},We=De=>De.dayLabel==="D",at=De=>{let Oe="border border-gray-300 px-4 py-2 font-semibold text-center";return We(De)?Oe+=" bg-blue-600 text-white":Oe+=" bg-gray-50 text-gray-700",Oe},Ye=["A","B","C","D"].filter(De=>{var Oe;return(Oe=l[De])==null?void 0:Oe.success}),rt=(()=>{const De=new Set;console.log(" HR Choices Debug:",{availableLabels:Ye,allDaysDataKeys:Object.keys(l),successfulDays:Object.entries(l).map(([Xe,nt])=>({label:Xe,success:nt==null?void 0:nt.success,hasHrData:!!(nt!=null&&nt.hrData),hrDataKeys:nt!=null&&nt.hrData?Object.keys(nt.hrData):[]}))}),Object.entries(l).forEach(([Xe,nt])=>{console.log(` Checking ${Xe}-day:`,{hasData:!!nt,success:nt==null?void 0:nt.success,hasHrData:!!(nt!=null&&nt.hrData),hrKeys:nt!=null&&nt.hrData?Object.keys(nt.hrData):[]}),nt!=null&&nt.hrData&&Object.keys(nt.hrData).forEach(Je=>{console.log(`  Found HR${Je} in ${Xe}-day`),De.add(Je)})});const Oe=Array.from(De).sort((Xe,nt)=>parseInt(Xe)-parseInt(nt));return console.log(" Final HR choices:",Oe),Oe})();return X.jsx("div",{className:"min-h-screen bg-gray-50",children:X.jsxs("div",{className:"container mx-auto px-4 py-6",children:[X.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6 border-t-4 border-orange-600",children:X.jsxs("div",{className:"flex justify-between items-center",children:[X.jsxs("div",{children:[X.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:" Astrological Index Matrix"}),X.jsxs("div",{className:"mt-2 text-sm text-orange-800",children:[X.jsxs("p",{children:[" User: ",(e==null?void 0:e.username)||r]}),X.jsxs("p",{children:[" Clicked Date: ",new Date(t).toLocaleDateString()]}),X.jsxs("p",{children:[" Window: ",Ye.join(", ")]})]}),X.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[X.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Debug:"}),X.jsx("span",{className:`text-xs px-2 py-1 rounded ${R.includes("")?"bg-green-100 text-green-700":R.includes("")?"bg-yellow-100 text-yellow-700":R.includes("")?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:R})]})]}),X.jsx("button",{onClick:s,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:" Back"})]})}),X.jsxs("div",{className:"bg-white rounded-lg shadow-md mb-6",children:[!1,X.jsxs("div",{className:"border-b border-gray-200 p-4",children:[X.jsx("span",{className:"text-sm font-medium text-gray-600 mr-4",children:"Select HR:"}),rt.map(De=>X.jsxs("button",{onClick:()=>o(De),className:`mx-1 px-3 py-1 rounded-lg text-sm font-medium ${i===De?"bg-orange-500 text-white":"bg-gray-100 text-gray-700 hover:bg-orange-100"}`,children:["HR ",De]},De))]}),k>0&&k<100&&X.jsxs("div",{className:"border-b border-gray-200 p-4 bg-blue-50",children:[X.jsx(W2,{progress:k,message:L,color:"blue",className:"mb-2"}),X.jsxs("p",{className:"text-xs text-gray-600 text-center",children:[" Computing ABCD/BCD patterns for HR ",i,"..."]})]}),i&&Object.keys(b).length>0&&X.jsx("div",{className:"border-b border-gray-200 p-4 bg-gray-50",children:X.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[X.jsx("span",{className:"font-medium text-gray-700",children:"Legend:"}),X.jsxs("div",{className:"flex items-center space-x-2",children:[X.jsx("span",{className:"bg-green-200 text-green-800 px-2 py-1 rounded text-xs font-bold",children:"ABCD"}),X.jsx("span",{className:"text-gray-600",children:"D-day numbers appearing in 2 of A,B,C days"})]}),X.jsxs("div",{className:"flex items-center space-x-2",children:[X.jsx("span",{className:"bg-blue-200 text-blue-800 px-2 py-1 rounded text-xs font-bold",children:"BCD"}),X.jsx("span",{className:"text-gray-600",children:"D-day numbers in exclusive B-D or C-D pairs"})]}),X.jsx("span",{className:"text-xs text-gray-500 italic",children:"(ABCD takes priority over BCD - numbers can't be both)"})]})}),i&&T.length>0&&X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:[X.jsxs("div",{className:"flex items-center justify-between mb-4",children:[X.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Filter Topics:"}),X.jsxs("div",{className:"flex items-center gap-4",children:[X.jsxs("span",{className:"text-sm text-gray-600",children:[x.size," of ",T.length," selected"]}),X.jsx("button",{onClick:G,className:"text-sm text-blue-600 hover:text-blue-800",children:"Select All"}),X.jsx("button",{onClick:re,className:"text-sm text-red-600 hover:text-red-800",children:"Clear All"}),X.jsx("button",{onClick:()=>S(!_),className:"text-sm text-gray-600 hover:text-gray-800",children:_?" Hide Selector":" Show Selector"})]})]}),_&&X.jsxs("div",{className:"space-y-4",children:[X.jsxs("div",{children:[X.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Topic Groups (Smart Selection)"}),X.jsx("div",{className:"flex flex-wrap gap-2",children:le().map(De=>{const Oe=ee(De),Xe=Z(De),nt=oe(De);return X.jsxs("button",{onClick:()=>se(De),className:`px-3 py-1 rounded-md text-sm font-medium transition-all ${Oe?"bg-blue-500 text-white":Xe?"bg-blue-200 text-blue-800 border-2 border-blue-400":"bg-gray-100 text-gray-700 hover:bg-blue-100"}`,title:`${De}: ${nt.join(", ")}`,children:[De," ",Oe?"":Xe?"":""]},De)})})]}),X.jsxs("div",{children:[X.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Individual Topics (Fine Control)"}),X.jsx("div",{className:"grid grid-cols-4 gap-2",children:T.map(De=>X.jsx("div",{className:"relative",children:X.jsx("button",{onClick:()=>D(De),className:`w-full px-2 py-1 rounded text-xs font-medium transition-all text-left ${x.has(De)?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-green-100"}`,children:X.jsxs("div",{className:"flex items-center justify-between",children:[X.jsx("span",{className:"truncate",children:te(De)}),x.has(De)&&X.jsx("span",{className:"text-white text-xs",children:""})]})})},De))})]})]}),x.size===0&&X.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:X.jsx("p",{className:"text-sm text-yellow-800",children:" No topics selected. Select at least one topic to view analysis results."})})]}),X.jsxs("div",{className:"p-6",children:[rt.length===0&&X.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-6",children:X.jsxs("div",{className:"flex items-start space-x-3",children:[X.jsx("div",{className:"text-2xl",children:""}),X.jsxs("div",{className:"flex-1",children:[X.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"No HR Data Available"}),X.jsx("p",{className:"text-yellow-700 mb-4",children:"The IndexPage requires both Excel data and Hour Entry data for at least one date to display HR tabs."}),X.jsxs("div",{className:"bg-white rounded-lg p-4 mb-4",children:[X.jsx("h4",{className:"font-semibold mb-2",children:"Current Data Status:"}),X.jsx("div",{className:"space-y-2 text-sm",children:["A","B","C","D"].map(De=>{const Oe=l[De],Xe=Oe==null?void 0:Oe.success,nt=!!(Oe!=null&&Oe.hrData),Je=nt?Object.keys(Oe.hrData).length:0;return X.jsxs("div",{className:"flex justify-between items-center",children:[X.jsxs("span",{className:"font-medium",children:[De,"-day (",(Oe==null?void 0:Oe.date)||"Unknown","):"]}),X.jsxs("div",{className:"flex items-center space-x-2",children:[X.jsx("span",{className:`px-2 py-1 rounded text-xs ${Xe?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Xe?" Complete":" Missing data"}),nt&&X.jsxs("span",{className:"text-xs text-gray-600",children:[Je," HR",Je!==1?"s":""]})]})]},De)})})]}),X.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[X.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" How to Fix:"}),X.jsxs("ol",{className:"list-decimal list-inside text-blue-700 space-y-1 text-sm",children:[X.jsx("li",{children:"Go back to the main ABCD page"}),X.jsx("li",{children:'For each missing date, click "Excel Upload" and upload Excel file'}),X.jsx("li",{children:'For each date, click "Hour Entry" and select planets for each HR'}),X.jsx("li",{children:"Return to IndexPage once you have complete data for at least one date"})]})]})]})]})}),i?(()=>{const De=new Set,Oe={availableLabels:Ye,activeHR:i,dayDataStatus:{}};if(Ye.forEach(Je=>{var ct;const wt=l[Je],gt=(ct=wt==null?void 0:wt.hrData)==null?void 0:ct[i],dt=gt==null?void 0:gt.sets;Oe.dayDataStatus[Je]={hasData:!!wt,success:wt==null?void 0:wt.success,hasHrData:!!gt,hasSets:!!dt,setCount:dt?Object.keys(dt).length:0,setNames:dt?Object.keys(dt):[]},dt&&Object.keys(dt).forEach(ut=>{De.add(ut)})}),console.log(` Rendering tables for HR${i}:`,Oe),De.size===0)return X.jsxs("div",{className:"text-center py-12",children:[X.jsx("div",{className:"text-4xl mb-4",children:""}),X.jsxs("p",{className:"text-lg font-semibold mb-4 text-red-600",children:["No Sets Found for HR",i]}),X.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg text-left max-w-2xl mx-auto",children:[X.jsx("h4",{className:"font-semibold mb-2",children:"Debug Information:"}),X.jsxs("div",{className:"text-sm space-y-1",children:[X.jsxs("div",{children:[X.jsx("strong",{children:"Available Labels:"})," ",Ye.join(", ")]}),X.jsxs("div",{children:[X.jsx("strong",{children:"Active HR:"})," ",i]}),Object.entries(Oe.dayDataStatus).map(([Je,wt])=>{var gt;return X.jsxs("div",{className:"ml-4",children:[X.jsxs("strong",{children:[Je,"-day:"]})," Success=",(gt=wt.success)==null?void 0:gt.toString(),", Sets=",wt.setCount," ",wt.setNames.length>0&&`(${wt.setNames.join(", ")})`]},Je)})]}),X.jsx("div",{className:"mt-3 text-xs text-gray-600",children:"Check console logs for detailed data loading information"})]})]});const Xe=ne(),nt=Array.from(De).filter(Je=>Xe.includes(Je));return console.log(" Topic filtering applied:",{totalSets:De.size,selectedTopics:x.size,availableTopics:T.length,topicsToDisplay:Xe.length,filteredSets:nt.length,setsToRender:nt}),nt.map(Je=>X.jsxs("div",{className:"mb-8",children:[X.jsx("h2",{className:"text-lg font-bold mb-3 bg-blue-50 p-2 rounded",children:Je}),X.jsx("div",{className:"overflow-x-auto",children:X.jsxs("table",{className:"w-full table-auto border-collapse",children:[X.jsx("thead",{children:X.jsxs("tr",{children:[X.jsx("th",{className:"border border-gray-300 px-4 py-2 font-semibold bg-gray-100",children:"Element"}),Ye.map(wt=>{const gt=l[wt];return X.jsx("th",{className:at(gt),children:qe(gt)},wt)})]})}),X.jsx("tbody",{children:(()=>{const wt=["Lagna","Moon","Hora Lagna","Ghati Lagna","Vighati Lagna","Varnada Lagna","Sree Lagna","Pranapada Lagna","Indu Lagna"],gt=new Set;Ye.forEach(ct=>{const ut=l[ct].hrData[i];ut&&ut.sets&&ut.sets[Je]&&Object.keys(ut.sets[Je]).forEach(ft=>gt.add(ft))}),Object.values(K).forEach(ct=>{gt.add(ct)});const dt=wt.filter(ct=>gt.has(ct));return console.log(` Rendering elements for ${Je} in specified order:`,dt),dt.map(ct=>X.jsxs("tr",{className:"hover:bg-gray-50",children:[X.jsx("td",{className:"border border-gray-300 px-4 py-2 font-medium bg-blue-200",children:ct}),Ye.map(ut=>{const ft=l[ut].hrData[i];let Et="",jt=!1;if(ft&&ft.sets&&ft.sets[Je]&&ft.sets[Je][ct]){const Vt=ft.sets[Je][ct];jt=Vt.hasData,Et=Vt.rawData||""}console.log(` Cell value for ${ut}-${ct}:`,{hasHrObj:!!ft,hasSets:!!(ft&&ft.sets),hasSetName:!!(ft&&ft.sets&&ft.sets[Je]),hasElement:!!(ft&&ft.sets&&ft.sets[Je]&&ft.sets[Je][ct]),hasData:jt,cellValue:Et});const Ot="border border-gray-300 px-4 py-2 text-center font-mono text-sm",yt=l[ut].dayLabel;return X.jsx("td",{className:`${Ot} ${We(l[ut])?"ring-2 ring-blue-400 bg-blue-50":jt?"bg-green-50 text-gray-800":"bg-red-50 text-gray-400"}`,children:ie(Et,Je,yt)},ut)})]},ct))})()})]})})]},Je))})():X.jsxs("div",{className:"text-center py-12 text-gray-500",children:[X.jsx("div",{className:"text-6xl mb-4",children:""}),X.jsx("p",{className:"text-lg font-semibold mb-2",children:"Select an HR above"}),X.jsx("p",{children:"Click an HR tab to view the available data matrices"})]})]})]}),X.jsx("div",{className:"flex justify-center mb-6",children:X.jsx("button",{onClick:()=>{je&&ye(t,i)},disabled:!je,className:`px-6 py-3 rounded-lg font-semibold transition-all duration-200 ${je?"bg-purple-500 hover:bg-purple-600 text-white shadow-lg hover:shadow-xl transform hover:-translate-y-1 cursor-pointer":"bg-gray-300 text-gray-600 cursor-not-allowed opacity-60"}`,children:" Extract Numbers (Enhanced)"})})]})})};function RV({visible:t,onClose:r,onSubmit:e,newDate:n,setNewDate:s,dateError:a,datesList:i}){if(!t)return null;const o=d=>{d.preventDefault(),e()},c=(()=>{if(i.length===0)return console.log(" No dates in list, no minimum restriction"),"";const d=[...i].sort((k,N)=>new Date(N)-new Date(k)),h=d[0];console.log(" Date restriction calculation:"),console.log("   Original dates list:",i),console.log("   Sorted dates (newest first):",d),console.log("   Most recent date string:",h);const f=new Date(h+"T00:00:00");console.log("   Most recent date as Date object:",f);const g=new Date(f);g.setDate(g.getDate()+1),console.log("   Next day date object:",g),console.log("   Next day getDate():",g.getDate()),console.log("   Next day getMonth():",g.getMonth()),console.log("   Next day getFullYear():",g.getFullYear());const m=g.toISOString().split("T")[0];console.log("   Calculated min date (day after most recent):",m);const p=g.getFullYear(),v=String(g.getMonth()+1).padStart(2,"0"),b=String(g.getDate()).padStart(2,"0"),y=`${p}-${v}-${b}`;return console.log("   Timezone-safe min date:",y),console.log("    All dates up to and including",h,"should be disabled"),console.log("    Only dates from",y,"onwards should be selectable"),y})();console.log(" Current min attribute value:",c);const u=Se.useRef(null);return Se.useEffect(()=>{u.current&&t&&(console.log(" Date input element:",u.current),console.log(" Date input min attribute:",u.current.min),console.log(" Date input value:",u.current.value))},[t,c]),X.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:X.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4",children:[X.jsxs("div",{className:"flex items-center justify-between mb-4",children:[X.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Add New Date"}),X.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 text-2xl font-bold",children:""})]}),X.jsxs("form",{onSubmit:o,children:[X.jsxs("div",{className:"mb-4",children:[X.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Date"}),X.jsx("input",{ref:u,type:"date",value:n,onChange:d=>s(d.target.value),min:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0}),a&&X.jsx("p",{className:"mt-2 text-sm text-red-600",children:a})]}),X.jsxs("div",{className:"flex gap-3 justify-end",children:[X.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),X.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Add Date"})]})]})]})})}const PV=({show:t,onClose:r,hourEntryDate:e,selectedUserData:n,planets:s,hourEntryPlanetSelections:a,handleHourEntryPlanetChange:i,handleSaveHourEntry:o,hourEntryError:l})=>{if(!t)return null;const c=u=>{u.target===u.currentTarget&&r()};return X.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",onClick:c,children:X.jsxs("div",{className:"bg-white p-6 rounded-lg max-w-5xl w-full mx-4 max-h-[90vh] overflow-y-auto shadow-xl",onClick:u=>u.stopPropagation(),children:[X.jsxs("div",{className:"text-center mb-6",children:[X.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:[" Hour Entry for ",e]}),X.jsx("p",{className:"text-sm text-gray-600",children:"Select a planet for each HR period"})]}),X.jsx("div",{className:"border-2 border-blue-200 rounded-lg p-4 bg-gradient-to-br from-blue-50 to-indigo-50 shadow-sm",children:X.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:n&&Array.from({length:n.hr},(u,d)=>d+1).map(u=>X.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[X.jsx("div",{className:"text-center mb-2",children:X.jsxs("span",{className:"inline-block bg-blue-600 text-white px-2 py-1 rounded-md text-sm font-semibold",children:["HR ",u]})}),X.jsxs("select",{value:a[u]||"",onChange:d=>i(u,d.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:border-blue-500 focus:ring-1 focus:ring-blue-200 bg-white text-center font-medium",children:[X.jsx("option",{value:"",children:" Select Planet"}),s.map(d=>X.jsx("option",{value:d.value,children:d.label},d.value))]}),a[u]&&X.jsx("div",{className:"mt-1.5 text-center",children:X.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-medium",children:" Selected"})})]},u))})}),l&&X.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:X.jsxs("div",{className:"flex items-center",children:[X.jsx("span",{className:"text-red-500 mr-2",children:""}),X.jsx("p",{className:"text-red-700 text-sm font-medium",children:l})]})}),X.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[X.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 hover:text-gray-700 transition-all duration-150 shadow-sm hover:shadow-md",children:"Cancel"}),X.jsx("button",{onClick:o,className:"px-6 py-2 text-sm font-medium rounded-lg shadow-sm hover:shadow-md transition-all duration-150 transform hover:scale-[1.02] bg-blue-600 hover:bg-blue-700 text-white border border-blue-600",children:" Save Entry"})]})]})})},OV=[{value:"Su",label:"Sun (Su)"},{value:"Mo",label:"Moon (Mo)"},{value:"Ma",label:"Mars (Ma)"},{value:"Me",label:"Mercury (Me)"},{value:"Ju",label:"Jupiter (Ju)"},{value:"Ve",label:"Venus (Ve)"},{value:"Sa",label:"Saturn (Sa)"},{value:"Ra",label:"Rahu (Ra)"},{value:"Ke",label:"Ketu (Ke)"}];function MV(){const t=mo(),{userId:r}=lm(),[e,n]=Se.useState([]),[s,a]=Se.useState(""),[i,o]=Se.useState(""),[l,c]=Se.useState(!1),[u,d]=Se.useState(""),[h,f]=Se.useState(""),[g,m]=Se.useState([]),[p,v]=Se.useState(!1),[b,y]=Se.useState(""),[k,N]=Se.useState(""),[L,F]=Se.useState(!1),[R,B]=Se.useState(""),[q,V]=Se.useState({}),[I,C]=Se.useState(""),[O,E]=Se.useState({}),[x,w]=Se.useState(!1),[_,S]=Se.useState(null),[T,U]=Se.useState(!1),[A,H]=Se.useState(null),[z,K]=Se.useState(!1),[j,J]=Se.useState(null),[P,D]=Se.useState(null),G={saveDates:(Ce,Ie)=>Gr.saveUserDates(Ce,Ie,Pn.ABCD),getDates:Ce=>Gr.getUserDates(Ce,Pn.ABCD),hasExcelData:(Ce,Ie)=>Gr.hasExcelData(Ce,Ie),getExcelData:(Ce,Ie)=>Gr.getExcelData(Ce,Ie),saveExcelData:(Ce,Ie,Ve)=>Gr.saveExcelData(Ce,Ie,Ve),hasHourEntry:(Ce,Ie)=>Gr.hasHourEntry(Ce,Ie),getHourEntry:(Ce,Ie)=>Gr.getHourEntry(Ce,Ie),saveHourEntry:(Ce,Ie,Ve)=>Gr.saveHourEntry(Ce,Ie,Ve.planetSelections),deleteDataForDate:async(Ce,Ie)=>{console.log(" [DATASERVICE] Calling comprehensive deletion for:",{userId:Ce,date:Ie});try{await Gr.deleteExcelData(Ce,Ie),await Gr.deleteHourEntry(Ce,Ie),console.log(" [DATASERVICE] CleanSupabaseService deletion completed")}catch(Oe){console.warn(" [DATASERVICE] CleanSupabaseService deletion had issues:",Oe.message)}const{DataService:Ve}=await Ma(async()=>{const{DataService:Oe}=await Promise.resolve().then(()=>gV);return{DataService:Oe}},void 0);await new Ve().deleteDataForDate(Ce,Ie),console.log(" [DATASERVICE] Comprehensive deletion completed")},invalidateAnalysisCacheForDate:()=>Promise.resolve(),invalidateUser:()=>Promise.resolve(),clearAllCache:()=>Promise.resolve(),warmUpCache:()=>Promise.resolve()},re=()=>Promise.resolve();Se.useEffect(()=>{te()},[]);const te=async()=>{try{c(!0);const Ce=await Gr.getAllUsers();if(Ce&&Ce.length>0){const Ie=Ce.map(Ve=>({...Ve,id:String(Ve.id),hr:Number(Ve.hr)||1}));n(Ie),r&&(a(r),await ne(r))}else{const Ie=[{id:"1",username:"Test User 1",hr:3},{id:"2",username:"Test User 2",hr:4},{id:"3",username:"Test User 3",hr:5}];try{for(const Ve of Ie)await Gr.createUser({username:Ve.username,email:`${Ve.username.toLowerCase().replace(" ","")}@example.com`,hr:Ve.hr});n(Ie)}catch(Ve){console.warn("Could not create default users, using local data:",Ve),n(Ie)}}d("")}catch(Ce){console.error("Failed to fetch users:",Ce),d("Failed to fetch users. Please try again.")}finally{c(!1)}};Se.useEffect(()=>{s?ne(s):(m([]),o(""))},[s]);const ne=async Ce=>{try{console.log(" Loading user dates for:",Ce);const Ie=await Gr.getUserDates(Ce,Pn.ABCD);if(console.log(" Loaded dates from user_dates_abcd table:",Ie),Ie&&Ie.length>0){const Ve=Ie.sort((De,Oe)=>new Date(Oe)-new Date(De));console.log(" Setting sorted dates in UI:",Ve),m(Ve),o(Ve[0]);return}console.log(" No dates found, setting empty state"),m([]),o("")}catch(Ie){console.error(" Error loading user dates:",Ie),m([]),o("")}};Se.useEffect(()=>{s?(ne(s),setTimeout(()=>{G.warmUpCache(s).catch(Ce=>console.warn("Cache warming failed:",Ce))},1e3)):(m([]),o(""))},[s]);const le=async()=>{if(!b){N("Please select a date.");return}if(!s){N("Please select a user first.");return}try{N("");const Ce=new Date(b).toISOString().split("T")[0];if(g.map(De=>new Date(De).toISOString().split("T")[0]).includes(Ce)){N("This date already exists.");return}console.log(" [PROGRESSIVE] Adding date with progressive calendar logic (no N-1 validation required)..."),console.log(` [PROGRESSIVE] User wants to add: ${Ce} - progressive calendar allows this`);try{if((await Gr.getUserDates(s)).includes(Ce)){N(`Date ${new Date(Ce).toLocaleDateString()} already exists for this user.`);return}console.log(" [PROGRESSIVE] Date validation passed - new date is unique")}catch{console.log(" [PROGRESSIVE] Could not check existing dates, proceeding anyway")}console.log(" Adding new date using CleanSupabaseService for ABCD page:",Ce),await Gr.addUserDate(s,Ce,Pn.ABCD),console.log(" Date added successfully to user_dates_abcd table"),await ne(s),console.log(" Reloaded dates from database after adding"),o(Ce),y(""),N(""),v(!1);const Ve=`Date ${new Date(Ce).toLocaleDateString()} added successfully. Ready for Excel upload and hour entry.`;f(Ve),setTimeout(()=>f(""),3e3)}catch(Ce){console.error(" Error adding date:",Ce),N("Failed to add date. Please try again.")}},oe=async Ce=>{try{if(console.log(" Starting date removal process for:",Ce),g.length<=1){console.log(" Removing last date using CleanSupabaseService for ABCD page:",Ce),await Gr.removeUserDate(s,Ce,Pn.ABCD),console.log(" Last date removed successfully from user_dates_abcd table"),await ne(s),o(""),f(`Date ${new Date(Ce).toLocaleDateString()} removed.`),setTimeout(()=>f(""),3e3);return}const Ie=g[0],Ve=g[g.length-1];if(Ce!==Ie&&Ce!==Ve){d("Only newest or oldest can be deleted directly."),setTimeout(()=>d(""),5e3);return}if(console.log(" Removing date using CleanSupabaseService for ABCD page:",Ce),await Gr.removeUserDate(s,Ce,Pn.ABCD),console.log(" Date removed successfully from user_dates_abcd table"),await ne(s),console.log(" Reloaded dates from database after removal"),i===Ce){const Oe=await Gr.getUserDates(s);Oe.length>0?o(Oe[0]):o("")}E(Oe=>{const Xe={...Oe};return delete Xe[Ce],Xe}),f(`${Ce===Ie?"Newest":"Oldest"} date ${new Date(Ce).toLocaleDateString()} removed.`),setTimeout(()=>f(""),3e3)}catch(Ie){console.error(" Error removing date:",Ie),d("Failed to remove date. Please try again."),setTimeout(()=>d(""),5e3)}},ee=async(Ce,Ie)=>{try{const Ve=Ce.target.files[0];if(!Ve)return;console.log(` STRICT VALIDATION: Starting upload for ${Ve.name}`);const De=10*1024*1024;if(Ve.size>De){d(`File too large! Maximum size is 10MB. Your file: ${(Ve.size/1024/1024).toFixed(2)}MB`),setTimeout(()=>d(""),8e3),Ce.target.value=null;return}const Oe=new FileReader;Oe.onload=async Xe=>{var nt;try{console.log(` Processing Excel file: ${Ve.name}`);const Je=new Uint8Array(Xe.target.result),wt=Hh(Je,{type:"array"}),gt=wt.Sheets[wt.SheetNames[0]],dt=Go.sheet_to_json(gt,{header:1});console.log(` Raw Excel data: ${dt.length} rows`);const ct=dV(dt,Ve.name);if(!ct.isValid){console.error(" VALIDATION FAILED:",ct.errors);const Ot=pV(ct,Ve.name);console.error(` VALIDATION REPORT:
`,Ot),d(" Excel file can't be uploaded - it's not from ABCD and BCD number file."),setTimeout(()=>d(""),5e3),Ce.target.value=null;return}let ut="";ct.warnings&&ct.warnings.length>0?(console.warn(" VALIDATION WARNINGS:",ct.warnings),ut=` File uploaded with ${ct.warnings.length} warning(s):
`,ct.warnings.slice(0,3).forEach((Ot,yt)=>{ut+=`${yt+1}. ${Ot}
`}),ct.warnings.length>3&&(ut+=`... and ${ct.warnings.length-3} more warnings
`),f(ut),setTimeout(()=>f(""),1e4)):(ut=`${ct.dataQualityScore>=98?"":ct.dataQualityScore>=95?"":""} Excel uploaded successfully for ${Ie} - Quality: ${((nt=ct.dataQualityScore)==null?void 0:nt.toFixed(1))||"100.0"}% (${ct.validDataCells||2430} valid cells)`,f(ut),setTimeout(()=>f(""),8e3)),console.log(" VALIDATION PASSED - Processing data...");const ft=Z(dt,Ie);await G.saveExcelData(s,Ie,{fileName:Ve.name,sets:ft.sets,date:Ie,uploadedAt:new Date().toISOString(),validationReport:ct});const Et=await G.hasExcelData(s,Ie),jt=await G.hasHourEntry(s,Ie);console.log(` Status after Excel upload for ${Ie}:`,{excelUploaded:Et,hourEntryCompleted:jt,key:`${s}_${Ie}`}),E(Ot=>({...Ot,[Ie]:{excelUploaded:Et,hourEntryCompleted:jt}})),f(` Excel file validated and uploaded successfully for ${new Date(Ie).toLocaleDateString()}!`),setTimeout(()=>f(""),5e3),m([...g])}catch(Je){console.error(" Excel processing error:",Je),d(`Failed to process Excel file: ${Je.message}

Please ensure the file matches the required template format.`),setTimeout(()=>d(""),8e3)}},Oe.readAsArrayBuffer(Ve),Ce.target.value=null,Ce.target.value=null}catch(Ve){d(`Failed to upload file: ${Ve.message}`),setTimeout(()=>d(""),5e3)}},Z=(Ce,Ie)=>{console.log(` Processing Excel with all 9 planets for ${Ie}, ${Ce.length} rows`);const Ve={date:Ie,sets:{},planets:{}},De={1:"Su",2:"Mo",3:"Ma",4:"Me",5:"Ju",6:"Ve",7:"Sa",8:"Ra",9:"Ke"},Oe={as:"Lagna",mo:"Moon",hl:"Hora Lagna",gl:"Ghati Lagna",vig:"Vighati Lagna",var:"Varnada Lagna",sl:"Sree Lagna",pp:"Pranapada Lagna",in:"Indu Lagna"};let Xe=null,nt={};for(let Je=0;Je<Ce.length;Je++){const wt=Ce[Je];if(!Array.isArray(wt)||wt.length===0)continue;const gt=String(wt[0]||"").trim();if(gt.includes("Matrix")&&(gt.includes("D-")||gt.includes("Set-"))){Xe&&Object.keys(nt).length>0&&(Ve.sets[Xe]={...nt}),Xe=gt,nt={},console.log(` Found set: ${Xe}`);continue}if(gt.toLowerCase()==="x"||["sun","moon","mars","mercury","jupiter","venus","saturn","rahu","ketu"].some(dt=>gt.toLowerCase().includes(dt))){console.log(` Skipping planet header row: ${gt}`);continue}if(Xe&&gt&&gt.length<=3){const dt=gt.toLowerCase();if(Oe[dt]){const ct=Oe[dt],ut={};for(let ft=1;ft<=9&&ft<wt.length;ft++){const Et=wt[ft];if(Et&&typeof Et=="string"&&Et.trim()){const jt=De[ft];ut[jt]=Et.trim()}}Object.keys(ut).length>0&&(nt[ct]=ut,console.log(`   ${ct}: ${Object.keys(ut).length} planets`))}}}return Xe&&Object.keys(nt).length>0&&(Ve.sets[Xe]={...nt}),console.log(` Processed ${Object.keys(Ve.sets).length} sets for ${Ie}`),console.log(" Sets found:",Object.keys(Ve.sets)),Ve},se=async Ce=>{if(!s){d("Please select a user first.");return}await G.getExcelData(s,Ce);const Ie=e.find(Oe=>Oe.id.toString()===s);if(!(Ie!=null&&Ie.hr)){d("User HR info missing.");return}let Ve={};for(let Oe=1;Oe<=Ie.hr;Oe++)Ve[Oe]="";const De=await G.getHourEntry(s,Ce);De&&De.planetSelections&&(Ve={...De.planetSelections}),B(Ce),V(Ve),C(""),F(!0)},ie=(Ce,Ie)=>{V(Ve=>({...Ve,[Ce]:Ie}))},ue=async()=>{const Ce=e.find(De=>De.id.toString()===s);let Ie=!0;for(let De=1;De<=Ce.hr;De++)if(!q[De]){Ie=!1;break}if(!Ie){C("Select a planet for each HR.");return}const Ve={userId:s,date:R,planetSelections:q,savedAt:new Date().toISOString()};try{await G.saveHourEntry(s,R,Ve);const De=await G.hasExcelData(s,R),Oe=await G.hasHourEntry(s,R);console.log(` Status after Hour Entry save for ${R}:`,{excelUploaded:De,hourEntryCompleted:Oe,key:`${s}_${R}`}),E(Xe=>({...Xe,[R]:{excelUploaded:De,hourEntryCompleted:Oe}})),F(!1),f(`Hour entry saved for ${new Date(R).toLocaleDateString()}.`),setTimeout(()=>f(""),3e3)}catch{C("Failed to save. Try again.")}},pe=async Ce=>{if(console.log(" handleIndexClick called with date:",Ce),console.log(" Current datesList:",g),console.log(" INDEXPAGE vs RULE-1 INPUT COMPARISON:"),console.log("   IndexPage clicked date:",Ce,typeof Ce),console.log("   IndexPage datesList:",g),console.log("   IndexPage user:",s),console.log("   Rule-1 would get SAME inputs for SAME button click"),!s){d("Please select a user first.");return}const Ie=await G.getExcelData(s,Ce),Ve=await G.getHourEntry(s,Ce);if(!Ve){d("Complete Hour Entry for this date first.");return}try{console.log(" Excel data structure:",Ie.data),console.log(" Hour entry selections:",Ve.planetSelections),H({date:Ce,selectedUser:s}),U(!0)}catch{d("Error processing saved data. Please re-upload Excel and complete Hour Entry.")}},fe=()=>{U(!1),H(null)},ye=async Ce=>{if(console.log(" handleRule2Click called with date:",Ce),console.log(" Current datesList:",g),console.log(" Current selectedUser:",s),console.log(" === ABCDNUMBER RULE2 DEBUG ==="),console.log(" Clicked date type:",typeof Ce),console.log(" Clicked date value:",JSON.stringify(Ce)),console.log(" DatesList type:",typeof g),console.log(" DatesList value:",JSON.stringify(g)),!s){console.log(" No user selected"),d("Please select a user first.");return}const Ie=[...g].sort((gt,dt)=>new Date(gt)-new Date(dt)),Ve=Ie.indexOf(Ce);if(console.log(" ABCDBCDNumber date processing (FIXED):"),console.log("  Sorted dates:",Ie),console.log(`  Clicked date "${Ce}" is at index ${Ve} (position ${Ve+1})`),Ve<3){d("Rule-2 requires the clicked date to have at least 3 preceding dates. This is only the "+(Ve+1)+Pe(Ve+1)+" date chronologically.");return}const De=Ie[Ve-3],Oe=Ie[Ve-2],Xe=Ie[Ve-1],nt=Ie[Ve];console.log(" Checking dates for ABCD sequence:"),console.log("   A (3rd back):",De),console.log("   B (2nd back):",Oe),console.log("   C (1st back):",Xe),console.log("   D (clicked):",nt," Analysis source"),console.log("   D (1st back):",nt);const Je=[{label:"A",date:De},{label:"B",date:Oe},{label:"C",date:Xe},{label:"D",date:nt}],wt=[];for(const{label:gt,date:dt}of Je){const ct=await G.hasExcelData(s,dt),ut=await G.hasHourEntry(s,dt);ct||wt.push(`${gt}-day (${new Date(dt).toLocaleDateString()}): Missing Excel file`),ut||wt.push(`${gt}-day (${new Date(dt).toLocaleDateString()}): Missing Hour Entry`)}if(wt.length>0){d(`Rule-2 requires Excel and Hour Entry for all ABCD dates:

${wt.join(`
`)}`);return}console.log(" All validations passed, showing Rule2Page"),S({date:Ce,selectedUser:s}),w(!0)},Te=async Ce=>{if(console.log(" handlePlanetsAnalysisClick called with date:",Ce),console.log(" Date type:",typeof Ce),console.log(" Date value (JSON):",JSON.stringify(Ce)),console.log(" Current datesList:",g),console.log(" Current selectedUser:",s),!s){console.log(" No user selected"),d("Please select a user first.");return}console.log(" [PROGRESSIVE] Navigating to Planets Analysis with progressive calendar logic..."),console.log(` [PROGRESSIVE] User selected date: ${Ce} - allowing direct navigation`);const Ie=`/planets-analysis/${s}?date=${Ce}`;console.log(" Navigating to URL:",Ie),t(Ie)},Pe=Ce=>{if(Ce%100>=11&&Ce%100<=13)return"th";switch(Ce%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},je=()=>{w(!1),S(null)},qe=Ce=>{if(console.log(" handleRule1Click called with date:",Ce),console.log(" Current datesList:",g),console.log(" Current selectedUser:",s),!s){console.log(" No user selected"),d("Please select a user first.");return}const Ie=[...g].sort((Oe,Xe)=>new Date(Oe)-new Date(Xe)),Ve=Ie.indexOf(Ce);if(Ve<4){d("Past Days requires at least 5 dates. This is only the "+(Ve+1)+Pe(Ve+1)+" date chronologically.");return}const De=Ie[3];console.log(" Past Days validation passed, showing Rule1PageEnhanced"),console.log(` FIXED: Past Days  Display: "${Ce}", Analysis: "${De}" (rule2page logic)`),console.log(` User clicked: "${Ce}"  Show this date as Target, but analyze: "${De}"`),J({date:Ce,analysisDate:De,selectedUser:s}),K(!0)},We=()=>{K(!1),J(null)},at=(Ce,Ie,Ve=null)=>{console.log(" Enhanced extract numbers navigation:",{date:Ce,activeHR:Ie,hasEnhancedData:!!Ve}),S({date:Ce,selectedUser:s,activeHR:Ie,enhancedData:Ve}),w(!0)};Se.useEffect(()=>{r&&e.length>0&&a(r)},[r,e]);const Ye=e.find(Ce=>Ce.id.toString()===s);Se.useEffect(()=>{(async()=>{if(!s||g.length===0){E({});return}const Ie={};for(const Ve of g){const De=await G.hasExcelData(s,Ve),Oe=await G.hasHourEntry(s,Ve);Ie[Ve]={excelUploaded:De,hourEntryCompleted:Oe}}E(Ie)})()},[g,s]);const rt=Ce=>{var Ie;return((Ie=O[Ce])==null?void 0:Ie.excelUploaded)||!1},ht=Ce=>{var Ie;return((Ie=O[Ce])==null?void 0:Ie.hourEntryCompleted)||!1};return Se.useEffect(()=>{(async()=>{if(g.length>0&&s){console.log(" Rule-2 Debug Info:"),console.log("   - Total dates:",g.length),console.log("   - Checking Rule-2 availability per date based on chronological position (thisIndex >= 4)"),console.log("   - Dates list:",g);for(const[Ie,Ve]of g.entries()){const Oe=[...g].sort((wt,gt)=>new Date(wt)-new Date(gt)).indexOf(Ve),Xe=Oe>=4,nt=await G.hasExcelData(s,Ve),Je=await G.hasHourEntry(s,Ve);console.log(`   - Date ${Ie+1} (${Ve}): chronoIndex=${Oe}, Rule2Available=${Xe}, Excel=${nt}, HourEntry=${Je}`)}}})()},[g,s]),Se.useEffect(()=>{(async()=>{var Ie;if(s){console.log(" DEBUG: Current user data state for",s);const Ve=await G.getDates(s);console.log(" Available dates:",Ve);for(const De of Ve){const Oe=await G.getExcelData(s,De),Xe=await G.getHourEntry(s,De);console.log(` Data for ${De}:`,{hasExcel:!!Oe,hasHour:!!Xe,excelSets:(Ie=Oe==null?void 0:Oe.data)!=null&&Ie.sets?Object.keys(Oe.data.sets):[],hourPlanets:Xe!=null&&Xe.planetSelections?Object.keys(Xe.planetSelections):[]})}}})()},[s]),x&&_?X.jsx(CV,{date:_.date,selectedUser:_.selectedUser,datesList:g,onBack:je,activeHR:_.activeHR,enhancedData:_.enhancedData},`rule2-${s}-${g.length}-${JSON.stringify(g)}`):T&&A?X.jsx(DV,{date:A.date,selectedUser:A.selectedUser,datesList:g,onBack:fe,onExtractNumbers:at},`index-${s}-${g.length}-${JSON.stringify(g)}`):z&&j?X.jsx(EV,{date:j.date,analysisDate:j.analysisDate,selectedUser:j.selectedUser,datesList:g,onBack:We,users:e},`rule1-${s}-${g.length}-${JSON.stringify(g)}`):X.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:X.jsxs("div",{className:"container mx-auto px-4 py-6",children:[X.jsx("div",{className:"bg-white rounded-lg shadow-lg p-4 mb-6 border-t-4 border-purple-600",children:X.jsxs("div",{className:"flex items-center justify-between",children:[X.jsxs("div",{children:[X.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"ABCD BCD Number"}),Ye?X.jsxs("div",{className:"text-sm text-purple-800",children:[X.jsxs("p",{children:[" User: ",Ye.username]}),X.jsxs("p",{children:[" HR Numbers: ",Ye.hr]}),X.jsxs("p",{children:[" Dates: ",g.length]}),P&&X.jsxs("p",{children:[" Cache: ",P.provider," ",P.available?"":""]})]}):X.jsxs("div",{className:"text-sm text-red-600",children:[X.jsx("p",{children:" No user data found"}),P&&X.jsxs("p",{children:[" Cache: ",P.provider," ",P.available?"":""]})]})]}),X.jsxs("div",{className:"flex gap-2",children:[P&&X.jsx("button",{onClick:async()=>{await G.clearAllCache(),await re(),f("Cache cleared successfully"),setTimeout(()=>f(""),3e3)},className:"bg-orange-500 hover:bg-orange-600 text-white px-3 py-1 rounded-lg text-xs",title:"Clear all cache",children:" Cache"}),X.jsx("button",{onClick:()=>v(!0),className:"bg-purple-500 hover:bg-purple-600 text-white px-3 py-1 rounded-lg",children:"Add Date"}),X.jsx(ti,{to:"/",className:"bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded-lg",children:"Back to Home"})]})]})}),X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-3 mb-4",children:[X.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:" Dates List"}),g.length>0?X.jsx("div",{className:"space-y-2",children:g.map((Ce,Ie)=>{const De=[...g].sort((gt,dt)=>new Date(gt)-new Date(dt)).indexOf(Ce);g.length===1||Ie===0||g.length-1;const Oe=rt(Ce),Xe=ht(Ce),nt=De>=4,Je=nt,wt=De>=3;return X.jsxs("div",{className:`flex items-center gap-2 p-2.5 rounded-lg border transition-all ${i===Ce?"bg-purple-50 border-purple-300 shadow-sm":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,children:[X.jsx("div",{className:"cursor-pointer min-w-[120px]",onClick:()=>o(Ce),children:X.jsx("div",{className:"font-bold text-blue-700 text-base",children:new Date(Ce).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})}),X.jsxs("div",{className:"flex gap-1.5 flex-wrap",children:[X.jsxs("div",{className:"relative",children:[X.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:gt=>ee(gt,Ce),className:"hidden",id:`excel-upload-${Ce}`}),X.jsxs("label",{htmlFor:`excel-upload-${Ce}`,className:`px-2 py-1 text-xs font-medium rounded cursor-pointer transition-all ${Oe?"bg-green-100 text-green-700 border border-green-300":"bg-purple-100 text-purple-700 border border-purple-300 hover:bg-purple-200"}`,children:[" Excel",Oe?" ":""]})]}),X.jsxs("button",{onClick:()=>se(Ce),disabled:!1,className:`px-2 py-1 text-xs font-medium rounded transition-all ${Xe?"bg-blue-100 text-blue-700 border border-blue-300":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:["Hour Entry",Xe?" ":""]}),X.jsx("button",{onClick:()=>pe(Ce),disabled:!1,className:"px-2 py-1 text-xs font-medium rounded transition-all bg-orange-500 hover:bg-orange-600 text-white",children:"Index"}),nt&&X.jsx("button",{onClick:()=>Je?qe(Ce):null,disabled:!Je,className:`px-2 py-1 text-xs font-medium rounded transition-all ${Je?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,title:Je?"Past Days Analysis - 4-day rolling window":"Past Days disabled - requires at least 5 total dates",children:"Past Days"}),wt&&X.jsx("button",{onClick:()=>ye(Ce),className:"px-2 py-1 text-xs font-medium rounded bg-purple-500 text-white hover:bg-purple-600",children:"Rule-2"}),X.jsx("button",{onClick:()=>Te(Ce),className:"px-2 py-1 text-xs font-medium rounded bg-cyan-500 text-white hover:bg-cyan-600",title:"Planets Analysis - Target data (left) vs Planets data (right)",children:"Planets"}),(()=>{const gt=[...g].sort((ft,Et)=>new Date(ft)-new Date(Et)),dt=gt.indexOf(Ce),ct=gt.length-1,ut=dt===0||dt===ct;return X.jsx("button",{onClick:()=>{if(!ut)return;const ft=`Are you sure you want to delete ${new Date(Ce).toLocaleDateString()}? This action cannot be undone.`;window.confirm(ft)&&oe(Ce)},disabled:!ut,className:`px-2 py-1 text-xs font-medium rounded ${ut?"bg-red-500 hover:bg-red-600 text-white":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:"Delete"})})()]}),X.jsxs("div",{className:"ml-auto flex flex-col gap-0.5",children:[X.jsx("div",{className:`text-xs px-1.5 py-0.5 rounded ${Oe?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Oe?" Excel ":" No Excel"}),X.jsx("div",{className:`text-xs px-1.5 py-0.5 rounded ${Xe?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"}`,children:Xe?" Hour ":" Pending"})]})]},Ce)})}):X.jsxs("div",{className:"text-center py-8 text-gray-500",children:[X.jsx("div",{className:"text-4xl mb-3",children:""}),X.jsx("h3",{className:"text-lg font-semibold mb-1",children:"No dates added yet"}),X.jsx("p",{className:"text-sm",children:'Click "Add Date" to start your astrological analysis'})]})]}),u&&X.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 text-red-700 px-3 py-2 rounded mb-4",children:u}),h&&X.jsx("div",{className:"bg-green-50 border-l-4 border-green-400 text-green-700 px-3 py-2 rounded mb-4",children:h}),X.jsx(RV,{visible:p,onClose:()=>{v(!1),y(""),N("")},onSubmit:le,newDate:b,setNewDate:y,dateError:k,datesList:g}),X.jsx(PV,{show:L,onClose:()=>{F(!1),C("")},hourEntryDate:R,datesList:g,hourEntryPlanetSelections:q,setHourEntryPlanetSelections:V,hourEntryError:I,handleHourEntryPlanetChange:ie,handleSaveHourEntry:ue,selectedUserData:Ye,planets:OV})]})})}class FV{constructor(){this.tableName="topic_abcd_bcd_numbers"}async getAllTopicNumbers(){try{console.log(" [AbcdBcdDB] Fetching all topic numbers from database...");const{data:r,error:e}=await Lt.from(this.tableName).select("topic_name, abcd_numbers, bcd_numbers").order("topic_name");if(e)return console.error(" [AbcdBcdDB] Database error:",e),{success:!1,error:`Database error: ${e.message}`,data:null};if(!r||r.length===0)return console.warn(" [AbcdBcdDB] No topic numbers found in database"),{success:!1,error:"No topic numbers found in database",data:null};const n={};return r.forEach(s=>{n[s.topic_name]={abcd:s.abcd_numbers||[],bcd:s.bcd_numbers||[]}}),console.log(` [AbcdBcdDB] Loaded ${r.length} topics from database`),{success:!0,data:{topicNumbers:n,totalTopics:r.length,source:"Database (topic_abcd_bcd_numbers)",lastUpdated:new Date().toISOString()},error:null}}catch(r){return console.error(" [AbcdBcdDB] Service error:",r),{success:!1,error:`Service error: ${r.message}`,data:null}}}async getTopicNumbers(r){try{console.log(` [AbcdBcdDB] Fetching numbers for topic: ${r}`);const{data:e,error:n}=await Lt.from(this.tableName).select("abcd_numbers, bcd_numbers").eq("topic_name",r).single();if(n)return console.error(` [AbcdBcdDB] Error fetching topic ${r}:`,n),{abcd:[],bcd:[]};if(!e)return console.warn(` [AbcdBcdDB] Topic not found: ${r}`),{abcd:[],bcd:[]};const s={abcd:e.abcd_numbers||[],bcd:e.bcd_numbers||[]};return console.log(` [AbcdBcdDB] Topic ${r}:`,s),s}catch(e){return console.error(` [AbcdBcdDB] Error fetching topic ${r}:`,e),{abcd:[],bcd:[]}}}async updateTopicNumbers(r,e,n,s=""){try{console.log(` [AbcdBcdDB] Updating topic: ${r}`),console.log(`   ABCD: [${e.join(", ")}]`),console.log(`   BCD: [${n.join(", ")}]`);const{data:a,error:i}=await Lt.from(this.tableName).update({abcd_numbers:e,bcd_numbers:n,notes:s,updated_at:new Date().toISOString()}).eq("topic_name",r).select();return i?(console.error(` [AbcdBcdDB] Error updating topic ${r}:`,i),{success:!1,error:`Database error: ${i.message}`}):(console.log(` [AbcdBcdDB] Successfully updated topic: ${r}`),{success:!0,data:a[0]||null})}catch(a){return console.error(` [AbcdBcdDB] Error updating topic ${r}:`,a),{success:!1,error:`Service error: ${a.message}`}}}isAbcdNumber(r,e){return!r||!r.abcd?!1:r.abcd.includes(e)}isBcdNumber(r,e){return!r||!r.bcd?!1:r.bcd.includes(e)}getAnalysisSummary(r){if(!r.success||!r.data)return{source:"Database (failed)",totalTopics:0,totalAbcdNumbers:0,totalBcdNumbers:0,lastUpdated:new Date().toISOString()};const{topicNumbers:e}=r.data;let n=0,s=0;return Object.values(e).forEach(a=>{n+=a.abcd.length,s+=a.bcd.length}),{source:r.data.source,totalTopics:r.data.totalTopics,totalAbcdNumbers:n,totalBcdNumbers:s,lastUpdated:r.data.lastUpdated}}async bulkUpdateTopics(r){try{console.log(` [AbcdBcdDB] Bulk updating ${r.length} topics...`);const e=[];for(const s of r){const a=await this.updateTopicNumbers(s.topicName,s.abcdNumbers,s.bcdNumbers,s.notes);e.push({topicName:s.topicName,...a})}const n=e.filter(s=>s.success).length;return console.log(` [AbcdBcdDB] Bulk update completed: ${n}/${r.length} successful`),{success:n===r.length,results:e,summary:`${n}/${r.length} topics updated successfully`}}catch(e){return console.error(" [AbcdBcdDB] Bulk update error:",e),{success:!1,error:`Bulk update error: ${e.message}`}}}}const F3=new FV;function j3(){const t=mo(),{userId:r}=lm(),e=Hu(),[n,s]=Se.useState(!1),[a,i]=Se.useState(""),[o,l]=Se.useState(""),[c,u]=Se.useState(null),[d,h]=Se.useState(new Set),[f,g]=Se.useState(!0),[m,p]=Se.useState(null),[v,b]=Se.useState(""),[y,k]=Se.useState(1),[N,L]=Se.useState({}),[F,R]=Se.useState(!1),[B,q]=Se.useState(null),[V,I]=Se.useState(!1),[C,O]=Se.useState(null),[E,x]=Se.useState("loading");Se.useEffect(()=>{const Z=async()=>{if(r)try{const{data:ue,error:pe}=await Lt.from("users").select("id, username, hr, days").eq("id",r).single();if(pe)throw pe;p(ue)}catch(ue){console.error("Error loading user info:",ue),p({id:r,username:"Unknown User",hr:"N/A"})}},se=new URLSearchParams(e.search),ie=se.get("date");console.log(" [PlanetsAnalysis] URL date extraction:"),console.log("  Full URL:",window.location.href),console.log("  Search params:",e.search),console.log("  All params:",Object.fromEntries(se.entries())),console.log("  Extracted dateParam:",ie),console.log("  dateParam type:",typeof ie),console.log("  Current selectedDate state:",v),console.log("  Provided userId:",r),ie?(console.log("   Setting selectedDate to:",ie),b(ie)):(console.log("   No date parameter found in URL"),console.log("   Expected URL format: /planets-analysis/{userId}?date=2025-07-07")),Z()},[r,e.search]),Se.useEffect(()=>{r&&m&&(console.log(" [PlanetsAnalysis] Triggering data load - userId:",r,"selectedDate:",v),w())},[r,m,v]),Se.useEffect(()=>{m&&m.hr&&y>m.hr&&k(1)},[m]),Se.useEffect(()=>{if(C&&y){if(console.log(` [PlanetsAnalysis] Hour/Data change detected - HR ${y}`),console.log(` [PlanetsAnalysis] Current realAnalysisData source: ${C.source}`),console.log(" [PlanetsAnalysis] Real analysis data updated for HR switching"),C.topicNumbers){const Z=Object.keys(C.topicNumbers).length;console.log(` [PlanetsAnalysis] Real analysis data contains ${Z} topics`)}if(C.topicNumbers&&C.topicNumbers["D-1 Set-1 Matrix"]){const Z=C.topicNumbers["D-1 Set-1 Matrix"];console.log(` [PlanetsAnalysis] Effect - D-1 Set-1 Matrix HR ${y}:`,Z)}}},[y,C]);const w=async()=>{try{I(!0),i(""),x("loading"),console.log(" [PlanetsAnalysis] Loading ABCD/BCD numbers from all sources...");try{if(r){console.log(" [PlanetsAnalysis] Attempting to fetch real Rule2 analysis data...");let se=[];console.log(" [DEBUG] Loading dates - Priority 1: CleanSupabaseServiceWithSeparateStorage");try{const{default:ie,PAGE_CONTEXTS:ue}=await Ma(async()=>{const{default:pe,PAGE_CONTEXTS:fe}=await Promise.resolve().then(()=>N5);return{default:pe,PAGE_CONTEXTS:fe}},void 0);console.log(" [PlanetsAnalysis] Attempting to load dates from CleanSupabaseServiceWithSeparateStorage..."),console.log(" [PlanetsAnalysis] Using userId:",r),console.log(" [PlanetsAnalysis] Using PAGE_CONTEXTS.ABCD:",ue.ABCD),se=await ie.getUserDates(r,ue.ABCD),console.log(" [PlanetsAnalysis] CleanSupabaseServiceWithSeparateStorage result:",se),console.log(" [PlanetsAnalysis] Result type:",typeof se),console.log(" [PlanetsAnalysis] Result length:",se?se.length:"null/undefined"),se&&se.length>0?(console.log(" [PlanetsAnalysis] Successfully loaded dates from CleanSupabaseServiceWithSeparateStorage"),console.log(" [PRIORITY DEBUG] All dates from CleanSupabaseServiceWithSeparateStorage:",se),console.log(" [PRIORITY DEBUG] July 2025 dates available:",se.filter(pe=>pe.startsWith("2025-07")))):(console.log(" [PlanetsAnalysis] CleanSupabaseServiceWithSeparateStorage returned empty/null result"),se=[])}catch(ie){console.log(" [PlanetsAnalysis] CleanSupabaseServiceWithSeparateStorage error:",ie),console.log(" [PlanetsAnalysis] Error details:",ie.message),console.log(" [PlanetsAnalysis] Error stack:",ie.stack),se=[]}if(se.length===0){console.log(" [DEBUG] CleanSupabaseServiceWithSeparateStorage failed, falling back to localStorage");try{const ie=localStorage.getItem(`abcd_dates_${r}`);if(ie)se=JSON.parse(ie),console.log(" [PlanetsAnalysis] Found dates in localStorage:",se);else{console.log(" [PlanetsAnalysis] No dates found in localStorage with key:",`abcd_dates_${r}`);const pe=Object.keys(localStorage).filter(ye=>ye.includes(r));console.log(" [PlanetsAnalysis] Available localStorage keys for user:",pe);const fe=[`abcd_dates_${r}`,`dates_${r}`,`user_dates_${r}`,`${r}_dates`];for(const ye of fe){const Te=localStorage.getItem(ye);if(Te){console.log(` [PlanetsAnalysis] Found dates in alternative key "${ye}":`,JSON.parse(Te)),se=JSON.parse(Te);break}}}}catch(ie){console.log(" [PlanetsAnalysis] Error reading localStorage dates:",ie)}}if(se.length===0){console.log(" [PlanetsAnalysis] CRITICAL: No dates found in any source!"),console.log(" [PlanetsAnalysis] This suggests a data storage/retrieval issue"),i("No date data available. Please ensure data is properly loaded in the system."),I(!1);return}if(v&&!se.includes(v)&&(console.log(` [PlanetsAnalysis] Selected date ${v} not in availableDates`),console.log(" [PlanetsAnalysis] Current availableDates:",se),se=[...se,v].sort((ue,pe)=>new Date(ue)-new Date(pe)),console.log(` [PlanetsAnalysis] Added ${v} to availableDates`),console.log(" [PlanetsAnalysis] Updated availableDates:",se),console.log(` [PlanetsAnalysis] Selected date ${v} now at position:`,se.indexOf(v)+1)),se&&se.length>0){i("");try{console.log(" [PlanetsAnalysis] Loading real ABCD/BCD data for each hour using RealTimeRule2AnalysisService...");const{RealTimeRule2AnalysisService:ie}=await Ma(async()=>{const{RealTimeRule2AnalysisService:ye}=await import("./realTimeRule2AnalysisService-1xb6PKaA.js");return{RealTimeRule2AnalysisService:ye}},[]);let ue=v,pe=v;if(console.log(" [DEBUG] Date selection debug (Simple Previous Date Logic):"),console.log("  selectedDate from URL:",v),console.log("  availableDates:",se),console.log("  availableDates length:",se.length),console.log("  availableDates (sorted):",[...se].sort()),console.log("  selectedDate type:",typeof v),v==="2025-07-08"&&(console.log(" [JULY 8TH DEBUG] Special debug for July 8th click:"),console.log("   Is July 7th (2025-07-07) in availableDates?",se.includes("2025-07-07")),console.log("   Is July 6th (2025-07-06) in availableDates?",se.includes("2025-07-06")),console.log("   Is July 5th (2025-07-05) in availableDates?",se.includes("2025-07-05")),console.log("   All July 2025 dates in availableDates:",se.filter(ye=>ye.startsWith("2025-07"))),console.log("   All June 2025 dates in availableDates:",se.filter(ye=>ye.startsWith("2025-06")))),!ue||!(v!=null&&v.trim())){const ye=[...se].sort((Te,Pe)=>new Date(Te)-new Date(Pe));ue=ye[ye.length-1],pe=ue,console.log("  No selectedDate, using latest:",ue)}else{if(pe=v.trim(),console.log("   SIMPLIFIED PATTERN Applied:"),console.log("    Display date (user clicked):",pe),console.log("    Available dates:",se),console.log("   Finding closest previous date with data..."),se.length===0){console.log("   DEBUG: No available dates found!");try{const{default:je,PAGE_CONTEXTS:qe}=await Ma(async()=>{const{default:at,PAGE_CONTEXTS:Ye}=await Promise.resolve().then(()=>N5);return{default:at,PAGE_CONTEXTS:Ye}},void 0),We=await je.getUserDates(r,qe.ABCD);console.log("   DEBUG: Found dates from CleanSupabaseServiceWithSeparateStorage:",We),We&&We.length>0&&(se=We)}catch(je){console.log("   DEBUG: CleanSupabaseServiceWithSeparateStorage also failed:",je)}}const ye=[...se].sort((je,qe)=>new Date(je)-new Date(qe));console.log("   DEBUG: sortedDates after sorting:",ye),console.log("   DEBUG: selectedDate:",v);const Te=new Date(v);console.log(`   ALWAYS finding closest previous date before ${v} (N-1 pattern)...`),console.log("   Available dates to check:",ye),console.log("   Note: With sparse dates (1,3,7,8), N-1 pattern requires closest previous logic");let Pe=null;for(let je=ye.length-1;je>=0;je--){const qe=new Date(ye[je]),We=qe<Te,at=(Te.getTime()-qe.getTime())/(1e3*60*60*24);if(console.log(`     Checking: ${ye[je]} < ${v} = ${We}, gap: ${Math.round(at)} days`),We){Pe=ye[je],console.log(`     Found closest previous date (${Math.round(at)} days gap): ${Pe}`);break}}Pe||(Pe=ye[ye.length-1],console.log(`     No previous date found, using latest available: ${Pe}`)),ue=Pe,console.log(`   FINAL LOGIC: ${v} clicked  using ${ue} data`),console.log("   Analysis will use the closest previous date with actual data"),console.log("   FINAL: Date selection complete - Analysis will use date:",ue)}console.log(` [PlanetsAnalysis] Using date for analysis: ${ue} (clicked: ${v||"none"})`),l(v&&ue?` Clicked ${new Date(v).toLocaleDateString()}  Using closest previous data from ${new Date(ue).toLocaleDateString()}`:v?` No previous data available for ${new Date(v).toLocaleDateString()}`:` Analyzing data for ${new Date(ue).toLocaleDateString()} (latest available date)`);const fe=await ie.performRule2Analysis(r,ue,se);if(fe.success&&fe.data.hrResults){const ye={},Te=fe.data.hrResults;if(console.log(" [PlanetsAnalysis] RealTime analysis successful! Found HR results:",Object.keys(Te)),Object.entries(Te).forEach(([Pe,je])=>{var qe,We;if(je&&!je.error&&je.topicResults){const at={};je.topicResults.forEach(Ye=>{Ye.error||(at[Ye.setName]={abcd:Ye.abcdNumbers||[],bcd:Ye.bcdNumbers||[]})}),ye[Pe]={source:"realTimeRule2Analysis",analysisDate:ue,timestamp:fe.data.timestamp,hrNumber:parseInt(Pe),topicNumbers:at,overallNumbers:{abcd:je.overallAbcdNumbers||[],bcd:je.overallBcdNumbers||[]},totalTopics:je.topicResults.length,dataSource:`Real Analysis HR-${Pe}`,realData:!0},console.log(` [PlanetsAnalysis] HR ${Pe} real data:`,{topics:Object.keys(at).length,overallABCD:((qe=je.overallAbcdNumbers)==null?void 0:qe.length)||0,overallBCD:((We=je.overallBcdNumbers)==null?void 0:We.length)||0,sampleTopic:Object.keys(at)[0]?at[Object.keys(at)[0]]:null})}else console.log(` [PlanetsAnalysis] HR ${Pe} has error:`,(je==null?void 0:je.error)||"Unknown error")}),Object.keys(ye).length>0){O(ye[y]||ye[Object.keys(ye)[0]]),L(ye),x("analysis"),l(` Loaded real ABCD/BCD data for ${Object.keys(ye).length} hours with unique numbers per hour`);const Pe=Object.keys(ye).slice(0,3);console.log(" [PlanetsAnalysis] Hour-specific data verification:"),Pe.forEach(je=>{const qe=ye[je];if(qe.topicNumbers["D-1 Set-1 Matrix"]){const We=qe.topicNumbers["D-1 Set-1 Matrix"];console.log(`   HR ${je}: ABCD=[${We.abcd.join(",")}], BCD=[${We.bcd.join(",")}]`)}}),I(!1);return}}else if(console.log(" [PlanetsAnalysis] RealTime analysis failed:",fe.error),v&&!isSelectedDateAvailable){console.log(" [PlanetsAnalysis] Retrying with latest available date as fallback...");const ye=[...se].sort((Pe,je)=>new Date(Pe)-new Date(je)),Te=ye[ye.length-1];try{const Pe=await ie.performRule2Analysis(r,Te,se);if(Pe.success&&Pe.data.hrResults){console.log(" [PlanetsAnalysis] Fallback analysis successful with date:",Te);const je={},qe=Pe.data.hrResults;console.log(" [PlanetsAnalysis] Fallback processing HR results:",Object.keys(qe)),Object.entries(qe).forEach(([We,at])=>{var Ye;at.error||(je[We]={source:"realTimeRule2Analysis",date:Te,hrNumber:parseInt(We),topicNumbers:{},overallNumbers:{abcd:at.overallAbcdNumbers||[],bcd:at.overallBcdNumbers||[]},totalTopics:((Ye=at.topicResults)==null?void 0:Ye.length)||0,timestamp:Pe.data.timestamp},at.topicResults&&at.topicResults.forEach(rt=>{je[We].topicNumbers[rt.setName]={abcd:rt.abcdNumbers||[],bcd:rt.bcdNumbers||[]}}))}),setHourlyAnalysisData(je),x("realTimeRule2Analysis"),b(Te),console.log(" [PlanetsAnalysis] Fallback data preview:"),Object.keys(je).forEach(We=>{const at=je[We];if(at.topicNumbers["D-1 Set-1 Matrix"]){const Ye=at.topicNumbers["D-1 Set-1 Matrix"];console.log(`   HR ${We}: ABCD=[${Ye.abcd.join(",")}], BCD=[${Ye.bcd.join(",")}]`)}}),i(` No data available for ${new Date(v).toLocaleDateString()}. Showing data for ${new Date(Te).toLocaleDateString()} instead. Add ${v} data for direct analysis.`),I(!1);return}else i(` No analysis data available for ${new Date(v).toLocaleDateString()} or any recent dates.`)}catch(Pe){console.log(" [PlanetsAnalysis] Fallback analysis also failed:",Pe.message),i(` Analysis failed for ${new Date(v).toLocaleDateString()}. Please try a different date.`)}}else i(` Analysis failed: ${fe.error}`)}catch(ie){console.log(" [PlanetsAnalysis] RealTime analysis error:",ie.message)}}}}catch(se){console.log(" [PlanetsAnalysis] Analysis data not available:",se.message)}console.log(" [PlanetsAnalysis] Trying database as fallback...");const Z=await F3.getAllTopicNumbers();if(Z.success){q(Z.data),x("database");const se=F3.getAnalysisSummary(Z);l(` Loaded ${se.totalTopics} topics from database`),console.log(" [PlanetsAnalysis] Database data loaded:",se),I(!1);return}console.log(" [PlanetsAnalysis] Using enhanced fallback data..."),x("fallback"),l("Using comprehensive fallback ABCD/BCD numbers for all topics")}catch(Z){console.error(" [PlanetsAnalysis] Error loading data:",Z),i(`Failed to load ABCD/BCD numbers: ${Z.message}`),x("fallback")}finally{I(!1)}},_=Z=>{if(C&&C.topicNumbers&&!C.incomplete){let se=C.topicNumbers[Z];if(se&&(se.abcd.length>0||se.bcd.length>0))return se;const ie=[Z,Z.replace(" Matrix",""),Z+" Matrix",Z.replace(/\s*Matrix\s*/g,"").trim()];for(const ue of ie)if(ue!==Z&&(se=C.topicNumbers[ue],se&&(se.abcd.length>0||se.bcd.length>0)))return se}return{abcd:[],bcd:[]}},S=Z=>{if(!Z||typeof Z!="string")return Z;let se=Z.replace(/\s*\([^)]*\)\s*/g," ").trim();return se.includes("Matrix")||(se+=" Matrix"),se=se.replace(/\s+/g," ").trim(),console.log(` [TopicNormalize] "${Z}"  "${se}"`),se},T=Z=>{const se=S(Z);let ie=_(se);if(ie.abcd.length>0||ie.bcd.length>0||(ie=_(Z),ie.abcd.length>0||ie.bcd.length>0))return ie;const ue=[Z.replace(/\s*\([^)]*\)\s*/g," ").trim()+" Matrix",Z.replace(/\s*\([^)]*\)\s*/g," ").replace("Set-","Set-").trim()+" Matrix",Z.replace(/\s*\([^)]*\)\s*/g,"").trim()+" Matrix"];for(const pe of ue){const fe=pe.replace(/\s+/g," ").trim();if(fe!==Z&&fe!==se&&(ie=_(fe),ie.abcd.length>0||ie.bcd.length>0))return ie}return{abcd:[],bcd:[]}},U=Z=>{if(typeof Z!="string")return null;const se=Z.match(/^[a-z]+-(\d+)/);return se?Number(se[1]):null},A=Z=>{if(!Z||typeof Z!="string")return null;const se=Z.match(/^([a-z]+-\d+)-\/[a-z]+-\(\d+\s+([A-Za-z]+)/);if(se){const[,ue,pe]=se;return`${ue}-${pe}`}if(Z.match(/^[a-z]+-\d+-[A-Za-z]+$/))return Z;const ie=Z.match(/^([a-z]+-\d+)/);return ie?ie[1]:Z},H=Z=>{var ue;if(!((ue=c==null?void 0:c.sets)!=null&&ue[Z]))return{};const se={Su:[],Mo:[],Ma:[],Me:[],Ju:[],Ve:[],Sa:[],Ra:[],Ke:[]},ie=c.sets[Z];return Object.values(ie).forEach(pe=>{Object.entries(pe).forEach(([fe,ye])=>{if(se[fe]!==void 0){const Te=U(ye);Te!==null&&!se[fe].includes(Te)&&se[fe].push(Te)}})}),Object.keys(se).forEach(pe=>{se[pe].sort((fe,ye)=>fe-ye)}),se},z=Z=>{if(!Z)return"";const se=A(Z);if(se)return se;let ie=Z.match(/^([a-z]+-\d+)\/[a-z]+-\((\d+)\s+([A-Za-z]+)/);if(ie){const[,pe,,fe]=ie;return`${pe}-${fe}`}if(Z.match(/^[a-z]+-\d+-[A-Za-z]+$/))return Z;const ue=Z.match(/^([a-z]+-\d+)/);return ue?ue[1]:Z},K=(Z,se)=>{const ie=U(Z);if(!ie&&ie!==0)return null;const{abcd:ue,bcd:pe}=T(se);return ue.includes(ie)?X.jsx("span",{className:"bg-green-200 text-green-800 px-1 py-0.5 rounded text-xs font-medium",children:"A"}):pe.includes(ie)?X.jsx("span",{className:"bg-blue-200 text-blue-800 px-1 py-0.5 rounded text-xs font-medium",children:"B"}):null},j=Z=>{const se={sets:{}},ie={1:"Su",2:"Mo",3:"Ma",4:"Me",5:"Ju",6:"Ve",7:"Sa",8:"Ra",9:"Ke"},ue={as:"Lagna",mo:"Moon",hl:"Hora Lagna",gl:"Ghati Lagna",vig:"Vighati Lagna",var:"Varnada Lagna",sl:"Sree Lagna",pp:"Pranapada Lagna",in:"Indu Lagna"};let pe=null,fe={};for(let ye=0;ye<Z.length;ye++){const Te=Z[ye];if(!Array.isArray(Te)||Te.length===0)continue;const Pe=String(Te[0]||"").trim();if(Pe.includes("Matrix")&&(Pe.includes("D-")||Pe.includes("Set-"))){pe&&Object.keys(fe).length>0&&(se.sets[pe]={...fe}),pe=Pe,fe={};continue}if(pe&&Pe&&Pe.length<=3){const je=Pe.toLowerCase();if(ue[je]){const qe={};for(let We=1;We<=9;We++){const at=ie[We],Ye=Te[We];Ye&&Ye.toString().trim()&&(qe[at]=Ye.toString().trim())}Object.keys(qe).length>0&&(fe[ue[je]]=qe)}}}return pe&&Object.keys(fe).length>0&&(se.sets[pe]={...fe}),se},J=async Z=>{const se=Z.target.files[0];if(se){s(!0),i(""),l("");try{const ie=new FileReader;ie.onload=async ue=>{try{const pe=new Uint8Array(ue.target.result),fe=Hh(pe,{type:"array"}),ye=fe.SheetNames[0],Te=fe.Sheets[ye],Pe=Go.sheet_to_json(Te,{header:1}),je=j(Pe);if(Object.keys(je.sets).length===0)throw new Error("No valid data found in Excel file");u(je),h(new Set),l(` Excel uploaded successfully! Found ${Object.keys(je.sets).length} topics.`)}catch(pe){console.error("Excel processing error:",pe),i(`Failed to process Excel file: ${pe.message}`)}},ie.readAsArrayBuffer(se),Z.target.value=null}catch(ie){i(`Failed to upload file: ${ie.message}`)}finally{s(!1)}}},P=Z=>Z.sort((se,ie)=>{const ue=je=>{const qe=je.match(/D-(\d+)(?:\s*\([^)]*\))?/);return qe?parseInt(qe[1],10):0},pe=je=>{const qe=je.match(/Set-(\d+)/);return qe?parseInt(qe[1],10):0},fe=ue(se),ye=ue(ie);if(fe!==ye)return fe-ye;const Te=pe(se),Pe=pe(ie);return Te!==Pe?Te-Pe:se.localeCompare(ie)}),D=c?P(Object.keys(c.sets)):[],G=()=>d.size===0?D:P(Array.from(d)),re=Z=>Z.replace(/\s+Matrix$/i,""),te=Z=>{const se=new Set(d);d.has(Z)?se.delete(Z):se.add(Z),h(se)},ne=()=>{h(new Set(D))},le=()=>{h(new Set)},oe=async Z=>{if(console.log(` [PlanetsAnalysis] Switching to Hour ${Z}...`),R(!0),await new Promise(se=>setTimeout(se,300)),k(Z),N[Z]){if(O(N[Z]),console.log(` [PlanetsAnalysis] Hour ${Z} data loaded:`,N[Z]),N[Z].topicNumbers&&N[Z].topicNumbers["D-1 Set-1 Matrix"]){const se=N[Z].topicNumbers["D-1 Set-1 Matrix"];console.log(` [PlanetsAnalysis] D-1 Set-1 Matrix for HR ${Z}:`,se),console.log(` [PlanetsAnalysis] ABCD: [${se.abcd.join(",")}], BCD: [${se.bcd.join(",")}]`)}if(l(` Now viewing Hour ${Z} - ABCD/BCD data updated`),N[Z].topicNumbers){const se=Object.keys(N[Z].topicNumbers).length;console.log(` [PlanetsAnalysis] Hour ${Z} has ${se} topics with ABCD/BCD data`);const ie=Object.keys(N[Z].topicNumbers)[0];if(ie){const ue=N[Z].topicNumbers[ie];console.log(` [Sample] ${ie} (HR ${Z}):`,ue)}}}else console.warn(` [PlanetsAnalysis] No pre-loaded analysis data for Hour ${Z}`),O({incomplete:!0,source:`No specific data for HR ${Z}`,topicNumbers:{},note:"Fallback mode - will use database or hardcoded TOPIC_NUMBERS data"}),l(` Hour ${Z} selected - Using fallback ABCD/BCD data sources`),console.log(" [Debug] Available hours in hourTabsData:",Object.keys(N)),console.log(" [Debug] User info HR count:",m==null?void 0:m.hr),console.log(" [Debug] Requested hour:",Z),m&&m.id&&m.hr>=Z?(console.log(` [PlanetsAnalysis] Attempting to reload data for HR ${Z}...`),w().catch(se=>{console.error(` [PlanetsAnalysis] Failed to reload data for HR ${Z}:`,se)})):console.log(` [PlanetsAnalysis] HR ${Z} is beyond user's configured range (${m==null?void 0:m.hr}) or user info unavailable`);setTimeout(()=>{R(!1)},500)},ee=["Su","Mo","Ma","Me","Ju","Ve","Sa","Ra","Ke"];return X.jsx("div",{className:"min-h-screen bg-gray-50",children:X.jsxs("div",{className:"max-w-full px-2 py-4",children:[X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border-t-4 border-teal-600",children:[X.jsxs("div",{className:"flex justify-between items-center",children:[X.jsx("div",{children:X.jsx("h1",{className:"text-xl font-bold text-gray-800",children:" Planets Analysis"})}),X.jsx("div",{children:X.jsx("button",{onClick:()=>t(-1),className:"px-3 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors flex items-center gap-2 text-sm font-medium",children:" Back"})})]}),X.jsx("div",{className:"mt-2",children:m?X.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[X.jsx("div",{className:"bg-blue-50 px-3 py-1 rounded-lg border border-blue-200",children:X.jsxs("span",{className:"text-sm",children:[" User: ",X.jsx("span",{className:"font-semibold text-blue-700",children:m.username})]})}),X.jsxs("div",{className:`px-3 py-1 rounded-lg border ${m.hr>1?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"}`,children:[X.jsxs("span",{className:"text-sm",children:[" Hours: ",X.jsx("span",{className:`font-semibold ${m.hr>1?"text-green-700":"text-yellow-700"}`,children:m.hr})]}),m.hr>1&&X.jsx("span",{className:"ml-1 text-xs text-green-600",children:"(Hour tabs available)"}),m.hr===1&&X.jsx("span",{className:"ml-1 text-xs text-yellow-600",children:"(Single hour only)"})]}),v&&X.jsxs("div",{className:"bg-purple-50 px-3 py-1 rounded-lg border border-purple-200",children:[X.jsxs("span",{className:"text-sm",children:[" Clicked: ",X.jsx("span",{className:"font-semibold text-purple-700",children:new Date(v).toLocaleDateString()})]}),C&&C.analysisDate&&C.analysisDate!==v&&X.jsxs("span",{className:"text-sm ml-2",children:[" Analysis: ",X.jsx("span",{className:"font-semibold text-green-700",children:new Date(C.analysisDate).toLocaleDateString()})]})]})]}):X.jsx("div",{className:"bg-gray-50 px-3 py-2 rounded-lg border border-gray-200",children:X.jsx("span",{className:"text-sm text-gray-600",children:"Upload Excel file to see planets data with ABCD/BCD analysis"})})})]}),m&&m.hr&&m.hr>1&&X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-2 mb-4",children:[X.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[X.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Hour:"}),X.jsxs("div",{className:"flex items-center mr-2",children:[X.jsxs("div",{className:`relative w-6 h-6 rounded-full border-2 transition-all duration-300 ${F?"border-orange-400 bg-orange-100 animate-pulse":C?"border-green-400 bg-green-100":"border-gray-300 bg-gray-100"}`,children:[X.jsx("div",{className:`absolute top-1/2 left-1/2 w-1 h-2 bg-current transform -translate-x-1/2 -translate-y-full origin-bottom transition-all duration-300 ${F?"text-orange-600 animate-spin":C?"text-green-600":"text-gray-400"}`,style:{transform:`translate(-50%, -100%) rotate(${y*30-90}deg)`}}),X.jsx("div",{className:`absolute top-1/2 left-1/2 w-0.5 h-1.5 bg-current transform -translate-x-1/2 -translate-y-full origin-bottom transition-all duration-300 ${F?"text-orange-500 animate-spin":C?"text-green-500":"text-gray-300"}`,style:{transform:`translate(-50%, -100%) rotate(${y*6-90}deg)`}}),X.jsx("div",{className:`absolute top-1/2 left-1/2 w-1 h-1 rounded-full transform -translate-x-1/2 -translate-y-1/2 transition-all duration-300 ${F?"bg-orange-500":C?"bg-green-500":"bg-gray-400"}`}),F&&X.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-transparent border-t-orange-500 animate-spin"})]}),X.jsx("span",{className:`ml-1 text-xs font-medium transition-all duration-300 ${F?"text-orange-600":C?"text-green-600":"text-gray-500"}`,children:F?"Updating...":C?`HR ${y}`:"No Data"})]}),Array.from({length:m.hr},(Z,se)=>se+1).map(Z=>X.jsxs("button",{onClick:()=>oe(Z),disabled:F,className:`px-2 py-1 rounded text-xs font-medium transition-all ${y===Z?"bg-teal-500 text-white shadow-md":F?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-teal-100"}`,children:["HR ",Z,N[Z]&&X.jsx("span",{className:"ml-1 text-xs",children:N[Z].topicNumbers?X.jsx("span",{className:"text-green-400",children:""}):X.jsx("span",{className:"text-gray-400",children:""})})]},Z)),Object.keys(N).length>0&&X.jsxs("span",{className:"ml-2 text-xs text-green-600",children:[" ",Object.keys(N).length,"/",m.hr," hours loaded"]}),C&&C.timestamp&&!F&&X.jsxs("span",{className:"ml-2 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:[" Updated: ",new Date(C.timestamp).toLocaleTimeString()]})]}),X.jsx("div",{className:"mt-2 h-1 bg-gray-200 rounded-full overflow-hidden",children:X.jsx("div",{className:`h-full transition-all duration-500 ${F?"bg-orange-400 animate-pulse":C?"bg-green-400":"bg-gray-300"}`,style:{width:F?"100%":C?`${Object.keys(N).length/m.hr*100}%`:"0%"}})})]}),X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-3 mb-4",children:[X.jsxs("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[X.jsxs("div",{className:"flex-1 min-w-0",children:[X.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Upload Excel File:"}),X.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:J,disabled:n,className:"block w-full text-xs text-gray-500 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:font-medium file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100"})]}),X.jsx("div",{className:"text-xs text-gray-600 italic",children:"ABCD/BCD data loads automatically for all hours when user information is available"})]}),C?X.jsxs("div",{className:`border-l-4 p-2 rounded text-xs mb-3 transition-all duration-300 ${F?"bg-orange-50 border-orange-400":"bg-green-50 border-green-400"}`,children:[X.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[X.jsx("span",{className:`text-white px-1 py-0.5 rounded text-xs font-medium transition-all duration-300 ${F?"bg-orange-600":"bg-green-600"}`,children:F?" UPDATING":" REAL ANALYSIS"}),X.jsx("span",{className:`font-medium text-xs transition-all duration-300 ${F?"text-orange-700":"text-green-700"}`,children:F?"Switching to HR data...":"Using actual Rule2 ABCD/BCD numbers"}),X.jsxs("span",{className:`text-white px-1 py-0.5 rounded text-xs font-medium ml-1 transition-all duration-300 ${F?"bg-orange-500 animate-pulse":"bg-teal-500"}`,children:["HR ",y]}),m&&m.hr>1&&X.jsx("span",{className:`text-white px-1 py-0.5 rounded text-xs font-medium ml-1 transition-all duration-300 ${F?"bg-orange-500":"bg-blue-500"}`,children:F?" Loading":" Hour-Specific Data"})]}),X.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[X.jsxs("div",{children:[X.jsxs("div",{children:[X.jsx("strong",{children:"Source:"})," ",C.source]}),X.jsxs("div",{children:[X.jsx("strong",{children:"Date:"})," ",C.analysisDate]}),X.jsxs("div",{children:[X.jsx("strong",{children:"Current Hour:"})," HR ",y]})]}),X.jsxs("div",{children:[X.jsxs("div",{children:[X.jsx("strong",{children:"Topics:"})," ",C.totalTopics]}),X.jsxs("div",{children:[X.jsx("strong",{children:"ABCD:"})," ",Object.values(C.topicNumbers||{}).reduce((Z,se)=>Z+se.abcd.length,0)]}),X.jsxs("div",{children:[X.jsx("strong",{children:"BCD:"})," ",Object.values(C.topicNumbers||{}).reduce((Z,se)=>Z+se.bcd.length,0)]})]})]}),C.topicNumbers&&C.topicNumbers["D-1 Set-1 Matrix"]&&X.jsxs("div",{className:"mt-1 p-1 bg-white rounded border text-xs",children:[X.jsxs("div",{className:"font-medium text-green-800",children:[" D-1 Set-1 Verification (HR ",y,"):"]}),X.jsxs("div",{className:"text-green-700",children:[X.jsx("strong",{children:"ABCD:"})," [",C.topicNumbers["D-1 Set-1 Matrix"].abcd.join(", "),"] |",X.jsx("strong",{children:" BCD:"})," [",C.topicNumbers["D-1 Set-1 Matrix"].bcd.join(", "),"]"]}),X.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Analysis Date: ",new Date(C.analysisDate).toLocaleDateString()]})]}),m&&m.hr>1&&X.jsxs("div",{className:"mt-1 p-1 bg-blue-50 rounded border text-xs",children:[X.jsx("div",{className:"font-medium text-blue-800",children:" Tip:"}),X.jsx("div",{className:"text-blue-700",children:"Click different HR tabs above to see ABCD/BCD numbers change for each hour!"})]})]}):null,B&&!C?X.jsx("div",{className:"bg-green-50 border-l-4 border-green-400 p-2 rounded text-xs",children:X.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[X.jsx("span",{className:"bg-green-500 text-white px-1 py-0.5 rounded text-xs font-medium",children:" DATABASE"}),X.jsx("span",{className:"text-green-700 font-medium text-xs",children:"Using Supabase ABCD/BCD numbers"})]})}):C?null:X.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-2 rounded text-xs",children:[X.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[X.jsx("span",{className:"bg-yellow-500 text-white px-1 py-0.5 rounded text-xs font-medium",children:" FALLBACK"}),X.jsx("span",{className:"text-yellow-700 font-medium text-xs",children:"Using hardcoded ABCD/BCD numbers"})]}),X.jsxs("div",{className:"text-yellow-700 text-xs",children:[X.jsxs("div",{children:[X.jsx("strong",{children:"Status:"})," Real analysis data not available for HR ",y]}),X.jsxs("div",{children:[X.jsx("strong",{children:"Action:"}),' Click " All Hours" to load calculated data from Rule2CompactPage']})]})]})]}),c&&D.length>0&&X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-3 mb-4",children:[X.jsxs("div",{className:"flex items-center justify-between mb-3",children:[X.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Filter Topics:"}),X.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[X.jsxs("span",{className:"text-gray-600",children:[d.size,"/",D.length]}),X.jsx("button",{onClick:ne,className:"text-blue-600 hover:text-blue-800",children:"All"}),X.jsx("button",{onClick:le,className:"text-red-600 hover:text-red-800",children:"Clear"}),X.jsx("button",{onClick:()=>g(!f),className:"text-gray-600 hover:text-gray-800",children:f?"":""})]})]}),C&&X.jsxs("div",{className:"mb-3 p-2 bg-green-50 rounded text-xs",children:[X.jsxs("div",{className:"font-medium text-green-800 mb-1",children:[" HR ",y," ABCD/BCD Status:"]}),X.jsx("div",{className:"grid grid-cols-4 gap-1 text-xs",children:D.slice(0,8).map(Z=>{const{abcd:se,bcd:ie}=T(Z),ue=se.length>0||ie.length>0;return X.jsxs("div",{className:`p-1 rounded ${ue?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[X.jsx("div",{className:"font-medium",children:re(Z)}),X.jsx("div",{children:ue?`A:${se.length} B:${ie.length}`:"No data"})]},Z)})}),D.length>8&&X.jsxs("div",{className:"mt-1 text-green-700",children:["...and ",D.length-8," more topics"]})]}),f&&X.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-6 gap-1",children:D.map(Z=>{const{abcd:se,bcd:ie}=T(Z),ue=se.length>0||ie.length>0;return X.jsx("button",{onClick:()=>te(Z),className:`w-full px-1 py-1 rounded text-xs font-medium transition-all text-left relative ${d.has(Z)?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-green-100"}`,children:X.jsxs("div",{className:"flex items-center justify-between",children:[X.jsx("span",{className:"truncate text-xs",children:re(Z)}),X.jsxs("div",{className:"flex items-center gap-0.5",children:[ue?X.jsx("span",{className:"text-green-600 text-xs",children:""}):X.jsx("span",{className:"text-red-500 text-xs",children:""}),d.has(Z)&&X.jsx("span",{className:"text-white text-xs",children:""})]})]})},Z)})})]}),a&&X.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 text-red-700 px-2 py-1 rounded mb-3 text-xs",children:a}),o&&X.jsx("div",{className:"bg-green-50 border-l-4 border-green-400 text-green-700 px-2 py-1 rounded mb-3 text-xs",children:o}),X.jsxs("div",{className:"bg-white rounded-lg shadow-md p-3",children:[X.jsx("div",{className:"flex items-center justify-between mb-3",children:X.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Planets Analysis Results"})}),n?X.jsxs("div",{className:"text-center py-8",children:[X.jsx("div",{className:"animate-spin h-6 w-6 border-4 border-teal-500 border-t-transparent rounded-full mx-auto mb-2"}),X.jsx("p",{className:"text-sm text-gray-600",children:"Processing Excel file..."})]}):c&&c.sets&&Object.keys(c.sets).length>0?X.jsx("div",{className:"space-y-4",children:G().map(Z=>X.jsxs("div",{className:"border rounded p-2",children:[X.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2 bg-gray-50 p-1 rounded flex items-center justify-between",children:[X.jsxs("span",{className:"flex items-center gap-2",children:[re(Z),F&&X.jsxs("div",{className:"flex items-center gap-1",children:[X.jsx("div",{className:"w-3 h-3 border-2 border-orange-400 border-t-transparent rounded-full animate-spin"}),X.jsx("span",{className:"text-xs text-orange-600",children:"Updating..."})]})]}),m&&m.hr>1&&C&&X.jsx("span",{className:`text-xs px-2 py-0.5 rounded transition-all duration-300 ${F?"bg-orange-100 text-orange-700":"bg-teal-100 text-teal-700"}`,children:F?" HR Data":`HR ${y} Data`})]}),(()=>{const{abcd:se,bcd:ie}=T(Z);return((se==null?void 0:se.length)||0)+((ie==null?void 0:ie.length)||0)===0?null:X.jsxs("div",{className:"mb-2 flex flex-wrap gap-4 items-center bg-blue-50 p-2 rounded",children:[X.jsxs("div",{className:"flex items-center gap-2",children:[X.jsx("span",{className:"text-xs font-semibold text-green-700 mr-1",children:"ABCD:"}),se&&se.length>0?se.sort((ue,pe)=>ue-pe).map(ue=>X.jsx("span",{className:"px-2 py-0.5 bg-green-200 text-green-900 rounded text-xs font-mono font-bold",children:ue},ue)):X.jsx("span",{className:"text-xs text-gray-400",children:"None"})]}),X.jsxs("div",{className:"flex items-center gap-2",children:[X.jsx("span",{className:"text-xs font-semibold text-blue-700 mr-1",children:"BCD:"}),ie&&ie.length>0?ie.sort((ue,pe)=>ue-pe).map(ue=>X.jsx("span",{className:"px-2 py-0.5 bg-blue-200 text-blue-900 rounded text-xs font-mono font-bold",children:ue},ue)):X.jsx("span",{className:"text-xs text-gray-400",children:"None"})]})]})})(),X.jsx("div",{className:"mb-2 grid grid-cols-9 gap-1",children:ee.map(se=>{const{abcd:ie,bcd:ue}=T(Z),pe=H(Z)[se]||[],fe=pe.filter(Te=>ie.includes(Te)),ye=pe.filter(Te=>ue.includes(Te));return X.jsxs("div",{className:"text-center bg-purple-100 p-1 rounded",children:[X.jsx("div",{className:"text-xs font-semibold",children:se}),X.jsxs("div",{className:"text-xs mt-0.5",children:[fe.length>0&&X.jsxs("div",{className:"bg-green-200 text-green-800 px-0.5 py-0.5 rounded mb-0.5 text-xs",children:["A: ",fe.join(",")]}),ye.length>0&&X.jsxs("div",{className:"bg-blue-200 text-blue-800 px-0.5 py-0.5 rounded text-xs",children:["B: ",ye.join(",")]}),fe.length===0&&ye.length===0&&X.jsx("div",{className:"text-gray-400 text-xs",children:""})]})]},`${se}-${y}`)})},`planet-headers-${y}-${(C==null?void 0:C.timestamp)||"fallback"}`),X.jsx("div",{className:"w-full overflow-x-auto",children:X.jsxs("table",{className:"w-full table-auto border-collapse text-xs",children:[X.jsx("thead",{children:X.jsxs("tr",{children:[X.jsx("th",{className:"border border-gray-300 px-1 py-1 font-semibold bg-gray-100 text-left w-16",children:"Element"}),ee.map(se=>X.jsx("th",{className:"border border-gray-300 px-1 py-1 font-semibold text-center bg-purple-100 w-16",children:se},se))]})}),X.jsx("tbody",{children:(()=>{const se=["Lagna","Moon","Hora Lagna","Ghati Lagna","Vighati Lagna","Varnada Lagna","Sree Lagna","Pranapada Lagna","Indu Lagna"],ie=c.sets[Z]||{};return se.filter(ue=>ie[ue]).map(ue=>{const pe=ie[ue];return X.jsxs("tr",{className:"hover:bg-gray-50",children:[X.jsx("td",{className:"border border-gray-300 px-1 py-1 font-medium bg-gray-50 text-xs",children:ue}),ee.map(fe=>{const ye=pe[fe],Te=z(ye);return X.jsx("td",{className:"border border-gray-300 px-1 py-1 text-center",children:ye?X.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[X.jsx("span",{className:"font-mono text-gray-700 text-xs",children:Te}),K(ye,Z)]}):X.jsx("span",{className:"text-gray-400 text-xs",children:""})},fe)})]},ue)})})()})]})})]},Z))}):X.jsx("div",{className:"text-center py-8",children:X.jsx("p",{className:"text-sm text-gray-600",children:"No analysis results available. Please upload an Excel file."})})]})]})})}class jV{constructor(){this.currentUser=null,this.authListeners=[],Lt.auth.onAuthStateChange((r,e)=>{console.log(" Supabase auth state change:",r),this.currentUser=(e==null?void 0:e.user)||null,this.authListeners.forEach(n=>n(this.currentUser))}),console.log(" SupabaseAuthService initialized")}async signIn(r,e){var n;try{const{data:s,error:a}=await Lt.auth.signInWithPassword({email:r,password:e});if(a)throw a;const i=s.user;return console.log(" User signed in with Supabase:",i.email),{user:{uid:i.id,email:i.email,displayName:((n=i.user_metadata)==null?void 0:n.display_name)||i.email.split("@")[0],authenticated:!0,loginTime:new Date().toISOString()}}}catch(s){throw console.error(" Supabase sign in error:",s),new Error(this.getAuthErrorMessage(s.message))}}async signUp(r,e,n=null){var s;try{const{data:a,error:i}=await Lt.auth.signUp({email:r,password:e,options:{data:{display_name:n||r.split("@")[0]}}});if(i)throw i;const o=a.user;return console.log(" User account created with Supabase:",o.email),{user:{uid:o.id,email:o.email,displayName:n||((s=o.user_metadata)==null?void 0:s.display_name),authenticated:!0,loginTime:new Date().toISOString()}}}catch(a){throw console.error(" Supabase sign up error:",a),new Error(this.getAuthErrorMessage(a.message))}}async signOut(){try{const{error:r}=await Lt.auth.signOut();if(r)throw r;return this.currentUser=null,console.log(" User signed out from Supabase"),!0}catch(r){throw console.error(" Supabase sign out error:",r),r}}getCurrentUser(){var r,e,n;if(!this.currentUser){const s=Lt.auth.getSession();(e=(r=s==null?void 0:s.data)==null?void 0:r.session)!=null&&e.user&&(this.currentUser=s.data.session.user)}return this.currentUser?{user:{uid:this.currentUser.id,email:this.currentUser.email,displayName:((n=this.currentUser.user_metadata)==null?void 0:n.display_name)||this.currentUser.email.split("@")[0],authenticated:!0}}:null}isAuthenticated(){return this.currentUser!==null}onAuthStateChange(r){return this.authListeners.push(r),()=>{this.authListeners=this.authListeners.filter(e=>e!==r)}}async getUserData(r){try{const{data:e,error:n}=await Lt.from("users").select("*").eq("id",r).single();if(n&&n.code!=="PGRST116")throw n;return e||null}catch(e){throw console.error(" Error getting user data from Supabase:",e),e}}getAuthErrorMessage(r){return r.includes("Invalid login credentials")?"Invalid email or password. Please check your credentials.":r.includes("User already registered")?"An account with this email already exists.":r.includes("Password should be at least")?"Password should be at least 6 characters.":r.includes("Unable to validate email address")?"Invalid email address format.":r.includes("Email rate limit exceeded")?"Too many attempts. Please try again later.":r.includes("Network request failed")?"Network error. Please check your connection.":r||"Authentication failed. Please try again."}async authenticateUser(r,e){const n=r.includes("@")?r:`${r}@viboothi.in`;try{return await this.signIn(n,e)}catch(s){if(r==="gurukrpasharma"&&e==="Srimatha1@")try{return await this.signUp("admin@viboothi.in",e,"Admin User")}catch{return await this.signIn("admin@viboothi.in",e)}throw s}}async resetPassword(r){try{const{error:e}=await Lt.auth.resetPasswordForEmail(r,{redirectTo:`${window.location.origin}/reset-password`});if(e)throw e;return console.log(" Password reset email sent"),!0}catch(e){throw console.error(" Password reset error:",e),new Error(this.getAuthErrorMessage(e.message))}}async updatePassword(r){try{const{error:e}=await Lt.auth.updateUser({password:r});if(e)throw e;return console.log(" Password updated successfully"),!0}catch(e){throw console.error(" Password update error:",e),new Error(this.getAuthErrorMessage(e.message))}}async updateProfile(r){try{const{error:e}=await Lt.auth.updateUser({data:r});if(e)throw e;return console.log(" Profile updated successfully"),!0}catch(e){throw console.error(" Profile update error:",e),new Error(this.getAuthErrorMessage(e.message))}}}const LV=new jV,Cg={ACTIVE_SERVICE:IV(),DUAL_SERVICE_MODE:BV(),SERVICES:{firebase:{enabled:$V(),name:"Firebase",description:"Google Firebase Firestore & Authentication",role:"backup"},supabase:{enabled:!0,name:"Supabase",description:"Supabase PostgreSQL & Authentication",role:"primary"}}};function IV(){return"supabase"}function BV(){return!1}function $V(){return!1}const UV={signIn:()=>Promise.reject(new Error("Firebase disabled in development")),signUp:()=>Promise.reject(new Error("Firebase disabled in development")),signOut:()=>Promise.resolve(!0),getCurrentUser:()=>null,isAuthenticated:()=>!1,onAuthStateChange:()=>()=>{},authenticateUser:()=>Promise.reject(new Error("Firebase disabled in development")),getAuthErrorMessage:t=>t||"Firebase error"};class HV{constructor(){this.activeService=Cg.ACTIVE_SERVICE,this.services=Cg.SERVICES,console.log(" Database Service Switcher initialized"),console.log(` Active Service: ${this.services[this.activeService].name}`),console.log(` Firebase Status: ${this.services.firebase.enabled?"Active":"Paused"}`),console.log(` Supabase Status: ${this.services.supabase.enabled?"Active":"Paused"}`)}getActiveService(){return this.activeService}getServiceStatus(){return{active:this.activeService,firebase:this.services.firebase,supabase:this.services.supabase}}switchToFirebase(){return this.activeService="firebase",this.services.firebase.enabled=!0,this.services.supabase.enabled=!1,console.log(" Switched to Firebase"),this.getServiceStatus()}switchToSupabase(){return this.activeService="supabase",this.services.supabase.enabled=!0,this.services.firebase.enabled=!1,console.log(" Switched to Supabase"),this.getServiceStatus()}pauseFirebase(){return this.services.firebase.enabled=!1,this.activeService==="firebase"&&this.switchToSupabase(),console.log(" Firebase paused"),this.getServiceStatus()}resumeFirebase(){return this.services.firebase.enabled=!0,console.log(" Firebase resumed"),this.getServiceStatus()}async createUser(r){return this.activeService==="firebase"?await lr.createUser(r):await lr.createUser(r)}async getUser(r){return this.activeService==="firebase"?await lr.getUser(r):await lr.getUser(r)}async getAllUsers(){return this.activeService==="firebase"?await lr.getAllUsers():await lr.getAllUsers()}async saveExcelData(r,e,n){return this.activeService==="firebase"?await lr.saveExcelData(r,e,n):await lr.saveExcelData(r,e,n)}async getExcelData(r,e){return this.activeService==="firebase"?await lr.getExcelData(r,e):await lr.getExcelData(r,e)}async hasExcelData(r,e){return this.activeService==="firebase"?await lr.hasExcelData(r,e):await lr.hasExcelData(r,e)}async deleteExcelData(r,e){return this.activeService==="firebase"?await lr.deleteExcelData(r,e):await lr.deleteExcelData(r,e)}async saveHourEntry(r,e,n){return this.activeService==="firebase"?await lr.saveHourEntry(r,e,n):await lr.saveHourEntry(r,e,n)}async getHourEntry(r,e){return this.activeService==="firebase"?await lr.getHourEntry(r,e):await lr.getHourEntry(r,e)}async hasHourEntry(r,e){return this.activeService==="firebase"?await lr.hasHourEntry(r,e):await lr.hasHourEntry(r,e)}async deleteHourEntry(r,e){return this.activeService==="firebase"?await lr.deleteHourEntry(r,e):await lr.deleteHourEntry(r,e)}async getUserDates(r){return this.activeService==="firebase"?await lr.getUserDates(r):await lr.getUserDates(r)}async saveUserDates(r,e){return this.activeService==="firebase"?await lr.saveUserDates(r,e):await lr.saveUserDates(r,e)}async addUserDate(r,e){return this.activeService==="firebase"?await lr.addUserDate(r,e):await lr.addUserDate(r,e)}async checkConnection(){return this.activeService==="firebase"?await lr.checkConnection():await lr.checkConnection()}getAuthService(){return this.activeService==="firebase"?UV:LV}enableDualService(){return this.services.firebase.enabled=!0,this.services.supabase.enabled=!0,console.log(" Dual-service mode enabled: Both Firebase and Supabase active"),this.getServiceStatus()}isDualServiceMode(){return Cg.DUAL_SERVICE_MODE&&this.services.firebase.enabled&&this.services.supabase.enabled}async saveDataToBothServices(r,...e){if(!this.isDualServiceMode())return await this[r](...e);const n={primary:null,backup:null,errors:[]};try{this.services.supabase.enabled&&(n.primary=await lr[r](...e),console.log(" Data saved to Supabase (primary)"))}catch(s){n.errors.push({service:"supabase",error:s.message}),console.error(" Supabase save failed:",s.message)}try{this.services.firebase.enabled&&(console.log(" Firebase backup save would happen here"),n.backup={success:!0,note:"Firebase implementation needed"})}catch(s){n.errors.push({service:"firebase",error:s.message}),console.error(" Firebase backup failed:",s.message)}return n}async syncBetweenServices(r){if(!this.isDualServiceMode())return console.log(" Dual-service mode not active - skipping sync"),{success:!1,reason:"Dual-service mode disabled"};console.log(" Starting data sync between Firebase and Supabase...");try{const e=await lr.getDataSummary(r);return console.log(" Syncing to Firebase...",e),{success:!0,synced:{excelData:e.excelDataCount,hourEntries:e.hourEntryCount,userDates:e.userDatesCount}}}catch(e){return console.error(" Sync failed:",e),{success:!1,error:e.message}}}async getServicesHealth(){const r={supabase:{status:"unknown",latency:null},firebase:{status:"unknown",latency:null}};if(this.services.supabase.enabled)try{const e=Date.now();await lr.checkConnection(),r.supabase={status:"healthy",latency:Date.now()-e}}catch(e){r.supabase={status:"error",error:e.message}}return this.services.firebase.enabled&&(r.firebase={status:"implementation_needed",note:"Firebase health check needs implementation"}),r}}const zV=new HV;class VV{constructor(){this.primary=lr,this.backup={saveExcelData:()=>Promise.resolve({success:!0,note:"Firebase disabled"}),getExcelData:()=>Promise.resolve(null),saveHourEntry:()=>Promise.resolve({success:!0,note:"Firebase disabled"}),getHourEntry:()=>Promise.resolve(null),getUserDates:()=>Promise.resolve([]),saveUserDates:()=>Promise.resolve({success:!0,note:"Firebase disabled"}),checkConnection:()=>Promise.resolve(!1)},this.isEnabled=!1,console.log(" Dual-Service Manager initialized (Firebase disabled for development)")}enable(){return this.isEnabled=!0,zV.enableDualService(),console.log(" Dual-service mode ENABLED"),this.getStatus()}disable(){return this.isEnabled=!1,console.log(" Dual-service mode DISABLED"),this.getStatus()}getStatus(){return{enabled:this.isEnabled,primary:"Supabase",backup:"Firebase",health:null}}async dualSave(r,...e){if(!this.isEnabled)return await this.primary[r](...e);const n={primary:{success:!1,data:null,error:null},backup:{success:!1,data:null,error:null},overall:{success:!1,savedCount:0}};try{n.primary.data=await this.primary[r](...e),n.primary.success=!0,n.overall.savedCount++,console.log(" Primary save successful (Supabase)")}catch(s){n.primary.error=s.message,console.error(" Primary save failed (Supabase):",s.message)}try{n.backup.data=await this.backup[r](...e),n.backup.success=!0,n.overall.savedCount++,console.log(" Backup save successful (Firebase)")}catch(s){n.backup.error=s.message,console.error(" Backup save failed (Firebase):",s.message)}if(n.overall.success=n.overall.savedCount>0,n.overall.savedCount===0)throw new Error("Both primary and backup saves failed");return n.overall.savedCount===1?console.log(" Partial save success (only one service succeeded)"):console.log(" Full dual-save success (both services succeeded)"),n}async dualFetch(r,...e){if(!this.isEnabled)return await this.primary[r](...e);let n=null,s=null,a=null,i=null;try{return n=await this.primary[r](...e),console.log(" Primary fetch successful (Supabase)"),{data:n,source:"primary",service:"Supabase",backupAvailable:!1}}catch(o){a=o.message,console.warn(" Primary fetch failed (Supabase), trying backup...")}try{return s=await this.backup[r](...e),console.log(" Backup fetch successful (Firebase)"),{data:s,source:"backup",service:"Firebase",primaryError:a}}catch(o){i=o.message,console.error(" Backup fetch failed (Firebase)")}throw new Error(`Both services failed - Primary: ${a}, Backup: ${i}`)}async syncPrimaryToBackup(r){if(!this.isEnabled)return{success:!1,reason:"Dual-service mode disabled"};console.log(" Starting primary-to-backup sync...");try{const e=await this.primary.getDataSummary(r),n=await this.primary.getUserDates(r);let s=0;n.length>0&&(await this.backup.saveUserDates(r,n),s++);for(const a of n)try{const i=await this.primary.getExcelData(r,a);i&&(await this.backup.saveExcelData(r,a,i),s++);const o=await this.primary.getHourEntry(r,a);o&&(await this.backup.saveHourEntry(r,a,o.planetSelections),s++)}catch(i){console.warn(` Failed to sync data for date ${a}:`,i.message)}return console.log(` Sync completed: ${s} items synced`),{success:!0,syncedItems:s,dates:n.length,summary:e}}catch(e){return console.error(" Sync failed:",e),{success:!1,error:e.message}}}async verifyDataConsistency(r){if(!this.isEnabled)return{success:!1,reason:"Dual-service mode disabled"};console.log(" Verifying data consistency...");try{const e=await this.primary.getDataSummary(r),n={userDatesMatch:!0,excelDataMatch:!0,hourEntriesMatch:!0,issues:[]};return console.log(" Consistency check completed"),{success:!0,primary:e,backup:{note:"Firebase summary implementation needed"},consistency:n}}catch(e){return console.error(" Consistency check failed:",e),{success:!1,error:e.message}}}async getHealthStatus(){const r={timestamp:new Date().toISOString(),services:{primary:{name:"Supabase",status:"unknown",latency:null},backup:{name:"Firebase",status:"unknown",latency:null}},overall:{status:"unknown",message:""}};try{const s=Date.now();await this.primary.checkConnection(),r.services.primary.status="healthy",r.services.primary.latency=Date.now()-s}catch(s){r.services.primary.status="error",r.services.primary.error=s.message}try{const s=Date.now();await this.backup.checkConnection(),r.services.backup.status="healthy",r.services.backup.latency=Date.now()-s}catch(s){r.services.backup.status="error",r.services.backup.error=s.message}const e=r.services.primary.status==="healthy",n=r.services.backup.status==="healthy";return e&&n?(r.overall.status="excellent",r.overall.message="Both services are healthy"):e?(r.overall.status="good",r.overall.message="Primary service healthy, backup needs attention"):n?(r.overall.status="degraded",r.overall.message="Primary service down, backup available"):(r.overall.status="critical",r.overall.message="Both services are down"),r}async saveExcelData(r,e,n){return await this.dualSave("saveExcelData",r,e,n)}async saveHourEntry(r,e,n){return await this.dualSave("saveHourEntry",r,e,n)}async saveUserDates(r,e){return await this.dualSave("saveUserDates",r,e)}async getExcelData(r,e){return await this.dualFetch("getExcelData",r,e)}async getHourEntry(r,e){return await this.dualFetch("getHourEntry",r,e)}async getUserDates(r){return await this.dualFetch("getUserDates",r)}}const Ll=new VV,qV=()=>{var m;const[t,r]=Se.useState(null),[e,n]=Se.useState(null),[s,a]=Se.useState(null),[i,o]=Se.useState(!1);Se.useEffect(()=>{l()},[]);const l=async()=>{try{const p=Ll.getStatus(),v=await Ll.getHealthStatus();r(p),n(v)}catch(p){console.error("Failed to load status:",p)}},c=async()=>{o(!0);try{const p=Ll.enable();r(p),await l(),console.log(" Dual-service mode enabled")}catch(p){console.error(" Failed to enable dual-service:",p)}finally{o(!1)}},u=async()=>{o(!0);try{const p=Ll.disable();r(p),await l(),console.log(" Dual-service mode disabled")}catch(p){console.error(" Failed to disable dual-service:",p)}finally{o(!1)}},d=async()=>{o(!0);try{const p="test-user-123",v="2025-01-01",b={fileName:"test-excel.xlsx",sets:{"Test Set 1":{"Element 1":{Sun:"sun-1/element",Moon:"moon-2/element"}}}};console.log(" Testing dual-save operation...");const y=await Ll.saveExcelData(p,v,b);a({operation:"Dual Save Excel Data",success:y.overall.success,details:y,timestamp:new Date().toISOString()}),console.log(" Dual-save test completed:",y)}catch(p){a({operation:"Dual Save Excel Data",success:!1,error:p.message,timestamp:new Date().toISOString()}),console.error(" Dual-save test failed:",p)}finally{o(!1)}},h=async()=>{o(!0);try{const p="test-user-123",v="2025-01-01";console.log(" Testing dual-fetch operation...");const b=await Ll.getExcelData(p,v);a({operation:"Dual Fetch Excel Data",success:!0,details:b,timestamp:new Date().toISOString()}),console.log(" Dual-fetch test completed:",b)}catch(p){a({operation:"Dual Fetch Excel Data",success:!1,error:p.message,timestamp:new Date().toISOString()}),console.error(" Dual-fetch test failed:",p)}finally{o(!1)}},f=async()=>{o(!0);try{const p="test-user-123";console.log(" Testing sync operation...");const v=await Ll.syncPrimaryToBackup(p);a({operation:"Sync Primary to Backup",success:v.success,details:v,timestamp:new Date().toISOString()}),console.log(" Sync test completed:",v)}catch(p){a({operation:"Sync Primary to Backup",success:!1,error:p.message,timestamp:new Date().toISOString()}),console.error(" Sync test failed:",p)}finally{o(!1)}},g=p=>{switch(p){case"excellent":return"text-green-600";case"good":return"text-blue-600";case"degraded":return"text-yellow-600";case"critical":return"text-red-600";case"healthy":return"text-green-600";case"error":return"text-red-600";default:return"text-gray-600"}};return X.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[X.jsx("h1",{className:"text-3xl font-bold mb-6 text-gray-800",children:" Dual-Service Manager Demo"}),X.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[X.jsx("h2",{className:"text-lg font-semibold text-blue-800 mb-2",children:"About Dual-Service Mode"}),X.jsx("p",{className:"text-blue-700 text-sm",children:"This demo shows how to run both Supabase and Firebase simultaneously for maximum reliability. Data is saved to both services, with automatic fallback if one fails."})]}),X.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[X.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[X.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Service Status"}),t?X.jsxs("div",{className:"space-y-2",children:[X.jsxs("div",{className:"flex justify-between",children:[X.jsx("span",{children:"Dual-Service Mode:"}),X.jsx("span",{className:t.enabled?"text-green-600 font-semibold":"text-red-600",children:t.enabled?"ENABLED":"DISABLED"})]}),X.jsxs("div",{className:"flex justify-between",children:[X.jsx("span",{children:"Primary Service:"}),X.jsx("span",{className:"font-semibold text-blue-600",children:t.primary})]}),X.jsxs("div",{className:"flex justify-between",children:[X.jsx("span",{children:"Backup Service:"}),X.jsx("span",{className:"font-semibold text-orange-600",children:t.backup})]})]}):X.jsx("div",{className:"text-gray-500",children:"Loading..."})]}),X.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[X.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Health Status"}),e?X.jsxs("div",{className:"space-y-2",children:[X.jsxs("div",{className:"flex justify-between",children:[X.jsx("span",{children:"Overall Status:"}),X.jsx("span",{className:`font-semibold ${g(e.overall.status)}`,children:(m=e.overall.status)==null?void 0:m.toUpperCase()})]}),X.jsxs("div",{className:"flex justify-between",children:[X.jsx("span",{children:"Supabase:"}),X.jsxs("span",{className:`font-semibold ${g(e.services.primary.status)}`,children:[e.services.primary.status," ",e.services.primary.latency&&`(${e.services.primary.latency}ms)`]})]}),X.jsxs("div",{className:"flex justify-between",children:[X.jsx("span",{children:"Firebase:"}),X.jsx("span",{className:`font-semibold ${g(e.services.backup.status)}`,children:e.services.backup.status})]}),X.jsx("div",{className:"text-xs text-gray-600 mt-2",children:e.overall.message})]}):X.jsx("div",{className:"text-gray-500",children:"Loading..."})]})]}),X.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-6",children:[X.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Service Controls"}),X.jsxs("div",{className:"flex flex-wrap gap-3",children:[X.jsx("button",{onClick:c,disabled:i||(t==null?void 0:t.enabled),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Enable Dual-Service"}),X.jsx("button",{onClick:u,disabled:i||!(t!=null&&t.enabled),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Disable Dual-Service"}),X.jsx("button",{onClick:l,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400",children:"Refresh Status"})]})]}),X.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-6",children:[X.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Test Operations"}),X.jsxs("div",{className:"flex flex-wrap gap-3",children:[X.jsx("button",{onClick:d,disabled:i,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:bg-gray-400",children:"Test Dual Save"}),X.jsx("button",{onClick:h,disabled:i,className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 disabled:bg-gray-400",children:"Test Dual Fetch"}),X.jsx("button",{onClick:f,disabled:i,className:"px-4 py-2 bg-orange-600 text-white rounded hover:bg-orange-700 disabled:bg-gray-400",children:"Test Sync"})]})]}),s&&X.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[X.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Test Results"}),X.jsxs("div",{className:"bg-gray-50 rounded p-3",children:[X.jsxs("div",{className:"flex justify-between items-start mb-2",children:[X.jsx("span",{className:"font-semibold",children:s.operation}),X.jsx("span",{className:`px-2 py-1 text-xs rounded ${s.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.success?"SUCCESS":"FAILED"})]}),X.jsx("div",{className:"text-xs text-gray-600 mb-2",children:s.timestamp}),s.error&&X.jsxs("div",{className:"text-red-600 text-sm mb-2",children:["Error: ",s.error]}),X.jsxs("details",{className:"text-sm",children:[X.jsx("summary",{className:"cursor-pointer text-blue-600",children:"View Details"}),X.jsx("pre",{className:"mt-2 text-xs bg-white p-2 rounded border overflow-auto",children:JSON.stringify(s.details,null,2)})]})]})]}),i&&X.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:X.jsxs("div",{className:"bg-white rounded-lg p-6 flex items-center",children:[X.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-3"}),X.jsx("span",{children:"Processing..."})]})})]})};function WV(){const[t,r]=Se.useState(null),[e,n]=Se.useState(!0),[s,a]=Se.useState(!0);return Se.useEffect(()=>{localStorage.setItem("house_count_enabled","true"),localStorage.setItem("auth_type","simple");const i={user:{authenticated:!0,email:"dev@temporary.com",id:"temp-dev-user"}};localStorage.setItem("house_count_session",JSON.stringify(i)),r(i)},[]),X.jsx(K9,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:X.jsx(Ho,{children:X.jsx("div",{className:"min-h-screen bg-gray-100",children:X.jsxs(H9,{children:[X.jsx(Hs,{path:"/",element:X.jsx(s0,{to:"/users",replace:!0})}),X.jsx(Hs,{path:"/auth",element:X.jsx(s0,{to:"/users",replace:!0})}),X.jsx(Hs,{path:"/users",element:X.jsx(SI,{})}),X.jsx(Hs,{path:"/dashboard",element:X.jsx(s0,{to:"/abcd-number/1",replace:!0})}),X.jsx(Hs,{path:"/user/:userId",element:X.jsx(D5,{})}),X.jsx(Hs,{path:"/user-data/:userId",element:X.jsx(D5,{})}),X.jsx(Hs,{path:"/day-details/:userId",element:X.jsx(Ho,{children:X.jsx(NI,{})})}),X.jsx(Hs,{path:"/number-gen",element:X.jsx(Ho,{children:X.jsx(hV,{})})}),X.jsx(Hs,{path:"/abcd-number/:userId",element:X.jsx(Ho,{children:X.jsx(MV,{})})}),X.jsx(Hs,{path:"/planets-analysis",element:X.jsx(Ho,{children:X.jsx(j3,{})})}),X.jsx(Hs,{path:"/planets-analysis/:userId",element:X.jsx(Ho,{children:X.jsx(j3,{})})}),X.jsx(Hs,{path:"/dual-service-demo",element:X.jsx(Ho,{children:X.jsx(qV,{})})}),X.jsx(Hs,{path:"*",element:X.jsx(s0,{to:"/users",replace:!0})})]})})})})}Ng.createRoot(document.getElementById("root")).render(X.jsx(wv.StrictMode,{children:X.jsx(WV,{})}));export{Vf as _,rr as a,lr as c,gv as g,Bm as p};
