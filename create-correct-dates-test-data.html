<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Test Data for Correct Dates</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #00ff00;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .section {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        button {
            background: #0066cc;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        button:hover {
            background: #0088ff;
        }
        .result {
            min-height: 100px;
            background: #000;
            border: 1px solid #333;
            padding: 15px;
            margin: 10px 0;
            white-space: pre-wrap;
            color: #00ff00;
        }
        .success { color: #00ff00; }
        .error { color: #ff4444; }
        .warning { color: #ffaa00; }
        .info { color: #44aaff; }
        .highlight {
            background: #333;
            padding: 10px;
            border-left: 4px solid #00ff00;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¯ Create Test Data for CORRECT Application Dates</h1>
        
        <div class="highlight">
            <h3>ðŸ“… Target Dates from Application:</h3>
            <p><strong>ABCD Sequence:</strong> A(02/06/2025) â†’ B(03/06/2025) â†’ C(04/06/2025) â†’ D(05/06/2025)</p>
            <p>This will create test data for the <strong>actual dates</strong> the application is analyzing!</p>
        </div>
        
        <div class="section">
            <h2>ðŸš€ Create Test Data</h2>
            <button onclick="createTestData()" style="font-size: 18px; padding: 20px 40px;">
                CREATE TEST DATA FOR CORRECT DATES
            </button>
            <div id="result" class="result"></div>
        </div>

        <div class="section">
            <h2>ðŸ”„ Quick Actions</h2>
            <button onclick="goToApp()">Go to Main App</button>
            <button onclick="goToRule2CompactPage()">Test Rule2CompactPage</button>
            <button onclick="clearAllData()">Clear All Test Data</button>
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const colors = {
                success: '#00ff00',
                error: '#ff4444', 
                warning: '#ffaa00',
                info: '#44aaff'
            };
            return `<span style="color: ${colors[type]}">${message}</span>`;
        }

        function createTestData() {
            const result = document.getElementById('result');
            result.innerHTML = '';
            
            try {
                result.innerHTML += log('ðŸŽ¯ Creating Test Data for ACTUAL Application Dates', 'info') + '\\n';
                result.innerHTML += log('=================================================', 'info') + '\\n\\n';

                // Check for existing user ID or create a new one
                let userId = localStorage.getItem('userId');
                if (!userId) {
                    userId = 'test-user-' + Date.now();
                    localStorage.setItem('userId', userId);
                    result.innerHTML += log('ðŸ‘¤ Created new user ID: ' + userId, 'success') + '\\n';
                } else {
                    result.innerHTML += log('ðŸ‘¤ Using existing user ID: ' + userId, 'info') + '\\n';
                }
                
                // ACTUAL dates from the application 
                const aDay = '2025-06-02';  // A-day: 02/06/2025
                const bDay = '2025-06-03';  // B-day: 03/06/2025  
                const cDay = '2025-06-04';  // C-day: 04/06/2025
                const dDay = '2025-06-05';  // D-day: 05/06/2025
                
                result.innerHTML += log('\\nðŸ“… Creating data for ACTUAL application dates:', 'info') + '\\n';
                result.innerHTML += log('   A-day: ' + aDay, 'info') + '\\n';
                result.innerHTML += log('   B-day: ' + bDay, 'info') + '\\n';
                result.innerHTML += log('   C-day: ' + cDay, 'info') + '\\n';
                result.innerHTML += log('   D-day: ' + dDay, 'info') + '\\n';
                
                // Create realistic Excel data structure
                const createExcelData = (dayNumbers) => ({
                    data: {
                        sets: {
                            'D-1 Set-1 Matrix': {
                                'element1': { 'Sun': `as-${dayNumbers[0]}/su-20`, 'Moon': `mo-${dayNumbers[1]}/ve-25` },
                                'element2': { 'Sun': `li-${dayNumbers[2]}/ma-30`, 'Moon': `ar-${dayNumbers[3]}/ju-35` },
                                'element3': { 'Sun': `vi-${dayNumbers[4]}/sa-40`, 'Moon': `le-${dayNumbers[5]}/me-45` }
                            },
                            'D-1 Set-2 Matrix': {
                                'element1': { 'Sun': `sc-${dayNumbers[6]}/ur-50`, 'Moon': `sg-${dayNumbers[7]}/ne-55` },
                                'element2': { 'Sun': `cp-${dayNumbers[8]}/pl-60`, 'Moon': `aq-${dayNumbers[9]}/ra-65` }
                            },
                            'D-3 (trd) Set-1 Matrix': {
                                'element1': { 'Sun': `pi-${dayNumbers[10]}/ke-70`, 'Moon': `ta-${dayNumbers[11]}/su-75` },
                                'element2': { 'Sun': `ge-${dayNumbers[12]}/mo-80`, 'Moon': `ca-${dayNumbers[13]}/ma-85` }
                            },
                            'D-3 (trd) Set-2 Matrix': {
                                'element1': { 'Sun': `ar-${dayNumbers[14]}/ve-90`, 'Moon': `le-${dayNumbers[15]}/ju-95` },
                                'element2': { 'Sun': `sg-${dayNumbers[16]}/sa-100`, 'Moon': `aq-${dayNumbers[17]}/me-105` }
                            },
                            'D-4 Set-1 Matrix': {
                                'element1': { 'Sun': `ta-${dayNumbers[18]}/ma-110`, 'Moon': `vi-${dayNumbers[19]}/ur-115` },
                                'element2': { 'Sun': `cp-${dayNumbers[20]}/ne-120`, 'Moon': `pi-${dayNumbers[21]}/pl-125` }
                            }
                        }
                    }
                });
                
                // Create hour data
                const createHourData = () => ({
                    planetSelections: { 
                        '1': 'Sun', 
                        '2': 'Moon',
                        '3': 'Sun',
                        '4': 'Moon' 
                    }
                });
                
                // Test scenario: Design data to produce specific ABCD/BCD results
                const testScenarios = {
                    [aDay]: [1, 2, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110],  // A-day numbers
                    [bDay]: [1, 3, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111],  // B-day numbers  
                    [cDay]: [2, 4, 17, 22, 27, 32, 37, 42, 47, 52, 57, 62, 67, 72, 77, 82, 87, 92, 97, 102, 107, 112],  // C-day numbers
                    [dDay]: [1, 2, 3, 4, 5, 18, 23, 28, 33, 38, 43, 48, 53, 58, 63, 68, 73, 78, 83, 88, 93, 98]       // D-day numbers
                };
                
                // Store test data for each day
                const dates = [aDay, bDay, cDay, dDay];
                dates.forEach(date => {
                    const excelKey = `${userId}_excel_${date}`;
                    const hourKey = `${userId}_hour_${date}`;
                    
                    const excelData = createExcelData(testScenarios[date]);
                    const hourData = createHourData();
                    
                    localStorage.setItem(excelKey, JSON.stringify(excelData));
                    localStorage.setItem(hourKey, JSON.stringify(hourData));
                    
                    result.innerHTML += log(`âœ… Created data for ${date}`, 'success') + '\\n';
                });
                
                // Analyze what ABCD/BCD results we should expect
                result.innerHTML += log('\\nðŸŽ¯ EXPECTED ABCD/BCD RESULTS:', 'info') + '\\n';
                result.innerHTML += log('=============================', 'info') + '\\n';
                
                const dDayNumbers = testScenarios[dDay];
                const aDayNumbers = testScenarios[aDay];
                const bDayNumbers = testScenarios[bDay];
                const cDayNumbers = testScenarios[cDay];
                
                result.innerHTML += log('Input numbers:', 'info') + '\\n';
                result.innerHTML += log(`D-day: [${dDayNumbers.join(', ')}]`, 'info') + '\\n';
                result.innerHTML += log(`A-day: [${aDayNumbers.join(', ')}]`, 'info') + '\\n';
                result.innerHTML += log(`B-day: [${bDayNumbers.join(', ')}]`, 'info') + '\\n';
                result.innerHTML += log(`C-day: [${cDayNumbers.join(', ')}]`, 'info') + '\\n';
                
                // Manual calculation for verification
                const expectedABCD = [];
                const expectedBCD = [];
                
                dDayNumbers.forEach(num => {
                    const inA = aDayNumbers.includes(num);
                    const inB = bDayNumbers.includes(num);
                    const inC = cDayNumbers.includes(num);
                    
                    const abcCount = [inA, inB, inC].filter(Boolean).length;
                    
                    if (abcCount >= 2) {
                        expectedABCD.push(num);
                    } else {
                        const bdPairOnly = inB && !inC;
                        const cdPairOnly = inC && !inB;
                        
                        if (bdPairOnly || cdPairOnly) {
                            expectedBCD.push(num);
                        }
                    }
                });
                
                result.innerHTML += log('\\nExpected results:', 'success') + '\\n';
                result.innerHTML += log(`âœ… ABCD: [${expectedABCD.join(', ')}]`, 'success') + '\\n';
                result.innerHTML += log(`âœ… BCD: [${expectedBCD.join(', ')}]`, 'success') + '\\n';
                
                result.innerHTML += log('\\nðŸš€ TEST DATA READY FOR ACTUAL APPLICATION DATES!', 'success') + '\\n';
                result.innerHTML += log('=================================================', 'success') + '\\n';
                result.innerHTML += log('1. Refresh the Rule2CompactPage', 'info') + '\\n';
                result.innerHTML += log('2. Try Rule2 analysis with these dates', 'info') + '\\n';
                result.innerHTML += log('3. You should now see ABCD/BCD results instead of "No D-day numbers found"', 'info') + '\\n';
                result.innerHTML += log(`4. Analysis dates: A=${aDay}, B=${bDay}, C=${cDay}, D=${dDay}`, 'info') + '\\n';

            } catch (error) {
                result.innerHTML += log('âŒ Error: ' + error.message, 'error') + '\\n';
            }
        }

        function goToApp() {
            window.location.href = 'index.html';
        }

        function goToRule2CompactPage() {
            // You'll need to navigate to Rule2CompactPage from the main app
            alert('Navigate to Rule2CompactPage from the main application to test the new data!');
            goToApp();
        }

        function clearAllData() {
            if (confirm('Are you sure you want to clear ALL test data?')) {
                // Clear user ID and all related data
                const userId = localStorage.getItem('userId');
                if (userId) {
                    const keys = Object.keys(localStorage);
                    keys.forEach(key => {
                        if (key.includes(userId) || key === 'userId') {
                            localStorage.removeItem(key);
                        }
                    });
                    alert('All test data cleared!');
                }
            }
        }
    </script>
</body>
</html>
