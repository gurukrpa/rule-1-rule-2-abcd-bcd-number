<!DOCTYPE html>
<html>
<head>
    <title>Debug Matrix Word Issue - HR-2 Topic Names</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f5f5f5; }
        .debug-section { margin: 20px 0; padding: 15px; background: white; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>üîç Debug Matrix Word Issue - HR-2 Topic Names</h1>
    
    <div class="debug-section">
        <h3>‚ùì Key Questions to Answer:</h3>
        <ul>
            <li>What format do topic names have in realAnalysisData.topicNumbers?</li>
            <li>Are we looking up the wrong key due to Matrix word handling?</li>
            <li>Is the incomplete flag being set incorrectly due to Matrix mismatch?</li>
        </ul>
    </div>

    <div class="debug-section">
        <h3>üß™ Debug Instructions:</h3>
        <ol>
            <li><strong>Open Planets Analysis page</strong> in browser</li>
            <li><strong>Open browser console</strong> (F12)</li>
            <li><strong>Switch to HR-2 tab</strong></li>
            <li><strong>Look for log messages</strong> starting with:
                <ul>
                    <li class="info">üéØ [Topic: xxx] Using REAL ANALYSIS numbers</li>
                    <li class="warning">‚ö†Ô∏è [Topic: xxx] HR 2 analysis data marked as incomplete</li>
                    <li class="error">‚ùå [Topic: xxx] NO ABCD/BCD NUMBERS FOUND</li>
                </ul>
            </li>
            <li><strong>Check if topic names have "Matrix" suffix</strong> in real data</li>
        </ol>
    </div>

    <div class="debug-section">
        <h3>üîß Console Commands to Run:</h3>
        <div style="background: #f0f0f0; padding: 10px; margin: 10px 0;">
            <strong>1. Check realAnalysisData structure:</strong><br>
            <code>console.log('Real Analysis Data:', window.debugRealAnalysisData);</code>
        </div>
        
        <div style="background: #f0f0f0; padding: 10px; margin: 10px 0;">
            <strong>2. Check topic names in real data:</strong><br>
            <code>Object.keys(window.debugRealAnalysisData?.topicNumbers || {}).slice(0, 5)</code>
        </div>
        
        <div style="background: #f0f0f0; padding: 10px; margin: 10px 0;">
            <strong>3. Check fallback topic names:</strong><br>
            <code>console.log('Fallback keys:', ['D-1 Set-1 Matrix', 'D-1 Set-2 Matrix', 'D-3 Set-1 Matrix']);</code>
        </div>
    </div>

    <div class="debug-section">
        <h3>üí° Expected Findings:</h3>
        <p><strong>Hypothesis:</strong> The Matrix word normalization is causing lookup failures because:</p>
        <ul>
            <li>Real analysis data has topic names like <code>"D-1 Set-1"</code> (no Matrix)</li>
            <li>Fallback TOPIC_NUMBERS expects <code>"D-1 Set-1 Matrix"</code> (with Matrix)</li>
            <li>normalizeTopicName() adds Matrix, but lookup still fails</li>
            <li>This causes incorrect "incomplete" flag setting for HR-2</li>
        </ul>
    </div>

    <div class="debug-section">
        <h3>üöÄ Quick Fix Ideas:</h3>
        <ol>
            <li><strong>Option 1:</strong> Remove Matrix suffix from TOPIC_NUMBERS keys</li>
            <li><strong>Option 2:</strong> Fix normalizeTopicName() to handle both directions</li>
            <li><strong>Option 3:</strong> Create better topic matching logic</li>
        </ol>
    </div>

    <script>
        console.log('üîç Matrix Word Debug Tool Loaded');
        console.log('üìã Use the commands above to investigate the issue');
        
        // Try to access debug data if available
        setTimeout(() => {
            if (window.debugRealAnalysisData) {
                console.log('‚úÖ Debug data available:', window.debugRealAnalysisData);
            } else {
                console.log('‚ö†Ô∏è Debug data not available - navigate to Planets Analysis page first');
            }
        }, 1000);
    </script>
</body>
</html>
